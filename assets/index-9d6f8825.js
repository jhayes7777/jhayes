var e=Object.defineProperty,t=(t,n,r)=>(((t,n,r)=>{n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r})(t,"symbol"!=typeof n?n+"":n,r),r);function n(e,t){const n=Object.create(null),r=e.split(",");for(let i=0;i<r.length;i++)n[r[i]]=!0;return t?e=>!!n[e.toLowerCase()]:e=>!!n[e]}function r(e){if(E(e)){const t={};for(let n=0;n<e.length;n++){const i=e[n],a=D(i)?o(i):r(i);if(a)for(const e in a)t[e]=a[e]}return t}return D(e)||O(e)?e:void 0}!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const i=/;(?![^(]*\))/g,a=/:([^]+)/,s=/\/\*.*?\*\//gs;function o(e){const t={};return e.replace(s,"").split(i).forEach((e=>{if(e){const n=e.split(a);n.length>1&&(t[n[0].trim()]=n[1].trim())}})),t}function l(e){let t="";if(D(e))t=e;else if(E(e))for(let n=0;n<e.length;n++){const r=l(e[n]);r&&(t+=r+" ")}else if(O(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}function u(e){if(!e)return null;let{class:t,style:n}=e;return t&&!D(t)&&(e.class=l(t)),n&&(e.style=r(n)),e}const c=n("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function d(e){return!!e||""===e}function h(e,t){if(e===t)return!0;let n=R(e),r=R(t);if(n||r)return!(!n||!r)&&e.getTime()===t.getTime();if(n=I(e),r=I(t),n||r)return e===t;if(n=E(e),r=E(t),n||r)return!(!n||!r)&&function(e,t){if(e.length!==t.length)return!1;let n=!0;for(let r=0;n&&r<e.length;r++)n=h(e[r],t[r]);return n}(e,t);if(n=O(e),r=O(t),n||r){if(!n||!r)return!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e){const r=e.hasOwnProperty(n),i=t.hasOwnProperty(n);if(r&&!i||!r&&i||!h(e[n],t[n]))return!1}}return String(e)===String(t)}function p(e,t){return e.findIndex((e=>h(e,t)))}const f=e=>D(e)?e:null==e?"":E(e)||O(e)&&(e.toString===B||!k(e.toString))?JSON.stringify(e,m,2):String(e),m=(e,t)=>t&&t.__v_isRef?m(e,t.value):A(t)?{[`Map(${t.size})`]:[...t.entries()].reduce(((e,[t,n])=>(e[`${t} =>`]=n,e)),{})}:P(t)?{[`Set(${t.size})`]:[...t.values()]}:!O(t)||E(t)||F(t)?t:String(t),g={},v=[],y=()=>{},_=()=>!1,b=/^on[^a-z]/,x=e=>b.test(e),w=e=>e.startsWith("onUpdate:"),S=Object.assign,C=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},T=Object.prototype.hasOwnProperty,M=(e,t)=>T.call(e,t),E=Array.isArray,A=e=>"[object Map]"===U(e),P=e=>"[object Set]"===U(e),R=e=>"[object Date]"===U(e),k=e=>"function"==typeof e,D=e=>"string"==typeof e,I=e=>"symbol"==typeof e,O=e=>null!==e&&"object"==typeof e,N=e=>O(e)&&k(e.then)&&k(e.catch),B=Object.prototype.toString,U=e=>B.call(e),z=e=>U(e).slice(8,-1),F=e=>"[object Object]"===U(e),V=e=>D(e)&&"NaN"!==e&&"-"!==e[0]&&""+parseInt(e,10)===e,G=n(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),H=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},j=/-(\w)/g,W=H((e=>e.replace(j,((e,t)=>t?t.toUpperCase():"")))),Y=/\B([A-Z])/g,X=H((e=>e.replace(Y,"-$1").toLowerCase())),q=H((e=>e.charAt(0).toUpperCase()+e.slice(1))),K=H((e=>e?`on${q(e)}`:"")),Z=(e,t)=>!Object.is(e,t),J=(e,t)=>{for(let n=0;n<e.length;n++)e[n](t)},Q=(e,t,n)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:n})},ee=e=>{const t=parseFloat(e);return isNaN(t)?e:t},te=e=>{const t=D(e)?Number(e):NaN;return isNaN(t)?e:t};let ne;const re=()=>ne||(ne="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{});let ie;class ae{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=ie,!e&&ie&&(this.index=(ie.scopes||(ie.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const t=ie;try{return ie=this,e()}finally{ie=t}}}on(){ie=this}off(){ie=this.parent}stop(e){if(this._active){let t,n;for(t=0,n=this.effects.length;t<n;t++)this.effects[t].stop();for(t=0,n=this.cleanups.length;t<n;t++)this.cleanups[t]();if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].stop(!0);if(!this.detached&&this.parent&&!e){const e=this.parent.scopes.pop();e&&e!==this&&(this.parent.scopes[this.index]=e,e.index=this.index)}this.parent=void 0,this._active=!1}}}function se(){return ie}function oe(e){ie&&ie.cleanups.push(e)}const le=e=>{const t=new Set(e);return t.w=0,t.n=0,t},ue=e=>(e.w&pe)>0,ce=e=>(e.n&pe)>0,de=new WeakMap;let he=0,pe=1;const fe=30;let me;const ge=Symbol(""),ve=Symbol("");class ye{constructor(e,t=null,n){this.fn=e,this.scheduler=t,this.active=!0,this.deps=[],this.parent=void 0,function(e,t=ie){t&&t.active&&t.effects.push(e)}(this,n)}run(){if(!this.active)return this.fn();let e=me,t=be;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=me,me=this,be=!0,pe=1<<++he,he<=fe?(({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=pe})(this):_e(this),this.fn()}finally{he<=fe&&(e=>{const{deps:t}=e;if(t.length){let n=0;for(let r=0;r<t.length;r++){const i=t[r];ue(i)&&!ce(i)?i.delete(e):t[n++]=i,i.w&=~pe,i.n&=~pe}t.length=n}})(this),pe=1<<--he,me=this.parent,be=t,this.parent=void 0,this.deferStop&&this.stop()}}stop(){me===this?this.deferStop=!0:this.active&&(_e(this),this.onStop&&this.onStop(),this.active=!1)}}function _e(e){const{deps:t}=e;if(t.length){for(let n=0;n<t.length;n++)t[n].delete(e);t.length=0}}let be=!0;const xe=[];function we(){xe.push(be),be=!1}function Se(){const e=xe.pop();be=void 0===e||e}function Ce(e,t,n){if(be&&me){let t=de.get(e);t||de.set(e,t=new Map);let r=t.get(n);r||t.set(n,r=le()),Te(r)}}function Te(e,t){let n=!1;he<=fe?ce(e)||(e.n|=pe,n=!ue(e)):n=!e.has(me),n&&(e.add(me),me.deps.push(e))}function Me(e,t,n,r,i,a){const s=de.get(e);if(!s)return;let o=[];if("clear"===t)o=[...s.values()];else if("length"===n&&E(e)){const e=Number(r);s.forEach(((t,n)=>{("length"===n||n>=e)&&o.push(t)}))}else switch(void 0!==n&&o.push(s.get(n)),t){case"add":E(e)?V(n)&&o.push(s.get("length")):(o.push(s.get(ge)),A(e)&&o.push(s.get(ve)));break;case"delete":E(e)||(o.push(s.get(ge)),A(e)&&o.push(s.get(ve)));break;case"set":A(e)&&o.push(s.get(ge))}if(1===o.length)o[0]&&Ee(o[0]);else{const e=[];for(const t of o)t&&e.push(...t);Ee(le(e))}}function Ee(e,t){const n=E(e)?e:[...e];for(const r of n)r.computed&&Ae(r);for(const r of n)r.computed||Ae(r)}function Ae(e,t){(e!==me||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const Pe=n("__proto__,__v_isRef,__isVue"),Re=new Set(Object.getOwnPropertyNames(Symbol).filter((e=>"arguments"!==e&&"caller"!==e)).map((e=>Symbol[e])).filter(I)),Le=Be(),ke=Be(!1,!0),De=Be(!0),Ie=Oe();function Oe(){const e={};return["includes","indexOf","lastIndexOf"].forEach((t=>{e[t]=function(...e){const n=xt(this);for(let t=0,i=this.length;t<i;t++)Ce(n,0,t+"");const r=n[t](...e);return-1===r||!1===r?n[t](...e.map(xt)):r}})),["push","pop","shift","unshift","splice"].forEach((t=>{e[t]=function(...e){we();const n=xt(this)[t].apply(this,e);return Se(),n}})),e}function Ne(e){const t=xt(this);return Ce(t,0,e),t.hasOwnProperty(e)}function Be(e=!1,t=!1){return function(n,r,i){if("__v_isReactive"===r)return!e;if("__v_isReadonly"===r)return e;if("__v_isShallow"===r)return t;if("__v_raw"===r&&i===(e?t?ht:dt:t?ct:ut).get(n))return n;const a=E(n);if(!e){if(a&&M(Ie,r))return Reflect.get(Ie,r,i);if("hasOwnProperty"===r)return Ne}const s=Reflect.get(n,r,i);return(I(r)?Re.has(r):Pe(r))?s:(e||Ce(n,0,r),t?s:Et(s)?a&&V(r)?s:s.value:O(s)?e?mt(s):pt(s):s)}}function Ue(e=!1){return function(t,n,r,i){let a=t[n];if(yt(a)&&Et(a)&&!Et(r))return!1;if(!e&&(_t(r)||yt(r)||(a=xt(a),r=xt(r)),!E(t)&&Et(a)&&!Et(r)))return a.value=r,!0;const s=E(t)&&V(n)?Number(n)<t.length:M(t,n),o=Reflect.set(t,n,r,i);return t===xt(i)&&(s?Z(r,a)&&Me(t,"set",n,r):Me(t,"add",n,r)),o}}const ze={get:Le,set:Ue(),deleteProperty:function(e,t){const n=M(e,t);e[t];const r=Reflect.deleteProperty(e,t);return r&&n&&Me(e,"delete",t,void 0),r},has:function(e,t){const n=Reflect.has(e,t);return I(t)&&Re.has(t)||Ce(e,0,t),n},ownKeys:function(e){return Ce(e,0,E(e)?"length":ge),Reflect.ownKeys(e)}},Fe={get:De,set:(e,t)=>!0,deleteProperty:(e,t)=>!0},Ve=S({},ze,{get:ke,set:Ue(!0)}),Ge=e=>e,He=e=>Reflect.getPrototypeOf(e);function je(e,t,n=!1,r=!1){const i=xt(e=e.__v_raw),a=xt(t);n||(t!==a&&Ce(i,0,t),Ce(i,0,a));const{has:s}=He(i),o=r?Ge:n?Ct:St;return s.call(i,t)?o(e.get(t)):s.call(i,a)?o(e.get(a)):void(e!==i&&e.get(t))}function We(e,t=!1){const n=this.__v_raw,r=xt(n),i=xt(e);return t||(e!==i&&Ce(r,0,e),Ce(r,0,i)),e===i?n.has(e):n.has(e)||n.has(i)}function Ye(e,t=!1){return e=e.__v_raw,!t&&Ce(xt(e),0,ge),Reflect.get(e,"size",e)}function $e(e){e=xt(e);const t=xt(this);return He(t).has.call(t,e)||(t.add(e),Me(t,"add",e,e)),this}function Xe(e,t){t=xt(t);const n=xt(this),{has:r,get:i}=He(n);let a=r.call(n,e);a||(e=xt(e),a=r.call(n,e));const s=i.call(n,e);return n.set(e,t),a?Z(t,s)&&Me(n,"set",e,t):Me(n,"add",e,t),this}function qe(e){const t=xt(this),{has:n,get:r}=He(t);let i=n.call(t,e);i||(e=xt(e),i=n.call(t,e)),r&&r.call(t,e);const a=t.delete(e);return i&&Me(t,"delete",e,void 0),a}function Ke(){const e=xt(this),t=0!==e.size,n=e.clear();return t&&Me(e,"clear",void 0,void 0),n}function Ze(e,t){return function(n,r){const i=this,a=i.__v_raw,s=xt(a),o=t?Ge:e?Ct:St;return!e&&Ce(s,0,ge),a.forEach(((e,t)=>n.call(r,o(e),o(t),i)))}}function Je(e,t,n){return function(...r){const i=this.__v_raw,a=xt(i),s=A(a),o="entries"===e||e===Symbol.iterator&&s,l="keys"===e&&s,u=i[e](...r),c=n?Ge:t?Ct:St;return!t&&Ce(a,0,l?ve:ge),{next(){const{value:e,done:t}=u.next();return t?{value:e,done:t}:{value:o?[c(e[0]),c(e[1])]:c(e),done:t}},[Symbol.iterator](){return this}}}}function Qe(e){return function(...t){return"delete"!==e&&this}}function et(){const e={get(e){return je(this,e)},get size(){return Ye(this)},has:We,add:$e,set:Xe,delete:qe,clear:Ke,forEach:Ze(!1,!1)},t={get(e){return je(this,e,!1,!0)},get size(){return Ye(this)},has:We,add:$e,set:Xe,delete:qe,clear:Ke,forEach:Ze(!1,!0)},n={get(e){return je(this,e,!0)},get size(){return Ye(this,!0)},has(e){return We.call(this,e,!0)},add:Qe("add"),set:Qe("set"),delete:Qe("delete"),clear:Qe("clear"),forEach:Ze(!0,!1)},r={get(e){return je(this,e,!0,!0)},get size(){return Ye(this,!0)},has(e){return We.call(this,e,!0)},add:Qe("add"),set:Qe("set"),delete:Qe("delete"),clear:Qe("clear"),forEach:Ze(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach((i=>{e[i]=Je(i,!1,!1),n[i]=Je(i,!0,!1),t[i]=Je(i,!1,!0),r[i]=Je(i,!0,!0)})),[e,n,t,r]}const[tt,nt,rt,it]=et();function at(e,t){const n=t?e?it:rt:e?nt:tt;return(t,r,i)=>"__v_isReactive"===r?!e:"__v_isReadonly"===r?e:"__v_raw"===r?t:Reflect.get(M(n,r)&&r in t?n:t,r,i)}const st={get:at(!1,!1)},ot={get:at(!1,!0)},lt={get:at(!0,!1)},ut=new WeakMap,ct=new WeakMap,dt=new WeakMap,ht=new WeakMap;function pt(e){return yt(e)?e:gt(e,!1,ze,st,ut)}function ft(e){return gt(e,!1,Ve,ot,ct)}function mt(e){return gt(e,!0,Fe,lt,dt)}function gt(e,t,n,r,i){if(!O(e))return e;if(e.__v_raw&&(!t||!e.__v_isReactive))return e;const a=i.get(e);if(a)return a;const s=(o=e).__v_skip||!Object.isExtensible(o)?0:function(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}(z(o));var o;if(0===s)return e;const l=new Proxy(e,2===s?r:n);return i.set(e,l),l}function vt(e){return yt(e)?vt(e.__v_raw):!(!e||!e.__v_isReactive)}function yt(e){return!(!e||!e.__v_isReadonly)}function _t(e){return!(!e||!e.__v_isShallow)}function bt(e){return vt(e)||yt(e)}function xt(e){const t=e&&e.__v_raw;return t?xt(t):e}function wt(e){return Q(e,"__v_skip",!0),e}const St=e=>O(e)?pt(e):e,Ct=e=>O(e)?mt(e):e;function Tt(e){be&&me&&Te((e=xt(e)).dep||(e.dep=le()))}function Mt(e,t){const n=(e=xt(e)).dep;n&&Ee(n)}function Et(e){return!(!e||!0!==e.__v_isRef)}function At(e){return Rt(e,!1)}function Pt(e){return Rt(e,!0)}function Rt(e,t){return Et(e)?e:new Lt(e,t)}class Lt{constructor(e,t){this.__v_isShallow=t,this.dep=void 0,this.__v_isRef=!0,this._rawValue=t?e:xt(e),this._value=t?e:St(e)}get value(){return Tt(this),this._value}set value(e){const t=this.__v_isShallow||_t(e)||yt(e);e=t?e:xt(e),Z(e,this._rawValue)&&(this._rawValue=e,this._value=t?e:St(e),Mt(this))}}function kt(e){Mt(e)}function Dt(e){return Et(e)?e.value:e}const It={get:(e,t,n)=>Dt(Reflect.get(e,t,n)),set:(e,t,n,r)=>{const i=e[t];return Et(i)&&!Et(n)?(i.value=n,!0):Reflect.set(e,t,n,r)}};function Ot(e){return vt(e)?e:new Proxy(e,It)}function Nt(e){const t=E(e)?new Array(e.length):{};for(const n in e)t[n]=Ut(e,n);return t}class Bt{constructor(e,t,n){this._object=e,this._key=t,this._defaultValue=n,this.__v_isRef=!0}get value(){const e=this._object[this._key];return void 0===e?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return e=xt(this._object),t=this._key,null===(n=de.get(e))||void 0===n?void 0:n.get(t);var e,t,n}}function Ut(e,t,n){const r=e[t];return Et(r)?r:new Bt(e,t,n)}var zt;class Ft{constructor(e,t,n,r){this._setter=t,this.dep=void 0,this.__v_isRef=!0,this[zt]=!1,this._dirty=!0,this.effect=new ye(e,(()=>{this._dirty||(this._dirty=!0,Mt(this))})),this.effect.computed=this,this.effect.active=this._cacheable=!r,this.__v_isReadonly=n}get value(){const e=xt(this);return Tt(e),!e._dirty&&e._cacheable||(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function Vt(e,t,n=!1){let r,i;const a=k(e);a?(r=e,i=y):(r=e.get,i=e.set);return new Ft(r,i,a||!i,n)}function Gt(e,t,n,r){let i;try{i=r?e(...r):e()}catch(a){jt(a,t,n)}return i}function Ht(e,t,n,r){if(k(e)){const i=Gt(e,t,n,r);return i&&N(i)&&i.catch((e=>{jt(e,t,n)})),i}const i=[];for(let a=0;a<e.length;a++)i.push(Ht(e[a],t,n,r));return i}function jt(e,t,n,r=!0){t&&t.vnode;if(t){let r=t.parent;const i=t.proxy,a=n;for(;r;){const t=r.ec;if(t)for(let n=0;n<t.length;n++)if(!1===t[n](e,i,a))return;r=r.parent}const s=t.appContext.config.errorHandler;if(s)return void Gt(s,null,10,[e,i,a])}!function(e,t,n,r=!0){console.error(e)}(e,0,0,r)}zt="__v_isReadonly";let Wt=!1,Yt=!1;const $t=[];let Xt=0;const qt=[];let Kt=null,Zt=0;const Jt=Promise.resolve();let Qt=null;function en(e){const t=Qt||Jt;return e?t.then(this?e.bind(this):e):t}function tn(e){$t.length&&$t.includes(e,Wt&&e.allowRecurse?Xt+1:Xt)||(null==e.id?$t.push(e):$t.splice(function(e){let t=Xt+1,n=$t.length;for(;t<n;){const r=t+n>>>1;sn($t[r])<e?t=r+1:n=r}return t}(e.id),0,e),nn())}function nn(){Wt||Yt||(Yt=!0,Qt=Jt.then(ln))}function rn(e,t=(Wt?Xt+1:0)){for(;t<$t.length;t++){const e=$t[t];e&&e.pre&&($t.splice(t,1),t--,e())}}function an(e){if(qt.length){const e=[...new Set(qt)];if(qt.length=0,Kt)return void Kt.push(...e);for(Kt=e,Kt.sort(((e,t)=>sn(e)-sn(t))),Zt=0;Zt<Kt.length;Zt++)Kt[Zt]();Kt=null,Zt=0}}const sn=e=>null==e.id?1/0:e.id,on=(e,t)=>{const n=sn(e)-sn(t);if(0===n){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return n};function ln(e){Yt=!1,Wt=!0,$t.sort(on);try{for(Xt=0;Xt<$t.length;Xt++){const e=$t[Xt];e&&!1!==e.active&&Gt(e,null,14)}}finally{Xt=0,$t.length=0,an(),Wt=!1,Qt=null,($t.length||qt.length)&&ln()}}function un(e,t,...n){if(e.isUnmounted)return;const r=e.vnode.props||g;let i=n;const a=t.startsWith("update:"),s=a&&t.slice(7);if(s&&s in r){const e=`${"modelValue"===s?"model":s}Modifiers`,{number:t,trim:a}=r[e]||g;a&&(i=n.map((e=>D(e)?e.trim():e))),t&&(i=n.map(ee))}let o,l=r[o=K(t)]||r[o=K(W(t))];!l&&a&&(l=r[o=K(X(t))]),l&&Ht(l,e,6,i);const u=r[o+"Once"];if(u){if(e.emitted){if(e.emitted[o])return}else e.emitted={};e.emitted[o]=!0,Ht(u,e,6,i)}}function cn(e,t,n=!1){const r=t.emitsCache,i=r.get(e);if(void 0!==i)return i;const a=e.emits;let s={},o=!1;if(!k(e)){const r=e=>{const n=cn(e,t,!0);n&&(o=!0,S(s,n))};!n&&t.mixins.length&&t.mixins.forEach(r),e.extends&&r(e.extends),e.mixins&&e.mixins.forEach(r)}return a||o?(E(a)?a.forEach((e=>s[e]=null)):S(s,a),O(e)&&r.set(e,s),s):(O(e)&&r.set(e,null),null)}function dn(e,t){return!(!e||!x(t))&&(t=t.slice(2).replace(/Once$/,""),M(e,t[0].toLowerCase()+t.slice(1))||M(e,X(t))||M(e,t))}let hn=null,pn=null;function fn(e){const t=hn;return hn=e,pn=e&&e.type.__scopeId||null,t}function mn(e){pn=e}function gn(){pn=null}function vn(e,t=hn,n){if(!t)return e;if(e._n)return e;const r=(...n)=>{r._d&&gi(-1);const i=fn(t);let a;try{a=e(...n)}finally{fn(i),r._d&&gi(1)}return a};return r._n=!0,r._c=!0,r._d=!0,r}function yn(e){const{type:t,vnode:n,proxy:r,withProxy:i,props:a,propsOptions:[s],slots:o,attrs:l,emit:u,render:c,renderCache:d,data:h,setupState:p,ctx:f,inheritAttrs:m}=e;let g,v;const y=fn(e);try{if(4&n.shapeFlag){const e=i||r;g=ki(c.call(e,e,d,a,p,h,f)),v=l}else{const e=t;0,g=ki(e.length>1?e(a,{attrs:l,slots:o,emit:u}):e(a,null)),v=t.props?l:_n(l)}}catch(b){hi.length=0,jt(b,e,1),g=Mi(ci)}let _=g;if(v&&!1!==m){const e=Object.keys(v),{shapeFlag:t}=_;e.length&&7&t&&(s&&e.some(w)&&(v=bn(v,s)),_=Ai(_,v))}return n.dirs&&(_=Ai(_),_.dirs=_.dirs?_.dirs.concat(n.dirs):n.dirs),n.transition&&(_.transition=n.transition),g=_,fn(y),g}const _n=e=>{let t;for(const n in e)("class"===n||"style"===n||x(n))&&((t||(t={}))[n]=e[n]);return t},bn=(e,t)=>{const n={};for(const r in e)w(r)&&r.slice(9)in t||(n[r]=e[r]);return n};function xn(e,t,n){const r=Object.keys(t);if(r.length!==Object.keys(e).length)return!0;for(let i=0;i<r.length;i++){const a=r[i];if(t[a]!==e[a]&&!dn(n,a))return!0}return!1}function wn(e,t){if(zi){let n=zi.provides;const r=zi.parent&&zi.parent.provides;r===n&&(n=zi.provides=Object.create(r)),n[e]=t}else;}function Sn(e,t,n=!1){const r=zi||hn;if(r){const i=null==r.parent?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides;if(i&&e in i)return i[e];if(arguments.length>1)return n&&k(t)?t.call(r.proxy):t}}function Cn(e,t){return En(e,null,t)}const Tn={};function Mn(e,t,n){return En(e,t,n)}function En(e,t,{immediate:n,deep:r,flush:i,onTrack:a,onTrigger:s}=g){const o=se()===(null==zi?void 0:zi.scope)?zi:null;let l,u,c=!1,d=!1;if(Et(e)?(l=()=>e.value,c=_t(e)):vt(e)?(l=()=>e,r=!0):E(e)?(d=!0,c=e.some((e=>vt(e)||_t(e))),l=()=>e.map((e=>Et(e)?e.value:vt(e)?Rn(e):k(e)?Gt(e,o,2):void 0))):l=k(e)?t?()=>Gt(e,o,2):()=>{if(!o||!o.isUnmounted)return u&&u(),Ht(e,o,3,[p])}:y,t&&r){const e=l;l=()=>Rn(e())}let h,p=e=>{u=_.onStop=()=>{Gt(e,o,4)}};if(Wi){if(p=y,t?n&&Ht(t,o,3,[l(),d?[]:void 0,p]):l(),"sync"!==i)return y;{const e=na();h=e.__watcherHandles||(e.__watcherHandles=[])}}let f=d?new Array(e.length).fill(Tn):Tn;const m=()=>{if(_.active)if(t){const e=_.run();(r||c||(d?e.some(((e,t)=>Z(e,f[t]))):Z(e,f)))&&(u&&u(),Ht(t,o,3,[e,f===Tn?void 0:d&&f[0]===Tn?[]:f,p]),f=e)}else _.run()};let v;m.allowRecurse=!!t,"sync"===i?v=m:"post"===i?v=()=>Jr(m,o&&o.suspense):(m.pre=!0,o&&(m.id=o.uid),v=()=>tn(m));const _=new ye(l,v);t?n?m():f=_.run():"post"===i?Jr(_.run.bind(_),o&&o.suspense):_.run();const b=()=>{_.stop(),o&&o.scope&&C(o.scope.effects,_)};return h&&h.push(b),b}function An(e,t,n){const r=this.proxy,i=D(e)?e.includes(".")?Pn(r,e):()=>r[e]:e.bind(r,r);let a;k(t)?a=t:(a=t.handler,n=t);const s=zi;Vi(this);const o=En(i,a.bind(r),n);return s?Vi(s):Gi(),o}function Pn(e,t){const n=t.split(".");return()=>{let t=e;for(let e=0;e<n.length&&t;e++)t=t[n[e]];return t}}function Rn(e,t){if(!O(e)||e.__v_skip)return e;if((t=t||new Set).has(e))return e;if(t.add(e),Et(e))Rn(e.value,t);else if(E(e))for(let n=0;n<e.length;n++)Rn(e[n],t);else if(P(e)||A(e))e.forEach((e=>{Rn(e,t)}));else if(F(e))for(const n in e)Rn(e[n],t);return e}function Ln(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Kn((()=>{e.isMounted=!0})),Qn((()=>{e.isUnmounting=!0})),e}const kn=[Function,Array],Dn={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:kn,onEnter:kn,onAfterEnter:kn,onEnterCancelled:kn,onBeforeLeave:kn,onLeave:kn,onAfterLeave:kn,onLeaveCancelled:kn,onBeforeAppear:kn,onAppear:kn,onAfterAppear:kn,onAppearCancelled:kn},setup(e,{slots:t}){const n=Fi(),r=Ln();let i;return()=>{const a=t.default&&zn(t.default(),!0);if(!a||!a.length)return;let s=a[0];if(a.length>1)for(const e of a)if(e.type!==ci){s=e;break}const o=xt(e),{mode:l}=o;if(r.isLeaving)return Nn(s);const u=Bn(s);if(!u)return Nn(s);const c=On(u,o,r,n);Un(u,c);const d=n.subTree,h=d&&Bn(d);let p=!1;const{getTransitionKey:f}=u.type;if(f){const e=f();void 0===i?i=e:e!==i&&(i=e,p=!0)}if(h&&h.type!==ci&&(!xi(u,h)||p)){const e=On(h,o,r,n);if(Un(h,e),"out-in"===l)return r.isLeaving=!0,e.afterLeave=()=>{r.isLeaving=!1,!1!==n.update.active&&n.update()},Nn(s);"in-out"===l&&u.type!==ci&&(e.delayLeave=(e,t,n)=>{In(r,h)[String(h.key)]=h,e._leaveCb=()=>{t(),e._leaveCb=void 0,delete c.delayedLeave},c.delayedLeave=n})}return s}}};function In(e,t){const{leavingVNodes:n}=e;let r=n.get(t.type);return r||(r=Object.create(null),n.set(t.type,r)),r}function On(e,t,n,r){const{appear:i,mode:a,persisted:s=!1,onBeforeEnter:o,onEnter:l,onAfterEnter:u,onEnterCancelled:c,onBeforeLeave:d,onLeave:h,onAfterLeave:p,onLeaveCancelled:f,onBeforeAppear:m,onAppear:g,onAfterAppear:v,onAppearCancelled:y}=t,_=String(e.key),b=In(n,e),x=(e,t)=>{e&&Ht(e,r,9,t)},w=(e,t)=>{const n=t[1];x(e,t),E(e)?e.every((e=>e.length<=1))&&n():e.length<=1&&n()},S={mode:a,persisted:s,beforeEnter(t){let r=o;if(!n.isMounted){if(!i)return;r=m||o}t._leaveCb&&t._leaveCb(!0);const a=b[_];a&&xi(e,a)&&a.el._leaveCb&&a.el._leaveCb(),x(r,[t])},enter(e){let t=l,r=u,a=c;if(!n.isMounted){if(!i)return;t=g||l,r=v||u,a=y||c}let s=!1;const o=e._enterCb=t=>{s||(s=!0,x(t?a:r,[e]),S.delayedLeave&&S.delayedLeave(),e._enterCb=void 0)};t?w(t,[e,o]):o()},leave(t,r){const i=String(e.key);if(t._enterCb&&t._enterCb(!0),n.isUnmounting)return r();x(d,[t]);let a=!1;const s=t._leaveCb=n=>{a||(a=!0,r(),x(n?f:p,[t]),t._leaveCb=void 0,b[i]===e&&delete b[i])};b[i]=e,h?w(h,[t,s]):s()},clone:e=>On(e,t,n,r)};return S}function Nn(e){if(Gn(e))return(e=Ai(e)).children=null,e}function Bn(e){return Gn(e)?e.children?e.children[0]:void 0:e}function Un(e,t){6&e.shapeFlag&&e.component?Un(e.component.subTree,t):128&e.shapeFlag?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function zn(e,t=!1,n){let r=[],i=0;for(let a=0;a<e.length;a++){let s=e[a];const o=null==n?s.key:String(n)+String(null!=s.key?s.key:a);s.type===li?(128&s.patchFlag&&i++,r=r.concat(zn(s.children,t,o))):(t||s.type!==ci)&&r.push(null!=o?Ai(s,{key:o}):s)}if(i>1)for(let a=0;a<r.length;a++)r[a].patchFlag=-2;return r}function Fn(e){return k(e)?{setup:e,name:e.name}:e}const Vn=e=>!!e.type.__asyncLoader,Gn=e=>e.type.__isKeepAlive;function Hn(e,t){Wn(e,"a",t)}function jn(e,t){Wn(e,"da",t)}function Wn(e,t,n=zi){const r=e.__wdc||(e.__wdc=()=>{let t=n;for(;t;){if(t.isDeactivated)return;t=t.parent}return e()});if($n(t,r,n),n){let e=n.parent;for(;e&&e.parent;)Gn(e.parent.vnode)&&Yn(r,t,n,e),e=e.parent}}function Yn(e,t,n,r){const i=$n(t,e,r,!0);er((()=>{C(r[t],i)}),n)}function $n(e,t,n=zi,r=!1){if(n){const i=n[e]||(n[e]=[]),a=t.__weh||(t.__weh=(...r)=>{if(n.isUnmounted)return;we(),Vi(n);const i=Ht(t,n,e,r);return Gi(),Se(),i});return r?i.unshift(a):i.push(a),a}}const Xn=e=>(t,n=zi)=>(!Wi||"sp"===e)&&$n(e,((...e)=>t(...e)),n),qn=Xn("bm"),Kn=Xn("m"),Zn=Xn("bu"),Jn=Xn("u"),Qn=Xn("bum"),er=Xn("um"),tr=Xn("sp"),nr=Xn("rtg"),rr=Xn("rtc");function ir(e,t=zi){$n("ec",e,t)}function ar(e,t){const n=hn;if(null===n)return e;const r=qi(n)||n.proxy,i=e.dirs||(e.dirs=[]);for(let a=0;a<t.length;a++){let[e,n,s,o=g]=t[a];e&&(k(e)&&(e={mounted:e,updated:e}),e.deep&&Rn(n),i.push({dir:e,instance:r,value:n,oldValue:void 0,arg:s,modifiers:o}))}return e}function sr(e,t,n,r){const i=e.dirs,a=t&&t.dirs;for(let s=0;s<i.length;s++){const o=i[s];a&&(o.oldValue=a[s].value);let l=o.dir[r];l&&(we(),Ht(l,n,8,[e.el,o,e,t]),Se())}}const or="components",lr="directives";function ur(e,t){return pr(or,e,!0,t)||e}const cr=Symbol();function dr(e){return D(e)?pr(or,e,!1)||e:e||cr}function hr(e){return pr(lr,e)}function pr(e,t,n=!0,r=!1){const i=hn||zi;if(i){const n=i.type;if(e===or){const e=function(e,t=!0){return k(e)?e.displayName||e.name:e.name||t&&e.__name}(n,!1);if(e&&(e===t||e===W(t)||e===q(W(t))))return n}const a=fr(i[e]||n[e],t)||fr(i.appContext[e],t);return!a&&r?n:a}}function fr(e,t){return e&&(e[t]||e[W(t)]||e[q(W(t))])}function mr(e,t,n,r){let i;const a=n&&n[r];if(E(e)||D(e)){i=new Array(e.length);for(let n=0,r=e.length;n<r;n++)i[n]=t(e[n],n,void 0,a&&a[n])}else if("number"==typeof e){i=new Array(e);for(let n=0;n<e;n++)i[n]=t(n+1,n,void 0,a&&a[n])}else if(O(e))if(e[Symbol.iterator])i=Array.from(e,((e,n)=>t(e,n,void 0,a&&a[n])));else{const n=Object.keys(e);i=new Array(n.length);for(let r=0,s=n.length;r<s;r++){const s=n[r];i[r]=t(e[s],s,r,a&&a[r])}}else i=[];return n&&(n[r]=i),i}function gr(e,t){for(let n=0;n<t.length;n++){const r=t[n];if(E(r))for(let t=0;t<r.length;t++)e[r[t].name]=r[t].fn;else r&&(e[r.name]=r.key?(...e)=>{const t=r.fn(...e);return t&&(t.key=r.key),t}:r.fn)}return e}function vr(e,t,n={},r,i){if(hn.isCE||hn.parent&&Vn(hn.parent)&&hn.parent.isCE)return"default"!==t&&(n.name=t),Mi("slot",n,r&&r());let a=e[t];a&&a._c&&(a._d=!1),fi();const s=a&&yr(a(n)),o=_i(li,{key:n.key||s&&s.key||`_${t}`},s||(r?r():[]),s&&1===e._?64:-2);return!i&&o.scopeId&&(o.slotScopeIds=[o.scopeId+"-s"]),a&&a._c&&(a._d=!0),o}function yr(e){return e.some((e=>!bi(e)||e.type!==ci&&!(e.type===li&&!yr(e.children))))?e:null}const _r=e=>e?Hi(e)?qi(e)||e.proxy:_r(e.parent):null,br=S(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>_r(e.parent),$root:e=>_r(e.root),$emit:e=>e.emit,$options:e=>Er(e),$forceUpdate:e=>e.f||(e.f=()=>tn(e.update)),$nextTick:e=>e.n||(e.n=en.bind(e.proxy)),$watch:e=>An.bind(e)}),xr=(e,t)=>e!==g&&!e.__isScriptSetup&&M(e,t),wr={get({_:e},t){const{ctx:n,setupState:r,data:i,props:a,accessCache:s,type:o,appContext:l}=e;let u;if("$"!==t[0]){const o=s[t];if(void 0!==o)switch(o){case 1:return r[t];case 2:return i[t];case 4:return n[t];case 3:return a[t]}else{if(xr(r,t))return s[t]=1,r[t];if(i!==g&&M(i,t))return s[t]=2,i[t];if((u=e.propsOptions[0])&&M(u,t))return s[t]=3,a[t];if(n!==g&&M(n,t))return s[t]=4,n[t];Sr&&(s[t]=0)}}const c=br[t];let d,h;return c?("$attrs"===t&&Ce(e,0,t),c(e)):(d=o.__cssModules)&&(d=d[t])?d:n!==g&&M(n,t)?(s[t]=4,n[t]):(h=l.config.globalProperties,M(h,t)?h[t]:void 0)},set({_:e},t,n){const{data:r,setupState:i,ctx:a}=e;return xr(i,t)?(i[t]=n,!0):r!==g&&M(r,t)?(r[t]=n,!0):!M(e.props,t)&&(("$"!==t[0]||!(t.slice(1)in e))&&(a[t]=n,!0))},has({_:{data:e,setupState:t,accessCache:n,ctx:r,appContext:i,propsOptions:a}},s){let o;return!!n[s]||e!==g&&M(e,s)||xr(t,s)||(o=a[0])&&M(o,s)||M(r,s)||M(br,s)||M(i.config.globalProperties,s)},defineProperty(e,t,n){return null!=n.get?e._.accessCache[t]=0:M(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};let Sr=!0;function Cr(e){const t=Er(e),n=e.proxy,r=e.ctx;Sr=!1,t.beforeCreate&&Tr(t.beforeCreate,e,"bc");const{data:i,computed:a,methods:s,watch:o,provide:l,inject:u,created:c,beforeMount:d,mounted:h,beforeUpdate:p,updated:f,activated:m,deactivated:g,beforeDestroy:v,beforeUnmount:_,destroyed:b,unmounted:x,render:w,renderTracked:S,renderTriggered:C,errorCaptured:T,serverPrefetch:M,expose:A,inheritAttrs:P,components:R,directives:L,filters:D}=t;if(u&&function(e,t,n=y,r=!1){E(e)&&(e=Lr(e));for(const i in e){const n=e[i];let a;a=O(n)?"default"in n?Sn(n.from||i,n.default,!0):Sn(n.from||i):Sn(n),Et(a)&&r?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>a.value,set:e=>a.value=e}):t[i]=a}}(u,r,null,e.appContext.config.unwrapInjectedRef),s)for(const y in s){const e=s[y];k(e)&&(r[y]=e.bind(n))}if(i){const t=i.call(n,n);O(t)&&(e.data=pt(t))}if(Sr=!0,a)for(const E in a){const e=a[E],t=k(e)?e.bind(n,n):k(e.get)?e.get.bind(n,n):y,i=!k(e)&&k(e.set)?e.set.bind(n):y,s=Ki({get:t,set:i});Object.defineProperty(r,E,{enumerable:!0,configurable:!0,get:()=>s.value,set:e=>s.value=e})}if(o)for(const y in o)Mr(o[y],r,n,y);if(l){const e=k(l)?l.call(n):l;Reflect.ownKeys(e).forEach((t=>{wn(t,e[t])}))}function I(e,t){E(t)?t.forEach((t=>e(t.bind(n)))):t&&e(t.bind(n))}if(c&&Tr(c,e,"c"),I(qn,d),I(Kn,h),I(Zn,p),I(Jn,f),I(Hn,m),I(jn,g),I(ir,T),I(rr,S),I(nr,C),I(Qn,_),I(er,x),I(tr,M),E(A))if(A.length){const t=e.exposed||(e.exposed={});A.forEach((e=>{Object.defineProperty(t,e,{get:()=>n[e],set:t=>n[e]=t})}))}else e.exposed||(e.exposed={});w&&e.render===y&&(e.render=w),null!=P&&(e.inheritAttrs=P),R&&(e.components=R),L&&(e.directives=L)}function Tr(e,t,n){Ht(E(e)?e.map((e=>e.bind(t.proxy))):e.bind(t.proxy),t,n)}function Mr(e,t,n,r){const i=r.includes(".")?Pn(n,r):()=>n[r];if(D(e)){const n=t[e];k(n)&&Mn(i,n)}else if(k(e))Mn(i,e.bind(n));else if(O(e))if(E(e))e.forEach((e=>Mr(e,t,n,r)));else{const r=k(e.handler)?e.handler.bind(n):t[e.handler];k(r)&&Mn(i,r,e)}}function Er(e){const t=e.type,{mixins:n,extends:r}=t,{mixins:i,optionsCache:a,config:{optionMergeStrategies:s}}=e.appContext,o=a.get(t);let l;return o?l=o:i.length||n||r?(l={},i.length&&i.forEach((e=>Ar(l,e,s,!0))),Ar(l,t,s)):l=t,O(t)&&a.set(t,l),l}function Ar(e,t,n,r=!1){const{mixins:i,extends:a}=t;a&&Ar(e,a,n,!0),i&&i.forEach((t=>Ar(e,t,n,!0)));for(const s in t)if(r&&"expose"===s);else{const r=Pr[s]||n&&n[s];e[s]=r?r(e[s],t[s]):t[s]}return e}const Pr={data:Rr,props:Dr,emits:Dr,methods:Dr,computed:Dr,beforeCreate:kr,created:kr,beforeMount:kr,mounted:kr,beforeUpdate:kr,updated:kr,beforeDestroy:kr,beforeUnmount:kr,destroyed:kr,unmounted:kr,activated:kr,deactivated:kr,errorCaptured:kr,serverPrefetch:kr,components:Dr,directives:Dr,watch:function(e,t){if(!e)return t;if(!t)return e;const n=S(Object.create(null),e);for(const r in t)n[r]=kr(e[r],t[r]);return n},provide:Rr,inject:function(e,t){return Dr(Lr(e),Lr(t))}};function Rr(e,t){return t?e?function(){return S(k(e)?e.call(this,this):e,k(t)?t.call(this,this):t)}:t:e}function Lr(e){if(E(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function kr(e,t){return e?[...new Set([].concat(e,t))]:t}function Dr(e,t){return e?S(S(Object.create(null),e),t):t}function Ir(e,t,n,r){const[i,a]=e.propsOptions;let s,o=!1;if(t)for(let l in t){if(G(l))continue;const u=t[l];let c;i&&M(i,c=W(l))?a&&a.includes(c)?(s||(s={}))[c]=u:n[c]=u:dn(e.emitsOptions,l)||l in r&&u===r[l]||(r[l]=u,o=!0)}if(a){const t=xt(n),r=s||g;for(let s=0;s<a.length;s++){const o=a[s];n[o]=Or(i,t,o,r[o],e,!M(r,o))}}return o}function Or(e,t,n,r,i,a){const s=e[n];if(null!=s){const e=M(s,"default");if(e&&void 0===r){const e=s.default;if(s.type!==Function&&k(e)){const{propsDefaults:a}=i;n in a?r=a[n]:(Vi(i),r=a[n]=e.call(null,t),Gi())}else r=e}s[0]&&(a&&!e?r=!1:!s[1]||""!==r&&r!==X(n)||(r=!0))}return r}function Nr(e,t,n=!1){const r=t.propsCache,i=r.get(e);if(i)return i;const a=e.props,s={},o=[];let l=!1;if(!k(e)){const r=e=>{l=!0;const[n,r]=Nr(e,t,!0);S(s,n),r&&o.push(...r)};!n&&t.mixins.length&&t.mixins.forEach(r),e.extends&&r(e.extends),e.mixins&&e.mixins.forEach(r)}if(!a&&!l)return O(e)&&r.set(e,v),v;if(E(a))for(let c=0;c<a.length;c++){const e=W(a[c]);Br(e)&&(s[e]=g)}else if(a)for(const c in a){const e=W(c);if(Br(e)){const t=a[c],n=s[e]=E(t)||k(t)?{type:t}:Object.assign({},t);if(n){const t=Fr(Boolean,n.type),r=Fr(String,n.type);n[0]=t>-1,n[1]=r<0||t<r,(t>-1||M(n,"default"))&&o.push(e)}}}const u=[s,o];return O(e)&&r.set(e,u),u}function Br(e){return"$"!==e[0]}function Ur(e){const t=e&&e.toString().match(/^\s*(function|class) (\w+)/);return t?t[2]:null===e?"null":""}function zr(e,t){return Ur(e)===Ur(t)}function Fr(e,t){return E(t)?t.findIndex((t=>zr(t,e))):k(t)&&zr(t,e)?0:-1}const Vr=e=>"_"===e[0]||"$stable"===e,Gr=e=>E(e)?e.map(ki):[ki(e)],Hr=(e,t,n)=>{if(t._n)return t;const r=vn(((...e)=>Gr(t(...e))),n);return r._c=!1,r},jr=(e,t,n)=>{const r=e._ctx;for(const i in e){if(Vr(i))continue;const n=e[i];if(k(n))t[i]=Hr(0,n,r);else if(null!=n){const e=Gr(n);t[i]=()=>e}}},Wr=(e,t)=>{const n=Gr(t);e.slots.default=()=>n},Yr=(e,t)=>{if(32&e.vnode.shapeFlag){const n=t._;n?(e.slots=xt(t),Q(t,"_",n)):jr(t,e.slots={})}else e.slots={},t&&Wr(e,t);Q(e.slots,wi,1)},$r=(e,t,n)=>{const{vnode:r,slots:i}=e;let a=!0,s=g;if(32&r.shapeFlag){const e=t._;e?n&&1===e?a=!1:(S(i,t),n||1!==e||delete i._):(a=!t.$stable,jr(t,i)),s=t}else t&&(Wr(e,t),s={default:1});if(a)for(const o in i)Vr(o)||o in s||delete i[o]};function Xr(){return{app:null,config:{isNativeTag:_,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let qr=0;function Kr(e,t){return function(n,r=null){k(n)||(n=Object.assign({},n)),null==r||O(r)||(r=null);const i=Xr(),a=new Set;let s=!1;const o=i.app={_uid:qr++,_component:n,_props:r,_container:null,_context:i,_instance:null,version:ra,get config(){return i.config},set config(e){},use:(e,...t)=>(a.has(e)||(e&&k(e.install)?(a.add(e),e.install(o,...t)):k(e)&&(a.add(e),e(o,...t))),o),mixin:e=>(i.mixins.includes(e)||i.mixins.push(e),o),component:(e,t)=>t?(i.components[e]=t,o):i.components[e],directive:(e,t)=>t?(i.directives[e]=t,o):i.directives[e],mount(a,l,u){if(!s){const c=Mi(n,r);return c.appContext=i,l&&t?t(c,a):e(c,a,u),s=!0,o._container=a,a.__vue_app__=o,qi(c.component)||c.component.proxy}},unmount(){s&&(e(null,o._container),delete o._container.__vue_app__)},provide:(e,t)=>(i.provides[e]=t,o)};return o}}function Zr(e,t,n,r,i=!1){if(E(e))return void e.forEach(((e,a)=>Zr(e,t&&(E(t)?t[a]:t),n,r,i)));if(Vn(r)&&!i)return;const a=4&r.shapeFlag?qi(r.component)||r.component.proxy:r.el,s=i?null:a,{i:o,r:l}=e,u=t&&t.r,c=o.refs===g?o.refs={}:o.refs,d=o.setupState;if(null!=u&&u!==l&&(D(u)?(c[u]=null,M(d,u)&&(d[u]=null)):Et(u)&&(u.value=null)),k(l))Gt(l,o,12,[s,c]);else{const t=D(l),r=Et(l);if(t||r){const o=()=>{if(e.f){const n=t?M(d,l)?d[l]:c[l]:l.value;i?E(n)&&C(n,a):E(n)?n.includes(a)||n.push(a):t?(c[l]=[a],M(d,l)&&(d[l]=c[l])):(l.value=[a],e.k&&(c[e.k]=l.value))}else t?(c[l]=s,M(d,l)&&(d[l]=s)):r&&(l.value=s,e.k&&(c[e.k]=s))};s?(o.id=-1,Jr(o,n)):o()}}}const Jr=function(e,t){var n;t&&t.pendingBranch?E(e)?t.effects.push(...e):t.effects.push(e):(E(n=e)?qt.push(...n):Kt&&Kt.includes(n,n.allowRecurse?Zt+1:Zt)||qt.push(n),nn())};function Qr(e){return function(e,t){re().__VUE__=!0;const{insert:n,remove:r,patchProp:i,createElement:a,createText:s,createComment:o,setText:l,setElementText:u,parentNode:c,nextSibling:d,setScopeId:h=y,insertStaticContent:p}=e,f=(e,t,n,r=null,i=null,a=null,s=!1,o=null,l=!!t.dynamicChildren)=>{if(e===t)return;e&&!xi(e,t)&&(r=K(e),H(e,i,a,!0),e=null),-2===t.patchFlag&&(l=!1,t.dynamicChildren=null);const{type:u,ref:c,shapeFlag:d}=t;switch(u){case ui:m(e,t,n,r);break;case ci:_(e,t,n,r);break;case di:null==e&&b(t,n,r,s);break;case li:L(e,t,n,r,i,a,s,o,l);break;default:1&d?S(e,t,n,r,i,a,s,o,l):6&d?k(e,t,n,r,i,a,s,o,l):(64&d||128&d)&&u.process(e,t,n,r,i,a,s,o,l,ee)}null!=c&&i&&Zr(c,e&&e.ref,a,t||e,!t)},m=(e,t,r,i)=>{if(null==e)n(t.el=s(t.children),r,i);else{const n=t.el=e.el;t.children!==e.children&&l(n,t.children)}},_=(e,t,r,i)=>{null==e?n(t.el=o(t.children||""),r,i):t.el=e.el},b=(e,t,n,r)=>{[e.el,e.anchor]=p(e.children,t,n,r,e.el,e.anchor)},x=({el:e,anchor:t},r,i)=>{let a;for(;e&&e!==t;)a=d(e),n(e,r,i),e=a;n(t,r,i)},w=({el:e,anchor:t})=>{let n;for(;e&&e!==t;)n=d(e),r(e),e=n;r(t)},S=(e,t,n,r,i,a,s,o,l)=>{s=s||"svg"===t.type,null==e?C(t,n,r,i,a,s,o,l):A(e,t,i,a,s,o,l)},C=(e,t,r,s,o,l,c,d)=>{let h,p;const{type:f,props:m,shapeFlag:g,transition:v,dirs:y}=e;if(h=e.el=a(e.type,l,m&&m.is,m),8&g?u(h,e.children):16&g&&E(e.children,h,null,s,o,l&&"foreignObject"!==f,c,d),y&&sr(e,null,s,"created"),T(h,e,e.scopeId,c,s),m){for(const t in m)"value"===t||G(t)||i(h,t,null,m[t],l,e.children,s,o,q);"value"in m&&i(h,"value",null,m.value),(p=m.onVnodeBeforeMount)&&Ni(p,s,e)}y&&sr(e,null,s,"beforeMount");const _=(!o||o&&!o.pendingBranch)&&v&&!v.persisted;_&&v.beforeEnter(h),n(h,t,r),((p=m&&m.onVnodeMounted)||_||y)&&Jr((()=>{p&&Ni(p,s,e),_&&v.enter(h),y&&sr(e,null,s,"mounted")}),o)},T=(e,t,n,r,i)=>{if(n&&h(e,n),r)for(let a=0;a<r.length;a++)h(e,r[a]);if(i){if(t===i.subTree){const t=i.vnode;T(e,t,t.scopeId,t.slotScopeIds,i.parent)}}},E=(e,t,n,r,i,a,s,o,l=0)=>{for(let u=l;u<e.length;u++){const l=e[u]=o?Di(e[u]):ki(e[u]);f(null,l,t,n,r,i,a,s,o)}},A=(e,t,n,r,a,s,o)=>{const l=t.el=e.el;let{patchFlag:c,dynamicChildren:d,dirs:h}=t;c|=16&e.patchFlag;const p=e.props||g,f=t.props||g;let m;n&&ei(n,!1),(m=f.onVnodeBeforeUpdate)&&Ni(m,n,t,e),h&&sr(t,e,n,"beforeUpdate"),n&&ei(n,!0);const v=a&&"foreignObject"!==t.type;if(d?P(e.dynamicChildren,d,l,n,r,v,s):o||U(e,t,l,null,n,r,v,s,!1),c>0){if(16&c)R(l,t,p,f,n,r,a);else if(2&c&&p.class!==f.class&&i(l,"class",null,f.class,a),4&c&&i(l,"style",p.style,f.style,a),8&c){const s=t.dynamicProps;for(let t=0;t<s.length;t++){const o=s[t],u=p[o],c=f[o];c===u&&"value"!==o||i(l,o,u,c,a,e.children,n,r,q)}}1&c&&e.children!==t.children&&u(l,t.children)}else o||null!=d||R(l,t,p,f,n,r,a);((m=f.onVnodeUpdated)||h)&&Jr((()=>{m&&Ni(m,n,t,e),h&&sr(t,e,n,"updated")}),r)},P=(e,t,n,r,i,a,s)=>{for(let o=0;o<t.length;o++){const l=e[o],u=t[o],d=l.el&&(l.type===li||!xi(l,u)||70&l.shapeFlag)?c(l.el):n;f(l,u,d,null,r,i,a,s,!0)}},R=(e,t,n,r,a,s,o)=>{if(n!==r){if(n!==g)for(const l in n)G(l)||l in r||i(e,l,n[l],null,o,t.children,a,s,q);for(const l in r){if(G(l))continue;const u=r[l],c=n[l];u!==c&&"value"!==l&&i(e,l,c,u,o,t.children,a,s,q)}"value"in r&&i(e,"value",n.value,r.value)}},L=(e,t,r,i,a,o,l,u,c)=>{const d=t.el=e?e.el:s(""),h=t.anchor=e?e.anchor:s("");let{patchFlag:p,dynamicChildren:f,slotScopeIds:m}=t;m&&(u=u?u.concat(m):m),null==e?(n(d,r,i),n(h,r,i),E(t.children,r,h,a,o,l,u,c)):p>0&&64&p&&f&&e.dynamicChildren?(P(e.dynamicChildren,f,r,a,o,l,u),(null!=t.key||a&&t===a.subTree)&&ti(e,t,!0)):U(e,t,r,h,a,o,l,u,c)},k=(e,t,n,r,i,a,s,o,l)=>{t.slotScopeIds=o,null==e?512&t.shapeFlag?i.ctx.activate(t,n,r,s,l):D(t,n,r,i,a,s,l):I(e,t,l)},D=(e,t,n,r,i,a,s)=>{const o=e.component=function(e,t,n){const r=e.type,i=(t?t.appContext:e.appContext)||Bi,a={uid:Ui++,vnode:e,type:r,parent:t,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,scope:new ae(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(i.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Nr(r,i),emitsOptions:cn(r,i),emit:null,emitted:null,propsDefaults:g,inheritAttrs:r.inheritAttrs,ctx:g,data:g,props:g,attrs:g,slots:g,refs:g,setupState:g,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};a.ctx={_:a},a.root=t?t.root:a,a.emit=un.bind(null,a),e.ce&&e.ce(a);return a}(e,r,i);if(Gn(e)&&(o.ctx.renderer=ee),function(e,t=!1){Wi=t;const{props:n,children:r}=e.vnode,i=Hi(e);(function(e,t,n,r=!1){const i={},a={};Q(a,wi,1),e.propsDefaults=Object.create(null),Ir(e,t,i,a);for(const s in e.propsOptions[0])s in i||(i[s]=void 0);n?e.props=r?i:ft(i):e.type.props?e.props=i:e.props=a,e.attrs=a})(e,n,i,t),Yr(e,r);const a=i?function(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=wt(new Proxy(e.ctx,wr));const{setup:r}=n;if(r){const n=e.setupContext=r.length>1?Xi(e):null;Vi(e),we();const i=Gt(r,e,0,[e.props,n]);if(Se(),Gi(),N(i)){if(i.then(Gi,Gi),t)return i.then((n=>{Yi(e,n,t)})).catch((t=>{jt(t,e,0)}));e.asyncDep=i}else Yi(e,i,t)}else $i(e,t)}(e,t):void 0;Wi=!1}(o),o.asyncDep){if(i&&i.registerDep(o,O),!e.el){const e=o.subTree=Mi(ci);_(null,e,t,n)}}else O(o,e,t,n,i,a,s)},I=(e,t,n)=>{const r=t.component=e.component;if(function(e,t,n){const{props:r,children:i,component:a}=e,{props:s,children:o,patchFlag:l}=t,u=a.emitsOptions;if(t.dirs||t.transition)return!0;if(!(n&&l>=0))return!(!i&&!o||o&&o.$stable)||r!==s&&(r?!s||xn(r,s,u):!!s);if(1024&l)return!0;if(16&l)return r?xn(r,s,u):!!s;if(8&l){const e=t.dynamicProps;for(let t=0;t<e.length;t++){const n=e[t];if(s[n]!==r[n]&&!dn(u,n))return!0}}return!1}(e,t,n)){if(r.asyncDep&&!r.asyncResolved)return void B(r,t,n);r.next=t,function(e){const t=$t.indexOf(e);t>Xt&&$t.splice(t,1)}(r.update),r.update()}else t.el=e.el,r.vnode=t},O=(e,t,n,r,i,a,s)=>{const o=()=>{if(e.isMounted){let t,{next:n,bu:r,u:o,parent:l,vnode:u}=e,d=n;ei(e,!1),n?(n.el=u.el,B(e,n,s)):n=u,r&&J(r),(t=n.props&&n.props.onVnodeBeforeUpdate)&&Ni(t,l,n,u),ei(e,!0);const h=yn(e),p=e.subTree;e.subTree=h,f(p,h,c(p.el),K(p),e,i,a),n.el=h.el,null===d&&function({vnode:e,parent:t},n){for(;t&&t.subTree===e;)(e=t.vnode).el=n,t=t.parent}(e,h.el),o&&Jr(o,i),(t=n.props&&n.props.onVnodeUpdated)&&Jr((()=>Ni(t,l,n,u)),i)}else{let s;const{el:o,props:l}=t,{bm:u,m:c,parent:d}=e,h=Vn(t);if(ei(e,!1),u&&J(u),!h&&(s=l&&l.onVnodeBeforeMount)&&Ni(s,d,t),ei(e,!0),o&&ne){const n=()=>{e.subTree=yn(e),ne(o,e.subTree,e,i,null)};h?t.type.__asyncLoader().then((()=>!e.isUnmounted&&n())):n()}else{const s=e.subTree=yn(e);f(null,s,n,r,e,i,a),t.el=s.el}if(c&&Jr(c,i),!h&&(s=l&&l.onVnodeMounted)){const e=t;Jr((()=>Ni(s,d,e)),i)}(256&t.shapeFlag||d&&Vn(d.vnode)&&256&d.vnode.shapeFlag)&&e.a&&Jr(e.a,i),e.isMounted=!0,t=n=r=null}},l=e.effect=new ye(o,(()=>tn(u)),e.scope),u=e.update=()=>l.run();u.id=e.uid,ei(e,!0),u()},B=(e,t,n)=>{t.component=e;const r=e.vnode.props;e.vnode=t,e.next=null,function(e,t,n,r){const{props:i,attrs:a,vnode:{patchFlag:s}}=e,o=xt(i),[l]=e.propsOptions;let u=!1;if(!(r||s>0)||16&s){let r;Ir(e,t,i,a)&&(u=!0);for(const a in o)t&&(M(t,a)||(r=X(a))!==a&&M(t,r))||(l?!n||void 0===n[a]&&void 0===n[r]||(i[a]=Or(l,o,a,void 0,e,!0)):delete i[a]);if(a!==o)for(const e in a)t&&M(t,e)||(delete a[e],u=!0)}else if(8&s){const n=e.vnode.dynamicProps;for(let r=0;r<n.length;r++){let s=n[r];if(dn(e.emitsOptions,s))continue;const c=t[s];if(l)if(M(a,s))c!==a[s]&&(a[s]=c,u=!0);else{const t=W(s);i[t]=Or(l,o,t,c,e,!1)}else c!==a[s]&&(a[s]=c,u=!0)}}u&&Me(e,"set","$attrs")}(e,t.props,r,n),$r(e,t.children,n),we(),rn(),Se()},U=(e,t,n,r,i,a,s,o,l=!1)=>{const c=e&&e.children,d=e?e.shapeFlag:0,h=t.children,{patchFlag:p,shapeFlag:f}=t;if(p>0){if(128&p)return void F(c,h,n,r,i,a,s,o,l);if(256&p)return void z(c,h,n,r,i,a,s,o,l)}8&f?(16&d&&q(c,i,a),h!==c&&u(n,h)):16&d?16&f?F(c,h,n,r,i,a,s,o,l):q(c,i,a,!0):(8&d&&u(n,""),16&f&&E(h,n,r,i,a,s,o,l))},z=(e,t,n,r,i,a,s,o,l)=>{t=t||v;const u=(e=e||v).length,c=t.length,d=Math.min(u,c);let h;for(h=0;h<d;h++){const r=t[h]=l?Di(t[h]):ki(t[h]);f(e[h],r,n,null,i,a,s,o,l)}u>c?q(e,i,a,!0,!1,d):E(t,n,r,i,a,s,o,l,d)},F=(e,t,n,r,i,a,s,o,l)=>{let u=0;const c=t.length;let d=e.length-1,h=c-1;for(;u<=d&&u<=h;){const r=e[u],c=t[u]=l?Di(t[u]):ki(t[u]);if(!xi(r,c))break;f(r,c,n,null,i,a,s,o,l),u++}for(;u<=d&&u<=h;){const r=e[d],u=t[h]=l?Di(t[h]):ki(t[h]);if(!xi(r,u))break;f(r,u,n,null,i,a,s,o,l),d--,h--}if(u>d){if(u<=h){const e=h+1,d=e<c?t[e].el:r;for(;u<=h;)f(null,t[u]=l?Di(t[u]):ki(t[u]),n,d,i,a,s,o,l),u++}}else if(u>h)for(;u<=d;)H(e[u],i,a,!0),u++;else{const p=u,m=u,g=new Map;for(u=m;u<=h;u++){const e=t[u]=l?Di(t[u]):ki(t[u]);null!=e.key&&g.set(e.key,u)}let y,_=0;const b=h-m+1;let x=!1,w=0;const S=new Array(b);for(u=0;u<b;u++)S[u]=0;for(u=p;u<=d;u++){const r=e[u];if(_>=b){H(r,i,a,!0);continue}let c;if(null!=r.key)c=g.get(r.key);else for(y=m;y<=h;y++)if(0===S[y-m]&&xi(r,t[y])){c=y;break}void 0===c?H(r,i,a,!0):(S[c-m]=u+1,c>=w?w=c:x=!0,f(r,t[c],n,null,i,a,s,o,l),_++)}const C=x?function(e){const t=e.slice(),n=[0];let r,i,a,s,o;const l=e.length;for(r=0;r<l;r++){const l=e[r];if(0!==l){if(i=n[n.length-1],e[i]<l){t[r]=i,n.push(r);continue}for(a=0,s=n.length-1;a<s;)o=a+s>>1,e[n[o]]<l?a=o+1:s=o;l<e[n[a]]&&(a>0&&(t[r]=n[a-1]),n[a]=r)}}a=n.length,s=n[a-1];for(;a-- >0;)n[a]=s,s=t[s];return n}(S):v;for(y=C.length-1,u=b-1;u>=0;u--){const e=m+u,d=t[e],h=e+1<c?t[e+1].el:r;0===S[u]?f(null,d,n,h,i,a,s,o,l):x&&(y<0||u!==C[y]?V(d,n,h,2):y--)}}},V=(e,t,r,i,a=null)=>{const{el:s,type:o,transition:l,children:u,shapeFlag:c}=e;if(6&c)return void V(e.component.subTree,t,r,i);if(128&c)return void e.suspense.move(t,r,i);if(64&c)return void o.move(e,t,r,ee);if(o===li){n(s,t,r);for(let e=0;e<u.length;e++)V(u[e],t,r,i);return void n(e.anchor,t,r)}if(o===di)return void x(e,t,r);if(2!==i&&1&c&&l)if(0===i)l.beforeEnter(s),n(s,t,r),Jr((()=>l.enter(s)),a);else{const{leave:e,delayLeave:i,afterLeave:a}=l,o=()=>n(s,t,r),u=()=>{e(s,(()=>{o(),a&&a()}))};i?i(s,o,u):u()}else n(s,t,r)},H=(e,t,n,r=!1,i=!1)=>{const{type:a,props:s,ref:o,children:l,dynamicChildren:u,shapeFlag:c,patchFlag:d,dirs:h}=e;if(null!=o&&Zr(o,null,n,e,!0),256&c)return void t.ctx.deactivate(e);const p=1&c&&h,f=!Vn(e);let m;if(f&&(m=s&&s.onVnodeBeforeUnmount)&&Ni(m,t,e),6&c)$(e.component,n,r);else{if(128&c)return void e.suspense.unmount(n,r);p&&sr(e,null,t,"beforeUnmount"),64&c?e.type.remove(e,t,n,i,ee,r):u&&(a!==li||d>0&&64&d)?q(u,t,n,!1,!0):(a===li&&384&d||!i&&16&c)&&q(l,t,n),r&&j(e)}(f&&(m=s&&s.onVnodeUnmounted)||p)&&Jr((()=>{m&&Ni(m,t,e),p&&sr(e,null,t,"unmounted")}),n)},j=e=>{const{type:t,el:n,anchor:i,transition:a}=e;if(t===li)return void Y(n,i);if(t===di)return void w(e);const s=()=>{r(n),a&&!a.persisted&&a.afterLeave&&a.afterLeave()};if(1&e.shapeFlag&&a&&!a.persisted){const{leave:t,delayLeave:r}=a,i=()=>t(n,s);r?r(e.el,s,i):i()}else s()},Y=(e,t)=>{let n;for(;e!==t;)n=d(e),r(e),e=n;r(t)},$=(e,t,n)=>{const{bum:r,scope:i,update:a,subTree:s,um:o}=e;r&&J(r),i.stop(),a&&(a.active=!1,H(s,e,t,n)),o&&Jr(o,t),Jr((()=>{e.isUnmounted=!0}),t),t&&t.pendingBranch&&!t.isUnmounted&&e.asyncDep&&!e.asyncResolved&&e.suspenseId===t.pendingId&&(t.deps--,0===t.deps&&t.resolve())},q=(e,t,n,r=!1,i=!1,a=0)=>{for(let s=a;s<e.length;s++)H(e[s],t,n,r,i)},K=e=>6&e.shapeFlag?K(e.component.subTree):128&e.shapeFlag?e.suspense.next():d(e.anchor||e.el),Z=(e,t,n)=>{null==e?t._vnode&&H(t._vnode,null,null,!0):f(t._vnode||null,e,t,null,null,null,n),rn(),an(),t._vnode=e},ee={p:f,um:H,m:V,r:j,mt:D,mc:E,pc:U,pbc:P,n:K,o:e};let te,ne;t&&([te,ne]=t(ee));return{render:Z,hydrate:te,createApp:Kr(Z,te)}}(e)}function ei({effect:e,update:t},n){e.allowRecurse=t.allowRecurse=n}function ti(e,t,n=!1){const r=e.children,i=t.children;if(E(r)&&E(i))for(let a=0;a<r.length;a++){const e=r[a];let t=i[a];1&t.shapeFlag&&!t.dynamicChildren&&((t.patchFlag<=0||32===t.patchFlag)&&(t=i[a]=Di(i[a]),t.el=e.el),n||ti(e,t)),t.type===ui&&(t.el=e.el)}}const ni=e=>e&&(e.disabled||""===e.disabled),ri=e=>"undefined"!=typeof SVGElement&&e instanceof SVGElement,ii=(e,t)=>{const n=e&&e.to;if(D(n)){if(t){return t(n)}return null}return n};function ai(e,t,n,{o:{insert:r},m:i},a=2){0===a&&r(e.targetAnchor,t,n);const{el:s,anchor:o,shapeFlag:l,children:u,props:c}=e,d=2===a;if(d&&r(s,t,n),(!d||ni(c))&&16&l)for(let h=0;h<u.length;h++)i(u[h],t,n,2);d&&r(o,t,n)}const si={__isTeleport:!0,process(e,t,n,r,i,a,s,o,l,u){const{mc:c,pc:d,pbc:h,o:{insert:p,querySelector:f,createText:m,createComment:g}}=u,v=ni(t.props);let{shapeFlag:y,children:_,dynamicChildren:b}=t;if(null==e){const e=t.el=m(""),u=t.anchor=m("");p(e,n,r),p(u,n,r);const d=t.target=ii(t.props,f),h=t.targetAnchor=m("");d&&(p(h,d),s=s||ri(d));const g=(e,t)=>{16&y&&c(_,e,t,i,a,s,o,l)};v?g(n,u):d&&g(d,h)}else{t.el=e.el;const r=t.anchor=e.anchor,c=t.target=e.target,p=t.targetAnchor=e.targetAnchor,m=ni(e.props),g=m?n:c,y=m?r:p;if(s=s||ri(c),b?(h(e.dynamicChildren,b,g,i,a,s,o),ti(e,t,!0)):l||d(e,t,g,y,i,a,s,o,!1),v)m||ai(t,n,r,u,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const e=t.target=ii(t.props,f);e&&ai(t,e,null,u,0)}else m&&ai(t,c,p,u,1)}oi(t)},remove(e,t,n,r,{um:i,o:{remove:a}},s){const{shapeFlag:o,children:l,anchor:u,targetAnchor:c,target:d,props:h}=e;if(d&&a(c),(s||!ni(h))&&(a(u),16&o))for(let p=0;p<l.length;p++){const e=l[p];i(e,t,n,!0,!!e.dynamicChildren)}},move:ai,hydrate:function(e,t,n,r,i,a,{o:{nextSibling:s,parentNode:o,querySelector:l}},u){const c=t.target=ii(t.props,l);if(c){const l=c._lpa||c.firstChild;if(16&t.shapeFlag)if(ni(t.props))t.anchor=u(s(e),t,o(e),n,r,i,a),t.targetAnchor=l;else{t.anchor=s(e);let o=l;for(;o;)if(o=s(o),o&&8===o.nodeType&&"teleport anchor"===o.data){t.targetAnchor=o,c._lpa=t.targetAnchor&&s(t.targetAnchor);break}u(l,t,c,n,r,i,a)}oi(t)}return t.anchor&&s(t.anchor)}};function oi(e){const t=e.ctx;if(t&&t.ut){let n=e.children[0].el;for(;n!==e.targetAnchor;)1===n.nodeType&&n.setAttribute("data-v-owner",t.uid),n=n.nextSibling;t.ut()}}const li=Symbol(void 0),ui=Symbol(void 0),ci=Symbol(void 0),di=Symbol(void 0),hi=[];let pi=null;function fi(e=!1){hi.push(pi=e?null:[])}let mi=1;function gi(e){mi+=e}function vi(e){return e.dynamicChildren=mi>0?pi||v:null,hi.pop(),pi=hi[hi.length-1]||null,mi>0&&pi&&pi.push(e),e}function yi(e,t,n,r,i,a){return vi(Ti(e,t,n,r,i,a,!0))}function _i(e,t,n,r,i){return vi(Mi(e,t,n,r,i,!0))}function bi(e){return!!e&&!0===e.__v_isVNode}function xi(e,t){return e.type===t.type&&e.key===t.key}const wi="__vInternal",Si=({key:e})=>null!=e?e:null,Ci=({ref:e,ref_key:t,ref_for:n})=>null!=e?D(e)||Et(e)||k(e)?{i:hn,r:e,k:t,f:!!n}:e:null;function Ti(e,t=null,n=null,r=0,i=null,a=(e===li?0:1),s=!1,o=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Si(t),ref:t&&Ci(t),scopeId:pn,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:r,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:hn};return o?(Ii(l,n),128&a&&e.normalize(l)):n&&(l.shapeFlag|=D(n)?8:16),mi>0&&!s&&pi&&(l.patchFlag>0||6&a)&&32!==l.patchFlag&&pi.push(l),l}const Mi=function(e,t=null,n=null,i=0,a=null,s=!1){e&&e!==cr||(e=ci);if(bi(e)){const r=Ai(e,t,!0);return n&&Ii(r,n),mi>0&&!s&&pi&&(6&r.shapeFlag?pi[pi.indexOf(e)]=r:pi.push(r)),r.patchFlag|=-2,r}o=e,k(o)&&"__vccOpts"in o&&(e=e.__vccOpts);var o;if(t){t=Ei(t);let{class:e,style:n}=t;e&&!D(e)&&(t.class=l(e)),O(n)&&(bt(n)&&!E(n)&&(n=S({},n)),t.style=r(n))}const u=D(e)?1:(e=>e.__isSuspense)(e)?128:(e=>e.__isTeleport)(e)?64:O(e)?4:k(e)?2:0;return Ti(e,t,n,i,a,u,s,!0)};function Ei(e){return e?bt(e)||wi in e?S({},e):e:null}function Ai(e,t,n=!1){const{props:r,ref:i,patchFlag:a,children:s}=e,o=t?Oi(r||{},t):r;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:o,key:o&&Si(o),ref:t&&t.ref?n&&i?E(i)?i.concat(Ci(t)):[i,Ci(t)]:Ci(t):i,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:s,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==li?-1===a?16:16|a:a,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Ai(e.ssContent),ssFallback:e.ssFallback&&Ai(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce}}function Pi(e=" ",t=0){return Mi(ui,null,e,t)}function Ri(e,t){const n=Mi(di,null,e);return n.staticCount=t,n}function Li(e="",t=!1){return t?(fi(),_i(ci,null,e)):Mi(ci,null,e)}function ki(e){return null==e||"boolean"==typeof e?Mi(ci):E(e)?Mi(li,null,e.slice()):"object"==typeof e?Di(e):Mi(ui,null,String(e))}function Di(e){return null===e.el&&-1!==e.patchFlag||e.memo?e:Ai(e)}function Ii(e,t){let n=0;const{shapeFlag:r}=e;if(null==t)t=null;else if(E(t))n=16;else if("object"==typeof t){if(65&r){const n=t.default;return void(n&&(n._c&&(n._d=!1),Ii(e,n()),n._c&&(n._d=!0)))}{n=32;const r=t._;r||wi in t?3===r&&hn&&(1===hn.slots._?t._=1:(t._=2,e.patchFlag|=1024)):t._ctx=hn}}else k(t)?(t={default:t,_ctx:hn},n=32):(t=String(t),64&r?(n=16,t=[Pi(t)]):n=8);e.children=t,e.shapeFlag|=n}function Oi(...e){const t={};for(let n=0;n<e.length;n++){const i=e[n];for(const e in i)if("class"===e)t.class!==i.class&&(t.class=l([t.class,i.class]));else if("style"===e)t.style=r([t.style,i.style]);else if(x(e)){const n=t[e],r=i[e];!r||n===r||E(n)&&n.includes(r)||(t[e]=n?[].concat(n,r):r)}else""!==e&&(t[e]=i[e])}return t}function Ni(e,t,n,r=null){Ht(e,t,7,[n,r])}const Bi=Xr();let Ui=0;let zi=null;const Fi=()=>zi||hn,Vi=e=>{zi=e,e.scope.on()},Gi=()=>{zi&&zi.scope.off(),zi=null};function Hi(e){return 4&e.vnode.shapeFlag}let ji,Wi=!1;function Yi(e,t,n){k(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:O(t)&&(e.setupState=Ot(t)),$i(e,n)}function $i(e,t,n){const r=e.type;if(!e.render){if(!t&&ji&&!r.render){const t=r.template||Er(e).template;if(t){const{isCustomElement:n,compilerOptions:i}=e.appContext.config,{delimiters:a,compilerOptions:s}=r,o=S(S({isCustomElement:n,delimiters:a},i),s);r.render=ji(t,o)}}e.render=r.render||y}Vi(e),we(),Cr(e),Se(),Gi()}function Xi(e){const t=t=>{e.exposed=t||{}};let n;return{get attrs(){return n||(n=function(e){return new Proxy(e.attrs,{get:(t,n)=>(Ce(e,0,"$attrs"),t[n])})}(e))},slots:e.slots,emit:e.emit,expose:t}}function qi(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(Ot(wt(e.exposed)),{get:(t,n)=>n in t?t[n]:n in br?br[n](e):void 0,has:(e,t)=>t in e||t in br}))}const Ki=(e,t)=>Vt(e,0,Wi);function Zi(){return Qi().slots}function Ji(){return Qi().attrs}function Qi(){const e=Fi();return e.setupContext||(e.setupContext=Xi(e))}function ea(e,t,n){const r=arguments.length;return 2===r?O(t)&&!E(t)?bi(t)?Mi(e,null,[t]):Mi(e,t):Mi(e,null,t):(r>3?n=Array.prototype.slice.call(arguments,2):3===r&&bi(n)&&(n=[n]),Mi(e,t,n))}const ta=Symbol(""),na=()=>Sn(ta),ra="3.2.47",ia="undefined"!=typeof document?document:null,aa=ia&&ia.createElement("template"),sa={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,r)=>{const i=t?ia.createElementNS("http://www.w3.org/2000/svg",e):ia.createElement(e,n?{is:n}:void 0);return"select"===e&&r&&null!=r.multiple&&i.setAttribute("multiple",r.multiple),i},createText:e=>ia.createTextNode(e),createComment:e=>ia.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>ia.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,r,i,a){const s=n?n.previousSibling:t.lastChild;if(i&&(i===a||i.nextSibling))for(;t.insertBefore(i.cloneNode(!0),n),i!==a&&(i=i.nextSibling););else{aa.innerHTML=r?`<svg>${e}</svg>`:e;const i=aa.content;if(r){const e=i.firstChild;for(;e.firstChild;)i.appendChild(e.firstChild);i.removeChild(e)}t.insertBefore(i,n)}return[s?s.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}};const oa=/\s*!important$/;function la(e,t,n){if(E(n))n.forEach((n=>la(e,t,n)));else if(null==n&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const r=function(e,t){const n=ca[t];if(n)return n;let r=W(t);if("filter"!==r&&r in e)return ca[t]=r;r=q(r);for(let i=0;i<ua.length;i++){const n=ua[i]+r;if(n in e)return ca[t]=n}return t}(e,t);oa.test(n)?e.setProperty(X(r),n.replace(oa,""),"important"):e[r]=n}}const ua=["Webkit","Moz","ms"],ca={};const da="http://www.w3.org/1999/xlink";function ha(e,t,n,r){e.addEventListener(t,n,r)}function pa(e,t,n,r,i=null){const a=e._vei||(e._vei={}),s=a[t];if(r&&s)s.value=r;else{const[n,o]=function(e){let t;if(fa.test(e)){let n;for(t={};n=e.match(fa);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}const n=":"===e[2]?e.slice(3):X(e.slice(2));return[n,t]}(t);if(r){const s=a[t]=function(e,t){const n=e=>{if(e._vts){if(e._vts<=n.attached)return}else e._vts=Date.now();Ht(function(e,t){if(E(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map((e=>t=>!t._stopped&&e&&e(t)))}return t}(e,n.value),t,5,[e])};return n.value=e,n.attached=va(),n}(r,i);ha(e,n,s,o)}else s&&(!function(e,t,n,r){e.removeEventListener(t,n,r)}(e,n,s,o),a[t]=void 0)}}const fa=/(?:Once|Passive|Capture)$/;let ma=0;const ga=Promise.resolve(),va=()=>ma||(ga.then((()=>ma=0)),ma=Date.now());const ya=/^on[a-z]/;const _a="transition",ba="animation",xa=(e,{slots:t})=>ea(Dn,Ma(e),t);xa.displayName="Transition";const wa={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Sa=xa.props=S({},Dn.props,wa),Ca=(e,t=[])=>{E(e)?e.forEach((e=>e(...t))):e&&e(...t)},Ta=e=>!!e&&(E(e)?e.some((e=>e.length>1)):e.length>1);function Ma(e){const t={};for(const S in e)S in wa||(t[S]=e[S]);if(!1===e.css)return t;const{name:n="v",type:r,duration:i,enterFromClass:a=`${n}-enter-from`,enterActiveClass:s=`${n}-enter-active`,enterToClass:o=`${n}-enter-to`,appearFromClass:l=a,appearActiveClass:u=s,appearToClass:c=o,leaveFromClass:d=`${n}-leave-from`,leaveActiveClass:h=`${n}-leave-active`,leaveToClass:p=`${n}-leave-to`}=e,f=function(e){if(null==e)return null;if(O(e))return[Ea(e.enter),Ea(e.leave)];{const t=Ea(e);return[t,t]}}(i),m=f&&f[0],g=f&&f[1],{onBeforeEnter:v,onEnter:y,onEnterCancelled:_,onLeave:b,onLeaveCancelled:x,onBeforeAppear:w=v,onAppear:C=y,onAppearCancelled:T=_}=t,M=(e,t,n)=>{Pa(e,t?c:o),Pa(e,t?u:s),n&&n()},E=(e,t)=>{e._isLeaving=!1,Pa(e,d),Pa(e,p),Pa(e,h),t&&t()},A=e=>(t,n)=>{const i=e?C:y,s=()=>M(t,e,n);Ca(i,[t,s]),Ra((()=>{Pa(t,e?l:a),Aa(t,e?c:o),Ta(i)||ka(t,r,m,s)}))};return S(t,{onBeforeEnter(e){Ca(v,[e]),Aa(e,a),Aa(e,s)},onBeforeAppear(e){Ca(w,[e]),Aa(e,l),Aa(e,u)},onEnter:A(!1),onAppear:A(!0),onLeave(e,t){e._isLeaving=!0;const n=()=>E(e,t);Aa(e,d),Na(),Aa(e,h),Ra((()=>{e._isLeaving&&(Pa(e,d),Aa(e,p),Ta(b)||ka(e,r,g,n))})),Ca(b,[e,n])},onEnterCancelled(e){M(e,!1),Ca(_,[e])},onAppearCancelled(e){M(e,!0),Ca(T,[e])},onLeaveCancelled(e){E(e),Ca(x,[e])}})}function Ea(e){return te(e)}function Aa(e,t){t.split(/\s+/).forEach((t=>t&&e.classList.add(t))),(e._vtc||(e._vtc=new Set)).add(t)}function Pa(e,t){t.split(/\s+/).forEach((t=>t&&e.classList.remove(t)));const{_vtc:n}=e;n&&(n.delete(t),n.size||(e._vtc=void 0))}function Ra(e){requestAnimationFrame((()=>{requestAnimationFrame(e)}))}let La=0;function ka(e,t,n,r){const i=e._endId=++La,a=()=>{i===e._endId&&r()};if(n)return setTimeout(a,n);const{type:s,timeout:o,propCount:l}=Da(e,t);if(!s)return r();const u=s+"end";let c=0;const d=()=>{e.removeEventListener(u,h),a()},h=t=>{t.target===e&&++c>=l&&d()};setTimeout((()=>{c<l&&d()}),o+1),e.addEventListener(u,h)}function Da(e,t){const n=window.getComputedStyle(e),r=e=>(n[e]||"").split(", "),i=r(`${_a}Delay`),a=r(`${_a}Duration`),s=Ia(i,a),o=r(`${ba}Delay`),l=r(`${ba}Duration`),u=Ia(o,l);let c=null,d=0,h=0;t===_a?s>0&&(c=_a,d=s,h=a.length):t===ba?u>0&&(c=ba,d=u,h=l.length):(d=Math.max(s,u),c=d>0?s>u?_a:ba:null,h=c?c===_a?a.length:l.length:0);return{type:c,timeout:d,propCount:h,hasTransform:c===_a&&/\b(transform|all)(,|$)/.test(r(`${_a}Property`).toString())}}function Ia(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map(((t,n)=>Oa(t)+Oa(e[n]))))}function Oa(e){return 1e3*Number(e.slice(0,-1).replace(",","."))}function Na(){return document.body.offsetHeight}const Ba=new WeakMap,Ua=new WeakMap,za={name:"TransitionGroup",props:S({},Sa,{tag:String,moveClass:String}),setup(e,{slots:t}){const n=Fi(),r=Ln();let i,a;return Jn((()=>{if(!i.length)return;const t=e.moveClass||`${e.name||"v"}-move`;if(!function(e,t,n){const r=e.cloneNode();e._vtc&&e._vtc.forEach((e=>{e.split(/\s+/).forEach((e=>e&&r.classList.remove(e)))}));n.split(/\s+/).forEach((e=>e&&r.classList.add(e))),r.style.display="none";const i=1===t.nodeType?t:t.parentNode;i.appendChild(r);const{hasTransform:a}=Da(r);return i.removeChild(r),a}(i[0].el,n.vnode.el,t))return;i.forEach(Va),i.forEach(Ga);const r=i.filter(Ha);Na(),r.forEach((e=>{const n=e.el,r=n.style;Aa(n,t),r.transform=r.webkitTransform=r.transitionDuration="";const i=n._moveCb=e=>{e&&e.target!==n||e&&!/transform$/.test(e.propertyName)||(n.removeEventListener("transitionend",i),n._moveCb=null,Pa(n,t))};n.addEventListener("transitionend",i)}))})),()=>{const s=xt(e),o=Ma(s);let l=s.tag||li;i=a,a=t.default?zn(t.default()):[];for(let e=0;e<a.length;e++){const t=a[e];null!=t.key&&Un(t,On(t,o,r,n))}if(i)for(let e=0;e<i.length;e++){const t=i[e];Un(t,On(t,o,r,n)),Ba.set(t,t.el.getBoundingClientRect())}return Mi(l,null,a)}}},Fa=za;function Va(e){const t=e.el;t._moveCb&&t._moveCb(),t._enterCb&&t._enterCb()}function Ga(e){Ua.set(e,e.el.getBoundingClientRect())}function Ha(e){const t=Ba.get(e),n=Ua.get(e),r=t.left-n.left,i=t.top-n.top;if(r||i){const t=e.el.style;return t.transform=t.webkitTransform=`translate(${r}px,${i}px)`,t.transitionDuration="0s",e}}const ja=e=>{const t=e.props["onUpdate:modelValue"]||!1;return E(t)?e=>J(t,e):t};function Wa(e){e.target.composing=!0}function Ya(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const $a={created(e,{modifiers:{lazy:t,trim:n,number:r}},i){e._assign=ja(i);const a=r||i.props&&"number"===i.props.type;ha(e,t?"change":"input",(t=>{if(t.target.composing)return;let r=e.value;n&&(r=r.trim()),a&&(r=ee(r)),e._assign(r)})),n&&ha(e,"change",(()=>{e.value=e.value.trim()})),t||(ha(e,"compositionstart",Wa),ha(e,"compositionend",Ya),ha(e,"change",Ya))},mounted(e,{value:t}){e.value=null==t?"":t},beforeUpdate(e,{value:t,modifiers:{lazy:n,trim:r,number:i}},a){if(e._assign=ja(a),e.composing)return;if(document.activeElement===e&&"range"!==e.type){if(n)return;if(r&&e.value.trim()===t)return;if((i||"number"===e.type)&&ee(e.value)===t)return}const s=null==t?"":t;e.value!==s&&(e.value=s)}},Xa={deep:!0,created(e,t,n){e._assign=ja(n),ha(e,"change",(()=>{const t=e._modelValue,n=Za(e),r=e.checked,i=e._assign;if(E(t)){const e=p(t,n),a=-1!==e;if(r&&!a)i(t.concat(n));else if(!r&&a){const n=[...t];n.splice(e,1),i(n)}}else if(P(t)){const e=new Set(t);r?e.add(n):e.delete(n),i(e)}else i(Ja(e,r))}))},mounted:qa,beforeUpdate(e,t,n){e._assign=ja(n),qa(e,t,n)}};function qa(e,{value:t,oldValue:n},r){e._modelValue=t,E(t)?e.checked=p(t,r.props.value)>-1:P(t)?e.checked=t.has(r.props.value):t!==n&&(e.checked=h(t,Ja(e,!0)))}const Ka={created(e,{value:t},n){e.checked=h(t,n.props.value),e._assign=ja(n),ha(e,"change",(()=>{e._assign(Za(e))}))},beforeUpdate(e,{value:t,oldValue:n},r){e._assign=ja(r),t!==n&&(e.checked=h(t,r.props.value))}};function Za(e){return"_value"in e?e._value:e.value}function Ja(e,t){const n=t?"_trueValue":"_falseValue";return n in e?e[n]:t}const Qa=["ctrl","shift","alt","meta"],es={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&0!==e.button,middle:e=>"button"in e&&1!==e.button,right:e=>"button"in e&&2!==e.button,exact:(e,t)=>Qa.some((n=>e[`${n}Key`]&&!t.includes(n)))},ts=(e,t)=>(n,...r)=>{for(let e=0;e<t.length;e++){const r=es[t[e]];if(r&&r(n,t))return}return e(n,...r)},ns={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},rs=(e,t)=>n=>{if(!("key"in n))return;const r=X(n.key);return t.some((e=>e===r||ns[e]===r))?e(n):void 0},is={beforeMount(e,{value:t},{transition:n}){e._vod="none"===e.style.display?"":e.style.display,n&&t?n.beforeEnter(e):as(e,t)},mounted(e,{value:t},{transition:n}){n&&t&&n.enter(e)},updated(e,{value:t,oldValue:n},{transition:r}){!t!=!n&&(r?t?(r.beforeEnter(e),as(e,!0),r.enter(e)):r.leave(e,(()=>{as(e,!1)})):as(e,t))},beforeUnmount(e,{value:t}){as(e,t)}};function as(e,t){e.style.display=t?e._vod:"none"}const ss=S({patchProp:(e,t,n,r,i=!1,a,s,o,l)=>{"class"===t?function(e,t,n){const r=e._vtc;r&&(t=(t?[t,...r]:[...r]).join(" ")),null==t?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}(e,r,i):"style"===t?function(e,t,n){const r=e.style,i=D(n);if(n&&!i){if(t&&!D(t))for(const e in t)null==n[e]&&la(r,e,"");for(const e in n)la(r,e,n[e])}else{const a=r.display;i?t!==n&&(r.cssText=n):t&&e.removeAttribute("style"),"_vod"in e&&(r.display=a)}}(e,n,r):x(t)?w(t)||pa(e,t,0,r,s):("."===t[0]?(t=t.slice(1),1):"^"===t[0]?(t=t.slice(1),0):function(e,t,n,r){if(r)return"innerHTML"===t||"textContent"===t||!!(t in e&&ya.test(t)&&k(n));if("spellcheck"===t||"draggable"===t||"translate"===t)return!1;if("form"===t)return!1;if("list"===t&&"INPUT"===e.tagName)return!1;if("type"===t&&"TEXTAREA"===e.tagName)return!1;if(ya.test(t)&&D(n))return!1;return t in e}(e,t,r,i))?function(e,t,n,r,i,a,s){if("innerHTML"===t||"textContent"===t)return r&&s(r,i,a),void(e[t]=null==n?"":n);if("value"===t&&"PROGRESS"!==e.tagName&&!e.tagName.includes("-")){e._value=n;const r=null==n?"":n;return e.value===r&&"OPTION"!==e.tagName||(e.value=r),void(null==n&&e.removeAttribute(t))}let o=!1;if(""===n||null==n){const r=typeof e[t];"boolean"===r?n=d(n):null==n&&"string"===r?(n="",o=!0):"number"===r&&(n=0,o=!0)}try{e[t]=n}catch(zA){}o&&e.removeAttribute(t)}(e,t,r,a,s,o,l):("true-value"===t?e._trueValue=r:"false-value"===t&&(e._falseValue=r),function(e,t,n,r,i){if(r&&t.startsWith("xlink:"))null==n?e.removeAttributeNS(da,t.slice(6,t.length)):e.setAttributeNS(da,t,n);else{const r=c(t);null==n||r&&!d(n)?e.removeAttribute(t):e.setAttribute(t,r?"":n)}}(e,t,r,i))}},sa);let os;function ls(){return os||(os=Qr(ss))}const us=(...e)=>{ls().render(...e)},cs=(...e)=>{const t=ls().createApp(...e),{mount:n}=t;return t.mount=e=>{const r=function(e){if(D(e)){return document.querySelector(e)}return e}(e);if(!r)return;const i=t._component;k(i)||i.render||i.template||(i.template=r.innerHTML),r.innerHTML="";const a=n(r,!1,r instanceof SVGElement);return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),a},t};const ds=e=>(mn("data-v-b5e0d153"),e=e(),gn(),e),hs={class:"relative w-full h-full common-layout"},ps={class:"top-0 w-full pl-10 pr-10 border-b-2 flxed"},fs=ds((()=>Ti("a",{href:"/"},[Ti("span",{class:"text-[30px] font-[800] text-[#1fb5ee]"}," JHAYES ")],-1))),ms=ds((()=>Ti("div",{class:"flex-grow"},null,-1))),gs=(e,t)=>{const n=e.__vccOpts||e;for(const[r,i]of t)n[r]=i;return n},vs=gs(Fn({__name:"App",setup(e){const t=At("0"),n=(e,t)=>{console.log(e,t)};return At({JHAYESGIS:[{id:1,title:"Does drinking coffee make you smarter?",date:"5h ago",commentCount:5,shareCount:2},{id:2,title:"So you've bought coffee... now what?",date:"2h ago",commentCount:3,shareCount:2}],JHAYESGL:[{id:1,title:"Is tech making coffee better or worse?",date:"Jan 7",commentCount:29,shareCount:16},{id:2,title:"The most innovative things happening in coffee",date:"Mar 19",commentCount:24,shareCount:12}],JHAYES2D:[{id:1,title:"Ask Me Anything: 10 answers to your questions about coffee",date:"2d ago",commentCount:9,shareCount:5},{id:2,title:"The worst advice we've ever heard about coffee",date:"4d ago",commentCount:1,shareCount:2}]}),At(["1","2","3","4"]),Kn((()=>{})),(e,r)=>{const i=ur("el-menu-item"),a=ur("el-menu"),s=ur("router-view");return fi(),yi("div",hs,[ar(Ti("div",ps,[Mi(a,{"default-active":t.value,class:"el-menu-demo",mode:"horizontal",ellipsis:!1,onSelect:n,router:!0},{default:vn((()=>[Mi(i,{class:"font-bold"},{default:vn((()=>[fs])),_:1}),ms,Mi(i,{index:"/JHAYESGL"},{default:vn((()=>[Pi(" JHAYESGL ")])),_:1}),Mi(i,{index:"/JHAYES3D"},{default:vn((()=>[Pi("JHAYES3D")])),_:1}),Mi(i,{index:"/JHAYES2D"},{default:vn((()=>[Pi("JHAYES2D")])),_:1}),Mi(i,{index:"/JHAYESGPU"},{default:vn((()=>[Pi("JHAYESGPU")])),_:1}),Mi(i,{index:"/JHAYESLAB"},{default:vn((()=>[Pi("实验室")])),_:1})])),_:1},8,["default-active"])],512),[[is,e.$route.meta.show]]),Mi(s)])}}}),[["__scopeId","data-v-b5e0d153"]]),ys=e=>Array.from(e.querySelectorAll('a[href],button:not([disabled]),button:not([hidden]),:not([tabindex="-1"]),input:not([disabled]),input:not([type="hidden"]),select:not([disabled]),textarea:not([disabled])')).filter((e=>_s(e)&&(e=>"fixed"!==getComputedStyle(e).position&&null!==e.offsetParent)(e))),_s=e=>{if(e.tabIndex>0||0===e.tabIndex&&null!==e.getAttribute("tabIndex"))return!0;if(e.disabled)return!1;switch(e.nodeName){case"A":return!!e.href&&"ignore"!==e.rel;case"INPUT":return!("hidden"===e.type||"file"===e.type);case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}},bs=function(e,t,...n){let r;r=t.includes("mouse")||t.includes("click")?"MouseEvents":t.includes("key")?"KeyboardEvent":"HTMLEvents";const i=document.createEvent(r);return i.initEvent(t,...n),e.dispatchEvent(i),e},xs=e=>!e.getAttribute("aria-owns"),ws=(e,t,n)=>{const{parentNode:r}=e;if(!r)return null;const i=r.querySelectorAll(n);return i[Array.prototype.indexOf.call(i,e)+t]||null},Ss=e=>{e&&(e.focus(),!xs(e)&&e.click())},Cs=(e,t,{checkForDefaultPrevented:n=!0}={})=>r=>{const i=null==e?void 0:e(r);if(!1===n||!i)return null==t?void 0:t(r)},Ts=e=>t=>"mouse"===t.pointerType?e(t):void 0;var Ms,Es=Object.defineProperty,As=Object.defineProperties,Ps=Object.getOwnPropertyDescriptors,Rs=Object.getOwnPropertySymbols,Ls=Object.prototype.hasOwnProperty,ks=Object.prototype.propertyIsEnumerable,Ds=(e,t,n)=>t in e?Es(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;function Is(e,t){var n;const r=Pt();var i,a;return Cn((()=>{r.value=e()}),(i=((e,t)=>{for(var n in t||(t={}))Ls.call(t,n)&&Ds(e,n,t[n]);if(Rs)for(var n of Rs(t))ks.call(t,n)&&Ds(e,n,t[n]);return e})({},t),a={flush:null!=(n=null==t?void 0:t.flush)?n:"sync"},As(i,Ps(a)))),mt(r)}const Os="undefined"!=typeof window,Ns=e=>"boolean"==typeof e,Bs=e=>"number"==typeof e,Us=e=>"string"==typeof e,zs=()=>{},Fs=Os&&(null==(Ms=null==window?void 0:window.navigator)?void 0:Ms.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function Vs(e){return"function"==typeof e?e():Dt(e)}function Gs(e,t){return function(...n){return new Promise(((r,i)=>{Promise.resolve(e((()=>t.apply(this,n)),{fn:t,thisArg:this,args:n})).then(r).catch(i)}))}}function Hs(e){return!!se()&&(oe(e),!0)}function js(e,t=200,n={}){return Gs(function(e,t={}){let n,r,i=zs;const a=e=>{clearTimeout(e),i(),i=zs};return s=>{const o=Vs(e),l=Vs(t.maxWait);return n&&a(n),o<=0||void 0!==l&&l<=0?(r&&(a(r),r=null),Promise.resolve(s())):new Promise(((e,u)=>{i=t.rejectOnCancel?u:e,l&&!r&&(r=setTimeout((()=>{n&&a(n),r=null,e(s())}),l)),n=setTimeout((()=>{r&&a(r),r=null,e(s())}),o)}))}}(t,n),e)}function Ws(e,t=200,n=!1,r=!0,i=!1){return Gs(function(e,t=!0,n=!0,r=!1){let i,a,s=0,o=!0,l=zs;const u=()=>{i&&(clearTimeout(i),i=void 0,l(),l=zs)};return c=>{const d=Vs(e),h=Date.now()-s,p=()=>a=c();return u(),d<=0?(s=Date.now(),p()):(h>d&&(n||!o)?(s=Date.now(),p()):t&&(a=new Promise(((e,t)=>{l=r?t:e,i=setTimeout((()=>{s=Date.now(),o=!0,e(p()),u()}),Math.max(0,d-h))}))),n||i||(i=setTimeout((()=>o=!0),d)),o=!1,a)}}(t,n,r,i),e)}function Ys(e,t=!0){Fi()?Kn(e):t?e():en(e)}function $s(e,t,n={}){const{immediate:r=!0}=n,i=At(!1);let a=null;function s(){a&&(clearTimeout(a),a=null)}function o(){i.value=!1,s()}function l(...n){s(),i.value=!0,a=setTimeout((()=>{i.value=!1,a=null,e(...n)}),Vs(t))}return r&&(i.value=!0,Os&&l()),Hs(o),{isPending:mt(i),start:l,stop:o}}function Xs(e){var t;const n=Vs(e);return null!=(t=null==n?void 0:n.$el)?t:n}const qs=Os?window:void 0,Ks=Os?window.document:void 0;function Zs(...e){let t,n,r,i;if(Us(e[0])||Array.isArray(e[0])?([n,r,i]=e,t=qs):[t,n,r,i]=e,!t)return zs;Array.isArray(n)||(n=[n]),Array.isArray(r)||(r=[r]);const a=[],s=()=>{a.forEach((e=>e())),a.length=0},o=Mn((()=>[Xs(t),Vs(i)]),(([e,t])=>{s(),e&&a.push(...n.flatMap((n=>r.map((r=>((e,t,n,r)=>(e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)))(e,n,r,t))))))}),{immediate:!0,flush:"post"}),l=()=>{o(),s()};return Hs(l),l}let Js=!1;function Qs(e,t,n={}){const{window:r=qs,ignore:i=[],capture:a=!0,detectIframe:s=!1}=n;if(!r)return;Fs&&!Js&&(Js=!0,Array.from(r.document.body.children).forEach((e=>e.addEventListener("click",zs))));let o=!0;const l=e=>i.some((t=>{if("string"==typeof t)return Array.from(r.document.querySelectorAll(t)).some((t=>t===e.target||e.composedPath().includes(t)));{const n=Xs(t);return n&&(e.target===n||e.composedPath().includes(n))}})),u=[Zs(r,"click",(n=>{const r=Xs(e);r&&r!==n.target&&!n.composedPath().includes(r)&&(0===n.detail&&(o=!l(n)),o?t(n):o=!0)}),{passive:!0,capture:a}),Zs(r,"pointerdown",(t=>{const n=Xs(e);n&&(o=!t.composedPath().includes(n)&&!l(t))}),{passive:!0}),s&&Zs(r,"blur",(n=>{var i;const a=Xs(e);"IFRAME"!==(null==(i=r.document.activeElement)?void 0:i.tagName)||(null==a?void 0:a.contains(r.document.activeElement))||t(n)}))].filter(Boolean);return()=>u.forEach((e=>e()))}const eo="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},to="__vueuse_ssr_handlers__";eo[to]=eo[to]||{};var no,ro,io=Object.getOwnPropertySymbols,ao=Object.prototype.hasOwnProperty,so=Object.prototype.propertyIsEnumerable,oo=(e,t)=>{var n={};for(var r in e)ao.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&io)for(var r of io(e))t.indexOf(r)<0&&so.call(e,r)&&(n[r]=e[r]);return n};function lo(e,t,n={}){const r=n,{window:i=qs}=r,a=oo(r,["window"]);let s;const o=function(e,t=!1){const n=At(),r=()=>n.value=Boolean(e());return r(),Ys(r,t),n}((()=>i&&"ResizeObserver"in i)),l=()=>{s&&(s.disconnect(),s=void 0)},u=Mn((()=>Xs(e)),(e=>{l(),o.value&&i&&e&&(s=new ResizeObserver(t),s.observe(e,a))}),{immediate:!0,flush:"post"}),c=()=>{l(),u()};return Hs(c),{isSupported:o,stop:c}}function uo(e,t={}){const{reset:n=!0,windowResize:r=!0,windowScroll:i=!0,immediate:a=!0}=t,s=At(0),o=At(0),l=At(0),u=At(0),c=At(0),d=At(0),h=At(0),p=At(0);function f(){const t=Xs(e);if(!t)return void(n&&(s.value=0,o.value=0,l.value=0,u.value=0,c.value=0,d.value=0,h.value=0,p.value=0));const r=t.getBoundingClientRect();s.value=r.height,o.value=r.bottom,l.value=r.left,u.value=r.right,c.value=r.top,d.value=r.width,h.value=r.x,p.value=r.y}return lo(e,f),Mn((()=>Xs(e)),(e=>!e&&f())),i&&Zs("scroll",f,{capture:!0,passive:!0}),r&&Zs("resize",f,{passive:!0}),Ys((()=>{a&&f()})),{height:s,bottom:o,left:l,right:u,top:c,width:d,x:h,y:p,update:f}}(ro=no||(no={})).UP="UP",ro.RIGHT="RIGHT",ro.DOWN="DOWN",ro.LEFT="LEFT",ro.NONE="NONE";var co=Object.defineProperty,ho=Object.getOwnPropertySymbols,po=Object.prototype.hasOwnProperty,fo=Object.prototype.propertyIsEnumerable,mo=(e,t,n)=>t in e?co(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;function go(e,t,n,r={}){var i,a,s;const{clone:o=!1,passive:l=!1,eventName:u,deep:c=!1,defaultValue:d}=r,h=Fi(),p=n||(null==h?void 0:h.emit)||(null==(i=null==h?void 0:h.$emit)?void 0:i.bind(h))||(null==(s=null==(a=null==h?void 0:h.proxy)?void 0:a.$emit)?void 0:s.bind(null==h?void 0:h.proxy));let f=u;t||(t="modelValue"),f=u||f||`update:${t.toString()}`;const m=e=>{return o?(e=>"function"==typeof e)(o)?o(e):(t=e,JSON.parse(JSON.stringify(t))):e;var t},g=()=>void 0!==e[t]?m(e[t]):d;if(l){const n=At(g());return Mn((()=>e[t]),(e=>n.value=m(e))),Mn(n,(n=>{(n!==e[t]||c)&&p(f,n)}),{deep:c}),n}return Ki({get:()=>g(),set(e){p(f,e)}})}((e,t)=>{for(var n in t||(t={}))po.call(t,n)&&mo(e,n,t[n]);if(ho)for(var n of ho(t))fo.call(t,n)&&mo(e,n,t[n])})({linear:function(e){return e}},{easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]});const vo=e=>{let t=0,n=e;for(;n;)t+=n.offsetTop,n=n.offsetParent;return t},yo=e=>{let t,n;return"touchend"===e.type?(n=e.changedTouches[0].clientY,t=e.changedTouches[0].clientX):e.type.startsWith("touch")?(n=e.touches[0].clientY,t=e.touches[0].clientX):(n=e.clientY,t=e.clientX),{clientX:t,clientY:n}};const _o="object"==typeof global&&global&&global.Object===Object&&global;var bo="object"==typeof self&&self&&self.Object===Object&&self;const xo=_o||bo||Function("return this")();const wo=xo.Symbol;var So=Object.prototype,Co=So.hasOwnProperty,To=So.toString,Mo=wo?wo.toStringTag:void 0;var Eo=Object.prototype.toString;var Ao="[object Null]",Po="[object Undefined]",Ro=wo?wo.toStringTag:void 0;function Lo(e){return null==e?void 0===e?Po:Ao:Ro&&Ro in Object(e)?function(e){var t=Co.call(e,Mo),n=e[Mo];try{e[Mo]=void 0;var r=!0}catch(zA){}var i=To.call(e);return r&&(t?e[Mo]=n:delete e[Mo]),i}(e):function(e){return Eo.call(e)}(e)}function ko(e){return null!=e&&"object"==typeof e}var Do="[object Symbol]";function Io(e){return"symbol"==typeof e||ko(e)&&Lo(e)==Do}function Oo(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}const No=Array.isArray;var Bo=1/0,Uo=wo?wo.prototype:void 0,zo=Uo?Uo.toString:void 0;function Fo(e){if("string"==typeof e)return e;if(No(e))return Oo(e,Fo)+"";if(Io(e))return zo?zo.call(e):"";var t=e+"";return"0"==t&&1/e==-Bo?"-0":t}var Vo=/\s/;var Go=/^\s+/;function Ho(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&Vo.test(e.charAt(t)););return t}(e)+1).replace(Go,""):e}function jo(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var Wo=NaN,Yo=/^[-+]0x[0-9a-f]+$/i,$o=/^0b[01]+$/i,Xo=/^0o[0-7]+$/i,qo=parseInt;function Ko(e){if("number"==typeof e)return e;if(Io(e))return Wo;if(jo(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=jo(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Ho(e);var n=$o.test(e);return n||Xo.test(e)?qo(e.slice(2),n?2:8):Yo.test(e)?Wo:+e}function Zo(e){return e}var Jo="[object AsyncFunction]",Qo="[object Function]",el="[object GeneratorFunction]",tl="[object Proxy]";function nl(e){if(!jo(e))return!1;var t=Lo(e);return t==Qo||t==el||t==Jo||t==tl}const rl=xo["__core-js_shared__"];var il,al=(il=/[^.]+$/.exec(rl&&rl.keys&&rl.keys.IE_PROTO||""))?"Symbol(src)_1."+il:"";var sl=Function.prototype.toString;function ol(e){if(null!=e){try{return sl.call(e)}catch(zA){}try{return e+""}catch(zA){}}return""}var ll=/^\[object .+?Constructor\]$/,ul=Function.prototype,cl=Object.prototype,dl=ul.toString,hl=cl.hasOwnProperty,pl=RegExp("^"+dl.call(hl).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function fl(e){return!(!jo(e)||(t=e,al&&al in t))&&(nl(e)?pl:ll).test(ol(e));var t}function ml(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return fl(n)?n:void 0}const gl=ml(xo,"WeakMap");var vl=Object.create;const yl=function(){function e(){}return function(t){if(!jo(t))return{};if(vl)return vl(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function _l(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}var bl=Date.now;var xl=function(){try{var e=ml(Object,"defineProperty");return e({},"",{}),e}catch(zA){}}();const wl=xl;var Sl=wl?function(e,t){return wl(e,"toString",{configurable:!0,enumerable:!1,value:(n=t,function(){return n}),writable:!0});var n}:Zo;var Cl,Tl,Ml;const El=(Cl=Sl,Tl=0,Ml=0,function(){var e=bl(),t=16-(e-Ml);if(Ml=e,t>0){if(++Tl>=800)return arguments[0]}else Tl=0;return Cl.apply(void 0,arguments)});function Al(e){return e!=e}function Pl(e,t){return!!(null==e?0:e.length)&&function(e,t,n){return t==t?function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):function(e,t,n,r){for(var i=e.length,a=n+(r?1:-1);r?a--:++a<i;)if(t(e[a],a,e))return a;return-1}(e,Al,n)}(e,t,0)>-1}var Rl=9007199254740991,Ll=/^(?:0|[1-9]\d*)$/;function kl(e,t){var n=typeof e;return!!(t=null==t?Rl:t)&&("number"==n||"symbol"!=n&&Ll.test(e))&&e>-1&&e%1==0&&e<t}function Dl(e,t,n){"__proto__"==t&&wl?wl(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function Il(e,t){return e===t||e!=e&&t!=t}var Ol=Object.prototype.hasOwnProperty;function Nl(e,t,n){var r=e[t];Ol.call(e,t)&&Il(r,n)&&(void 0!==n||t in e)||Dl(e,t,n)}function Bl(e,t,n,r){var i=!n;n||(n={});for(var a=-1,s=t.length;++a<s;){var o=t[a],l=r?r(n[o],e[o],o,n,e):void 0;void 0===l&&(l=e[o]),i?Dl(n,o,l):Nl(n,o,l)}return n}var Ul=Math.max;function zl(e,t,n){return t=Ul(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,a=Ul(r.length-t,0),s=Array(a);++i<a;)s[i]=r[t+i];i=-1;for(var o=Array(t+1);++i<t;)o[i]=r[i];return o[t]=n(s),function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}(e,this,o)}}function Fl(e,t){return El(zl(e,t,Zo),e+"")}var Vl=9007199254740991;function Gl(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Vl}function Hl(e){return null!=e&&Gl(e.length)&&!nl(e)}var jl=Object.prototype;function Wl(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||jl)}function Yl(e){return ko(e)&&"[object Arguments]"==Lo(e)}var $l=Object.prototype,Xl=$l.hasOwnProperty,ql=$l.propertyIsEnumerable;const Kl=Yl(function(){return arguments}())?Yl:function(e){return ko(e)&&Xl.call(e,"callee")&&!ql.call(e,"callee")};var Zl="object"==typeof exports&&exports&&!exports.nodeType&&exports,Jl=Zl&&"object"==typeof module&&module&&!module.nodeType&&module,Ql=Jl&&Jl.exports===Zl?xo.Buffer:void 0;const eu=(Ql?Ql.isBuffer:void 0)||function(){return!1};var tu={};function nu(e){return function(t){return e(t)}}tu["[object Float32Array]"]=tu["[object Float64Array]"]=tu["[object Int8Array]"]=tu["[object Int16Array]"]=tu["[object Int32Array]"]=tu["[object Uint8Array]"]=tu["[object Uint8ClampedArray]"]=tu["[object Uint16Array]"]=tu["[object Uint32Array]"]=!0,tu["[object Arguments]"]=tu["[object Array]"]=tu["[object ArrayBuffer]"]=tu["[object Boolean]"]=tu["[object DataView]"]=tu["[object Date]"]=tu["[object Error]"]=tu["[object Function]"]=tu["[object Map]"]=tu["[object Number]"]=tu["[object Object]"]=tu["[object RegExp]"]=tu["[object Set]"]=tu["[object String]"]=tu["[object WeakMap]"]=!1;var ru="object"==typeof exports&&exports&&!exports.nodeType&&exports,iu=ru&&"object"==typeof module&&module&&!module.nodeType&&module,au=iu&&iu.exports===ru&&_o.process;const su=function(){try{var e=iu&&iu.require&&iu.require("util").types;return e||au&&au.binding&&au.binding("util")}catch(zA){}}();var ou=su&&su.isTypedArray;const lu=ou?nu(ou):function(e){return ko(e)&&Gl(e.length)&&!!tu[Lo(e)]};var uu=Object.prototype.hasOwnProperty;function cu(e,t){var n=No(e),r=!n&&Kl(e),i=!n&&!r&&eu(e),a=!n&&!r&&!i&&lu(e),s=n||r||i||a,o=s?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],l=o.length;for(var u in e)!t&&!uu.call(e,u)||s&&("length"==u||i&&("offset"==u||"parent"==u)||a&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||kl(u,l))||o.push(u);return o}function du(e,t){return function(n){return e(t(n))}}const hu=du(Object.keys,Object);var pu=Object.prototype.hasOwnProperty;function fu(e){return Hl(e)?cu(e):function(e){if(!Wl(e))return hu(e);var t=[];for(var n in Object(e))pu.call(e,n)&&"constructor"!=n&&t.push(n);return t}(e)}var mu=Object.prototype.hasOwnProperty;function gu(e){if(!jo(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=Wl(e),n=[];for(var r in e)("constructor"!=r||!t&&mu.call(e,r))&&n.push(r);return n}function vu(e){return Hl(e)?cu(e,!0):gu(e)}var yu=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,_u=/^\w*$/;function bu(e,t){if(No(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!Io(e))||(_u.test(e)||!yu.test(e)||null!=t&&e in Object(t))}const xu=ml(Object,"create");var wu=Object.prototype.hasOwnProperty;var Su=Object.prototype.hasOwnProperty;function Cu(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Tu(e,t){for(var n=e.length;n--;)if(Il(e[n][0],t))return n;return-1}Cu.prototype.clear=function(){this.__data__=xu?xu(null):{},this.size=0},Cu.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Cu.prototype.get=function(e){var t=this.__data__;if(xu){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return wu.call(t,e)?t[e]:void 0},Cu.prototype.has=function(e){var t=this.__data__;return xu?void 0!==t[e]:Su.call(t,e)},Cu.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=xu&&void 0===t?"__lodash_hash_undefined__":t,this};var Mu=Array.prototype.splice;function Eu(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Eu.prototype.clear=function(){this.__data__=[],this.size=0},Eu.prototype.delete=function(e){var t=this.__data__,n=Tu(t,e);return!(n<0)&&(n==t.length-1?t.pop():Mu.call(t,n,1),--this.size,!0)},Eu.prototype.get=function(e){var t=this.__data__,n=Tu(t,e);return n<0?void 0:t[n][1]},Eu.prototype.has=function(e){return Tu(this.__data__,e)>-1},Eu.prototype.set=function(e,t){var n=this.__data__,r=Tu(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};const Au=ml(xo,"Map");function Pu(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function Ru(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Ru.prototype.clear=function(){this.size=0,this.__data__={hash:new Cu,map:new(Au||Eu),string:new Cu}},Ru.prototype.delete=function(e){var t=Pu(this,e).delete(e);return this.size-=t?1:0,t},Ru.prototype.get=function(e){return Pu(this,e).get(e)},Ru.prototype.has=function(e){return Pu(this,e).has(e)},Ru.prototype.set=function(e,t){var n=Pu(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};var Lu="Expected a function";function ku(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(Lu);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],a=n.cache;if(a.has(i))return a.get(i);var s=e.apply(this,r);return n.cache=a.set(i,s)||a,s};return n.cache=new(ku.Cache||Ru),n}ku.Cache=Ru;var Du=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Iu=/\\(\\)?/g,Ou=function(e){var t=ku(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Du,(function(e,n,r,i){t.push(r?i.replace(Iu,"$1"):n||e)})),t}));const Nu=Ou;function Bu(e,t){return No(e)?e:bu(e,t)?[e]:Nu(function(e){return null==e?"":Fo(e)}(e))}var Uu=1/0;function zu(e){if("string"==typeof e||Io(e))return e;var t=e+"";return"0"==t&&1/e==-Uu?"-0":t}function Fu(e,t){for(var n=0,r=(t=Bu(t,e)).length;null!=e&&n<r;)e=e[zu(t[n++])];return n&&n==r?e:void 0}function Vu(e,t,n){var r=null==e?void 0:Fu(e,t);return void 0===r?n:r}function Gu(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}var Hu=wo?wo.isConcatSpreadable:void 0;function ju(e){return No(e)||Kl(e)||!!(Hu&&e&&e[Hu])}function Wu(e,t,n,r,i){var a=-1,s=e.length;for(n||(n=ju),i||(i=[]);++a<s;){var o=e[a];t>0&&n(o)?t>1?Wu(o,t-1,n,r,i):Gu(i,o):r||(i[i.length]=o)}return i}function Yu(e){return(null==e?0:e.length)?Wu(e,1):[]}const $u=du(Object.getPrototypeOf,Object);var Xu="[object Object]",qu=Function.prototype,Ku=Object.prototype,Zu=qu.toString,Ju=Ku.hasOwnProperty,Qu=Zu.call(Object);function ec(){if(!arguments.length)return[];var e=arguments[0];return No(e)?e:[e]}function tc(e){var t=this.__data__=new Eu(e);this.size=t.size}tc.prototype.clear=function(){this.__data__=new Eu,this.size=0},tc.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},tc.prototype.get=function(e){return this.__data__.get(e)},tc.prototype.has=function(e){return this.__data__.has(e)},tc.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Eu){var r=n.__data__;if(!Au||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Ru(r)}return n.set(e,t),this.size=n.size,this};var nc="object"==typeof exports&&exports&&!exports.nodeType&&exports,rc=nc&&"object"==typeof module&&module&&!module.nodeType&&module,ic=rc&&rc.exports===nc?xo.Buffer:void 0,ac=ic?ic.allocUnsafe:void 0;function sc(e,t){if(t)return e.slice();var n=e.length,r=ac?ac(n):new e.constructor(n);return e.copy(r),r}function oc(){return[]}var lc=Object.prototype.propertyIsEnumerable,uc=Object.getOwnPropertySymbols;const cc=uc?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,a=[];++n<r;){var s=e[n];t(s,n,e)&&(a[i++]=s)}return a}(uc(e),(function(t){return lc.call(e,t)})))}:oc;const dc=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Gu(t,cc(e)),e=$u(e);return t}:oc;function hc(e,t,n){var r=t(e);return No(e)?r:Gu(r,n(e))}function pc(e){return hc(e,fu,cc)}function fc(e){return hc(e,vu,dc)}const mc=ml(xo,"DataView");const gc=ml(xo,"Promise");const vc=ml(xo,"Set");var yc="[object Map]",_c="[object Promise]",bc="[object Set]",xc="[object WeakMap]",wc="[object DataView]",Sc=ol(mc),Cc=ol(Au),Tc=ol(gc),Mc=ol(vc),Ec=ol(gl),Ac=Lo;(mc&&Ac(new mc(new ArrayBuffer(1)))!=wc||Au&&Ac(new Au)!=yc||gc&&Ac(gc.resolve())!=_c||vc&&Ac(new vc)!=bc||gl&&Ac(new gl)!=xc)&&(Ac=function(e){var t=Lo(e),n="[object Object]"==t?e.constructor:void 0,r=n?ol(n):"";if(r)switch(r){case Sc:return wc;case Cc:return yc;case Tc:return _c;case Mc:return bc;case Ec:return xc}return t});const Pc=Ac;var Rc=Object.prototype.hasOwnProperty;const Lc=xo.Uint8Array;function kc(e){var t=new e.constructor(e.byteLength);return new Lc(t).set(new Lc(e)),t}var Dc=/\w*$/;var Ic=wo?wo.prototype:void 0,Oc=Ic?Ic.valueOf:void 0;function Nc(e,t){var n=t?kc(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}var Bc="[object Boolean]",Uc="[object Date]",zc="[object Map]",Fc="[object Number]",Vc="[object RegExp]",Gc="[object Set]",Hc="[object String]",jc="[object Symbol]",Wc="[object ArrayBuffer]",Yc="[object DataView]",$c="[object Float32Array]",Xc="[object Float64Array]",qc="[object Int8Array]",Kc="[object Int16Array]",Zc="[object Int32Array]",Jc="[object Uint8Array]",Qc="[object Uint8ClampedArray]",ed="[object Uint16Array]",td="[object Uint32Array]";function nd(e,t,n){var r,i,a,s=e.constructor;switch(t){case Wc:return kc(e);case Bc:case Uc:return new s(+e);case Yc:return function(e,t){var n=t?kc(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case $c:case Xc:case qc:case Kc:case Zc:case Jc:case Qc:case ed:case td:return Nc(e,n);case zc:return new s;case Fc:case Hc:return new s(e);case Vc:return(a=new(i=e).constructor(i.source,Dc.exec(i))).lastIndex=i.lastIndex,a;case Gc:return new s;case jc:return r=e,Oc?Object(Oc.call(r)):{}}}function rd(e){return"function"!=typeof e.constructor||Wl(e)?{}:yl($u(e))}var id=su&&su.isMap;const ad=id?nu(id):function(e){return ko(e)&&"[object Map]"==Pc(e)};var sd=su&&su.isSet;const od=sd?nu(sd):function(e){return ko(e)&&"[object Set]"==Pc(e)};var ld=1,ud=2,cd=4,dd="[object Arguments]",hd="[object Function]",pd="[object GeneratorFunction]",fd="[object Object]",md={};function gd(e,t,n,r,i,a){var s,o=t&ld,l=t&ud,u=t&cd;if(n&&(s=i?n(e,r,i,a):n(e)),void 0!==s)return s;if(!jo(e))return e;var c=No(e);if(c){if(s=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&Rc.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!o)return _l(e,s)}else{var d=Pc(e),h=d==hd||d==pd;if(eu(e))return sc(e,o);if(d==fd||d==dd||h&&!i){if(s=l||h?{}:rd(e),!o)return l?function(e,t){return Bl(e,dc(e),t)}(e,function(e,t){return e&&Bl(t,vu(t),e)}(s,e)):function(e,t){return Bl(e,cc(e),t)}(e,function(e,t){return e&&Bl(t,fu(t),e)}(s,e))}else{if(!md[d])return i?e:{};s=nd(e,d,o)}}a||(a=new tc);var p=a.get(e);if(p)return p;a.set(e,s),od(e)?e.forEach((function(r){s.add(gd(r,t,n,r,e,a))})):ad(e)&&e.forEach((function(r,i){s.set(i,gd(r,t,n,i,e,a))}));var f=c?void 0:(u?l?fc:pc:l?vu:fu)(e);return function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););}(f||e,(function(r,i){f&&(r=e[i=r]),Nl(s,i,gd(r,t,n,i,e,a))})),s}md[dd]=md["[object Array]"]=md["[object ArrayBuffer]"]=md["[object DataView]"]=md["[object Boolean]"]=md["[object Date]"]=md["[object Float32Array]"]=md["[object Float64Array]"]=md["[object Int8Array]"]=md["[object Int16Array]"]=md["[object Int32Array]"]=md["[object Map]"]=md["[object Number]"]=md[fd]=md["[object RegExp]"]=md["[object Set]"]=md["[object String]"]=md["[object Symbol]"]=md["[object Uint8Array]"]=md["[object Uint8ClampedArray]"]=md["[object Uint16Array]"]=md["[object Uint32Array]"]=!0,md["[object Error]"]=md[hd]=md["[object WeakMap]"]=!1;function vd(e){return gd(e,4)}function yd(e){return gd(e,5)}function _d(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Ru;++t<n;)this.add(e[t])}function bd(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function xd(e,t){return e.has(t)}_d.prototype.add=_d.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},_d.prototype.has=function(e){return this.__data__.has(e)};var wd=1,Sd=2;function Cd(e,t,n,r,i,a){var s=n&wd,o=e.length,l=t.length;if(o!=l&&!(s&&l>o))return!1;var u=a.get(e),c=a.get(t);if(u&&c)return u==t&&c==e;var d=-1,h=!0,p=n&Sd?new _d:void 0;for(a.set(e,t),a.set(t,e);++d<o;){var f=e[d],m=t[d];if(r)var g=s?r(m,f,d,t,e,a):r(f,m,d,e,t,a);if(void 0!==g){if(g)continue;h=!1;break}if(p){if(!bd(t,(function(e,t){if(!xd(p,t)&&(f===e||i(f,e,n,r,a)))return p.push(t)}))){h=!1;break}}else if(f!==m&&!i(f,m,n,r,a)){h=!1;break}}return a.delete(e),a.delete(t),h}function Td(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function Md(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var Ed=1,Ad=2,Pd="[object Boolean]",Rd="[object Date]",Ld="[object Error]",kd="[object Map]",Dd="[object Number]",Id="[object RegExp]",Od="[object Set]",Nd="[object String]",Bd="[object Symbol]",Ud="[object ArrayBuffer]",zd="[object DataView]",Fd=wo?wo.prototype:void 0,Vd=Fd?Fd.valueOf:void 0;var Gd=1,Hd=Object.prototype.hasOwnProperty;var jd=1,Wd="[object Arguments]",Yd="[object Array]",$d="[object Object]",Xd=Object.prototype.hasOwnProperty;function qd(e,t,n,r,i,a){var s=No(e),o=No(t),l=s?Yd:Pc(e),u=o?Yd:Pc(t),c=(l=l==Wd?$d:l)==$d,d=(u=u==Wd?$d:u)==$d,h=l==u;if(h&&eu(e)){if(!eu(t))return!1;s=!0,c=!1}if(h&&!c)return a||(a=new tc),s||lu(e)?Cd(e,t,n,r,i,a):function(e,t,n,r,i,a,s){switch(n){case zd:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Ud:return!(e.byteLength!=t.byteLength||!a(new Lc(e),new Lc(t)));case Pd:case Rd:case Dd:return Il(+e,+t);case Ld:return e.name==t.name&&e.message==t.message;case Id:case Nd:return e==t+"";case kd:var o=Td;case Od:var l=r&Ed;if(o||(o=Md),e.size!=t.size&&!l)return!1;var u=s.get(e);if(u)return u==t;r|=Ad,s.set(e,t);var c=Cd(o(e),o(t),r,i,a,s);return s.delete(e),c;case Bd:if(Vd)return Vd.call(e)==Vd.call(t)}return!1}(e,t,l,n,r,i,a);if(!(n&jd)){var p=c&&Xd.call(e,"__wrapped__"),f=d&&Xd.call(t,"__wrapped__");if(p||f){var m=p?e.value():e,g=f?t.value():t;return a||(a=new tc),i(m,g,n,r,a)}}return!!h&&(a||(a=new tc),function(e,t,n,r,i,a){var s=n&Gd,o=pc(e),l=o.length;if(l!=pc(t).length&&!s)return!1;for(var u=l;u--;){var c=o[u];if(!(s?c in t:Hd.call(t,c)))return!1}var d=a.get(e),h=a.get(t);if(d&&h)return d==t&&h==e;var p=!0;a.set(e,t),a.set(t,e);for(var f=s;++u<l;){var m=e[c=o[u]],g=t[c];if(r)var v=s?r(g,m,c,t,e,a):r(m,g,c,e,t,a);if(!(void 0===v?m===g||i(m,g,n,r,a):v)){p=!1;break}f||(f="constructor"==c)}if(p&&!f){var y=e.constructor,_=t.constructor;y==_||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof _&&_ instanceof _||(p=!1)}return a.delete(e),a.delete(t),p}(e,t,n,r,i,a))}function Kd(e,t,n,r,i){return e===t||(null==e||null==t||!ko(e)&&!ko(t)?e!=e&&t!=t:qd(e,t,n,r,Kd,i))}var Zd=1,Jd=2;function Qd(e){return e==e&&!jo(e)}function eh(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}function th(e){var t=function(e){for(var t=fu(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,Qd(i)]}return t}(e);return 1==t.length&&t[0][2]?eh(t[0][0],t[0][1]):function(n){return n===e||function(e,t,n,r){var i=n.length,a=i,s=!r;if(null==e)return!a;for(e=Object(e);i--;){var o=n[i];if(s&&o[2]?o[1]!==e[o[0]]:!(o[0]in e))return!1}for(;++i<a;){var l=(o=n[i])[0],u=e[l],c=o[1];if(s&&o[2]){if(void 0===u&&!(l in e))return!1}else{var d=new tc;if(r)var h=r(u,c,l,e,t,d);if(!(void 0===h?Kd(c,u,Zd|Jd,r,d):h))return!1}}return!0}(n,e,t)}}function nh(e,t){return null!=e&&t in Object(e)}function rh(e,t){return null!=e&&function(e,t,n){for(var r=-1,i=(t=Bu(t,e)).length,a=!1;++r<i;){var s=zu(t[r]);if(!(a=null!=e&&n(e,s)))break;e=e[s]}return a||++r!=i?a:!!(i=null==e?0:e.length)&&Gl(i)&&kl(s,i)&&(No(e)||Kl(e))}(e,t,nh)}var ih,ah=1,sh=2;function oh(e){return bu(e)?(t=zu(e),function(e){return null==e?void 0:e[t]}):function(e){return function(t){return Fu(t,e)}}(e);var t}function lh(e){return"function"==typeof e?e:null==e?Zo:"object"==typeof e?No(e)?(t=e[0],n=e[1],bu(t)&&Qd(n)?eh(zu(t),n):function(e){var r=Vu(e,t);return void 0===r&&r===n?rh(e,t):Kd(n,r,ah|sh)}):th(e):oh(e);var t,n}const uh=function(e,t,n){for(var r=-1,i=Object(e),a=n(e),s=a.length;s--;){var o=a[ih?s:++r];if(!1===t(i[o],o,i))break}return e};var ch=function(e,t){return function(n,r){if(null==n)return n;if(!Hl(n))return e(n,r);for(var i=n.length,a=t?i:-1,s=Object(n);(t?a--:++a<i)&&!1!==r(s[a],a,s););return n}}((function(e,t){return e&&uh(e,t,fu)}));const dh=ch;const hh=function(){return xo.Date.now()};var ph="Expected a function",fh=Math.max,mh=Math.min;function gh(e,t,n){var r,i,a,s,o,l,u=0,c=!1,d=!1,h=!0;if("function"!=typeof e)throw new TypeError(ph);function p(t){var n=r,a=i;return r=i=void 0,u=t,s=e.apply(a,n)}function f(e){var n=e-l;return void 0===l||n>=t||n<0||d&&e-u>=a}function m(){var e=hh();if(f(e))return g(e);o=setTimeout(m,function(e){var n=t-(e-l);return d?mh(n,a-(e-u)):n}(e))}function g(e){return o=void 0,h&&r?p(e):(r=i=void 0,s)}function v(){var e=hh(),n=f(e);if(r=arguments,i=this,l=e,n){if(void 0===o)return function(e){return u=e,o=setTimeout(m,t),c?p(e):s}(l);if(d)return clearTimeout(o),o=setTimeout(m,t),p(l)}return void 0===o&&(o=setTimeout(m,t)),s}return t=Ko(t)||0,jo(n)&&(c=!!n.leading,a=(d="maxWait"in n)?fh(Ko(n.maxWait)||0,t):a,h="trailing"in n?!!n.trailing:h),v.cancel=function(){void 0!==o&&clearTimeout(o),u=0,r=l=i=o=void 0},v.flush=function(){return void 0===o?s:g(hh())},v}function vh(e,t,n){(void 0!==n&&!Il(e[t],n)||void 0===n&&!(t in e))&&Dl(e,t,n)}function yh(e){return ko(e)&&Hl(e)}function _h(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}function bh(e,t,n,r,i,a,s){var o=_h(e,n),l=_h(t,n),u=s.get(l);if(u)vh(e,n,u);else{var c,d=a?a(o,l,n+"",e,t,s):void 0,h=void 0===d;if(h){var p=No(l),f=!p&&eu(l),m=!p&&!f&&lu(l);d=l,p||f||m?No(o)?d=o:yh(o)?d=_l(o):f?(h=!1,d=sc(l,!0)):m?(h=!1,d=Nc(l,!0)):d=[]:function(e){if(!ko(e)||Lo(e)!=Xu)return!1;var t=$u(e);if(null===t)return!0;var n=Ju.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Zu.call(n)==Qu}(l)||Kl(l)?(d=o,Kl(o)?d=Bl(c=o,vu(c)):jo(o)&&!nl(o)||(d=rd(l))):h=!1}h&&(s.set(l,d),i(d,l,r,a,s),s.delete(l)),vh(e,n,d)}}function xh(e,t,n,r,i){e!==t&&uh(t,(function(a,s){if(i||(i=new tc),jo(a))bh(e,t,s,n,xh,r,i);else{var o=r?r(_h(e,s),a,s+"",e,t,i):void 0;void 0===o&&(o=a),vh(e,s,o)}}),vu)}function wh(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}function Sh(e,t){var n=-1,r=Hl(e)?Array(e.length):[];return dh(e,(function(e,i,a){r[++n]=t(e,i,a)})),r}function Ch(e,t){return Wu(function(e,t){return(No(e)?Oo:Sh)(e,lh(t))}(e,t),1)}var Th;function Mh(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r}function Eh(e,t){return Kd(e,t)}function Ah(e){return null==e}const Ph=(Th=function(e,t,n){xh(e,t,n)},Fl((function(e,t){var n=-1,r=t.length,i=r>1?t[r-1]:void 0,a=r>2?t[2]:void 0;for(i=Th.length>3&&"function"==typeof i?(r--,i):void 0,a&&function(e,t,n){if(!jo(n))return!1;var r=typeof t;return!!("number"==r?Hl(n)&&kl(t,n.length):"string"==r&&t in n)&&Il(n[t],e)}(t[0],t[1],a)&&(i=r<3?void 0:i,r=1),e=Object(e);++n<r;){var s=t[n];s&&Th(e,s,n,i)}return e})));function Rh(e,t,n,r){if(!jo(e))return e;for(var i=-1,a=(t=Bu(t,e)).length,s=a-1,o=e;null!=o&&++i<a;){var l=zu(t[i]),u=n;if("__proto__"===l||"constructor"===l||"prototype"===l)return e;if(i!=s){var c=o[l];void 0===(u=r?r(c,l,o):void 0)&&(u=jo(c)?c:kl(t[i+1])?[]:{})}Nl(o,l,u),o=o[l]}return e}function Lh(e,t){return function(e,t,n){for(var r=-1,i=t.length,a={};++r<i;){var s=t[r],o=Fu(e,s);n(o,s)&&Rh(a,Bu(s,e),o)}return a}(e,t,(function(t,n){return rh(e,n)}))}var kh=function(e){return El(zl(e,void 0,Yu),e+"")}((function(e,t){return null==e?{}:Lh(e,t)}));const Dh=kh;function Ih(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return jo(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),gh(e,t,{leading:r,maxWait:t,trailing:i})}const Oh=vc&&1/Md(new vc([,-0]))[1]==1/0?function(e){return new vc(e)}:function(){};const Nh=Fl((function(e){return function(e,t,n){var r=-1,i=Pl,a=e.length,s=!0,o=[],l=o;if(n)s=!1,i=wh;else if(a>=200){var u=t?null:Oh(e);if(u)return Md(u);s=!1,i=xd,l=new _d}else l=t?[]:o;e:for(;++r<a;){var c=e[r],d=t?t(c):c;if(c=n||0!==c?c:0,s&&d==d){for(var h=l.length;h--;)if(l[h]===d)continue e;t&&l.push(d),o.push(c)}else i(l,d,n)||(l!==o&&l.push(d),o.push(c))}return o}(Wu(e,1,yh,!0))})),Bh=e=>void 0===e,Uh=e=>!e&&0!==e||E(e)&&0===e.length||O(e)&&!Object.keys(e).length,zh=e=>"undefined"!=typeof Element&&e instanceof Element,Fh=(e="")=>e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d"),Vh=e=>q(e),Gh=e=>Object.keys(e),Hh=(e,t,n)=>({get value(){return Vu(e,t,n)},set value(n){!function(e,t,n){null==e||Rh(e,t,n)}(e,t,n)}});class jh extends Error{constructor(e){super(e),this.name="ElementPlusError"}}function Wh(e,t){throw new jh(`[${e}] ${t}`)}const Yh=(e="")=>e.split(" ").filter((e=>!!e.trim())),$h=(e,t)=>{if(!e||!t)return!1;if(t.includes(" "))throw new Error("className should not contain space.");return e.classList.contains(t)},Xh=(e,t)=>{e&&t.trim()&&e.classList.add(...Yh(t))},qh=(e,t)=>{e&&t.trim()&&e.classList.remove(...Yh(t))},Kh=(e,t)=>{var n;if(!Os||!e||!t)return"";let r=W(t);"float"===r&&(r="cssFloat");try{const t=e.style[r];if(t)return t;const i=null==(n=document.defaultView)?void 0:n.getComputedStyle(e,"");return i?i[r]:""}catch(zA){return e.style[r]}};function Zh(e,t="px"){return e?Bs(e)||D(n=e)&&!Number.isNaN(Number(n))?`${e}${t}`:D(e)?e:void 0:"";var n}const Jh=(e,t)=>{if(!Os)return!1;const n={undefined:"overflow",true:"overflow-y",false:"overflow-x"}[String(t)],r=Kh(e,n);return["scroll","auto","overlay"].some((e=>r.includes(e)))},Qh=(e,t)=>{if(!Os)return;let n=e;for(;n;){if([window,document,document.documentElement].includes(n))return window;if(Jh(n,t))return n;n=n.parentNode}return n};let ep;const tp=e=>{var t;if(!Os)return 0;if(void 0!==ep)return ep;const n=document.createElement("div");n.className=`${e}-scrollbar__wrap`,n.style.visibility="hidden",n.style.width="100px",n.style.position="absolute",n.style.top="-9999px",document.body.appendChild(n);const r=n.offsetWidth;n.style.overflow="scroll";const i=document.createElement("div");i.style.width="100%",n.appendChild(i);const a=i.offsetWidth;return null==(t=n.parentNode)||t.removeChild(n),ep=r-a,ep};function np(e,t){if(!Os)return;if(!t)return void(e.scrollTop=0);const n=[];let r=t.offsetParent;for(;null!==r&&e!==r&&e.contains(r);)n.push(r),r=r.offsetParent;const i=t.offsetTop+n.reduce(((e,t)=>e+t.offsetTop),0),a=i+t.offsetHeight,s=e.scrollTop,o=s+e.clientHeight;i<s?e.scrollTop=i:a>o&&(e.scrollTop=a-e.clientHeight)}
/*! Element Plus Icons Vue v2.1.0 */var rp=(e,t)=>{let n=e.__vccOpts||e;for(let[r,i]of t)n[r]=i;return n},ip={name:"ArrowDown"},ap={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},sp=[Ti("path",{fill:"currentColor",d:"M831.872 340.864 512 652.672 192.128 340.864a30.592 30.592 0 0 0-42.752 0 29.12 29.12 0 0 0 0 41.6L489.664 714.24a32 32 0 0 0 44.672 0l340.288-331.712a29.12 29.12 0 0 0 0-41.728 30.592 30.592 0 0 0-42.752 0z"},null,-1)];var op=rp(ip,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",ap,sp)}],["__file","arrow-down.vue"]]),lp={name:"ArrowLeft"},up={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},cp=[Ti("path",{fill:"currentColor",d:"M609.408 149.376 277.76 489.6a32 32 0 0 0 0 44.672l331.648 340.352a29.12 29.12 0 0 0 41.728 0 30.592 30.592 0 0 0 0-42.752L339.264 511.936l311.872-319.872a30.592 30.592 0 0 0 0-42.688 29.12 29.12 0 0 0-41.728 0z"},null,-1)];var dp=rp(lp,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",up,cp)}],["__file","arrow-left.vue"]]),hp={name:"ArrowRight"},pp={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},fp=[Ti("path",{fill:"currentColor",d:"M340.864 149.312a30.592 30.592 0 0 0 0 42.752L652.736 512 340.864 831.872a30.592 30.592 0 0 0 0 42.752 29.12 29.12 0 0 0 41.728 0L714.24 534.336a32 32 0 0 0 0-44.672L382.592 149.376a29.12 29.12 0 0 0-41.728 0z"},null,-1)];var mp=rp(hp,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",pp,fp)}],["__file","arrow-right.vue"]]),gp={name:"ArrowUp"},vp={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},yp=[Ti("path",{fill:"currentColor",d:"m488.832 344.32-339.84 356.672a32 32 0 0 0 0 44.16l.384.384a29.44 29.44 0 0 0 42.688 0l320-335.872 319.872 335.872a29.44 29.44 0 0 0 42.688 0l.384-.384a32 32 0 0 0 0-44.16L535.168 344.32a32 32 0 0 0-46.336 0z"},null,-1)];var _p=rp(gp,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",vp,yp)}],["__file","arrow-up.vue"]]),bp={name:"Back"},xp={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},wp=[Ti("path",{fill:"currentColor",d:"M224 480h640a32 32 0 1 1 0 64H224a32 32 0 0 1 0-64z"},null,-1),Ti("path",{fill:"currentColor",d:"m237.248 512 265.408 265.344a32 32 0 0 1-45.312 45.312l-288-288a32 32 0 0 1 0-45.312l288-288a32 32 0 1 1 45.312 45.312L237.248 512z"},null,-1)];var Sp=rp(bp,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",xp,wp)}],["__file","back.vue"]]),Cp={name:"Calendar"},Tp={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Mp=[Ti("path",{fill:"currentColor",d:"M128 384v512h768V192H768v32a32 32 0 1 1-64 0v-32H320v32a32 32 0 0 1-64 0v-32H128v128h768v64H128zm192-256h384V96a32 32 0 1 1 64 0v32h160a32 32 0 0 1 32 32v768a32 32 0 0 1-32 32H96a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h160V96a32 32 0 0 1 64 0v32zm-32 384h64a32 32 0 0 1 0 64h-64a32 32 0 0 1 0-64zm0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64zm192-192h64a32 32 0 0 1 0 64h-64a32 32 0 0 1 0-64zm0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64zm192-192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64zm0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64z"},null,-1)];var Ep=rp(Cp,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",Tp,Mp)}],["__file","calendar.vue"]]),Ap={name:"CaretRight"},Pp={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Rp=[Ti("path",{fill:"currentColor",d:"M384 192v640l384-320.064z"},null,-1)];var Lp=rp(Ap,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",Pp,Rp)}],["__file","caret-right.vue"]]),kp={name:"CaretTop"},Dp={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Ip=[Ti("path",{fill:"currentColor",d:"M512 320 192 704h639.936z"},null,-1)];var Op=rp(kp,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",Dp,Ip)}],["__file","caret-top.vue"]]),Np={name:"Check"},Bp={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Up=[Ti("path",{fill:"currentColor",d:"M406.656 706.944 195.84 496.256a32 32 0 1 0-45.248 45.248l256 256 512-512a32 32 0 0 0-45.248-45.248L406.592 706.944z"},null,-1)];var zp=rp(Np,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",Bp,Up)}],["__file","check.vue"]]),Fp={name:"CircleCheckFilled"},Vp={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Gp=[Ti("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896zm-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336L456.192 600.384z"},null,-1)];var Hp=rp(Fp,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",Vp,Gp)}],["__file","circle-check-filled.vue"]]),jp={name:"CircleCheck"},Wp={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Yp=[Ti("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768zm0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896z"},null,-1),Ti("path",{fill:"currentColor",d:"M745.344 361.344a32 32 0 0 1 45.312 45.312l-288 288a32 32 0 0 1-45.312 0l-160-160a32 32 0 1 1 45.312-45.312L480 626.752l265.344-265.408z"},null,-1)];var $p=rp(jp,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",Wp,Yp)}],["__file","circle-check.vue"]]),Xp={name:"CircleCloseFilled"},qp={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Kp=[Ti("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896zm0 393.664L407.936 353.6a38.4 38.4 0 1 0-54.336 54.336L457.664 512 353.6 616.064a38.4 38.4 0 1 0 54.336 54.336L512 566.336 616.064 670.4a38.4 38.4 0 1 0 54.336-54.336L566.336 512 670.4 407.936a38.4 38.4 0 1 0-54.336-54.336L512 457.664z"},null,-1)];var Zp=rp(Xp,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",qp,Kp)}],["__file","circle-close-filled.vue"]]),Jp={name:"CircleClose"},Qp={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},ef=[Ti("path",{fill:"currentColor",d:"m466.752 512-90.496-90.496a32 32 0 0 1 45.248-45.248L512 466.752l90.496-90.496a32 32 0 1 1 45.248 45.248L557.248 512l90.496 90.496a32 32 0 1 1-45.248 45.248L512 557.248l-90.496 90.496a32 32 0 0 1-45.248-45.248L466.752 512z"},null,-1),Ti("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768zm0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896z"},null,-1)];var tf=rp(Jp,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",Qp,ef)}],["__file","circle-close.vue"]]),nf={name:"Clock"},rf={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},af=[Ti("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768zm0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896z"},null,-1),Ti("path",{fill:"currentColor",d:"M480 256a32 32 0 0 1 32 32v256a32 32 0 0 1-64 0V288a32 32 0 0 1 32-32z"},null,-1),Ti("path",{fill:"currentColor",d:"M480 512h256q32 0 32 32t-32 32H480q-32 0-32-32t32-32z"},null,-1)];var sf=rp(nf,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",rf,af)}],["__file","clock.vue"]]),of={name:"Close"},lf={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},uf=[Ti("path",{fill:"currentColor",d:"M764.288 214.592 512 466.88 259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512 214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z"},null,-1)];var cf=rp(of,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",lf,uf)}],["__file","close.vue"]]),df={name:"DArrowLeft"},hf={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},pf=[Ti("path",{fill:"currentColor",d:"M529.408 149.376a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L259.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L197.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224zm256 0a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L515.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L453.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224z"},null,-1)];var ff=rp(df,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",hf,pf)}],["__file","d-arrow-left.vue"]]),mf={name:"DArrowRight"},gf={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},vf=[Ti("path",{fill:"currentColor",d:"M452.864 149.312a29.12 29.12 0 0 1 41.728.064L826.24 489.664a32 32 0 0 1 0 44.672L494.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L764.736 512 452.864 192a30.592 30.592 0 0 1 0-42.688zm-256 0a29.12 29.12 0 0 1 41.728.064L570.24 489.664a32 32 0 0 1 0 44.672L238.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L508.736 512 196.864 192a30.592 30.592 0 0 1 0-42.688z"},null,-1)];var yf=rp(mf,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",gf,vf)}],["__file","d-arrow-right.vue"]]),_f={name:"Delete"},bf={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},xf=[Ti("path",{fill:"currentColor",d:"M160 256H96a32 32 0 0 1 0-64h256V95.936a32 32 0 0 1 32-32h256a32 32 0 0 1 32 32V192h256a32 32 0 1 1 0 64h-64v672a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32V256zm448-64v-64H416v64h192zM224 896h576V256H224v640zm192-128a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32zm192 0a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32z"},null,-1)];var wf=rp(_f,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",bf,xf)}],["__file","delete.vue"]]),Sf={name:"Document"},Cf={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Tf=[Ti("path",{fill:"currentColor",d:"M832 384H576V128H192v768h640V384zm-26.496-64L640 154.496V320h165.504zM160 64h480l256 256v608a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V96a32 32 0 0 1 32-32zm160 448h384v64H320v-64zm0-192h160v64H320v-64zm0 384h384v64H320v-64z"},null,-1)];var Mf=rp(Sf,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",Cf,Tf)}],["__file","document.vue"]]),Ef={name:"FullScreen"},Af={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Pf=[Ti("path",{fill:"currentColor",d:"m160 96.064 192 .192a32 32 0 0 1 0 64l-192-.192V352a32 32 0 0 1-64 0V96h64v.064zm0 831.872V928H96V672a32 32 0 1 1 64 0v191.936l192-.192a32 32 0 1 1 0 64l-192 .192zM864 96.064V96h64v256a32 32 0 1 1-64 0V160.064l-192 .192a32 32 0 1 1 0-64l192-.192zm0 831.872-192-.192a32 32 0 0 1 0-64l192 .192V672a32 32 0 1 1 64 0v256h-64v-.064z"},null,-1)];var Rf=rp(Ef,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",Af,Pf)}],["__file","full-screen.vue"]]),Lf={name:"Hide"},kf={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Df=[Ti("path",{fill:"currentColor",d:"M876.8 156.8c0-9.6-3.2-16-9.6-22.4-6.4-6.4-12.8-9.6-22.4-9.6-9.6 0-16 3.2-22.4 9.6L736 220.8c-64-32-137.6-51.2-224-60.8-160 16-288 73.6-377.6 176C44.8 438.4 0 496 0 512s48 73.6 134.4 176c22.4 25.6 44.8 48 73.6 67.2l-86.4 89.6c-6.4 6.4-9.6 12.8-9.6 22.4 0 9.6 3.2 16 9.6 22.4 6.4 6.4 12.8 9.6 22.4 9.6 9.6 0 16-3.2 22.4-9.6l704-710.4c3.2-6.4 6.4-12.8 6.4-22.4Zm-646.4 528c-76.8-70.4-128-128-153.6-172.8 28.8-48 80-105.6 153.6-172.8C304 272 400 230.4 512 224c64 3.2 124.8 19.2 176 44.8l-54.4 54.4C598.4 300.8 560 288 512 288c-64 0-115.2 22.4-160 64s-64 96-64 160c0 48 12.8 89.6 35.2 124.8L256 707.2c-9.6-6.4-19.2-16-25.6-22.4Zm140.8-96c-12.8-22.4-19.2-48-19.2-76.8 0-44.8 16-83.2 48-112 32-28.8 67.2-48 112-48 28.8 0 54.4 6.4 73.6 19.2L371.2 588.8ZM889.599 336c-12.8-16-28.8-28.8-41.6-41.6l-48 48c73.6 67.2 124.8 124.8 150.4 169.6-28.8 48-80 105.6-153.6 172.8-73.6 67.2-172.8 108.8-284.8 115.2-51.2-3.2-99.2-12.8-140.8-28.8l-48 48c57.6 22.4 118.4 38.4 188.8 44.8 160-16 288-73.6 377.6-176C979.199 585.6 1024 528 1024 512s-48.001-73.6-134.401-176Z"},null,-1),Ti("path",{fill:"currentColor",d:"M511.998 672c-12.8 0-25.6-3.2-38.4-6.4l-51.2 51.2c28.8 12.8 57.6 19.2 89.6 19.2 64 0 115.2-22.4 160-64 41.6-41.6 64-96 64-160 0-32-6.4-64-19.2-89.6l-51.2 51.2c3.2 12.8 6.4 25.6 6.4 38.4 0 44.8-16 83.2-48 112-32 28.8-67.2 48-112 48Z"},null,-1)];var If=rp(Lf,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",kf,Df)}],["__file","hide.vue"]]),Of={name:"InfoFilled"},Nf={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Bf=[Ti("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896.064A448 448 0 0 1 512 64zm67.2 275.072c33.28 0 60.288-23.104 60.288-57.344s-27.072-57.344-60.288-57.344c-33.28 0-60.16 23.104-60.16 57.344s26.88 57.344 60.16 57.344zM590.912 699.2c0-6.848 2.368-24.64 1.024-34.752l-52.608 60.544c-10.88 11.456-24.512 19.392-30.912 17.28a12.992 12.992 0 0 1-8.256-14.72l87.68-276.992c7.168-35.136-12.544-67.2-54.336-71.296-44.096 0-108.992 44.736-148.48 101.504 0 6.784-1.28 23.68.064 33.792l52.544-60.608c10.88-11.328 23.552-19.328 29.952-17.152a12.8 12.8 0 0 1 7.808 16.128L388.48 728.576c-10.048 32.256 8.96 63.872 55.04 71.04 67.84 0 107.904-43.648 147.456-100.416z"},null,-1)];var Uf=rp(Of,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",Nf,Bf)}],["__file","info-filled.vue"]]),zf={name:"Loading"},Ff={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Vf=[Ti("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32zm0 640a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V736a32 32 0 0 1 32-32zm448-192a32 32 0 0 1-32 32H736a32 32 0 1 1 0-64h192a32 32 0 0 1 32 32zm-640 0a32 32 0 0 1-32 32H96a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32zM195.2 195.2a32 32 0 0 1 45.248 0L376.32 331.008a32 32 0 0 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm452.544 452.544a32 32 0 0 1 45.248 0L828.8 783.552a32 32 0 0 1-45.248 45.248L647.744 692.992a32 32 0 0 1 0-45.248zM828.8 195.264a32 32 0 0 1 0 45.184L692.992 376.32a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0zm-452.544 452.48a32 32 0 0 1 0 45.248L240.448 828.8a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0z"},null,-1)];var Gf=rp(zf,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",Ff,Vf)}],["__file","loading.vue"]]),Hf={name:"Minus"},jf={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Wf=[Ti("path",{fill:"currentColor",d:"M128 544h768a32 32 0 1 0 0-64H128a32 32 0 0 0 0 64z"},null,-1)];var Yf=rp(Hf,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",jf,Wf)}],["__file","minus.vue"]]),$f={name:"MoreFilled"},Xf={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},qf=[Ti("path",{fill:"currentColor",d:"M176 416a112 112 0 1 1 0 224 112 112 0 0 1 0-224zm336 0a112 112 0 1 1 0 224 112 112 0 0 1 0-224zm336 0a112 112 0 1 1 0 224 112 112 0 0 1 0-224z"},null,-1)];var Kf=rp($f,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",Xf,qf)}],["__file","more-filled.vue"]]),Zf={name:"More"},Jf={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Qf=[Ti("path",{fill:"currentColor",d:"M176 416a112 112 0 1 0 0 224 112 112 0 0 0 0-224m0 64a48 48 0 1 1 0 96 48 48 0 0 1 0-96zm336-64a112 112 0 1 1 0 224 112 112 0 0 1 0-224zm0 64a48 48 0 1 0 0 96 48 48 0 0 0 0-96zm336-64a112 112 0 1 1 0 224 112 112 0 0 1 0-224zm0 64a48 48 0 1 0 0 96 48 48 0 0 0 0-96z"},null,-1)];var em=rp(Zf,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",Jf,Qf)}],["__file","more.vue"]]),tm={name:"PictureFilled"},nm={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},rm=[Ti("path",{fill:"currentColor",d:"M96 896a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h832a32 32 0 0 1 32 32v704a32 32 0 0 1-32 32H96zm315.52-228.48-68.928-68.928a32 32 0 0 0-45.248 0L128 768.064h778.688l-242.112-290.56a32 32 0 0 0-49.216 0L458.752 665.408a32 32 0 0 1-47.232 2.112zM256 384a96 96 0 1 0 192.064-.064A96 96 0 0 0 256 384z"},null,-1)];var im=rp(tm,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",nm,rm)}],["__file","picture-filled.vue"]]),am={name:"Plus"},sm={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},om=[Ti("path",{fill:"currentColor",d:"M480 480V128a32 32 0 0 1 64 0v352h352a32 32 0 1 1 0 64H544v352a32 32 0 1 1-64 0V544H128a32 32 0 0 1 0-64h352z"},null,-1)];var lm=rp(am,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",sm,om)}],["__file","plus.vue"]]),um={name:"QuestionFilled"},cm={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},dm=[Ti("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896zm23.744 191.488c-52.096 0-92.928 14.784-123.2 44.352-30.976 29.568-45.76 70.4-45.76 122.496h80.256c0-29.568 5.632-52.8 17.6-68.992 13.376-19.712 35.2-28.864 66.176-28.864 23.936 0 42.944 6.336 56.32 19.712 12.672 13.376 19.712 31.68 19.712 54.912 0 17.6-6.336 34.496-19.008 49.984l-8.448 9.856c-45.76 40.832-73.216 70.4-82.368 89.408-9.856 19.008-14.08 42.24-14.08 68.992v9.856h80.96v-9.856c0-16.896 3.52-31.68 10.56-45.76 6.336-12.672 15.488-24.64 28.16-35.2 33.792-29.568 54.208-48.576 60.544-55.616 16.896-22.528 26.048-51.392 26.048-86.592 0-42.944-14.08-76.736-42.24-101.376-28.16-25.344-65.472-37.312-111.232-37.312zm-12.672 406.208a54.272 54.272 0 0 0-38.72 14.784 49.408 49.408 0 0 0-15.488 38.016c0 15.488 4.928 28.16 15.488 38.016A54.848 54.848 0 0 0 523.072 768c15.488 0 28.16-4.928 38.72-14.784a51.52 51.52 0 0 0 16.192-38.72 51.968 51.968 0 0 0-15.488-38.016 55.936 55.936 0 0 0-39.424-14.784z"},null,-1)];var hm=rp(um,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",cm,dm)}],["__file","question-filled.vue"]]),pm={name:"RefreshLeft"},fm={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},mm=[Ti("path",{fill:"currentColor",d:"M289.088 296.704h92.992a32 32 0 0 1 0 64H232.96a32 32 0 0 1-32-32V179.712a32 32 0 0 1 64 0v50.56a384 384 0 0 1 643.84 282.88 384 384 0 0 1-383.936 384 384 384 0 0 1-384-384h64a320 320 0 1 0 640 0 320 320 0 0 0-555.712-216.448z"},null,-1)];var gm=rp(pm,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",fm,mm)}],["__file","refresh-left.vue"]]),vm={name:"RefreshRight"},ym={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_m=[Ti("path",{fill:"currentColor",d:"M784.512 230.272v-50.56a32 32 0 1 1 64 0v149.056a32 32 0 0 1-32 32H667.52a32 32 0 1 1 0-64h92.992A320 320 0 1 0 524.8 833.152a320 320 0 0 0 320-320h64a384 384 0 0 1-384 384 384 384 0 0 1-384-384 384 384 0 0 1 643.712-282.88z"},null,-1)];var bm=rp(vm,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",ym,_m)}],["__file","refresh-right.vue"]]),xm={name:"ScaleToOriginal"},wm={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Sm=[Ti("path",{fill:"currentColor",d:"M813.176 180.706a60.235 60.235 0 0 1 60.236 60.235v481.883a60.235 60.235 0 0 1-60.236 60.235H210.824a60.235 60.235 0 0 1-60.236-60.235V240.94a60.235 60.235 0 0 1 60.236-60.235h602.352zm0-60.235H210.824A120.47 120.47 0 0 0 90.353 240.94v481.883a120.47 120.47 0 0 0 120.47 120.47h602.353a120.47 120.47 0 0 0 120.471-120.47V240.94a120.47 120.47 0 0 0-120.47-120.47zm-120.47 180.705a30.118 30.118 0 0 0-30.118 30.118v301.177a30.118 30.118 0 0 0 60.236 0V331.294a30.118 30.118 0 0 0-30.118-30.118zm-361.412 0a30.118 30.118 0 0 0-30.118 30.118v301.177a30.118 30.118 0 1 0 60.236 0V331.294a30.118 30.118 0 0 0-30.118-30.118zM512 361.412a30.118 30.118 0 0 0-30.118 30.117v30.118a30.118 30.118 0 0 0 60.236 0V391.53A30.118 30.118 0 0 0 512 361.412zM512 512a30.118 30.118 0 0 0-30.118 30.118v30.117a30.118 30.118 0 0 0 60.236 0v-30.117A30.118 30.118 0 0 0 512 512z"},null,-1)];var Cm=rp(xm,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",wm,Sm)}],["__file","scale-to-original.vue"]]),Tm={name:"Search"},Mm={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Em=[Ti("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704z"},null,-1)];var Am=rp(Tm,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",Mm,Em)}],["__file","search.vue"]]),Pm={name:"SortDown"},Rm={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Lm=[Ti("path",{fill:"currentColor",d:"M576 96v709.568L333.312 562.816A32 32 0 1 0 288 608l297.408 297.344A32 32 0 0 0 640 882.688V96a32 32 0 0 0-64 0z"},null,-1)];var km=rp(Pm,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",Rm,Lm)}],["__file","sort-down.vue"]]),Dm={name:"SortUp"},Im={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Om=[Ti("path",{fill:"currentColor",d:"M384 141.248V928a32 32 0 1 0 64 0V218.56l242.688 242.688A32 32 0 1 0 736 416L438.592 118.656A32 32 0 0 0 384 141.248z"},null,-1)];var Nm=rp(Dm,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",Im,Om)}],["__file","sort-up.vue"]]),Bm={name:"StarFilled"},Um={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},zm=[Ti("path",{fill:"currentColor",d:"M283.84 867.84 512 747.776l228.16 119.936a6.4 6.4 0 0 0 9.28-6.72l-43.52-254.08 184.512-179.904a6.4 6.4 0 0 0-3.52-10.88l-255.104-37.12L517.76 147.904a6.4 6.4 0 0 0-11.52 0L392.192 379.072l-255.104 37.12a6.4 6.4 0 0 0-3.52 10.88L318.08 606.976l-43.584 254.08a6.4 6.4 0 0 0 9.28 6.72z"},null,-1)];var Fm=rp(Bm,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",Um,zm)}],["__file","star-filled.vue"]]),Vm={name:"Star"},Gm={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Hm=[Ti("path",{fill:"currentColor",d:"m512 747.84 228.16 119.936a6.4 6.4 0 0 0 9.28-6.72l-43.52-254.08 184.512-179.904a6.4 6.4 0 0 0-3.52-10.88l-255.104-37.12L517.76 147.904a6.4 6.4 0 0 0-11.52 0L392.192 379.072l-255.104 37.12a6.4 6.4 0 0 0-3.52 10.88L318.08 606.976l-43.584 254.08a6.4 6.4 0 0 0 9.28 6.72L512 747.84zM313.6 924.48a70.4 70.4 0 0 1-102.144-74.24l37.888-220.928L88.96 472.96A70.4 70.4 0 0 1 128 352.896l221.76-32.256 99.2-200.96a70.4 70.4 0 0 1 126.208 0l99.2 200.96 221.824 32.256a70.4 70.4 0 0 1 39.04 120.064L774.72 629.376l37.888 220.928a70.4 70.4 0 0 1-102.144 74.24L512 820.096l-198.4 104.32z"},null,-1)];var jm=rp(Vm,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",Gm,Hm)}],["__file","star.vue"]]),Wm={name:"SuccessFilled"},Ym={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},$m=[Ti("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896zm-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336L456.192 600.384z"},null,-1)];var Xm=rp(Wm,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",Ym,$m)}],["__file","success-filled.vue"]]),qm={name:"View"},Km={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Zm=[Ti("path",{fill:"currentColor",d:"M512 160c320 0 512 352 512 352S832 864 512 864 0 512 0 512s192-352 512-352zm0 64c-225.28 0-384.128 208.064-436.8 288 52.608 79.872 211.456 288 436.8 288 225.28 0 384.128-208.064 436.8-288-52.608-79.872-211.456-288-436.8-288zm0 64a224 224 0 1 1 0 448 224 224 0 0 1 0-448zm0 64a160.192 160.192 0 0 0-160 160c0 88.192 71.744 160 160 160s160-71.808 160-160-71.744-160-160-160z"},null,-1)];var Jm=rp(qm,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",Km,Zm)}],["__file","view.vue"]]),Qm={name:"WarningFilled"},eg={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},tg=[Ti("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896zm0 192a58.432 58.432 0 0 0-58.24 63.744l23.36 256.384a35.072 35.072 0 0 0 69.76 0l23.296-256.384A58.432 58.432 0 0 0 512 256zm0 512a51.2 51.2 0 1 0 0-102.4 51.2 51.2 0 0 0 0 102.4z"},null,-1)];var ng=rp(Qm,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",eg,tg)}],["__file","warning-filled.vue"]]),rg={name:"ZoomIn"},ig={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},ag=[Ti("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704zm-32-384v-96a32 32 0 0 1 64 0v96h96a32 32 0 0 1 0 64h-96v96a32 32 0 0 1-64 0v-96h-96a32 32 0 0 1 0-64h96z"},null,-1)];var sg=rp(rg,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",ig,ag)}],["__file","zoom-in.vue"]]),og={name:"ZoomOut"},lg={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},ug=[Ti("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704zM352 448h256a32 32 0 0 1 0 64H352a32 32 0 0 1 0-64z"},null,-1)];var cg=rp(og,[["render",function(e,t,n,r,i,a){return fi(),yi("svg",lg,ug)}],["__file","zoom-out.vue"]]);const dg="__epPropKey",hg=(e,t)=>{if(!O(e)||O(n=e)&&n[dg])return e;var n;const{values:r,required:i,default:a,type:s,validator:o}=e,l=r||o?t=>{let n=!1,i=[];if(r&&(i=Array.from(r),M(e,"default")&&i.push(a),n||(n=i.includes(t))),o&&(n||(n=o(t))),!n&&i.length>0){[...new Set(i)].map((e=>JSON.stringify(e))).join(", ");JSON.stringify(t)}return n}:void 0,u={type:s,required:!!i,validator:l,[dg]:!0};return M(e,"default")&&(u.default=a),u},pg=e=>Mh(Object.entries(e).map((([e,t])=>[e,hg(t)]))),fg=[String,Object,Function],mg={Close:cf},gg={Close:cf,SuccessFilled:Xm,InfoFilled:Uf,WarningFilled:ng,CircleCloseFilled:Zp},vg={success:Xm,warning:ng,error:Zp,info:Uf},yg={validating:Gf,success:$p,error:tf},_g=(e,t)=>{if(e.install=n=>{for(const r of[e,...Object.values(null!=t?t:{})])n.component(r.name,r)},t)for(const[n,r]of Object.entries(t))e[n]=r;return e},bg=(e,t)=>(e.install=n=>{e._context=n._context,n.config.globalProperties[t]=e},e),xg=e=>(e.install=y,e),wg=(...e)=>t=>{e.forEach((e=>{k(e)?e(t):e.value=t}))},Sg={tab:"Tab",enter:"Enter",space:"Space",left:"ArrowLeft",up:"ArrowUp",right:"ArrowRight",down:"ArrowDown",esc:"Escape",delete:"Delete",backspace:"Backspace",numpadEnter:"NumpadEnter",pageUp:"PageUp",pageDown:"PageDown",home:"Home",end:"End"},Cg=["sun","mon","tue","wed","thu","fri","sat"],Tg="update:modelValue",Mg="change",Eg="input",Ag=Symbol("INSTALLED_KEY"),Pg=["","default","small","large"],Rg={large:40,default:32,small:24},Lg=e=>["",...Pg].includes(e);var kg=(e=>(e[e.TEXT=1]="TEXT",e[e.CLASS=2]="CLASS",e[e.STYLE=4]="STYLE",e[e.PROPS=8]="PROPS",e[e.FULL_PROPS=16]="FULL_PROPS",e[e.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",e[e.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",e[e.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",e[e.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",e[e.NEED_PATCH=512]="NEED_PATCH",e[e.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",e[e.HOISTED=-1]="HOISTED",e[e.BAIL=-2]="BAIL",e))(kg||{});function Dg(e){return bi(e)&&e.type===li}function Ig(e){return bi(e)&&!Dg(e)&&!function(e){return bi(e)&&e.type===ci}(e)}const Og=e=>{const t=E(e)?e:[e],n=[];return t.forEach((e=>{var t;E(e)?n.push(...Og(e)):bi(e)&&E(e.children)?n.push(...Og(e.children)):(n.push(e),bi(e)&&(null==(t=e.component)?void 0:t.subTree)&&n.push(...Og(e.component.subTree)))})),n},Ng=e=>[...new Set(e)],Bg=e=>e||0===e?Array.isArray(e)?e:[e]:[],Ug=()=>Os&&/firefox/i.test(window.navigator.userAgent),zg=e=>/([(\uAC00-\uD7AF)|(\u3130-\u318F)])+/gi.test(e),Fg=e=>Os?window.requestAnimationFrame(e):setTimeout(e,16),Vg=e=>Os?window.cancelAnimationFrame(e):clearTimeout(e),Gg=()=>Math.floor(1e4*Math.random()),Hg=["class","style"],jg=/^on[A-Z]/,Wg=(e={})=>{const{excludeListeners:t=!1,excludeKeys:n}=e,r=Ki((()=>((null==n?void 0:n.value)||[]).concat(Hg))),i=Fi();return Ki(i?()=>{var e;return Mh(Object.entries(null==(e=i.proxy)?void 0:e.$attrs).filter((([e])=>!(r.value.includes(e)||t&&jg.test(e)))))}:()=>({}))},Yg=({from:e,replacement:t,scope:n,version:r,ref:i,type:a="API"},s)=>{Mn((()=>Dt(s)),(e=>{}),{immediate:!0})},$g=(e,t,n)=>{let r={offsetX:0,offsetY:0};const i=t=>{const n=t.clientX,i=t.clientY,{offsetX:a,offsetY:s}=r,o=e.value.getBoundingClientRect(),l=o.left,u=o.top,c=o.width,d=o.height,h=document.documentElement.clientWidth,p=document.documentElement.clientHeight,f=-l+a,m=-u+s,g=h-l-c+a,v=p-u-d+s,y=t=>{const o=Math.min(Math.max(a+t.clientX-n,f),g),l=Math.min(Math.max(s+t.clientY-i,m),v);r={offsetX:o,offsetY:l},e.value.style.transform=`translate(${Zh(o)}, ${Zh(l)})`},_=()=>{document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",_)};document.addEventListener("mousemove",y),document.addEventListener("mouseup",_)},a=()=>{t.value&&e.value&&t.value.removeEventListener("mousedown",i)};Kn((()=>{Cn((()=>{n.value?t.value&&e.value&&t.value.addEventListener("mousedown",i):a()}))})),Qn((()=>{a()}))};var Xg={name:"en",el:{colorpicker:{confirm:"OK",clear:"Clear",defaultLabel:"color picker",description:"current color is {color}. press enter to select a new color."},datepicker:{now:"Now",today:"Today",cancel:"Cancel",clear:"Clear",confirm:"OK",dateTablePrompt:"Use the arrow keys and enter to select the day of the month",monthTablePrompt:"Use the arrow keys and enter to select the month",yearTablePrompt:"Use the arrow keys and enter to select the year",selectedDate:"Selected date",selectDate:"Select date",selectTime:"Select time",startDate:"Start Date",startTime:"Start Time",endDate:"End Date",endTime:"End Time",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",year:"",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",week:"week",weeks:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},weeksFull:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"},months:{jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"}},inputNumber:{decrease:"decrease number",increase:"increase number"},select:{loading:"Loading",noMatch:"No matching data",noData:"No data",placeholder:"Select"},dropdown:{toggleDropdown:"Toggle Dropdown"},cascader:{noMatch:"No matching data",loading:"Loading",placeholder:"Select",noData:"No data"},pagination:{goto:"Go to",pagesize:"/page",total:"Total {total}",pageClassifier:"",page:"Page",prev:"Go to previous page",next:"Go to next page",currentPage:"page {pager}",prevPages:"Previous {pager} pages",nextPages:"Next {pager} pages",deprecationWarning:"Deprecated usages detected, please refer to the el-pagination documentation for more details"},dialog:{close:"Close this dialog"},drawer:{close:"Close this dialog"},messagebox:{title:"Message",confirm:"OK",cancel:"Cancel",error:"Illegal input",close:"Close this dialog"},upload:{deleteTip:"press delete to remove",delete:"Delete",preview:"Preview",continue:"Continue"},slider:{defaultLabel:"slider between {min} and {max}",defaultRangeStartLabel:"pick start value",defaultRangeEndLabel:"pick end value"},table:{emptyText:"No Data",confirmFilter:"Confirm",resetFilter:"Reset",clearFilter:"All",sumText:"Sum"},tree:{emptyText:"No Data"},transfer:{noMatch:"No matching data",noData:"No data",titles:["List 1","List 2"],filterPlaceholder:"Enter keyword",noCheckedFormat:"{total} items",hasCheckedFormat:"{checked}/{total} checked"},image:{error:"FAILED"},pageHeader:{title:"Back"},popconfirm:{confirmButtonText:"Yes",cancelButtonText:"No"}}};const qg=e=>(t,n)=>Kg(t,n,Dt(e)),Kg=(e,t,n)=>Vu(n,e,e).replace(/\{(\w+)\}/g,((e,n)=>{var r;return`${null!=(r=null==t?void 0:t[n])?r:`{${n}}`}`})),Zg=Symbol("localeContextKey"),Jg=e=>{const t=e||Sn(Zg,At());return(e=>({lang:Ki((()=>Dt(e).name)),locale:Et(e)?e:At(e),t:qg(e)}))(Ki((()=>t.value||Xg)))},Qg="el",ev=(e,t,n,r,i)=>{let a=`${e}-${t}`;return n&&(a+=`-${n}`),r&&(a+=`__${r}`),i&&(a+=`--${i}`),a},tv=Symbol("namespaceContextKey"),nv=e=>{const t=e||Sn(tv,At(Qg));return Ki((()=>Dt(t)||Qg))},rv=(e,t)=>{const n=nv(t);return{namespace:n,b:(t="")=>ev(n.value,e,t,"",""),e:t=>t?ev(n.value,e,"",t,""):"",m:t=>t?ev(n.value,e,"","",t):"",be:(t,r)=>t&&r?ev(n.value,e,t,r,""):"",em:(t,r)=>t&&r?ev(n.value,e,"",t,r):"",bm:(t,r)=>t&&r?ev(n.value,e,t,"",r):"",bem:(t,r,i)=>t&&r&&i?ev(n.value,e,t,r,i):"",is:(e,...t)=>{const n=!(t.length>=1)||t[0];return e&&n?`is-${e}`:""},cssVar:e=>{const t={};for(const r in e)e[r]&&(t[`--${n.value}-${r}`]=e[r]);return t},cssVarName:e=>`--${n.value}-${e}`,cssVarBlock:t=>{const r={};for(const i in t)t[i]&&(r[`--${n.value}-${e}-${i}`]=t[i]);return r},cssVarBlockName:t=>`--${n.value}-${e}-${t}`}},iv=(e,t={})=>{Et(e)||Wh("[useLockscreen]","You need to pass a ref param to this function");const n=t.ns||rv("popup"),r=Vt((()=>n.bm("parent","hidden")));if(!Os||$h(document.body,r.value))return;let i=0,a=!1,s="0";const o=()=>{setTimeout((()=>{qh(null==document?void 0:document.body,r.value),a&&document&&(document.body.style.width=s)}),200)};Mn(e,(e=>{if(!e)return void o();a=!$h(document.body,r.value),a&&(s=document.body.style.width),i=tp(n.namespace.value);const t=document.documentElement.clientHeight<document.body.scrollHeight,l=Kh(document.body,"overflowY");i>0&&(t||"scroll"===l)&&a&&(document.body.style.width=`calc(100% - ${i}px)`),Xh(document.body,r.value)})),oe((()=>o()))},av=hg({type:Boolean,default:null}),sv=hg({type:Function}),ov=e=>{const t=`update:${e}`,n=`onUpdate:${e}`;return{useModelToggle:({indicator:r,toggleReason:i,shouldHideWhenRouteChanges:a,shouldProceed:s,onShow:o,onHide:l})=>{const u=Fi(),{emit:c}=u,d=u.props,h=Ki((()=>k(d[n]))),p=Ki((()=>null===d[e])),f=e=>{!0!==r.value&&(r.value=!0,i&&(i.value=e),k(o)&&o(e))},m=e=>{!1!==r.value&&(r.value=!1,i&&(i.value=e),k(l)&&l(e))},g=e=>{if(!0===d.disabled||k(s)&&!s())return;const n=h.value&&Os;n&&c(t,!0),!p.value&&n||f(e)},v=e=>{if(!0===d.disabled||!Os)return;const n=h.value&&Os;n&&c(t,!1),!p.value&&n||m(e)},y=e=>{Ns(e)&&(d.disabled&&e?h.value&&c(t,!1):r.value!==e&&(e?f():m()))};return Mn((()=>d[e]),y),a&&void 0!==u.appContext.config.globalProperties.$route&&Mn((()=>({...u.proxy.$route})),(()=>{a.value&&r.value&&v()})),Kn((()=>{y(d[e])})),{hide:v,show:g,toggle:()=>{r.value?v():g()},hasUpdateHandler:h}},useModelToggleProps:{[e]:av,[n]:sv},useModelToggleEmits:[t]}};ov("modelValue");const lv=e=>{const t=Fi();return Ki((()=>{var n,r;return null==(r=null==(n=null==t?void 0:t.proxy)?void 0:n.$props)?void 0:r[e]}))};var uv="top",cv="bottom",dv="right",hv="left",pv="auto",fv=[uv,cv,dv,hv],mv="start",gv="end",vv="clippingParents",yv="viewport",_v="popper",bv="reference",xv=fv.reduce((function(e,t){return e.concat([t+"-"+mv,t+"-"+gv])}),[]),wv=[].concat(fv,[pv]).reduce((function(e,t){return e.concat([t,t+"-"+mv,t+"-"+gv])}),[]),Sv=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function Cv(e){return e?(e.nodeName||"").toLowerCase():null}function Tv(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Mv(e){return e instanceof Tv(e).Element||e instanceof Element}function Ev(e){return e instanceof Tv(e).HTMLElement||e instanceof HTMLElement}function Av(e){return"undefined"!=typeof ShadowRoot&&(e instanceof Tv(e).ShadowRoot||e instanceof ShadowRoot)}var Pv={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var n=t.styles[e]||{},r=t.attributes[e]||{},i=t.elements[e];!Ev(i)||!Cv(i)||(Object.assign(i.style,n),Object.keys(r).forEach((function(e){var t=r[e];!1===t?i.removeAttribute(e):i.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach((function(e){var r=t.elements[e],i=t.attributes[e]||{},a=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:n[e]).reduce((function(e,t){return e[t]="",e}),{});!Ev(r)||!Cv(r)||(Object.assign(r.style,a),Object.keys(i).forEach((function(e){r.removeAttribute(e)})))}))}},requires:["computeStyles"]};function Rv(e){return e.split("-")[0]}var Lv=Math.max,kv=Math.min,Dv=Math.round;function Iv(e,t){void 0===t&&(t=!1);var n=e.getBoundingClientRect(),r=1,i=1;if(Ev(e)&&t){var a=e.offsetHeight,s=e.offsetWidth;s>0&&(r=Dv(n.width)/s||1),a>0&&(i=Dv(n.height)/a||1)}return{width:n.width/r,height:n.height/i,top:n.top/i,right:n.right/r,bottom:n.bottom/i,left:n.left/r,x:n.left/r,y:n.top/i}}function Ov(e){var t=Iv(e),n=e.offsetWidth,r=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:r}}function Nv(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&Av(n)){var r=t;do{if(r&&e.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function Bv(e){return Tv(e).getComputedStyle(e)}function Uv(e){return["table","td","th"].indexOf(Cv(e))>=0}function zv(e){return((Mv(e)?e.ownerDocument:e.document)||window.document).documentElement}function Fv(e){return"html"===Cv(e)?e:e.assignedSlot||e.parentNode||(Av(e)?e.host:null)||zv(e)}function Vv(e){return Ev(e)&&"fixed"!==Bv(e).position?e.offsetParent:null}function Gv(e){for(var t=Tv(e),n=Vv(e);n&&Uv(n)&&"static"===Bv(n).position;)n=Vv(n);return n&&("html"===Cv(n)||"body"===Cv(n)&&"static"===Bv(n).position)?t:n||function(e){var t=-1!==navigator.userAgent.toLowerCase().indexOf("firefox");if(-1!==navigator.userAgent.indexOf("Trident")&&Ev(e)&&"fixed"===Bv(e).position)return null;var n=Fv(e);for(Av(n)&&(n=n.host);Ev(n)&&["html","body"].indexOf(Cv(n))<0;){var r=Bv(n);if("none"!==r.transform||"none"!==r.perspective||"paint"===r.contain||-1!==["transform","perspective"].indexOf(r.willChange)||t&&"filter"===r.willChange||t&&r.filter&&"none"!==r.filter)return n;n=n.parentNode}return null}(e)||t}function Hv(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function jv(e,t,n){return Lv(e,kv(t,n))}function Wv(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function Yv(e,t){return t.reduce((function(t,n){return t[n]=e,t}),{})}var $v={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,n=e.state,r=e.name,i=e.options,a=n.elements.arrow,s=n.modifiersData.popperOffsets,o=Rv(n.placement),l=Hv(o),u=[hv,dv].indexOf(o)>=0?"height":"width";if(a&&s){var c=function(e,t){return Wv("number"!=typeof(e="function"==typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:Yv(e,fv))}(i.padding,n),d=Ov(a),h="y"===l?uv:hv,p="y"===l?cv:dv,f=n.rects.reference[u]+n.rects.reference[l]-s[l]-n.rects.popper[u],m=s[l]-n.rects.reference[l],g=Gv(a),v=g?"y"===l?g.clientHeight||0:g.clientWidth||0:0,y=f/2-m/2,_=c[h],b=v-d[u]-c[p],x=v/2-d[u]/2+y,w=jv(_,x,b),S=l;n.modifiersData[r]=((t={})[S]=w,t.centerOffset=w-x,t)}},effect:function(e){var t=e.state,n=e.options.element,r=void 0===n?"[data-popper-arrow]":n;null!=r&&("string"==typeof r&&!(r=t.elements.popper.querySelector(r))||!Nv(t.elements.popper,r)||(t.elements.arrow=r))},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Xv(e){return e.split("-")[1]}var qv={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Kv(e){var t,n=e.popper,r=e.popperRect,i=e.placement,a=e.variation,s=e.offsets,o=e.position,l=e.gpuAcceleration,u=e.adaptive,c=e.roundOffsets,d=e.isFixed,h=s.x,p=void 0===h?0:h,f=s.y,m=void 0===f?0:f,g="function"==typeof c?c({x:p,y:m}):{x:p,y:m};p=g.x,m=g.y;var v=s.hasOwnProperty("x"),y=s.hasOwnProperty("y"),_=hv,b=uv,x=window;if(u){var w=Gv(n),S="clientHeight",C="clientWidth";if(w===Tv(n)&&("static"!==Bv(w=zv(n)).position&&"absolute"===o&&(S="scrollHeight",C="scrollWidth")),i===uv||(i===hv||i===dv)&&a===gv)b=cv,m-=(d&&w===x&&x.visualViewport?x.visualViewport.height:w[S])-r.height,m*=l?1:-1;if(i===hv||(i===uv||i===cv)&&a===gv)_=dv,p-=(d&&w===x&&x.visualViewport?x.visualViewport.width:w[C])-r.width,p*=l?1:-1}var T,M=Object.assign({position:o},u&&qv),E=!0===c?function(e){var t=e.x,n=e.y,r=window.devicePixelRatio||1;return{x:Dv(t*r)/r||0,y:Dv(n*r)/r||0}}({x:p,y:m}):{x:p,y:m};return p=E.x,m=E.y,l?Object.assign({},M,((T={})[b]=y?"0":"",T[_]=v?"0":"",T.transform=(x.devicePixelRatio||1)<=1?"translate("+p+"px, "+m+"px)":"translate3d("+p+"px, "+m+"px, 0)",T)):Object.assign({},M,((t={})[b]=y?m+"px":"",t[_]=v?p+"px":"",t.transform="",t))}var Zv={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,n=e.options,r=n.gpuAcceleration,i=void 0===r||r,a=n.adaptive,s=void 0===a||a,o=n.roundOffsets,l=void 0===o||o,u={placement:Rv(t.placement),variation:Xv(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:i,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,Kv(Object.assign({},u,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:s,roundOffsets:l})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,Kv(Object.assign({},u,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},Jv={passive:!0};var Qv={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,n=e.instance,r=e.options,i=r.scroll,a=void 0===i||i,s=r.resize,o=void 0===s||s,l=Tv(t.elements.popper),u=[].concat(t.scrollParents.reference,t.scrollParents.popper);return a&&u.forEach((function(e){e.addEventListener("scroll",n.update,Jv)})),o&&l.addEventListener("resize",n.update,Jv),function(){a&&u.forEach((function(e){e.removeEventListener("scroll",n.update,Jv)})),o&&l.removeEventListener("resize",n.update,Jv)}},data:{}},ey={left:"right",right:"left",bottom:"top",top:"bottom"};function ty(e){return e.replace(/left|right|bottom|top/g,(function(e){return ey[e]}))}var ny={start:"end",end:"start"};function ry(e){return e.replace(/start|end/g,(function(e){return ny[e]}))}function iy(e){var t=Tv(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function ay(e){return Iv(zv(e)).left+iy(e).scrollLeft}function sy(e){var t=Bv(e),n=t.overflow,r=t.overflowX,i=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+i+r)}function oy(e){return["html","body","#document"].indexOf(Cv(e))>=0?e.ownerDocument.body:Ev(e)&&sy(e)?e:oy(Fv(e))}function ly(e,t){var n;void 0===t&&(t=[]);var r=oy(e),i=r===(null==(n=e.ownerDocument)?void 0:n.body),a=Tv(r),s=i?[a].concat(a.visualViewport||[],sy(r)?r:[]):r,o=t.concat(s);return i?o:o.concat(ly(Fv(s)))}function uy(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function cy(e,t){return t===yv?uy(function(e){var t=Tv(e),n=zv(e),r=t.visualViewport,i=n.clientWidth,a=n.clientHeight,s=0,o=0;return r&&(i=r.width,a=r.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(s=r.offsetLeft,o=r.offsetTop)),{width:i,height:a,x:s+ay(e),y:o}}(e)):Mv(t)?function(e){var t=Iv(e);return t.top=t.top+e.clientTop,t.left=t.left+e.clientLeft,t.bottom=t.top+e.clientHeight,t.right=t.left+e.clientWidth,t.width=e.clientWidth,t.height=e.clientHeight,t.x=t.left,t.y=t.top,t}(t):uy(function(e){var t,n=zv(e),r=iy(e),i=null==(t=e.ownerDocument)?void 0:t.body,a=Lv(n.scrollWidth,n.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),s=Lv(n.scrollHeight,n.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),o=-r.scrollLeft+ay(e),l=-r.scrollTop;return"rtl"===Bv(i||n).direction&&(o+=Lv(n.clientWidth,i?i.clientWidth:0)-a),{width:a,height:s,x:o,y:l}}(zv(e)))}function dy(e,t,n){var r="clippingParents"===t?function(e){var t=ly(Fv(e)),n=["absolute","fixed"].indexOf(Bv(e).position)>=0&&Ev(e)?Gv(e):e;return Mv(n)?t.filter((function(e){return Mv(e)&&Nv(e,n)&&"body"!==Cv(e)})):[]}(e):[].concat(t),i=[].concat(r,[n]),a=i[0],s=i.reduce((function(t,n){var r=cy(e,n);return t.top=Lv(r.top,t.top),t.right=kv(r.right,t.right),t.bottom=kv(r.bottom,t.bottom),t.left=Lv(r.left,t.left),t}),cy(e,a));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}function hy(e){var t,n=e.reference,r=e.element,i=e.placement,a=i?Rv(i):null,s=i?Xv(i):null,o=n.x+n.width/2-r.width/2,l=n.y+n.height/2-r.height/2;switch(a){case uv:t={x:o,y:n.y-r.height};break;case cv:t={x:o,y:n.y+n.height};break;case dv:t={x:n.x+n.width,y:l};break;case hv:t={x:n.x-r.width,y:l};break;default:t={x:n.x,y:n.y}}var u=a?Hv(a):null;if(null!=u){var c="y"===u?"height":"width";switch(s){case mv:t[u]=t[u]-(n[c]/2-r[c]/2);break;case gv:t[u]=t[u]+(n[c]/2-r[c]/2)}}return t}function py(e,t){void 0===t&&(t={});var n=t,r=n.placement,i=void 0===r?e.placement:r,a=n.boundary,s=void 0===a?vv:a,o=n.rootBoundary,l=void 0===o?yv:o,u=n.elementContext,c=void 0===u?_v:u,d=n.altBoundary,h=void 0!==d&&d,p=n.padding,f=void 0===p?0:p,m=Wv("number"!=typeof f?f:Yv(f,fv)),g=c===_v?bv:_v,v=e.rects.popper,y=e.elements[h?g:c],_=dy(Mv(y)?y:y.contextElement||zv(e.elements.popper),s,l),b=Iv(e.elements.reference),x=hy({reference:b,element:v,strategy:"absolute",placement:i}),w=uy(Object.assign({},v,x)),S=c===_v?w:b,C={top:_.top-S.top+m.top,bottom:S.bottom-_.bottom+m.bottom,left:_.left-S.left+m.left,right:S.right-_.right+m.right},T=e.modifiersData.offset;if(c===_v&&T){var M=T[i];Object.keys(C).forEach((function(e){var t=[dv,cv].indexOf(e)>=0?1:-1,n=[uv,cv].indexOf(e)>=0?"y":"x";C[e]+=M[n]*t}))}return C}var fy={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name;if(!t.modifiersData[r]._skip){for(var i=n.mainAxis,a=void 0===i||i,s=n.altAxis,o=void 0===s||s,l=n.fallbackPlacements,u=n.padding,c=n.boundary,d=n.rootBoundary,h=n.altBoundary,p=n.flipVariations,f=void 0===p||p,m=n.allowedAutoPlacements,g=t.options.placement,v=Rv(g),y=l||(v===g||!f?[ty(g)]:function(e){if(Rv(e)===pv)return[];var t=ty(e);return[ry(e),t,ry(t)]}(g)),_=[g].concat(y).reduce((function(e,n){return e.concat(Rv(n)===pv?function(e,t){void 0===t&&(t={});var n=t,r=n.placement,i=n.boundary,a=n.rootBoundary,s=n.padding,o=n.flipVariations,l=n.allowedAutoPlacements,u=void 0===l?wv:l,c=Xv(r),d=c?o?xv:xv.filter((function(e){return Xv(e)===c})):fv,h=d.filter((function(e){return u.indexOf(e)>=0}));0===h.length&&(h=d);var p=h.reduce((function(t,n){return t[n]=py(e,{placement:n,boundary:i,rootBoundary:a,padding:s})[Rv(n)],t}),{});return Object.keys(p).sort((function(e,t){return p[e]-p[t]}))}(t,{placement:n,boundary:c,rootBoundary:d,padding:u,flipVariations:f,allowedAutoPlacements:m}):n)}),[]),b=t.rects.reference,x=t.rects.popper,w=new Map,S=!0,C=_[0],T=0;T<_.length;T++){var M=_[T],E=Rv(M),A=Xv(M)===mv,P=[uv,cv].indexOf(E)>=0,R=P?"width":"height",L=py(t,{placement:M,boundary:c,rootBoundary:d,altBoundary:h,padding:u}),k=P?A?dv:hv:A?cv:uv;b[R]>x[R]&&(k=ty(k));var D=ty(k),I=[];if(a&&I.push(L[E]<=0),o&&I.push(L[k]<=0,L[D]<=0),I.every((function(e){return e}))){C=M,S=!1;break}w.set(M,I)}if(S)for(var O=function(e){var t=_.find((function(t){var n=w.get(t);if(n)return n.slice(0,e).every((function(e){return e}))}));if(t)return C=t,"break"},N=f?3:1;N>0;N--){if("break"===O(N))break}t.placement!==C&&(t.modifiersData[r]._skip=!0,t.placement=C,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function my(e,t,n){return void 0===n&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function gy(e){return[uv,dv,cv,hv].some((function(t){return e[t]>=0}))}var vy={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,n=e.name,r=t.rects.reference,i=t.rects.popper,a=t.modifiersData.preventOverflow,s=py(t,{elementContext:"reference"}),o=py(t,{altBoundary:!0}),l=my(s,r),u=my(o,i,a),c=gy(l),d=gy(u);t.modifiersData[n]={referenceClippingOffsets:l,popperEscapeOffsets:u,isReferenceHidden:c,hasPopperEscaped:d},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":d})}};var yy={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,n=e.options,r=e.name,i=n.offset,a=void 0===i?[0,0]:i,s=wv.reduce((function(e,n){return e[n]=function(e,t,n){var r=Rv(e),i=[hv,uv].indexOf(r)>=0?-1:1,a="function"==typeof n?n(Object.assign({},t,{placement:e})):n,s=a[0],o=a[1];return s=s||0,o=(o||0)*i,[hv,dv].indexOf(r)>=0?{x:o,y:s}:{x:s,y:o}}(n,t.rects,a),e}),{}),o=s[t.placement],l=o.x,u=o.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=u),t.modifiersData[r]=s}};var _y={name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,n=e.name;t.modifiersData[n]=hy({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}};var by={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name,i=n.mainAxis,a=void 0===i||i,s=n.altAxis,o=void 0!==s&&s,l=n.boundary,u=n.rootBoundary,c=n.altBoundary,d=n.padding,h=n.tether,p=void 0===h||h,f=n.tetherOffset,m=void 0===f?0:f,g=py(t,{boundary:l,rootBoundary:u,padding:d,altBoundary:c}),v=Rv(t.placement),y=Xv(t.placement),_=!y,b=Hv(v),x=function(e){return"x"===e?"y":"x"}(b),w=t.modifiersData.popperOffsets,S=t.rects.reference,C=t.rects.popper,T="function"==typeof m?m(Object.assign({},t.rects,{placement:t.placement})):m,M="number"==typeof T?{mainAxis:T,altAxis:T}:Object.assign({mainAxis:0,altAxis:0},T),E=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,A={x:0,y:0};if(w){if(a){var P,R="y"===b?uv:hv,L="y"===b?cv:dv,k="y"===b?"height":"width",D=w[b],I=D+g[R],O=D-g[L],N=p?-C[k]/2:0,B=y===mv?S[k]:C[k],U=y===mv?-C[k]:-S[k],z=t.elements.arrow,F=p&&z?Ov(z):{width:0,height:0},V=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},G=V[R],H=V[L],j=jv(0,S[k],F[k]),W=_?S[k]/2-N-j-G-M.mainAxis:B-j-G-M.mainAxis,Y=_?-S[k]/2+N+j+H+M.mainAxis:U+j+H+M.mainAxis,$=t.elements.arrow&&Gv(t.elements.arrow),X=$?"y"===b?$.clientTop||0:$.clientLeft||0:0,q=null!=(P=null==E?void 0:E[b])?P:0,K=D+Y-q,Z=jv(p?kv(I,D+W-q-X):I,D,p?Lv(O,K):O);w[b]=Z,A[b]=Z-D}if(o){var J,Q="x"===b?uv:hv,ee="x"===b?cv:dv,te=w[x],ne="y"===x?"height":"width",re=te+g[Q],ie=te-g[ee],ae=-1!==[uv,hv].indexOf(v),se=null!=(J=null==E?void 0:E[x])?J:0,oe=ae?re:te-S[ne]-C[ne]-se+M.altAxis,le=ae?te+S[ne]+C[ne]-se-M.altAxis:ie,ue=p&&ae?function(e,t,n){var r=jv(e,t,n);return r>n?n:r}(oe,te,le):jv(p?oe:re,te,p?le:ie);w[x]=ue,A[x]=ue-te}t.modifiersData[r]=A}},requiresIfExists:["offset"]};function xy(e,t,n){void 0===n&&(n=!1);var r=Ev(t),i=Ev(t)&&function(e){var t=e.getBoundingClientRect(),n=Dv(t.width)/e.offsetWidth||1,r=Dv(t.height)/e.offsetHeight||1;return 1!==n||1!==r}(t),a=zv(t),s=Iv(e,i),o={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!n)&&(("body"!==Cv(t)||sy(a))&&(o=function(e){return e!==Tv(e)&&Ev(e)?function(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}(e):iy(e)}(t)),Ev(t)?((l=Iv(t,!0)).x+=t.clientLeft,l.y+=t.clientTop):a&&(l.x=ay(a))),{x:s.left+o.scrollLeft-l.x,y:s.top+o.scrollTop-l.y,width:s.width,height:s.height}}function wy(e){var t=new Map,n=new Set,r=[];function i(e){n.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!n.has(e)){var r=t.get(e);r&&i(r)}})),r.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){n.has(e.name)||i(e)})),r}function Sy(e){var t;return function(){return t||(t=new Promise((function(n){Promise.resolve().then((function(){t=void 0,n(e())}))}))),t}}var Cy={placement:"bottom",modifiers:[],strategy:"absolute"};function Ty(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some((function(e){return!(e&&"function"==typeof e.getBoundingClientRect)}))}function My(e){void 0===e&&(e={});var t=e,n=t.defaultModifiers,r=void 0===n?[]:n,i=t.defaultOptions,a=void 0===i?Cy:i;return function(e,t,n){void 0===n&&(n=a);var i={placement:"bottom",orderedModifiers:[],options:Object.assign({},Cy,a),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},s=[],o=!1,l={state:i,setOptions:function(n){var o="function"==typeof n?n(i.options):n;u(),i.options=Object.assign({},a,i.options,o),i.scrollParents={reference:Mv(e)?ly(e):e.contextElement?ly(e.contextElement):[],popper:ly(t)};var c=function(e){var t=wy(e);return Sv.reduce((function(e,n){return e.concat(t.filter((function(e){return e.phase===n})))}),[])}(function(e){var t=e.reduce((function(e,t){var n=e[t.name];return e[t.name]=n?Object.assign({},n,t,{options:Object.assign({},n.options,t.options),data:Object.assign({},n.data,t.data)}):t,e}),{});return Object.keys(t).map((function(e){return t[e]}))}([].concat(r,i.options.modifiers)));return i.orderedModifiers=c.filter((function(e){return e.enabled})),i.orderedModifiers.forEach((function(e){var t=e.name,n=e.options,r=void 0===n?{}:n,a=e.effect;if("function"==typeof a){var o=a({state:i,name:t,instance:l,options:r}),u=function(){};s.push(o||u)}})),l.update()},forceUpdate:function(){if(!o){var e=i.elements,t=e.reference,n=e.popper;if(Ty(t,n)){i.rects={reference:xy(t,Gv(n),"fixed"===i.options.strategy),popper:Ov(n)},i.reset=!1,i.placement=i.options.placement,i.orderedModifiers.forEach((function(e){return i.modifiersData[e.name]=Object.assign({},e.data)}));for(var r=0;r<i.orderedModifiers.length;r++)if(!0!==i.reset){var a=i.orderedModifiers[r],s=a.fn,u=a.options,c=void 0===u?{}:u,d=a.name;"function"==typeof s&&(i=s({state:i,options:c,name:d,instance:l})||i)}else i.reset=!1,r=-1}}},update:Sy((function(){return new Promise((function(e){l.forceUpdate(),e(i)}))})),destroy:function(){u(),o=!0}};if(!Ty(e,t))return l;function u(){s.forEach((function(e){return e()})),s=[]}return l.setOptions(n).then((function(e){!o&&n.onFirstUpdate&&n.onFirstUpdate(e)})),l}}My(),My({defaultModifiers:[Qv,_y,Zv,Pv]});var Ey=My({defaultModifiers:[Qv,_y,Zv,Pv,yy,fy,by,$v,vy]});const Ay=(e,t,n={})=>{const r={name:"updateState",enabled:!0,phase:"write",fn:({state:e})=>{const t=function(e){const t=Object.keys(e.elements),n=Mh(t.map((t=>[t,e.styles[t]||{}]))),r=Mh(t.map((t=>[t,e.attributes[t]])));return{styles:n,attributes:r}}(e);Object.assign(s.value,t)},requires:["computeStyles"]},i=Ki((()=>{const{onFirstUpdate:e,placement:t,strategy:i,modifiers:a}=Dt(n);return{onFirstUpdate:e,placement:t||"bottom",strategy:i||"absolute",modifiers:[...a||[],r,{name:"applyStyles",enabled:!1}]}})),a=Pt(),s=At({styles:{popper:{position:Dt(i).strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),o=()=>{a.value&&(a.value.destroy(),a.value=void 0)};return Mn(i,(e=>{const t=Dt(a);t&&t.setOptions(e)}),{deep:!0}),Mn([e,t],(([e,t])=>{o(),e&&t&&(a.value=Ey(e,t,Dt(i)))})),Qn((()=>{o()})),{state:Ki((()=>{var e;return{...(null==(e=Dt(a))?void 0:e.state)||{}}})),styles:Ki((()=>Dt(s).styles)),attributes:Ki((()=>Dt(s).attributes)),update:()=>{var e;return null==(e=Dt(a))?void 0:e.update()},forceUpdate:()=>{var e;return null==(e=Dt(a))?void 0:e.forceUpdate()},instanceRef:Ki((()=>Dt(a)))}};const Py=e=>{if(!e)return{onClick:y,onMousedown:y,onMouseup:y};let t=!1,n=!1;return{onClick:r=>{t&&n&&e(r),t=n=!1},onMousedown:e=>{t=e.target===e.currentTarget},onMouseup:e=>{n=e.target===e.currentTarget}}};function Ry(){let e;const t=()=>window.clearTimeout(e);return Hs((()=>t())),{registerTimeout:(n,r)=>{t(),e=window.setTimeout(n,r)},cancelTimeout:t}}const Ly={prefix:Math.floor(1e4*Math.random()),current:0},ky=Symbol("elIdInjection"),Dy=()=>Fi()?Sn(ky,Ly):Ly,Iy=e=>{const t=Dy(),n=nv();return Ki((()=>Dt(e)||`${n.value}-id-${t.prefix}-${t.current++}`))};let Oy=[];const Ny=e=>{const t=e;t.key===Sg.esc&&Oy.forEach((e=>e(t)))};let By;const Uy=()=>{const e=nv(),t=Dy(),n=Ki((()=>`${e.value}-popper-container-${t.prefix}`)),r=Ki((()=>`#${n.value}`));return{id:n,selector:r}},zy=()=>{const{id:e,selector:t}=Uy();return qn((()=>{Os&&(By||document.body.querySelector(t.value)||(By=(e=>{const t=document.createElement("div");return t.id=e,document.body.appendChild(t),t})(e.value)))})),{id:e,selector:t}},Fy=pg({showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0}}),Vy=({showAfter:e,hideAfter:t,autoClose:n,open:r,close:i})=>{const{registerTimeout:a}=Ry(),{registerTimeout:s,cancelTimeout:o}=Ry();return{onOpen:t=>{a((()=>{r(t);const e=Dt(n);Bs(e)&&e>0&&s((()=>{i(t)}),e)}),Dt(e))},onClose:e=>{o(),a((()=>{i(e)}),Dt(t))}}},Gy=Symbol("elForwardRef"),Hy=At(0),jy=2e3,Wy=Symbol("zIndexContextKey"),Yy=e=>{const t=e||Sn(Wy,void 0),n=Ki((()=>{const e=Dt(t);return Bs(e)?e:jy})),r=Ki((()=>n.value+Hy.value));return{initialZIndex:n,currentZIndex:r,nextZIndex:()=>(Hy.value++,r.value)}};function $y(e){return e.split("-")[1]}function Xy(e){return"y"===e?"height":"width"}function qy(e){return e.split("-")[0]}function Ky(e){return["top","bottom"].includes(qy(e))?"x":"y"}function Zy(e,t,n){let{reference:r,floating:i}=e;const a=r.x+r.width/2-i.width/2,s=r.y+r.height/2-i.height/2,o=Ky(t),l=Xy(o),u=r[l]/2-i[l]/2,c="x"===o;let d;switch(qy(t)){case"top":d={x:a,y:r.y-i.height};break;case"bottom":d={x:a,y:r.y+r.height};break;case"right":d={x:r.x+r.width,y:s};break;case"left":d={x:r.x-i.width,y:s};break;default:d={x:r.x,y:r.y}}switch($y(t)){case"start":d[o]-=u*(n&&c?-1:1);break;case"end":d[o]+=u*(n&&c?-1:1)}return d}function Jy(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}const Qy=Math.min,e_=Math.max;const t_=e=>({name:"arrow",options:e,async fn(t){const{element:n,padding:r=0}=e||{},{x:i,y:a,placement:s,rects:o,platform:l,elements:u}=t;if(null==n)return{};const c="number"!=typeof(w=r)?(S=w,{top:0,right:0,bottom:0,left:0,...S}):{top:w,right:w,bottom:w,left:w},d={x:i,y:a},h=Ky(s),p=Xy(h),f=await l.getDimensions(n),m="y"===h,g=m?"top":"left",v=m?"bottom":"right",y=m?"clientHeight":"clientWidth",_=o.reference[p]+o.reference[h]-d[h]-o.floating[p],b=d[h]-o.reference[h],x=await(null==l.getOffsetParent?void 0:l.getOffsetParent(n));var w,S;let C=x?x[y]:0;C&&await(null==l.isElement?void 0:l.isElement(x))||(C=u.floating[y]||o.floating[p]);const T=_/2-b/2,M=c[g],E=C-f[p]-c[v],A=C/2-f[p]/2+T,P=function(e,t,n){return e_(e,Qy(t,n))}(M,A,E),R=null!=$y(s)&&A!=P&&o.reference[p]/2-(A<M?c[g]:c[v])-f[p]/2<0;return{[h]:d[h]-(R?A<M?M-A:E-A:0),data:{[h]:P,centerOffset:A-P}}}});["top","right","bottom","left"].reduce(((e,t)=>e.concat(t,t+"-start",t+"-end")),[]);const n_=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){const{x:n,y:r}=t,i=await async function(e,t){const{placement:n,platform:r,elements:i}=e,a=await(null==r.isRTL?void 0:r.isRTL(i.floating)),s=qy(n),o=$y(n),l="x"===Ky(n),u=["left","top"].includes(s)?-1:1,c=a&&l?-1:1,d="function"==typeof t?t(e):t;let{mainAxis:h,crossAxis:p,alignmentAxis:f}="number"==typeof d?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return o&&"number"==typeof f&&(p="end"===o?-1*f:f),l?{x:p*c,y:h*u}:{x:h*u,y:p*c}}(t,e);return{x:n+i.x,y:r+i.y,data:i}}}};function r_(e){var t;return(null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function i_(e){return r_(e).getComputedStyle(e)}function a_(e){return e instanceof r_(e).Node}function s_(e){return a_(e)?(e.nodeName||"").toLowerCase():""}let o_;function l_(){if(o_)return o_;const e=navigator.userAgentData;return e&&Array.isArray(e.brands)?(o_=e.brands.map((e=>e.brand+"/"+e.version)).join(" "),o_):navigator.userAgent}function u_(e){return e instanceof r_(e).HTMLElement}function c_(e){return e instanceof r_(e).Element}function d_(e){return"undefined"!=typeof ShadowRoot&&(e instanceof r_(e).ShadowRoot||e instanceof ShadowRoot)}function h_(e){const{overflow:t,overflowX:n,overflowY:r,display:i}=i_(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(i)}function p_(e){return["table","td","th"].includes(s_(e))}function f_(e){const t=/firefox/i.test(l_()),n=i_(e),r=n.backdropFilter||n.WebkitBackdropFilter;return"none"!==n.transform||"none"!==n.perspective||!!r&&"none"!==r||t&&"filter"===n.willChange||t&&!!n.filter&&"none"!==n.filter||["transform","perspective"].some((e=>n.willChange.includes(e)))||["paint","layout","strict","content"].some((e=>{const t=n.contain;return null!=t&&t.includes(e)}))}function m_(){return/^((?!chrome|android).)*safari/i.test(l_())}function g_(e){return["html","body","#document"].includes(s_(e))}const v_=Math.min,y_=Math.max,__=Math.round;function b_(e){const t=i_(e);let n=parseFloat(t.width),r=parseFloat(t.height);const i=u_(e),a=i?e.offsetWidth:n,s=i?e.offsetHeight:r,o=__(n)!==a||__(r)!==s;return o&&(n=a,r=s),{width:n,height:r,fallback:o}}function x_(e){return c_(e)?e:e.contextElement}const w_={x:1,y:1};function S_(e){const t=x_(e);if(!u_(t))return w_;const n=t.getBoundingClientRect(),{width:r,height:i,fallback:a}=b_(t);let s=(a?__(n.width):n.width)/r,o=(a?__(n.height):n.height)/i;return s&&Number.isFinite(s)||(s=1),o&&Number.isFinite(o)||(o=1),{x:s,y:o}}function C_(e,t,n,r){var i,a;void 0===t&&(t=!1),void 0===n&&(n=!1);const s=e.getBoundingClientRect(),o=x_(e);let l=w_;t&&(r?c_(r)&&(l=S_(r)):l=S_(e));const u=o?r_(o):window,c=m_()&&n;let d=(s.left+(c&&(null==(i=u.visualViewport)?void 0:i.offsetLeft)||0))/l.x,h=(s.top+(c&&(null==(a=u.visualViewport)?void 0:a.offsetTop)||0))/l.y,p=s.width/l.x,f=s.height/l.y;if(o){const e=r_(o),t=r&&c_(r)?r_(r):r;let n=e.frameElement;for(;n&&r&&t!==e;){const e=S_(n),t=n.getBoundingClientRect(),r=getComputedStyle(n);t.x+=(n.clientLeft+parseFloat(r.paddingLeft))*e.x,t.y+=(n.clientTop+parseFloat(r.paddingTop))*e.y,d*=e.x,h*=e.y,p*=e.x,f*=e.y,d+=t.x,h+=t.y,n=r_(n).frameElement}}return Jy({width:p,height:f,x:d,y:h})}function T_(e){return((a_(e)?e.ownerDocument:e.document)||window.document).documentElement}function M_(e){return c_(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function E_(e){return C_(T_(e)).left+M_(e).scrollLeft}function A_(e){if("html"===s_(e))return e;const t=e.assignedSlot||e.parentNode||d_(e)&&e.host||T_(e);return d_(t)?t.host:t}function P_(e){const t=A_(e);return g_(t)?t.ownerDocument.body:u_(t)&&h_(t)?t:P_(t)}function R_(e,t){var n;void 0===t&&(t=[]);const r=P_(e),i=r===(null==(n=e.ownerDocument)?void 0:n.body),a=r_(r);return i?t.concat(a,a.visualViewport||[],h_(r)?r:[]):t.concat(r,R_(r))}function L_(e,t,n){let r;if("viewport"===t)r=function(e,t){const n=r_(e),r=T_(e),i=n.visualViewport;let a=r.clientWidth,s=r.clientHeight,o=0,l=0;if(i){a=i.width,s=i.height;const e=m_();(!e||e&&"fixed"===t)&&(o=i.offsetLeft,l=i.offsetTop)}return{width:a,height:s,x:o,y:l}}(e,n);else if("document"===t)r=function(e){const t=T_(e),n=M_(e),r=e.ownerDocument.body,i=y_(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),a=y_(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let s=-n.scrollLeft+E_(e);const o=-n.scrollTop;return"rtl"===i_(r).direction&&(s+=y_(t.clientWidth,r.clientWidth)-i),{width:i,height:a,x:s,y:o}}(T_(e));else if(c_(t))r=function(e,t){const n=C_(e,!0,"fixed"===t),r=n.top+e.clientTop,i=n.left+e.clientLeft,a=u_(e)?S_(e):{x:1,y:1};return{width:e.clientWidth*a.x,height:e.clientHeight*a.y,x:i*a.x,y:r*a.y}}(t,n);else{const n={...t};if(m_()){var i,a;const t=r_(e);n.x-=(null==(i=t.visualViewport)?void 0:i.offsetLeft)||0,n.y-=(null==(a=t.visualViewport)?void 0:a.offsetTop)||0}r=n}return Jy(r)}function k_(e,t){return u_(e)&&"fixed"!==i_(e).position?t?t(e):e.offsetParent:null}function D_(e,t){const n=r_(e);if(!u_(e))return n;let r=k_(e,t);for(;r&&p_(r)&&"static"===i_(r).position;)r=k_(r,t);return r&&("html"===s_(r)||"body"===s_(r)&&"static"===i_(r).position&&!f_(r))?n:r||function(e){let t=A_(e);for(;u_(t)&&!g_(t);){if(f_(t))return t;t=A_(t)}return null}(e)||n}function I_(e,t,n){const r=u_(t),i=T_(t),a=C_(e,!0,"fixed"===n,t);let s={scrollLeft:0,scrollTop:0};const o={x:0,y:0};if(r||!r&&"fixed"!==n)if(("body"!==s_(t)||h_(i))&&(s=M_(t)),u_(t)){const e=C_(t,!0);o.x=e.x+t.clientLeft,o.y=e.y+t.clientTop}else i&&(o.x=E_(i));return{x:a.left+s.scrollLeft-o.x,y:a.top+s.scrollTop-o.y,width:a.width,height:a.height}}const O_={getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:r,strategy:i}=e;const a=[..."clippingAncestors"===n?function(e,t){const n=t.get(e);if(n)return n;let r=R_(e).filter((e=>c_(e)&&"body"!==s_(e))),i=null;const a="fixed"===i_(e).position;let s=a?A_(e):e;for(;c_(s)&&!g_(s);){const e=i_(s),t=f_(s);"fixed"===e.position&&(i=null),(a?t||i:t||"static"!==e.position||!i||!["absolute","fixed"].includes(i.position))?i=e:r=r.filter((e=>e!==s)),s=A_(s)}return t.set(e,r),r}(t,this._c):[].concat(n),r],s=a[0],o=a.reduce(((e,n)=>{const r=L_(t,n,i);return e.top=y_(r.top,e.top),e.right=v_(r.right,e.right),e.bottom=v_(r.bottom,e.bottom),e.left=y_(r.left,e.left),e}),L_(t,s,i));return{width:o.right-o.left,height:o.bottom-o.top,x:o.left,y:o.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{rect:t,offsetParent:n,strategy:r}=e;const i=u_(n),a=T_(n);if(n===a)return t;let s={scrollLeft:0,scrollTop:0},o={x:1,y:1};const l={x:0,y:0};if((i||!i&&"fixed"!==r)&&(("body"!==s_(n)||h_(a))&&(s=M_(n)),u_(n))){const e=C_(n);o=S_(n),l.x=e.x+n.clientLeft,l.y=e.y+n.clientTop}return{width:t.width*o.x,height:t.height*o.y,x:t.x*o.x-s.scrollLeft*o.x+l.x,y:t.y*o.y-s.scrollTop*o.y+l.y}},isElement:c_,getDimensions:function(e){return b_(e)},getOffsetParent:D_,getDocumentElement:T_,getScale:S_,async getElementRects(e){let{reference:t,floating:n,strategy:r}=e;const i=this.getOffsetParent||D_,a=this.getDimensions;return{reference:I_(t,await i(n),r),floating:{x:0,y:0,...await a(n)}}},getClientRects:e=>Array.from(e.getClientRects()),isRTL:e=>"rtl"===i_(e).direction},N_=(e,t,n)=>{const r=new Map,i={platform:O_,...n},a={...i.platform,_c:r};return(async(e,t,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:a=[],platform:s}=n,o=a.filter(Boolean),l=await(null==s.isRTL?void 0:s.isRTL(t));let u=await s.getElementRects({reference:e,floating:t,strategy:i}),{x:c,y:d}=Zy(u,r,l),h=r,p={},f=0;for(let m=0;m<o.length;m++){const{name:n,fn:a}=o[m],{x:g,y:v,data:y,reset:_}=await a({x:c,y:d,initialPlacement:r,placement:h,strategy:i,middlewareData:p,rects:u,platform:s,elements:{reference:e,floating:t}});c=null!=g?g:c,d=null!=v?v:d,p={...p,[n]:{...p[n],...y}},_&&f<=50&&(f++,"object"==typeof _&&(_.placement&&(h=_.placement),_.rects&&(u=!0===_.rects?await s.getElementRects({reference:e,floating:t,strategy:i}):_.rects),({x:c,y:d}=Zy(u,h,l))),m=-1)}return{x:c,y:d,placement:h,strategy:i,middlewareData:p}})(e,t,{...i,platform:a})};pg({});const B_=({middleware:e,placement:t,strategy:n})=>{const r=At(),i=At(),a=At(),s=At(),o=At({}),l={x:a,y:s,placement:t,strategy:n,middlewareData:o},u=async()=>{if(!Os)return;const a=(e=>{if(!Os)return;if(!e)return e;const t=Xs(e);return t||(Et(e)?t:e)})(r),s=Xs(i);if(!a||!s)return;const o=await N_(a,s,{placement:Dt(t),strategy:Dt(n),middleware:Dt(e)});Gh(l).forEach((e=>{l[e].value=o[e]}))};return Kn((()=>{Cn((()=>{u()}))})),{...l,update:u,referenceRef:r,contentRef:i}};const U_=(e,t)=>{const n={},r=Pt([]);return{children:r,addChild:i=>{n[i.uid]=i,r.value=((e,t,n)=>Og(e.subTree).filter((e=>{var n;return bi(e)&&(null==(n=e.type)?void 0:n.name)===t&&!!e.component})).map((e=>e.component.uid)).map((e=>n[e])).filter((e=>!!e)))(e,t,n)},removeChild:e=>{delete n[e],r.value=r.value.filter((t=>t.uid!==e))}}},z_=hg({type:String,values:Pg,required:!1}),F_=Symbol("size"),V_=Symbol(),G_=At();function H_(e,t=void 0){const n=Fi()?Sn(V_,G_):G_;return e?Ki((()=>{var r,i;return null!=(i=null==(r=n.value)?void 0:r[e])?i:t})):n}function j_(e,t){const n=H_(),r=rv(e,Ki((()=>{var e;return(null==(e=n.value)?void 0:e.namespace)||Qg}))),i=Jg(Ki((()=>{var e;return null==(e=n.value)?void 0:e.locale}))),a=Yy(Ki((()=>{var e;return(null==(e=n.value)?void 0:e.zIndex)||jy}))),s=Ki((()=>{var e;return Dt(t)||(null==(e=n.value)?void 0:e.size)||""}));return W_(Ki((()=>Dt(n)||{}))),{ns:r,locale:i,zIndex:a,size:s}}const W_=(e,t,n=!1)=>{var r;const i=!!Fi(),a=i?H_():void 0,s=null!=(r=null==t?void 0:t.provide)?r:i?wn:void 0;if(!s)return;const o=Ki((()=>{const t=Dt(e);return(null==a?void 0:a.value)?Y_(a.value,t):t}));return s(V_,o),s(Zg,Ki((()=>o.value.locale))),s(tv,Ki((()=>o.value.namespace))),s(Wy,Ki((()=>o.value.zIndex))),s(F_,{size:Ki((()=>o.value.size||""))}),!n&&G_.value||(G_.value=o.value),o},Y_=(e,t)=>{var n;const r=[...new Set([...Gh(e),...Gh(t)])],i={};for(const a of r)i[a]=null!=(n=t[a])?n:e[a];return i},$_=pg({a11y:{type:Boolean,default:!0},locale:{type:Object},size:z_,button:{type:Object},experimentalFeatures:{type:Object},keyboardNavigation:{type:Boolean,default:!0},message:{type:Object},zIndex:Number,namespace:{type:String,default:"el"}}),X_={},q_=_g(Fn({name:"ElConfigProvider",props:$_,setup(e,{slots:t}){Mn((()=>e.message),(e=>{Object.assign(X_,null!=e?e:{})}),{immediate:!0,deep:!0});const n=W_(e);return()=>vr(t,"default",{config:null==n?void 0:n.value})}})),K_=pg({zIndex:{type:[Number,String],default:100},target:{type:String,default:""},offset:{type:Number,default:0},position:{type:String,values:["top","bottom"],default:"top"}}),Z_={scroll:({scrollTop:e,fixed:t})=>Bs(e)&&Ns(t),[Mg]:e=>Ns(e)};var J_=(e,t)=>{const n=e.__vccOpts||e;for(const[r,i]of t)n[r]=i;return n};const Q_="ElAffix",eb=Fn({name:Q_});const tb=_g(J_(Fn({...eb,props:K_,emits:Z_,setup(e,{expose:t,emit:n}){const i=e,a=rv("affix"),s=Pt(),o=Pt(),u=Pt(),{height:c}=function(e={}){const{window:t=qs,initialWidth:n=1/0,initialHeight:r=1/0,listenOrientation:i=!0,includeScrollbar:a=!0}=e,s=At(n),o=At(r),l=()=>{t&&(a?(s.value=t.innerWidth,o.value=t.innerHeight):(s.value=t.document.documentElement.clientWidth,o.value=t.document.documentElement.clientHeight))};return l(),Ys(l),Zs("resize",l,{passive:!0}),i&&Zs("orientationchange",l,{passive:!0}),{width:s,height:o}}(),{height:d,width:h,top:p,bottom:f,update:m}=uo(o,{windowScroll:!1}),g=uo(s),v=At(!1),y=At(0),_=At(0),b=Ki((()=>({height:v.value?`${d.value}px`:"",width:v.value?`${h.value}px`:""}))),x=Ki((()=>{if(!v.value)return{};const e=i.offset?Zh(i.offset):0;return{height:`${d.value}px`,width:`${h.value}px`,top:"top"===i.position?e:"",bottom:"bottom"===i.position?e:"",transform:_.value?`translateY(${_.value}px)`:"",zIndex:i.zIndex}})),w=()=>{if(u.value)if(y.value=u.value instanceof Window?document.documentElement.scrollTop:u.value.scrollTop||0,"top"===i.position)if(i.target){const e=g.bottom.value-i.offset-d.value;v.value=i.offset>p.value&&g.bottom.value>0,_.value=e<0?e:0}else v.value=i.offset>p.value;else if(i.target){const e=c.value-g.top.value-i.offset-d.value;v.value=c.value-i.offset<f.value&&c.value>g.top.value,_.value=e<0?-e:0}else v.value=c.value-i.offset<f.value};return Mn(v,(e=>n("change",e))),Kn((()=>{var e;i.target?(s.value=null!=(e=document.querySelector(i.target))?e:void 0,s.value||Wh(Q_,`Target is not existed: ${i.target}`)):s.value=document.documentElement,u.value=Qh(o.value,!0),m()})),Zs(u,"scroll",(()=>{m(),n("scroll",{scrollTop:y.value,fixed:v.value})})),Cn(w),t({update:w,updateRoot:m}),(e,t)=>(fi(),yi("div",{ref_key:"root",ref:o,class:l(Dt(a).b()),style:r(Dt(b))},[Ti("div",{class:l({[Dt(a).m("fixed")]:v.value}),style:r(Dt(x))},[vr(e.$slots,"default")],6)],6))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/affix/src/affix.vue"]])),nb=pg({size:{type:[Number,String]},color:{type:String}}),rb=Fn({name:"ElIcon",inheritAttrs:!1});const ib=_g(J_(Fn({...rb,props:nb,setup(e){const t=e,n=rv("icon"),r=Ki((()=>{const{size:e,color:n}=t;return e||n?{fontSize:Bh(e)?void 0:Zh(e),"--color":n}:{}}));return(e,t)=>(fi(),yi("i",Oi({class:Dt(n).b(),style:Dt(r)},e.$attrs),[vr(e.$slots,"default")],16))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/icon/src/icon.vue"]])),ab=pg({title:{type:String,default:""},description:{type:String,default:""},type:{type:String,values:Gh(vg),default:"info"},closable:{type:Boolean,default:!0},closeText:{type:String,default:""},showIcon:Boolean,center:Boolean,effect:{type:String,values:["light","dark"],default:"light"}}),sb={close:e=>e instanceof MouseEvent},ob=Fn({name:"ElAlert"});const lb=_g(J_(Fn({...ob,props:ab,emits:sb,setup(e,{emit:t}){const n=e,{Close:r}=gg,i=Zi(),a=rv("alert"),s=At(!0),o=Ki((()=>vg[n.type])),u=Ki((()=>[a.e("icon"),{[a.is("big")]:!!n.description||!!i.default}])),c=Ki((()=>({[a.is("bold")]:n.description||i.default}))),d=e=>{s.value=!1,t("close",e)};return(e,t)=>(fi(),_i(xa,{name:Dt(a).b("fade"),persisted:""},{default:vn((()=>[ar(Ti("div",{class:l([Dt(a).b(),Dt(a).m(e.type),Dt(a).is("center",e.center),Dt(a).is(e.effect)]),role:"alert"},[e.showIcon&&Dt(o)?(fi(),_i(Dt(ib),{key:0,class:l(Dt(u))},{default:vn((()=>[(fi(),_i(dr(Dt(o))))])),_:1},8,["class"])):Li("v-if",!0),Ti("div",{class:l(Dt(a).e("content"))},[e.title||e.$slots.title?(fi(),yi("span",{key:0,class:l([Dt(a).e("title"),Dt(c)])},[vr(e.$slots,"title",{},(()=>[Pi(f(e.title),1)]))],2)):Li("v-if",!0),e.$slots.default||e.description?(fi(),yi("p",{key:1,class:l(Dt(a).e("description"))},[vr(e.$slots,"default",{},(()=>[Pi(f(e.description),1)]))],2)):Li("v-if",!0),e.closable?(fi(),yi(li,{key:2},[e.closeText?(fi(),yi("div",{key:0,class:l([Dt(a).e("close-btn"),Dt(a).is("customed")]),onClick:d},f(e.closeText),3)):(fi(),_i(Dt(ib),{key:1,class:l(Dt(a).e("close-btn")),onClick:d},{default:vn((()=>[Mi(Dt(r))])),_:1},8,["class"]))],64)):Li("v-if",!0)],2)],2),[[is,s.value]])])),_:3},8,["name"]))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/alert/src/alert.vue"]])),ub=Symbol("formContextKey"),cb=Symbol("formItemContextKey"),db=(e,t={})=>{const n=At(void 0),r=t.prop?n:lv("size"),i=t.global?n:(()=>{const e=Sn(F_,{});return Ki((()=>Dt(e.size)||""))})(),a=t.form?{size:void 0}:Sn(ub,void 0),s=t.formItem?{size:void 0}:Sn(cb,void 0);return Ki((()=>r.value||Dt(e)||(null==s?void 0:s.size)||(null==a?void 0:a.size)||i.value||""))},hb=e=>{const t=lv("disabled"),n=Sn(ub,void 0);return Ki((()=>t.value||Dt(e)||(null==n?void 0:n.disabled)||!1))},pb=()=>({form:Sn(ub,void 0),formItem:Sn(cb,void 0)}),fb=(e,{formItemContext:t,disableIdGeneration:n,disableIdManagement:r})=>{n||(n=At(!1)),r||(r=At(!1));const i=At();let a;const s=Ki((()=>{var n;return!!(!e.label&&t&&t.inputIds&&(null==(n=t.inputIds)?void 0:n.length)<=1)}));return Kn((()=>{a=Mn([Ut(e,"id"),n],(([e,n])=>{const a=null!=e?e:n?void 0:Iy().value;a!==i.value&&((null==t?void 0:t.removeInputId)&&(i.value&&t.removeInputId(i.value),(null==r?void 0:r.value)||n||!a||t.addInputId(a)),i.value=a)}),{immediate:!0})})),er((()=>{a&&a(),(null==t?void 0:t.removeInputId)&&i.value&&t.removeInputId(i.value)})),{isLabeledByFormItem:s,inputId:i}},mb=pg({size:{type:String,values:Pg},disabled:Boolean}),gb=pg({...mb,model:Object,rules:{type:Object},labelPosition:{type:String,values:["left","right","top"],default:"right"},requireAsteriskPosition:{type:String,values:["left","right"],default:"left"},labelWidth:{type:[String,Number],default:""},labelSuffix:{type:String,default:""},inline:Boolean,inlineMessage:Boolean,statusIcon:Boolean,showMessage:{type:Boolean,default:!0},validateOnRuleChange:{type:Boolean,default:!0},hideRequiredAsterisk:{type:Boolean,default:!1},scrollToError:Boolean,scrollIntoViewOptions:{type:[Object,Boolean]}}),vb={validate:(e,t,n)=>(E(e)||D(e))&&Ns(t)&&D(n)};function yb(){const e=At([]),t=Ki((()=>{if(!e.value.length)return"0";const t=Math.max(...e.value);return t?`${t}px`:""}));function n(n){const r=e.value.indexOf(n);return-1===r&&t.value,r}return{autoLabelWidth:t,registerLabelWidth:function(t,r){if(t&&r){const i=n(r);e.value.splice(i,1,t)}else t&&e.value.push(t)},deregisterLabelWidth:function(t){const r=n(t);r>-1&&e.value.splice(r,1)}}}const _b=(e,t)=>{const n=ec(t);return n.length>0?e.filter((e=>e.prop&&n.includes(e.prop))):e},bb=Fn({name:"ElForm"}),xb=Fn({...bb,props:gb,emits:vb,setup(e,{expose:t,emit:n}){const r=e,i=[],a=db(),s=rv("form"),o=Ki((()=>{const{labelPosition:e,inline:t}=r;return[s.b(),s.m(a.value||"default"),{[s.m(`label-${e}`)]:e,[s.m("inline")]:t}]})),u=(e=[])=>{r.model&&_b(i,e).forEach((e=>e.resetField()))},c=(e=[])=>{_b(i,e).forEach((e=>e.clearValidate()))},d=Ki((()=>!!r.model)),h=async e=>f(void 0,e),p=async(e=[])=>{if(!d.value)return!1;const t=(e=>{if(0===i.length)return[];const t=_b(i,e);return t.length?t:[]})(e);if(0===t.length)return!0;let n={};for(const i of t)try{await i.validate("")}catch(r){n={...n,...r}}return 0===Object.keys(n).length||Promise.reject(n)},f=async(e=[],t)=>{const n=!k(t);try{const n=await p(e);return!0===n&&(null==t||t(n)),n}catch(zA){if(zA instanceof Error)throw zA;const i=zA;return r.scrollToError&&m(Object.keys(i)[0]),null==t||t(!1,i),n&&Promise.reject(i)}},m=e=>{var t;const n=_b(i,e)[0];n&&(null==(t=n.$el)||t.scrollIntoView(r.scrollIntoViewOptions))};return Mn((()=>r.rules),(()=>{r.validateOnRuleChange&&h().catch((e=>{}))}),{deep:!0}),wn(ub,pt({...Nt(r),emit:n,resetFields:u,clearValidate:c,validateField:f,addField:e=>{i.push(e)},removeField:e=>{e.prop&&i.splice(i.indexOf(e),1)},...yb()})),t({validate:h,validateField:f,resetFields:u,clearValidate:c,scrollToField:m}),(e,t)=>(fi(),yi("form",{class:l(Dt(o))},[vr(e.$slots,"default")],2))}});var wb=J_(xb,[["__file","/home/runner/work/element-plus/element-plus/packages/components/form/src/form.vue"]]);function Sb(){return Sb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Sb.apply(this,arguments)}function Cb(e){return(Cb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Tb(e,t){return(Tb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Mb(e,t,n){return(Mb=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(zA){return!1}}()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&Tb(i,n.prototype),i}).apply(null,arguments)}function Eb(e){var t="function"==typeof Map?new Map:void 0;return Eb=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return Mb(e,arguments,Cb(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Tb(r,e)},Eb(e)}var Ab=/%[sdj%]/g,Pb=function(){};function Rb(e){if(!e||!e.length)return null;var t={};return e.forEach((function(e){var n=e.field;t[n]=t[n]||[],t[n].push(e)})),t}function Lb(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=0,a=n.length;return"function"==typeof e?e.apply(null,n):"string"==typeof e?e.replace(Ab,(function(e){if("%%"===e)return"%";if(i>=a)return e;switch(e){case"%s":return String(n[i++]);case"%d":return Number(n[i++]);case"%j":try{return JSON.stringify(n[i++])}catch(t){return"[Circular]"}break;default:return e}})):e}function kb(e,t){return null==e||(!("array"!==t||!Array.isArray(e)||e.length)||!(!function(e){return"string"===e||"url"===e||"hex"===e||"email"===e||"date"===e||"pattern"===e}(t)||"string"!=typeof e||e))}function Db(e,t,n){var r=0,i=e.length;!function a(s){if(s&&s.length)n(s);else{var o=r;r+=1,o<i?t(e[o],a):n([])}}([])}"undefined"!=typeof process&&process.env;var Ib=function(e){var t,n;function r(t,n){var r;return(r=e.call(this,"Async Validation Error")||this).errors=t,r.fields=n,r}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,Tb(t,n),r}(Eb(Error));function Ob(e,t,n,r,i){if(t.first){var a=new Promise((function(t,a){var s=function(e){var t=[];return Object.keys(e).forEach((function(n){t.push.apply(t,e[n]||[])})),t}(e);Db(s,n,(function(e){return r(e),e.length?a(new Ib(e,Rb(e))):t(i)}))}));return a.catch((function(e){return e})),a}var s=!0===t.firstFields?Object.keys(e):t.firstFields||[],o=Object.keys(e),l=o.length,u=0,c=[],d=new Promise((function(t,a){var d=function(e){if(c.push.apply(c,e),++u===l)return r(c),c.length?a(new Ib(c,Rb(c))):t(i)};o.length||(r(c),t(i)),o.forEach((function(t){var r=e[t];-1!==s.indexOf(t)?Db(r,n,d):function(e,t,n){var r=[],i=0,a=e.length;function s(e){r.push.apply(r,e||[]),++i===a&&n(r)}e.forEach((function(e){t(e,s)}))}(r,n,d)}))}));return d.catch((function(e){return e})),d}function Nb(e,t){return function(n){var r,i;return r=e.fullFields?function(e,t){for(var n=e,r=0;r<t.length;r++){if(null==n)return n;n=n[t[r]]}return n}(t,e.fullFields):t[n.field||e.fullField],(i=n)&&void 0!==i.message?(n.field=n.field||e.fullField,n.fieldValue=r,n):{message:"function"==typeof n?n():n,fieldValue:r,field:n.field||e.fullField}}}function Bb(e,t){if(t)for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];"object"==typeof r&&"object"==typeof e[n]?e[n]=Sb({},e[n],r):e[n]=r}return e}var Ub,zb=function(e,t,n,r,i,a){!e.required||n.hasOwnProperty(e.field)&&!kb(t,a||e.type)||r.push(Lb(i.messages.required,e.fullField))},Fb=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,Vb=/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i,Gb={integer:function(e){return Gb.number(e)&&parseInt(e,10)===e},float:function(e){return Gb.number(e)&&!Gb.integer(e)},array:function(e){return Array.isArray(e)},regexp:function(e){if(e instanceof RegExp)return!0;try{return!!new RegExp(e)}catch(zA){return!1}},date:function(e){return"function"==typeof e.getTime&&"function"==typeof e.getMonth&&"function"==typeof e.getYear&&!isNaN(e.getTime())},number:function(e){return!isNaN(e)&&"number"==typeof e},object:function(e){return"object"==typeof e&&!Gb.array(e)},method:function(e){return"function"==typeof e},email:function(e){return"string"==typeof e&&e.length<=320&&!!e.match(Fb)},url:function(e){return"string"==typeof e&&e.length<=2048&&!!e.match(function(){if(Ub)return Ub;var e="[a-fA-F\\d:]",t=function(t){return t&&t.includeBoundaries?"(?:(?<=\\s|^)(?="+e+")|(?<="+e+")(?=\\s|$))":""},n="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",r="[a-fA-F\\d]{1,4}",i=("\n(?:\n(?:"+r+":){7}(?:"+r+"|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8\n(?:"+r+":){6}(?:"+n+"|:"+r+"|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4\n(?:"+r+":){5}(?::"+n+"|(?::"+r+"){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4\n(?:"+r+":){4}(?:(?::"+r+"){0,1}:"+n+"|(?::"+r+"){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4\n(?:"+r+":){3}(?:(?::"+r+"){0,2}:"+n+"|(?::"+r+"){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4\n(?:"+r+":){2}(?:(?::"+r+"){0,3}:"+n+"|(?::"+r+"){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4\n(?:"+r+":){1}(?:(?::"+r+"){0,4}:"+n+"|(?::"+r+"){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4\n(?::(?:(?::"+r+"){0,5}:"+n+"|(?::"+r+"){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4\n)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1\n").replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),a=new RegExp("(?:^"+n+"$)|(?:^"+i+"$)"),s=new RegExp("^"+n+"$"),o=new RegExp("^"+i+"$"),l=function(e){return e&&e.exact?a:new RegExp("(?:"+t(e)+n+t(e)+")|(?:"+t(e)+i+t(e)+")","g")};l.v4=function(e){return e&&e.exact?s:new RegExp(""+t(e)+n+t(e),"g")},l.v6=function(e){return e&&e.exact?o:new RegExp(""+t(e)+i+t(e),"g")};var u=l.v4().source,c=l.v6().source;return Ub=new RegExp("(?:^(?:(?:(?:[a-z]+:)?//)|www\\.)(?:\\S+(?::\\S*)?@)?(?:localhost|"+u+"|"+c+'|(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))(?::\\d{2,5})?(?:[/?#][^\\s"]*)?$)',"i")}())},hex:function(e){return"string"==typeof e&&!!e.match(Vb)}},Hb="enum",jb={required:zb,whitespace:function(e,t,n,r,i){(/^\s+$/.test(t)||""===t)&&r.push(Lb(i.messages.whitespace,e.fullField))},type:function(e,t,n,r,i){if(e.required&&void 0===t)zb(e,t,n,r,i);else{var a=e.type;["integer","float","array","regexp","object","method","email","number","date","url","hex"].indexOf(a)>-1?Gb[a](t)||r.push(Lb(i.messages.types[a],e.fullField,e.type)):a&&typeof t!==e.type&&r.push(Lb(i.messages.types[a],e.fullField,e.type))}},range:function(e,t,n,r,i){var a="number"==typeof e.len,s="number"==typeof e.min,o="number"==typeof e.max,l=t,u=null,c="number"==typeof t,d="string"==typeof t,h=Array.isArray(t);if(c?u="number":d?u="string":h&&(u="array"),!u)return!1;h&&(l=t.length),d&&(l=t.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"_").length),a?l!==e.len&&r.push(Lb(i.messages[u].len,e.fullField,e.len)):s&&!o&&l<e.min?r.push(Lb(i.messages[u].min,e.fullField,e.min)):o&&!s&&l>e.max?r.push(Lb(i.messages[u].max,e.fullField,e.max)):s&&o&&(l<e.min||l>e.max)&&r.push(Lb(i.messages[u].range,e.fullField,e.min,e.max))},enum:function(e,t,n,r,i){e[Hb]=Array.isArray(e[Hb])?e[Hb]:[],-1===e[Hb].indexOf(t)&&r.push(Lb(i.messages[Hb],e.fullField,e[Hb].join(", ")))},pattern:function(e,t,n,r,i){if(e.pattern)if(e.pattern instanceof RegExp)e.pattern.lastIndex=0,e.pattern.test(t)||r.push(Lb(i.messages.pattern.mismatch,e.fullField,t,e.pattern));else if("string"==typeof e.pattern){new RegExp(e.pattern).test(t)||r.push(Lb(i.messages.pattern.mismatch,e.fullField,t,e.pattern))}}},Wb=function(e,t,n,r,i){var a=e.type,s=[];if(e.required||!e.required&&r.hasOwnProperty(e.field)){if(kb(t,a)&&!e.required)return n();jb.required(e,t,r,s,i,a),kb(t,a)||jb.type(e,t,r,s,i)}n(s)},Yb={string:function(e,t,n,r,i){var a=[];if(e.required||!e.required&&r.hasOwnProperty(e.field)){if(kb(t,"string")&&!e.required)return n();jb.required(e,t,r,a,i,"string"),kb(t,"string")||(jb.type(e,t,r,a,i),jb.range(e,t,r,a,i),jb.pattern(e,t,r,a,i),!0===e.whitespace&&jb.whitespace(e,t,r,a,i))}n(a)},method:function(e,t,n,r,i){var a=[];if(e.required||!e.required&&r.hasOwnProperty(e.field)){if(kb(t)&&!e.required)return n();jb.required(e,t,r,a,i),void 0!==t&&jb.type(e,t,r,a,i)}n(a)},number:function(e,t,n,r,i){var a=[];if(e.required||!e.required&&r.hasOwnProperty(e.field)){if(""===t&&(t=void 0),kb(t)&&!e.required)return n();jb.required(e,t,r,a,i),void 0!==t&&(jb.type(e,t,r,a,i),jb.range(e,t,r,a,i))}n(a)},boolean:function(e,t,n,r,i){var a=[];if(e.required||!e.required&&r.hasOwnProperty(e.field)){if(kb(t)&&!e.required)return n();jb.required(e,t,r,a,i),void 0!==t&&jb.type(e,t,r,a,i)}n(a)},regexp:function(e,t,n,r,i){var a=[];if(e.required||!e.required&&r.hasOwnProperty(e.field)){if(kb(t)&&!e.required)return n();jb.required(e,t,r,a,i),kb(t)||jb.type(e,t,r,a,i)}n(a)},integer:function(e,t,n,r,i){var a=[];if(e.required||!e.required&&r.hasOwnProperty(e.field)){if(kb(t)&&!e.required)return n();jb.required(e,t,r,a,i),void 0!==t&&(jb.type(e,t,r,a,i),jb.range(e,t,r,a,i))}n(a)},float:function(e,t,n,r,i){var a=[];if(e.required||!e.required&&r.hasOwnProperty(e.field)){if(kb(t)&&!e.required)return n();jb.required(e,t,r,a,i),void 0!==t&&(jb.type(e,t,r,a,i),jb.range(e,t,r,a,i))}n(a)},array:function(e,t,n,r,i){var a=[];if(e.required||!e.required&&r.hasOwnProperty(e.field)){if(null==t&&!e.required)return n();jb.required(e,t,r,a,i,"array"),null!=t&&(jb.type(e,t,r,a,i),jb.range(e,t,r,a,i))}n(a)},object:function(e,t,n,r,i){var a=[];if(e.required||!e.required&&r.hasOwnProperty(e.field)){if(kb(t)&&!e.required)return n();jb.required(e,t,r,a,i),void 0!==t&&jb.type(e,t,r,a,i)}n(a)},enum:function(e,t,n,r,i){var a=[];if(e.required||!e.required&&r.hasOwnProperty(e.field)){if(kb(t)&&!e.required)return n();jb.required(e,t,r,a,i),void 0!==t&&jb.enum(e,t,r,a,i)}n(a)},pattern:function(e,t,n,r,i){var a=[];if(e.required||!e.required&&r.hasOwnProperty(e.field)){if(kb(t,"string")&&!e.required)return n();jb.required(e,t,r,a,i),kb(t,"string")||jb.pattern(e,t,r,a,i)}n(a)},date:function(e,t,n,r,i){var a=[];if(e.required||!e.required&&r.hasOwnProperty(e.field)){if(kb(t,"date")&&!e.required)return n();var s;if(jb.required(e,t,r,a,i),!kb(t,"date"))s=t instanceof Date?t:new Date(t),jb.type(e,s,r,a,i),s&&jb.range(e,s.getTime(),r,a,i)}n(a)},url:Wb,hex:Wb,email:Wb,required:function(e,t,n,r,i){var a=[],s=Array.isArray(t)?"array":typeof t;jb.required(e,t,r,a,i,s),n(a)},any:function(e,t,n,r,i){var a=[];if(e.required||!e.required&&r.hasOwnProperty(e.field)){if(kb(t)&&!e.required)return n();jb.required(e,t,r,a,i)}n(a)}};function $b(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var e=JSON.parse(JSON.stringify(this));return e.clone=this.clone,e}}}var Xb=$b(),qb=function(){function e(e){this.rules=null,this._messages=Xb,this.define(e)}var t=e.prototype;return t.define=function(e){var t=this;if(!e)throw new Error("Cannot configure a schema with no rules");if("object"!=typeof e||Array.isArray(e))throw new Error("Rules must be an object");this.rules={},Object.keys(e).forEach((function(n){var r=e[n];t.rules[n]=Array.isArray(r)?r:[r]}))},t.messages=function(e){return e&&(this._messages=Bb($b(),e)),this._messages},t.validate=function(t,n,r){var i=this;void 0===n&&(n={}),void 0===r&&(r=function(){});var a=t,s=n,o=r;if("function"==typeof s&&(o=s,s={}),!this.rules||0===Object.keys(this.rules).length)return o&&o(null,a),Promise.resolve(a);if(s.messages){var l=this.messages();l===Xb&&(l=$b()),Bb(l,s.messages),s.messages=l}else s.messages=this.messages();var u={};(s.keys||Object.keys(this.rules)).forEach((function(e){var n=i.rules[e],r=a[e];n.forEach((function(n){var s=n;"function"==typeof s.transform&&(a===t&&(a=Sb({},a)),r=a[e]=s.transform(r)),(s="function"==typeof s?{validator:s}:Sb({},s)).validator=i.getValidationMethod(s),s.validator&&(s.field=e,s.fullField=s.fullField||e,s.type=i.getType(s),u[e]=u[e]||[],u[e].push({rule:s,value:r,source:a,field:e}))}))}));var c={};return Ob(u,s,(function(t,n){var r,i=t.rule,o=!("object"!==i.type&&"array"!==i.type||"object"!=typeof i.fields&&"object"!=typeof i.defaultField);function l(e,t){return Sb({},t,{fullField:i.fullField+"."+e,fullFields:i.fullFields?[].concat(i.fullFields,[e]):[e]})}function u(r){void 0===r&&(r=[]);var u=Array.isArray(r)?r:[r];!s.suppressWarning&&u.length&&e.warning("async-validator:",u),u.length&&void 0!==i.message&&(u=[].concat(i.message));var d=u.map(Nb(i,a));if(s.first&&d.length)return c[i.field]=1,n(d);if(o){if(i.required&&!t.value)return void 0!==i.message?d=[].concat(i.message).map(Nb(i,a)):s.error&&(d=[s.error(i,Lb(s.messages.required,i.field))]),n(d);var h={};i.defaultField&&Object.keys(t.value).map((function(e){h[e]=i.defaultField})),h=Sb({},h,t.rule.fields);var p={};Object.keys(h).forEach((function(e){var t=h[e],n=Array.isArray(t)?t:[t];p[e]=n.map(l.bind(null,e))}));var f=new e(p);f.messages(s.messages),t.rule.options&&(t.rule.options.messages=s.messages,t.rule.options.error=s.error),f.validate(t.value,t.rule.options||s,(function(e){var t=[];d&&d.length&&t.push.apply(t,d),e&&e.length&&t.push.apply(t,e),n(t.length?t:null)}))}else n(d)}if(o=o&&(i.required||!i.required&&t.value),i.field=t.field,i.asyncValidator)r=i.asyncValidator(i,t.value,u,t.source,s);else if(i.validator){try{r=i.validator(i,t.value,u,t.source,s)}catch(d){null==console.error||console.error(d),s.suppressValidatorError||setTimeout((function(){throw d}),0),u(d.message)}!0===r?u():!1===r?u("function"==typeof i.message?i.message(i.fullField||i.field):i.message||(i.fullField||i.field)+" fails"):r instanceof Array?u(r):r instanceof Error&&u(r.message)}r&&r.then&&r.then((function(){return u()}),(function(e){return u(e)}))}),(function(e){!function(e){for(var t,n,r=[],i={},s=0;s<e.length;s++)t=e[s],n=void 0,Array.isArray(t)?r=(n=r).concat.apply(n,t):r.push(t);r.length?(i=Rb(r),o(r,i)):o(null,a)}(e)}),a)},t.getType=function(e){if(void 0===e.type&&e.pattern instanceof RegExp&&(e.type="pattern"),"function"!=typeof e.validator&&e.type&&!Yb.hasOwnProperty(e.type))throw new Error(Lb("Unknown rule type %s",e.type));return e.type||"string"},t.getValidationMethod=function(e){if("function"==typeof e.validator)return e.validator;var t=Object.keys(e),n=t.indexOf("message");return-1!==n&&t.splice(n,1),1===t.length&&"required"===t[0]?Yb.required:Yb[this.getType(e)]||void 0},e}();qb.register=function(e,t){if("function"!=typeof t)throw new Error("Cannot register a validator by type, validator is not a function");Yb[e]=t},qb.warning=Pb,qb.messages=Xb,qb.validators=Yb;const Kb=pg({label:String,labelWidth:{type:[String,Number],default:""},prop:{type:[String,Array]},required:{type:Boolean,default:void 0},rules:{type:[Object,Array]},error:String,validateStatus:{type:String,values:["","error","validating","success"]},for:String,inlineMessage:{type:[String,Boolean],default:""},showMessage:{type:Boolean,default:!0},size:{type:String,values:Pg}}),Zb="ElLabelWrap";var Jb=Fn({name:Zb,props:{isAutoWidth:Boolean,updateAll:Boolean},setup(e,{slots:t}){const n=Sn(ub,void 0),r=Sn(cb);r||Wh(Zb,"usage: <el-form-item><label-wrap /></el-form-item>");const i=rv("form"),a=At(),s=At(0),o=(r="update")=>{en((()=>{t.default&&e.isAutoWidth&&("update"===r?s.value=(()=>{var e;if(null==(e=a.value)?void 0:e.firstElementChild){const e=window.getComputedStyle(a.value.firstElementChild).width;return Math.ceil(Number.parseFloat(e))}return 0})():"remove"===r&&(null==n||n.deregisterLabelWidth(s.value)))}))},l=()=>o("update");return Kn((()=>{l()})),Qn((()=>{o("remove")})),Jn((()=>l())),Mn(s,((t,r)=>{e.updateAll&&(null==n||n.registerLabelWidth(t,r))})),lo(Ki((()=>{var e,t;return null!=(t=null==(e=a.value)?void 0:e.firstElementChild)?t:null})),l),()=>{var o,l;if(!t)return null;const{isAutoWidth:u}=e;if(u){const e=null==n?void 0:n.autoLabelWidth,l={};if((null==r?void 0:r.hasLabel)&&e&&"auto"!==e){const t=Math.max(0,Number.parseInt(e,10)-s.value),r="left"===n.labelPosition?"marginRight":"marginLeft";t&&(l[r]=`${t}px`)}return Mi("div",{ref:a,class:[i.be("item","label-wrap")],style:l},[null==(o=t.default)?void 0:o.call(t)])}return Mi(li,{ref:a},[null==(l=t.default)?void 0:l.call(t)])}}});const Qb=["role","aria-labelledby"],ex=Fn({name:"ElFormItem"}),tx=Fn({...ex,props:Kb,setup(e,{expose:t}){const n=e,i=Zi(),a=Sn(ub,void 0),s=Sn(cb,void 0),o=db(void 0,{formItem:!1}),u=rv("form-item"),c=Iy().value,d=At([]),h=At(""),p=function(e,t=200,n={}){const r=At(e.value),i=js((()=>{r.value=e.value}),t,n);return Mn(e,(()=>i())),r}(h,100),m=At(""),g=At();let v,y=!1;const _=Ki((()=>{if("top"===(null==a?void 0:a.labelPosition))return{};const e=Zh(n.labelWidth||(null==a?void 0:a.labelWidth)||"");return e?{width:e}:{}})),b=Ki((()=>{if("top"===(null==a?void 0:a.labelPosition)||(null==a?void 0:a.inline))return{};if(!n.label&&!n.labelWidth&&A)return{};const e=Zh(n.labelWidth||(null==a?void 0:a.labelWidth)||"");return n.label||i.label?{}:{marginLeft:e}})),x=Ki((()=>[u.b(),u.m(o.value),u.is("error","error"===h.value),u.is("validating","validating"===h.value),u.is("success","success"===h.value),u.is("required",I.value||n.required),u.is("no-asterisk",null==a?void 0:a.hideRequiredAsterisk),"right"===(null==a?void 0:a.requireAsteriskPosition)?"asterisk-right":"asterisk-left",{[u.m("feedback")]:null==a?void 0:a.statusIcon}])),w=Ki((()=>Ns(n.inlineMessage)?n.inlineMessage:(null==a?void 0:a.inlineMessage)||!1)),S=Ki((()=>[u.e("error"),{[u.em("error","inline")]:w.value}])),C=Ki((()=>n.prop?D(n.prop)?n.prop:n.prop.join("."):"")),T=Ki((()=>!(!n.label&&!i.label))),M=Ki((()=>n.for||1===d.value.length?d.value[0]:void 0)),E=Ki((()=>!M.value&&T.value)),A=!!s,P=Ki((()=>{const e=null==a?void 0:a.model;if(e&&n.prop)return Hh(e,n.prop).value})),R=Ki((()=>{const{required:e}=n,t=[];n.rules&&t.push(...ec(n.rules));const r=null==a?void 0:a.rules;if(r&&n.prop){const e=Hh(r,n.prop).value;e&&t.push(...ec(e))}if(void 0!==e){const n=t.map(((e,t)=>[e,t])).filter((([e])=>Object.keys(e).includes("required")));if(n.length>0)for(const[r,i]of n)r.required!==e&&(t[i]={...r,required:e});else t.push({required:e})}return t})),L=Ki((()=>R.value.length>0)),I=Ki((()=>R.value.some((e=>e.required)))),O=Ki((()=>{var e;return"error"===p.value&&n.showMessage&&(null==(e=null==a?void 0:a.showMessage)||e)})),N=Ki((()=>`${n.label||""}${(null==a?void 0:a.labelSuffix)||""}`)),B=e=>{h.value=e},U=async e=>{const t=C.value;return new qb({[t]:e}).validate({[t]:P.value},{firstFields:!0}).then((()=>(B("success"),null==a||a.emit("validate",n.prop,!0,""),!0))).catch((e=>((e=>{var t,r;const{errors:i,fields:s}=e;i&&s||console.error(e),B("error"),m.value=i?null!=(r=null==(t=null==i?void 0:i[0])?void 0:t.message)?r:`${n.prop} is required`:"",null==a||a.emit("validate",n.prop,!1,m.value)})(e),Promise.reject(e))))},z=async(e,t)=>{if(y||!n.prop)return!1;const r=k(t);if(!L.value)return null==t||t(!1),!1;const i=(e=>R.value.filter((t=>!t.trigger||!e||(Array.isArray(t.trigger)?t.trigger.includes(e):t.trigger===e))).map((({trigger:e,...t})=>t)))(e);return 0===i.length?(null==t||t(!0),!0):(B("validating"),U(i).then((()=>(null==t||t(!0),!0))).catch((e=>{const{fields:n}=e;return null==t||t(!1,n),!r&&Promise.reject(n)})))},F=()=>{B(""),m.value="",y=!1},V=async()=>{const e=null==a?void 0:a.model;if(!e||!n.prop)return;const t=Hh(e,n.prop);y=!0,t.value=vd(v),await en(),F(),y=!1};Mn((()=>n.error),(e=>{m.value=e||"",B(e?"error":"")}),{immediate:!0}),Mn((()=>n.validateStatus),(e=>B(e||"")));const G=pt({...Nt(n),$el:g,size:o,validateState:h,labelId:c,inputIds:d,isGroup:E,hasLabel:T,addInputId:e=>{d.value.includes(e)||d.value.push(e)},removeInputId:e=>{d.value=d.value.filter((t=>t!==e))},resetField:V,clearValidate:F,validate:z});return wn(cb,G),Kn((()=>{n.prop&&(null==a||a.addField(G),v=vd(P.value))})),Qn((()=>{null==a||a.removeField(G)})),t({size:o,validateMessage:m,validateState:h,validate:z,clearValidate:F,resetField:V}),(e,t)=>{var n;return fi(),yi("div",{ref_key:"formItemRef",ref:g,class:l(Dt(x)),role:Dt(E)?"group":void 0,"aria-labelledby":Dt(E)?Dt(c):void 0},[Mi(Dt(Jb),{"is-auto-width":"auto"===Dt(_).width,"update-all":"auto"===(null==(n=Dt(a))?void 0:n.labelWidth)},{default:vn((()=>[Dt(T)?(fi(),_i(dr(Dt(M)?"label":"div"),{key:0,id:Dt(c),for:Dt(M),class:l(Dt(u).e("label")),style:r(Dt(_))},{default:vn((()=>[vr(e.$slots,"label",{label:Dt(N)},(()=>[Pi(f(Dt(N)),1)]))])),_:3},8,["id","for","class","style"])):Li("v-if",!0)])),_:3},8,["is-auto-width","update-all"]),Ti("div",{class:l(Dt(u).e("content")),style:r(Dt(b))},[vr(e.$slots,"default"),Mi(Fa,{name:`${Dt(u).namespace.value}-zoom-in-top`},{default:vn((()=>[Dt(O)?vr(e.$slots,"error",{key:0,error:m.value},(()=>[Ti("div",{class:l(Dt(S))},f(m.value),3)])):Li("v-if",!0)])),_:3},8,["name"])],6)],10,Qb)}}});var nx=J_(tx,[["__file","/home/runner/work/element-plus/element-plus/packages/components/form/src/form-item.vue"]]);const rx=_g(wb,{FormItem:nx}),ix=xg(nx);let ax;const sx=`\n  height:0 !important;\n  visibility:hidden !important;\n  ${Ug()?"":"overflow:hidden !important;"}\n  position:absolute !important;\n  z-index:-1000 !important;\n  top:0 !important;\n  right:0 !important;\n`,ox=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];function lx(e,t=1,n){var r;ax||(ax=document.createElement("textarea"),document.body.appendChild(ax));const{paddingSize:i,borderSize:a,boxSizing:s,contextStyle:o}=function(e){const t=window.getComputedStyle(e),n=t.getPropertyValue("box-sizing"),r=Number.parseFloat(t.getPropertyValue("padding-bottom"))+Number.parseFloat(t.getPropertyValue("padding-top")),i=Number.parseFloat(t.getPropertyValue("border-bottom-width"))+Number.parseFloat(t.getPropertyValue("border-top-width"));return{contextStyle:ox.map((e=>`${e}:${t.getPropertyValue(e)}`)).join(";"),paddingSize:r,borderSize:i,boxSizing:n}}(e);ax.setAttribute("style",`${o};${sx}`),ax.value=e.value||e.placeholder||"";let l=ax.scrollHeight;const u={};"border-box"===s?l+=a:"content-box"===s&&(l-=i),ax.value="";const c=ax.scrollHeight-i;if(Bs(t)){let e=c*t;"border-box"===s&&(e=e+i+a),l=Math.max(e,l),u.minHeight=`${e}px`}if(Bs(n)){let e=c*n;"border-box"===s&&(e=e+i+a),l=Math.min(e,l)}return u.height=`${l}px`,null==(r=ax.parentNode)||r.removeChild(ax),ax=void 0,u}const ux=pg({id:{type:String,default:void 0},size:z_,disabled:Boolean,modelValue:{type:[String,Number,Object],default:""},type:{type:String,default:"text"},resize:{type:String,values:["none","both","horizontal","vertical"]},autosize:{type:[Boolean,Object],default:!1},autocomplete:{type:String,default:"off"},formatter:{type:Function},parser:{type:Function},placeholder:{type:String},form:{type:String},readonly:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},showPassword:{type:Boolean,default:!1},showWordLimit:{type:Boolean,default:!1},suffixIcon:{type:fg},prefixIcon:{type:fg},containerRole:{type:String,default:void 0},label:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},validateEvent:{type:Boolean,default:!0},inputStyle:{type:[Object,Array,String],default:()=>({})}}),cx={[Tg]:e=>D(e),input:e=>D(e),change:e=>D(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0,mouseleave:e=>e instanceof MouseEvent,mouseenter:e=>e instanceof MouseEvent,keydown:e=>e instanceof Event,compositionstart:e=>e instanceof CompositionEvent,compositionupdate:e=>e instanceof CompositionEvent,compositionend:e=>e instanceof CompositionEvent},dx=["role"],hx=["id","type","disabled","formatter","parser","readonly","autocomplete","tabindex","aria-label","placeholder","form"],px=["id","tabindex","disabled","readonly","autocomplete","aria-label","placeholder","form"],fx=Fn({name:"ElInput",inheritAttrs:!1});const mx=_g(J_(Fn({...fx,props:ux,emits:cx,setup(e,{expose:t,emit:n}){const i=e,a=Ji(),s=Zi(),o=Ki((()=>{const e={};return"combobox"===i.containerRole&&(e["aria-haspopup"]=a["aria-haspopup"],e["aria-owns"]=a["aria-owns"],e["aria-expanded"]=a["aria-expanded"]),e})),u=Ki((()=>["textarea"===i.type?b.b():_.b(),_.m(g.value),_.is("disabled",v.value),_.is("exceed",G.value),{[_.b("group")]:s.prepend||s.append,[_.bm("group","append")]:s.append,[_.bm("group","prepend")]:s.prepend,[_.m("prefix")]:s.prefix||i.prefixIcon,[_.m("suffix")]:s.suffix||i.suffixIcon||i.clearable||i.showPassword,[_.bm("suffix","password-clear")]:U.value&&z.value},a.class])),c=Ki((()=>[_.e("wrapper"),_.is("focus",S.value)])),d=Wg({excludeKeys:Ki((()=>Object.keys(o.value)))}),{form:h,formItem:p}=pb(),{inputId:m}=fb(i,{formItemContext:p}),g=db(),v=hb(),_=rv("input"),b=rv("textarea"),x=Pt(),w=Pt(),S=At(!1),C=At(!1),T=At(!1),M=At(!1),E=At(),A=Pt(i.inputStyle),P=Ki((()=>x.value||w.value)),R=Ki((()=>{var e;return null!=(e=null==h?void 0:h.statusIcon)&&e})),L=Ki((()=>(null==p?void 0:p.validateState)||"")),k=Ki((()=>L.value&&yg[L.value])),D=Ki((()=>M.value?Jm:If)),I=Ki((()=>[a.style,i.inputStyle])),N=Ki((()=>[i.inputStyle,A.value,{resize:i.resize}])),B=Ki((()=>Ah(i.modelValue)?"":String(i.modelValue))),U=Ki((()=>i.clearable&&!v.value&&!i.readonly&&!!B.value&&(S.value||C.value))),z=Ki((()=>i.showPassword&&!v.value&&!i.readonly&&!!B.value&&(!!B.value||S.value))),F=Ki((()=>i.showWordLimit&&!!d.value.maxlength&&("text"===i.type||"textarea"===i.type)&&!v.value&&!i.readonly&&!i.showPassword)),V=Ki((()=>B.value.length)),G=Ki((()=>!!F.value&&V.value>Number(d.value.maxlength))),H=Ki((()=>!!s.suffix||!!i.suffixIcon||U.value||i.showPassword||F.value||!!L.value&&R.value)),[j,W]=function(e){const t=At();return[function(){if(null==e.value)return;const{selectionStart:n,selectionEnd:r,value:i}=e.value;if(null==n||null==r)return;const a=i.slice(0,Math.max(0,n)),s=i.slice(Math.max(0,r));t.value={selectionStart:n,selectionEnd:r,value:i,beforeTxt:a,afterTxt:s}},function(){if(null==e.value||null==t.value)return;const{value:n}=e.value,{beforeTxt:r,afterTxt:i,selectionStart:a}=t.value;if(null==r||null==i||null==a)return;let s=n.length;if(n.endsWith(i))s=n.length-i.length;else if(n.startsWith(r))s=r.length;else{const e=r[a-1],t=n.indexOf(e,a-1);-1!==t&&(s=t+1)}e.value.setSelectionRange(s,s)}]}(x);lo(w,(e=>{if($(),!F.value||"both"!==i.resize)return;const t=e[0],{width:n}=t.contentRect;E.value={right:`calc(100% - ${n+15+6}px)`}}));const Y=()=>{const{type:e,autosize:t}=i;if(Os&&"textarea"===e&&w.value)if(t){const e=O(t)?t.minRows:void 0,n=O(t)?t.maxRows:void 0,r=lx(w.value,e,n);A.value={overflowY:"hidden",...r},en((()=>{w.value.offsetHeight,A.value=r}))}else A.value={minHeight:lx(w.value).minHeight}},$=(e=>{let t=!1;return()=>{var n;if(t||!i.autosize)return;null===(null==(n=w.value)?void 0:n.offsetParent)||(e(),t=!0)}})(Y),X=()=>{const e=P.value;e&&e.value!==B.value&&(e.value=B.value)},q=async e=>{j();let{value:t}=e.target;i.formatter&&(t=i.parser?i.parser(t):t,t=i.formatter(t)),T.value||(t!==B.value?(n(Tg,t),n("input",t),await en(),X(),W()):X())},K=e=>{n("change",e.target.value)},Z=e=>{n("compositionstart",e),T.value=!0},J=e=>{var t;n("compositionupdate",e);const r=null==(t=e.target)?void 0:t.value,i=r[r.length-1]||"";T.value=!zg(i)},Q=e=>{n("compositionend",e),T.value&&(T.value=!1,q(e))},ee=()=>{M.value=!M.value,te()},te=async()=>{var e;await en(),null==(e=P.value)||e.focus()},ne=e=>{S.value=!0,n("focus",e)},re=e=>{var t;S.value=!1,n("blur",e),i.validateEvent&&(null==(t=null==p?void 0:p.validate)||t.call(p,"blur").catch((e=>{})))},ie=e=>{C.value=!1,n("mouseleave",e)},ae=e=>{C.value=!0,n("mouseenter",e)},se=e=>{n("keydown",e)},oe=()=>{n(Tg,""),n("change",""),n("clear"),n("input","")};return Mn((()=>i.modelValue),(()=>{var e;en((()=>Y())),i.validateEvent&&(null==(e=null==p?void 0:p.validate)||e.call(p,"change").catch((e=>{})))})),Mn(B,(()=>X())),Mn((()=>i.type),(async()=>{await en(),X(),Y()})),Kn((()=>{!i.formatter&&i.parser,X(),en(Y)})),t({input:x,textarea:w,ref:P,textareaStyle:N,autosize:Ut(i,"autosize"),focus:te,blur:()=>{var e;return null==(e=P.value)?void 0:e.blur()},select:()=>{var e;null==(e=P.value)||e.select()},clear:oe,resizeTextarea:Y}),(e,t)=>ar((fi(),yi("div",Oi(Dt(o),{class:Dt(u),style:Dt(I),role:e.containerRole,onMouseenter:ae,onMouseleave:ie}),[Li(" input "),"textarea"!==e.type?(fi(),yi(li,{key:0},[Li(" prepend slot "),e.$slots.prepend?(fi(),yi("div",{key:0,class:l(Dt(_).be("group","prepend"))},[vr(e.$slots,"prepend")],2)):Li("v-if",!0),Ti("div",{class:l(Dt(c))},[Li(" prefix slot "),e.$slots.prefix||e.prefixIcon?(fi(),yi("span",{key:0,class:l(Dt(_).e("prefix"))},[Ti("span",{class:l(Dt(_).e("prefix-inner")),onClick:te},[vr(e.$slots,"prefix"),e.prefixIcon?(fi(),_i(Dt(ib),{key:0,class:l(Dt(_).e("icon"))},{default:vn((()=>[(fi(),_i(dr(e.prefixIcon)))])),_:1},8,["class"])):Li("v-if",!0)],2)],2)):Li("v-if",!0),Ti("input",Oi({id:Dt(m),ref_key:"input",ref:x,class:Dt(_).e("inner")},Dt(d),{type:e.showPassword?M.value?"text":"password":e.type,disabled:Dt(v),formatter:e.formatter,parser:e.parser,readonly:e.readonly,autocomplete:e.autocomplete,tabindex:e.tabindex,"aria-label":e.label,placeholder:e.placeholder,style:e.inputStyle,form:i.form,onCompositionstart:Z,onCompositionupdate:J,onCompositionend:Q,onInput:q,onFocus:ne,onBlur:re,onChange:K,onKeydown:se}),null,16,hx),Li(" suffix slot "),Dt(H)?(fi(),yi("span",{key:1,class:l(Dt(_).e("suffix"))},[Ti("span",{class:l(Dt(_).e("suffix-inner")),onClick:te},[Dt(U)&&Dt(z)&&Dt(F)?Li("v-if",!0):(fi(),yi(li,{key:0},[vr(e.$slots,"suffix"),e.suffixIcon?(fi(),_i(Dt(ib),{key:0,class:l(Dt(_).e("icon"))},{default:vn((()=>[(fi(),_i(dr(e.suffixIcon)))])),_:1},8,["class"])):Li("v-if",!0)],64)),Dt(U)?(fi(),_i(Dt(ib),{key:1,class:l([Dt(_).e("icon"),Dt(_).e("clear")]),onMousedown:ts(Dt(y),["prevent"]),onClick:oe},{default:vn((()=>[Mi(Dt(tf))])),_:1},8,["class","onMousedown"])):Li("v-if",!0),Dt(z)?(fi(),_i(Dt(ib),{key:2,class:l([Dt(_).e("icon"),Dt(_).e("password")]),onClick:ee},{default:vn((()=>[(fi(),_i(dr(Dt(D))))])),_:1},8,["class"])):Li("v-if",!0),Dt(F)?(fi(),yi("span",{key:3,class:l(Dt(_).e("count"))},[Ti("span",{class:l(Dt(_).e("count-inner"))},f(Dt(V))+" / "+f(Dt(d).maxlength),3)],2)):Li("v-if",!0),Dt(L)&&Dt(k)&&Dt(R)?(fi(),_i(Dt(ib),{key:4,class:l([Dt(_).e("icon"),Dt(_).e("validateIcon"),Dt(_).is("loading","validating"===Dt(L))])},{default:vn((()=>[(fi(),_i(dr(Dt(k))))])),_:1},8,["class"])):Li("v-if",!0)],2)],2)):Li("v-if",!0)],2),Li(" append slot "),e.$slots.append?(fi(),yi("div",{key:1,class:l(Dt(_).be("group","append"))},[vr(e.$slots,"append")],2)):Li("v-if",!0)],64)):(fi(),yi(li,{key:1},[Li(" textarea "),Ti("textarea",Oi({id:Dt(m),ref_key:"textarea",ref:w,class:Dt(b).e("inner")},Dt(d),{tabindex:e.tabindex,disabled:Dt(v),readonly:e.readonly,autocomplete:e.autocomplete,style:Dt(N),"aria-label":e.label,placeholder:e.placeholder,form:i.form,onCompositionstart:Z,onCompositionupdate:J,onCompositionend:Q,onInput:q,onFocus:ne,onBlur:re,onChange:K,onKeydown:se}),null,16,px),Dt(F)?(fi(),yi("span",{key:0,style:r(E.value),class:l(Dt(_).e("count"))},f(Dt(V))+" / "+f(Dt(d).maxlength),7)):Li("v-if",!0)],64))],16,dx)),[[is,"hidden"!==e.type]])}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/input/src/input.vue"]])),gx={vertical:{offset:"offsetHeight",scroll:"scrollTop",scrollSize:"scrollHeight",size:"height",key:"vertical",axis:"Y",client:"clientY",direction:"top"},horizontal:{offset:"offsetWidth",scroll:"scrollLeft",scrollSize:"scrollWidth",size:"width",key:"horizontal",axis:"X",client:"clientX",direction:"left"}},vx=Symbol("scrollbarContextKey"),yx=pg({vertical:Boolean,size:String,move:Number,ratio:{type:Number,required:!0},always:Boolean}),_x=Fn({__name:"thumb",props:yx,setup(e){const t=e,n=Sn(vx),i=rv("scrollbar");n||Wh("Thumb","can not inject scrollbar context");const a=At(),s=At(),o=At({}),u=At(!1);let c=!1,d=!1,h=Os?document.onselectstart:null;const p=Ki((()=>gx[t.vertical?"vertical":"horizontal"])),f=Ki((()=>(({move:e,size:t,bar:n})=>({[n.size]:t,transform:`translate${n.axis}(${e}%)`}))({size:t.size,move:t.move,bar:p.value}))),m=Ki((()=>a.value[p.value.offset]**2/n.wrapElement[p.value.scrollSize]/t.ratio/s.value[p.value.offset])),g=e=>{var t;if(e.stopPropagation(),e.ctrlKey||[1,2].includes(e.button))return;null==(t=window.getSelection())||t.removeAllRanges(),y(e);const n=e.currentTarget;n&&(o.value[p.value.axis]=n[p.value.offset]-(e[p.value.client]-n.getBoundingClientRect()[p.value.direction]))},v=e=>{if(!s.value||!a.value||!n.wrapElement)return;const t=100*(Math.abs(e.target.getBoundingClientRect()[p.value.direction]-e[p.value.client])-s.value[p.value.offset]/2)*m.value/a.value[p.value.offset];n.wrapElement[p.value.scroll]=t*n.wrapElement[p.value.scrollSize]/100},y=e=>{e.stopImmediatePropagation(),c=!0,document.addEventListener("mousemove",_),document.addEventListener("mouseup",b),h=document.onselectstart,document.onselectstart=()=>!1},_=e=>{if(!a.value||!s.value)return;if(!1===c)return;const t=o.value[p.value.axis];if(!t)return;const r=100*(-1*(a.value.getBoundingClientRect()[p.value.direction]-e[p.value.client])-(s.value[p.value.offset]-t))*m.value/a.value[p.value.offset];n.wrapElement[p.value.scroll]=r*n.wrapElement[p.value.scrollSize]/100},b=()=>{c=!1,o.value[p.value.axis]=0,document.removeEventListener("mousemove",_),document.removeEventListener("mouseup",b),x(),d&&(u.value=!1)};Qn((()=>{x(),document.removeEventListener("mouseup",b)}));const x=()=>{document.onselectstart!==h&&(document.onselectstart=h)};return Zs(Ut(n,"scrollbarElement"),"mousemove",(()=>{d=!1,u.value=!!t.size})),Zs(Ut(n,"scrollbarElement"),"mouseleave",(()=>{d=!0,u.value=c})),(e,t)=>(fi(),_i(xa,{name:Dt(i).b("fade"),persisted:""},{default:vn((()=>[ar(Ti("div",{ref_key:"instance",ref:a,class:l([Dt(i).e("bar"),Dt(i).is(Dt(p).key)]),onMousedown:v},[Ti("div",{ref_key:"thumb",ref:s,class:l(Dt(i).e("thumb")),style:r(Dt(f)),onMousedown:g},null,38)],34),[[is,e.always||u.value]])])),_:1},8,["name"]))}});var bx=J_(_x,[["__file","/home/runner/work/element-plus/element-plus/packages/components/scrollbar/src/thumb.vue"]]);var xx=J_(Fn({__name:"bar",props:pg({always:{type:Boolean,default:!0},width:String,height:String,ratioX:{type:Number,default:1},ratioY:{type:Number,default:1}}),setup(e,{expose:t}){const n=e,r=At(0),i=At(0);return t({handleScroll:e=>{if(e){const t=e.offsetHeight-4,a=e.offsetWidth-4;i.value=100*e.scrollTop/t*n.ratioY,r.value=100*e.scrollLeft/a*n.ratioX}}}),(e,t)=>(fi(),yi(li,null,[Mi(bx,{move:r.value,ratio:e.ratioX,size:e.width,always:e.always},null,8,["move","ratio","size","always"]),Mi(bx,{move:i.value,ratio:e.ratioY,size:e.height,vertical:"",always:e.always},null,8,["move","ratio","size","always"])],64))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/scrollbar/src/bar.vue"]]);const wx=pg({height:{type:[String,Number],default:""},maxHeight:{type:[String,Number],default:""},native:{type:Boolean,default:!1},wrapStyle:{type:[String,Object,Array],default:""},wrapClass:{type:[String,Array],default:""},viewClass:{type:[String,Array],default:""},viewStyle:{type:[String,Array,Object],default:""},noresize:Boolean,tag:{type:String,default:"div"},always:Boolean,minSize:{type:Number,default:20}}),Sx={scroll:({scrollTop:e,scrollLeft:t})=>[e,t].every(Bs)},Cx=Fn({name:"ElScrollbar"});const Tx=_g(J_(Fn({...Cx,props:wx,emits:Sx,setup(e,{expose:t,emit:n}){const i=e,a=rv("scrollbar");let s,o;const u=At(),c=At(),d=At(),h=At("0"),p=At("0"),f=At(),m=At(1),g=At(1),v=Ki((()=>{const e={};return i.height&&(e.height=Zh(i.height)),i.maxHeight&&(e.maxHeight=Zh(i.maxHeight)),[i.wrapStyle,e]})),y=Ki((()=>[i.wrapClass,a.e("wrap"),{[a.em("wrap","hidden-default")]:!i.native}])),_=Ki((()=>[a.e("view"),i.viewClass])),b=()=>{var e;c.value&&(null==(e=f.value)||e.handleScroll(c.value),n("scroll",{scrollTop:c.value.scrollTop,scrollLeft:c.value.scrollLeft}))};const x=()=>{if(!c.value)return;const e=c.value.offsetHeight-4,t=c.value.offsetWidth-4,n=e**2/c.value.scrollHeight,r=t**2/c.value.scrollWidth,a=Math.max(n,i.minSize),s=Math.max(r,i.minSize);m.value=n/(e-n)/(a/(e-a)),g.value=r/(t-r)/(s/(t-s)),p.value=a+4<e?`${a}px`:"",h.value=s+4<t?`${s}px`:""};return Mn((()=>i.noresize),(e=>{e?(null==s||s(),null==o||o()):(({stop:s}=lo(d,x)),o=Zs("resize",x))}),{immediate:!0}),Mn((()=>[i.maxHeight,i.height]),(()=>{i.native||en((()=>{var e;x(),c.value&&(null==(e=f.value)||e.handleScroll(c.value))}))})),wn(vx,pt({scrollbarElement:u,wrapElement:c})),Kn((()=>{i.native||en((()=>{x()}))})),Jn((()=>x())),t({wrapRef:c,update:x,scrollTo:function(e,t){O(e)?c.value.scrollTo(e):Bs(e)&&Bs(t)&&c.value.scrollTo(e,t)},setScrollTop:e=>{Bs(e)&&(c.value.scrollTop=e)},setScrollLeft:e=>{Bs(e)&&(c.value.scrollLeft=e)},handleScroll:b}),(e,t)=>(fi(),yi("div",{ref_key:"scrollbarRef",ref:u,class:l(Dt(a).b())},[Ti("div",{ref_key:"wrapRef",ref:c,class:l(Dt(y)),style:r(Dt(v)),onScroll:b},[(fi(),_i(dr(e.tag),{ref_key:"resizeRef",ref:d,class:l(Dt(_)),style:r(e.viewStyle)},{default:vn((()=>[vr(e.$slots,"default")])),_:3},8,["class","style"]))],38),e.native?Li("v-if",!0):(fi(),_i(xx,{key:0,ref_key:"barRef",ref:f,height:p.value,width:h.value,always:e.always,"ratio-x":g.value,"ratio-y":m.value},null,8,["height","width","always","ratio-x","ratio-y"]))],2))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/scrollbar/src/scrollbar.vue"]])),Mx=Symbol("popper"),Ex=Symbol("popperContent"),Ax=pg({role:{type:String,values:["dialog","grid","group","listbox","menu","navigation","tooltip","tree"],default:"tooltip"}}),Px=Fn({name:"ElPopper",inheritAttrs:!1});var Rx=J_(Fn({...Px,props:Ax,setup(e,{expose:t}){const n=e,r={triggerRef:At(),popperInstanceRef:At(),contentRef:At(),referenceRef:At(),role:Ki((()=>n.role))};return t(r),wn(Mx,r),(e,t)=>vr(e.$slots,"default")}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/popper.vue"]]);const Lx=pg({arrowOffset:{type:Number,default:5}}),kx=Fn({name:"ElPopperArrow",inheritAttrs:!1});var Dx=J_(Fn({...kx,props:Lx,setup(e,{expose:t}){const n=e,i=rv("popper"),{arrowOffset:a,arrowRef:s,arrowStyle:o}=Sn(Ex,void 0);return Mn((()=>n.arrowOffset),(e=>{a.value=e})),Qn((()=>{s.value=void 0})),t({arrowRef:s}),(e,t)=>(fi(),yi("span",{ref_key:"arrowRef",ref:s,class:l(Dt(i).e("arrow")),style:r(Dt(o)),"data-popper-arrow":""},null,6))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/arrow.vue"]]);const Ix=Fn({name:"ElOnlyChild",setup(e,{slots:t,attrs:n}){var r;const i=Sn(Gy),a=(s=null!=(r=null==i?void 0:i.setForwardRef)?r:y,{mounted(e){s(e)},updated(e){s(e)},unmounted(){s(null)}});var s;return()=>{var e;const r=null==(e=t.default)?void 0:e.call(t,n);if(!r)return null;if(r.length>1)return null;const i=Ox(r);return i?ar(Ai(i,n),[[a]]):null}}});function Ox(e){if(!e)return null;const t=e;for(const n of t){if(O(n))switch(n.type){case ci:continue;case ui:case"svg":return Nx(n);case li:return Ox(n.children);default:return n}return Nx(n)}return null}function Nx(e){const t=rv("only-child");return Mi("span",{class:t.e("content")},[e])}const Bx=pg({virtualRef:{type:Object},virtualTriggering:Boolean,onMouseenter:{type:Function},onMouseleave:{type:Function},onClick:{type:Function},onKeydown:{type:Function},onFocus:{type:Function},onBlur:{type:Function},onContextmenu:{type:Function},id:String,open:Boolean}),Ux=Fn({name:"ElPopperTrigger",inheritAttrs:!1});var zx=J_(Fn({...Ux,props:Bx,setup(e,{expose:t}){const n=e,{role:r,triggerRef:i}=Sn(Mx,void 0);var a;a=i,wn(Gy,{setForwardRef:e=>{a.value=e}});const s=Ki((()=>l.value?n.id:void 0)),o=Ki((()=>{if(r&&"tooltip"===r.value)return n.open&&n.id?n.id:void 0})),l=Ki((()=>{if(r&&"tooltip"!==r.value)return r.value})),u=Ki((()=>l.value?`${n.open}`:void 0));let c;return Kn((()=>{Mn((()=>n.virtualRef),(e=>{e&&(i.value=Xs(e))}),{immediate:!0}),Mn(i,((e,t)=>{null==c||c(),c=void 0,zh(e)&&(["onMouseenter","onMouseleave","onClick","onKeydown","onFocus","onBlur","onContextmenu"].forEach((r=>{var i;const a=n[r];a&&(e.addEventListener(r.slice(2).toLowerCase(),a),null==(i=null==t?void 0:t.removeEventListener)||i.call(t,r.slice(2).toLowerCase(),a))})),c=Mn([s,o,l,u],(t=>{["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach(((n,r)=>{Ah(t[r])?e.removeAttribute(n):e.setAttribute(n,t[r])}))}),{immediate:!0})),zh(t)&&["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach((e=>t.removeAttribute(e)))}),{immediate:!0})})),Qn((()=>{null==c||c(),c=void 0})),t({triggerRef:i}),(e,t)=>e.virtualTriggering?Li("v-if",!0):(fi(),_i(Dt(Ix),Oi({key:0},e.$attrs,{"aria-controls":Dt(s),"aria-describedby":Dt(o),"aria-expanded":Dt(u),"aria-haspopup":Dt(l)}),{default:vn((()=>[vr(e.$slots,"default")])),_:3},16,["aria-controls","aria-describedby","aria-expanded","aria-haspopup"]))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/trigger.vue"]]);const Fx="focus-trap.focus-after-trapped",Vx="focus-trap.focus-after-released",Gx={cancelable:!0,bubbles:!1},Hx={cancelable:!0,bubbles:!1},jx="focusAfterTrapped",Wx="focusAfterReleased",Yx=Symbol("elFocusTrap"),$x=At(),Xx=At(0),qx=At(0);let Kx=0;const Zx=e=>{const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{const t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0||e===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t},Jx=(e,t)=>{for(const n of e)if(!Qx(n,t))return n},Qx=(e,t)=>{if("hidden"===getComputedStyle(e).visibility)return!0;for(;e;){if(t&&e===t)return!1;if("none"===getComputedStyle(e).display)return!0;e=e.parentElement}return!1},ew=(e,t)=>{if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),qx.value=window.performance.now(),e!==n&&(e=>e instanceof HTMLInputElement&&"select"in e)(e)&&t&&e.select()}};function tw(e,t){const n=[...e],r=e.indexOf(t);return-1!==r&&n.splice(r,1),n}const nw=(()=>{let e=[];return{push:t=>{const n=e[0];n&&t!==n&&n.pause(),e=tw(e,t),e.unshift(t)},remove:t=>{var n,r;e=tw(e,t),null==(r=null==(n=e[0])?void 0:n.resume)||r.call(n)}}})(),rw=()=>{$x.value="pointer",Xx.value=window.performance.now()},iw=()=>{$x.value="keyboard",Xx.value=window.performance.now()},aw=e=>new CustomEvent("focus-trap.focusout-prevented",{...Hx,detail:e}),sw=Fn({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[jx,Wx,"focusin","focusout","focusout-prevented","release-requested"],setup(e,{emit:t}){const n=At();let r,i;const{focusReason:a}=(Kn((()=>{0===Kx&&(document.addEventListener("mousedown",rw),document.addEventListener("touchstart",rw),document.addEventListener("keydown",iw)),Kx++})),Qn((()=>{Kx--,Kx<=0&&(document.removeEventListener("mousedown",rw),document.removeEventListener("touchstart",rw),document.removeEventListener("keydown",iw))})),{focusReason:$x,lastUserFocusTimestamp:Xx,lastAutomatedFocusTimestamp:qx});var s;s=n=>{e.trapped&&!o.paused&&t("release-requested",n)},Kn((()=>{0===Oy.length&&document.addEventListener("keydown",Ny),Os&&Oy.push(s)})),Qn((()=>{Oy=Oy.filter((e=>e!==s)),0===Oy.length&&Os&&document.removeEventListener("keydown",Ny)}));const o={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},l=n=>{if(!e.loop&&!e.trapped)return;if(o.paused)return;const{key:r,altKey:i,ctrlKey:s,metaKey:l,currentTarget:u,shiftKey:c}=n,{loop:d}=e,h=r===Sg.tab&&!i&&!s&&!l,p=document.activeElement;if(h&&p){const e=u,[r,i]=(e=>{const t=Zx(e);return[Jx(t,e),Jx(t.reverse(),e)]})(e);if(r&&i)if(c||p!==i){if(c&&[r,e].includes(p)){const e=aw({focusReason:a.value});t("focusout-prevented",e),e.defaultPrevented||(n.preventDefault(),d&&ew(i,!0))}}else{const e=aw({focusReason:a.value});t("focusout-prevented",e),e.defaultPrevented||(n.preventDefault(),d&&ew(r,!0))}else if(p===e){const e=aw({focusReason:a.value});t("focusout-prevented",e),e.defaultPrevented||n.preventDefault()}}};wn(Yx,{focusTrapRef:n,onKeydown:l}),Mn((()=>e.focusTrapEl),(e=>{e&&(n.value=e)}),{immediate:!0}),Mn([n],(([e],[t])=>{e&&(e.addEventListener("keydown",l),e.addEventListener("focusin",d),e.addEventListener("focusout",h)),t&&(t.removeEventListener("keydown",l),t.removeEventListener("focusin",d),t.removeEventListener("focusout",h))}));const u=e=>{t(jx,e)},c=e=>t(Wx,e),d=a=>{const s=Dt(n);if(!s)return;const l=a.target,u=a.relatedTarget,c=l&&s.contains(l);if(!e.trapped){u&&s.contains(u)||(r=u)}c&&t("focusin",a),o.paused||e.trapped&&(c?i=l:ew(i,!0))},h=r=>{const s=Dt(n);if(!o.paused&&s)if(e.trapped){const n=r.relatedTarget;Ah(n)||s.contains(n)||setTimeout((()=>{if(!o.paused&&e.trapped){const e=aw({focusReason:a.value});t("focusout-prevented",e),e.defaultPrevented||ew(i,!0)}}),0)}else{const e=r.target;e&&s.contains(e)||t("focusout",r)}};async function p(){await en();const t=Dt(n);if(t){nw.push(o);const n=t.contains(document.activeElement)?r:document.activeElement;r=n;if(!t.contains(n)){const r=new Event(Fx,Gx);t.addEventListener(Fx,u),t.dispatchEvent(r),r.defaultPrevented||en((()=>{let r=e.focusStartEl;D(r)||(ew(r),document.activeElement!==r&&(r="first")),"first"===r&&((e,t=!1)=>{const n=document.activeElement;for(const r of e)if(ew(r,t),document.activeElement!==n)return})(Zx(t),!0),document.activeElement!==n&&"container"!==r||ew(t)}))}}}function f(){const e=Dt(n);if(e){e.removeEventListener(Fx,u);const t=new CustomEvent(Vx,{...Gx,detail:{focusReason:a.value}});e.addEventListener(Vx,c),e.dispatchEvent(t),t.defaultPrevented||"keyboard"!=a.value&&Xx.value>qx.value&&!e.contains(document.activeElement)||ew(null!=r?r:document.body),e.removeEventListener(Vx,u),nw.remove(o)}}return Kn((()=>{e.trapped&&p(),Mn((()=>e.trapped),(e=>{e?p():f()}))})),Qn((()=>{e.trapped&&f()})),{onKeydown:l}}});var ow=J_(sw,[["render",function(e,t,n,r,i,a){return vr(e.$slots,"default",{handleKeydown:e.onKeydown})}],["__file","/home/runner/work/element-plus/element-plus/packages/components/focus-trap/src/focus-trap.vue"]]);const lw=pg({boundariesPadding:{type:Number,default:0},fallbackPlacements:{type:Array,default:void 0},gpuAcceleration:{type:Boolean,default:!0},offset:{type:Number,default:12},placement:{type:String,values:wv,default:"bottom"},popperOptions:{type:Object,default:()=>({})},strategy:{type:String,values:["fixed","absolute"],default:"absolute"}}),uw=pg({...lw,id:String,style:{type:[String,Array,Object]},className:{type:[String,Array,Object]},effect:{type:String,default:"dark"},visible:Boolean,enterable:{type:Boolean,default:!0},pure:Boolean,focusOnShow:{type:Boolean,default:!1},trapping:{type:Boolean,default:!1},popperClass:{type:[String,Array,Object]},popperStyle:{type:[String,Array,Object]},referenceEl:{type:Object},triggerTargetEl:{type:Object},stopPopperMouseEvent:{type:Boolean,default:!0},ariaLabel:{type:String,default:void 0},virtualTriggering:Boolean,zIndex:Number}),cw={mouseenter:e=>e instanceof MouseEvent,mouseleave:e=>e instanceof MouseEvent,focus:()=>!0,blur:()=>!0,close:()=>!0},dw=(e,t=[])=>{const{placement:n,strategy:r,popperOptions:i}=e,a={placement:n,strategy:r,...i,modifiers:[...hw(e),...t]};return function(e,t){t&&(e.modifiers=[...e.modifiers,...null!=t?t:[]])}(a,null==i?void 0:i.modifiers),a};function hw(e){const{offset:t,gpuAcceleration:n,fallbackPlacements:r}=e;return[{name:"offset",options:{offset:[0,null!=t?t:12]}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5,fallbackPlacements:r}},{name:"computeStyles",options:{gpuAcceleration:n}}]}const pw=e=>{const{popperInstanceRef:t,contentRef:n,triggerRef:r,role:i}=Sn(Mx,void 0),a=At(),s=At(),o=Ki((()=>({name:"eventListeners",enabled:!!e.visible}))),l=Ki((()=>{var e;const t=Dt(a),n=null!=(e=Dt(s))?e:0;return{name:"arrow",enabled:(r=t,!(void 0===r)),options:{element:t,padding:n}};var r})),u=Ki((()=>({onFirstUpdate:()=>{f()},...dw(e,[Dt(l),Dt(o)])}))),c=Ki((()=>(e=>{if(Os)return Xs(e)})(e.referenceEl)||Dt(r))),{attributes:d,state:h,styles:p,update:f,forceUpdate:m,instanceRef:g}=Ay(c,n,u);return Mn(g,(e=>t.value=e)),Kn((()=>{Mn((()=>{var e;return null==(e=Dt(c))?void 0:e.getBoundingClientRect()}),(()=>{f()}))})),{attributes:d,arrowRef:a,contentRef:n,instanceRef:g,state:h,styles:p,role:i,forceUpdate:m,update:f}},fw=Fn({name:"ElPopperContent"}),mw=Fn({...fw,props:uw,emits:cw,setup(e,{expose:t,emit:n}){const r=e,{focusStartRef:i,trapped:a,onFocusAfterReleased:s,onFocusAfterTrapped:o,onFocusInTrap:l,onFocusoutPrevented:u,onReleaseRequested:c}=((e,t)=>{const n=At(!1),r=At();return{focusStartRef:r,trapped:n,onFocusAfterReleased:e=>{var n;"pointer"!==(null==(n=e.detail)?void 0:n.focusReason)&&(r.value="first",t("blur"))},onFocusAfterTrapped:()=>{t("focus")},onFocusInTrap:t=>{e.visible&&!n.value&&(t.target&&(r.value=t.target),n.value=!0)},onFocusoutPrevented:t=>{e.trapping||("pointer"===t.detail.focusReason&&t.preventDefault(),n.value=!1)},onReleaseRequested:()=>{n.value=!1,t("close")}}})(r,n),{attributes:d,arrowRef:h,contentRef:p,styles:f,instanceRef:m,role:g,update:v}=pw(r),{ariaModal:_,arrowStyle:b,contentAttrs:x,contentClass:w,contentStyle:S,updateZIndex:C}=((e,{attributes:t,styles:n,role:r})=>{const{nextZIndex:i}=Yy(),a=rv("popper"),s=Ki((()=>Dt(t).popper)),o=At(e.zIndex||i()),l=Ki((()=>[a.b(),a.is("pure",e.pure),a.is(e.effect),e.popperClass])),u=Ki((()=>[{zIndex:Dt(o)},e.popperStyle||{},Dt(n).popper]));return{ariaModal:Ki((()=>"dialog"===r.value?"false":void 0)),arrowStyle:Ki((()=>Dt(n).arrow||{})),contentAttrs:s,contentClass:l,contentStyle:u,contentZIndex:o,updateZIndex:()=>{o.value=e.zIndex||i()}}})(r,{styles:f,attributes:d,role:g}),T=Sn(cb,void 0),M=At();let E;wn(Ex,{arrowStyle:b,arrowRef:h,arrowOffset:M}),T&&(T.addInputId||T.removeInputId)&&wn(cb,{...T,addInputId:y,removeInputId:y});const A=(e=!0)=>{v(),e&&C()},P=()=>{A(!1),r.visible&&r.focusOnShow?a.value=!0:!1===r.visible&&(a.value=!1)};return Kn((()=>{Mn((()=>r.triggerTargetEl),((e,t)=>{null==E||E(),E=void 0;const n=Dt(e||p.value),i=Dt(t||p.value);zh(n)&&(E=Mn([g,()=>r.ariaLabel,_,()=>r.id],(e=>{["role","aria-label","aria-modal","id"].forEach(((t,r)=>{Ah(e[r])?n.removeAttribute(t):n.setAttribute(t,e[r])}))}),{immediate:!0})),i!==n&&zh(i)&&["role","aria-label","aria-modal","id"].forEach((e=>{i.removeAttribute(e)}))}),{immediate:!0}),Mn((()=>r.visible),P,{immediate:!0})})),Qn((()=>{null==E||E(),E=void 0})),t({popperContentRef:p,popperInstanceRef:m,updatePopper:A,contentStyle:S}),(e,t)=>(fi(),yi("div",Oi({ref_key:"contentRef",ref:p},Dt(x),{style:Dt(S),class:Dt(w),tabindex:"-1",onMouseenter:t[0]||(t[0]=t=>e.$emit("mouseenter",t)),onMouseleave:t[1]||(t[1]=t=>e.$emit("mouseleave",t))}),[Mi(Dt(ow),{trapped:Dt(a),"trap-on-focus-in":!0,"focus-trap-el":Dt(p),"focus-start-el":Dt(i),onFocusAfterTrapped:Dt(o),onFocusAfterReleased:Dt(s),onFocusin:Dt(l),onFocusoutPrevented:Dt(u),onReleaseRequested:Dt(c)},{default:vn((()=>[vr(e.$slots,"default")])),_:3},8,["trapped","focus-trap-el","focus-start-el","onFocusAfterTrapped","onFocusAfterReleased","onFocusin","onFocusoutPrevented","onReleaseRequested"])],16))}});var gw=J_(mw,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/content.vue"]]);const vw=_g(Rx),yw=Symbol("elTooltip"),_w=pg({...Fy,...uw,appendTo:{type:[String,Object]},content:{type:String,default:""},rawContent:{type:Boolean,default:!1},persistent:Boolean,ariaLabel:String,visible:{type:Boolean,default:null},transition:String,teleported:{type:Boolean,default:!0},disabled:Boolean}),bw=pg({...Bx,disabled:Boolean,trigger:{type:[String,Array],default:"hover"},triggerKeys:{type:Array,default:()=>[Sg.enter,Sg.space]}}),{useModelToggleProps:xw,useModelToggleEmits:ww,useModelToggle:Sw}=ov("visible"),Cw=pg({...Ax,...xw,..._w,...bw,...Lx,showArrow:{type:Boolean,default:!0}}),Tw=[...ww,"before-show","before-hide","show","hide","open","close"],Mw=(e,t,n)=>r=>{((e,t)=>E(e)?e.includes(t):e===t)(Dt(e),t)&&n(r)},Ew=Fn({name:"ElTooltipTrigger"}),Aw=Fn({...Ew,props:bw,setup(e,{expose:t}){const n=e,r=rv("tooltip"),{controlled:i,id:a,open:s,onOpen:o,onClose:u,onToggle:c}=Sn(yw,void 0),d=At(null),h=()=>{if(Dt(i)||n.disabled)return!0},p=Ut(n,"trigger"),f=Cs(h,Mw(p,"hover",o)),m=Cs(h,Mw(p,"hover",u)),g=Cs(h,Mw(p,"click",(e=>{0===e.button&&c(e)}))),v=Cs(h,Mw(p,"focus",o)),y=Cs(h,Mw(p,"focus",u)),_=Cs(h,Mw(p,"contextmenu",(e=>{e.preventDefault(),c(e)}))),b=Cs(h,(e=>{const{code:t}=e;n.triggerKeys.includes(t)&&(e.preventDefault(),c(e))}));return t({triggerRef:d}),(e,t)=>(fi(),_i(Dt(zx),{id:Dt(a),"virtual-ref":e.virtualRef,open:Dt(s),"virtual-triggering":e.virtualTriggering,class:l(Dt(r).e("trigger")),onBlur:Dt(y),onClick:Dt(g),onContextmenu:Dt(_),onFocus:Dt(v),onMouseenter:Dt(f),onMouseleave:Dt(m),onKeydown:Dt(b)},{default:vn((()=>[vr(e.$slots,"default")])),_:3},8,["id","virtual-ref","open","virtual-triggering","class","onBlur","onClick","onContextmenu","onFocus","onMouseenter","onMouseleave","onKeydown"]))}});var Pw=J_(Aw,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip/src/trigger.vue"]]);const Rw=Fn({name:"ElTooltipContent",inheritAttrs:!1});var Lw=J_(Fn({...Rw,props:_w,setup(e,{expose:t}){const n=e,{selector:r}=Uy(),i=rv("tooltip"),a=At(null),s=At(!1),{controlled:o,id:l,open:u,trigger:c,onClose:d,onOpen:h,onShow:p,onHide:f,onBeforeShow:m,onBeforeHide:g}=Sn(yw,void 0),v=Ki((()=>n.transition||`${i.namespace.value}-fade-in-linear`)),y=Ki((()=>n.persistent));Qn((()=>{s.value=!0}));const _=Ki((()=>!!Dt(y)||Dt(u))),b=Ki((()=>!n.disabled&&Dt(u))),x=Ki((()=>n.appendTo||r.value)),w=Ki((()=>{var e;return null!=(e=n.style)?e:{}})),S=Ki((()=>!Dt(u))),C=()=>{f()},T=()=>{if(Dt(o))return!0},M=Cs(T,(()=>{n.enterable&&"hover"===Dt(c)&&h()})),E=Cs(T,(()=>{"hover"===Dt(c)&&d()})),A=()=>{var e,t;null==(t=null==(e=a.value)?void 0:e.updatePopper)||t.call(e),null==m||m()},P=()=>{null==g||g()},R=()=>{p(),k=Qs(Ki((()=>{var e;return null==(e=a.value)?void 0:e.popperContentRef})),(()=>{if(Dt(o))return;"hover"!==Dt(c)&&d()}))},L=()=>{n.virtualTriggering||d()};let k;return Mn((()=>Dt(u)),(e=>{e||null==k||k()}),{flush:"post"}),Mn((()=>n.content),(()=>{var e,t;null==(t=null==(e=a.value)?void 0:e.updatePopper)||t.call(e)})),t({contentRef:a}),(e,t)=>(fi(),_i(si,{disabled:!e.teleported,to:Dt(x)},[Mi(xa,{name:Dt(v),onAfterLeave:C,onBeforeEnter:A,onAfterEnter:R,onBeforeLeave:P},{default:vn((()=>[Dt(_)?ar((fi(),_i(Dt(gw),Oi({key:0,id:Dt(l),ref_key:"contentRef",ref:a},e.$attrs,{"aria-label":e.ariaLabel,"aria-hidden":Dt(S),"boundaries-padding":e.boundariesPadding,"fallback-placements":e.fallbackPlacements,"gpu-acceleration":e.gpuAcceleration,offset:e.offset,placement:e.placement,"popper-options":e.popperOptions,strategy:e.strategy,effect:e.effect,enterable:e.enterable,pure:e.pure,"popper-class":e.popperClass,"popper-style":[e.popperStyle,Dt(w)],"reference-el":e.referenceEl,"trigger-target-el":e.triggerTargetEl,visible:Dt(b),"z-index":e.zIndex,onMouseenter:Dt(M),onMouseleave:Dt(E),onBlur:L,onClose:Dt(d)}),{default:vn((()=>[s.value?Li("v-if",!0):vr(e.$slots,"default",{key:0})])),_:3},16,["id","aria-label","aria-hidden","boundaries-padding","fallback-placements","gpu-acceleration","offset","placement","popper-options","strategy","effect","enterable","pure","popper-class","popper-style","reference-el","trigger-target-el","visible","z-index","onMouseenter","onMouseleave","onClose"])),[[is,Dt(b)]]):Li("v-if",!0)])),_:3},8,["name"])],8,["disabled","to"]))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip/src/content.vue"]]);const kw=["innerHTML"],Dw={key:1},Iw=Fn({name:"ElTooltip"});const Ow=_g(J_(Fn({...Iw,props:Cw,emits:Tw,setup(e,{expose:t,emit:n}){const r=e;zy();const i=Iy(),a=At(),s=At(),o=()=>{var e;const t=Dt(a);t&&(null==(e=t.popperInstanceRef)||e.update())},l=At(!1),u=At(),{show:c,hide:d,hasUpdateHandler:h}=Sw({indicator:l,toggleReason:u}),{onOpen:p,onClose:m}=Vy({showAfter:Ut(r,"showAfter"),hideAfter:Ut(r,"hideAfter"),autoClose:Ut(r,"autoClose"),open:c,close:d}),g=Ki((()=>Ns(r.visible)&&!h.value));wn(yw,{controlled:g,id:i,open:mt(l),trigger:Ut(r,"trigger"),onOpen:e=>{p(e)},onClose:e=>{m(e)},onToggle:e=>{Dt(l)?m(e):p(e)},onShow:()=>{n("show",u.value)},onHide:()=>{n("hide",u.value)},onBeforeShow:()=>{n("before-show",u.value)},onBeforeHide:()=>{n("before-hide",u.value)},updatePopper:o}),Mn((()=>r.disabled),(e=>{e&&l.value&&(l.value=!1)}));return jn((()=>l.value&&d())),t({popperRef:a,contentRef:s,isFocusInsideContent:()=>{var e,t;const n=null==(t=null==(e=s.value)?void 0:e.contentRef)?void 0:t.popperContentRef;return n&&n.contains(document.activeElement)},updatePopper:o,onOpen:p,onClose:m,hide:d}),(e,t)=>(fi(),_i(Dt(vw),{ref_key:"popperRef",ref:a,role:e.role},{default:vn((()=>[Mi(Pw,{disabled:e.disabled,trigger:e.trigger,"trigger-keys":e.triggerKeys,"virtual-ref":e.virtualRef,"virtual-triggering":e.virtualTriggering},{default:vn((()=>[e.$slots.default?vr(e.$slots,"default",{key:0}):Li("v-if",!0)])),_:3},8,["disabled","trigger","trigger-keys","virtual-ref","virtual-triggering"]),Mi(Lw,{ref_key:"contentRef",ref:s,"aria-label":e.ariaLabel,"boundaries-padding":e.boundariesPadding,content:e.content,disabled:e.disabled,effect:e.effect,enterable:e.enterable,"fallback-placements":e.fallbackPlacements,"hide-after":e.hideAfter,"gpu-acceleration":e.gpuAcceleration,offset:e.offset,persistent:e.persistent,"popper-class":e.popperClass,"popper-style":e.popperStyle,placement:e.placement,"popper-options":e.popperOptions,pure:e.pure,"raw-content":e.rawContent,"reference-el":e.referenceEl,"trigger-target-el":e.triggerTargetEl,"show-after":e.showAfter,strategy:e.strategy,teleported:e.teleported,transition:e.transition,"virtual-triggering":e.virtualTriggering,"z-index":e.zIndex,"append-to":e.appendTo},{default:vn((()=>[vr(e.$slots,"content",{},(()=>[e.rawContent?(fi(),yi("span",{key:0,innerHTML:e.content},null,8,kw)):(fi(),yi("span",Dw,f(e.content),1))])),e.showArrow?(fi(),_i(Dt(Dx),{key:0,"arrow-offset":e.arrowOffset},null,8,["arrow-offset"])):Li("v-if",!0)])),_:3},8,["aria-label","boundaries-padding","content","disabled","effect","enterable","fallback-placements","hide-after","gpu-acceleration","offset","persistent","popper-class","popper-style","placement","popper-options","pure","raw-content","reference-el","trigger-target-el","show-after","strategy","teleported","transition","virtual-triggering","z-index","append-to"])])),_:3},8,["role"]))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip/src/tooltip.vue"]])),Nw=pg({valueKey:{type:String,default:"value"},modelValue:{type:[String,Number],default:""},debounce:{type:Number,default:300},placement:{type:String,values:["top","top-start","top-end","bottom","bottom-start","bottom-end"],default:"bottom-start"},fetchSuggestions:{type:[Function,Array],default:y},popperClass:{type:String,default:""},triggerOnFocus:{type:Boolean,default:!0},selectWhenUnmatched:{type:Boolean,default:!1},hideLoading:{type:Boolean,default:!1},label:{type:String},teleported:_w.teleported,highlightFirstItem:{type:Boolean,default:!1},fitInputWidth:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},name:String}),Bw={[Tg]:e=>D(e),[Eg]:e=>D(e),[Mg]:e=>D(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0,select:e=>O(e)},Uw=["aria-expanded","aria-owns"],zw={key:0},Fw=["id","aria-selected","onClick"],Vw="ElAutocomplete",Gw=Fn({name:Vw,inheritAttrs:!1});const Hw=_g(J_(Fn({...Gw,props:Nw,emits:Bw,setup(e,{expose:t,emit:n}){const i=e,a=Wg(),s=Ji(),o=hb(),u=rv("autocomplete"),c=At(),d=At(),h=At(),p=At();let m=!1,g=!1;const v=At([]),y=At(-1),_=At(""),b=At(!1),x=At(!1),w=At(!1),S=Ki((()=>u.b(String(Gg())))),C=Ki((()=>s.style)),T=Ki((()=>(v.value.length>0||w.value)&&b.value)),M=Ki((()=>!i.hideLoading&&w.value)),A=Ki((()=>c.value?Array.from(c.value.$el.querySelectorAll("input")):[])),P=async()=>{await en(),T.value&&(_.value=`${c.value.$el.offsetWidth}px`)},R=()=>{y.value=-1},L=gh((async e=>{if(x.value)return;const t=e=>{w.value=!1,x.value||(E(e)?(v.value=e,y.value=i.highlightFirstItem?0:-1):Wh(Vw,"autocomplete suggestions must be an array"))};if(w.value=!0,E(i.fetchSuggestions))t(i.fetchSuggestions);else{const n=await i.fetchSuggestions(e,t);E(n)&&t(n)}}),i.debounce),k=e=>{const t=!!e;if(n(Eg,e),n(Tg,e),x.value=!1,b.value||(b.value=t),!i.triggerOnFocus&&!e)return x.value=!0,void(v.value=[]);L(e)},D=e=>{var t;o.value||("INPUT"!==(null==(t=e.target)?void 0:t.tagName)||A.value.includes(document.activeElement))&&(b.value=!0)},I=e=>{n(Mg,e)},O=e=>{g?g=!1:(b.value=!0,n("focus",e),i.triggerOnFocus&&!m&&L(String(i.modelValue)))},N=e=>{setTimeout((()=>{var t;(null==(t=h.value)?void 0:t.isFocusInsideContent())?g=!0:(b.value&&F(),n("blur",e))}))},B=()=>{b.value=!1,n(Tg,""),n("clear")},U=async()=>{T.value&&y.value>=0&&y.value<v.value.length?V(v.value[y.value]):i.selectWhenUnmatched&&(n("select",{value:i.modelValue}),v.value=[],y.value=-1)},z=e=>{T.value&&(e.preventDefault(),e.stopPropagation(),F())},F=()=>{b.value=!1},V=async e=>{n(Eg,e[i.valueKey]),n(Tg,e[i.valueKey]),n("select",e),v.value=[],y.value=-1},G=e=>{if(!T.value||w.value)return;if(e<0)return void(y.value=-1);e>=v.value.length&&(e=v.value.length-1);const t=d.value.querySelector(`.${u.be("suggestion","wrap")}`),n=t.querySelectorAll(`.${u.be("suggestion","list")} li`)[e],r=t.scrollTop,{offsetTop:i,scrollHeight:a}=n;i+a>r+t.clientHeight&&(t.scrollTop+=a),i<r&&(t.scrollTop-=a),y.value=e,c.value.ref.setAttribute("aria-activedescendant",`${S.value}-item-${y.value}`)};return Qs(p,(()=>{T.value&&F()})),Kn((()=>{c.value.ref.setAttribute("role","textbox"),c.value.ref.setAttribute("aria-autocomplete","list"),c.value.ref.setAttribute("aria-controls","id"),c.value.ref.setAttribute("aria-activedescendant",`${S.value}-item-${y.value}`),m=c.value.ref.hasAttribute("readonly")})),t({highlightedIndex:y,activated:b,loading:w,inputRef:c,popperRef:h,suggestions:v,handleSelect:V,handleKeyEnter:U,focus:()=>{var e;null==(e=c.value)||e.focus()},blur:()=>{var e;null==(e=c.value)||e.blur()},close:F,highlight:G}),(e,t)=>(fi(),_i(Dt(Ow),{ref_key:"popperRef",ref:h,visible:Dt(T),placement:e.placement,"fallback-placements":["bottom-start","top-start"],"popper-class":[Dt(u).e("popper"),e.popperClass],teleported:e.teleported,"gpu-acceleration":!1,pure:"","manual-mode":"",effect:"light",trigger:"click",transition:`${Dt(u).namespace.value}-zoom-in-top`,persistent:"",onBeforeShow:P,onHide:R},{content:vn((()=>[Ti("div",{ref_key:"regionRef",ref:d,class:l([Dt(u).b("suggestion"),Dt(u).is("loading",Dt(M))]),style:r({[e.fitInputWidth?"width":"minWidth"]:_.value,outline:"none"}),role:"region"},[Mi(Dt(Tx),{id:Dt(S),tag:"ul","wrap-class":Dt(u).be("suggestion","wrap"),"view-class":Dt(u).be("suggestion","list"),role:"listbox"},{default:vn((()=>[Dt(M)?(fi(),yi("li",zw,[Mi(Dt(ib),{class:l(Dt(u).is("loading"))},{default:vn((()=>[Mi(Dt(Gf))])),_:1},8,["class"])])):(fi(!0),yi(li,{key:1},mr(v.value,((t,n)=>(fi(),yi("li",{id:`${Dt(S)}-item-${n}`,key:n,class:l({highlighted:y.value===n}),role:"option","aria-selected":y.value===n,onClick:e=>V(t)},[vr(e.$slots,"default",{item:t},(()=>[Pi(f(t[e.valueKey]),1)]))],10,Fw)))),128))])),_:3},8,["id","wrap-class","view-class"])],6)])),default:vn((()=>[Ti("div",{ref_key:"listboxRef",ref:p,class:l([Dt(u).b(),e.$attrs.class]),style:r(Dt(C)),role:"combobox","aria-haspopup":"listbox","aria-expanded":Dt(T),"aria-owns":Dt(S)},[Mi(Dt(mx),Oi({ref_key:"inputRef",ref:c},Dt(a),{clearable:e.clearable,disabled:Dt(o),name:e.name,"model-value":e.modelValue,onInput:k,onChange:I,onFocus:O,onBlur:N,onClear:B,onKeydown:[t[0]||(t[0]=rs(ts((e=>G(y.value-1)),["prevent"]),["up"])),t[1]||(t[1]=rs(ts((e=>G(y.value+1)),["prevent"]),["down"])),rs(U,["enter"]),rs(F,["tab"]),rs(z,["esc"])],onMousedown:D}),gr({_:2},[e.$slots.prepend?{name:"prepend",fn:vn((()=>[vr(e.$slots,"prepend")]))}:void 0,e.$slots.append?{name:"append",fn:vn((()=>[vr(e.$slots,"append")]))}:void 0,e.$slots.prefix?{name:"prefix",fn:vn((()=>[vr(e.$slots,"prefix")]))}:void 0,e.$slots.suffix?{name:"suffix",fn:vn((()=>[vr(e.$slots,"suffix")]))}:void 0]),1040,["clearable","disabled","name","model-value","onKeydown"])],14,Uw)])),_:3},8,["visible","placement","popper-class","teleported","transition"]))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/autocomplete/src/autocomplete.vue"]])),jw=pg({size:{type:[Number,String],values:Pg,default:"",validator:e=>Bs(e)},shape:{type:String,values:["circle","square"],default:"circle"},icon:{type:fg},src:{type:String,default:""},alt:String,srcSet:String,fit:{type:String,default:"cover"}}),Ww={error:e=>e instanceof Event},Yw=["src","alt","srcset"],$w=Fn({name:"ElAvatar"}),Xw=Fn({...$w,props:jw,emits:Ww,setup(e,{emit:t}){const n=e,i=rv("avatar"),a=At(!1),s=Ki((()=>{const{size:e,icon:t,shape:r}=n,a=[i.b()];return D(e)&&a.push(i.m(e)),t&&a.push(i.m("icon")),r&&a.push(i.m(r)),a})),o=Ki((()=>{const{size:e}=n;return Bs(e)?i.cssVarBlock({size:Zh(e)||""}):void 0})),u=Ki((()=>({objectFit:n.fit})));function c(e){a.value=!0,t("error",e)}return Mn((()=>n.src),(()=>a.value=!1)),(e,t)=>(fi(),yi("span",{class:l(Dt(s)),style:r(Dt(o))},[!e.src&&!e.srcSet||a.value?e.icon?(fi(),_i(Dt(ib),{key:1},{default:vn((()=>[(fi(),_i(dr(e.icon)))])),_:1})):vr(e.$slots,"default",{key:2}):(fi(),yi("img",{key:0,src:e.src,alt:e.alt,srcset:e.srcSet,style:r(Dt(u)),onError:c},null,44,Yw))],6))}});const qw=_g(J_(Xw,[["__file","/home/runner/work/element-plus/element-plus/packages/components/avatar/src/avatar.vue"]])),Kw={visibilityHeight:{type:Number,default:200},target:{type:String,default:""},right:{type:Number,default:40},bottom:{type:Number,default:40}},Zw={click:e=>e instanceof MouseEvent},Jw="ElBacktop",Qw=Fn({name:Jw});const eS=_g(J_(Fn({...Qw,props:Kw,emits:Zw,setup(e,{emit:t}){const n=e,i=rv("backtop"),{handleClick:a,visible:s}=((e,t,n)=>{const r=Pt(),i=Pt(),a=At(!1),s=Ws((()=>{r.value&&(a.value=r.value.scrollTop>=e.visibilityHeight)}),300,!0);return Zs(i,"scroll",s),Kn((()=>{var t;i.value=document,r.value=document.documentElement,e.target&&(r.value=null!=(t=document.querySelector(e.target))?t:void 0,r.value||Wh(n,`target does not exist: ${e.target}`),i.value=r.value)})),{visible:a,handleClick:e=>{var n;null==(n=r.value)||n.scrollTo({top:0,behavior:"smooth"}),t("click",e)}}})(n,t,Jw),o=Ki((()=>({right:`${n.right}px`,bottom:`${n.bottom}px`})));return(e,t)=>(fi(),_i(xa,{name:`${Dt(i).namespace.value}-fade-in`},{default:vn((()=>[Dt(s)?(fi(),yi("div",{key:0,style:r(Dt(o)),class:l(Dt(i).b()),onClick:t[0]||(t[0]=ts(((...e)=>Dt(a)&&Dt(a)(...e)),["stop"]))},[vr(e.$slots,"default",{},(()=>[Mi(Dt(ib),{class:l(Dt(i).e("icon"))},{default:vn((()=>[Mi(Dt(Op))])),_:1},8,["class"])]))],6)):Li("v-if",!0)])),_:3},8,["name"]))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/backtop/src/backtop.vue"]])),tS=pg({value:{type:[String,Number],default:""},max:{type:Number,default:99},isDot:Boolean,hidden:Boolean,type:{type:String,values:["primary","success","warning","info","danger"],default:"danger"}}),nS=["textContent"],rS=Fn({name:"ElBadge"});const iS=_g(J_(Fn({...rS,props:tS,setup(e,{expose:t}){const n=e,r=rv("badge"),i=Ki((()=>n.isDot?"":Bs(n.value)&&Bs(n.max)&&n.max<n.value?`${n.max}+`:`${n.value}`));return t({content:i}),(e,t)=>(fi(),yi("div",{class:l(Dt(r).b())},[vr(e.$slots,"default"),Mi(xa,{name:`${Dt(r).namespace.value}-zoom-in-center`,persisted:""},{default:vn((()=>[ar(Ti("sup",{class:l([Dt(r).e("content"),Dt(r).em("content",e.type),Dt(r).is("fixed",!!e.$slots.default),Dt(r).is("dot",e.isDot)]),textContent:f(Dt(i))},null,10,nS),[[is,!e.hidden&&(Dt(i)||e.isDot)]])])),_:1},8,["name"])],2))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/badge/src/badge.vue"]])),aS=Symbol("breadcrumbKey"),sS=pg({separator:{type:String,default:"/"},separatorIcon:{type:fg}}),oS=Fn({name:"ElBreadcrumb"});var lS=J_(Fn({...oS,props:sS,setup(e){const t=e,n=rv("breadcrumb"),r=At();return wn(aS,t),Kn((()=>{const e=r.value.querySelectorAll(`.${n.e("item")}`);e.length&&e[e.length-1].setAttribute("aria-current","page")})),(e,t)=>(fi(),yi("div",{ref_key:"breadcrumb",ref:r,class:l(Dt(n).b()),"aria-label":"Breadcrumb",role:"navigation"},[vr(e.$slots,"default")],2))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/breadcrumb/src/breadcrumb.vue"]]);const uS=pg({to:{type:[String,Object],default:""},replace:{type:Boolean,default:!1}}),cS=Fn({name:"ElBreadcrumbItem"});var dS=J_(Fn({...cS,props:uS,setup(e){const t=e,n=Fi(),r=Sn(aS,void 0),i=rv("breadcrumb"),{separator:a,separatorIcon:s}=Nt(r),o=n.appContext.config.globalProperties.$router,u=At(),c=()=>{t.to&&o&&(t.replace?o.replace(t.to):o.push(t.to))};return(e,t)=>(fi(),yi("span",{class:l(Dt(i).e("item"))},[Ti("span",{ref_key:"link",ref:u,class:l([Dt(i).e("inner"),Dt(i).is("link",!!e.to)]),role:"link",onClick:c},[vr(e.$slots,"default")],2),Dt(s)?(fi(),_i(Dt(ib),{key:0,class:l(Dt(i).e("separator"))},{default:vn((()=>[(fi(),_i(dr(Dt(s))))])),_:1},8,["class"])):(fi(),yi("span",{key:1,class:l(Dt(i).e("separator")),role:"presentation"},f(Dt(a)),3))],2))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/breadcrumb/src/breadcrumb-item.vue"]]);const hS=_g(lS,{BreadcrumbItem:dS}),pS=xg(dS),fS=Symbol("buttonGroupContextKey"),mS=["default","primary","success","warning","info","danger","text",""],gS=pg({size:z_,disabled:Boolean,type:{type:String,values:mS,default:""},icon:{type:fg},nativeType:{type:String,values:["button","submit","reset"],default:"button"},loading:Boolean,loadingIcon:{type:fg,default:()=>Gf},plain:Boolean,text:Boolean,link:Boolean,bg:Boolean,autofocus:Boolean,round:Boolean,circle:Boolean,color:String,dark:Boolean,autoInsertSpace:{type:Boolean,default:void 0}}),vS={click:e=>e instanceof MouseEvent};function yS(e,t){(function(e){return"string"==typeof e&&-1!==e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var n=function(e){return"string"==typeof e&&-1!==e.indexOf("%")}(e);return e=360===t?e:Math.min(t,Math.max(0,parseFloat(e))),n&&(e=parseInt(String(e*t),10)/100),Math.abs(e-t)<1e-6?1:e=360===t?(e<0?e%t+t:e%t)/parseFloat(String(t)):e%t/parseFloat(String(t))}function _S(e){return Math.min(1,Math.max(0,e))}function bS(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function xS(e){return e<=1?"".concat(100*Number(e),"%"):e}function wS(e){return 1===e.length?"0"+e:String(e)}function SS(e,t,n){e=yS(e,255),t=yS(t,255),n=yS(n,255);var r=Math.max(e,t,n),i=Math.min(e,t,n),a=0,s=0,o=(r+i)/2;if(r===i)s=0,a=0;else{var l=r-i;switch(s=o>.5?l/(2-r-i):l/(r+i),r){case e:a=(t-n)/l+(t<n?6:0);break;case t:a=(n-e)/l+2;break;case n:a=(e-t)/l+4}a/=6}return{h:a,s:s,l:o}}function CS(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*n*(t-e):n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function TS(e,t,n){e=yS(e,255),t=yS(t,255),n=yS(n,255);var r=Math.max(e,t,n),i=Math.min(e,t,n),a=0,s=r,o=r-i,l=0===r?0:o/r;if(r===i)a=0;else{switch(r){case e:a=(t-n)/o+(t<n?6:0);break;case t:a=(n-e)/o+2;break;case n:a=(e-t)/o+4}a/=6}return{h:a,s:l,v:s}}function MS(e,t,n,r){var i=[wS(Math.round(e).toString(16)),wS(Math.round(t).toString(16)),wS(Math.round(n).toString(16))];return r&&i[0].startsWith(i[0].charAt(1))&&i[1].startsWith(i[1].charAt(1))&&i[2].startsWith(i[2].charAt(1))?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function ES(e){return AS(e)/255}function AS(e){return parseInt(e,16)}var PS={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function RS(e){var t,n,r,i={r:0,g:0,b:0},a=1,s=null,o=null,l=null,u=!1,c=!1;return"string"==typeof e&&(e=function(e){if(e=e.trim().toLowerCase(),0===e.length)return!1;var t=!1;if(PS[e])e=PS[e],t=!0;else if("transparent"===e)return{r:0,g:0,b:0,a:0,format:"name"};var n=IS.rgb.exec(e);if(n)return{r:n[1],g:n[2],b:n[3]};if(n=IS.rgba.exec(e),n)return{r:n[1],g:n[2],b:n[3],a:n[4]};if(n=IS.hsl.exec(e),n)return{h:n[1],s:n[2],l:n[3]};if(n=IS.hsla.exec(e),n)return{h:n[1],s:n[2],l:n[3],a:n[4]};if(n=IS.hsv.exec(e),n)return{h:n[1],s:n[2],v:n[3]};if(n=IS.hsva.exec(e),n)return{h:n[1],s:n[2],v:n[3],a:n[4]};if(n=IS.hex8.exec(e),n)return{r:AS(n[1]),g:AS(n[2]),b:AS(n[3]),a:ES(n[4]),format:t?"name":"hex8"};if(n=IS.hex6.exec(e),n)return{r:AS(n[1]),g:AS(n[2]),b:AS(n[3]),format:t?"name":"hex"};if(n=IS.hex4.exec(e),n)return{r:AS(n[1]+n[1]),g:AS(n[2]+n[2]),b:AS(n[3]+n[3]),a:ES(n[4]+n[4]),format:t?"name":"hex8"};if(n=IS.hex3.exec(e),n)return{r:AS(n[1]+n[1]),g:AS(n[2]+n[2]),b:AS(n[3]+n[3]),format:t?"name":"hex"};return!1}(e)),"object"==typeof e&&(OS(e.r)&&OS(e.g)&&OS(e.b)?(t=e.r,n=e.g,r=e.b,i={r:255*yS(t,255),g:255*yS(n,255),b:255*yS(r,255)},u=!0,c="%"===String(e.r).substr(-1)?"prgb":"rgb"):OS(e.h)&&OS(e.s)&&OS(e.v)?(s=xS(e.s),o=xS(e.v),i=function(e,t,n){e=6*yS(e,360),t=yS(t,100),n=yS(n,100);var r=Math.floor(e),i=e-r,a=n*(1-t),s=n*(1-i*t),o=n*(1-(1-i)*t),l=r%6;return{r:255*[n,s,a,a,o,n][l],g:255*[o,n,n,s,a,a][l],b:255*[a,a,o,n,n,s][l]}}(e.h,s,o),u=!0,c="hsv"):OS(e.h)&&OS(e.s)&&OS(e.l)&&(s=xS(e.s),l=xS(e.l),i=function(e,t,n){var r,i,a;if(e=yS(e,360),t=yS(t,100),n=yS(n,100),0===t)i=n,a=n,r=n;else{var s=n<.5?n*(1+t):n+t-n*t,o=2*n-s;r=CS(o,s,e+1/3),i=CS(o,s,e),a=CS(o,s,e-1/3)}return{r:255*r,g:255*i,b:255*a}}(e.h,s,l),u=!0,c="hsl"),Object.prototype.hasOwnProperty.call(e,"a")&&(a=e.a)),a=bS(a),{ok:u,format:e.format||c,r:Math.min(255,Math.max(i.r,0)),g:Math.min(255,Math.max(i.g,0)),b:Math.min(255,Math.max(i.b,0)),a:a}}var LS="(?:".concat("[-\\+]?\\d*\\.\\d+%?",")|(?:").concat("[-\\+]?\\d+%?",")"),kS="[\\s|\\(]+(".concat(LS,")[,|\\s]+(").concat(LS,")[,|\\s]+(").concat(LS,")\\s*\\)?"),DS="[\\s|\\(]+(".concat(LS,")[,|\\s]+(").concat(LS,")[,|\\s]+(").concat(LS,")[,|\\s]+(").concat(LS,")\\s*\\)?"),IS={CSS_UNIT:new RegExp(LS),rgb:new RegExp("rgb"+kS),rgba:new RegExp("rgba"+DS),hsl:new RegExp("hsl"+kS),hsla:new RegExp("hsla"+DS),hsv:new RegExp("hsv"+kS),hsva:new RegExp("hsva"+DS),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function OS(e){return Boolean(IS.CSS_UNIT.exec(String(e)))}var NS=function(){function e(t,n){var r;if(void 0===t&&(t=""),void 0===n&&(n={}),t instanceof e)return t;"number"==typeof t&&(t=function(e){return{r:e>>16,g:(65280&e)>>8,b:255&e}}(t)),this.originalInput=t;var i=RS(t);this.originalInput=t,this.r=i.r,this.g=i.g,this.b=i.b,this.a=i.a,this.roundA=Math.round(100*this.a)/100,this.format=null!==(r=n.format)&&void 0!==r?r:i.format,this.gradientType=n.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=i.ok}return e.prototype.isDark=function(){return this.getBrightness()<128},e.prototype.isLight=function(){return!this.isDark()},e.prototype.getBrightness=function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},e.prototype.getLuminance=function(){var e=this.toRgb(),t=e.r/255,n=e.g/255,r=e.b/255;return.2126*(t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.7152*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))+.0722*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))},e.prototype.getAlpha=function(){return this.a},e.prototype.setAlpha=function(e){return this.a=bS(e),this.roundA=Math.round(100*this.a)/100,this},e.prototype.isMonochrome=function(){return 0===this.toHsl().s},e.prototype.toHsv=function(){var e=TS(this.r,this.g,this.b);return{h:360*e.h,s:e.s,v:e.v,a:this.a}},e.prototype.toHsvString=function(){var e=TS(this.r,this.g,this.b),t=Math.round(360*e.h),n=Math.round(100*e.s),r=Math.round(100*e.v);return 1===this.a?"hsv(".concat(t,", ").concat(n,"%, ").concat(r,"%)"):"hsva(".concat(t,", ").concat(n,"%, ").concat(r,"%, ").concat(this.roundA,")")},e.prototype.toHsl=function(){var e=SS(this.r,this.g,this.b);return{h:360*e.h,s:e.s,l:e.l,a:this.a}},e.prototype.toHslString=function(){var e=SS(this.r,this.g,this.b),t=Math.round(360*e.h),n=Math.round(100*e.s),r=Math.round(100*e.l);return 1===this.a?"hsl(".concat(t,", ").concat(n,"%, ").concat(r,"%)"):"hsla(".concat(t,", ").concat(n,"%, ").concat(r,"%, ").concat(this.roundA,")")},e.prototype.toHex=function(e){return void 0===e&&(e=!1),MS(this.r,this.g,this.b,e)},e.prototype.toHexString=function(e){return void 0===e&&(e=!1),"#"+this.toHex(e)},e.prototype.toHex8=function(e){return void 0===e&&(e=!1),function(e,t,n,r,i){var a,s=[wS(Math.round(e).toString(16)),wS(Math.round(t).toString(16)),wS(Math.round(n).toString(16)),wS((a=r,Math.round(255*parseFloat(a)).toString(16)))];return i&&s[0].startsWith(s[0].charAt(1))&&s[1].startsWith(s[1].charAt(1))&&s[2].startsWith(s[2].charAt(1))&&s[3].startsWith(s[3].charAt(1))?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join("")}(this.r,this.g,this.b,this.a,e)},e.prototype.toHex8String=function(e){return void 0===e&&(e=!1),"#"+this.toHex8(e)},e.prototype.toHexShortString=function(e){return void 0===e&&(e=!1),1===this.a?this.toHexString(e):this.toHex8String(e)},e.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},e.prototype.toRgbString=function(){var e=Math.round(this.r),t=Math.round(this.g),n=Math.round(this.b);return 1===this.a?"rgb(".concat(e,", ").concat(t,", ").concat(n,")"):"rgba(".concat(e,", ").concat(t,", ").concat(n,", ").concat(this.roundA,")")},e.prototype.toPercentageRgb=function(){var e=function(e){return"".concat(Math.round(100*yS(e,255)),"%")};return{r:e(this.r),g:e(this.g),b:e(this.b),a:this.a}},e.prototype.toPercentageRgbString=function(){var e=function(e){return Math.round(100*yS(e,255))};return 1===this.a?"rgb(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%)"):"rgba(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%, ").concat(this.roundA,")")},e.prototype.toName=function(){if(0===this.a)return"transparent";if(this.a<1)return!1;for(var e="#"+MS(this.r,this.g,this.b,!1),t=0,n=Object.entries(PS);t<n.length;t++){var r=n[t],i=r[0];if(e===r[1])return i}return!1},e.prototype.toString=function(e){var t=Boolean(e);e=null!=e?e:this.format;var n=!1,r=this.a<1&&this.a>=0;return t||!r||!e.startsWith("hex")&&"name"!==e?("rgb"===e&&(n=this.toRgbString()),"prgb"===e&&(n=this.toPercentageRgbString()),"hex"!==e&&"hex6"!==e||(n=this.toHexString()),"hex3"===e&&(n=this.toHexString(!0)),"hex4"===e&&(n=this.toHex8String(!0)),"hex8"===e&&(n=this.toHex8String()),"name"===e&&(n=this.toName()),"hsl"===e&&(n=this.toHslString()),"hsv"===e&&(n=this.toHsvString()),n||this.toHexString()):"name"===e&&0===this.a?this.toName():this.toRgbString()},e.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},e.prototype.clone=function(){return new e(this.toString())},e.prototype.lighten=function(t){void 0===t&&(t=10);var n=this.toHsl();return n.l+=t/100,n.l=_S(n.l),new e(n)},e.prototype.brighten=function(t){void 0===t&&(t=10);var n=this.toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(-t/100*255))),n.g=Math.max(0,Math.min(255,n.g-Math.round(-t/100*255))),n.b=Math.max(0,Math.min(255,n.b-Math.round(-t/100*255))),new e(n)},e.prototype.darken=function(t){void 0===t&&(t=10);var n=this.toHsl();return n.l-=t/100,n.l=_S(n.l),new e(n)},e.prototype.tint=function(e){return void 0===e&&(e=10),this.mix("white",e)},e.prototype.shade=function(e){return void 0===e&&(e=10),this.mix("black",e)},e.prototype.desaturate=function(t){void 0===t&&(t=10);var n=this.toHsl();return n.s-=t/100,n.s=_S(n.s),new e(n)},e.prototype.saturate=function(t){void 0===t&&(t=10);var n=this.toHsl();return n.s+=t/100,n.s=_S(n.s),new e(n)},e.prototype.greyscale=function(){return this.desaturate(100)},e.prototype.spin=function(t){var n=this.toHsl(),r=(n.h+t)%360;return n.h=r<0?360+r:r,new e(n)},e.prototype.mix=function(t,n){void 0===n&&(n=50);var r=this.toRgb(),i=new e(t).toRgb(),a=n/100;return new e({r:(i.r-r.r)*a+r.r,g:(i.g-r.g)*a+r.g,b:(i.b-r.b)*a+r.b,a:(i.a-r.a)*a+r.a})},e.prototype.analogous=function(t,n){void 0===t&&(t=6),void 0===n&&(n=30);var r=this.toHsl(),i=360/n,a=[this];for(r.h=(r.h-(i*t>>1)+720)%360;--t;)r.h=(r.h+i)%360,a.push(new e(r));return a},e.prototype.complement=function(){var t=this.toHsl();return t.h=(t.h+180)%360,new e(t)},e.prototype.monochromatic=function(t){void 0===t&&(t=6);for(var n=this.toHsv(),r=n.h,i=n.s,a=n.v,s=[],o=1/t;t--;)s.push(new e({h:r,s:i,v:a})),a=(a+o)%1;return s},e.prototype.splitcomplement=function(){var t=this.toHsl(),n=t.h;return[this,new e({h:(n+72)%360,s:t.s,l:t.l}),new e({h:(n+216)%360,s:t.s,l:t.l})]},e.prototype.onBackground=function(t){var n=this.toRgb(),r=new e(t).toRgb(),i=n.a+r.a*(1-n.a);return new e({r:(n.r*n.a+r.r*r.a*(1-n.a))/i,g:(n.g*n.a+r.g*r.a*(1-n.a))/i,b:(n.b*n.a+r.b*r.a*(1-n.a))/i,a:i})},e.prototype.triad=function(){return this.polyad(3)},e.prototype.tetrad=function(){return this.polyad(4)},e.prototype.polyad=function(t){for(var n=this.toHsl(),r=n.h,i=[this],a=360/t,s=1;s<t;s++)i.push(new e({h:(r+s*a)%360,s:n.s,l:n.l}));return i},e.prototype.equals=function(t){return this.toRgbString()===new e(t).toRgbString()},e}();function BS(e,t=20){return e.mix("#141414",t).toString()}const US=["aria-disabled","disabled","autofocus","type"],zS=Fn({name:"ElButton"});var FS=J_(Fn({...zS,props:gS,emits:vS,setup(e,{expose:t,emit:n}){const i=e,a=function(e){const t=hb(),n=rv("button");return Ki((()=>{let r={};const i=e.color;if(i){const a=new NS(i),s=e.dark?a.tint(20).toString():BS(a,20);if(e.plain)r=n.cssVarBlock({"bg-color":e.dark?BS(a,90):a.tint(90).toString(),"text-color":i,"border-color":e.dark?BS(a,50):a.tint(50).toString(),"hover-text-color":`var(${n.cssVarName("color-white")})`,"hover-bg-color":i,"hover-border-color":i,"active-bg-color":s,"active-text-color":`var(${n.cssVarName("color-white")})`,"active-border-color":s}),t.value&&(r[n.cssVarBlockName("disabled-bg-color")]=e.dark?BS(a,90):a.tint(90).toString(),r[n.cssVarBlockName("disabled-text-color")]=e.dark?BS(a,50):a.tint(50).toString(),r[n.cssVarBlockName("disabled-border-color")]=e.dark?BS(a,80):a.tint(80).toString());else{const o=e.dark?BS(a,30):a.tint(30).toString(),l=a.isDark()?`var(${n.cssVarName("color-white")})`:`var(${n.cssVarName("color-black")})`;if(r=n.cssVarBlock({"bg-color":i,"text-color":l,"border-color":i,"hover-bg-color":o,"hover-text-color":l,"hover-border-color":o,"active-bg-color":s,"active-border-color":s}),t.value){const t=e.dark?BS(a,50):a.tint(50).toString();r[n.cssVarBlockName("disabled-bg-color")]=t,r[n.cssVarBlockName("disabled-text-color")]=e.dark?"rgba(255, 255, 255, 0.5)":`var(${n.cssVarName("color-white")})`,r[n.cssVarBlockName("disabled-border-color")]=t}}}return r}))}(i),s=rv("button"),{_ref:o,_size:u,_type:c,_disabled:d,shouldAddSpace:h,handleClick:p}=((e,t)=>{Yg({from:"type.text",replacement:"link",version:"3.0.0",scope:"props",ref:"https://element-plus.org/en-US/component/button.html#button-attributes"},Ki((()=>"text"===e.type)));const n=Sn(fS,void 0),r=H_("button"),{form:i}=pb(),a=db(Ki((()=>null==n?void 0:n.size))),s=hb(),o=At(),l=Zi(),u=Ki((()=>e.type||(null==n?void 0:n.type)||"")),c=Ki((()=>{var t,n,i;return null!=(i=null!=(n=e.autoInsertSpace)?n:null==(t=r.value)?void 0:t.autoInsertSpace)&&i}));return{_disabled:s,_size:a,_type:u,_ref:o,shouldAddSpace:Ki((()=>{var e;const t=null==(e=l.default)?void 0:e.call(l);if(c.value&&1===(null==t?void 0:t.length)){const e=t[0];if((null==e?void 0:e.type)===ui){const t=e.children;return/^\p{Unified_Ideograph}{2}$/u.test(t.trim())}}return!1})),handleClick:n=>{"reset"===e.nativeType&&(null==i||i.resetFields()),t("click",n)}}})(i,n);return t({ref:o,size:u,type:c,disabled:d,shouldAddSpace:h}),(e,t)=>(fi(),yi("button",{ref_key:"_ref",ref:o,class:l([Dt(s).b(),Dt(s).m(Dt(c)),Dt(s).m(Dt(u)),Dt(s).is("disabled",Dt(d)),Dt(s).is("loading",e.loading),Dt(s).is("plain",e.plain),Dt(s).is("round",e.round),Dt(s).is("circle",e.circle),Dt(s).is("text",e.text),Dt(s).is("link",e.link),Dt(s).is("has-bg",e.bg)]),"aria-disabled":Dt(d)||e.loading,disabled:Dt(d)||e.loading,autofocus:e.autofocus,type:e.nativeType,style:r(Dt(a)),onClick:t[0]||(t[0]=(...e)=>Dt(p)&&Dt(p)(...e))},[e.loading?(fi(),yi(li,{key:0},[e.$slots.loading?vr(e.$slots,"loading",{key:0}):(fi(),_i(Dt(ib),{key:1,class:l(Dt(s).is("loading"))},{default:vn((()=>[(fi(),_i(dr(e.loadingIcon)))])),_:1},8,["class"]))],64)):e.icon||e.$slots.icon?(fi(),_i(Dt(ib),{key:1},{default:vn((()=>[e.icon?(fi(),_i(dr(e.icon),{key:0})):vr(e.$slots,"icon",{key:1})])),_:3})):Li("v-if",!0),e.$slots.default?(fi(),yi("span",{key:2,class:l({[Dt(s).em("text","expand")]:Dt(h)})},[vr(e.$slots,"default")],2)):Li("v-if",!0)],14,US))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/button/src/button.vue"]]);const VS={size:gS.size,type:gS.type},GS=Fn({name:"ElButtonGroup"});var HS=J_(Fn({...GS,props:VS,setup(e){const t=e;wn(fS,pt({size:Ut(t,"size"),type:Ut(t,"type")}));const n=rv("button");return(e,t)=>(fi(),yi("div",{class:l(`${Dt(n).b("group")}`)},[vr(e.$slots,"default")],2))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/button/src/button-group.vue"]]);const jS=_g(FS,{ButtonGroup:HS}),WS=xg(HS);var YS="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},$S={};({get exports(){return $S},set exports(e){$S=e}}).exports=function(){var e=1e3,t=6e4,n=36e5,r="millisecond",i="second",a="minute",s="hour",o="day",l="week",u="month",c="quarter",d="year",h="date",p="Invalid Date",f=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,m=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,g={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"}},v=function(e,t,n){var r=String(e);return!r||r.length>=t?e:""+Array(t+1-r.length).join(n)+e},y={s:v,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),r=Math.floor(n/60),i=n%60;return(t<=0?"+":"-")+v(r,2,"0")+":"+v(i,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var r=12*(n.year()-t.year())+(n.month()-t.month()),i=t.clone().add(r,u),a=n-i<0,s=t.clone().add(r+(a?-1:1),u);return+(-(r+(n-i)/(a?i-s:s-i))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:u,y:d,w:l,d:o,D:h,h:s,m:a,s:i,ms:r,Q:c}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},_="en",b={};b[_]=g;var x=function(e){return e instanceof T},w=function e(t,n,r){var i;if(!t)return _;if("string"==typeof t){var a=t.toLowerCase();b[a]&&(i=a),n&&(b[a]=n,i=a);var s=t.split("-");if(!i&&s.length>1)return e(s[0])}else{var o=t.name;b[o]=t,i=o}return!r&&i&&(_=i),i||!r&&_},S=function(e,t){if(x(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new T(n)},C=y;C.l=w,C.i=x,C.w=function(e,t){return S(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var T=function(){function g(e){this.$L=w(e.locale,null,!0),this.parse(e)}var v=g.prototype;return v.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(C.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var r=t.match(f);if(r){var i=r[2]-1||0,a=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,a)):new Date(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,a)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},v.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},v.$utils=function(){return C},v.isValid=function(){return!(this.$d.toString()===p)},v.isSame=function(e,t){var n=S(e);return this.startOf(t)<=n&&n<=this.endOf(t)},v.isAfter=function(e,t){return S(e)<this.startOf(t)},v.isBefore=function(e,t){return this.endOf(t)<S(e)},v.$g=function(e,t,n){return C.u(e)?this[t]:this.set(n,e)},v.unix=function(){return Math.floor(this.valueOf()/1e3)},v.valueOf=function(){return this.$d.getTime()},v.startOf=function(e,t){var n=this,r=!!C.u(t)||t,c=C.p(e),p=function(e,t){var i=C.w(n.$u?Date.UTC(n.$y,t,e):new Date(n.$y,t,e),n);return r?i:i.endOf(o)},f=function(e,t){return C.w(n.toDate()[e].apply(n.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(t)),n)},m=this.$W,g=this.$M,v=this.$D,y="set"+(this.$u?"UTC":"");switch(c){case d:return r?p(1,0):p(31,11);case u:return r?p(1,g):p(0,g+1);case l:var _=this.$locale().weekStart||0,b=(m<_?m+7:m)-_;return p(r?v-b:v+(6-b),g);case o:case h:return f(y+"Hours",0);case s:return f(y+"Minutes",1);case a:return f(y+"Seconds",2);case i:return f(y+"Milliseconds",3);default:return this.clone()}},v.endOf=function(e){return this.startOf(e,!1)},v.$set=function(e,t){var n,l=C.p(e),c="set"+(this.$u?"UTC":""),p=(n={},n[o]=c+"Date",n[h]=c+"Date",n[u]=c+"Month",n[d]=c+"FullYear",n[s]=c+"Hours",n[a]=c+"Minutes",n[i]=c+"Seconds",n[r]=c+"Milliseconds",n)[l],f=l===o?this.$D+(t-this.$W):t;if(l===u||l===d){var m=this.clone().set(h,1);m.$d[p](f),m.init(),this.$d=m.set(h,Math.min(this.$D,m.daysInMonth())).$d}else p&&this.$d[p](f);return this.init(),this},v.set=function(e,t){return this.clone().$set(e,t)},v.get=function(e){return this[C.p(e)]()},v.add=function(r,c){var h,p=this;r=Number(r);var f=C.p(c),m=function(e){var t=S(p);return C.w(t.date(t.date()+Math.round(e*r)),p)};if(f===u)return this.set(u,this.$M+r);if(f===d)return this.set(d,this.$y+r);if(f===o)return m(1);if(f===l)return m(7);var g=(h={},h[a]=t,h[s]=n,h[i]=e,h)[f]||1,v=this.$d.getTime()+r*g;return C.w(v,this)},v.subtract=function(e,t){return this.add(-1*e,t)},v.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||p;var r=e||"YYYY-MM-DDTHH:mm:ssZ",i=C.z(this),a=this.$H,s=this.$m,o=this.$M,l=n.weekdays,u=n.months,c=function(e,n,i,a){return e&&(e[n]||e(t,r))||i[n].slice(0,a)},d=function(e){return C.s(a%12||12,e,"0")},h=n.meridiem||function(e,t,n){var r=e<12?"AM":"PM";return n?r.toLowerCase():r},f={YY:String(this.$y).slice(-2),YYYY:this.$y,M:o+1,MM:C.s(o+1,2,"0"),MMM:c(n.monthsShort,o,u,3),MMMM:c(u,o),D:this.$D,DD:C.s(this.$D,2,"0"),d:String(this.$W),dd:c(n.weekdaysMin,this.$W,l,2),ddd:c(n.weekdaysShort,this.$W,l,3),dddd:l[this.$W],H:String(a),HH:C.s(a,2,"0"),h:d(1),hh:d(2),a:h(a,s,!0),A:h(a,s,!1),m:String(s),mm:C.s(s,2,"0"),s:String(this.$s),ss:C.s(this.$s,2,"0"),SSS:C.s(this.$ms,3,"0"),Z:i};return r.replace(m,(function(e,t){return t||f[e]||i.replace(":","")}))},v.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},v.diff=function(r,h,p){var f,m=C.p(h),g=S(r),v=(g.utcOffset()-this.utcOffset())*t,y=this-g,_=C.m(this,g);return _=(f={},f[d]=_/12,f[u]=_,f[c]=_/3,f[l]=(y-v)/6048e5,f[o]=(y-v)/864e5,f[s]=y/n,f[a]=y/t,f[i]=y/e,f)[m]||y,p?_:C.a(_)},v.daysInMonth=function(){return this.endOf(u).$D},v.$locale=function(){return b[this.$L]},v.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),r=w(e,t,!0);return r&&(n.$L=r),n},v.clone=function(){return C.w(this.$d,this)},v.toDate=function(){return new Date(this.valueOf())},v.toJSON=function(){return this.isValid()?this.toISOString():null},v.toISOString=function(){return this.$d.toISOString()},v.toString=function(){return this.$d.toUTCString()},g}(),M=T.prototype;return S.prototype=M,[["$ms",r],["$s",i],["$m",a],["$H",s],["$W",o],["$M",u],["$y",d],["$D",h]].forEach((function(e){M[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),S.extend=function(e,t){return e.$i||(e(t,T,S),e.$i=!0),S},S.locale=w,S.isDayjs=x,S.unix=function(e){return S(1e3*e)},S.en=b[_],S.Ls=b,S.p={},S}();const XS=$S;var qS={};({get exports(){return qS},set exports(e){qS=e}}).exports=function(){var e={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},t=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,n=/\d\d/,r=/\d\d?/,i=/\d*[^-_:/,()\s\d]+/,a={},s=function(e){return(e=+e)+(e>68?1900:2e3)},o=function(e){return function(t){this[e]=+t}},l=[/[+-]\d\d:?(\d\d)?|Z/,function(e){(this.zone||(this.zone={})).offset=function(e){if(!e)return 0;if("Z"===e)return 0;var t=e.match(/([+-]|\d\d)/g),n=60*t[1]+(+t[2]||0);return 0===n?0:"+"===t[0]?-n:n}(e)}],u=function(e){var t=a[e];return t&&(t.indexOf?t:t.s.concat(t.f))},c=function(e,t){var n,r=a.meridiem;if(r){for(var i=1;i<=24;i+=1)if(e.indexOf(r(i,0,t))>-1){n=i>12;break}}else n=e===(t?"pm":"PM");return n},d={A:[i,function(e){this.afternoon=c(e,!1)}],a:[i,function(e){this.afternoon=c(e,!0)}],S:[/\d/,function(e){this.milliseconds=100*+e}],SS:[n,function(e){this.milliseconds=10*+e}],SSS:[/\d{3}/,function(e){this.milliseconds=+e}],s:[r,o("seconds")],ss:[r,o("seconds")],m:[r,o("minutes")],mm:[r,o("minutes")],H:[r,o("hours")],h:[r,o("hours")],HH:[r,o("hours")],hh:[r,o("hours")],D:[r,o("day")],DD:[n,o("day")],Do:[i,function(e){var t=a.ordinal,n=e.match(/\d+/);if(this.day=n[0],t)for(var r=1;r<=31;r+=1)t(r).replace(/\[|\]/g,"")===e&&(this.day=r)}],M:[r,o("month")],MM:[n,o("month")],MMM:[i,function(e){var t=u("months"),n=(u("monthsShort")||t.map((function(e){return e.slice(0,3)}))).indexOf(e)+1;if(n<1)throw new Error;this.month=n%12||n}],MMMM:[i,function(e){var t=u("months").indexOf(e)+1;if(t<1)throw new Error;this.month=t%12||t}],Y:[/[+-]?\d+/,o("year")],YY:[n,function(e){this.year=s(e)}],YYYY:[/\d{4}/,o("year")],Z:l,ZZ:l};function h(n){var r,i;r=n,i=a&&a.formats;for(var s=(n=r.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(t,n,r){var a=r&&r.toUpperCase();return n||i[r]||e[r]||i[a].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(e,t,n){return t||n.slice(1)}))}))).match(t),o=s.length,l=0;l<o;l+=1){var u=s[l],c=d[u],h=c&&c[0],p=c&&c[1];s[l]=p?{regex:h,parser:p}:u.replace(/^\[|\]$/g,"")}return function(e){for(var t={},n=0,r=0;n<o;n+=1){var i=s[n];if("string"==typeof i)r+=i.length;else{var a=i.regex,l=i.parser,u=e.slice(r),c=a.exec(u)[0];l.call(t,c),e=e.replace(c,"")}}return function(e){var t=e.afternoon;if(void 0!==t){var n=e.hours;t?n<12&&(e.hours+=12):12===n&&(e.hours=0),delete e.afternoon}}(t),t}}return function(e,t,n){n.p.customParseFormat=!0,e&&e.parseTwoDigitYear&&(s=e.parseTwoDigitYear);var r=t.prototype,i=r.parse;r.parse=function(e){var t=e.date,r=e.utc,s=e.args;this.$u=r;var o=s[1];if("string"==typeof o){var l=!0===s[2],u=!0===s[3],c=l||u,d=s[2];u&&(d=s[2]),a=this.$locale(),!l&&d&&(a=n.Ls[d]),this.$d=function(e,t,n){try{if(["x","X"].indexOf(t)>-1)return new Date(("X"===t?1e3:1)*e);var r=h(t)(e),i=r.year,a=r.month,s=r.day,o=r.hours,l=r.minutes,u=r.seconds,c=r.milliseconds,d=r.zone,p=new Date,f=s||(i||a?1:p.getDate()),m=i||p.getFullYear(),g=0;i&&!a||(g=a>0?a-1:p.getMonth());var v=o||0,y=l||0,_=u||0,b=c||0;return d?new Date(Date.UTC(m,g,f,v,y,_,b+60*d.offset*1e3)):n?new Date(Date.UTC(m,g,f,v,y,_,b)):new Date(m,g,f,v,y,_,b)}catch(x){return new Date("")}}(t,o,r),this.init(),d&&!0!==d&&(this.$L=this.locale(d).$L),c&&t!=this.format(o)&&(this.$d=new Date("")),a={}}else if(o instanceof Array)for(var p=o.length,f=1;f<=p;f+=1){s[1]=o[f-1];var m=n.apply(this,s);if(m.isValid()){this.$d=m.$d,this.$L=m.$L,this.init();break}f===p&&(this.$d=new Date(""))}else i.call(this,e)}}}();const KS=qS,ZS=["hours","minutes","seconds"],JS="HH:mm:ss",QS="YYYY-MM-DD",eC={date:QS,dates:QS,week:"gggg[w]ww",year:"YYYY",month:"YYYY-MM",datetime:`${QS} ${JS}`,monthrange:"YYYY-MM",daterange:QS,datetimerange:`${QS} ${JS}`},tC=(e,t)=>[e>0?e-1:void 0,e,e<t?e+1:void 0],nC=e=>Array.from(Array.from({length:e}).keys()),rC=e=>e.replace(/\W?m{1,2}|\W?ZZ/g,"").replace(/\W?h{1,2}|\W?s{1,3}|\W?a/gi,"").trim(),iC=e=>e.replace(/\W?D{1,2}|\W?Do|\W?d{1,4}|\W?M{1,4}|\W?Y{2,4}/g,"").trim(),aC=function(e,t){const n=R(e),r=R(t);return n&&r?e.getTime()===t.getTime():!n&&!r&&e===t},sC=function(e,t){const n=E(e),r=E(t);return n&&r?e.length===t.length&&e.every(((e,n)=>aC(e,t[n]))):!n&&!r&&aC(e,t)},oC=function(e,t,n){const r=Uh(t)||"x"===t?XS(e).locale(n):XS(e,t).locale(n);return r.isValid()?r:void 0},lC=function(e,t,n){return Uh(t)?e:"x"===t?+e:XS(e).locale(n).format(t)},uC=(e,t)=>{var n;const r=[],i=null==t?void 0:t();for(let a=0;a<e;a++)r.push(null!=(n=null==i?void 0:i.includes(a))&&n);return r},cC=pg({disabledHours:{type:Function},disabledMinutes:{type:Function},disabledSeconds:{type:Function}}),dC=pg({visible:Boolean,actualVisible:{type:Boolean,default:void 0},format:{type:String,default:""}}),hC=pg({id:{type:[Array,String]},name:{type:[Array,String],default:""},popperClass:{type:String,default:""},format:String,valueFormat:String,type:{type:String,default:""},clearable:{type:Boolean,default:!0},clearIcon:{type:[String,Object],default:tf},editable:{type:Boolean,default:!0},prefixIcon:{type:[String,Object],default:""},size:z_,readonly:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},placeholder:{type:String,default:""},popperOptions:{type:Object,default:()=>({})},modelValue:{type:[Date,Array,String,Number],default:""},rangeSeparator:{type:String,default:"-"},startPlaceholder:String,endPlaceholder:String,defaultValue:{type:[Date,Array]},defaultTime:{type:[Date,Array]},isRange:{type:Boolean,default:!1},...cC,disabledDate:{type:Function},cellClassName:{type:Function},shortcuts:{type:Array,default:()=>[]},arrowControl:{type:Boolean,default:!1},label:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},validateEvent:{type:Boolean,default:!0},unlinkPanels:Boolean}),pC=["id","name","placeholder","value","disabled","readonly"],fC=["id","name","placeholder","value","disabled","readonly"],mC=Fn({name:"Picker"}),gC=Fn({...mC,props:hC,emits:["update:modelValue","change","focus","blur","calendar-change","panel-change","visible-change","keydown"],setup(e,{expose:t,emit:n}){const i=e,{lang:a}=Jg(),s=rv("date"),o=rv("input"),u=rv("range"),{form:c,formItem:d}=pb(),h=Sn("ElPopperOptions",{}),p=At(),m=At(),g=At(!1),v=At(!1),y=At(null);let _=!1,b=!1;Mn(g,(e=>{e?en((()=>{e&&(y.value=i.modelValue)})):(Q.value=null,en((()=>{x(i.modelValue)})))}));const x=(e,t)=>{!t&&sC(e,y.value)||(n("change",e),i.validateEvent&&(null==d||d.validate("change").catch((e=>{}))))},w=e=>{if(!sC(i.modelValue,e)){let t;E(e)?t=e.map((e=>lC(e,i.valueFormat,a.value))):e&&(t=lC(e,i.valueFormat,a.value)),n("update:modelValue",e?t:e,a.value)}},S=Ki((()=>{if(m.value){const e=q.value?m.value:m.value.$el;return Array.from(e.querySelectorAll("input"))}return[]})),C=(e,t,n)=>{const r=S.value;r.length&&(n&&"min"!==n?"max"===n&&(r[1].setSelectionRange(e,t),r[1].focus()):(r[0].setSelectionRange(e,t),r[0].focus()))},T=(e="",t=!1)=>{let n;t||(b=!0),g.value=t,n=E(e)?e.map((e=>e.toDate())):e?e.toDate():e,Q.value=null,w(n)},M=()=>{v.value=!0},A=()=>{n("visible-change",!0)},P=e=>{(null==e?void 0:e.key)===Sg.esc&&L(!0,!0)},R=()=>{v.value=!1,g.value=!1,b=!1,n("visible-change",!1)},L=(e=!0,t=!1)=>{b=t;const[n,r]=Dt(S);let i=n;!e&&q.value&&(i=r),i&&i.focus()},k=e=>{i.readonly||O.value||g.value||b||(g.value=!0,n("focus",e))};let D;const I=e=>{const t=async()=>{setTimeout((()=>{var r;D===t&&((null==(r=p.value)?void 0:r.isFocusInsideContent())&&!_||0!==S.value.filter((e=>e.contains(document.activeElement))).length||(ee(),g.value=!1,n("blur",e),i.validateEvent&&(null==d||d.validate("blur").catch((e=>{})))),_=!1)}),0)};D=t,t()},O=Ki((()=>i.disabled||(null==c?void 0:c.disabled))),N=Ki((()=>{let e;if(j.value?ce.value.getDefaultValue&&(e=ce.value.getDefaultValue()):e=E(i.modelValue)?i.modelValue.map((e=>oC(e,i.valueFormat,a.value))):oC(i.modelValue,i.valueFormat,a.value),ce.value.getRangeAvailableTime){const t=ce.value.getRangeAvailableTime(e);Eh(t,e)||(e=t,w(E(e)?e.map((e=>e.toDate())):e.toDate()))}return E(e)&&e.some((e=>!e))&&(e=[]),e})),B=Ki((()=>{if(!ce.value.panelReady)return"";const e=ne(N.value);return E(Q.value)?[Q.value[0]||e&&e[0]||"",Q.value[1]||e&&e[1]||""]:null!==Q.value?Q.value:!z.value&&j.value||!g.value&&j.value?"":e?F.value?e.join(", "):e:""})),U=Ki((()=>i.type.includes("time"))),z=Ki((()=>i.type.startsWith("time"))),F=Ki((()=>"dates"===i.type)),V=Ki((()=>i.prefixIcon||(U.value?sf:Ep))),G=At(!1),H=e=>{i.readonly||O.value||G.value&&(e.stopPropagation(),L(!0,!0),en((()=>{b=!1})),w(null),x(null,!0),G.value=!1,g.value=!1,ce.value.handleClear&&ce.value.handleClear())},j=Ki((()=>{const{modelValue:e}=i;return!e||E(e)&&!e.filter(Boolean).length})),W=async e=>{var t;i.readonly||O.value||("INPUT"!==(null==(t=e.target)?void 0:t.tagName)||S.value.includes(document.activeElement))&&(g.value=!0)},Y=()=>{i.readonly||O.value||!j.value&&i.clearable&&(G.value=!0)},$=()=>{G.value=!1},X=e=>{var t;i.readonly||O.value||("INPUT"!==(null==(t=e.touches[0].target)?void 0:t.tagName)||S.value.includes(document.activeElement))&&(g.value=!0)},q=Ki((()=>i.type.includes("range"))),K=db(),Z=Ki((()=>{var e,t;return null==(t=null==(e=Dt(p))?void 0:e.popperRef)?void 0:t.contentRef})),J=Ki((()=>{var e;return Dt(q)?Dt(m):null==(e=Dt(m))?void 0:e.$el}));Qs(J,(e=>{const t=Dt(Z),n=Dt(J);t&&(e.target===t||e.composedPath().includes(t))||e.target===n||e.composedPath().includes(n)||(g.value=!1)}));const Q=At(null),ee=()=>{if(Q.value){const e=te(B.value);e&&re(e)&&(w(E(e)?e.map((e=>e.toDate())):e.toDate()),Q.value=null)}""===Q.value&&(w(null),x(null),Q.value=null)},te=e=>e?ce.value.parseUserInput(e):null,ne=e=>e?ce.value.formatToString(e):null,re=e=>ce.value.isValidValue(e),ie=async e=>{if(i.readonly||O.value)return;const{code:t}=e;if(n("keydown",e),t!==Sg.esc)if(t===Sg.down&&(ce.value.handleFocusPicker&&(e.preventDefault(),e.stopPropagation()),!1===g.value&&(g.value=!0,await en()),ce.value.handleFocusPicker))ce.value.handleFocusPicker();else{if(t!==Sg.tab)return t===Sg.enter||t===Sg.numpadEnter?((null===Q.value||""===Q.value||re(te(B.value)))&&(ee(),g.value=!1),void e.stopPropagation()):void(Q.value?e.stopPropagation():ce.value.handleKeydownInput&&ce.value.handleKeydownInput(e));_=!0}else!0===g.value&&(g.value=!1,e.preventDefault(),e.stopPropagation())},ae=e=>{Q.value=e,g.value||(g.value=!0)},se=e=>{const t=e.target;Q.value?Q.value=[t.value,Q.value[1]]:Q.value=[t.value,null]},oe=e=>{const t=e.target;Q.value?Q.value=[Q.value[0],t.value]:Q.value=[null,t.value]},le=()=>{var e;const t=Q.value,n=te(t&&t[0]),r=Dt(N);if(n&&n.isValid()){Q.value=[ne(n),(null==(e=B.value)?void 0:e[1])||null];const t=[n,r&&(r[1]||null)];re(t)&&(w(t),Q.value=null)}},ue=()=>{var e;const t=Dt(Q),n=te(t&&t[1]),r=Dt(N);if(n&&n.isValid()){Q.value=[(null==(e=Dt(B))?void 0:e[0])||null,ne(n)];const t=[r&&r[0],n];re(t)&&(w(t),Q.value=null)}},ce=At({}),de=e=>{ce.value[e[0]]=e[1],ce.value.panelReady=!0},he=e=>{n("calendar-change",e)},pe=(e,t,r)=>{n("panel-change",e,t,r)};return wn("EP_PICKER_BASE",{props:i}),t({focus:L,handleFocusInput:k,handleBlurInput:I,handleOpen:()=>{g.value=!0},handleClose:()=>{g.value=!1},onPick:T}),(e,t)=>(fi(),_i(Dt(Ow),Oi({ref_key:"refPopper",ref:p,visible:g.value,effect:"light",pure:"",trigger:"click"},e.$attrs,{role:"dialog",teleported:"",transition:`${Dt(s).namespace.value}-zoom-in-top`,"popper-class":[`${Dt(s).namespace.value}-picker__popper`,e.popperClass],"popper-options":Dt(h),"fallback-placements":["bottom","top","right","left"],"gpu-acceleration":!1,"stop-popper-mouse-event":!1,"hide-after":0,persistent:"",onBeforeShow:M,onShow:A,onHide:R}),{default:vn((()=>[Dt(q)?(fi(),yi("div",{key:1,ref_key:"inputRef",ref:m,class:l([Dt(s).b("editor"),Dt(s).bm("editor",e.type),Dt(o).e("wrapper"),Dt(s).is("disabled",Dt(O)),Dt(s).is("active",g.value),Dt(u).b("editor"),Dt(K)?Dt(u).bm("editor",Dt(K)):"",e.$attrs.class]),style:r(e.$attrs.style),onClick:k,onMouseenter:Y,onMouseleave:$,onTouchstart:X,onKeydown:ie},[Dt(V)?(fi(),_i(Dt(ib),{key:0,class:l([Dt(o).e("icon"),Dt(u).e("icon")]),onMousedown:ts(W,["prevent"]),onTouchstart:X},{default:vn((()=>[(fi(),_i(dr(Dt(V))))])),_:1},8,["class","onMousedown"])):Li("v-if",!0),Ti("input",{id:e.id&&e.id[0],autocomplete:"off",name:e.name&&e.name[0],placeholder:e.startPlaceholder,value:Dt(B)&&Dt(B)[0],disabled:Dt(O),readonly:!e.editable||e.readonly,class:l(Dt(u).b("input")),onMousedown:W,onInput:se,onChange:le,onFocus:k,onBlur:I},null,42,pC),vr(e.$slots,"range-separator",{},(()=>[Ti("span",{class:l(Dt(u).b("separator"))},f(e.rangeSeparator),3)])),Ti("input",{id:e.id&&e.id[1],autocomplete:"off",name:e.name&&e.name[1],placeholder:e.endPlaceholder,value:Dt(B)&&Dt(B)[1],disabled:Dt(O),readonly:!e.editable||e.readonly,class:l(Dt(u).b("input")),onMousedown:W,onFocus:k,onBlur:I,onInput:oe,onChange:ue},null,42,fC),e.clearIcon?(fi(),_i(Dt(ib),{key:1,class:l([Dt(o).e("icon"),Dt(u).e("close-icon"),{[Dt(u).e("close-icon--hidden")]:!G.value}]),onClick:H},{default:vn((()=>[(fi(),_i(dr(e.clearIcon)))])),_:1},8,["class"])):Li("v-if",!0)],38)):(fi(),_i(Dt(mx),{key:0,id:e.id,ref_key:"inputRef",ref:m,"container-role":"combobox","model-value":Dt(B),name:e.name,size:Dt(K),disabled:Dt(O),placeholder:e.placeholder,class:l([Dt(s).b("editor"),Dt(s).bm("editor",e.type),e.$attrs.class]),style:r(e.$attrs.style),readonly:!e.editable||e.readonly||Dt(F)||"week"===e.type,label:e.label,tabindex:e.tabindex,"validate-event":!1,onInput:ae,onFocus:k,onBlur:I,onKeydown:ie,onChange:ee,onMousedown:W,onMouseenter:Y,onMouseleave:$,onTouchstart:X,onClick:t[0]||(t[0]=ts((()=>{}),["stop"]))},{prefix:vn((()=>[Dt(V)?(fi(),_i(Dt(ib),{key:0,class:l(Dt(o).e("icon")),onMousedown:ts(W,["prevent"]),onTouchstart:X},{default:vn((()=>[(fi(),_i(dr(Dt(V))))])),_:1},8,["class","onMousedown"])):Li("v-if",!0)])),suffix:vn((()=>[G.value&&e.clearIcon?(fi(),_i(Dt(ib),{key:0,class:l(`${Dt(o).e("icon")} clear-icon`),onClick:ts(H,["stop"])},{default:vn((()=>[(fi(),_i(dr(e.clearIcon)))])),_:1},8,["class","onClick"])):Li("v-if",!0)])),_:1},8,["id","model-value","name","size","disabled","placeholder","class","style","readonly","label","tabindex","onKeydown"]))])),content:vn((()=>[vr(e.$slots,"default",{visible:g.value,actualVisible:v.value,parsedValue:Dt(N),format:e.format,unlinkPanels:e.unlinkPanels,type:e.type,defaultValue:e.defaultValue,onPick:T,onSelectRange:C,onSetPickerOption:de,onCalendarChange:he,onPanelChange:pe,onKeydown:P,onMousedown:t[1]||(t[1]=ts((()=>{}),["stop"]))})])),_:3},16,["visible","transition","popper-class","popper-options"]))}});var vC=J_(gC,[["__file","/home/runner/work/element-plus/element-plus/packages/components/time-picker/src/common/picker.vue"]]);const yC=pg({...dC,datetimeRole:String,parsedValue:{type:Object}}),_C=({getAvailableHours:e,getAvailableMinutes:t,getAvailableSeconds:n})=>{const r={};return{timePickerOptions:r,getAvailableTime:(r,i,a,s)=>{const o={hour:e,minute:t,second:n};let l=r;return["hour","minute","second"].forEach((e=>{if(o[e]){let t;const n=o[e];switch(e){case"minute":t=n(l.hour(),i,s);break;case"second":t=n(l.hour(),l.minute(),i,s);break;default:t=n(i,s)}if((null==t?void 0:t.length)&&!t.includes(l[e]())){const n=a?0:t.length-1;l=l[e](t[n])}}})),l},onSetOption:([e,t])=>{r[e]=t}}},bC=e=>e.map(((e,t)=>e||t)).filter((e=>!0!==e)),xC=(e,t,n)=>({getHoursList:(t,n)=>uC(24,e&&(()=>null==e?void 0:e(t,n))),getMinutesList:(e,n,r)=>uC(60,t&&(()=>null==t?void 0:t(e,n,r))),getSecondsList:(e,t,r,i)=>uC(60,n&&(()=>null==n?void 0:n(e,t,r,i)))}),wC=(e,t,n)=>{const{getHoursList:r,getMinutesList:i,getSecondsList:a}=xC(e,t,n);return{getAvailableHours:(e,t)=>bC(r(e,t)),getAvailableMinutes:(e,t,n)=>bC(i(e,t,n)),getAvailableSeconds:(e,t,n,r)=>bC(a(e,t,n,r))}},SC=e=>{const t=At(e.parsedValue);return Mn((()=>e.visible),(n=>{n||(t.value=e.parsedValue)})),t},CC=new Map;let TC;function MC(e,t){let n=[];return Array.isArray(t.arg)?n=t.arg:zh(t.arg)&&n.push(t.arg),function(r,i){const a=t.instance.popperRef,s=r.target,o=null==i?void 0:i.target,l=!t||!t.instance,u=!s||!o,c=e.contains(s)||e.contains(o),d=e===s,h=n.length&&n.some((e=>null==e?void 0:e.contains(s)))||n.length&&n.includes(o),p=a&&(a.contains(s)||a.contains(o));l||u||c||d||h||p||t.value(r,i)}}Os&&(document.addEventListener("mousedown",(e=>TC=e)),document.addEventListener("mouseup",(e=>{for(const t of CC.values())for(const{documentHandler:n}of t)n(e,TC)})));const EC={beforeMount(e,t){CC.has(e)||CC.set(e,[]),CC.get(e).push({documentHandler:MC(e,t),bindingFn:t.value})},updated(e,t){CC.has(e)||CC.set(e,[]);const n=CC.get(e),r=n.findIndex((e=>e.bindingFn===t.oldValue)),i={documentHandler:MC(e,t),bindingFn:t.value};r>=0?n.splice(r,1,i):n.push(i)},unmounted(e){CC.delete(e)}},AC=100,PC=600,RC={beforeMount(e,t){const n=t.value,{interval:r=AC,delay:i=PC}=k(n)?{}:n;let a,s;const o=()=>k(n)?n():n.handler(),l=()=>{s&&(clearTimeout(s),s=void 0),a&&(clearInterval(a),a=void 0)};e.addEventListener("mousedown",(e=>{0===e.button&&(l(),o(),document.addEventListener("mouseup",(()=>l()),{once:!0}),s=setTimeout((()=>{a=setInterval((()=>{o()}),r)}),i))}))}},LC="_trap-focus-children",kC=[],DC=e=>{if(0===kC.length)return;const t=kC[kC.length-1][LC];if(t.length>0&&e.code===Sg.tab){if(1===t.length)return e.preventDefault(),void(document.activeElement!==t[0]&&t[0].focus());const n=e.shiftKey,r=e.target===t[0],i=e.target===t[t.length-1];r&&n&&(e.preventDefault(),t[t.length-1].focus()),i&&!n&&(e.preventDefault(),t[0].focus())}},IC={beforeMount(e){e[LC]=ys(e),kC.push(e),kC.length<=1&&document.addEventListener("keydown",DC)},updated(e){en((()=>{e[LC]=ys(e)}))},unmounted(){kC.shift(),0===kC.length&&document.removeEventListener("keydown",DC)}};var OC,NC,BC,UC,zC,FC,VC,GC,HC,jC,WC,YC,$C,XC,qC,KC=!1;function ZC(){if(!KC){KC=!0;var e=navigator.userAgent,t=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(e),n=/(Mac OS X)|(Windows)|(Linux)/.exec(e);if(YC=/\b(iPhone|iP[ao]d)/.exec(e),$C=/\b(iP[ao]d)/.exec(e),jC=/Android/i.exec(e),XC=/FBAN\/\w+;/i.exec(e),qC=/Mobile/i.exec(e),WC=!!/Win64/.exec(e),t){(OC=t[1]?parseFloat(t[1]):t[5]?parseFloat(t[5]):NaN)&&document&&document.documentMode&&(OC=document.documentMode);var r=/(?:Trident\/(\d+.\d+))/.exec(e);FC=r?parseFloat(r[1])+4:OC,NC=t[2]?parseFloat(t[2]):NaN,BC=t[3]?parseFloat(t[3]):NaN,(UC=t[4]?parseFloat(t[4]):NaN)?(t=/(?:Chrome\/(\d+\.\d+))/.exec(e),zC=t&&t[1]?parseFloat(t[1]):NaN):zC=NaN}else OC=NC=BC=zC=UC=NaN;if(n){if(n[1]){var i=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(e);VC=!i||parseFloat(i[1].replace("_","."))}else VC=!1;GC=!!n[2],HC=!!n[3]}else VC=GC=HC=!1}}var JC,QC={ie:function(){return ZC()||OC},ieCompatibilityMode:function(){return ZC()||FC>OC},ie64:function(){return QC.ie()&&WC},firefox:function(){return ZC()||NC},opera:function(){return ZC()||BC},webkit:function(){return ZC()||UC},safari:function(){return QC.webkit()},chrome:function(){return ZC()||zC},windows:function(){return ZC()||GC},osx:function(){return ZC()||VC},linux:function(){return ZC()||HC},iphone:function(){return ZC()||YC},mobile:function(){return ZC()||YC||$C||jC||qC},nativeApp:function(){return ZC()||XC},android:function(){return ZC()||jC},ipad:function(){return ZC()||$C}},eT=QC,tT=!!(typeof window<"u"&&window.document&&window.document.createElement),nT={canUseDOM:tT,canUseWorkers:typeof Worker<"u",canUseEventListeners:tT&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:tT&&!!window.screen,isInWorker:!tT};nT.canUseDOM&&(JC=document.implementation&&document.implementation.hasFeature&&!0!==document.implementation.hasFeature("",""));var rT=function(e,t){if(!nT.canUseDOM||t&&!("addEventListener"in document))return!1;var n="on"+e,r=n in document;if(!r){var i=document.createElement("div");i.setAttribute(n,"return;"),r="function"==typeof i[n]}return!r&&JC&&"wheel"===e&&(r=document.implementation.hasFeature("Events.wheel","3.0")),r};function iT(e){var t=0,n=0,r=0,i=0;return"detail"in e&&(n=e.detail),"wheelDelta"in e&&(n=-e.wheelDelta/120),"wheelDeltaY"in e&&(n=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(t=n,n=0),r=10*t,i=10*n,"deltaY"in e&&(i=e.deltaY),"deltaX"in e&&(r=e.deltaX),(r||i)&&e.deltaMode&&(1==e.deltaMode?(r*=40,i*=40):(r*=800,i*=800)),r&&!t&&(t=r<1?-1:1),i&&!n&&(n=i<1?-1:1),{spinX:t,spinY:n,pixelX:r,pixelY:i}}iT.getEventType=function(){return eT.firefox()?"DOMMouseScroll":rT("wheel")?"wheel":"mousewheel"};var aT=iT;
/**
* Checks if an event is supported in the current execution environment.
*
* NOTE: This will not work correctly for non-generic events such as `change`,
* `reset`, `load`, `error`, and `select`.
*
* Borrows from Modernizr.
*
* @param {string} eventNameSuffix Event name, e.g. "click".
* @param {?boolean} capture Check if the capture phase is supported.
* @return {boolean} True if the event is supported.
* @internal
* @license Modernizr 3.0.0pre (Custom Build) | MIT
*/const sT={beforeMount(e,t){!function(e,t){if(e&&e.addEventListener){const n=function(e){const n=aT(e);t&&Reflect.apply(t,this,[e,n])};e.addEventListener("wheel",n,{passive:!0})}}(e,t.value)}},oT=pg({role:{type:String,required:!0},spinnerDate:{type:Object,required:!0},showSeconds:{type:Boolean,default:!0},arrowControl:Boolean,amPmMode:{type:String,default:""},...cC}),lT=["onClick"],uT=["onMouseenter"];var cT=J_(Fn({__name:"basic-time-spinner",props:oT,emits:["change","select-range","set-option"],setup(e,{emit:t}){const n=e,r=rv("time"),{getHoursList:i,getMinutesList:a,getSecondsList:s}=xC(n.disabledHours,n.disabledMinutes,n.disabledSeconds);let o=!1;const u=At(),c={hours:At(),minutes:At(),seconds:At()},d=Ki((()=>n.showSeconds?ZS:ZS.slice(0,2))),h=Ki((()=>{const{spinnerDate:e}=n;return{hours:e.hour(),minutes:e.minute(),seconds:e.second()}})),p=Ki((()=>{const{hours:e,minutes:t}=Dt(h);return{hours:i(n.role),minutes:a(e,n.role),seconds:s(e,t,n.role)}})),m=Ki((()=>{const{hours:e,minutes:t,seconds:n}=Dt(h);return{hours:tC(e,23),minutes:tC(t,59),seconds:tC(n,59)}})),g=gh((e=>{o=!1,_(e)}),200),v=e=>{if(!!!n.amPmMode)return"";let t=e<12?" am":" pm";return"A"===n.amPmMode&&(t=t.toUpperCase()),t},y=e=>{let n;switch(e){case"hours":n=[0,2];break;case"minutes":n=[3,5];break;case"seconds":n=[6,8]}const[r,i]=n;t("select-range",r,i),u.value=e},_=e=>{w(e,Dt(h)[e])},b=()=>{_("hours"),_("minutes"),_("seconds")},x=e=>e.querySelector(`.${r.namespace.value}-scrollbar__wrap`),w=(e,t)=>{if(n.arrowControl)return;const r=Dt(c[e]);r&&r.$el&&(x(r.$el).scrollTop=Math.max(0,t*S(e)))},S=e=>{const t=Dt(c[e]);return(null==t?void 0:t.$el.querySelector("li").offsetHeight)||0},C=()=>{M(1)},T=()=>{M(-1)},M=e=>{u.value||y("hours");const t=u.value,n=Dt(h)[t],r="hours"===u.value?24:60,i=E(t,n,e,r);A(t,i),w(t,i),en((()=>y(t)))},E=(e,t,n,r)=>{let i=(t+n+r)%r;const a=Dt(p)[e];for(;a[i]&&i!==t;)i=(i+n+r)%r;return i},A=(e,r)=>{if(Dt(p)[e][r])return;const{hours:i,minutes:a,seconds:s}=Dt(h);let o;switch(e){case"hours":o=n.spinnerDate.hour(r).minute(a).second(s);break;case"minutes":o=n.spinnerDate.hour(i).minute(r).second(s);break;case"seconds":o=n.spinnerDate.hour(i).minute(a).second(r)}t("change",o)},P=e=>Dt(c[e]).$el.offsetHeight,R=()=>{const e=e=>{const t=Dt(c[e]);t&&t.$el&&(x(t.$el).onscroll=()=>{(e=>{o=!0,g(e);const t=Math.min(Math.round((x(Dt(c[e]).$el).scrollTop-(.5*P(e)-10)/S(e)+3)/S(e)),"hours"===e?23:59);A(e,t)})(e)})};e("hours"),e("minutes"),e("seconds")};Kn((()=>{en((()=>{!n.arrowControl&&R(),b(),"start"===n.role&&y("hours")}))}));return t("set-option",[`${n.role}_scrollDown`,M]),t("set-option",[`${n.role}_emitSelectRange`,y]),Mn((()=>n.spinnerDate),(()=>{o||b()})),(e,t)=>(fi(),yi("div",{class:l([Dt(r).b("spinner"),{"has-seconds":e.showSeconds}])},[e.arrowControl?Li("v-if",!0):(fi(!0),yi(li,{key:0},mr(Dt(d),(t=>(fi(),_i(Dt(Tx),{key:t,ref_for:!0,ref:e=>((e,t)=>{c[t].value=e})(e,t),class:l(Dt(r).be("spinner","wrapper")),"wrap-style":"max-height: inherit;","view-class":Dt(r).be("spinner","list"),noresize:"",tag:"ul",onMouseenter:e=>y(t),onMousemove:e=>_(t)},{default:vn((()=>[(fi(!0),yi(li,null,mr(Dt(p)[t],((n,i)=>(fi(),yi("li",{key:i,class:l([Dt(r).be("spinner","item"),Dt(r).is("active",i===Dt(h)[t]),Dt(r).is("disabled",n)]),onClick:e=>((e,{value:t,disabled:n})=>{n||(A(e,t),y(e),w(e,t))})(t,{value:i,disabled:n})},["hours"===t?(fi(),yi(li,{key:0},[Pi(f(("0"+(e.amPmMode?i%12||12:i)).slice(-2))+f(v(i)),1)],64)):(fi(),yi(li,{key:1},[Pi(f(("0"+i).slice(-2)),1)],64))],10,lT)))),128))])),_:2},1032,["class","view-class","onMouseenter","onMousemove"])))),128)),e.arrowControl?(fi(!0),yi(li,{key:1},mr(Dt(d),(t=>(fi(),yi("div",{key:t,class:l([Dt(r).be("spinner","wrapper"),Dt(r).is("arrow")]),onMouseenter:e=>y(t)},[ar((fi(),_i(Dt(ib),{class:l(["arrow-up",Dt(r).be("spinner","arrow")])},{default:vn((()=>[Mi(Dt(_p))])),_:1},8,["class"])),[[Dt(RC),T]]),ar((fi(),_i(Dt(ib),{class:l(["arrow-down",Dt(r).be("spinner","arrow")])},{default:vn((()=>[Mi(Dt(op))])),_:1},8,["class"])),[[Dt(RC),C]]),Ti("ul",{class:l(Dt(r).be("spinner","list"))},[(fi(!0),yi(li,null,mr(Dt(m)[t],((n,i)=>(fi(),yi("li",{key:i,class:l([Dt(r).be("spinner","item"),Dt(r).is("active",n===Dt(h)[t]),Dt(r).is("disabled",Dt(p)[t][n])])},["number"==typeof n?(fi(),yi(li,{key:0},["hours"===t?(fi(),yi(li,{key:0},[Pi(f(("0"+(e.amPmMode?n%12||12:n)).slice(-2))+f(v(n)),1)],64)):(fi(),yi(li,{key:1},[Pi(f(("0"+n).slice(-2)),1)],64))],64)):Li("v-if",!0)],2)))),128))],2)],42,uT)))),128)):Li("v-if",!0)],2))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/time-picker/src/time-picker-com/basic-time-spinner.vue"]]);const dT=Fn({__name:"panel-time-pick",props:yC,emits:["pick","select-range","set-picker-option"],setup(e,{emit:t}){const n=e,r=Sn("EP_PICKER_BASE"),{arrowControl:i,disabledHours:a,disabledMinutes:s,disabledSeconds:o,defaultValue:u}=r.props,{getAvailableHours:c,getAvailableMinutes:d,getAvailableSeconds:h}=wC(a,s,o),p=rv("time"),{t:m,lang:g}=Jg(),v=At([0,2]),y=SC(n),_=Ki((()=>Bh(n.actualVisible)?`${p.namespace.value}-zoom-in-top`:"")),b=Ki((()=>n.format.includes("ss"))),x=Ki((()=>n.format.includes("A")?"A":n.format.includes("a")?"a":"")),w=()=>{t("pick",y.value,!1)},S=e=>{if(!n.visible)return;const r=A(e).millisecond(0);t("pick",r,!0)},C=(e,n)=>{t("select-range",e,n),v.value=[e,n]},{timePickerOptions:T,onSetOption:M,getAvailableTime:E}=_C({getAvailableHours:c,getAvailableMinutes:d,getAvailableSeconds:h}),A=e=>E(e,n.datetimeRole||"",!0);return t("set-picker-option",["isValidValue",e=>{const t=XS(e).locale(g.value),n=A(t);return t.isSame(n)}]),t("set-picker-option",["formatToString",e=>e?e.format(n.format):null]),t("set-picker-option",["parseUserInput",e=>e?XS(e,n.format).locale(g.value):null]),t("set-picker-option",["handleKeydownInput",e=>{const t=e.code,{left:n,right:r,up:i,down:a}=Sg;if([n,r].includes(t)){return(e=>{const t=[0,3].concat(b.value?[6]:[]),n=["hours","minutes"].concat(b.value?["seconds"]:[]),r=(t.indexOf(v.value[0])+e+t.length)%t.length;T.start_emitSelectRange(n[r])})(t===n?-1:1),void e.preventDefault()}if([i,a].includes(t)){const n=t===i?-1:1;return T.start_scrollDown(n),void e.preventDefault()}}]),t("set-picker-option",["getRangeAvailableTime",A]),t("set-picker-option",["getDefaultValue",()=>XS(u).locale(g.value)]),(e,r)=>(fi(),_i(xa,{name:Dt(_)},{default:vn((()=>[e.actualVisible||e.visible?(fi(),yi("div",{key:0,class:l(Dt(p).b("panel"))},[Ti("div",{class:l([Dt(p).be("panel","content"),{"has-seconds":Dt(b)}])},[Mi(cT,{ref:"spinner",role:e.datetimeRole||"start","arrow-control":Dt(i),"show-seconds":Dt(b),"am-pm-mode":Dt(x),"spinner-date":e.parsedValue,"disabled-hours":Dt(a),"disabled-minutes":Dt(s),"disabled-seconds":Dt(o),onChange:S,onSetOption:Dt(M),onSelectRange:C},null,8,["role","arrow-control","show-seconds","am-pm-mode","spinner-date","disabled-hours","disabled-minutes","disabled-seconds","onSetOption"])],2),Ti("div",{class:l(Dt(p).be("panel","footer"))},[Ti("button",{type:"button",class:l([Dt(p).be("panel","btn"),"cancel"]),onClick:w},f(Dt(m)("el.datepicker.cancel")),3),Ti("button",{type:"button",class:l([Dt(p).be("panel","btn"),"confirm"]),onClick:r[0]||(r[0]=e=>((e=!1,r=!1)=>{r||t("pick",n.parsedValue,e)})())},f(Dt(m)("el.datepicker.confirm")),3)],2)],2)):Li("v-if",!0)])),_:1},8,["name"]))}});var hT=J_(dT,[["__file","/home/runner/work/element-plus/element-plus/packages/components/time-picker/src/time-picker-com/panel-time-pick.vue"]]);const pT=pg({...dC,parsedValue:{type:Array}}),fT=["disabled"],mT=Fn({__name:"panel-time-range",props:pT,emits:["pick","select-range","set-picker-option"],setup(e,{emit:t}){const n=e,r=(e,t)=>{const n=[];for(let r=e;r<=t;r++)n.push(r);return n},{t:i,lang:a}=Jg(),s=rv("time"),o=rv("picker"),u=Sn("EP_PICKER_BASE"),{arrowControl:c,disabledHours:d,disabledMinutes:h,disabledSeconds:p,defaultValue:m}=u.props,g=Ki((()=>n.parsedValue[0])),v=Ki((()=>n.parsedValue[1])),y=SC(n),_=Ki((()=>n.format.includes("ss"))),b=Ki((()=>n.format.includes("A")?"A":n.format.includes("a")?"a":"")),x=e=>{S(e.millisecond(0),v.value)},w=e=>{S(g.value,e.millisecond(0))},S=(e,n)=>{t("pick",[e,n],!0)},C=Ki((()=>g.value>v.value)),T=At([0,2]),M=(e,n)=>{t("select-range",e,n,"min"),T.value=[e,n]},A=Ki((()=>_.value?11:8)),P=(e,n)=>{t("select-range",e,n,"max");const r=Dt(A);T.value=[e+r,n+r]},R=(e,t)=>{const n=d?d(e):[],i="start"===e,a=(t||(i?v.value:g.value)).hour(),s=i?r(a+1,23):r(0,a-1);return Nh(n,s)},L=(e,t,n)=>{const i=h?h(e,t):[],a="start"===t,s=n||(a?v.value:g.value);if(e!==s.hour())return i;const o=s.minute(),l=a?r(o+1,59):r(0,o-1);return Nh(i,l)},k=(e,t,n,i)=>{const a=p?p(e,t,n):[],s="start"===n,o=i||(s?v.value:g.value),l=o.hour(),u=o.minute();if(e!==l||t!==u)return a;const c=o.second(),d=s?r(c+1,59):r(0,c-1);return Nh(a,d)},D=([e,t])=>[U(e,"start",!0,t),U(t,"end",!1,e)],{getAvailableHours:I,getAvailableMinutes:O,getAvailableSeconds:N}=wC(R,L,k),{timePickerOptions:B,getAvailableTime:U,onSetOption:z}=_C({getAvailableHours:I,getAvailableMinutes:O,getAvailableSeconds:N});return t("set-picker-option",["formatToString",e=>e?E(e)?e.map((e=>e.format(n.format))):e.format(n.format):null]),t("set-picker-option",["parseUserInput",e=>e?E(e)?e.map((e=>XS(e,n.format).locale(a.value))):XS(e,n.format).locale(a.value):null]),t("set-picker-option",["isValidValue",e=>{const t=e.map((e=>XS(e).locale(a.value))),n=D(t);return t[0].isSame(n[0])&&t[1].isSame(n[1])}]),t("set-picker-option",["handleKeydownInput",e=>{const t=e.code,{left:n,right:r,up:i,down:a}=Sg;if([n,r].includes(t)){return(e=>{const t=_.value?[0,3,6,11,14,17]:[0,3,8,11],n=["hours","minutes"].concat(_.value?["seconds"]:[]),r=(t.indexOf(T.value[0])+e+t.length)%t.length,i=t.length/2;r<i?B.start_emitSelectRange(n[r]):B.end_emitSelectRange(n[r-i])})(t===n?-1:1),void e.preventDefault()}if([i,a].includes(t)){const n=t===i?-1:1,r=T.value[0]<A.value?"start":"end";return B[`${r}_scrollDown`](n),void e.preventDefault()}}]),t("set-picker-option",["getDefaultValue",()=>{if(E(m))return m.map((e=>XS(e).locale(a.value)));const e=XS(m).locale(a.value);return[e,e.add(60,"m")]}]),t("set-picker-option",["getRangeAvailableTime",D]),(e,n)=>e.actualVisible?(fi(),yi("div",{key:0,class:l([Dt(s).b("range-picker"),Dt(o).b("panel")])},[Ti("div",{class:l(Dt(s).be("range-picker","content"))},[Ti("div",{class:l(Dt(s).be("range-picker","cell"))},[Ti("div",{class:l(Dt(s).be("range-picker","header"))},f(Dt(i)("el.datepicker.startTime")),3),Ti("div",{class:l([Dt(s).be("range-picker","body"),Dt(s).be("panel","content"),Dt(s).is("arrow",Dt(c)),{"has-seconds":Dt(_)}])},[Mi(cT,{ref:"minSpinner",role:"start","show-seconds":Dt(_),"am-pm-mode":Dt(b),"arrow-control":Dt(c),"spinner-date":Dt(g),"disabled-hours":R,"disabled-minutes":L,"disabled-seconds":k,onChange:x,onSetOption:Dt(z),onSelectRange:M},null,8,["show-seconds","am-pm-mode","arrow-control","spinner-date","onSetOption"])],2)],2),Ti("div",{class:l(Dt(s).be("range-picker","cell"))},[Ti("div",{class:l(Dt(s).be("range-picker","header"))},f(Dt(i)("el.datepicker.endTime")),3),Ti("div",{class:l([Dt(s).be("range-picker","body"),Dt(s).be("panel","content"),Dt(s).is("arrow",Dt(c)),{"has-seconds":Dt(_)}])},[Mi(cT,{ref:"maxSpinner",role:"end","show-seconds":Dt(_),"am-pm-mode":Dt(b),"arrow-control":Dt(c),"spinner-date":Dt(v),"disabled-hours":R,"disabled-minutes":L,"disabled-seconds":k,onChange:w,onSetOption:Dt(z),onSelectRange:P},null,8,["show-seconds","am-pm-mode","arrow-control","spinner-date","onSetOption"])],2)],2)],2),Ti("div",{class:l(Dt(s).be("panel","footer"))},[Ti("button",{type:"button",class:l([Dt(s).be("panel","btn"),"cancel"]),onClick:n[0]||(n[0]=e=>{t("pick",y.value,!1)})},f(Dt(i)("el.datepicker.cancel")),3),Ti("button",{type:"button",class:l([Dt(s).be("panel","btn"),"confirm"]),disabled:Dt(C),onClick:n[1]||(n[1]=e=>((e=!1)=>{t("pick",[g.value,v.value],e)})())},f(Dt(i)("el.datepicker.confirm")),11,fT)],2)],2)):Li("v-if",!0)}});var gT=J_(mT,[["__file","/home/runner/work/element-plus/element-plus/packages/components/time-picker/src/time-picker-com/panel-time-range.vue"]]);XS.extend(KS);var vT=Fn({name:"ElTimePicker",install:null,props:{...hC,isRange:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,t){const n=At(),[r,i]=e.isRange?["timerange",gT]:["time",hT],a=e=>t.emit("update:modelValue",e);return wn("ElPopperOptions",e.popperOptions),t.expose({focus:e=>{var t;null==(t=n.value)||t.handleFocusInput(e)},blur:e=>{var t;null==(t=n.value)||t.handleBlurInput(e)},handleOpen:()=>{var e;null==(e=n.value)||e.handleOpen()},handleClose:()=>{var e;null==(e=n.value)||e.handleClose()}}),()=>{var t;const s=null!=(t=e.format)?t:JS;return Mi(vC,Oi(e,{ref:n,type:r,format:s,"onUpdate:modelValue":a}),{default:e=>Mi(i,e,null)})}}});const yT=vT;yT.install=e=>{e.component(yT.name,yT)};const _T=yT,bT=pg({selectedDay:{type:Object},range:{type:Array},date:{type:Object,required:!0},hideHeader:{type:Boolean}}),xT={pick:e=>O(e)};var wT={};({get exports(){return wT},set exports(e){wT=e}}).exports=function(e,t,n){var r=t.prototype,i=function(e){return e&&(e.indexOf?e:e.s)},a=function(e,t,n,r,a){var s=e.name?e:e.$locale(),o=i(s[t]),l=i(s[n]),u=o||l.map((function(e){return e.slice(0,r)}));if(!a)return u;var c=s.weekStart;return u.map((function(e,t){return u[(t+(c||0))%7]}))},s=function(){return n.Ls[n.locale()]},o=function(e,t){return e.formats[t]||e.formats[t.toUpperCase()].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(e,t,n){return t||n.slice(1)}))},l=function(){var e=this;return{months:function(t){return t?t.format("MMMM"):a(e,"months")},monthsShort:function(t){return t?t.format("MMM"):a(e,"monthsShort","months",3)},firstDayOfWeek:function(){return e.$locale().weekStart||0},weekdays:function(t){return t?t.format("dddd"):a(e,"weekdays")},weekdaysMin:function(t){return t?t.format("dd"):a(e,"weekdaysMin","weekdays",2)},weekdaysShort:function(t){return t?t.format("ddd"):a(e,"weekdaysShort","weekdays",3)},longDateFormat:function(t){return o(e.$locale(),t)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};r.localeData=function(){return l.bind(this)()},n.localeData=function(){var e=s();return{firstDayOfWeek:function(){return e.weekStart||0},weekdays:function(){return n.weekdays()},weekdaysShort:function(){return n.weekdaysShort()},weekdaysMin:function(){return n.weekdaysMin()},months:function(){return n.months()},monthsShort:function(){return n.monthsShort()},longDateFormat:function(t){return o(e,t)},meridiem:e.meridiem,ordinal:e.ordinal}},n.months=function(){return a(s(),"months")},n.monthsShort=function(){return a(s(),"monthsShort","months",3)},n.weekdays=function(e){return a(s(),"weekdays",null,null,e)},n.weekdaysShort=function(e){return a(s(),"weekdaysShort","weekdays",3,e)},n.weekdaysMin=function(e){return a(s(),"weekdaysMin","weekdays",2,e)}};const ST=wT,CT=(e,t)=>{XS.extend(ST);const n=XS.localeData().firstDayOfWeek(),{t:r,lang:i}=Jg(),a=XS().locale(i.value),s=Ki((()=>!!e.range&&!!e.range.length)),o=Ki((()=>{let t=[];if(s.value){const[n,r]=e.range,i=nC(r.date()-n.date()+1).map((e=>({text:n.date()+e,type:"current"})));let a=i.length%7;a=0===a?0:7-a;const s=nC(a).map(((e,t)=>({text:t+1,type:"next"})));t=i.concat(s)}else{const r=e.date.startOf("month").day(),i=((e,t)=>{const n=e.subtract(1,"month").endOf("month").date();return nC(t).map(((e,r)=>n-(t-r-1)))})(e.date,(r-n+7)%7).map((e=>({text:e,type:"prev"}))),a=(e=>{const t=e.daysInMonth();return nC(t).map(((e,t)=>t+1))})(e.date).map((e=>({text:e,type:"current"})));t=[...i,...a];const s=7-(t.length%7||7),o=nC(s).map(((e,t)=>({text:t+1,type:"next"})));t=t.concat(o)}return(e=>nC(e.length/7).map((t=>{const n=7*t;return e.slice(n,n+7)})))(t)})),l=Ki((()=>{const e=n;return 0===e?Cg.map((e=>r(`el.datepicker.weeks.${e}`))):Cg.slice(e).concat(Cg.slice(0,e)).map((e=>r(`el.datepicker.weeks.${e}`)))})),u=(t,n)=>{switch(n){case"prev":return e.date.startOf("month").subtract(1,"month").date(t);case"next":return e.date.startOf("month").add(1,"month").date(t);case"current":return e.date.date(t)}};return{now:a,isInRange:s,rows:o,weekDays:l,getFormattedDate:u,handlePickDay:({text:e,type:n})=>{const r=u(e,n);t("pick",r)},getSlotData:({text:t,type:n})=>{const r=u(t,n);return{isSelected:r.isSame(e.selectedDay),type:`${n}-month`,day:r.format("YYYY-MM-DD"),date:r.toDate()}}}},TT={key:0},MT=["onClick"],ET=Fn({name:"DateTable"});var AT=J_(Fn({...ET,props:bT,emits:xT,setup(e,{expose:t,emit:n}){const r=e,{isInRange:i,now:a,rows:s,weekDays:o,getFormattedDate:u,handlePickDay:c,getSlotData:d}=CT(r,n),h=rv("calendar-table"),p=rv("calendar-day"),m=({text:e,type:t})=>{const n=[t];if("current"===t){const i=u(e,t);i.isSame(r.selectedDay,"day")&&n.push(p.is("selected")),i.isSame(a,"day")&&n.push(p.is("today"))}return n};return t({getFormattedDate:u}),(e,t)=>(fi(),yi("table",{class:l([Dt(h).b(),Dt(h).is("range",Dt(i))]),cellspacing:"0",cellpadding:"0"},[e.hideHeader?Li("v-if",!0):(fi(),yi("thead",TT,[(fi(!0),yi(li,null,mr(Dt(o),(e=>(fi(),yi("th",{key:e},f(e),1)))),128))])),Ti("tbody",null,[(fi(!0),yi(li,null,mr(Dt(s),((t,n)=>(fi(),yi("tr",{key:n,class:l({[Dt(h).e("row")]:!0,[Dt(h).em("row","hide-border")]:0===n&&e.hideHeader})},[(fi(!0),yi(li,null,mr(t,((t,n)=>(fi(),yi("td",{key:n,class:l(m(t)),onClick:e=>Dt(c)(t)},[Ti("div",{class:l(Dt(p).b())},[vr(e.$slots,"date-cell",{data:Dt(d)(t)},(()=>[Ti("span",null,f(t.text),1)]))],2)],10,MT)))),128))],2)))),128))])],2))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/calendar/src/date-table.vue"]]);const PT=pg({modelValue:{type:Date},range:{type:Array,validator:e=>E(e)&&2===e.length&&e.every((e=>R(e)))}}),RT={[Tg]:e=>R(e),[Eg]:e=>R(e)},LT=Fn({name:"ElCalendar"}),kT=Fn({...LT,props:PT,emits:RT,setup(e,{expose:t,emit:n}){const r=e,i=rv("calendar"),{calculateValidatedDateRange:a,date:s,pickDay:o,realSelectedDay:c,selectDate:d,validatedRange:h}=((e,t,n)=>{const r=Zi(),{lang:i}=Jg(),a=At(),s=XS().locale(i.value),o=Ki({get:()=>e.modelValue?u.value:a.value,set(e){if(!e)return;a.value=e;const n=e.toDate();t(Eg,n),t(Tg,n)}}),l=Ki((()=>{if(!e.range)return[];const t=e.range.map((e=>XS(e).locale(i.value))),[n,r]=t;return n.isAfter(r)?[]:n.isSame(r,"month")?f(n,r):n.add(1,"month").month()!==r.month()?[]:f(n,r)})),u=Ki((()=>e.modelValue?XS(e.modelValue).locale(i.value):o.value||(l.value.length?l.value[0][0]:s))),c=Ki((()=>u.value.subtract(1,"month").date(1))),d=Ki((()=>u.value.add(1,"month").date(1))),h=Ki((()=>u.value.subtract(1,"year").date(1))),p=Ki((()=>u.value.add(1,"year").date(1))),f=(e,t)=>{const n=e.startOf("week"),r=t.endOf("week"),i=n.get("month"),a=r.get("month");return i===a?[[n,r]]:(i+1)%12===a?((e,t)=>{const n=e.endOf("month"),r=t.startOf("month"),i=n.isSame(r,"week");return[[e,n],[(i?r.add(1,"week"):r).startOf("week"),t]]})(n,r):i+2===a||(i+1)%11===a?((e,t)=>{const n=e.endOf("month"),r=e.add(1,"month").startOf("month"),i=n.isSame(r,"week")?r.add(1,"week"):r,a=i.endOf("month"),s=t.startOf("month"),o=a.isSame(s,"week")?s.add(1,"week"):s;return[[e,n],[i.startOf("week"),a],[o.startOf("week"),t]]})(n,r):[]},m=e=>{o.value=e};return Yg({from:'"dateCell"',replacement:'"date-cell"',scope:"ElCalendar",version:"2.3.0",ref:"https://element-plus.org/en-US/component/calendar.html#slots",type:"Slot"},Ki((()=>!!r.dateCell))),{calculateValidatedDateRange:f,date:u,realSelectedDay:o,pickDay:m,selectDate:e=>{const t={"prev-month":c.value,"next-month":d.value,"prev-year":h.value,"next-year":p.value,today:s}[e];t.isSame(u.value,"day")||m(t)},validatedRange:l}})(r,n),{t:p}=Jg(),m=Ki((()=>{const e=`el.datepicker.month${s.value.format("M")}`;return`${s.value.year()} ${p("el.datepicker.year")} ${p(e)}`}));return t({selectedDay:c,pickDay:o,selectDate:d,calculateValidatedDateRange:a}),(e,t)=>(fi(),yi("div",{class:l(Dt(i).b())},[Ti("div",{class:l(Dt(i).e("header"))},[vr(e.$slots,"header",{date:Dt(m)},(()=>[Ti("div",{class:l(Dt(i).e("title"))},f(Dt(m)),3),0===Dt(h).length?(fi(),yi("div",{key:0,class:l(Dt(i).e("button-group"))},[Mi(Dt(WS),null,{default:vn((()=>[Mi(Dt(jS),{size:"small",onClick:t[0]||(t[0]=e=>Dt(d)("prev-month"))},{default:vn((()=>[Pi(f(Dt(p)("el.datepicker.prevMonth")),1)])),_:1}),Mi(Dt(jS),{size:"small",onClick:t[1]||(t[1]=e=>Dt(d)("today"))},{default:vn((()=>[Pi(f(Dt(p)("el.datepicker.today")),1)])),_:1}),Mi(Dt(jS),{size:"small",onClick:t[2]||(t[2]=e=>Dt(d)("next-month"))},{default:vn((()=>[Pi(f(Dt(p)("el.datepicker.nextMonth")),1)])),_:1})])),_:1})],2)):Li("v-if",!0)]))],2),0===Dt(h).length?(fi(),yi("div",{key:0,class:l(Dt(i).e("body"))},[Mi(AT,{date:Dt(s),"selected-day":Dt(c),onPick:Dt(o)},gr({_:2},[e.$slots["date-cell"]||e.$slots.dateCell?{name:"date-cell",fn:vn((t=>[e.$slots["date-cell"]?vr(e.$slots,"date-cell",u(Oi({key:0},t))):vr(e.$slots,"dateCell",u(Oi({key:1},t)))]))}:void 0]),1032,["date","selected-day","onPick"])],2)):(fi(),yi("div",{key:1,class:l(Dt(i).e("body"))},[(fi(!0),yi(li,null,mr(Dt(h),((t,n)=>(fi(),_i(AT,{key:n,date:t[0],"selected-day":Dt(c),range:t,"hide-header":0!==n,onPick:Dt(o)},gr({_:2},[e.$slots["date-cell"]||e.$slots.dateCell?{name:"date-cell",fn:vn((t=>[e.$slots["date-cell"]?vr(e.$slots,"date-cell",u(Oi({key:0},t))):vr(e.$slots,"dateCell",u(Oi({key:1},t)))]))}:void 0]),1032,["date","selected-day","range","hide-header","onPick"])))),128))],2))],2))}});const DT=_g(J_(kT,[["__file","/home/runner/work/element-plus/element-plus/packages/components/calendar/src/calendar.vue"]])),IT=pg({header:{type:String,default:""},bodyStyle:{type:[String,Object,Array],default:""},shadow:{type:String,values:["always","hover","never"],default:"always"}}),OT=Fn({name:"ElCard"});const NT=_g(J_(Fn({...OT,props:IT,setup(e){const t=rv("card");return(e,n)=>(fi(),yi("div",{class:l([Dt(t).b(),Dt(t).is(`${e.shadow}-shadow`)])},[e.$slots.header||e.header?(fi(),yi("div",{key:0,class:l(Dt(t).e("header"))},[vr(e.$slots,"header",{},(()=>[Pi(f(e.header),1)]))],2)):Li("v-if",!0),Ti("div",{class:l(Dt(t).e("body")),style:r(e.bodyStyle)},[vr(e.$slots,"default")],6)],2))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/card/src/card.vue"]])),BT=pg({initialIndex:{type:Number,default:0},height:{type:String,default:""},trigger:{type:String,values:["hover","click"],default:"hover"},autoplay:{type:Boolean,default:!0},interval:{type:Number,default:3e3},indicatorPosition:{type:String,values:["","none","outside"],default:""},arrow:{type:String,values:["always","hover","never"],default:"hover"},type:{type:String,values:["","card"],default:""},loop:{type:Boolean,default:!0},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},pauseOnHover:{type:Boolean,default:!0}}),UT={change:(e,t)=>[e,t].every(Bs)},zT=Symbol("carouselContextKey"),FT=(e,t,n)=>{const{children:r,addChild:i,removeChild:a}=U_(Fi(),"ElCarouselItem"),s=At(-1),o=At(null),l=At(!1),u=At(),c=Ki((()=>"never"!==e.arrow&&!Dt(p))),d=Ki((()=>r.value.some((e=>e.props.label.toString().length>0)))),h=Ki((()=>"card"===e.type)),p=Ki((()=>"vertical"===e.direction)),f=Ih((e=>{_(e)}),300,{trailing:!0}),m=Ih((t=>{!function(t){"hover"===e.trigger&&t!==s.value&&(s.value=t)}(t)}),300);function g(){o.value&&(clearInterval(o.value),o.value=null)}function v(){e.interval<=0||!e.autoplay||o.value||(o.value=setInterval((()=>y()),e.interval))}const y=()=>{s.value<r.value.length-1?s.value=s.value+1:e.loop&&(s.value=0)};function _(t){if(D(t)){const e=r.value.filter((e=>e.props.name===t));e.length>0&&(t=r.value.indexOf(e[0]))}if(t=Number(t),Number.isNaN(t)||t!==Math.floor(t))return;const n=r.value.length,i=s.value;s.value=t<0?e.loop?n-1:0:t>=n?e.loop?0:n-1:t,i===s.value&&b(i),x()}function b(e){r.value.forEach(((t,n)=>{t.translateItem(n,s.value,e)}))}function x(){g(),v()}Mn((()=>s.value),((e,n)=>{b(n),n>-1&&t("change",e,n)})),Mn((()=>e.autoplay),(e=>{e?v():g()})),Mn((()=>e.loop),(()=>{_(s.value)})),Mn((()=>e.interval),(()=>{x()})),Mn((()=>r.value),(()=>{r.value.length>0&&_(e.initialIndex)}));const w=Pt();return Kn((()=>{w.value=lo(u.value,(()=>{b()})),v()})),Qn((()=>{g(),u.value&&w.value&&w.value.stop()})),wn(zT,{root:u,isCardType:h,isVertical:p,items:r,loop:e.loop,addItem:i,removeItem:a,setActiveItem:_}),{root:u,activeIndex:s,arrowDisplay:c,hasLabel:d,hover:l,isCardType:h,items:r,handleButtonEnter:function(e){Dt(p)||r.value.forEach(((t,n)=>{e===function(e,t){var n,i,a,s;const o=Dt(r),l=o.length;if(0===l||!e.states.inStage)return!1;const u=t+1,c=t-1,d=l-1,h=o[d].states.active,p=o[0].states.active,f=null==(i=null==(n=o[u])?void 0:n.states)?void 0:i.active,m=null==(s=null==(a=o[c])?void 0:a.states)?void 0:s.active;return t===d&&p||f?"left":!!(0===t&&h||m)&&"right"}(t,n)&&(t.states.hover=!0)}))},handleButtonLeave:function(){Dt(p)||r.value.forEach((e=>{e.states.hover=!1}))},handleIndicatorClick:function(e){s.value=e},handleMouseEnter:function(){l.value=!0,e.pauseOnHover&&g()},handleMouseLeave:function(){l.value=!1,v()},setActiveItem:_,prev:function(){_(s.value-1)},next:function(){_(s.value+1)},throttledArrowClick:f,throttledIndicatorHover:m}},VT=["onMouseenter","onClick"],GT={key:0},HT=Fn({name:"ElCarousel"});var jT=J_(Fn({...HT,props:BT,emits:UT,setup(e,{expose:t,emit:n}){const i=e,{root:a,activeIndex:s,arrowDisplay:o,hasLabel:u,hover:c,isCardType:d,items:h,handleButtonEnter:p,handleButtonLeave:m,handleIndicatorClick:g,handleMouseEnter:v,handleMouseLeave:y,setActiveItem:_,prev:b,next:x,throttledArrowClick:w,throttledIndicatorHover:S}=FT(i,n),C=rv("carousel"),T=Ki((()=>{const e=[C.b(),C.m(i.direction)];return Dt(d)&&e.push(C.m("card")),e})),M=Ki((()=>{const e=[C.e("indicators"),C.em("indicators",i.direction)];return Dt(u)&&e.push(C.em("indicators","labels")),("outside"===i.indicatorPosition||Dt(d))&&e.push(C.em("indicators","outside")),e}));return t({setActiveItem:_,prev:b,next:x}),(e,t)=>(fi(),yi("div",{ref_key:"root",ref:a,class:l(Dt(T)),onMouseenter:t[6]||(t[6]=ts(((...e)=>Dt(v)&&Dt(v)(...e)),["stop"])),onMouseleave:t[7]||(t[7]=ts(((...e)=>Dt(y)&&Dt(y)(...e)),["stop"]))},[Ti("div",{class:l(Dt(C).e("container")),style:r({height:e.height})},[Dt(o)?(fi(),_i(xa,{key:0,name:"carousel-arrow-left",persisted:""},{default:vn((()=>[ar(Ti("button",{type:"button",class:l([Dt(C).e("arrow"),Dt(C).em("arrow","left")]),onMouseenter:t[0]||(t[0]=e=>Dt(p)("left")),onMouseleave:t[1]||(t[1]=(...e)=>Dt(m)&&Dt(m)(...e)),onClick:t[2]||(t[2]=ts((e=>Dt(w)(Dt(s)-1)),["stop"]))},[Mi(Dt(ib),null,{default:vn((()=>[Mi(Dt(dp))])),_:1})],34),[[is,("always"===e.arrow||Dt(c))&&(i.loop||Dt(s)>0)]])])),_:1})):Li("v-if",!0),Dt(o)?(fi(),_i(xa,{key:1,name:"carousel-arrow-right",persisted:""},{default:vn((()=>[ar(Ti("button",{type:"button",class:l([Dt(C).e("arrow"),Dt(C).em("arrow","right")]),onMouseenter:t[3]||(t[3]=e=>Dt(p)("right")),onMouseleave:t[4]||(t[4]=(...e)=>Dt(m)&&Dt(m)(...e)),onClick:t[5]||(t[5]=ts((e=>Dt(w)(Dt(s)+1)),["stop"]))},[Mi(Dt(ib),null,{default:vn((()=>[Mi(Dt(mp))])),_:1})],34),[[is,("always"===e.arrow||Dt(c))&&(i.loop||Dt(s)<Dt(h).length-1)]])])),_:1})):Li("v-if",!0),vr(e.$slots,"default")],6),"none"!==e.indicatorPosition?(fi(),yi("ul",{key:0,class:l(Dt(M))},[(fi(!0),yi(li,null,mr(Dt(h),((t,n)=>(fi(),yi("li",{key:n,class:l([Dt(C).e("indicator"),Dt(C).em("indicator",e.direction),Dt(C).is("active",n===Dt(s))]),onMouseenter:e=>Dt(S)(n),onClick:ts((e=>Dt(g)(n)),["stop"])},[Ti("button",{class:l(Dt(C).e("button"))},[Dt(u)?(fi(),yi("span",GT,f(t.props.label),1)):Li("v-if",!0)],2)],42,VT)))),128))],2)):Li("v-if",!0)],34))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/carousel/src/carousel.vue"]]);const WT=pg({name:{type:String,default:""},label:{type:[String,Number],default:""}}),YT=(e,t)=>{const n=Sn(zT),r=Fi(),i=.83,a=At(!1),s=At(0),o=At(1),l=At(!1),u=At(!1),c=At(!1),d=At(!1),{isCardType:h,isVertical:p}=n;const f=(e,t,r)=>{var a;const f=Dt(h),m=null!=(a=n.items.value.length)?a:Number.NaN,g=e===t;f||Bh(r)||(d.value=g||e===r),!g&&m>2&&n.loop&&(e=function(e,t,n){const r=n-1,i=n/2;return 0===t&&e===r?-1:t===r&&0===e?n:e<t-1&&t-e>=i?n+1:e>t+1&&e-t>=i?-2:e}(e,t,m));const v=Dt(p);l.value=g,f?(c.value=Math.round(Math.abs(e-t))<=1,s.value=function(e,t){var r;const i=(null==(r=n.root.value)?void 0:r.offsetWidth)||0;return c.value?i*(1.17*(e-t)+1)/4:e<t?-1.83*i/4:3.83*i/4}(e,t),o.value=Dt(l)?1:i):s.value=function(e,t,r){const i=n.root.value;return i?((r?i.offsetHeight:i.offsetWidth)||0)*(e-t):0}(e,t,v),u.value=!0};return Kn((()=>{n.addItem({props:e,states:pt({hover:a,translate:s,scale:o,active:l,ready:u,inStage:c,animating:d}),uid:r.uid,translateItem:f})})),er((()=>{n.removeItem(r.uid)})),{active:l,animating:d,hover:a,inStage:c,isVertical:p,translate:s,isCardType:h,scale:o,ready:u,handleItemClick:function(){if(n&&Dt(h)){const e=n.items.value.findIndex((({uid:e})=>e===r.uid));n.setActiveItem(e)}}}},$T=Fn({name:"ElCarouselItem"});var XT=J_(Fn({...$T,props:WT,setup(e){const t=e,n=rv("carousel"),{active:i,animating:a,hover:s,inStage:o,isVertical:u,translate:c,isCardType:d,scale:h,ready:p,handleItemClick:f}=YT(t),m=Ki((()=>({transform:[`${"translate"+(Dt(u)?"Y":"X")}(${Dt(c)}px)`,`scale(${Dt(h)})`].join(" ")})));return(e,t)=>ar((fi(),yi("div",{class:l([Dt(n).e("item"),Dt(n).is("active",Dt(i)),Dt(n).is("in-stage",Dt(o)),Dt(n).is("hover",Dt(s)),Dt(n).is("animating",Dt(a)),{[Dt(n).em("item","card")]:Dt(d)}]),style:r(Dt(m)),onClick:t[0]||(t[0]=(...e)=>Dt(f)&&Dt(f)(...e))},[Dt(d)?ar((fi(),yi("div",{key:0,class:l(Dt(n).e("mask"))},null,2)),[[is,!Dt(i)]]):Li("v-if",!0),vr(e.$slots,"default")],6)),[[is,Dt(p)]])}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/carousel/src/carousel-item.vue"]]);const qT=_g(jT,{CarouselItem:XT}),KT=xg(XT),ZT={modelValue:{type:[Number,String,Boolean],default:void 0},label:{type:[String,Boolean,Number,Object]},indeterminate:Boolean,disabled:Boolean,checked:Boolean,name:{type:String,default:void 0},trueLabel:{type:[String,Number],default:void 0},falseLabel:{type:[String,Number],default:void 0},id:{type:String,default:void 0},controls:{type:String,default:void 0},border:Boolean,size:z_,tabindex:[String,Number],validateEvent:{type:Boolean,default:!0}},JT={[Tg]:e=>D(e)||Bs(e)||Ns(e),change:e=>D(e)||Bs(e)||Ns(e)},QT=Symbol("checkboxGroupContextKey"),eM=(e,{model:t,isLimitExceeded:n,hasOwnLabel:r,isDisabled:i,isLabeledByFormItem:a})=>{const s=Sn(QT,void 0),{formItem:o}=pb(),{emit:l}=Fi();function u(t){var n,r;return t===e.trueLabel||!0===t?null==(n=e.trueLabel)||n:null!=(r=e.falseLabel)&&r}const c=Ki((()=>(null==s?void 0:s.validateEvent)||e.validateEvent));return Mn((()=>e.modelValue),(()=>{c.value&&(null==o||o.validate("change").catch((e=>{})))})),{handleChange:function(e){if(n.value)return;const t=e.target;l("change",u(t.checked),e)},onClickRoot:async function(s){if(!n.value&&!r.value&&!i.value&&a.value){s.composedPath().some((e=>"LABEL"===e.tagName))||(t.value=u([!1,e.falseLabel].includes(t.value)),await en(),function(e,t){l("change",u(e),t)}(t.value,s))}}}},tM=(e,t)=>{const{formItem:n}=pb(),{model:r,isGroup:i,isLimitExceeded:a}=(e=>{const t=At(!1),{emit:n}=Fi(),r=Sn(QT,void 0),i=Ki((()=>!1===Bh(r))),a=At(!1);return{model:Ki({get(){var n,a;return i.value?null==(n=null==r?void 0:r.modelValue)?void 0:n.value:null!=(a=e.modelValue)?a:t.value},set(e){var s,o;i.value&&E(e)?(a.value=void 0!==(null==(s=null==r?void 0:r.max)?void 0:s.value)&&e.length>(null==r?void 0:r.max.value),!1===a.value&&(null==(o=null==r?void 0:r.changeEvent)||o.call(r,e))):(n(Tg,e),t.value=e)}}),isGroup:i,isLimitExceeded:a}})(e),{isFocused:s,isChecked:o,checkboxButtonSize:l,checkboxSize:u,hasOwnLabel:c}=((e,t,{model:n})=>{const r=Sn(QT,void 0),i=At(!1),a=Ki((()=>{const t=n.value;return Ns(t)?t:E(t)?O(e.label)?t.map(xt).some((t=>Eh(t,e.label))):t.map(xt).includes(e.label):null!=t?t===e.trueLabel:!!t}));return{checkboxButtonSize:db(Ki((()=>{var e;return null==(e=null==r?void 0:r.size)?void 0:e.value})),{prop:!0}),isChecked:a,isFocused:i,checkboxSize:db(Ki((()=>{var e;return null==(e=null==r?void 0:r.size)?void 0:e.value}))),hasOwnLabel:Ki((()=>!(!t.default&&!e.label)))}})(e,t,{model:r}),{isDisabled:d}=(({model:e,isChecked:t})=>{const n=Sn(QT,void 0),r=Ki((()=>{var r,i;const a=null==(r=null==n?void 0:n.max)?void 0:r.value,s=null==(i=null==n?void 0:n.min)?void 0:i.value;return!Bh(a)&&e.value.length>=a&&!t.value||!Bh(s)&&e.value.length<=s&&t.value}));return{isDisabled:hb(Ki((()=>(null==n?void 0:n.disabled.value)||r.value))),isLimitDisabled:r}})({model:r,isChecked:o}),{inputId:h,isLabeledByFormItem:p}=fb(e,{formItemContext:n,disableIdGeneration:c,disableIdManagement:i}),{handleChange:f,onClickRoot:m}=eM(e,{model:r,isLimitExceeded:a,hasOwnLabel:c,isDisabled:d,isLabeledByFormItem:p});return((e,{model:t})=>{e.checked&&(E(t.value)&&!t.value.includes(e.label)?t.value.push(e.label):t.value=e.trueLabel||!0)})(e,{model:r}),{inputId:h,isLabeledByFormItem:p,isChecked:o,isDisabled:d,isFocused:s,checkboxButtonSize:l,checkboxSize:u,hasOwnLabel:c,model:r,handleChange:f,onClickRoot:m}},nM=["tabindex","role","aria-checked"],rM=["id","aria-hidden","name","tabindex","disabled","true-value","false-value"],iM=["id","aria-hidden","disabled","value","name","tabindex"],aM=Fn({name:"ElCheckbox"});var sM=J_(Fn({...aM,props:ZT,emits:JT,setup(e){const t=e,n=Zi(),{inputId:r,isLabeledByFormItem:i,isChecked:a,isDisabled:s,isFocused:o,checkboxSize:u,hasOwnLabel:c,model:d,handleChange:h,onClickRoot:p}=tM(t,n),m=rv("checkbox"),g=Ki((()=>[m.b(),m.m(u.value),m.is("disabled",s.value),m.is("bordered",t.border),m.is("checked",a.value)])),v=Ki((()=>[m.e("input"),m.is("disabled",s.value),m.is("checked",a.value),m.is("indeterminate",t.indeterminate),m.is("focus",o.value)]));return(e,t)=>(fi(),_i(dr(!Dt(c)&&Dt(i)?"span":"label"),{class:l(Dt(g)),"aria-controls":e.indeterminate?e.controls:null,onClick:Dt(p)},{default:vn((()=>[Ti("span",{class:l(Dt(v)),tabindex:e.indeterminate?0:void 0,role:e.indeterminate?"checkbox":void 0,"aria-checked":e.indeterminate?"mixed":void 0},[e.trueLabel||e.falseLabel?ar((fi(),yi("input",{key:0,id:Dt(r),"onUpdate:modelValue":t[0]||(t[0]=e=>Et(d)?d.value=e:null),class:l(Dt(m).e("original")),type:"checkbox","aria-hidden":e.indeterminate?"true":"false",name:e.name,tabindex:e.tabindex,disabled:Dt(s),"true-value":e.trueLabel,"false-value":e.falseLabel,onChange:t[1]||(t[1]=(...e)=>Dt(h)&&Dt(h)(...e)),onFocus:t[2]||(t[2]=e=>o.value=!0),onBlur:t[3]||(t[3]=e=>o.value=!1)},null,42,rM)),[[Xa,Dt(d)]]):ar((fi(),yi("input",{key:1,id:Dt(r),"onUpdate:modelValue":t[4]||(t[4]=e=>Et(d)?d.value=e:null),class:l(Dt(m).e("original")),type:"checkbox","aria-hidden":e.indeterminate?"true":"false",disabled:Dt(s),value:e.label,name:e.name,tabindex:e.tabindex,onChange:t[5]||(t[5]=(...e)=>Dt(h)&&Dt(h)(...e)),onFocus:t[6]||(t[6]=e=>o.value=!0),onBlur:t[7]||(t[7]=e=>o.value=!1)},null,42,iM)),[[Xa,Dt(d)]]),Ti("span",{class:l(Dt(m).e("inner"))},null,2)],10,nM),Dt(c)?(fi(),yi("span",{key:0,class:l(Dt(m).e("label"))},[vr(e.$slots,"default"),e.$slots.default?Li("v-if",!0):(fi(),yi(li,{key:0},[Pi(f(e.label),1)],64))],2)):Li("v-if",!0)])),_:3},8,["class","aria-controls","onClick"]))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/checkbox/src/checkbox.vue"]]);const oM=["name","tabindex","disabled","true-value","false-value"],lM=["name","tabindex","disabled","value"],uM=Fn({name:"ElCheckboxButton"});var cM=J_(Fn({...uM,props:ZT,emits:JT,setup(e){const t=e,n=Zi(),{isFocused:i,isChecked:a,isDisabled:s,checkboxButtonSize:o,model:u,handleChange:c}=tM(t,n),d=Sn(QT,void 0),h=rv("checkbox"),p=Ki((()=>{var e,t,n,r;const i=null!=(t=null==(e=null==d?void 0:d.fill)?void 0:e.value)?t:"";return{backgroundColor:i,borderColor:i,color:null!=(r=null==(n=null==d?void 0:d.textColor)?void 0:n.value)?r:"",boxShadow:i?`-1px 0 0 0 ${i}`:void 0}})),m=Ki((()=>[h.b("button"),h.bm("button",o.value),h.is("disabled",s.value),h.is("checked",a.value),h.is("focus",i.value)]));return(e,t)=>(fi(),yi("label",{class:l(Dt(m))},[e.trueLabel||e.falseLabel?ar((fi(),yi("input",{key:0,"onUpdate:modelValue":t[0]||(t[0]=e=>Et(u)?u.value=e:null),class:l(Dt(h).be("button","original")),type:"checkbox",name:e.name,tabindex:e.tabindex,disabled:Dt(s),"true-value":e.trueLabel,"false-value":e.falseLabel,onChange:t[1]||(t[1]=(...e)=>Dt(c)&&Dt(c)(...e)),onFocus:t[2]||(t[2]=e=>i.value=!0),onBlur:t[3]||(t[3]=e=>i.value=!1)},null,42,oM)),[[Xa,Dt(u)]]):ar((fi(),yi("input",{key:1,"onUpdate:modelValue":t[4]||(t[4]=e=>Et(u)?u.value=e:null),class:l(Dt(h).be("button","original")),type:"checkbox",name:e.name,tabindex:e.tabindex,disabled:Dt(s),value:e.label,onChange:t[5]||(t[5]=(...e)=>Dt(c)&&Dt(c)(...e)),onFocus:t[6]||(t[6]=e=>i.value=!0),onBlur:t[7]||(t[7]=e=>i.value=!1)},null,42,lM)),[[Xa,Dt(u)]]),e.$slots.default||e.label?(fi(),yi("span",{key:2,class:l(Dt(h).be("button","inner")),style:r(Dt(a)?Dt(p):void 0)},[vr(e.$slots,"default",{},(()=>[Pi(f(e.label),1)]))],6)):Li("v-if",!0)],2))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/checkbox/src/checkbox-button.vue"]]);const dM=pg({modelValue:{type:Array,default:()=>[]},disabled:Boolean,min:Number,max:Number,size:z_,label:String,fill:String,textColor:String,tag:{type:String,default:"div"},validateEvent:{type:Boolean,default:!0}}),hM={[Tg]:e=>E(e),change:e=>E(e)},pM=Fn({name:"ElCheckboxGroup"});var fM=J_(Fn({...pM,props:dM,emits:hM,setup(e,{emit:t}){const n=e,r=rv("checkbox"),{formItem:i}=pb(),{inputId:a,isLabeledByFormItem:s}=fb(n,{formItemContext:i}),o=async e=>{t(Tg,e),await en(),t("change",e)},u=Ki({get:()=>n.modelValue,set(e){o(e)}});return wn(QT,{...Dh(Nt(n),["size","min","max","disabled","validateEvent","fill","textColor"]),modelValue:u,changeEvent:o}),Mn((()=>n.modelValue),(()=>{n.validateEvent&&(null==i||i.validate("change").catch((e=>{})))})),(e,t)=>{var n;return fi(),_i(dr(e.tag),{id:Dt(a),class:l(Dt(r).b("group")),role:"group","aria-label":Dt(s)?void 0:e.label||"checkbox-group","aria-labelledby":Dt(s)?null==(n=Dt(i))?void 0:n.labelId:void 0},{default:vn((()=>[vr(e.$slots,"default")])),_:3},8,["id","class","aria-label","aria-labelledby"])}}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/checkbox/src/checkbox-group.vue"]]);const mM=_g(sM,{CheckboxButton:cM,CheckboxGroup:fM}),gM=xg(cM),vM=xg(fM),yM=pg({size:z_,disabled:Boolean,label:{type:[String,Number,Boolean],default:""}}),_M=pg({...yM,modelValue:{type:[String,Number,Boolean],default:""},name:{type:String,default:""},border:Boolean}),bM={[Tg]:e=>D(e)||Bs(e)||Ns(e),[Mg]:e=>D(e)||Bs(e)||Ns(e)},xM=Symbol("radioGroupKey"),wM=(e,t)=>{const n=At(),r=Sn(xM,void 0),i=Ki((()=>!!r)),a=Ki({get:()=>i.value?r.modelValue:e.modelValue,set(a){i.value?r.changeEvent(a):t&&t(Tg,a),n.value.checked=e.modelValue===e.label}}),s=db(Ki((()=>null==r?void 0:r.size))),o=hb(Ki((()=>null==r?void 0:r.disabled))),l=At(!1),u=Ki((()=>o.value||i.value&&a.value!==e.label?-1:0));return{radioRef:n,isGroup:i,radioGroup:r,focus:l,size:s,disabled:o,tabIndex:u,modelValue:a}},SM=["value","name","disabled"],CM=Fn({name:"ElRadio"});var TM=J_(Fn({...CM,props:_M,emits:bM,setup(e,{emit:t}){const n=e,r=rv("radio"),{radioRef:i,radioGroup:a,focus:s,size:o,disabled:u,modelValue:c}=wM(n,t);function d(){en((()=>t("change",c.value)))}return(e,t)=>{var n;return fi(),yi("label",{class:l([Dt(r).b(),Dt(r).is("disabled",Dt(u)),Dt(r).is("focus",Dt(s)),Dt(r).is("bordered",e.border),Dt(r).is("checked",Dt(c)===e.label),Dt(r).m(Dt(o))])},[Ti("span",{class:l([Dt(r).e("input"),Dt(r).is("disabled",Dt(u)),Dt(r).is("checked",Dt(c)===e.label)])},[ar(Ti("input",{ref_key:"radioRef",ref:i,"onUpdate:modelValue":t[0]||(t[0]=e=>Et(c)?c.value=e:null),class:l(Dt(r).e("original")),value:e.label,name:e.name||(null==(n=Dt(a))?void 0:n.name),disabled:Dt(u),type:"radio",onFocus:t[1]||(t[1]=e=>s.value=!0),onBlur:t[2]||(t[2]=e=>s.value=!1),onChange:d},null,42,SM),[[Ka,Dt(c)]]),Ti("span",{class:l(Dt(r).e("inner"))},null,2)],2),Ti("span",{class:l(Dt(r).e("label")),onKeydown:t[3]||(t[3]=ts((()=>{}),["stop"]))},[vr(e.$slots,"default",{},(()=>[Pi(f(e.label),1)]))],34)],2)}}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/radio/src/radio.vue"]]);const MM=pg({...yM,name:{type:String,default:""}}),EM=["value","name","disabled"],AM=Fn({name:"ElRadioButton"});var PM=J_(Fn({...AM,props:MM,setup(e){const t=e,n=rv("radio"),{radioRef:i,focus:a,size:s,disabled:o,modelValue:u,radioGroup:c}=wM(t),d=Ki((()=>({backgroundColor:(null==c?void 0:c.fill)||"",borderColor:(null==c?void 0:c.fill)||"",boxShadow:(null==c?void 0:c.fill)?`-1px 0 0 0 ${c.fill}`:"",color:(null==c?void 0:c.textColor)||""})));return(e,t)=>{var h;return fi(),yi("label",{class:l([Dt(n).b("button"),Dt(n).is("active",Dt(u)===e.label),Dt(n).is("disabled",Dt(o)),Dt(n).is("focus",Dt(a)),Dt(n).bm("button",Dt(s))])},[ar(Ti("input",{ref_key:"radioRef",ref:i,"onUpdate:modelValue":t[0]||(t[0]=e=>Et(u)?u.value=e:null),class:l(Dt(n).be("button","original-radio")),value:e.label,type:"radio",name:e.name||(null==(h=Dt(c))?void 0:h.name),disabled:Dt(o),onFocus:t[1]||(t[1]=e=>a.value=!0),onBlur:t[2]||(t[2]=e=>a.value=!1)},null,42,EM),[[Ka,Dt(u)]]),Ti("span",{class:l(Dt(n).be("button","inner")),style:r(Dt(u)===e.label?Dt(d):{}),onKeydown:t[3]||(t[3]=ts((()=>{}),["stop"]))},[vr(e.$slots,"default",{},(()=>[Pi(f(e.label),1)]))],38)],2)}}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/radio/src/radio-button.vue"]]);const RM=pg({id:{type:String,default:void 0},size:z_,disabled:Boolean,modelValue:{type:[String,Number,Boolean],default:""},fill:{type:String,default:""},label:{type:String,default:void 0},textColor:{type:String,default:""},name:{type:String,default:void 0},validateEvent:{type:Boolean,default:!0}}),LM=bM,kM=["id","aria-label","aria-labelledby"],DM=Fn({name:"ElRadioGroup"}),IM=Fn({...DM,props:RM,emits:LM,setup(e,{emit:t}){const n=e,r=rv("radio"),i=Iy(),a=At(),{formItem:s}=pb(),{inputId:o,isLabeledByFormItem:u}=fb(n,{formItemContext:s});Kn((()=>{const e=a.value.querySelectorAll("[type=radio]"),t=e[0];!Array.from(e).some((e=>e.checked))&&t&&(t.tabIndex=0)}));const c=Ki((()=>n.name||i.value));return wn(xM,pt({...Nt(n),changeEvent:e=>{t(Tg,e),en((()=>t("change",e)))},name:c})),Mn((()=>n.modelValue),(()=>{n.validateEvent&&(null==s||s.validate("change").catch((e=>{})))})),(e,t)=>(fi(),yi("div",{id:Dt(o),ref_key:"radioGroupRef",ref:a,class:l(Dt(r).b("group")),role:"radiogroup","aria-label":Dt(u)?void 0:e.label||"radio-group","aria-labelledby":Dt(u)?Dt(s).labelId:void 0},[vr(e.$slots,"default")],10,kM))}});var OM=J_(IM,[["__file","/home/runner/work/element-plus/element-plus/packages/components/radio/src/radio-group.vue"]]);const NM=_g(TM,{RadioButton:PM,RadioGroup:OM}),BM=xg(OM),UM=xg(PM);var zM=Fn({name:"NodeContent",setup:()=>({ns:rv("cascader-node")}),render(){const{ns:e}=this,{node:t,panel:n}=this.$parent,{data:r,label:i}=t,{renderLabelFn:a}=n;return ea("span",{class:e.e("label")},a?a({node:t,data:r}):i)}});const FM=Symbol(),VM=Fn({name:"ElCascaderNode",components:{ElCheckbox:mM,ElRadio:NM,NodeContent:zM,ElIcon:ib,Check:zp,Loading:Gf,ArrowRight:mp},props:{node:{type:Object,required:!0},menuId:String},emits:["expand"],setup(e,{emit:t}){const n=Sn(FM),r=rv("cascader-node"),i=Ki((()=>n.isHoverMenu)),a=Ki((()=>n.config.multiple)),s=Ki((()=>n.config.checkStrictly)),o=Ki((()=>{var e;return null==(e=n.checkedNodes[0])?void 0:e.uid})),l=Ki((()=>e.node.isDisabled)),u=Ki((()=>e.node.isLeaf)),c=Ki((()=>s.value&&!u.value||!l.value)),d=Ki((()=>p(n.expandingNode))),h=Ki((()=>s.value&&n.checkedNodes.some(p))),p=t=>{var n;const{level:r,uid:i}=e.node;return(null==(n=null==t?void 0:t.pathNodes[r-1])?void 0:n.uid)===i},f=()=>{d.value||n.expandNode(e.node)},m=t=>{const{node:r}=e;t!==r.checked&&n.handleCheckChange(r,t)},g=()=>{n.lazyLoad(e.node,(()=>{u.value||f()}))},v=()=>{const{node:t}=e;c.value&&!t.loading&&(t.loaded?f():g())},y=t=>{e.node.loaded?(m(t),!s.value&&f()):g()};return{panel:n,isHoverMenu:i,multiple:a,checkStrictly:s,checkedNodeId:o,isDisabled:l,isLeaf:u,expandable:c,inExpandingPath:d,inCheckedPath:h,ns:r,handleHoverExpand:e=>{i.value&&(v(),!u.value&&t("expand",e))},handleExpand:v,handleClick:()=>{i.value&&!u.value||(!u.value||l.value||s.value||a.value?v():y(!0))},handleCheck:y,handleSelectCheck:t=>{s.value?(m(t),e.node.loaded&&f()):y(t)}}}}),GM=["id","aria-haspopup","aria-owns","aria-expanded","tabindex"],HM=Ti("span",null,null,-1);const jM=Fn({name:"ElCascaderMenu",components:{Loading:Gf,ElIcon:ib,ElScrollbar:Tx,ElCascaderNode:J_(VM,[["render",function(e,t,n,r,i,a){const s=ur("el-checkbox"),o=ur("el-radio"),u=ur("check"),c=ur("el-icon"),d=ur("node-content"),h=ur("loading"),p=ur("arrow-right");return fi(),yi("li",{id:`${e.menuId}-${e.node.uid}`,role:"menuitem","aria-haspopup":!e.isLeaf,"aria-owns":e.isLeaf?null:e.menuId,"aria-expanded":e.inExpandingPath,tabindex:e.expandable?-1:void 0,class:l([e.ns.b(),e.ns.is("selectable",e.checkStrictly),e.ns.is("active",e.node.checked),e.ns.is("disabled",!e.expandable),e.inExpandingPath&&"in-active-path",e.inCheckedPath&&"in-checked-path"]),onMouseenter:t[2]||(t[2]=(...t)=>e.handleHoverExpand&&e.handleHoverExpand(...t)),onFocus:t[3]||(t[3]=(...t)=>e.handleHoverExpand&&e.handleHoverExpand(...t)),onClick:t[4]||(t[4]=(...t)=>e.handleClick&&e.handleClick(...t))},[Li(" prefix "),e.multiple?(fi(),_i(s,{key:0,"model-value":e.node.checked,indeterminate:e.node.indeterminate,disabled:e.isDisabled,onClick:t[0]||(t[0]=ts((()=>{}),["stop"])),"onUpdate:modelValue":e.handleSelectCheck},null,8,["model-value","indeterminate","disabled","onUpdate:modelValue"])):e.checkStrictly?(fi(),_i(o,{key:1,"model-value":e.checkedNodeId,label:e.node.uid,disabled:e.isDisabled,"onUpdate:modelValue":e.handleSelectCheck,onClick:t[1]||(t[1]=ts((()=>{}),["stop"]))},{default:vn((()=>[Li("\n        Add an empty element to avoid render label,\n        do not use empty fragment here for https://github.com/vuejs/vue-next/pull/2485\n      "),HM])),_:1},8,["model-value","label","disabled","onUpdate:modelValue"])):e.isLeaf&&e.node.checked?(fi(),_i(c,{key:2,class:l(e.ns.e("prefix"))},{default:vn((()=>[Mi(u)])),_:1},8,["class"])):Li("v-if",!0),Li(" content "),Mi(d),Li(" postfix "),e.isLeaf?Li("v-if",!0):(fi(),yi(li,{key:3},[e.node.loading?(fi(),_i(c,{key:0,class:l([e.ns.is("loading"),e.ns.e("postfix")])},{default:vn((()=>[Mi(h)])),_:1},8,["class"])):(fi(),_i(c,{key:1,class:l(["arrow-right",e.ns.e("postfix")])},{default:vn((()=>[Mi(p)])),_:1},8,["class"]))],64))],42,GM)}],["__file","/home/runner/work/element-plus/element-plus/packages/components/cascader-panel/src/node.vue"]])},props:{nodes:{type:Array,required:!0},index:{type:Number,required:!0}},setup(e){const t=Fi(),n=rv("cascader-menu"),{t:r}=Jg(),i=Gg();let a=null,s=null;const o=Sn(FM),l=At(null),u=Ki((()=>!e.nodes.length)),c=Ki((()=>!o.initialLoaded)),d=Ki((()=>`cascader-menu-${i}-${e.index}`)),h=()=>{s&&(clearTimeout(s),s=null)},p=()=>{l.value&&(l.value.innerHTML="",h())};return{ns:n,panel:o,hoverZone:l,isEmpty:u,isLoading:c,menuId:d,t:r,handleExpand:e=>{a=e.target},handleMouseMove:e=>{if(o.isHoverMenu&&a&&l.value)if(a.contains(e.target)){h();const n=t.vnode.el,{left:r}=n.getBoundingClientRect(),{offsetWidth:i,offsetHeight:s}=n,o=e.clientX-r,u=a.offsetTop,c=u+a.offsetHeight;l.value.innerHTML=`\n          <path style="pointer-events: auto;" fill="transparent" d="M${o} ${u} L${i} 0 V${u} Z" />\n          <path style="pointer-events: auto;" fill="transparent" d="M${o} ${c} L${i} ${s} V${c} Z" />\n        `}else s||(s=window.setTimeout(p,o.config.hoverThreshold))},clearHoverZone:p}}});var WM=J_(jM,[["render",function(e,t,n,r,i,a){const s=ur("el-cascader-node"),o=ur("loading"),u=ur("el-icon"),c=ur("el-scrollbar");return fi(),_i(c,{key:e.menuId,tag:"ul",role:"menu",class:l(e.ns.b()),"wrap-class":e.ns.e("wrap"),"view-class":[e.ns.e("list"),e.ns.is("empty",e.isEmpty)],onMousemove:e.handleMouseMove,onMouseleave:e.clearHoverZone},{default:vn((()=>{var t;return[(fi(!0),yi(li,null,mr(e.nodes,(t=>(fi(),_i(s,{key:t.uid,node:t,"menu-id":e.menuId,onExpand:e.handleExpand},null,8,["node","menu-id","onExpand"])))),128)),e.isLoading?(fi(),yi("div",{key:0,class:l(e.ns.e("empty-text"))},[Mi(u,{size:"14",class:l(e.ns.is("loading"))},{default:vn((()=>[Mi(o)])),_:1},8,["class"]),Pi(" "+f(e.t("el.cascader.loading")),1)],2)):e.isEmpty?(fi(),yi("div",{key:1,class:l(e.ns.e("empty-text"))},f(e.t("el.cascader.noData")),3)):(null==(t=e.panel)?void 0:t.isHoverMenu)?(fi(),yi("svg",{key:2,ref:"hoverZone",class:l(e.ns.e("hover-zone"))},null,2)):Li("v-if",!0)]})),_:1},8,["class","wrap-class","view-class","onMousemove","onMouseleave"])}],["__file","/home/runner/work/element-plus/element-plus/packages/components/cascader-panel/src/menu.vue"]]);let YM=0;let $M=class e{constructor(t,n,r,i=!1){this.data=t,this.config=n,this.parent=r,this.root=i,this.uid=YM++,this.checked=!1,this.indeterminate=!1,this.loading=!1;const{value:a,label:s,children:o}=n,l=t[o],u=(e=>{const t=[e];let{parent:n}=e;for(;n;)t.unshift(n),n=n.parent;return t})(this);this.level=i?0:r?r.level+1:1,this.value=t[a],this.label=t[s],this.pathNodes=u,this.pathValues=u.map((e=>e.value)),this.pathLabels=u.map((e=>e.label)),this.childrenData=l,this.children=(l||[]).map((t=>new e(t,n,this))),this.loaded=!n.lazy||this.isLeaf||!Uh(l)}get isDisabled(){const{data:e,parent:t,config:n}=this,{disabled:r,checkStrictly:i}=n;return(k(r)?r(e,this):!!e[r])||!i&&(null==t?void 0:t.isDisabled)}get isLeaf(){const{data:e,config:t,childrenData:n,loaded:r}=this,{lazy:i,leaf:a}=t,s=k(a)?a(e,this):e[a];return Bh(s)?!(i&&!r)&&!(Array.isArray(n)&&n.length):!!s}get valueByOption(){return this.config.emitPath?this.pathValues:this.value}appendChild(t){const{childrenData:n,children:r}=this,i=new e(t,this.config,this);return Array.isArray(n)?n.push(t):this.childrenData=[t],r.push(i),i}calcText(e,t){const n=e?this.pathLabels.join(t):this.label;return this.text=n,n}broadcast(e,...t){const n=`onParent${Vh(e)}`;this.children.forEach((r=>{r&&(r.broadcast(e,...t),r[n]&&r[n](...t))}))}emit(e,...t){const{parent:n}=this,r=`onChild${Vh(e)}`;n&&(n[r]&&n[r](...t),n.emit(e,...t))}onParentCheck(e){this.isDisabled||this.setCheckState(e)}onChildCheck(){const{children:e}=this,t=e.filter((e=>!e.isDisabled)),n=!!t.length&&t.every((e=>e.checked));this.setCheckState(n)}setCheckState(e){const t=this.children.length,n=this.children.reduce(((e,t)=>e+(t.checked?1:t.indeterminate?.5:0)),0);this.checked=this.loaded&&this.children.filter((e=>!e.isDisabled)).every((e=>e.loaded&&e.checked))&&e,this.indeterminate=this.loaded&&n!==t&&n>0}doCheck(e){if(this.checked===e)return;const{checkStrictly:t,multiple:n}=this.config;t||!n?this.checked=e:(this.broadcast("check",e),this.setCheckState(e),this.emit("check"))}};const XM=(e,t)=>e.reduce(((e,n)=>(n.isLeaf?e.push(n):(!t&&e.push(n),e=e.concat(XM(n.children,t))),e)),[]);class qM{constructor(e,t){this.config=t;const n=(e||[]).map((e=>new $M(e,this.config)));this.nodes=n,this.allNodes=XM(n,!1),this.leafNodes=XM(n,!0)}getNodes(){return this.nodes}getFlattedNodes(e){return e?this.leafNodes:this.allNodes}appendNode(e,t){const n=t?t.appendChild(e):new $M(e,this.config);t||this.nodes.push(n),this.allNodes.push(n),n.isLeaf&&this.leafNodes.push(n)}appendNodes(e,t){e.forEach((e=>this.appendNode(e,t)))}getNodeByValue(e,t=!1){if(!e&&0!==e)return null;return this.getFlattedNodes(t).find((t=>Eh(t.value,e)||Eh(t.pathValues,e)))||null}getSameNode(e){if(!e)return null;return this.getFlattedNodes(!1).find((({value:t,level:n})=>Eh(e.value,t)&&e.level===n))||null}}const KM=pg({modelValue:{type:[Number,String,Array]},options:{type:Array,default:()=>[]},props:{type:Object,default:()=>({})}}),ZM={expandTrigger:"click",multiple:!1,checkStrictly:!1,emitPath:!0,lazy:!1,lazyLoad:y,value:"value",label:"label",children:"children",leaf:"leaf",disabled:"disabled",hoverThreshold:500},JM=e=>{if(!e)return 0;const t=e.id.split("-");return Number(t[t.length-2])},QM=Fn({name:"ElCascaderPanel",components:{ElCascaderMenu:WM},props:{...KM,border:{type:Boolean,default:!0},renderLabel:Function},emits:[Tg,Mg,"close","expand-change"],setup(e,{emit:t,slots:n}){let r=!1;const i=rv("cascader"),a=(e=>Ki((()=>({...ZM,...e.props}))))(e);let s=null;const o=At(!0),l=At([]),u=At(null),c=At([]),d=At(null),h=At([]),p=Ki((()=>"hover"===a.value.expandTrigger)),f=Ki((()=>e.renderLabel||n.default)),m=(e,t)=>{const n=a.value;(e=e||new $M({},n,void 0,!0)).loading=!0;n.lazyLoad(e,(n=>{const r=e,i=r.root?null:r;n&&(null==s||s.appendNodes(n,i)),r.loading=!1,r.loaded=!0,r.childrenData=r.childrenData||[],t&&t(n)}))},g=(e,n)=>{var r;const{level:i}=e,a=c.value.slice(0,i);let s;e.isLeaf?s=e.pathNodes[i-2]:(s=e,a.push(e.children)),(null==(r=d.value)?void 0:r.uid)!==(null==s?void 0:s.uid)&&(d.value=e,c.value=a,!n&&t("expand-change",(null==e?void 0:e.pathValues)||[]))},v=(e,n,i=!0)=>{const{checkStrictly:s,multiple:o}=a.value,l=h.value[0];r=!0,!o&&(null==l||l.doCheck(!1)),e.doCheck(n),x(),i&&!o&&!s&&t("close"),!i&&!o&&!s&&y(e)},y=e=>{e&&(e=e.parent,y(e),e&&g(e))},_=e=>null==s?void 0:s.getFlattedNodes(e),b=e=>{var t;return null==(t=_(e))?void 0:t.filter((e=>!1!==e.checked))},x=()=>{var e;const{checkStrictly:t,multiple:n}=a.value,r=((e,t)=>{const n=t.slice(0),r=n.map((e=>e.uid)),i=e.reduce(((e,t)=>{const i=r.indexOf(t.uid);return i>-1&&(e.push(t),n.splice(i,1),r.splice(i,1)),e}),[]);return i.push(...n),i})(h.value,b(!t)),i=r.map((e=>e.valueByOption));h.value=r,u.value=n?i:null!=(e=i[0])?e:null},w=(t=!1,n=!1)=>{const{modelValue:i}=e,{lazy:l,multiple:c,checkStrictly:d}=a.value,h=!d;var p;if(o.value&&!r&&(n||!Eh(i,u.value)))if(l&&!t){const e=Ng(null!=(p=Bg(i))&&p.length?Wu(p,1/0):[]).map((e=>null==s?void 0:s.getNodeByValue(e))).filter((e=>!!e&&!e.loaded&&!e.loading));e.length?e.forEach((e=>{m(e,(()=>w(!1,n)))})):w(!0,n)}else{const e=c?Bg(i):[i],t=Ng(e.map((e=>null==s?void 0:s.getNodeByValue(e,h))));S(t,n),u.value=yd(i)}},S=(e,t=!0)=>{const{checkStrictly:n}=a.value,r=h.value,i=e.filter((e=>!!e&&(n||e.isLeaf))),o=null==s?void 0:s.getSameNode(d.value),l=t&&o||i[0];l?l.pathNodes.forEach((e=>g(e,!0))):d.value=null,r.forEach((e=>e.doCheck(!1))),i.forEach((e=>e.doCheck(!0))),h.value=i,en(C)},C=()=>{Os&&l.value.forEach((e=>{const t=null==e?void 0:e.$el;if(t){np(t.querySelector(`.${i.namespace.value}-scrollbar__wrap`),t.querySelector(`.${i.b("node")}.${i.is("active")}`)||t.querySelector(`.${i.b("node")}.in-active-path`))}}))};return wn(FM,pt({config:a,expandingNode:d,checkedNodes:h,isHoverMenu:p,initialLoaded:o,renderLabelFn:f,lazyLoad:m,expandNode:g,handleCheckChange:v})),Mn([a,()=>e.options],(()=>{const{options:t}=e,n=a.value;r=!1,s=new qM(t,n),c.value=[s.getNodes()],n.lazy&&Uh(e.options)?(o.value=!1,m(void 0,(e=>{e&&(s=new qM(e,n),c.value=[s.getNodes()]),o.value=!0,w(!1,!0)}))):w(!1,!0)}),{deep:!0,immediate:!0}),Mn((()=>e.modelValue),(()=>{r=!1,w()}),{deep:!0}),Mn((()=>u.value),(n=>{Eh(n,e.modelValue)||(t(Tg,n),t(Mg,n))})),Zn((()=>l.value=[])),Kn((()=>!Uh(e.modelValue)&&w())),{ns:i,menuList:l,menus:c,checkedNodes:h,handleKeyDown:e=>{const t=e.target,{code:n}=e;switch(n){case Sg.up:case Sg.down:{e.preventDefault();const r=n===Sg.up?-1:1;Ss(ws(t,r,`.${i.b("node")}[tabindex="-1"]`));break}case Sg.left:{e.preventDefault();const n=l.value[JM(t)-1],r=null==n?void 0:n.$el.querySelector(`.${i.b("node")}[aria-expanded="true"]`);Ss(r);break}case Sg.right:{e.preventDefault();const n=l.value[JM(t)+1],r=null==n?void 0:n.$el.querySelector(`.${i.b("node")}[tabindex="-1"]`);Ss(r);break}case Sg.enter:(e=>{if(!e)return;const t=e.querySelector("input");t?t.click():xs(e)&&e.click()})(t)}},handleCheckChange:v,getFlattedNodes:_,getCheckedNodes:b,clearCheckedNodes:()=>{h.value.forEach((e=>e.doCheck(!1))),x(),c.value=c.value.slice(0,1),d.value=null,t("expand-change",[])},calculateCheckedValue:x,scrollToExpandingNode:C}}});var eE=J_(QM,[["render",function(e,t,n,r,i,a){const s=ur("el-cascader-menu");return fi(),yi("div",{class:l([e.ns.b("panel"),e.ns.is("bordered",e.border)]),onKeydown:t[0]||(t[0]=(...t)=>e.handleKeyDown&&e.handleKeyDown(...t))},[(fi(!0),yi(li,null,mr(e.menus,((t,n)=>(fi(),_i(s,{key:n,ref_for:!0,ref:t=>e.menuList[n]=t,index:n,nodes:[...t]},null,8,["index","nodes"])))),128))],34)}],["__file","/home/runner/work/element-plus/element-plus/packages/components/cascader-panel/src/index.vue"]]);eE.install=e=>{e.component(eE.name,eE)};const tE=eE,nE=tE,rE=pg({closable:Boolean,type:{type:String,values:["success","info","warning","danger",""],default:""},hit:Boolean,disableTransitions:Boolean,color:{type:String,default:""},size:{type:String,values:Pg,default:""},effect:{type:String,values:["dark","light","plain"],default:"light"},round:Boolean}),iE={close:e=>e instanceof MouseEvent,click:e=>e instanceof MouseEvent},aE=Fn({name:"ElTag"});const sE=_g(J_(Fn({...aE,props:rE,emits:iE,setup(e,{emit:t}){const n=e,i=db(),a=rv("tag"),s=Ki((()=>{const{type:e,hit:t,effect:r,closable:s,round:o}=n;return[a.b(),a.is("closable",s),a.m(e),a.m(i.value),a.m(r),a.is("hit",t),a.is("round",o)]})),o=e=>{t("close",e)},u=e=>{t("click",e)};return(e,t)=>e.disableTransitions?(fi(),yi("span",{key:0,class:l(Dt(s)),style:r({backgroundColor:e.color}),onClick:u},[Ti("span",{class:l(Dt(a).e("content"))},[vr(e.$slots,"default")],2),e.closable?(fi(),_i(Dt(ib),{key:0,class:l(Dt(a).e("close")),onClick:ts(o,["stop"])},{default:vn((()=>[Mi(Dt(cf))])),_:1},8,["class","onClick"])):Li("v-if",!0)],6)):(fi(),_i(xa,{key:1,name:`${Dt(a).namespace.value}-zoom-in-center`,appear:""},{default:vn((()=>[Ti("span",{class:l(Dt(s)),style:r({backgroundColor:e.color}),onClick:u},[Ti("span",{class:l(Dt(a).e("content"))},[vr(e.$slots,"default")],2),e.closable?(fi(),_i(Dt(ib),{key:0,class:l(Dt(a).e("close")),onClick:ts(o,["stop"])},{default:vn((()=>[Mi(Dt(cf))])),_:1},8,["class","onClick"])):Li("v-if",!0)],6)])),_:3},8,["name"]))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/tag/src/tag.vue"]])),oE=pg({...KM,size:z_,placeholder:String,disabled:Boolean,clearable:Boolean,filterable:Boolean,filterMethod:{type:Function,default:(e,t)=>e.text.includes(t)},separator:{type:String,default:" / "},showAllLevels:{type:Boolean,default:!0},collapseTags:Boolean,collapseTagsTooltip:{type:Boolean,default:!1},debounce:{type:Number,default:300},beforeFilter:{type:Function,default:()=>!0},popperClass:{type:String,default:""},teleported:_w.teleported,tagType:{...rE.type,default:"info"},validateEvent:{type:Boolean,default:!0}}),lE={[Tg]:e=>!!e||null===e,[Mg]:e=>!!e||null===e,focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,visibleChange:e=>Ns(e),expandChange:e=>!!e,removeTag:e=>!!e},uE={key:0},cE=["placeholder","onKeydown"],dE=["onClick"],hE=Fn({name:"ElCascader"}),pE=Fn({...hE,props:oE,emits:lE,setup(e,{expose:t,emit:n}){const i=e,a={modifiers:[{name:"arrowPosition",enabled:!0,phase:"main",fn:({state:e})=>{const{modifiersData:t,placement:n}=e;["right","left","bottom","top"].includes(n)||(t.arrow.x=35)},requires:["arrow"]}]},s=Ji();let o=0,u=0;const c=rv("cascader"),d=rv("input"),{t:h}=Jg(),{form:p,formItem:m}=pb(),g=At(null),v=At(null),y=At(null),_=At(null),b=At(null),x=At(!1),w=At(!1),S=At(!1),C=At(!1),T=At(""),M=At(""),E=At([]),A=At([]),P=At([]),R=At(!1),L=Ki((()=>s.style)),k=Ki((()=>i.disabled||(null==p?void 0:p.disabled))),D=Ki((()=>i.placeholder||h("el.cascader.placeholder"))),I=Ki((()=>M.value||E.value.length>0||R.value?"":D.value)),O=db(),B=Ki((()=>["small"].includes(O.value)?"small":"default")),U=Ki((()=>!!i.props.multiple)),z=Ki((()=>!i.filterable||U.value)),F=Ki((()=>U.value?M.value:T.value)),V=Ki((()=>{var e;return(null==(e=_.value)?void 0:e.checkedNodes)||[]})),G=Ki((()=>!(!i.clearable||k.value||S.value||!w.value)&&!!V.value.length)),H=Ki((()=>{const{showAllLevels:e,separator:t}=i,n=V.value;return n.length?U.value?"":n[0].calcText(e,t):""})),j=Ki({get:()=>yd(i.modelValue),set(e){n(Tg,e),n(Mg,e),i.validateEvent&&(null==m||m.validate("change").catch((e=>{})))}}),W=Ki((()=>[c.b(),c.m(O.value),c.is("disabled",k.value),s.class])),Y=Ki((()=>[d.e("icon"),"icon-arrow-down",c.is("reverse",x.value)])),$=Ki((()=>c.is("focus",x.value||C.value))),X=Ki((()=>{var e,t;return null==(t=null==(e=g.value)?void 0:e.popperRef)?void 0:t.contentRef})),q=e=>{var t,r,a;k.value||(e=null!=e?e:!x.value)!==x.value&&(x.value=e,null==(r=null==(t=v.value)?void 0:t.input)||r.setAttribute("aria-expanded",`${e}`),e?(K(),en(null==(a=_.value)?void 0:a.scrollToExpandingNode)):i.filterable&&oe(),n("visibleChange",e))},K=()=>{en((()=>{var e;null==(e=g.value)||e.updatePopper()}))},Z=()=>{S.value=!1},J=e=>{const{showAllLevels:t,separator:n}=i;return{node:e,key:e.uid,text:e.calcText(t,n),hitState:!1,closable:!k.value&&!e.isDisabled,isCollapseTag:!1}},Q=e=>{var t;const r=e.node;r.doCheck(!1),null==(t=_.value)||t.calculateCheckedValue(),n("removeTag",r.valueByOption)},ee=()=>{var e,t;const{filterMethod:n,showAllLevels:r,separator:a}=i,s=null==(t=null==(e=_.value)?void 0:e.getFlattedNodes(!i.props.checkStrictly))?void 0:t.filter((e=>!e.isDisabled&&(e.calcText(r,a),n(e,F.value))));U.value&&(E.value.forEach((e=>{e.hitState=!1})),A.value.forEach((e=>{e.hitState=!1}))),S.value=!0,P.value=s,K()},te=()=>{var e;let t;t=S.value&&b.value?b.value.$el.querySelector(`.${c.e("suggestion-item")}`):null==(e=_.value)?void 0:e.$el.querySelector(`.${c.b("node")}[tabindex="-1"]`),t&&(t.focus(),!S.value&&t.click())},ne=()=>{var e,t;const n=null==(e=v.value)?void 0:e.input,r=y.value,i=null==(t=b.value)?void 0:t.$el;if(Os&&n){if(i){i.querySelector(`.${c.e("suggestion-list")}`).style.minWidth=`${n.offsetWidth}px`}if(r){const{offsetHeight:e}=r,t=E.value.length>0?`${Math.max(e+6,o)}px`:`${o}px`;n.style.height=t,K()}}},re=e=>{K(),n("expandChange",e)},ie=e=>{var t;const n=null==(t=e.target)?void 0:t.value;if("compositionend"===e.type)R.value=!1,en((()=>pe(n)));else{const e=n[n.length-1]||"";R.value=!zg(e)}},ae=e=>{if(!R.value)switch(e.code){case Sg.enter:q();break;case Sg.down:q(!0),en(te),e.preventDefault();break;case Sg.esc:!0===x.value&&(e.preventDefault(),e.stopPropagation(),q(!1));break;case Sg.tab:q(!1)}},se=()=>{var e;null==(e=_.value)||e.clearCheckedNodes(),!x.value&&i.filterable&&oe(),q(!1)},oe=()=>{const{value:e}=H;T.value=e,M.value=e},le=e=>{const t=e.target,{code:n}=e;switch(n){case Sg.up:case Sg.down:{const e=n===Sg.up?-1:1;Ss(ws(t,e,`.${c.e("suggestion-item")}[tabindex="-1"]`));break}case Sg.enter:t.click()}},ue=()=>{const e=E.value,t=e[e.length-1];u=M.value?0:u+1,!t||!u||i.collapseTags&&e.length>1||(t.hitState?Q(t):t.hitState=!0)},ce=e=>{const t=e.target,r=c.e("search-input");t.className===r&&(C.value=!0),n("focus",e)},de=e=>{C.value=!1,n("blur",e)},he=gh((()=>{const{value:e}=F;if(!e)return;const t=i.beforeFilter(e);N(t)?t.then(ee).catch((()=>{})):!1!==t?ee():Z()}),i.debounce),pe=(e,t)=>{!x.value&&q(!0),(null==t?void 0:t.isComposing)||(e?he():Z())};return Mn(S,K),Mn([V,k],(()=>{if(!U.value)return;const e=V.value,t=[],n=[];if(e.forEach((e=>n.push(J(e)))),A.value=n,e.length){const[n,...r]=e,a=r.length;t.push(J(n)),a&&(i.collapseTags?t.push({key:-1,text:`+ ${a}`,closable:!1,isCollapseTag:!0}):r.forEach((e=>t.push(J(e)))))}E.value=t})),Mn(E,(()=>{en((()=>ne()))})),Mn(H,oe,{immediate:!0}),Kn((()=>{const e=v.value.input,t=Number.parseFloat(function(e,t,{window:n=qs,initialValue:r=""}={}){const i=At(r),a=Ki((()=>{var e;return Xs(t)||(null==(e=null==n?void 0:n.document)?void 0:e.documentElement)}));return Mn([a,()=>Vs(e)],(([e,t])=>{var a;if(e&&n){const s=null==(a=n.getComputedStyle(e).getPropertyValue(t))?void 0:a.trim();i.value=s||r}}),{immediate:!0}),Mn(i,(t=>{var n;(null==(n=a.value)?void 0:n.style)&&a.value.style.setProperty(Vs(e),t)})),i}(d.cssVarName("input-height"),e).value)-2;o=e.offsetHeight||t,lo(e,ne)})),t({getCheckedNodes:e=>{var t;return null==(t=_.value)?void 0:t.getCheckedNodes(e)},cascaderPanelRef:_,togglePopperVisible:q,contentRef:X}),(e,t)=>(fi(),_i(Dt(Ow),{ref_key:"tooltipRef",ref:g,visible:x.value,teleported:e.teleported,"popper-class":[Dt(c).e("dropdown"),e.popperClass],"popper-options":a,"fallback-placements":["bottom-start","bottom","top-start","top","right","left"],"stop-popper-mouse-event":!1,"gpu-acceleration":!1,placement:"bottom-start",transition:`${Dt(c).namespace.value}-zoom-in-top`,effect:"light",pure:"",persistent:"",onHide:Z},{default:vn((()=>[ar((fi(),yi("div",{class:l(Dt(W)),style:r(Dt(L)),onClick:t[5]||(t[5]=()=>q(!Dt(z)||void 0)),onKeydown:ae,onMouseenter:t[6]||(t[6]=e=>w.value=!0),onMouseleave:t[7]||(t[7]=e=>w.value=!1)},[Mi(Dt(mx),{ref_key:"input",ref:v,modelValue:T.value,"onUpdate:modelValue":t[1]||(t[1]=e=>T.value=e),placeholder:Dt(I),readonly:Dt(z),disabled:Dt(k),"validate-event":!1,size:Dt(O),class:l(Dt($)),tabindex:Dt(U)&&e.filterable&&!Dt(k)?-1:void 0,onCompositionstart:ie,onCompositionupdate:ie,onCompositionend:ie,onFocus:ce,onBlur:de,onInput:pe},{suffix:vn((()=>[Dt(G)?(fi(),_i(Dt(ib),{key:"clear",class:l([Dt(d).e("icon"),"icon-circle-close"]),onClick:ts(se,["stop"])},{default:vn((()=>[Mi(Dt(tf))])),_:1},8,["class","onClick"])):(fi(),_i(Dt(ib),{key:"arrow-down",class:l(Dt(Y)),onClick:t[0]||(t[0]=ts((e=>q()),["stop"]))},{default:vn((()=>[Mi(Dt(op))])),_:1},8,["class"]))])),_:1},8,["modelValue","placeholder","readonly","disabled","size","class","tabindex"]),Dt(U)?(fi(),yi("div",{key:0,ref_key:"tagWrapper",ref:y,class:l(Dt(c).e("tags"))},[(fi(!0),yi(li,null,mr(E.value,(t=>(fi(),_i(Dt(sE),{key:t.key,type:e.tagType,size:Dt(B),hit:t.hitState,closable:t.closable,"disable-transitions":"",onClose:e=>Q(t)},{default:vn((()=>[!1===t.isCollapseTag?(fi(),yi("span",uE,f(t.text),1)):(fi(),_i(Dt(Ow),{key:1,disabled:x.value||!e.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],placement:"bottom",effect:"light"},{default:vn((()=>[Ti("span",null,f(t.text),1)])),content:vn((()=>[Ti("div",{class:l(Dt(c).e("collapse-tags"))},[(fi(!0),yi(li,null,mr(A.value.slice(1),((t,n)=>(fi(),yi("div",{key:n,class:l(Dt(c).e("collapse-tag"))},[(fi(),_i(Dt(sE),{key:t.key,class:"in-tooltip",type:e.tagType,size:Dt(B),hit:t.hitState,closable:t.closable,"disable-transitions":"",onClose:e=>Q(t)},{default:vn((()=>[Ti("span",null,f(t.text),1)])),_:2},1032,["type","size","hit","closable","onClose"]))],2)))),128))],2)])),_:2},1032,["disabled"]))])),_:2},1032,["type","size","hit","closable","onClose"])))),128)),e.filterable&&!Dt(k)?ar((fi(),yi("input",{key:0,"onUpdate:modelValue":t[2]||(t[2]=e=>M.value=e),type:"text",class:l(Dt(c).e("search-input")),placeholder:Dt(H)?"":Dt(D),onInput:t[3]||(t[3]=e=>pe(M.value,e)),onClick:t[4]||(t[4]=ts((e=>q(!0)),["stop"])),onKeydown:rs(ue,["delete"]),onCompositionstart:ie,onCompositionupdate:ie,onCompositionend:ie,onFocus:ce,onBlur:de},null,42,cE)),[[$a,M.value]]):Li("v-if",!0)],2)):Li("v-if",!0)],38)),[[Dt(EC),()=>q(!1),Dt(X)]])])),content:vn((()=>[ar(Mi(Dt(tE),{ref_key:"cascaderPanelRef",ref:_,modelValue:Dt(j),"onUpdate:modelValue":t[8]||(t[8]=e=>Et(j)?j.value=e:null),options:e.options,props:i.props,border:!1,"render-label":e.$slots.default,onExpandChange:re,onClose:t[9]||(t[9]=t=>e.$nextTick((()=>q(!1))))},null,8,["modelValue","options","props","render-label"]),[[is,!S.value]]),e.filterable?ar((fi(),_i(Dt(Tx),{key:0,ref_key:"suggestionPanel",ref:b,tag:"ul",class:l(Dt(c).e("suggestion-panel")),"view-class":Dt(c).e("suggestion-list"),onKeydown:le},{default:vn((()=>[P.value.length?(fi(!0),yi(li,{key:0},mr(P.value,(e=>(fi(),yi("li",{key:e.uid,class:l([Dt(c).e("suggestion-item"),Dt(c).is("checked",e.checked)]),tabindex:-1,onClick:t=>(e=>{var t,n;const{checked:r}=e;U.value?null==(t=_.value)||t.handleCheckChange(e,!r,!1):(!r&&(null==(n=_.value)||n.handleCheckChange(e,!0,!1)),q(!1))})(e)},[Ti("span",null,f(e.text),1),e.checked?(fi(),_i(Dt(ib),{key:0},{default:vn((()=>[Mi(Dt(zp))])),_:1})):Li("v-if",!0)],10,dE)))),128)):vr(e.$slots,"empty",{key:1},(()=>[Ti("li",{class:l(Dt(c).e("empty-text"))},f(Dt(h)("el.cascader.noMatch")),3)]))])),_:3},8,["class","view-class"])),[[is,S.value]]):Li("v-if",!0)])),_:3},8,["visible","teleported","popper-class","transition"]))}});var fE=J_(pE,[["__file","/home/runner/work/element-plus/element-plus/packages/components/cascader/src/cascader.vue"]]);fE.install=e=>{e.component(fE.name,fE)};const mE=fE,gE=pg({checked:{type:Boolean,default:!1}}),vE={"update:checked":e=>Ns(e),[Mg]:e=>Ns(e)},yE=Fn({name:"ElCheckTag"});const _E=_g(J_(Fn({...yE,props:gE,emits:vE,setup(e,{emit:t}){const n=e,r=rv("check-tag"),i=()=>{const e=!n.checked;t(Mg,e),t("update:checked",e)};return(e,t)=>(fi(),yi("span",{class:l([Dt(r).b(),Dt(r).is("checked",e.checked)]),onClick:i},[vr(e.$slots,"default")],2))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/check-tag/src/check-tag.vue"]])),bE=Symbol("rowContextKey"),xE=pg({tag:{type:String,default:"div"},gutter:{type:Number,default:0},justify:{type:String,values:["start","center","end","space-around","space-between","space-evenly"],default:"start"},align:{type:String,values:["top","middle","bottom"],default:"top"}}),wE=Fn({name:"ElRow"});const SE=_g(J_(Fn({...wE,props:xE,setup(e){const t=e,n=rv("row"),i=Ki((()=>t.gutter));wn(bE,{gutter:i});const a=Ki((()=>{const e={};return t.gutter?(e.marginRight=e.marginLeft=`-${t.gutter/2}px`,e):e})),s=Ki((()=>[n.b(),n.is(`justify-${t.justify}`,"start"!==t.justify),n.is(`align-${t.align}`,"top"!==t.align)]));return(e,t)=>(fi(),_i(dr(e.tag),{class:l(Dt(s)),style:r(Dt(a))},{default:vn((()=>[vr(e.$slots,"default")])),_:3},8,["class","style"]))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/row/src/row.vue"]])),CE=pg({tag:{type:String,default:"div"},span:{type:Number,default:24},offset:{type:Number,default:0},pull:{type:Number,default:0},push:{type:Number,default:0},xs:{type:[Number,Object],default:()=>({})},sm:{type:[Number,Object],default:()=>({})},md:{type:[Number,Object],default:()=>({})},lg:{type:[Number,Object],default:()=>({})},xl:{type:[Number,Object],default:()=>({})}}),TE=Fn({name:"ElCol"});const ME=_g(J_(Fn({...TE,props:CE,setup(e){const t=e,{gutter:n}=Sn(bE,{gutter:Ki((()=>0))}),i=rv("col"),a=Ki((()=>{const e={};return n.value&&(e.paddingLeft=e.paddingRight=n.value/2+"px"),e})),s=Ki((()=>{const e=[];["span","offset","pull","push"].forEach((n=>{const r=t[n];Bs(r)&&("span"===n?e.push(i.b(`${t[n]}`)):r>0&&e.push(i.b(`${n}-${t[n]}`)))}));return["xs","sm","md","lg","xl"].forEach((n=>{Bs(t[n])?e.push(i.b(`${n}-${t[n]}`)):O(t[n])&&Object.entries(t[n]).forEach((([t,r])=>{e.push("span"!==t?i.b(`${n}-${t}-${r}`):i.b(`${n}-${r}`))}))})),n.value&&e.push(i.is("guttered")),[i.b(),e]}));return(e,t)=>(fi(),_i(dr(e.tag),{class:l(Dt(s)),style:r(Dt(a))},{default:vn((()=>[vr(e.$slots,"default")])),_:3},8,["class","style"]))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/col/src/col.vue"]])),EE=e=>typeof Bs(e),AE=pg({accordion:Boolean,modelValue:{type:[Array,String,Number],default:()=>[]}}),PE={[Tg]:EE,[Mg]:EE},RE=Symbol("collapseContextKey"),LE=Fn({name:"ElCollapse"}),kE=Fn({...LE,props:AE,emits:PE,setup(e,{expose:t,emit:n}){const r=e,{activeNames:i,setActiveNames:a}=((e,t)=>{const n=At(ec(e.modelValue)),r=r=>{n.value=r;const i=e.accordion?n.value[0]:n.value;t(Tg,i),t(Mg,i)};return Mn((()=>e.modelValue),(()=>n.value=ec(e.modelValue)),{deep:!0}),wn(RE,{activeNames:n,handleItemClick:t=>{if(e.accordion)r([n.value[0]===t?"":t]);else{const e=[...n.value],i=e.indexOf(t);i>-1?e.splice(i,1):e.push(t),r(e)}}}),{activeNames:n,setActiveNames:r}})(r,n),{rootKls:s}=(()=>{const e=rv("collapse");return{rootKls:Ki((()=>e.b()))}})();return t({activeNames:i,setActiveNames:a}),(e,t)=>(fi(),yi("div",{class:l(Dt(s)),role:"tablist","aria-multiselectable":"true"},[vr(e.$slots,"default")],2))}});var DE=J_(kE,[["__file","/home/runner/work/element-plus/element-plus/packages/components/collapse/src/collapse.vue"]]);const IE=Fn({name:"ElCollapseTransition"});var OE=J_(Fn({...IE,setup(e){const t=rv("collapse-transition"),n={beforeEnter(e){e.dataset||(e.dataset={}),e.dataset.oldPaddingTop=e.style.paddingTop,e.dataset.oldPaddingBottom=e.style.paddingBottom,e.style.maxHeight=0,e.style.paddingTop=0,e.style.paddingBottom=0},enter(e){e.dataset.oldOverflow=e.style.overflow,0!==e.scrollHeight?(e.style.maxHeight=`${e.scrollHeight}px`,e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom):(e.style.maxHeight=0,e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom),e.style.overflow="hidden"},afterEnter(e){e.style.maxHeight="",e.style.overflow=e.dataset.oldOverflow},beforeLeave(e){e.dataset||(e.dataset={}),e.dataset.oldPaddingTop=e.style.paddingTop,e.dataset.oldPaddingBottom=e.style.paddingBottom,e.dataset.oldOverflow=e.style.overflow,e.style.maxHeight=`${e.scrollHeight}px`,e.style.overflow="hidden"},leave(e){0!==e.scrollHeight&&(e.style.maxHeight=0,e.style.paddingTop=0,e.style.paddingBottom=0)},afterLeave(e){e.style.maxHeight="",e.style.overflow=e.dataset.oldOverflow,e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom}};return(e,r)=>(fi(),_i(xa,Oi({name:Dt(t).b()},function(e,t){const n={};for(const r in e)n[t&&/[A-Z]/.test(r)?`on:${r}`:K(r)]=e[r];return n}(n)),{default:vn((()=>[vr(e.$slots,"default")])),_:3},16,["name"]))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/collapse-transition/src/collapse-transition.vue"]]);OE.install=e=>{e.component(OE.name,OE)};const NE=OE,BE=NE,UE=pg({title:{type:String,default:""},name:{type:[String,Number],default:()=>Gg()},disabled:Boolean}),zE=["aria-expanded","aria-controls","aria-describedby"],FE=["id","tabindex"],VE=["id","aria-hidden","aria-labelledby"],GE=Fn({name:"ElCollapseItem"});var HE=J_(Fn({...GE,props:UE,setup(e,{expose:t}){const n=e,{focusing:r,id:i,isActive:a,handleFocus:s,handleHeaderClick:o,handleEnterClick:u}=(e=>{const t=Sn(RE),n=At(!1),r=At(!1),i=At(Gg()),a=Ki((()=>null==t?void 0:t.activeNames.value.includes(e.name)));return{focusing:n,id:i,isActive:a,handleFocus:()=>{setTimeout((()=>{r.value?r.value=!1:n.value=!0}),50)},handleHeaderClick:()=>{e.disabled||(null==t||t.handleItemClick(e.name),n.value=!1,r.value=!0)},handleEnterClick:()=>{null==t||t.handleItemClick(e.name)}}})(n),{arrowKls:c,headKls:d,rootKls:h,itemWrapperKls:p,itemContentKls:m,scopedContentId:g,scopedHeadId:v}=((e,{focusing:t,isActive:n,id:r})=>{const i=rv("collapse"),a=Ki((()=>[i.b("item"),i.is("active",Dt(n)),i.is("disabled",e.disabled)])),s=Ki((()=>[i.be("item","header"),i.is("active",Dt(n)),{focusing:Dt(t)&&!e.disabled}]));return{arrowKls:Ki((()=>[i.be("item","arrow"),i.is("active",Dt(n))])),headKls:s,rootKls:a,itemWrapperKls:Ki((()=>i.be("item","wrap"))),itemContentKls:Ki((()=>i.be("item","content"))),scopedContentId:Ki((()=>i.b(`content-${Dt(r)}`))),scopedHeadId:Ki((()=>i.b(`head-${Dt(r)}`)))}})(n,{focusing:r,isActive:a,id:i});return t({isActive:a}),(e,t)=>(fi(),yi("div",{class:l(Dt(h))},[Ti("div",{role:"tab","aria-expanded":Dt(a),"aria-controls":Dt(g),"aria-describedby":Dt(g)},[Ti("div",{id:Dt(v),class:l(Dt(d)),role:"button",tabindex:e.disabled?-1:0,onClick:t[0]||(t[0]=(...e)=>Dt(o)&&Dt(o)(...e)),onKeypress:t[1]||(t[1]=rs(ts(((...e)=>Dt(u)&&Dt(u)(...e)),["stop","prevent"]),["space","enter"])),onFocus:t[2]||(t[2]=(...e)=>Dt(s)&&Dt(s)(...e)),onBlur:t[3]||(t[3]=e=>r.value=!1)},[vr(e.$slots,"title",{},(()=>[Pi(f(e.title),1)])),Mi(Dt(ib),{class:l(Dt(c))},{default:vn((()=>[Mi(Dt(mp))])),_:1},8,["class"])],42,FE)],8,zE),Mi(Dt(NE),null,{default:vn((()=>[ar(Ti("div",{id:Dt(g),class:l(Dt(p)),role:"tabpanel","aria-hidden":!Dt(a),"aria-labelledby":Dt(v)},[Ti("div",{class:l(Dt(m))},[vr(e.$slots,"default")],2)],10,VE),[[is,Dt(a)]])])),_:3})],2))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/collapse/src/collapse-item.vue"]]);const jE=_g(DE,{CollapseItem:HE}),WE=xg(HE),YE=pg({color:{type:Object,required:!0},vertical:{type:Boolean,default:!1}});let $E=!1;function XE(e,t){if(!Os)return;const n=function(e){var n;null==(n=t.drag)||n.call(t,e)},r=function(e){var i;document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",r),document.removeEventListener("touchmove",n),document.removeEventListener("touchend",r),document.onselectstart=null,document.ondragstart=null,$E=!1,null==(i=t.end)||i.call(t,e)},i=function(e){var i;$E||(e.preventDefault(),document.onselectstart=()=>!1,document.ondragstart=()=>!1,document.addEventListener("mousemove",n),document.addEventListener("mouseup",r),document.addEventListener("touchmove",n),document.addEventListener("touchend",r),$E=!0,null==(i=t.start)||i.call(t,e))};e.addEventListener("mousedown",i),e.addEventListener("touchstart",i)}const qE=(e,{bar:t,thumb:n,handleDrag:r})=>{const i=Fi(),a=rv("color-alpha-slider"),s=At(0),o=At(0),l=At();function u(){s.value=function(){if(!n.value)return 0;if(e.vertical)return 0;const t=i.vnode.el,r=e.color.get("alpha");return t?Math.round(r*(t.offsetWidth-n.value.offsetWidth/2)/100):0}(),o.value=function(){if(!n.value)return 0;const t=i.vnode.el;if(!e.vertical)return 0;const r=e.color.get("alpha");return t?Math.round(r*(t.offsetHeight-n.value.offsetHeight/2)/100):0}(),l.value=function(){if(e.color&&e.color.value){const{r:t,g:n,b:r}=e.color.toRgb();return`linear-gradient(to right, rgba(${t}, ${n}, ${r}, 0) 0%, rgba(${t}, ${n}, ${r}, 1) 100%)`}return""}()}Kn((()=>{if(!t.value||!n.value)return;const e={drag:e=>{r(e)},end:e=>{r(e)}};XE(t.value,e),XE(n.value,e),u()})),Mn((()=>e.color.get("alpha")),(()=>u())),Mn((()=>e.color.value),(()=>u()));const c=Ki((()=>[a.b(),a.is("vertical",e.vertical)])),d=Ki((()=>a.e("bar"))),h=Ki((()=>a.e("thumb")));return{rootKls:c,barKls:d,barStyle:Ki((()=>({background:l.value}))),thumbKls:h,thumbStyle:Ki((()=>({left:Zh(s.value),top:Zh(o.value)}))),update:u}},KE=Fn({name:"ElColorAlphaSlider"});var ZE=J_(Fn({...KE,props:YE,setup(e,{expose:t}){const n=e,{bar:i,thumb:a,handleDrag:s,handleClick:o}=(e=>{const t=Fi(),n=Pt(),r=Pt();function i(i){if(!r.value||!n.value)return;const a=t.vnode.el.getBoundingClientRect(),{clientX:s,clientY:o}=yo(i);if(e.vertical){let t=o-a.top;t=Math.max(n.value.offsetHeight/2,t),t=Math.min(t,a.height-n.value.offsetHeight/2),e.color.set("alpha",Math.round((t-n.value.offsetHeight/2)/(a.height-n.value.offsetHeight)*100))}else{let t=s-a.left;t=Math.max(n.value.offsetWidth/2,t),t=Math.min(t,a.width-n.value.offsetWidth/2),e.color.set("alpha",Math.round((t-n.value.offsetWidth/2)/(a.width-n.value.offsetWidth)*100))}}return{thumb:n,bar:r,handleDrag:i,handleClick:function(e){e.target!==n.value&&i(e)}}})(n),{rootKls:u,barKls:c,barStyle:d,thumbKls:h,thumbStyle:p,update:f}=qE(n,{bar:i,thumb:a,handleDrag:s});return t({update:f,bar:i,thumb:a}),(e,t)=>(fi(),yi("div",{class:l(Dt(u))},[Ti("div",{ref_key:"bar",ref:i,class:l(Dt(c)),style:r(Dt(d)),onClick:t[0]||(t[0]=(...e)=>Dt(o)&&Dt(o)(...e))},null,6),Ti("div",{ref_key:"thumb",ref:a,class:l(Dt(h)),style:r(Dt(p))},null,6)],2))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/alpha-slider.vue"]]);var JE=J_(Fn({name:"ElColorHueSlider",props:{color:{type:Object,required:!0},vertical:Boolean},setup(e){const t=rv("color-hue-slider"),n=Fi(),r=At(),i=At(),a=At(0),s=At(0),o=Ki((()=>e.color.get("hue")));function l(t){if(!i.value||!r.value)return;const a=n.vnode.el.getBoundingClientRect(),{clientX:s,clientY:o}=yo(t);let l;if(e.vertical){let e=o-a.top;e=Math.min(e,a.height-r.value.offsetHeight/2),e=Math.max(r.value.offsetHeight/2,e),l=Math.round((e-r.value.offsetHeight/2)/(a.height-r.value.offsetHeight)*360)}else{let e=s-a.left;e=Math.min(e,a.width-r.value.offsetWidth/2),e=Math.max(r.value.offsetWidth/2,e),l=Math.round((e-r.value.offsetWidth/2)/(a.width-r.value.offsetWidth)*360)}e.color.set("hue",l)}function u(){a.value=function(){if(!r.value)return 0;const t=n.vnode.el;if(e.vertical)return 0;const i=e.color.get("hue");return t?Math.round(i*(t.offsetWidth-r.value.offsetWidth/2)/360):0}(),s.value=function(){if(!r.value)return 0;const t=n.vnode.el;if(!e.vertical)return 0;const i=e.color.get("hue");return t?Math.round(i*(t.offsetHeight-r.value.offsetHeight/2)/360):0}()}return Mn((()=>o.value),(()=>{u()})),Kn((()=>{if(!i.value||!r.value)return;const e={drag:e=>{l(e)},end:e=>{l(e)}};XE(i.value,e),XE(r.value,e),u()})),{bar:i,thumb:r,thumbLeft:a,thumbTop:s,hueValue:o,handleClick:function(e){e.target!==r.value&&l(e)},update:u,ns:t}}}),[["render",function(e,t,n,i,a,s){return fi(),yi("div",{class:l([e.ns.b(),e.ns.is("vertical",e.vertical)])},[Ti("div",{ref:"bar",class:l(e.ns.e("bar")),onClick:t[0]||(t[0]=(...t)=>e.handleClick&&e.handleClick(...t))},null,2),Ti("div",{ref:"thumb",class:l(e.ns.e("thumb")),style:r({left:e.thumbLeft+"px",top:e.thumbTop+"px"})},null,6)],2)}],["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/hue-slider.vue"]]);const QE=pg({modelValue:String,id:String,showAlpha:Boolean,colorFormat:String,disabled:Boolean,size:z_,popperClass:{type:String,default:""},label:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},predefine:{type:Array},validateEvent:{type:Boolean,default:!0}}),eA={[Tg]:e=>D(e)||Ah(e),[Mg]:e=>D(e)||Ah(e),activeChange:e=>D(e)||Ah(e)},tA=Symbol("colorPickerContextKey"),nA=function(e,t,n){return[e,t*n/((e=(2-t)*n)<1?e:2-e)||0,e/2]},rA=function(e,t){var n;"string"==typeof(n=e)&&n.includes(".")&&1===Number.parseFloat(n)&&(e="100%");const r=function(e){return"string"==typeof e&&e.includes("%")}(e);return e=Math.min(t,Math.max(0,Number.parseFloat(`${e}`))),r&&(e=Number.parseInt(""+e*t,10)/100),Math.abs(e-t)<1e-6?1:e%t/Number.parseFloat(t)},iA={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"},aA=e=>{e=Math.min(Math.round(e),255);const t=Math.floor(e/16),n=e%16;return`${iA[t]||t}${iA[n]||n}`},sA=function({r:e,g:t,b:n}){return Number.isNaN(+e)||Number.isNaN(+t)||Number.isNaN(+n)?"":`#${aA(e)}${aA(t)}${aA(n)}`},oA={A:10,B:11,C:12,D:13,E:14,F:15},lA=function(e){return 2===e.length?16*(oA[e[0].toUpperCase()]||+e[0])+(oA[e[1].toUpperCase()]||+e[1]):oA[e[1].toUpperCase()]||+e[1]},uA=(e,t,n)=>{e=rA(e,255),t=rA(t,255),n=rA(n,255);const r=Math.max(e,t,n),i=Math.min(e,t,n);let a;const s=r,o=r-i,l=0===r?0:o/r;if(r===i)a=0;else{switch(r){case e:a=(t-n)/o+(t<n?6:0);break;case t:a=(n-e)/o+2;break;case n:a=(e-t)/o+4}a/=6}return{h:360*a,s:100*l,v:100*s}},cA=function(e,t,n){e=6*rA(e,360),t=rA(t,100),n=rA(n,100);const r=Math.floor(e),i=e-r,a=n*(1-t),s=n*(1-i*t),o=n*(1-(1-i)*t),l=r%6,u=[n,s,a,a,o,n][l],c=[o,n,n,s,a,a][l],d=[a,a,o,n,n,s][l];return{r:Math.round(255*u),g:Math.round(255*c),b:Math.round(255*d)}};let dA=class{constructor(e={}){this._hue=0,this._saturation=100,this._value=100,this._alpha=100,this.enableAlpha=!1,this.format="hex",this.value="";for(const t in e)M(e,t)&&(this[t]=e[t]);e.value?this.fromString(e.value):this.doOnChange()}set(e,t){if(1!==arguments.length||"object"!=typeof e)this[`_${e}`]=t,this.doOnChange();else for(const n in e)M(e,n)&&this.set(n,e[n])}get(e){return"alpha"===e?Math.floor(this[`_${e}`]):this[`_${e}`]}toRgb(){return cA(this._hue,this._saturation,this._value)}fromString(e){if(!e)return this._hue=0,this._saturation=100,this._value=100,void this.doOnChange();const t=(e,t,n)=>{this._hue=Math.max(0,Math.min(360,e)),this._saturation=Math.max(0,Math.min(100,t)),this._value=Math.max(0,Math.min(100,n)),this.doOnChange()};if(e.includes("hsl")){const n=e.replace(/hsla|hsl|\(|\)/gm,"").split(/\s|,/g).filter((e=>""!==e)).map(((e,t)=>t>2?Number.parseFloat(e):Number.parseInt(e,10)));if(4===n.length?this._alpha=100*Number.parseFloat(n[3]):3===n.length&&(this._alpha=100),n.length>=3){const{h:e,s:r,v:i}=function(e,t,n){n/=100;let r=t/=100;const i=Math.max(n,.01);return t*=(n*=2)<=1?n:2-n,r*=i<=1?i:2-i,{h:e,s:100*(0===n?2*r/(i+r):2*t/(n+t)),v:(n+t)/2*100}}(n[0],n[1],n[2]);t(e,r,i)}}else if(e.includes("hsv")){const n=e.replace(/hsva|hsv|\(|\)/gm,"").split(/\s|,/g).filter((e=>""!==e)).map(((e,t)=>t>2?Number.parseFloat(e):Number.parseInt(e,10)));4===n.length?this._alpha=100*Number.parseFloat(n[3]):3===n.length&&(this._alpha=100),n.length>=3&&t(n[0],n[1],n[2])}else if(e.includes("rgb")){const n=e.replace(/rgba|rgb|\(|\)/gm,"").split(/\s|,/g).filter((e=>""!==e)).map(((e,t)=>t>2?Number.parseFloat(e):Number.parseInt(e,10)));if(4===n.length?this._alpha=100*Number.parseFloat(n[3]):3===n.length&&(this._alpha=100),n.length>=3){const{h:e,s:r,v:i}=uA(n[0],n[1],n[2]);t(e,r,i)}}else if(e.includes("#")){const n=e.replace("#","").trim();if(!/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$|^[0-9a-fA-F]{8}$/.test(n))return;let r,i,a;3===n.length?(r=lA(n[0]+n[0]),i=lA(n[1]+n[1]),a=lA(n[2]+n[2])):6!==n.length&&8!==n.length||(r=lA(n.slice(0,2)),i=lA(n.slice(2,4)),a=lA(n.slice(4,6))),8===n.length?this._alpha=lA(n.slice(6))/255*100:3!==n.length&&6!==n.length||(this._alpha=100);const{h:s,s:o,v:l}=uA(r,i,a);t(s,o,l)}}compare(e){return Math.abs(e._hue-this._hue)<2&&Math.abs(e._saturation-this._saturation)<1&&Math.abs(e._value-this._value)<1&&Math.abs(e._alpha-this._alpha)<1}doOnChange(){const{_hue:e,_saturation:t,_value:n,_alpha:r,format:i}=this;if(this.enableAlpha)switch(i){case"hsl":{const r=nA(e,t/100,n/100);this.value=`hsla(${e}, ${Math.round(100*r[1])}%, ${Math.round(100*r[2])}%, ${this.get("alpha")/100})`;break}case"hsv":this.value=`hsva(${e}, ${Math.round(t)}%, ${Math.round(n)}%, ${this.get("alpha")/100})`;break;case"hex":this.value=`${sA(cA(e,t,n))}${aA(255*r/100)}`;break;default:{const{r:r,g:i,b:a}=cA(e,t,n);this.value=`rgba(${r}, ${i}, ${a}, ${this.get("alpha")/100})`}}else switch(i){case"hsl":{const r=nA(e,t/100,n/100);this.value=`hsl(${e}, ${Math.round(100*r[1])}%, ${Math.round(100*r[2])}%)`;break}case"hsv":this.value=`hsv(${e}, ${Math.round(t)}%, ${Math.round(n)}%)`;break;case"rgb":{const{r:r,g:i,b:a}=cA(e,t,n);this.value=`rgb(${r}, ${i}, ${a})`;break}default:this.value=sA(cA(e,t,n))}}};const hA=Fn({props:{colors:{type:Array,required:!0},color:{type:Object,required:!0}},setup(e){const t=rv("color-predefine"),{currentColor:n}=Sn(tA),r=At(i(e.colors,e.color));function i(e,t){return e.map((e=>{const n=new dA;return n.enableAlpha=!0,n.format="rgba",n.fromString(e),n.selected=n.value===t.value,n}))}return Mn((()=>n.value),(e=>{const t=new dA;t.fromString(e),r.value.forEach((e=>{e.selected=t.compare(e)}))})),Cn((()=>{r.value=i(e.colors,e.color)})),{rgbaColors:r,handleSelect:function(t){e.color.fromString(e.colors[t])},ns:t}}}),pA=["onClick"];var fA=J_(hA,[["render",function(e,t,n,i,a,s){return fi(),yi("div",{class:l(e.ns.b())},[Ti("div",{class:l(e.ns.e("colors"))},[(fi(!0),yi(li,null,mr(e.rgbaColors,((t,n)=>(fi(),yi("div",{key:e.colors[n],class:l([e.ns.e("color-selector"),e.ns.is("alpha",t._alpha<100),{selected:t.selected}]),onClick:t=>e.handleSelect(n)},[Ti("div",{style:r({backgroundColor:t.value})},null,4)],10,pA)))),128))],2)],2)}],["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/predefine.vue"]]);const mA=Fn({name:"ElSlPanel",props:{color:{type:Object,required:!0}},setup(e){const t=rv("color-svpanel"),n=Fi(),r=At(0),i=At(0),a=At("hsl(0, 100%, 50%)"),s=Ki((()=>({hue:e.color.get("hue"),value:e.color.get("value")})));function o(){const t=e.color.get("saturation"),s=e.color.get("value"),o=n.vnode.el,{clientWidth:l,clientHeight:u}=o;i.value=t*l/100,r.value=(100-s)*u/100,a.value=`hsl(${e.color.get("hue")}, 100%, 50%)`}function l(t){const a=n.vnode.el.getBoundingClientRect(),{clientX:s,clientY:o}=yo(t);let l=s-a.left,u=o-a.top;l=Math.max(0,l),l=Math.min(l,a.width),u=Math.max(0,u),u=Math.min(u,a.height),i.value=l,r.value=u,e.color.set({saturation:l/a.width*100,value:100-u/a.height*100})}return Mn((()=>s.value),(()=>{o()})),Kn((()=>{XE(n.vnode.el,{drag:e=>{l(e)},end:e=>{l(e)}}),o()})),{cursorTop:r,cursorLeft:i,background:a,colorValue:s,handleDrag:l,update:o,ns:t}}}),gA=[Ti("div",null,null,-1)];var vA=J_(mA,[["render",function(e,t,n,i,a,s){return fi(),yi("div",{class:l(e.ns.b()),style:r({backgroundColor:e.background})},[Ti("div",{class:l(e.ns.e("white"))},null,2),Ti("div",{class:l(e.ns.e("black"))},null,2),Ti("div",{class:l(e.ns.e("cursor")),style:r({top:e.cursorTop+"px",left:e.cursorLeft+"px"})},gA,6)],6)}],["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/sv-panel.vue"]]);const yA=["id","aria-label","aria-labelledby","aria-description","tabindex","onKeydown"],_A=Fn({name:"ElColorPicker"}),bA=Fn({..._A,props:QE,emits:eA,setup(e,{expose:t,emit:n}){const i=e,{t:a}=Jg(),s=rv("color"),{formItem:o}=pb(),u=db(),c=hb(),{inputId:d,isLabeledByFormItem:h}=fb(i,{formItemContext:o}),p=At(),m=At(),g=At(),v=At();let y=!0;const _=pt(new dA({enableAlpha:i.showAlpha,format:i.colorFormat||"",value:i.modelValue})),b=At(!1),x=At(!1),w=At(""),S=Ki((()=>i.modelValue||x.value?function(e,t){if(!(e instanceof dA))throw new TypeError("color should be instance of _color Class");const{r:n,g:r,b:i}=e.toRgb();return t?`rgba(${n}, ${r}, ${i}, ${e.get("alpha")/100})`:`rgb(${n}, ${r}, ${i})`}(_,i.showAlpha):"transparent")),C=Ki((()=>i.modelValue||x.value?_.value:"")),T=Ki((()=>h.value?void 0:i.label||a("el.colorpicker.defaultLabel"))),M=Ki((()=>h.value?null==o?void 0:o.labelId:void 0)),E=Ki((()=>[s.b("picker"),s.is("disabled",c.value),s.bm("picker",u.value)]));function A(e){b.value=e}const P=gh(A,100);function R(){P(!1),L()}function L(){en((()=>{i.modelValue?_.fromString(i.modelValue):(_.value="",en((()=>{x.value=!1})))}))}function k(){c.value||P(!b.value)}function D(){_.fromString(w.value)}function I(){const e=_.value;n(Tg,e),n("change",e),i.validateEvent&&(null==o||o.validate("change").catch((e=>{}))),P(!1),en((()=>{const e=new dA({enableAlpha:i.showAlpha,format:i.colorFormat||"",value:i.modelValue});_.compare(e)||L()}))}function O(){P(!1),n(Tg,null),n("change",null),null!==i.modelValue&&i.validateEvent&&(null==o||o.validate("change").catch((e=>{}))),L()}return Kn((()=>{i.modelValue&&(w.value=C.value)})),Mn((()=>i.modelValue),(e=>{e?e&&e!==_.value&&(y=!1,_.fromString(e)):x.value=!1})),Mn((()=>C.value),(e=>{w.value=e,y&&n("activeChange",e),y=!0})),Mn((()=>_.value),(()=>{i.modelValue||x.value||(x.value=!0)})),Mn((()=>b.value),(()=>{en((()=>{var e,t,n;null==(e=p.value)||e.update(),null==(t=m.value)||t.update(),null==(n=g.value)||n.update()}))})),wn(tA,{currentColor:C}),t({color:_,show:function(){c.value||A(!0)},hide:R}),(e,t)=>(fi(),_i(Dt(Ow),{ref_key:"popper",ref:v,visible:b.value,"show-arrow":!1,"fallback-placements":["bottom","top","right","left"],offset:0,"gpu-acceleration":!1,"popper-class":[Dt(s).be("picker","panel"),Dt(s).b("dropdown"),e.popperClass],"stop-popper-mouse-event":!1,effect:"light",trigger:"click",transition:`${Dt(s).namespace.value}-zoom-in-top`,persistent:""},{content:vn((()=>[ar((fi(),yi("div",null,[Ti("div",{class:l(Dt(s).be("dropdown","main-wrapper"))},[Mi(JE,{ref_key:"hue",ref:p,class:"hue-slider",color:Dt(_),vertical:""},null,8,["color"]),Mi(vA,{ref:"svPanel",color:Dt(_)},null,8,["color"])],2),e.showAlpha?(fi(),_i(ZE,{key:0,ref_key:"alpha",ref:g,color:Dt(_)},null,8,["color"])):Li("v-if",!0),e.predefine?(fi(),_i(fA,{key:1,ref:"predefine",color:Dt(_),colors:e.predefine},null,8,["color","colors"])):Li("v-if",!0),Ti("div",{class:l(Dt(s).be("dropdown","btns"))},[Ti("span",{class:l(Dt(s).be("dropdown","value"))},[Mi(Dt(mx),{modelValue:w.value,"onUpdate:modelValue":t[0]||(t[0]=e=>w.value=e),"validate-event":!1,size:"small",onKeyup:rs(D,["enter"]),onBlur:D},null,8,["modelValue","onKeyup"])],2),Mi(Dt(jS),{class:l(Dt(s).be("dropdown","link-btn")),text:"",size:"small",onClick:O},{default:vn((()=>[Pi(f(Dt(a)("el.colorpicker.clear")),1)])),_:1},8,["class"]),Mi(Dt(jS),{plain:"",size:"small",class:l(Dt(s).be("dropdown","btn")),onClick:I},{default:vn((()=>[Pi(f(Dt(a)("el.colorpicker.confirm")),1)])),_:1},8,["class"])],2)])),[[Dt(EC),R]])])),default:vn((()=>[Ti("div",{id:Dt(d),class:l(Dt(E)),role:"button","aria-label":Dt(T),"aria-labelledby":Dt(M),"aria-description":Dt(a)("el.colorpicker.description",{color:e.modelValue||""}),tabindex:e.tabindex,onKeydown:rs(k,["enter"])},[Dt(c)?(fi(),yi("div",{key:0,class:l(Dt(s).be("picker","mask"))},null,2)):Li("v-if",!0),Ti("div",{class:l(Dt(s).be("picker","trigger")),onClick:k},[Ti("span",{class:l([Dt(s).be("picker","color"),Dt(s).is("alpha",e.showAlpha)])},[Ti("span",{class:l(Dt(s).be("picker","color-inner")),style:r({backgroundColor:Dt(S)})},[ar(Mi(Dt(ib),{class:l([Dt(s).be("picker","icon"),Dt(s).is("icon-arrow-down")])},{default:vn((()=>[Mi(Dt(op))])),_:1},8,["class"]),[[is,e.modelValue||x.value]]),e.modelValue||x.value?Li("v-if",!0):(fi(),_i(Dt(ib),{key:0,class:l([Dt(s).be("picker","empty"),Dt(s).is("icon-close")])},{default:vn((()=>[Mi(Dt(cf))])),_:1},8,["class"]))],6)],2)],2)],42,yA)])),_:1},8,["visible","popper-class","transition"]))}});const xA=_g(J_(bA,[["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/color-picker.vue"]])),wA=Fn({name:"ElContainer"});var SA=J_(Fn({...wA,props:{direction:{type:String}},setup(e){const t=e,n=Zi(),r=rv("container"),i=Ki((()=>{if("vertical"===t.direction)return!0;if("horizontal"===t.direction)return!1;if(n&&n.default){return n.default().some((e=>{const t=e.type.name;return"ElHeader"===t||"ElFooter"===t}))}return!1}));return(e,t)=>(fi(),yi("section",{class:l([Dt(r).b(),Dt(r).is("vertical",Dt(i))])},[vr(e.$slots,"default")],2))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/container.vue"]]);const CA=Fn({name:"ElAside"});var TA=J_(Fn({...CA,props:{width:{type:String,default:null}},setup(e){const t=e,n=rv("aside"),i=Ki((()=>t.width?n.cssVarBlock({width:t.width}):{}));return(e,t)=>(fi(),yi("aside",{class:l(Dt(n).b()),style:r(Dt(i))},[vr(e.$slots,"default")],6))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/aside.vue"]]);const MA=Fn({name:"ElFooter"});var EA=J_(Fn({...MA,props:{height:{type:String,default:null}},setup(e){const t=e,n=rv("footer"),i=Ki((()=>t.height?n.cssVarBlock({height:t.height}):{}));return(e,t)=>(fi(),yi("footer",{class:l(Dt(n).b()),style:r(Dt(i))},[vr(e.$slots,"default")],6))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/footer.vue"]]);const AA=Fn({name:"ElHeader"});var PA=J_(Fn({...AA,props:{height:{type:String,default:null}},setup(e){const t=e,n=rv("header"),i=Ki((()=>t.height?n.cssVarBlock({height:t.height}):{}));return(e,t)=>(fi(),yi("header",{class:l(Dt(n).b()),style:r(Dt(i))},[vr(e.$slots,"default")],6))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/header.vue"]]);const RA=Fn({name:"ElMain"});var LA=J_(Fn({...RA,setup(e){const t=rv("main");return(e,n)=>(fi(),yi("main",{class:l(Dt(t).b())},[vr(e.$slots,"default")],2))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/main.vue"]]);const kA=_g(SA,{Aside:TA,Footer:EA,Header:PA,Main:LA}),DA=xg(TA),IA=xg(EA),OA=xg(PA),NA=xg(LA);var BA={};({get exports(){return BA},set exports(e){BA=e}}).exports=function(e,t){var n=t.prototype,r=n.format;n.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return r.bind(this)(e);var i=this.$utils(),a=(e||"YYYY-MM-DDTHH:mm:ssZ").replace(/\[([^\]]+)]|Q|wo|ww|w|WW|W|zzz|z|gggg|GGGG|Do|X|x|k{1,2}|S/g,(function(e){switch(e){case"Q":return Math.ceil((t.$M+1)/3);case"Do":return n.ordinal(t.$D);case"gggg":return t.weekYear();case"GGGG":return t.isoWeekYear();case"wo":return n.ordinal(t.week(),"W");case"w":case"ww":return i.s(t.week(),"w"===e?1:2,"0");case"W":case"WW":return i.s(t.isoWeek(),"W"===e?1:2,"0");case"k":case"kk":return i.s(String(0===t.$H?24:t.$H),"k"===e?1:2,"0");case"X":return Math.floor(t.$d.getTime()/1e3);case"x":return t.$d.getTime();case"z":return"["+t.offsetName()+"]";case"zzz":return"["+t.offsetName("long")+"]";default:return e}}));return r.bind(this)(a)}};const UA=BA;var zA,FA,VA={};({get exports(){return VA},set exports(e){VA=e}}).exports=(zA="week",FA="year",function(e,t,n){var r=t.prototype;r.week=function(e){if(void 0===e&&(e=null),null!==e)return this.add(7*(e-this.week()),"day");var t=this.$locale().yearStart||1;if(11===this.month()&&this.date()>25){var r=n(this).startOf(FA).add(1,FA).date(t),i=n(this).endOf(zA);if(r.isBefore(i))return 1}var a=n(this).startOf(FA).date(t).startOf(zA).subtract(1,"millisecond"),s=this.diff(a,zA,!0);return s<0?n(this).startOf("week").week():Math.ceil(s)},r.weeks=function(e){return void 0===e&&(e=null),this.week(e)}});const GA=VA;var HA={};({get exports(){return HA},set exports(e){HA=e}}).exports=function(e,t){t.prototype.weekYear=function(){var e=this.month(),t=this.week(),n=this.year();return 1===t&&11===e?n+1:0===e&&t>=52?n-1:n}};const jA=HA;var WA={};({get exports(){return WA},set exports(e){WA=e}}).exports=function(e,t,n){t.prototype.dayOfYear=function(e){var t=Math.round((n(this).startOf("day")-n(this).startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"day")}};const YA=WA;var $A={};({get exports(){return $A},set exports(e){$A=e}}).exports=function(e,t){t.prototype.isSameOrAfter=function(e,t){return this.isSame(e,t)||this.isAfter(e,t)}};const XA=$A;var qA={};({get exports(){return qA},set exports(e){qA=e}}).exports=function(e,t){t.prototype.isSameOrBefore=function(e,t){return this.isSame(e,t)||this.isBefore(e,t)}};const KA=qA,ZA=Symbol(),JA=pg({type:{type:String,default:"date"}}),QA=["date","dates","year","month","week","range"],eP=pg({disabledDate:{type:Function},date:{type:Object,required:!0},minDate:{type:Object},maxDate:{type:Object},parsedValue:{type:[Object,Array]},rangeState:{type:Object,default:()=>({endDate:null,selecting:!1})}}),tP=pg({type:{type:String,required:!0,values:["year","month","date","dates","week","datetime","datetimerange","daterange","monthrange"]}}),nP=pg({unlinkPanels:Boolean,parsedValue:{type:Array}}),rP=e=>({type:String,values:QA,default:e}),iP=pg({...tP,parsedValue:{type:[Object,Array]},visible:{type:Boolean},format:{type:String,default:""}}),aP=pg({...eP,cellClassName:{type:Function},showWeekNumber:Boolean,selectionMode:rP("date")}),sP=e=>{if(!E(e))return!1;const[t,n]=e;return XS.isDayjs(t)&&XS.isDayjs(n)&&t.isSameOrBefore(n)},oP=(e,{lang:t,unit:n,unlinkPanels:r})=>{let i;if(E(e)){let[i,a]=e.map((e=>XS(e).locale(t)));return r||(a=i.add(1,n)),[i,a]}return i=e?XS(e):XS(),i=i.locale(t),[i,i.add(1,n)]};var lP=Fn({name:"ElDatePickerCell",props:pg({cell:{type:Object}}),setup(e){const t=rv("date-table-cell"),{slots:n}=Sn(ZA);return()=>{const{cell:r}=e;if(n.default){const e=n.default(r).filter((e=>-2!==e.patchFlag&&"Symbol(Comment)"!==e.type.toString()));if(e.length)return e}return Mi("div",{class:t.b()},[Mi("span",{class:t.e("text")},[null==r?void 0:r.text])])}}});const uP=["aria-label","onMousedown"],cP={key:0,scope:"col"},dP=["aria-label"],hP=["aria-current","aria-selected","tabindex"],pP=Fn({__name:"basic-date-table",props:aP,emits:["changerange","pick","select"],setup(e,{expose:t,emit:n}){const r=e,i=rv("date-table"),{t:a,lang:s}=Jg(),o=At(),u=At(),c=At(),d=At(),h=At([[],[],[],[],[],[]]);let p=!1;const m=r.date.$locale().weekStart||7,g=r.date.locale("en").localeData().weekdaysShort().map((e=>e.toLowerCase())),v=Ki((()=>m>3?7-m:-m)),y=Ki((()=>{const e=r.date.startOf("month");return e.subtract(e.day()||7,"day")})),_=Ki((()=>g.concat(g).slice(m,m+7))),b=Ki((()=>Yu(T.value).some((e=>e.isCurrent)))),x=Ki((()=>{const e=r.date.startOf("month");return{startOfMonthDay:e.day()||7,dateCountOfMonth:e.daysInMonth(),dateCountOfLastMonth:e.subtract(1,"month").daysInMonth()}})),w=Ki((()=>"dates"===r.selectionMode?Bg(r.parsedValue):[])),S=(e,{columnIndex:t,rowIndex:n},i)=>{const{disabledDate:a,cellClassName:s}=r,o=Dt(w),l=((e,{count:t,rowIndex:n,columnIndex:r})=>{const{startOfMonthDay:i,dateCountOfMonth:a,dateCountOfLastMonth:s}=Dt(x),o=Dt(v);if(!(n>=0&&n<=1))return t<=a?e.text=t:(e.text=t-a,e.type="next-month"),!0;{const a=i+o<0?7+i+o:i+o;if(r+7*n>=a)return e.text=t,!0;e.text=s-(a-r%7)+1+7*n,e.type="prev-month"}return!1})(e,{count:i,rowIndex:n,columnIndex:t}),u=e.dayjs.toDate();return e.selected=o.find((t=>t.valueOf()===e.dayjs.valueOf())),e.isSelected=!!e.selected,e.isCurrent=E(e),e.disabled=null==a?void 0:a(u),e.customClass=null==s?void 0:s(u),l},C=e=>{if("week"===r.selectionMode){const[t,n]=r.showWeekNumber?[1,7]:[0,6],i=B(e[t+1]);e[t].inRange=i,e[t].start=i,e[n].inRange=i,e[n].end=i}},T=Ki((()=>{const{minDate:e,maxDate:t,rangeState:n,showWeekNumber:i}=r,a=v.value,o=h.value,l="day";let u=1;if(i)for(let r=0;r<6;r++)o[r][0]||(o[r][0]={type:"week",text:y.value.add(7*r+1,l).week()});return((e,t,{columnIndexOffset:n,startDate:r,nextEndDate:i,now:a,unit:s,relativeDateGetter:o,setCellMetadata:l,setRowMetadata:u})=>{for(let c=0;c<e.row;c++){const d=t[c];for(let t=0;t<e.column;t++){let u=d[t+n];u||(u={row:c,column:t,type:"normal",inRange:!1,start:!1,end:!1});const h=o(c*e.column+t);u.dayjs=h,u.date=h.toDate(),u.timestamp=h.valueOf(),u.type="normal",u.inRange=!!(r&&h.isSameOrAfter(r,s)&&i&&h.isSameOrBefore(i,s))||!!(r&&h.isSameOrBefore(r,s)&&i&&h.isSameOrAfter(i,s)),(null==r?void 0:r.isSameOrAfter(i))?(u.start=!!i&&h.isSame(i,s),u.end=r&&h.isSame(r,s)):(u.start=!!r&&h.isSame(r,s),u.end=!!i&&h.isSame(i,s)),h.isSame(a,s)&&(u.type="today"),null==l||l(u,{rowIndex:c,columnIndex:t}),d[t+n]=u}null==u||u(d)}})({row:6,column:7},o,{startDate:e,columnIndexOffset:i?1:0,nextEndDate:n.endDate||t||n.selecting&&e||null,now:XS().locale(Dt(s)).startOf(l),unit:l,relativeDateGetter:e=>y.value.add(e-a,l),setCellMetadata:(...e)=>{S(...e,u)&&(u+=1)},setRowMetadata:C}),o}));Mn((()=>r.date),(async()=>{var e,t;(null==(e=o.value)?void 0:e.contains(document.activeElement))&&(await en(),null==(t=u.value)||t.focus())}));const M=(e="")=>["normal","today"].includes(e),E=e=>"date"===r.selectionMode&&M(e.type)&&A(e,r.parsedValue),A=(e,t)=>!!t&&XS(t).locale(s.value).isSame(r.date.date(Number(e.text)),"day"),P=e=>{const t=[];return M(e.type)&&!e.disabled?(t.push("available"),"today"===e.type&&t.push("today")):t.push(e.type),E(e)&&t.push("current"),e.inRange&&(M(e.type)||"week"===r.selectionMode)&&(t.push("in-range"),e.start&&t.push("start-date"),e.end&&t.push("end-date")),e.disabled&&t.push("disabled"),e.selected&&t.push("selected"),e.customClass&&t.push(e.customClass),t.join(" ")},R=(e,t)=>{const n=7*e+(t-(r.showWeekNumber?1:0))-v.value;return y.value.add(n,"day")},L=e=>{var t;if(!r.rangeState.selecting)return;let i=e.target;if("SPAN"===i.tagName&&(i=null==(t=i.parentNode)?void 0:t.parentNode),"DIV"===i.tagName&&(i=i.parentNode),"TD"!==i.tagName)return;const a=i.parentNode.rowIndex-1,s=i.cellIndex;T.value[a][s].disabled||a===c.value&&s===d.value||(c.value=a,d.value=s,n("changerange",{selecting:!0,endDate:R(a,s)}))},k=e=>!b.value&&1===(null==e?void 0:e.text)&&"normal"===e.type||e.isCurrent,D=e=>{p||b.value||"date"!==r.selectionMode||N(e,!0)},I=e=>{e.target.closest("td")&&(p=!0)},O=e=>{e.target.closest("td")&&(p=!1)},N=(e,t=!1)=>{const i=e.target.closest("td");if(!i)return;const a=i.parentNode.rowIndex-1,s=i.cellIndex,o=T.value[a][s];if(o.disabled||"week"===o.type)return;const l=R(a,s);if("range"===r.selectionMode)r.rangeState.selecting&&r.minDate?(l>=r.minDate?n("pick",{minDate:r.minDate,maxDate:l}):n("pick",{minDate:l,maxDate:r.minDate}),n("select",!1)):(n("pick",{minDate:l,maxDate:null}),n("select",!0));else if("date"===r.selectionMode)n("pick",l,t);else if("week"===r.selectionMode){const e=l.week(),t=`${l.year()}w${e}`;n("pick",{year:l.year(),week:e,value:t,date:l.startOf("week")})}else if("dates"===r.selectionMode){const e=o.selected?Bg(r.parsedValue).filter((e=>(null==e?void 0:e.valueOf())!==l.valueOf())):Bg(r.parsedValue).concat([l]);n("pick",e)}},B=e=>{if("week"!==r.selectionMode)return!1;let t=r.date.startOf("day");if("prev-month"===e.type&&(t=t.subtract(1,"month")),"next-month"===e.type&&(t=t.add(1,"month")),t=t.date(Number.parseInt(e.text,10)),r.parsedValue&&!Array.isArray(r.parsedValue)){const e=(r.parsedValue.day()-m+7)%7-1;return r.parsedValue.subtract(e,"day").isSame(t,"day")}return!1};return t({focus:async()=>{var e;null==(e=u.value)||e.focus()}}),(e,t)=>(fi(),yi("table",{role:"grid","aria-label":Dt(a)("el.datepicker.dateTablePrompt"),cellspacing:"0",cellpadding:"0",class:l([Dt(i).b(),{"is-week-mode":"week"===e.selectionMode}]),onClick:N,onMousemove:L,onMousedown:ts(I,["prevent"]),onMouseup:O},[Ti("tbody",{ref_key:"tbodyRef",ref:o},[Ti("tr",null,[e.showWeekNumber?(fi(),yi("th",cP,f(Dt(a)("el.datepicker.week")),1)):Li("v-if",!0),(fi(!0),yi(li,null,mr(Dt(_),((e,t)=>(fi(),yi("th",{key:t,scope:"col","aria-label":Dt(a)("el.datepicker.weeksFull."+e)},f(Dt(a)("el.datepicker.weeks."+e)),9,dP)))),128))]),(fi(!0),yi(li,null,mr(Dt(T),((e,t)=>(fi(),yi("tr",{key:t,class:l([Dt(i).e("row"),{current:B(e[1])}])},[(fi(!0),yi(li,null,mr(e,((e,n)=>(fi(),yi("td",{key:`${t}.${n}`,ref_for:!0,ref:t=>k(e)&&(u.value=t),class:l(P(e)),"aria-current":e.isCurrent?"date":void 0,"aria-selected":e.isCurrent,tabindex:k(e)?0:-1,onFocus:D},[Mi(Dt(lP),{cell:e},null,8,["cell"])],42,hP)))),128))],2)))),128))],512)],42,uP))}});var fP=J_(pP,[["__file","/home/runner/work/element-plus/element-plus/packages/components/date-picker/src/date-picker-com/basic-date-table.vue"]]);const mP=pg({...eP,selectionMode:rP("month")}),gP=["aria-label"],vP=["aria-selected","aria-label","tabindex","onKeydown"],yP={class:"cell"},_P=Fn({__name:"basic-month-table",props:mP,emits:["changerange","pick","select"],setup(e,{expose:t,emit:n}){const r=e,i=rv("month-table"),{t:a,lang:s}=Jg(),o=At(),u=At(),c=At(r.date.locale("en").localeData().monthsShort().map((e=>e.toLowerCase()))),d=At([[],[],[]]),h=At(),p=At(),m=Ki((()=>{var e,t;const n=d.value,i=XS().locale(s.value).startOf("month");for(let a=0;a<3;a++){const s=n[a];for(let n=0;n<4;n++){const o=s[n]||(s[n]={row:a,column:n,type:"normal",inRange:!1,start:!1,end:!1,text:-1,disabled:!1});o.type="normal";const l=4*a+n,u=r.date.startOf("year").month(l),c=r.rangeState.endDate||r.maxDate||r.rangeState.selecting&&r.minDate||null;o.inRange=!!(r.minDate&&u.isSameOrAfter(r.minDate,"month")&&c&&u.isSameOrBefore(c,"month"))||!!(r.minDate&&u.isSameOrBefore(r.minDate,"month")&&c&&u.isSameOrAfter(c,"month")),(null==(e=r.minDate)?void 0:e.isSameOrAfter(c))?(o.start=!(!c||!u.isSame(c,"month")),o.end=r.minDate&&u.isSame(r.minDate,"month")):(o.start=!(!r.minDate||!u.isSame(r.minDate,"month")),o.end=!(!c||!u.isSame(c,"month")));i.isSame(u)&&(o.type="today"),o.text=l,o.disabled=(null==(t=r.disabledDate)?void 0:t.call(r,u.toDate()))||!1}}return n})),g=e=>{const t={},n=r.date.year(),i=new Date,a=e.text;return t.disabled=!!r.disabledDate&&((e,t,n)=>{const r=XS().locale(n).startOf("month").month(t).year(e),i=r.daysInMonth();return nC(i).map((e=>r.add(e,"day").toDate()))})(n,a,s.value).every(r.disabledDate),t.current=Bg(r.parsedValue).findIndex((e=>XS.isDayjs(e)&&e.year()===n&&e.month()===a))>=0,t.today=i.getFullYear()===n&&i.getMonth()===a,e.inRange&&(t["in-range"]=!0,e.start&&(t["start-date"]=!0),e.end&&(t["end-date"]=!0)),t},v=e=>{const t=r.date.year(),n=e.text;return Bg(r.date).findIndex((e=>e.year()===t&&e.month()===n))>=0},y=e=>{var t;if(!r.rangeState.selecting)return;let i=e.target;if("A"===i.tagName&&(i=null==(t=i.parentNode)?void 0:t.parentNode),"DIV"===i.tagName&&(i=i.parentNode),"TD"!==i.tagName)return;const a=i.parentNode.rowIndex,s=i.cellIndex;m.value[a][s].disabled||a===h.value&&s===p.value||(h.value=a,p.value=s,n("changerange",{selecting:!0,endDate:r.date.startOf("year").month(4*a+s)}))},_=e=>{var t;const i=null==(t=e.target)?void 0:t.closest("td");if("TD"!==(null==i?void 0:i.tagName))return;if($h(i,"disabled"))return;const a=i.cellIndex,s=4*i.parentNode.rowIndex+a,o=r.date.startOf("year").month(s);"range"===r.selectionMode?r.rangeState.selecting?(r.minDate&&o>=r.minDate?n("pick",{minDate:r.minDate,maxDate:o}):n("pick",{minDate:o,maxDate:r.minDate}),n("select",!1)):(n("pick",{minDate:o,maxDate:null}),n("select",!0)):n("pick",s)};return Mn((()=>r.date),(async()=>{var e,t;(null==(e=o.value)?void 0:e.contains(document.activeElement))&&(await en(),null==(t=u.value)||t.focus())})),t({focus:()=>{var e;null==(e=u.value)||e.focus()}}),(e,t)=>(fi(),yi("table",{role:"grid","aria-label":Dt(a)("el.datepicker.monthTablePrompt"),class:l(Dt(i).b()),onClick:_,onMousemove:y},[Ti("tbody",{ref_key:"tbodyRef",ref:o},[(fi(!0),yi(li,null,mr(Dt(m),((e,t)=>(fi(),yi("tr",{key:t},[(fi(!0),yi(li,null,mr(e,((e,t)=>(fi(),yi("td",{key:t,ref_for:!0,ref:t=>v(e)&&(u.value=t),class:l(g(e)),"aria-selected":`${v(e)}`,"aria-label":Dt(a)("el.datepicker.month"+(+e.text+1)),tabindex:v(e)?0:-1,onKeydown:[rs(ts(_,["prevent","stop"]),["space"]),rs(ts(_,["prevent","stop"]),["enter"])]},[Ti("div",null,[Ti("span",yP,f(Dt(a)("el.datepicker.months."+c.value[e.text])),1)])],42,vP)))),128))])))),128))],512)],42,gP))}});var bP=J_(_P,[["__file","/home/runner/work/element-plus/element-plus/packages/components/date-picker/src/date-picker-com/basic-month-table.vue"]]);const{date:xP,disabledDate:wP,parsedValue:SP}=eP,CP=pg({date:xP,disabledDate:wP,parsedValue:SP}),TP=["aria-label"],MP=["aria-selected","tabindex","onKeydown"],EP={class:"cell"},AP={key:1},PP=Fn({__name:"basic-year-table",props:CP,emits:["pick"],setup(e,{expose:t,emit:n}){const r=e,i=rv("year-table"),{t:a,lang:s}=Jg(),o=At(),u=At(),c=Ki((()=>10*Math.floor(r.date.year()/10))),d=e=>{const t={},n=XS().locale(s.value);return t.disabled=!!r.disabledDate&&((e,t)=>{const n=XS(String(e)).locale(t).startOf("year"),r=n.endOf("year").dayOfYear();return nC(r).map((e=>n.add(e,"day").toDate()))})(e,s.value).every(r.disabledDate),t.current=Bg(r.parsedValue).findIndex((t=>t.year()===e))>=0,t.today=n.year()===e,t},h=e=>e===c.value&&r.date.year()<c.value&&r.date.year()>c.value+9||Bg(r.date).findIndex((t=>t.year()===e))>=0,p=e=>{const t=e.target.closest("td");if(t&&t.textContent){if($h(t,"disabled"))return;const e=t.textContent||t.innerText;n("pick",Number(e))}};return Mn((()=>r.date),(async()=>{var e,t;(null==(e=o.value)?void 0:e.contains(document.activeElement))&&(await en(),null==(t=u.value)||t.focus())})),t({focus:()=>{var e;null==(e=u.value)||e.focus()}}),(e,t)=>(fi(),yi("table",{role:"grid","aria-label":Dt(a)("el.datepicker.yearTablePrompt"),class:l(Dt(i).b()),onClick:p},[Ti("tbody",{ref_key:"tbodyRef",ref:o},[(fi(),yi(li,null,mr(3,((e,t)=>Ti("tr",{key:t},[(fi(),yi(li,null,mr(4,((e,n)=>(fi(),yi(li,{key:t+"_"+n},[4*t+n<10?(fi(),yi("td",{key:0,ref_for:!0,ref:e=>h(Dt(c)+4*t+n)&&(u.value=e),class:l(["available",d(Dt(c)+4*t+n)]),"aria-selected":`${h(Dt(c)+4*t+n)}`,tabindex:h(Dt(c)+4*t+n)?0:-1,onKeydown:[rs(ts(p,["prevent","stop"]),["space"]),rs(ts(p,["prevent","stop"]),["enter"])]},[Ti("span",EP,f(Dt(c)+4*t+n),1)],42,MP)):(fi(),yi("td",AP))],64)))),64))]))),64))],512)],10,TP))}});var RP=J_(PP,[["__file","/home/runner/work/element-plus/element-plus/packages/components/date-picker/src/date-picker-com/basic-year-table.vue"]]);const LP=["onClick"],kP=["aria-label"],DP=["aria-label"],IP=["aria-label"],OP=["aria-label"],NP=Fn({__name:"panel-date-pick",props:iP,emits:["pick","set-picker-option","panel-change"],setup(e,{emit:t}){const n=e,r=rv("picker-panel"),i=rv("date-picker"),a=Ji(),s=Zi(),{t:o,lang:u}=Jg(),c=Sn("EP_PICKER_BASE"),d=Sn(yw),{shortcuts:h,disabledDate:p,cellClassName:m,defaultTime:g,arrowControl:v}=c.props,y=Ut(c.props,"defaultValue"),_=At(),b=At(XS().locale(u.value)),x=At(!1),w=Ki((()=>XS(g).locale(u.value))),S=Ki((()=>b.value.month())),C=Ki((()=>b.value.year())),T=At([]),M=At(null),A=At(null),P=e=>!(T.value.length>0)||(T.value,n.format,!0),R=e=>!g||K.value||x.value?j.value?e.millisecond(0):e.startOf("day"):w.value.year(e.year()).month(e.month()).date(e.date()),L=(e,...n)=>{if(e)if(E(e)){const r=e.map(R);t("pick",r,...n)}else t("pick",R(e),...n);else t("pick",e,...n);M.value=null,A.value=null,x.value=!1},D=(e,t)=>{if("date"===U.value){let r=n.parsedValue?n.parsedValue.year(e.year()).month(e.month()).date(e.date()):e;P()||(r=T.value[0][0].year(e.year()).month(e.month()).date(e.date())),b.value=r,L(r,j.value||t)}else"week"===U.value?L(e.date):"dates"===U.value&&L(e,!0)},I=e=>{const t=e?"add":"subtract";b.value=b.value[t](1,"month"),ue("month")},O=e=>{const t=b.value,n=e?"add":"subtract";b.value="year"===N.value?t[n](10,"year"):t[n](1,"year"),ue("year")},N=At("date"),B=Ki((()=>{const e=o("el.datepicker.year");if("year"===N.value){const t=10*Math.floor(C.value/10);return e?`${t} ${e} - ${t+9} ${e}`:`${t} - ${t+9}`}return`${C.value} ${e}`})),U=Ki((()=>{const{type:e}=n;return["week","month","year","dates"].includes(e)?e:"date"})),z=Ki((()=>"date"===U.value?N.value:U.value)),F=Ki((()=>!!h.length)),V=async e=>{b.value=b.value.startOf("month").month(e),"month"===U.value?L(b.value,!1):(N.value="date",["month","year","date","week"].includes(U.value)&&(L(b.value,!0),await en(),se())),ue("month")},G=async e=>{"year"===U.value?(b.value=b.value.startOf("year").year(e),L(b.value,!1)):(b.value=b.value.year(e),N.value="month",["month","year","date","week"].includes(U.value)&&(L(b.value,!0),await en(),se())),ue("year")},H=async e=>{N.value=e,await en(),se()},j=Ki((()=>"datetime"===n.type||"datetimerange"===n.type)),W=Ki((()=>j.value||"dates"===U.value)),Y=()=>{if("dates"===U.value)L(n.parsedValue);else{let e=n.parsedValue;if(!e){const t=XS(g).locale(u.value),n=ae();e=t.year(n.year()).month(n.month()).date(n.date())}b.value=e,L(e)}},$=()=>{const e=XS().locale(u.value).toDate();x.value=!0,p&&p(e)||!P()||(b.value=XS().locale(u.value),L(b.value))},X=Ki((()=>iC(n.format))),q=Ki((()=>rC(n.format))),K=Ki((()=>A.value?A.value:n.parsedValue||y.value?(n.parsedValue||b.value).format(X.value):void 0)),Z=Ki((()=>M.value?M.value:n.parsedValue||y.value?(n.parsedValue||b.value).format(q.value):void 0)),J=At(!1),Q=()=>{J.value=!0},ee=()=>{J.value=!1},te=e=>({hour:e.hour(),minute:e.minute(),second:e.second(),year:e.year(),month:e.month(),date:e.date()}),ne=(e,t,r)=>{const{hour:i,minute:a,second:s}=te(e),o=n.parsedValue?n.parsedValue.hour(i).minute(a).second(s):e;b.value=o,L(b.value,!0),r||(J.value=t)},re=e=>{const t=XS(e,X.value).locale(u.value);if(t.isValid()&&P()){const{year:e,month:n,date:r}=te(b.value);b.value=t.year(e).month(n).date(r),A.value=null,J.value=!1,L(b.value,!0)}},ie=e=>{const t=XS(e,q.value).locale(u.value);if(t.isValid()){if(p&&p(t.toDate()))return;const{hour:e,minute:n,second:r}=te(b.value);b.value=t.hour(e).minute(n).second(r),M.value=null,L(b.value,!0)}},ae=()=>{const e=XS(y.value).locale(u.value);if(!y.value){const e=w.value;return XS().hour(e.hour()).minute(e.minute()).second(e.second()).locale(u.value)}return e},se=async()=>{var e;["week","month","year","date"].includes(U.value)&&(null==(e=_.value)||e.focus(),"week"===U.value&&le(Sg.down))},oe=e=>{const{code:t}=e;[Sg.up,Sg.down,Sg.left,Sg.right,Sg.home,Sg.end,Sg.pageUp,Sg.pageDown].includes(t)&&(le(t),e.stopPropagation(),e.preventDefault()),[Sg.enter,Sg.space,Sg.numpadEnter].includes(t)&&null===M.value&&null===A.value&&(e.preventDefault(),L(b.value,!1))},le=e=>{var n;const{up:r,down:i,left:a,right:s,home:o,end:l,pageUp:c,pageDown:d}=Sg,h={year:{[r]:-4,[i]:4,[a]:-1,[s]:1,offset:(e,t)=>e.setFullYear(e.getFullYear()+t)},month:{[r]:-4,[i]:4,[a]:-1,[s]:1,offset:(e,t)=>e.setMonth(e.getMonth()+t)},week:{[r]:-1,[i]:1,[a]:-1,[s]:1,offset:(e,t)=>e.setDate(e.getDate()+7*t)},date:{[r]:-7,[i]:7,[a]:-1,[s]:1,[o]:e=>-e.getDay(),[l]:e=>6-e.getDay(),[c]:e=>-new Date(e.getFullYear(),e.getMonth(),0).getDate(),[d]:e=>new Date(e.getFullYear(),e.getMonth()+1,0).getDate(),offset:(e,t)=>e.setDate(e.getDate()+t)}},f=b.value.toDate();for(;Math.abs(b.value.diff(f,"year",!0))<1;){const r=h[z.value];if(!r)return;if(r.offset(f,k(r[e])?r[e](f):null!=(n=r[e])?n:0),p&&p(f))break;const i=XS(f).locale(u.value);b.value=i,t("pick",i,!0);break}},ue=e=>{t("panel-change",b.value.toDate(),e,N.value)};return Mn((()=>U.value),(e=>{["month","year"].includes(e)?N.value=e:N.value="date"}),{immediate:!0}),Mn((()=>N.value),(()=>{null==d||d.updatePopper()})),Mn((()=>y.value),(e=>{e&&(b.value=ae())}),{immediate:!0}),Mn((()=>n.parsedValue),(e=>{if(e){if("dates"===U.value)return;if(Array.isArray(e))return;b.value=e}else b.value=ae()}),{immediate:!0}),t("set-picker-option",["isValidValue",e=>XS.isDayjs(e)&&e.isValid()&&(!p||!p(e.toDate()))]),t("set-picker-option",["formatToString",e=>"dates"===U.value?e.map((e=>e.format(n.format))):e.format(n.format)]),t("set-picker-option",["parseUserInput",e=>XS(e,n.format).locale(u.value)]),t("set-picker-option",["handleFocusPicker",se]),(e,n)=>(fi(),yi("div",{class:l([Dt(r).b(),Dt(i).b(),{"has-sidebar":e.$slots.sidebar||Dt(F),"has-time":Dt(j)}])},[Ti("div",{class:l(Dt(r).e("body-wrapper"))},[vr(e.$slots,"sidebar",{class:l(Dt(r).e("sidebar"))}),Dt(F)?(fi(),yi("div",{key:0,class:l(Dt(r).e("sidebar"))},[(fi(!0),yi(li,null,mr(Dt(h),((e,n)=>(fi(),yi("button",{key:n,type:"button",class:l(Dt(r).e("shortcut")),onClick:n=>(e=>{const n=k(e.value)?e.value():e.value;n?L(XS(n).locale(u.value)):e.onClick&&e.onClick({attrs:a,slots:s,emit:t})})(e)},f(e.text),11,LP)))),128))],2)):Li("v-if",!0),Ti("div",{class:l(Dt(r).e("body"))},[Dt(j)?(fi(),yi("div",{key:0,class:l(Dt(i).e("time-header"))},[Ti("span",{class:l(Dt(i).e("editor-wrap"))},[Mi(Dt(mx),{placeholder:Dt(o)("el.datepicker.selectDate"),"model-value":Dt(Z),size:"small","validate-event":!1,onInput:n[0]||(n[0]=e=>M.value=e),onChange:ie},null,8,["placeholder","model-value"])],2),ar((fi(),yi("span",{class:l(Dt(i).e("editor-wrap"))},[Mi(Dt(mx),{placeholder:Dt(o)("el.datepicker.selectTime"),"model-value":Dt(K),size:"small","validate-event":!1,onFocus:Q,onInput:n[1]||(n[1]=e=>A.value=e),onChange:re},null,8,["placeholder","model-value"]),Mi(Dt(hT),{visible:J.value,format:Dt(X),"time-arrow-control":Dt(v),"parsed-value":b.value,onPick:ne},null,8,["visible","format","time-arrow-control","parsed-value"])],2)),[[Dt(EC),ee]])],2)):Li("v-if",!0),ar(Ti("div",{class:l([Dt(i).e("header"),("year"===N.value||"month"===N.value)&&Dt(i).e("header--bordered")])},[Ti("span",{class:l(Dt(i).e("prev-btn"))},[Ti("button",{type:"button","aria-label":Dt(o)("el.datepicker.prevYear"),class:l(["d-arrow-left",Dt(r).e("icon-btn")]),onClick:n[2]||(n[2]=e=>O(!1))},[Mi(Dt(ib),null,{default:vn((()=>[Mi(Dt(ff))])),_:1})],10,kP),ar(Ti("button",{type:"button","aria-label":Dt(o)("el.datepicker.prevMonth"),class:l([Dt(r).e("icon-btn"),"arrow-left"]),onClick:n[3]||(n[3]=e=>I(!1))},[Mi(Dt(ib),null,{default:vn((()=>[Mi(Dt(dp))])),_:1})],10,DP),[[is,"date"===N.value]])],2),Ti("span",{role:"button",class:l(Dt(i).e("header-label")),"aria-live":"polite",tabindex:"0",onKeydown:n[4]||(n[4]=rs((e=>H("year")),["enter"])),onClick:n[5]||(n[5]=e=>H("year"))},f(Dt(B)),35),ar(Ti("span",{role:"button","aria-live":"polite",tabindex:"0",class:l([Dt(i).e("header-label"),{active:"month"===N.value}]),onKeydown:n[6]||(n[6]=rs((e=>H("month")),["enter"])),onClick:n[7]||(n[7]=e=>H("month"))},f(Dt(o)(`el.datepicker.month${Dt(S)+1}`)),35),[[is,"date"===N.value]]),Ti("span",{class:l(Dt(i).e("next-btn"))},[ar(Ti("button",{type:"button","aria-label":Dt(o)("el.datepicker.nextMonth"),class:l([Dt(r).e("icon-btn"),"arrow-right"]),onClick:n[8]||(n[8]=e=>I(!0))},[Mi(Dt(ib),null,{default:vn((()=>[Mi(Dt(mp))])),_:1})],10,IP),[[is,"date"===N.value]]),Ti("button",{type:"button","aria-label":Dt(o)("el.datepicker.nextYear"),class:l([Dt(r).e("icon-btn"),"d-arrow-right"]),onClick:n[9]||(n[9]=e=>O(!0))},[Mi(Dt(ib),null,{default:vn((()=>[Mi(Dt(yf))])),_:1})],10,OP)],2)],2),[[is,"time"!==N.value]]),Ti("div",{class:l(Dt(r).e("content")),onKeydown:oe},["date"===N.value?(fi(),_i(fP,{key:0,ref_key:"currentViewRef",ref:_,"selection-mode":Dt(U),date:b.value,"parsed-value":e.parsedValue,"disabled-date":Dt(p),"cell-class-name":Dt(m),onPick:D},null,8,["selection-mode","date","parsed-value","disabled-date","cell-class-name"])):Li("v-if",!0),"year"===N.value?(fi(),_i(RP,{key:1,ref_key:"currentViewRef",ref:_,date:b.value,"disabled-date":Dt(p),"parsed-value":e.parsedValue,onPick:G},null,8,["date","disabled-date","parsed-value"])):Li("v-if",!0),"month"===N.value?(fi(),_i(bP,{key:2,ref_key:"currentViewRef",ref:_,date:b.value,"parsed-value":e.parsedValue,"disabled-date":Dt(p),onPick:V},null,8,["date","parsed-value","disabled-date"])):Li("v-if",!0)],34)],2)],2),ar(Ti("div",{class:l(Dt(r).e("footer"))},[ar(Mi(Dt(jS),{text:"",size:"small",class:l(Dt(r).e("link-btn")),onClick:$},{default:vn((()=>[Pi(f(Dt(o)("el.datepicker.now")),1)])),_:1},8,["class"]),[[is,"dates"!==Dt(U)]]),Mi(Dt(jS),{plain:"",size:"small",class:l(Dt(r).e("link-btn")),onClick:Y},{default:vn((()=>[Pi(f(Dt(o)("el.datepicker.confirm")),1)])),_:1},8,["class"])],2),[[is,Dt(W)&&"date"===N.value]])],2))}});var BP=J_(NP,[["__file","/home/runner/work/element-plus/element-plus/packages/components/date-picker/src/date-picker-com/panel-date-pick.vue"]]);const UP=pg({...tP,...nP}),zP=(e,{defaultValue:t,leftDate:n,rightDate:r,unit:i,onParsedValueChanged:a})=>{const{emit:s}=Fi(),{pickerNs:o}=Sn(ZA),l=rv("date-range-picker"),{t:u,lang:c}=Jg(),d=(e=>{const{emit:t}=Fi(),n=Ji(),r=Zi();return i=>{const a=k(i.value)?i.value():i.value;a?t("pick",[XS(a[0]).locale(e.value),XS(a[1]).locale(e.value)]):i.onClick&&i.onClick({attrs:n,slots:r,emit:t})}})(c),h=At(),p=At(),f=At({endDate:null,selecting:!1}),m=()=>{const[a,s]=oP(Dt(t),{lang:Dt(c),unit:i,unlinkPanels:e.unlinkPanels});h.value=void 0,p.value=void 0,n.value=a,r.value=s};return Mn(t,(e=>{e&&m()}),{immediate:!0}),Mn((()=>e.parsedValue),(e=>{if(E(e)&&2===e.length){const[t,r]=e;h.value=t,n.value=t,p.value=r,a(Dt(h),Dt(p))}else m()}),{immediate:!0}),{minDate:h,maxDate:p,rangeState:f,lang:c,ppNs:o,drpNs:l,handleChangeRange:e=>{f.value=e},handleRangeConfirm:(e=!1)=>{const t=Dt(h),n=Dt(p);sP([t,n])&&s("pick",[t,n],e)},handleShortcutClick:d,onSelect:e=>{f.value.selecting=e,e||(f.value.endDate=null)},t:u}},FP=["onClick"],VP=["disabled"],GP=["disabled"],HP=["disabled"],jP=["disabled"],WP="month",YP=Fn({__name:"panel-date-range",props:UP,emits:["pick","set-picker-option","calendar-change","panel-change"],setup(e,{emit:t}){const n=e,r=Sn("EP_PICKER_BASE"),{disabledDate:i,cellClassName:a,format:s,defaultTime:o,arrowControl:u,clearable:c}=r.props,d=Ut(r.props,"shortcuts"),h=Ut(r.props,"defaultValue"),{lang:p}=Jg(),m=At(XS().locale(p.value)),g=At(XS().locale(p.value).add(1,WP)),{minDate:v,maxDate:y,rangeState:_,ppNs:b,drpNs:x,handleChangeRange:w,handleRangeConfirm:S,handleShortcutClick:C,onSelect:T,t:M}=zP(n,{defaultValue:h,leftDate:m,rightDate:g,unit:WP,onParsedValueChanged:function(e,t){if(n.unlinkPanels&&t){const n=(null==e?void 0:e.year())||0,r=(null==e?void 0:e.month())||0,i=t.year(),a=t.month();g.value=n===i&&r===a?t.add(1,WP):t}else g.value=m.value.add(1,WP),t&&(g.value=g.value.hour(t.hour()).minute(t.minute()).second(t.second()))}}),A=At({min:null,max:null}),P=At({min:null,max:null}),R=Ki((()=>`${m.value.year()} ${M("el.datepicker.year")} ${M(`el.datepicker.month${m.value.month()+1}`)}`)),L=Ki((()=>`${g.value.year()} ${M("el.datepicker.year")} ${M(`el.datepicker.month${g.value.month()+1}`)}`)),k=Ki((()=>m.value.year())),D=Ki((()=>m.value.month())),I=Ki((()=>g.value.year())),O=Ki((()=>g.value.month())),N=Ki((()=>!!d.value.length)),B=Ki((()=>null!==A.value.min?A.value.min:v.value?v.value.format(G.value):"")),U=Ki((()=>null!==A.value.max?A.value.max:y.value||v.value?(y.value||v.value).format(G.value):"")),z=Ki((()=>null!==P.value.min?P.value.min:v.value?v.value.format(V.value):"")),F=Ki((()=>null!==P.value.max?P.value.max:y.value||v.value?(y.value||v.value).format(V.value):"")),V=Ki((()=>iC(s))),G=Ki((()=>rC(s))),H=()=>{m.value=m.value.subtract(1,"year"),n.unlinkPanels||(g.value=m.value.add(1,"month")),Z("year")},j=()=>{m.value=m.value.subtract(1,"month"),n.unlinkPanels||(g.value=m.value.add(1,"month")),Z("month")},W=()=>{n.unlinkPanels?g.value=g.value.add(1,"year"):(m.value=m.value.add(1,"year"),g.value=m.value.add(1,"month")),Z("year")},Y=()=>{n.unlinkPanels?g.value=g.value.add(1,"month"):(m.value=m.value.add(1,"month"),g.value=m.value.add(1,"month")),Z("month")},$=()=>{m.value=m.value.add(1,"year"),Z("year")},X=()=>{m.value=m.value.add(1,"month"),Z("month")},q=()=>{g.value=g.value.subtract(1,"year"),Z("year")},K=()=>{g.value=g.value.subtract(1,"month"),Z("month")},Z=e=>{t("panel-change",[m.value.toDate(),g.value.toDate()],e)},J=Ki((()=>{const e=(D.value+1)%12,t=D.value+1>=12?1:0;return n.unlinkPanels&&new Date(k.value+t,e)<new Date(I.value,O.value)})),Q=Ki((()=>n.unlinkPanels&&12*I.value+O.value-(12*k.value+D.value+1)>=12)),ee=Ki((()=>!(v.value&&y.value&&!_.value.selecting&&sP([v.value,y.value])))),te=Ki((()=>"datetime"===n.type||"datetimerange"===n.type)),ne=(e,t)=>{if(e){if(o){return XS(o[t]||o).locale(p.value).year(e.year()).month(e.month()).date(e.date())}return e}},re=(e,n=!0)=>{const r=e.minDate,i=e.maxDate,a=ne(r,0),s=ne(i,1);y.value===s&&v.value===a||(t("calendar-change",[r.toDate(),i&&i.toDate()]),y.value=s,v.value=a,n&&!te.value&&S())},ie=At(!1),ae=At(!1),se=()=>{ie.value=!1},oe=()=>{ae.value=!1},le=(e,t)=>{A.value[t]=e;const r=XS(e,G.value).locale(p.value);if(r.isValid()){if(i&&i(r.toDate()))return;"min"===t?(m.value=r,v.value=(v.value||m.value).year(r.year()).month(r.month()).date(r.date()),n.unlinkPanels||(g.value=r.add(1,"month"),y.value=v.value.add(1,"month"))):(g.value=r,y.value=(y.value||g.value).year(r.year()).month(r.month()).date(r.date()),n.unlinkPanels||(m.value=r.subtract(1,"month"),v.value=y.value.subtract(1,"month")))}},ue=(e,t)=>{A.value[t]=null},ce=(e,t)=>{P.value[t]=e;const n=XS(e,V.value).locale(p.value);n.isValid()&&("min"===t?(ie.value=!0,v.value=(v.value||m.value).hour(n.hour()).minute(n.minute()).second(n.second()),y.value&&!y.value.isBefore(v.value)||(y.value=v.value)):(ae.value=!0,y.value=(y.value||g.value).hour(n.hour()).minute(n.minute()).second(n.second()),g.value=y.value,y.value&&y.value.isBefore(v.value)&&(v.value=y.value)))},de=(e,t)=>{P.value[t]=null,"min"===t?(m.value=v.value,ie.value=!1):(g.value=y.value,ae.value=!1)},he=(e,t,n)=>{P.value.min||(e&&(m.value=e,v.value=(v.value||m.value).hour(e.hour()).minute(e.minute()).second(e.second())),n||(ie.value=t),y.value&&!y.value.isBefore(v.value)||(y.value=v.value,g.value=e))},pe=(e,t,n)=>{P.value.max||(e&&(g.value=e,y.value=(y.value||g.value).hour(e.hour()).minute(e.minute()).second(e.second())),n||(ae.value=t),y.value&&y.value.isBefore(v.value)&&(v.value=y.value))},fe=()=>{m.value=oP(Dt(h),{lang:Dt(p),unit:"month",unlinkPanels:n.unlinkPanels})[0],g.value=m.value.add(1,"month"),t("pick",null)};return t("set-picker-option",["isValidValue",sP]),t("set-picker-option",["parseUserInput",e=>E(e)?e.map((e=>XS(e,s).locale(p.value))):XS(e,s).locale(p.value)]),t("set-picker-option",["formatToString",e=>E(e)?e.map((e=>e.format(s))):e.format(s)]),t("set-picker-option",["handleClear",fe]),(e,t)=>(fi(),yi("div",{class:l([Dt(b).b(),Dt(x).b(),{"has-sidebar":e.$slots.sidebar||Dt(N),"has-time":Dt(te)}])},[Ti("div",{class:l(Dt(b).e("body-wrapper"))},[vr(e.$slots,"sidebar",{class:l(Dt(b).e("sidebar"))}),Dt(N)?(fi(),yi("div",{key:0,class:l(Dt(b).e("sidebar"))},[(fi(!0),yi(li,null,mr(Dt(d),((e,t)=>(fi(),yi("button",{key:t,type:"button",class:l(Dt(b).e("shortcut")),onClick:t=>Dt(C)(e)},f(e.text),11,FP)))),128))],2)):Li("v-if",!0),Ti("div",{class:l(Dt(b).e("body"))},[Dt(te)?(fi(),yi("div",{key:0,class:l(Dt(x).e("time-header"))},[Ti("span",{class:l(Dt(x).e("editors-wrap"))},[Ti("span",{class:l(Dt(x).e("time-picker-wrap"))},[Mi(Dt(mx),{size:"small",disabled:Dt(_).selecting,placeholder:Dt(M)("el.datepicker.startDate"),class:l(Dt(x).e("editor")),"model-value":Dt(B),"validate-event":!1,onInput:t[0]||(t[0]=e=>le(e,"min")),onChange:t[1]||(t[1]=e=>ue(0,"min"))},null,8,["disabled","placeholder","class","model-value"])],2),ar((fi(),yi("span",{class:l(Dt(x).e("time-picker-wrap"))},[Mi(Dt(mx),{size:"small",class:l(Dt(x).e("editor")),disabled:Dt(_).selecting,placeholder:Dt(M)("el.datepicker.startTime"),"model-value":Dt(z),"validate-event":!1,onFocus:t[2]||(t[2]=e=>ie.value=!0),onInput:t[3]||(t[3]=e=>ce(e,"min")),onChange:t[4]||(t[4]=e=>de(0,"min"))},null,8,["class","disabled","placeholder","model-value"]),Mi(Dt(hT),{visible:ie.value,format:Dt(V),"datetime-role":"start","time-arrow-control":Dt(u),"parsed-value":m.value,onPick:he},null,8,["visible","format","time-arrow-control","parsed-value"])],2)),[[Dt(EC),se]])],2),Ti("span",null,[Mi(Dt(ib),null,{default:vn((()=>[Mi(Dt(mp))])),_:1})]),Ti("span",{class:l([Dt(x).e("editors-wrap"),"is-right"])},[Ti("span",{class:l(Dt(x).e("time-picker-wrap"))},[Mi(Dt(mx),{size:"small",class:l(Dt(x).e("editor")),disabled:Dt(_).selecting,placeholder:Dt(M)("el.datepicker.endDate"),"model-value":Dt(U),readonly:!Dt(v),"validate-event":!1,onInput:t[5]||(t[5]=e=>le(e,"max")),onChange:t[6]||(t[6]=e=>ue(0,"max"))},null,8,["class","disabled","placeholder","model-value","readonly"])],2),ar((fi(),yi("span",{class:l(Dt(x).e("time-picker-wrap"))},[Mi(Dt(mx),{size:"small",class:l(Dt(x).e("editor")),disabled:Dt(_).selecting,placeholder:Dt(M)("el.datepicker.endTime"),"model-value":Dt(F),readonly:!Dt(v),"validate-event":!1,onFocus:t[7]||(t[7]=e=>Dt(v)&&(ae.value=!0)),onInput:t[8]||(t[8]=e=>ce(e,"max")),onChange:t[9]||(t[9]=e=>de(0,"max"))},null,8,["class","disabled","placeholder","model-value","readonly"]),Mi(Dt(hT),{"datetime-role":"end",visible:ae.value,format:Dt(V),"time-arrow-control":Dt(u),"parsed-value":g.value,onPick:pe},null,8,["visible","format","time-arrow-control","parsed-value"])],2)),[[Dt(EC),oe]])],2)],2)):Li("v-if",!0),Ti("div",{class:l([[Dt(b).e("content"),Dt(x).e("content")],"is-left"])},[Ti("div",{class:l(Dt(x).e("header"))},[Ti("button",{type:"button",class:l([Dt(b).e("icon-btn"),"d-arrow-left"]),onClick:H},[Mi(Dt(ib),null,{default:vn((()=>[Mi(Dt(ff))])),_:1})],2),Ti("button",{type:"button",class:l([Dt(b).e("icon-btn"),"arrow-left"]),onClick:j},[Mi(Dt(ib),null,{default:vn((()=>[Mi(Dt(dp))])),_:1})],2),e.unlinkPanels?(fi(),yi("button",{key:0,type:"button",disabled:!Dt(Q),class:l([[Dt(b).e("icon-btn"),{"is-disabled":!Dt(Q)}],"d-arrow-right"]),onClick:$},[Mi(Dt(ib),null,{default:vn((()=>[Mi(Dt(yf))])),_:1})],10,VP)):Li("v-if",!0),e.unlinkPanels?(fi(),yi("button",{key:1,type:"button",disabled:!Dt(J),class:l([[Dt(b).e("icon-btn"),{"is-disabled":!Dt(J)}],"arrow-right"]),onClick:X},[Mi(Dt(ib),null,{default:vn((()=>[Mi(Dt(mp))])),_:1})],10,GP)):Li("v-if",!0),Ti("div",null,f(Dt(R)),1)],2),Mi(fP,{"selection-mode":"range",date:m.value,"min-date":Dt(v),"max-date":Dt(y),"range-state":Dt(_),"disabled-date":Dt(i),"cell-class-name":Dt(a),onChangerange:Dt(w),onPick:re,onSelect:Dt(T)},null,8,["date","min-date","max-date","range-state","disabled-date","cell-class-name","onChangerange","onSelect"])],2),Ti("div",{class:l([[Dt(b).e("content"),Dt(x).e("content")],"is-right"])},[Ti("div",{class:l(Dt(x).e("header"))},[e.unlinkPanels?(fi(),yi("button",{key:0,type:"button",disabled:!Dt(Q),class:l([[Dt(b).e("icon-btn"),{"is-disabled":!Dt(Q)}],"d-arrow-left"]),onClick:q},[Mi(Dt(ib),null,{default:vn((()=>[Mi(Dt(ff))])),_:1})],10,HP)):Li("v-if",!0),e.unlinkPanels?(fi(),yi("button",{key:1,type:"button",disabled:!Dt(J),class:l([[Dt(b).e("icon-btn"),{"is-disabled":!Dt(J)}],"arrow-left"]),onClick:K},[Mi(Dt(ib),null,{default:vn((()=>[Mi(Dt(dp))])),_:1})],10,jP)):Li("v-if",!0),Ti("button",{type:"button",class:l([Dt(b).e("icon-btn"),"d-arrow-right"]),onClick:W},[Mi(Dt(ib),null,{default:vn((()=>[Mi(Dt(yf))])),_:1})],2),Ti("button",{type:"button",class:l([Dt(b).e("icon-btn"),"arrow-right"]),onClick:Y},[Mi(Dt(ib),null,{default:vn((()=>[Mi(Dt(mp))])),_:1})],2),Ti("div",null,f(Dt(L)),1)],2),Mi(fP,{"selection-mode":"range",date:g.value,"min-date":Dt(v),"max-date":Dt(y),"range-state":Dt(_),"disabled-date":Dt(i),"cell-class-name":Dt(a),onChangerange:Dt(w),onPick:re,onSelect:Dt(T)},null,8,["date","min-date","max-date","range-state","disabled-date","cell-class-name","onChangerange","onSelect"])],2)],2)],2),Dt(te)?(fi(),yi("div",{key:0,class:l(Dt(b).e("footer"))},[Dt(c)?(fi(),_i(Dt(jS),{key:0,text:"",size:"small",class:l(Dt(b).e("link-btn")),onClick:fe},{default:vn((()=>[Pi(f(Dt(M)("el.datepicker.clear")),1)])),_:1},8,["class"])):Li("v-if",!0),Mi(Dt(jS),{plain:"",size:"small",class:l(Dt(b).e("link-btn")),disabled:Dt(ee),onClick:t[10]||(t[10]=e=>Dt(S)(!1))},{default:vn((()=>[Pi(f(Dt(M)("el.datepicker.confirm")),1)])),_:1},8,["class","disabled"])],2)):Li("v-if",!0)],2))}});var $P=J_(YP,[["__file","/home/runner/work/element-plus/element-plus/packages/components/date-picker/src/date-picker-com/panel-date-range.vue"]]);const XP=pg({...nP}),qP=["onClick"],KP=["disabled"],ZP=["disabled"],JP="year",QP=Fn({name:"DatePickerMonthRange"}),eR=Fn({...QP,props:XP,emits:["pick","set-picker-option"],setup(e,{emit:t}){const n=e,{lang:r}=Jg(),i=Sn("EP_PICKER_BASE"),{shortcuts:a,disabledDate:s,format:o}=i.props,u=Ut(i.props,"defaultValue"),c=At(XS().locale(r.value)),d=At(XS().locale(r.value).add(1,JP)),{minDate:h,maxDate:p,rangeState:m,ppNs:g,drpNs:v,handleChangeRange:y,handleRangeConfirm:_,handleShortcutClick:b,onSelect:x}=zP(n,{defaultValue:u,leftDate:c,rightDate:d,unit:JP,onParsedValueChanged:function(e,t){if(n.unlinkPanels&&t){const n=(null==e?void 0:e.year())||0,r=t.year();d.value=n===r?t.add(1,JP):t}else d.value=c.value.add(1,JP)}}),w=Ki((()=>!!a.length)),{leftPrevYear:S,rightNextYear:C,leftNextYear:T,rightPrevYear:M,leftLabel:E,rightLabel:A,leftYear:P,rightYear:R}=(({unlinkPanels:e,leftDate:t,rightDate:n})=>{const{t:r}=Jg();return{leftPrevYear:()=>{t.value=t.value.subtract(1,"year"),e.value||(n.value=n.value.subtract(1,"year"))},rightNextYear:()=>{e.value||(t.value=t.value.add(1,"year")),n.value=n.value.add(1,"year")},leftNextYear:()=>{t.value=t.value.add(1,"year")},rightPrevYear:()=>{n.value=n.value.subtract(1,"year")},leftLabel:Ki((()=>`${t.value.year()} ${r("el.datepicker.year")}`)),rightLabel:Ki((()=>`${n.value.year()} ${r("el.datepicker.year")}`)),leftYear:Ki((()=>t.value.year())),rightYear:Ki((()=>n.value.year()===t.value.year()?t.value.year()+1:n.value.year()))}})({unlinkPanels:Ut(n,"unlinkPanels"),leftDate:c,rightDate:d}),L=Ki((()=>n.unlinkPanels&&R.value>P.value+1)),k=(e,t=!0)=>{const n=e.minDate,r=e.maxDate;p.value===r&&h.value===n||(p.value=r,h.value=n,t&&_())};return t("set-picker-option",["formatToString",e=>e.map((e=>e.format(o)))]),(e,t)=>(fi(),yi("div",{class:l([Dt(g).b(),Dt(v).b(),{"has-sidebar":Boolean(e.$slots.sidebar)||Dt(w)}])},[Ti("div",{class:l(Dt(g).e("body-wrapper"))},[vr(e.$slots,"sidebar",{class:l(Dt(g).e("sidebar"))}),Dt(w)?(fi(),yi("div",{key:0,class:l(Dt(g).e("sidebar"))},[(fi(!0),yi(li,null,mr(Dt(a),((e,t)=>(fi(),yi("button",{key:t,type:"button",class:l(Dt(g).e("shortcut")),onClick:t=>Dt(b)(e)},f(e.text),11,qP)))),128))],2)):Li("v-if",!0),Ti("div",{class:l(Dt(g).e("body"))},[Ti("div",{class:l([[Dt(g).e("content"),Dt(v).e("content")],"is-left"])},[Ti("div",{class:l(Dt(v).e("header"))},[Ti("button",{type:"button",class:l([Dt(g).e("icon-btn"),"d-arrow-left"]),onClick:t[0]||(t[0]=(...e)=>Dt(S)&&Dt(S)(...e))},[Mi(Dt(ib),null,{default:vn((()=>[Mi(Dt(ff))])),_:1})],2),e.unlinkPanels?(fi(),yi("button",{key:0,type:"button",disabled:!Dt(L),class:l([[Dt(g).e("icon-btn"),{[Dt(g).is("disabled")]:!Dt(L)}],"d-arrow-right"]),onClick:t[1]||(t[1]=(...e)=>Dt(T)&&Dt(T)(...e))},[Mi(Dt(ib),null,{default:vn((()=>[Mi(Dt(yf))])),_:1})],10,KP)):Li("v-if",!0),Ti("div",null,f(Dt(E)),1)],2),Mi(bP,{"selection-mode":"range",date:c.value,"min-date":Dt(h),"max-date":Dt(p),"range-state":Dt(m),"disabled-date":Dt(s),onChangerange:Dt(y),onPick:k,onSelect:Dt(x)},null,8,["date","min-date","max-date","range-state","disabled-date","onChangerange","onSelect"])],2),Ti("div",{class:l([[Dt(g).e("content"),Dt(v).e("content")],"is-right"])},[Ti("div",{class:l(Dt(v).e("header"))},[e.unlinkPanels?(fi(),yi("button",{key:0,type:"button",disabled:!Dt(L),class:l([[Dt(g).e("icon-btn"),{"is-disabled":!Dt(L)}],"d-arrow-left"]),onClick:t[2]||(t[2]=(...e)=>Dt(M)&&Dt(M)(...e))},[Mi(Dt(ib),null,{default:vn((()=>[Mi(Dt(ff))])),_:1})],10,ZP)):Li("v-if",!0),Ti("button",{type:"button",class:l([Dt(g).e("icon-btn"),"d-arrow-right"]),onClick:t[3]||(t[3]=(...e)=>Dt(C)&&Dt(C)(...e))},[Mi(Dt(ib),null,{default:vn((()=>[Mi(Dt(yf))])),_:1})],2),Ti("div",null,f(Dt(A)),1)],2),Mi(bP,{"selection-mode":"range",date:d.value,"min-date":Dt(h),"max-date":Dt(p),"range-state":Dt(m),"disabled-date":Dt(s),onChangerange:Dt(y),onPick:k,onSelect:Dt(x)},null,8,["date","min-date","max-date","range-state","disabled-date","onChangerange","onSelect"])],2)],2)],2)],2))}});var tR=J_(eR,[["__file","/home/runner/work/element-plus/element-plus/packages/components/date-picker/src/date-picker-com/panel-month-range.vue"]]);XS.extend(ST),XS.extend(UA),XS.extend(KS),XS.extend(GA),XS.extend(jA),XS.extend(YA),XS.extend(XA),XS.extend(KA);const nR=Fn({name:"ElDatePicker",install:null,props:{...hC,...JA},emits:["update:modelValue"],setup(e,{expose:t,emit:n,slots:r}){const i=rv("picker-panel");wn("ElPopperOptions",pt(Ut(e,"popperOptions"))),wn(ZA,{slots:r,pickerNs:i});const a=At();t({focus:(e=!0)=>{var t;null==(t=a.value)||t.focus(e)},handleOpen:()=>{var e;null==(e=a.value)||e.handleOpen()},handleClose:()=>{var e;null==(e=a.value)||e.handleClose()}});const s=e=>{n("update:modelValue",e)};return()=>{var t;const n=null!=(t=e.format)?t:eC[e.type]||QS,i=function(e){switch(e){case"daterange":case"datetimerange":return $P;case"monthrange":return tR;default:return BP}}(e.type);return Mi(vC,Oi(e,{format:n,type:e.type,ref:a,"onUpdate:modelValue":s}),{default:e=>Mi(i,e,null),"range-separator":r["range-separator"]})}}});nR.install=e=>{e.component(nR.name,nR)};const rR=nR,iR=Symbol("elDescriptions");var aR=Fn({name:"ElDescriptionsCell",props:{cell:{type:Object},tag:{type:String},type:{type:String}},setup:()=>({descriptions:Sn(iR,{})}),render(){var e,t,n,r,i,a;const s=(e=>{if(!bi(e))return{};const t=e.props||{},n=(bi(e.type)?e.type.props:void 0)||{},r={};return Object.keys(n).forEach((e=>{M(n[e],"default")&&(r[e]=n[e].default)})),Object.keys(t).forEach((e=>{r[W(e)]=t[e]})),r})(this.cell),{border:o,direction:l}=this.descriptions,u="vertical"===l,c=(null==(n=null==(t=null==(e=this.cell)?void 0:e.children)?void 0:t.label)?void 0:n.call(t))||s.label,d=null==(a=null==(i=null==(r=this.cell)?void 0:r.children)?void 0:i.default)?void 0:a.call(i),h=s.span,p=s.align?`is-${s.align}`:"",f=s.labelAlign?`is-${s.labelAlign}`:p,m=s.className,g=s.labelClassName,v={width:Zh(s.width),minWidth:Zh(s.minWidth)},y=rv("descriptions");switch(this.type){case"label":return ea(this.tag,{style:v,class:[y.e("cell"),y.e("label"),y.is("bordered-label",o),y.is("vertical-label",u),f,g],colSpan:u?h:1},c);case"content":return ea(this.tag,{style:v,class:[y.e("cell"),y.e("content"),y.is("bordered-content",o),y.is("vertical-content",u),p,m],colSpan:u?h:2*h-1},d);default:return ea("td",{style:v,class:[y.e("cell"),p],colSpan:h},[Ah(c)?void 0:ea("span",{class:[y.e("label"),g]},c),ea("span",{class:[y.e("content"),m]},d)])}}});const sR=pg({row:{type:Array,default:()=>[]}}),oR={key:1},lR=Fn({name:"ElDescriptionsRow"});var uR=J_(Fn({...lR,props:sR,setup(e){const t=Sn(iR,{});return(e,n)=>"vertical"===Dt(t).direction?(fi(),yi(li,{key:0},[Ti("tr",null,[(fi(!0),yi(li,null,mr(e.row,((e,t)=>(fi(),_i(Dt(aR),{key:`tr1-${t}`,cell:e,tag:"th",type:"label"},null,8,["cell"])))),128))]),Ti("tr",null,[(fi(!0),yi(li,null,mr(e.row,((e,t)=>(fi(),_i(Dt(aR),{key:`tr2-${t}`,cell:e,tag:"td",type:"content"},null,8,["cell"])))),128))])],64)):(fi(),yi("tr",oR,[(fi(!0),yi(li,null,mr(e.row,((e,n)=>(fi(),yi(li,{key:`tr3-${n}`},[Dt(t).border?(fi(),yi(li,{key:0},[Mi(Dt(aR),{cell:e,tag:"td",type:"label"},null,8,["cell"]),Mi(Dt(aR),{cell:e,tag:"td",type:"content"},null,8,["cell"])],64)):(fi(),_i(Dt(aR),{key:1,cell:e,tag:"td",type:"both"},null,8,["cell"]))],64)))),128))]))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/descriptions/src/descriptions-row.vue"]]);const cR=pg({border:{type:Boolean,default:!1},column:{type:Number,default:3},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},size:z_,title:{type:String,default:""},extra:{type:String,default:""}}),dR=Fn({name:"ElDescriptions"}),hR=Fn({...dR,props:cR,setup(e){const t=e,n=rv("descriptions"),r=db(),i=Zi();wn(iR,t);const a=Ki((()=>[n.b(),n.m(r.value)])),s=(e,t,n,r=!1)=>(e.props||(e.props={}),t>n&&(e.props.span=n),r&&(e.props.span=t),e),o=()=>{var e;const n=Og(null==(e=i.default)?void 0:e.call(i)).filter((e=>{var t;return"ElDescriptionsItem"===(null==(t=null==e?void 0:e.type)?void 0:t.name)})),r=[];let a=[],o=t.column,l=0;return n.forEach(((e,i)=>{var u;const c=(null==(u=e.props)?void 0:u.span)||1;if(i<n.length-1&&(l+=c>o?o:c),i===n.length-1){const n=t.column-l%t.column;return a.push(s(e,n,o,!0)),void r.push(a)}c<o?(o-=c,a.push(e)):(a.push(s(e,c,o)),r.push(a),o=t.column,a=[])})),r};return(e,t)=>(fi(),yi("div",{class:l(Dt(a))},[e.title||e.extra||e.$slots.title||e.$slots.extra?(fi(),yi("div",{key:0,class:l(Dt(n).e("header"))},[Ti("div",{class:l(Dt(n).e("title"))},[vr(e.$slots,"title",{},(()=>[Pi(f(e.title),1)]))],2),Ti("div",{class:l(Dt(n).e("extra"))},[vr(e.$slots,"extra",{},(()=>[Pi(f(e.extra),1)]))],2)],2)):Li("v-if",!0),Ti("div",{class:l(Dt(n).e("body"))},[Ti("table",{class:l([Dt(n).e("table"),Dt(n).is("bordered",e.border)])},[Ti("tbody",null,[(fi(!0),yi(li,null,mr(o(),((e,t)=>(fi(),_i(uR,{key:t,row:e},null,8,["row"])))),128))])],2)],2)],2))}});var pR=J_(hR,[["__file","/home/runner/work/element-plus/element-plus/packages/components/descriptions/src/description.vue"]]),fR=Fn({name:"ElDescriptionsItem",props:{label:{type:String,default:""},span:{type:Number,default:1},width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},align:{type:String,default:"left"},labelAlign:{type:String,default:""},className:{type:String,default:""},labelClassName:{type:String,default:""}}});const mR=_g(pR,{DescriptionsItem:fR}),gR=xg(fR),vR=pg({mask:{type:Boolean,default:!0},customMaskEvent:{type:Boolean,default:!1},overlayClass:{type:[String,Array,Object]},zIndex:{type:[String,Number]}});var yR=Fn({name:"ElOverlay",props:vR,emits:{click:e=>e instanceof MouseEvent},setup(e,{slots:t,emit:n}){const r=rv("overlay"),{onClick:i,onMousedown:a,onMouseup:s}=Py(e.customMaskEvent?void 0:e=>{n("click",e)});return()=>e.mask?Mi("div",{class:[r.b(),e.overlayClass],style:{zIndex:e.zIndex},onClick:i,onMousedown:a,onMouseup:s},[vr(t,"default")],kg.STYLE|kg.CLASS|kg.PROPS,["onClick","onMouseup","onMousedown"]):ea("div",{class:e.overlayClass,style:{zIndex:e.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[vr(t,"default")])}});const _R=yR,bR=Symbol("dialogInjectionKey"),xR=pg({center:{type:Boolean,default:!1},alignCenter:{type:Boolean,default:!1},closeIcon:{type:fg},customClass:{type:String,default:""},draggable:{type:Boolean,default:!1},fullscreen:{type:Boolean,default:!1},showClose:{type:Boolean,default:!0},title:{type:String,default:""}}),wR=["aria-label"],SR=["id"],CR=Fn({name:"ElDialogContent"}),TR=Fn({...CR,props:xR,emits:{close:()=>!0},setup(e){const t=e,{t:n}=Jg(),{Close:i}=mg,{dialogRef:a,headerRef:s,bodyId:o,ns:u,style:c}=Sn(bR),{focusTrapRef:d}=Sn(Yx),h=wg(d,a),p=Ki((()=>t.draggable));return $g(a,s,p),(e,t)=>(fi(),yi("div",{ref:Dt(h),class:l([Dt(u).b(),Dt(u).is("fullscreen",e.fullscreen),Dt(u).is("draggable",Dt(p)),Dt(u).is("align-center",e.alignCenter),{[Dt(u).m("center")]:e.center},e.customClass]),style:r(Dt(c)),tabindex:"-1"},[Ti("header",{ref_key:"headerRef",ref:s,class:l(Dt(u).e("header"))},[vr(e.$slots,"header",{},(()=>[Ti("span",{role:"heading",class:l(Dt(u).e("title"))},f(e.title),3)])),e.showClose?(fi(),yi("button",{key:0,"aria-label":Dt(n)("el.dialog.close"),class:l(Dt(u).e("headerbtn")),type:"button",onClick:t[0]||(t[0]=t=>e.$emit("close"))},[Mi(Dt(ib),{class:l(Dt(u).e("close"))},{default:vn((()=>[(fi(),_i(dr(e.closeIcon||Dt(i))))])),_:1},8,["class"])],10,wR)):Li("v-if",!0)],2),Ti("div",{id:Dt(o),class:l(Dt(u).e("body"))},[vr(e.$slots,"default")],10,SR),e.$slots.footer?(fi(),yi("footer",{key:0,class:l(Dt(u).e("footer"))},[vr(e.$slots,"footer")],2)):Li("v-if",!0)],6))}});var MR=J_(TR,[["__file","/home/runner/work/element-plus/element-plus/packages/components/dialog/src/dialog-content.vue"]]);const ER=pg({...xR,appendToBody:{type:Boolean,default:!1},beforeClose:{type:Function},destroyOnClose:{type:Boolean,default:!1},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:{type:Boolean,default:!1},modalClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:{type:Boolean,default:!1}}),AR={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[Tg]:e=>Ns(e),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},PR=(e,t)=>{const n=Fi().emit,{nextZIndex:r}=Yy();let i="";const a=Iy(),s=Iy(),o=At(!1),l=At(!1),u=At(!1),c=At(e.zIndex||r());let d,h;const p=H_("namespace",Qg),f=Ki((()=>{const t={},n=`--${p.value}-dialog`;return e.fullscreen||(e.top&&(t[`${n}-margin-top`]=e.top),e.width&&(t[`${n}-width`]=Zh(e.width))),t})),m=Ki((()=>e.alignCenter?{display:"flex"}:{}));function g(){null==h||h(),null==d||d(),e.openDelay&&e.openDelay>0?({stop:d}=$s((()=>_()),e.openDelay)):_()}function v(){null==d||d(),null==h||h(),e.closeDelay&&e.closeDelay>0?({stop:h}=$s((()=>b()),e.closeDelay)):b()}function y(){e.beforeClose?e.beforeClose((function(e){e||(l.value=!0,o.value=!1)})):v()}function _(){Os&&(o.value=!0)}function b(){o.value=!1}return e.lockScroll&&iv(o),Mn((()=>e.modelValue),(i=>{i?(l.value=!1,g(),u.value=!0,c.value=e.zIndex?c.value++:r(),en((()=>{n("open"),t.value&&(t.value.scrollTop=0)}))):o.value&&v()})),Mn((()=>e.fullscreen),(e=>{t.value&&(e?(i=t.value.style.transform,t.value.style.transform=""):t.value.style.transform=i)})),Kn((()=>{e.modelValue&&(o.value=!0,u.value=!0,g())})),{afterEnter:function(){n("opened")},afterLeave:function(){n("closed"),n(Tg,!1),e.destroyOnClose&&(u.value=!1)},beforeLeave:function(){n("close")},handleClose:y,onModalClick:function(){e.closeOnClickModal&&y()},close:v,doClose:b,onOpenAutoFocus:function(){n("openAutoFocus")},onCloseAutoFocus:function(){n("closeAutoFocus")},onCloseRequested:function(){e.closeOnPressEscape&&y()},onFocusoutPrevented:function(e){var t;"pointer"===(null==(t=e.detail)?void 0:t.focusReason)&&e.preventDefault()},titleId:a,bodyId:s,closed:l,style:f,overlayDialogStyle:m,rendered:u,visible:o,zIndex:c}},RR=["aria-label","aria-labelledby","aria-describedby"],LR=Fn({name:"ElDialog",inheritAttrs:!1});const kR=_g(J_(Fn({...LR,props:ER,emits:AR,setup(e,{expose:t}){const n=e,i=Zi();Yg({scope:"el-dialog",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/dialog.html#slots"},Ki((()=>!!i.title))),Yg({scope:"el-dialog",from:"custom-class",replacement:"class",version:"2.3.0",ref:"https://element-plus.org/en-US/component/dialog.html#attributes",type:"Attribute"},Ki((()=>!!n.customClass)));const a=rv("dialog"),s=At(),o=At(),u=At(),{visible:c,titleId:d,bodyId:h,style:p,overlayDialogStyle:f,rendered:m,zIndex:g,afterEnter:v,afterLeave:y,beforeLeave:_,handleClose:b,onModalClick:x,onOpenAutoFocus:w,onCloseAutoFocus:S,onCloseRequested:C,onFocusoutPrevented:T}=PR(n,s);wn(bR,{dialogRef:s,headerRef:o,bodyId:h,ns:a,rendered:m,style:p});const M=Py(x),E=Ki((()=>n.draggable&&!n.fullscreen));return t({visible:c,dialogContentRef:u}),(e,t)=>(fi(),_i(si,{to:"body",disabled:!e.appendToBody},[Mi(xa,{name:"dialog-fade",onAfterEnter:Dt(v),onAfterLeave:Dt(y),onBeforeLeave:Dt(_),persisted:""},{default:vn((()=>[ar(Mi(Dt(_R),{"custom-mask-event":"",mask:e.modal,"overlay-class":e.modalClass,"z-index":Dt(g)},{default:vn((()=>[Ti("div",{role:"dialog","aria-modal":"true","aria-label":e.title||void 0,"aria-labelledby":e.title?void 0:Dt(d),"aria-describedby":Dt(h),class:l(`${Dt(a).namespace.value}-overlay-dialog`),style:r(Dt(f)),onClick:t[0]||(t[0]=(...e)=>Dt(M).onClick&&Dt(M).onClick(...e)),onMousedown:t[1]||(t[1]=(...e)=>Dt(M).onMousedown&&Dt(M).onMousedown(...e)),onMouseup:t[2]||(t[2]=(...e)=>Dt(M).onMouseup&&Dt(M).onMouseup(...e))},[Mi(Dt(ow),{loop:"",trapped:Dt(c),"focus-start-el":"container",onFocusAfterTrapped:Dt(w),onFocusAfterReleased:Dt(S),onFocusoutPrevented:Dt(T),onReleaseRequested:Dt(C)},{default:vn((()=>[Dt(m)?(fi(),_i(MR,Oi({key:0,ref_key:"dialogContentRef",ref:u},e.$attrs,{"custom-class":e.customClass,center:e.center,"align-center":e.alignCenter,"close-icon":e.closeIcon,draggable:Dt(E),fullscreen:e.fullscreen,"show-close":e.showClose,title:e.title,onClose:Dt(b)}),gr({header:vn((()=>[e.$slots.title?vr(e.$slots,"title",{key:1}):vr(e.$slots,"header",{key:0,close:Dt(b),titleId:Dt(d),titleClass:Dt(a).e("title")})])),default:vn((()=>[vr(e.$slots,"default")])),_:2},[e.$slots.footer?{name:"footer",fn:vn((()=>[vr(e.$slots,"footer")]))}:void 0]),1040,["custom-class","center","align-center","close-icon","draggable","fullscreen","show-close","title","onClose"])):Li("v-if",!0)])),_:3},8,["trapped","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])],46,RR)])),_:3},8,["mask","overlay-class","z-index"]),[[is,Dt(c)]])])),_:3},8,["onAfterEnter","onAfterLeave","onBeforeLeave"])],8,["disabled"]))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/dialog/src/dialog.vue"]])),DR=pg({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},contentPosition:{type:String,values:["left","center","right"],default:"center"},borderStyle:{type:String,default:"solid"}}),IR=Fn({name:"ElDivider"});const OR=_g(J_(Fn({...IR,props:DR,setup(e){const t=e,n=rv("divider"),i=Ki((()=>n.cssVar({"border-style":t.borderStyle})));return(e,t)=>(fi(),yi("div",{class:l([Dt(n).b(),Dt(n).m(e.direction)]),style:r(Dt(i)),role:"separator"},[e.$slots.default&&"vertical"!==e.direction?(fi(),yi("div",{key:0,class:l([Dt(n).e("text"),Dt(n).is(e.contentPosition)])},[vr(e.$slots,"default")],2)):Li("v-if",!0)],6))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/divider/src/divider.vue"]])),NR=pg({...ER,direction:{type:String,default:"rtl",values:["ltr","rtl","ttb","btt"]},size:{type:[String,Number],default:"30%"},withHeader:{type:Boolean,default:!0},modalFade:{type:Boolean,default:!0}}),BR=Fn({name:"ElDrawer",components:{ElOverlay:_R,ElFocusTrap:ow,ElIcon:ib,Close:cf},inheritAttrs:!1,props:NR,emits:AR,setup(e,{slots:t}){Yg({scope:"el-drawer",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/drawer.html#slots"},Ki((()=>!!t.title))),Yg({scope:"el-drawer",from:"custom-class",replacement:"class",version:"2.3.0",ref:"https://element-plus.org/en-US/component/drawer.html#attributes",type:"Attribute"},Ki((()=>!!e.customClass)));const n=At(),r=At(),i=rv("drawer"),{t:a}=Jg(),s=Ki((()=>"rtl"===e.direction||"ltr"===e.direction)),o=Ki((()=>Zh(e.size)));return{...PR(e,n),drawerRef:n,focusStartRef:r,isHorizontal:s,drawerSize:o,ns:i,t:a}}}),UR=["aria-label","aria-labelledby","aria-describedby"],zR=["id"],FR=["aria-label"],VR=["id"];const GR=_g(J_(BR,[["render",function(e,t,n,r,i,a){const s=ur("close"),o=ur("el-icon"),u=ur("el-focus-trap"),c=ur("el-overlay");return fi(),_i(si,{to:"body",disabled:!e.appendToBody},[Mi(xa,{name:e.ns.b("fade"),onAfterEnter:e.afterEnter,onAfterLeave:e.afterLeave,onBeforeLeave:e.beforeLeave,persisted:""},{default:vn((()=>[ar(Mi(c,{mask:e.modal,"overlay-class":e.modalClass,"z-index":e.zIndex,onClick:e.onModalClick},{default:vn((()=>[Mi(u,{loop:"",trapped:e.visible,"focus-trap-el":e.drawerRef,"focus-start-el":e.focusStartRef,onReleaseRequested:e.onCloseRequested},{default:vn((()=>[Ti("div",Oi({ref:"drawerRef","aria-modal":"true","aria-label":e.title||void 0,"aria-labelledby":e.title?void 0:e.titleId,"aria-describedby":e.bodyId},e.$attrs,{class:[e.ns.b(),e.direction,e.visible&&"open",e.customClass],style:e.isHorizontal?"width: "+e.drawerSize:"height: "+e.drawerSize,role:"dialog",onClick:t[1]||(t[1]=ts((()=>{}),["stop"]))}),[Ti("span",{ref:"focusStartRef",class:l(e.ns.e("sr-focus")),tabindex:"-1"},null,2),e.withHeader?(fi(),yi("header",{key:0,class:l(e.ns.e("header"))},[e.$slots.title?vr(e.$slots,"title",{key:1},(()=>[Li(" DEPRECATED SLOT ")])):vr(e.$slots,"header",{key:0,close:e.handleClose,titleId:e.titleId,titleClass:e.ns.e("title")},(()=>[e.$slots.title?Li("v-if",!0):(fi(),yi("span",{key:0,id:e.titleId,role:"heading",class:l(e.ns.e("title"))},f(e.title),11,zR))])),e.showClose?(fi(),yi("button",{key:2,"aria-label":e.t("el.drawer.close"),class:l(e.ns.e("close-btn")),type:"button",onClick:t[0]||(t[0]=(...t)=>e.handleClose&&e.handleClose(...t))},[Mi(o,{class:l(e.ns.e("close"))},{default:vn((()=>[Mi(s)])),_:1},8,["class"])],10,FR)):Li("v-if",!0)],2)):Li("v-if",!0),e.rendered?(fi(),yi("div",{key:1,id:e.bodyId,class:l(e.ns.e("body"))},[vr(e.$slots,"default")],10,VR)):Li("v-if",!0),e.$slots.footer?(fi(),yi("div",{key:2,class:l(e.ns.e("footer"))},[vr(e.$slots,"footer")],2)):Li("v-if",!0)],16,UR)])),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])])),_:3},8,["mask","overlay-class","z-index","onClick"]),[[is,e.visible]])])),_:3},8,["name","onAfterEnter","onAfterLeave","onBeforeLeave"])],8,["disabled"])}],["__file","/home/runner/work/element-plus/element-plus/packages/components/drawer/src/drawer.vue"]]));var HR=J_(Fn({inheritAttrs:!1}),[["render",function(e,t,n,r,i,a){return vr(e.$slots,"default")}],["__file","/home/runner/work/element-plus/element-plus/packages/components/collection/src/collection.vue"]]);var jR=J_(Fn({name:"ElCollectionItem",inheritAttrs:!1}),[["render",function(e,t,n,r,i,a){return vr(e.$slots,"default")}],["__file","/home/runner/work/element-plus/element-plus/packages/components/collection/src/collection-item.vue"]]);const WR="data-el-collection-item",YR=e=>{const t=`El${e}Collection`,n=`${t}Item`,r=Symbol(t),i=Symbol(n),a={...HR,name:t,setup(){const e=At(null),t=new Map;wn(r,{itemMap:t,getItems:()=>{const n=Dt(e);if(!n)return[];const r=Array.from(n.querySelectorAll(`[${WR}]`));return[...t.values()].sort(((e,t)=>r.indexOf(e.ref)-r.indexOf(t.ref)))},collectionRef:e})}},s={...jR,name:n,setup(e,{attrs:t}){const n=At(null),a=Sn(r,void 0);wn(i,{collectionItemRef:n}),Kn((()=>{const e=Dt(n);e&&a.itemMap.set(e,{ref:e,...t})})),Qn((()=>{const e=Dt(n);a.itemMap.delete(e)}))}};return{COLLECTION_INJECTION_KEY:r,COLLECTION_ITEM_INJECTION_KEY:i,ElCollection:a,ElCollectionItem:s}},$R=pg({style:{type:[String,Array,Object]},currentTabId:{type:String},defaultCurrentTabId:String,loop:Boolean,dir:{type:String,values:["ltr","rtl"],default:"ltr"},orientation:{type:String},onBlur:Function,onFocus:Function,onMousedown:Function}),{ElCollection:XR,ElCollectionItem:qR,COLLECTION_INJECTION_KEY:KR,COLLECTION_ITEM_INJECTION_KEY:ZR}=YR("RovingFocusGroup"),JR=Symbol("elRovingFocusGroup"),QR=Symbol("elRovingFocusGroupItem"),eL={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"},tL=(e,t,n)=>{const r=((e,t)=>{if("rtl"!==t)return e;switch(e){case Sg.right:return Sg.left;case Sg.left:return Sg.right;default:return e}})(e.key,n);if(!("vertical"===t&&[Sg.left,Sg.right].includes(r)||"horizontal"===t&&[Sg.up,Sg.down].includes(r)))return eL[r]},nL=e=>{const{activeElement:t}=document;for(const n of e){if(n===t)return;if(n.focus(),t!==document.activeElement)return}},rL="currentTabIdChange",iL="rovingFocusGroup.entryFocus",aL={bubbles:!1,cancelable:!0},sL=Fn({name:"ElRovingFocusGroupImpl",inheritAttrs:!1,props:$R,emits:[rL,"entryFocus"],setup(e,{emit:t}){var n;const r=At(null!=(n=e.currentTabId||e.defaultCurrentTabId)?n:null),i=At(!1),a=At(!1),s=At(null),{getItems:o}=Sn(KR,void 0),l=Ki((()=>[{outline:"none"},e.style])),u=Cs((t=>{var n;null==(n=e.onMousedown)||n.call(e,t)}),(()=>{a.value=!0})),c=Cs((t=>{var n;null==(n=e.onFocus)||n.call(e,t)}),(e=>{const t=!Dt(a),{target:n,currentTarget:s}=e;if(n===s&&t&&!Dt(i)){const e=new Event(iL,aL);if(null==s||s.dispatchEvent(e),!e.defaultPrevented){const e=o().filter((e=>e.focusable)),t=[e.find((e=>e.active)),e.find((e=>e.id===Dt(r))),...e].filter(Boolean).map((e=>e.ref));nL(t)}}a.value=!1})),d=Cs((t=>{var n;null==(n=e.onBlur)||n.call(e,t)}),(()=>{i.value=!1}));wn(JR,{currentTabbedId:mt(r),loop:Ut(e,"loop"),tabIndex:Ki((()=>Dt(i)?-1:0)),rovingFocusGroupRef:s,rovingFocusGroupRootStyle:l,orientation:Ut(e,"orientation"),dir:Ut(e,"dir"),onItemFocus:e=>{t(rL,e)},onItemShiftTab:()=>{i.value=!0},onBlur:d,onFocus:c,onMousedown:u}),Mn((()=>e.currentTabId),(e=>{r.value=null!=e?e:null})),Zs(s,iL,((...e)=>{t("entryFocus",...e)}))}});var oL=J_(Fn({name:"ElRovingFocusGroup",components:{ElFocusGroupCollection:XR,ElRovingFocusGroupImpl:J_(sL,[["render",function(e,t,n,r,i,a){return vr(e.$slots,"default")}],["__file","/home/runner/work/element-plus/element-plus/packages/components/roving-focus-group/src/roving-focus-group-impl.vue"]])}}),[["render",function(e,t,n,r,i,a){const s=ur("el-roving-focus-group-impl"),o=ur("el-focus-group-collection");return fi(),_i(o,null,{default:vn((()=>[Mi(s,u(Ei(e.$attrs)),{default:vn((()=>[vr(e.$slots,"default")])),_:3},16)])),_:3})}],["__file","/home/runner/work/element-plus/element-plus/packages/components/roving-focus-group/src/roving-focus-group.vue"]]);const lL=Fn({components:{ElRovingFocusCollectionItem:qR},props:{focusable:{type:Boolean,default:!0},active:{type:Boolean,default:!1}},emits:["mousedown","focus","keydown"],setup(e,{emit:t}){const{currentTabbedId:n,loop:r,onItemFocus:i,onItemShiftTab:a}=Sn(JR,void 0),{getItems:s}=Sn(KR,void 0),o=Iy(),l=At(null),u=Cs((e=>{t("mousedown",e)}),(t=>{e.focusable?i(Dt(o)):t.preventDefault()})),c=Cs((e=>{t("focus",e)}),(()=>{i(Dt(o))})),d=Cs((e=>{t("keydown",e)}),(e=>{const{key:t,shiftKey:n,target:i,currentTarget:o}=e;if(t===Sg.tab&&n)return void a();if(i!==o)return;const l=tL(e);if(l){e.preventDefault();let t=s().filter((e=>e.focusable)).map((e=>e.ref));switch(l){case"last":t.reverse();break;case"prev":case"next":{"prev"===l&&t.reverse();const e=t.indexOf(o);t=r.value?(c=e+1,(u=t).map(((e,t)=>u[(t+c)%u.length]))):t.slice(e+1);break}}en((()=>{nL(t)}))}var u,c})),h=Ki((()=>n.value===Dt(o)));return wn(QR,{rovingFocusGroupItemRef:l,tabIndex:Ki((()=>Dt(h)?0:-1)),handleMousedown:u,handleFocus:c,handleKeydown:d}),{id:o,handleKeydown:d,handleFocus:c,handleMousedown:u}}});var uL=J_(lL,[["render",function(e,t,n,r,i,a){const s=ur("el-roving-focus-collection-item");return fi(),_i(s,{id:e.id,focusable:e.focusable,active:e.active},{default:vn((()=>[vr(e.$slots,"default")])),_:3},8,["id","focusable","active"])}],["__file","/home/runner/work/element-plus/element-plus/packages/components/roving-focus-group/src/roving-focus-item.vue"]]);const cL=pg({trigger:bw.trigger,effect:{..._w.effect,default:"light"},type:{type:String},placement:{type:String,default:"bottom"},popperOptions:{type:Object,default:()=>({})},id:String,size:{type:String,default:""},splitButton:Boolean,hideOnClick:{type:Boolean,default:!0},loop:{type:Boolean,default:!0},showTimeout:{type:Number,default:150},hideTimeout:{type:Number,default:150},tabindex:{type:[Number,String],default:0},maxHeight:{type:[Number,String],default:""},popperClass:{type:String,default:""},disabled:{type:Boolean,default:!1},role:{type:String,default:"menu"},buttonProps:{type:Object},teleported:_w.teleported}),dL=pg({command:{type:[Object,String,Number],default:()=>({})},disabled:Boolean,divided:Boolean,textValue:String,icon:{type:fg}}),hL=pg({onKeydown:{type:Function}}),pL=[Sg.down,Sg.pageDown,Sg.home],fL=[Sg.up,Sg.pageUp,Sg.end],mL=[...pL,...fL],{ElCollection:gL,ElCollectionItem:vL,COLLECTION_INJECTION_KEY:yL,COLLECTION_ITEM_INJECTION_KEY:_L}=YR("Dropdown"),bL=Symbol("elDropdown"),{ButtonGroup:xL}=jS,wL=Fn({name:"ElDropdown",components:{ElButton:jS,ElButtonGroup:xL,ElScrollbar:Tx,ElDropdownCollection:gL,ElTooltip:Ow,ElRovingFocusGroup:oL,ElOnlyChild:Ix,ElIcon:ib,ArrowDown:op},props:cL,emits:["visible-change","click","command"],setup(e,{emit:t}){const n=Fi(),r=rv("dropdown"),{t:i}=Jg(),a=At(),s=At(),o=At(null),l=At(null),u=At(null),c=At(null),d=At(!1),h=[Sg.enter,Sg.space,Sg.down],p=Ki((()=>({maxHeight:Zh(e.maxHeight)}))),f=Ki((()=>[r.m(y.value)])),m=Iy().value,g=Ki((()=>e.id||m));function v(){var e;null==(e=o.value)||e.onClose()}Mn([a,Ut(e,"trigger")],(([e,t],[n])=>{var r,i,a;const s=E(t)?t:[t];(null==(r=null==n?void 0:n.$el)?void 0:r.removeEventListener)&&n.$el.removeEventListener("pointerenter",_),(null==(i=null==e?void 0:e.$el)?void 0:i.removeEventListener)&&e.$el.removeEventListener("pointerenter",_),(null==(a=null==e?void 0:e.$el)?void 0:a.addEventListener)&&s.includes("hover")&&e.$el.addEventListener("pointerenter",_)}),{immediate:!0}),Qn((()=>{var e,t;(null==(t=null==(e=a.value)?void 0:e.$el)?void 0:t.removeEventListener)&&a.value.$el.removeEventListener("pointerenter",_)}));const y=db();function _(){var e,t;null==(t=null==(e=a.value)?void 0:e.$el)||t.focus()}wn(bL,{contentRef:l,role:Ki((()=>e.role)),triggerId:g,isUsingKeyboard:d,onItemEnter:function(){},onItemLeave:function(){const e=Dt(l);null==e||e.focus(),c.value=null}}),wn("elDropdown",{instance:n,dropdownSize:y,handleClick:function(){v()},commandHandler:function(...e){t("command",...e)},trigger:Ut(e,"trigger"),hideOnClick:Ut(e,"hideOnClick")});return{t:i,ns:r,scrollbar:u,wrapStyle:p,dropdownTriggerKls:f,dropdownSize:y,triggerId:g,triggerKeys:h,currentTabId:c,handleCurrentTabIdChange:function(e){c.value=e},handlerMainButtonClick:e=>{t("click",e)},handleEntryFocus:function(e){d.value||(e.preventDefault(),e.stopImmediatePropagation())},handleClose:v,handleOpen:function(){var e;null==(e=o.value)||e.onOpen()},handleBeforeShowTooltip:function(){t("visible-change",!0)},handleShowTooltip:function(e){"keydown"===(null==e?void 0:e.type)&&l.value.focus()},handleBeforeHideTooltip:function(){t("visible-change",!1)},onFocusAfterTrapped:e=>{var t,n;e.preventDefault(),null==(n=null==(t=l.value)?void 0:t.focus)||n.call(t,{preventScroll:!0})},popperRef:o,contentRef:l,triggeringElementRef:a,referenceElementRef:s}}});var SL=J_(wL,[["render",function(e,t,n,r,i,a){var s;const o=ur("el-dropdown-collection"),u=ur("el-roving-focus-group"),c=ur("el-scrollbar"),d=ur("el-only-child"),h=ur("el-tooltip"),p=ur("el-button"),f=ur("arrow-down"),m=ur("el-icon"),g=ur("el-button-group");return fi(),yi("div",{class:l([e.ns.b(),e.ns.is("disabled",e.disabled)])},[Mi(h,{ref:"popperRef",role:e.role,effect:e.effect,"fallback-placements":["bottom","top"],"popper-options":e.popperOptions,"gpu-acceleration":!1,"hide-after":"hover"===e.trigger?e.hideTimeout:0,"manual-mode":!0,placement:e.placement,"popper-class":[e.ns.e("popper"),e.popperClass],"reference-element":null==(s=e.referenceElementRef)?void 0:s.$el,trigger:e.trigger,"trigger-keys":e.triggerKeys,"trigger-target-el":e.contentRef,"show-after":"hover"===e.trigger?e.showTimeout:0,"stop-popper-mouse-event":!1,"virtual-ref":e.triggeringElementRef,"virtual-triggering":e.splitButton,disabled:e.disabled,transition:`${e.ns.namespace.value}-zoom-in-top`,teleported:e.teleported,pure:"",persistent:"",onBeforeShow:e.handleBeforeShowTooltip,onShow:e.handleShowTooltip,onBeforeHide:e.handleBeforeHideTooltip},gr({content:vn((()=>[Mi(c,{ref:"scrollbar","wrap-style":e.wrapStyle,tag:"div","view-class":e.ns.e("list")},{default:vn((()=>[Mi(u,{loop:e.loop,"current-tab-id":e.currentTabId,orientation:"horizontal",onCurrentTabIdChange:e.handleCurrentTabIdChange,onEntryFocus:e.handleEntryFocus},{default:vn((()=>[Mi(o,null,{default:vn((()=>[vr(e.$slots,"dropdown")])),_:3})])),_:3},8,["loop","current-tab-id","onCurrentTabIdChange","onEntryFocus"])])),_:3},8,["wrap-style","view-class"])])),_:2},[e.splitButton?void 0:{name:"default",fn:vn((()=>[Mi(d,{id:e.triggerId,ref:"triggeringElementRef",role:"button",tabindex:e.tabindex},{default:vn((()=>[vr(e.$slots,"default")])),_:3},8,["id","tabindex"])]))}]),1032,["role","effect","popper-options","hide-after","placement","popper-class","reference-element","trigger","trigger-keys","trigger-target-el","show-after","virtual-ref","virtual-triggering","disabled","transition","teleported","onBeforeShow","onShow","onBeforeHide"]),e.splitButton?(fi(),_i(g,{key:0},{default:vn((()=>[Mi(p,Oi({ref:"referenceElementRef"},e.buttonProps,{size:e.dropdownSize,type:e.type,disabled:e.disabled,tabindex:e.tabindex,onClick:e.handlerMainButtonClick}),{default:vn((()=>[vr(e.$slots,"default")])),_:3},16,["size","type","disabled","tabindex","onClick"]),Mi(p,Oi({id:e.triggerId,ref:"triggeringElementRef"},e.buttonProps,{role:"button",size:e.dropdownSize,type:e.type,class:e.ns.e("caret-button"),disabled:e.disabled,tabindex:e.tabindex,"aria-label":e.t("el.dropdown.toggleDropdown")}),{default:vn((()=>[Mi(m,{class:l(e.ns.e("icon"))},{default:vn((()=>[Mi(f)])),_:1},8,["class"])])),_:1},16,["id","size","type","class","disabled","tabindex","aria-label"])])),_:3})):Li("v-if",!0)],2)}],["__file","/home/runner/work/element-plus/element-plus/packages/components/dropdown/src/dropdown.vue"]]);const CL=Fn({name:"DropdownItemImpl",components:{ElIcon:ib},props:dL,emits:["pointermove","pointerleave","click","clickimpl"],setup(e,{emit:t}){const n=rv("dropdown"),{role:r}=Sn(bL,void 0),{collectionItemRef:i}=Sn(_L,void 0),{collectionItemRef:a}=Sn(ZR,void 0),{rovingFocusGroupItemRef:s,tabIndex:o,handleFocus:l,handleKeydown:u,handleMousedown:c}=Sn(QR,void 0),d=wg(i,a,s),h=Ki((()=>"menu"===r.value?"menuitem":"navigation"===r.value?"link":"button")),p=Cs((e=>{const{code:n}=e;if(n===Sg.enter||n===Sg.space)return e.preventDefault(),e.stopImmediatePropagation(),t("clickimpl",e),!0}),u);return{ns:n,itemRef:d,dataset:{[WR]:""},role:h,tabIndex:o,handleFocus:l,handleKeydown:p,handleMousedown:c}}}),TL=["aria-disabled","tabindex","role"];var ML=J_(CL,[["render",function(e,t,n,r,i,a){const s=ur("el-icon");return fi(),yi(li,null,[e.divided?(fi(),yi("li",Oi({key:0,role:"separator",class:e.ns.bem("menu","item","divided")},e.$attrs),null,16)):Li("v-if",!0),Ti("li",Oi({ref:e.itemRef},{...e.dataset,...e.$attrs},{"aria-disabled":e.disabled,class:[e.ns.be("menu","item"),e.ns.is("disabled",e.disabled)],tabindex:e.tabIndex,role:e.role,onClick:t[0]||(t[0]=t=>e.$emit("clickimpl",t)),onFocus:t[1]||(t[1]=(...t)=>e.handleFocus&&e.handleFocus(...t)),onKeydown:t[2]||(t[2]=ts(((...t)=>e.handleKeydown&&e.handleKeydown(...t)),["self"])),onMousedown:t[3]||(t[3]=(...t)=>e.handleMousedown&&e.handleMousedown(...t)),onPointermove:t[4]||(t[4]=t=>e.$emit("pointermove",t)),onPointerleave:t[5]||(t[5]=t=>e.$emit("pointerleave",t))}),[e.icon?(fi(),_i(s,{key:0},{default:vn((()=>[(fi(),_i(dr(e.icon)))])),_:1})):Li("v-if",!0),vr(e.$slots,"default")],16,TL)],64)}],["__file","/home/runner/work/element-plus/element-plus/packages/components/dropdown/src/dropdown-item-impl.vue"]]);const EL=()=>{const e=Sn("elDropdown",{}),t=Ki((()=>null==e?void 0:e.dropdownSize));return{elDropdown:e,_elDropdownSize:t}},AL=Fn({name:"ElDropdownItem",components:{ElDropdownCollectionItem:vL,ElRovingFocusItem:uL,ElDropdownItemImpl:ML},inheritAttrs:!1,props:dL,emits:["pointermove","pointerleave","click"],setup(e,{emit:t,attrs:n}){const{elDropdown:r}=EL(),i=Fi(),a=At(null),s=Ki((()=>{var e,t;return null!=(t=null==(e=Dt(a))?void 0:e.textContent)?t:""})),{onItemEnter:o,onItemLeave:l}=Sn(bL,void 0),u=Cs((e=>(t("pointermove",e),e.defaultPrevented)),Ts((t=>{if(e.disabled)return void l(t);const n=t.currentTarget;n===document.activeElement||n.contains(document.activeElement)||(o(t),t.defaultPrevented||null==n||n.focus())}))),c=Cs((e=>(t("pointerleave",e),e.defaultPrevented)),Ts((e=>{l(e)}))),d=Cs((n=>{if(!e.disabled)return t("click",n),"keydown"!==n.type&&n.defaultPrevented}),(t=>{var n,a,s;e.disabled?t.stopImmediatePropagation():((null==(n=null==r?void 0:r.hideOnClick)?void 0:n.value)&&(null==(a=r.handleClick)||a.call(r)),null==(s=r.commandHandler)||s.call(r,e.command,i,t))}));return{handleClick:d,handlePointerMove:u,handlePointerLeave:c,textContent:s,propsAndAttrs:Ki((()=>({...e,...n})))}}});var PL=J_(AL,[["render",function(e,t,n,r,i,a){var s;const o=ur("el-dropdown-item-impl"),l=ur("el-roving-focus-item"),u=ur("el-dropdown-collection-item");return fi(),_i(u,{disabled:e.disabled,"text-value":null!=(s=e.textValue)?s:e.textContent},{default:vn((()=>[Mi(l,{focusable:!e.disabled},{default:vn((()=>[Mi(o,Oi(e.propsAndAttrs,{onPointerleave:e.handlePointerLeave,onPointermove:e.handlePointerMove,onClickimpl:e.handleClick}),{default:vn((()=>[vr(e.$slots,"default")])),_:3},16,["onPointerleave","onPointermove","onClickimpl"])])),_:3},8,["focusable"])])),_:3},8,["disabled","text-value"])}],["__file","/home/runner/work/element-plus/element-plus/packages/components/dropdown/src/dropdown-item.vue"]]);const RL=Fn({name:"ElDropdownMenu",props:hL,setup(e){const t=rv("dropdown"),{_elDropdownSize:n}=EL(),r=n.value,{focusTrapRef:i,onKeydown:a}=Sn(Yx,void 0),{contentRef:s,role:o,triggerId:l}=Sn(bL,void 0),{collectionRef:u,getItems:c}=Sn(yL,void 0),{rovingFocusGroupRef:d,rovingFocusGroupRootStyle:h,tabIndex:p,onBlur:f,onFocus:m,onMousedown:g}=Sn(JR,void 0),{collectionRef:v}=Sn(KR,void 0),y=Ki((()=>[t.b("menu"),t.bm("menu",null==r?void 0:r.value)])),_=wg(s,u,i,d,v),b=Cs((t=>{var n;null==(n=e.onKeydown)||n.call(e,t)}),(e=>{const{currentTarget:t,code:n,target:r}=e;if(t.contains(r),Sg.tab===n&&e.stopImmediatePropagation(),e.preventDefault(),r!==Dt(s))return;if(!mL.includes(n))return;const i=c().filter((e=>!e.disabled)).map((e=>e.ref));fL.includes(n)&&i.reverse(),nL(i)}));return{size:r,rovingFocusGroupRootStyle:h,tabIndex:p,dropdownKls:y,role:o,triggerId:l,dropdownListWrapperRef:_,handleKeydown:e=>{b(e),a(e)},onBlur:f,onFocus:m,onMousedown:g}}}),LL=["role","aria-labelledby"];var kL=J_(RL,[["render",function(e,t,n,i,a,s){return fi(),yi("ul",{ref:e.dropdownListWrapperRef,class:l(e.dropdownKls),style:r(e.rovingFocusGroupRootStyle),tabindex:-1,role:e.role,"aria-labelledby":e.triggerId,onBlur:t[0]||(t[0]=(...t)=>e.onBlur&&e.onBlur(...t)),onFocus:t[1]||(t[1]=(...t)=>e.onFocus&&e.onFocus(...t)),onKeydown:t[2]||(t[2]=ts(((...t)=>e.handleKeydown&&e.handleKeydown(...t)),["self"])),onMousedown:t[3]||(t[3]=ts(((...t)=>e.onMousedown&&e.onMousedown(...t)),["self"]))},[vr(e.$slots,"default")],46,LL)}],["__file","/home/runner/work/element-plus/element-plus/packages/components/dropdown/src/dropdown-menu.vue"]]);const DL=_g(SL,{DropdownItem:PL,DropdownMenu:kL}),IL=xg(PL),OL=xg(kL),NL={viewBox:"0 0 79 86",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},BL=["id"],UL=["stop-color"],zL=["stop-color"],FL=["id"],VL=["stop-color"],GL=["stop-color"],HL=["id"],jL={id:"Illustrations",stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},WL={id:"B-type",transform:"translate(-1268.000000, -535.000000)"},YL={id:"Group-2",transform:"translate(1268.000000, 535.000000)"},$L=["fill"],XL=["fill"],qL={id:"Group-Copy",transform:"translate(34.500000, 31.500000) scale(-1, 1) rotate(-25.000000) translate(-34.500000, -31.500000) translate(7.000000, 10.000000)"},KL=["fill"],ZL=["fill"],JL=["fill"],QL=["fill"],ek=["fill"],tk={id:"Rectangle-Copy-17",transform:"translate(53.000000, 45.000000)"},nk=["fill","xlink:href"],rk=["fill","mask"],ik=["fill"],ak=Fn({name:"ImgEmpty"});var sk=J_(Fn({...ak,setup(e){const t=rv("empty"),n=Iy();return(e,r)=>(fi(),yi("svg",NL,[Ti("defs",null,[Ti("linearGradient",{id:`linearGradient-1-${Dt(n)}`,x1:"38.8503086%",y1:"0%",x2:"61.1496914%",y2:"100%"},[Ti("stop",{"stop-color":`var(${Dt(t).cssVarBlockName("fill-color-1")})`,offset:"0%"},null,8,UL),Ti("stop",{"stop-color":`var(${Dt(t).cssVarBlockName("fill-color-4")})`,offset:"100%"},null,8,zL)],8,BL),Ti("linearGradient",{id:`linearGradient-2-${Dt(n)}`,x1:"0%",y1:"9.5%",x2:"100%",y2:"90.5%"},[Ti("stop",{"stop-color":`var(${Dt(t).cssVarBlockName("fill-color-1")})`,offset:"0%"},null,8,VL),Ti("stop",{"stop-color":`var(${Dt(t).cssVarBlockName("fill-color-6")})`,offset:"100%"},null,8,GL)],8,FL),Ti("rect",{id:`path-3-${Dt(n)}`,x:"0",y:"0",width:"17",height:"36"},null,8,HL)]),Ti("g",jL,[Ti("g",WL,[Ti("g",YL,[Ti("path",{id:"Oval-Copy-2",d:"M39.5,86 C61.3152476,86 79,83.9106622 79,81.3333333 C79,78.7560045 57.3152476,78 35.5,78 C13.6847524,78 0,78.7560045 0,81.3333333 C0,83.9106622 17.6847524,86 39.5,86 Z",fill:`var(${Dt(t).cssVarBlockName("fill-color-3")})`},null,8,$L),Ti("polygon",{id:"Rectangle-Copy-14",fill:`var(${Dt(t).cssVarBlockName("fill-color-7")})`,transform:"translate(27.500000, 51.500000) scale(1, -1) translate(-27.500000, -51.500000) ",points:"13 58 53 58 42 45 2 45"},null,8,XL),Ti("g",qL,[Ti("polygon",{id:"Rectangle-Copy-10",fill:`var(${Dt(t).cssVarBlockName("fill-color-7")})`,transform:"translate(11.500000, 5.000000) scale(1, -1) translate(-11.500000, -5.000000) ",points:"2.84078316e-14 3 18 3 23 7 5 7"},null,8,KL),Ti("polygon",{id:"Rectangle-Copy-11",fill:`var(${Dt(t).cssVarBlockName("fill-color-5")})`,points:"-3.69149156e-15 7 38 7 38 43 -3.69149156e-15 43"},null,8,ZL),Ti("rect",{id:"Rectangle-Copy-12",fill:`url(#linearGradient-1-${Dt(n)})`,transform:"translate(46.500000, 25.000000) scale(-1, 1) translate(-46.500000, -25.000000) ",x:"38",y:"7",width:"17",height:"36"},null,8,JL),Ti("polygon",{id:"Rectangle-Copy-13",fill:`var(${Dt(t).cssVarBlockName("fill-color-2")})`,transform:"translate(39.500000, 3.500000) scale(-1, 1) translate(-39.500000, -3.500000) ",points:"24 7 41 7 55 -3.63806207e-12 38 -3.63806207e-12"},null,8,QL)]),Ti("rect",{id:"Rectangle-Copy-15",fill:`url(#linearGradient-2-${Dt(n)})`,x:"13",y:"45",width:"40",height:"36"},null,8,ek),Ti("g",tk,[Ti("use",{id:"Mask",fill:`var(${Dt(t).cssVarBlockName("fill-color-8")})`,transform:"translate(8.500000, 18.000000) scale(-1, 1) translate(-8.500000, -18.000000) ","xlink:href":`#path-3-${Dt(n)}`},null,8,nk),Ti("polygon",{id:"Rectangle-Copy",fill:`var(${Dt(t).cssVarBlockName("fill-color-9")})`,mask:`url(#mask-4-${Dt(n)})`,transform:"translate(12.000000, 9.000000) scale(-1, 1) translate(-12.000000, -9.000000) ",points:"7 0 24 0 20 18 7 16.5"},null,8,rk)]),Ti("polygon",{id:"Rectangle-Copy-18",fill:`var(${Dt(t).cssVarBlockName("fill-color-2")})`,transform:"translate(66.000000, 51.500000) scale(-1, 1) translate(-66.000000, -51.500000) ",points:"62 45 79 45 70 58 53 58"},null,8,ik)])])])]))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/empty/src/img-empty.vue"]]);const ok=pg({image:{type:String,default:""},imageSize:Number,description:{type:String,default:""}}),lk=["src"],uk={key:1},ck=Fn({name:"ElEmpty"}),dk=Fn({...ck,props:ok,setup(e){const t=e,{t:n}=Jg(),i=rv("empty"),a=Ki((()=>t.description||n("el.table.emptyText"))),s=Ki((()=>({width:Zh(t.imageSize)})));return(e,t)=>(fi(),yi("div",{class:l(Dt(i).b())},[Ti("div",{class:l(Dt(i).e("image")),style:r(Dt(s))},[e.image?(fi(),yi("img",{key:0,src:e.image,ondragstart:"return false"},null,8,lk)):vr(e.$slots,"image",{key:1},(()=>[Mi(sk)]))],6),Ti("div",{class:l(Dt(i).e("description"))},[e.$slots.description?vr(e.$slots,"description",{key:0}):(fi(),yi("p",uk,f(Dt(a)),1))],2),e.$slots.default?(fi(),yi("div",{key:0,class:l(Dt(i).e("bottom"))},[vr(e.$slots,"default")],2)):Li("v-if",!0)],2))}});const hk=_g(J_(dk,[["__file","/home/runner/work/element-plus/element-plus/packages/components/empty/src/empty.vue"]])),pk=pg({urlList:{type:Array,default:()=>[]},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:{type:Boolean,default:!1},teleported:{type:Boolean,default:!1},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),fk={close:()=>!0,switch:e=>Bs(e)},mk=["src"],gk=Fn({name:"ElImageViewer"}),vk=Fn({...gk,props:pk,emits:fk,setup(e,{expose:t,emit:n}){const i=e,a={CONTAIN:{name:"contain",icon:wt(Rf)},ORIGINAL:{name:"original",icon:wt(Cm)}},{t:s}=Jg(),o=rv("image-viewer"),{nextZIndex:u}=Yy(),c=At(),d=At([]),h=new ae(p);var p;const f=At(!0),m=At(i.initialIndex),g=Pt(a.CONTAIN),v=At({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),y=Ki((()=>{const{urlList:e}=i;return e.length<=1})),_=Ki((()=>0===m.value)),b=Ki((()=>m.value===i.urlList.length-1)),x=Ki((()=>i.urlList[m.value])),w=Ki((()=>{const{scale:e,deg:t,offsetX:n,offsetY:r,enableTransition:i}=v.value;let s=n/e,o=r/e;switch(t%360){case 90:case-270:[s,o]=[o,-s];break;case 180:case-180:[s,o]=[-s,-o];break;case 270:case-90:[s,o]=[-o,s]}const l={transform:`scale(${e}) rotate(${t}deg) translate(${s}px, ${o}px)`,transition:i?"transform .3s":""};return g.value.name===a.CONTAIN.name&&(l.maxWidth=l.maxHeight="100%"),l})),S=Ki((()=>Bs(i.zIndex)?i.zIndex:u()));function C(){h.stop(),n("close")}function T(){f.value=!1}function M(e){f.value=!1,e.target.alt=s("el.image.error")}function E(e){if(f.value||0!==e.button||!c.value)return;v.value.enableTransition=!1;const{offsetX:t,offsetY:n}=v.value,r=e.pageX,i=e.pageY,a=Ih((e=>{v.value={...v.value,offsetX:t+e.pageX-r,offsetY:n+e.pageY-i}})),s=Zs(document,"mousemove",a);Zs(document,"mouseup",(()=>{s()})),e.preventDefault()}function A(){v.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function P(){if(f.value)return;const e=Gh(a),t=Object.values(a),n=g.value.name,r=(t.findIndex((e=>e.name===n))+1)%e.length;g.value=a[e[r]],A()}function R(e){const t=i.urlList.length;m.value=(e+t)%t}function L(){_.value&&!i.infinite||R(m.value-1)}function k(){b.value&&!i.infinite||R(m.value+1)}function D(e,t={}){if(f.value)return;const{zoomRate:n,rotateDeg:r,enableTransition:a}={zoomRate:i.zoomRate,rotateDeg:90,enableTransition:!0,...t};switch(e){case"zoomOut":v.value.scale>.2&&(v.value.scale=Number.parseFloat((v.value.scale/n).toFixed(3)));break;case"zoomIn":v.value.scale<7&&(v.value.scale=Number.parseFloat((v.value.scale*n).toFixed(3)));break;case"clockwise":v.value.deg+=r;break;case"anticlockwise":v.value.deg-=r}v.value.enableTransition=a}return Mn(x,(()=>{en((()=>{const e=d.value[0];(null==e?void 0:e.complete)||(f.value=!0)}))})),Mn(m,(e=>{A(),n("switch",e)})),Kn((()=>{var e,t;!function(){const e=Ih((e=>{switch(e.code){case Sg.esc:i.closeOnPressEscape&&C();break;case Sg.space:P();break;case Sg.left:L();break;case Sg.up:D("zoomIn");break;case Sg.right:k();break;case Sg.down:D("zoomOut")}})),t=Ih((e=>{D((e.deltaY||e.deltaX)<0?"zoomIn":"zoomOut",{zoomRate:i.zoomRate,enableTransition:!1})}));h.run((()=>{Zs(document,"keydown",e),Zs(document,"wheel",t)}))}(),null==(t=null==(e=c.value)?void 0:e.focus)||t.call(e)})),t({setActiveItem:R}),(e,t)=>(fi(),_i(si,{to:"body",disabled:!e.teleported},[Mi(xa,{name:"viewer-fade",appear:""},{default:vn((()=>[Ti("div",{ref_key:"wrapper",ref:c,tabindex:-1,class:l(Dt(o).e("wrapper")),style:r({zIndex:Dt(S)})},[Ti("div",{class:l(Dt(o).e("mask")),onClick:t[0]||(t[0]=ts((t=>e.hideOnClickModal&&C()),["self"]))},null,2),Li(" CLOSE "),Ti("span",{class:l([Dt(o).e("btn"),Dt(o).e("close")]),onClick:C},[Mi(Dt(ib),null,{default:vn((()=>[Mi(Dt(cf))])),_:1})],2),Li(" ARROW "),Dt(y)?Li("v-if",!0):(fi(),yi(li,{key:0},[Ti("span",{class:l([Dt(o).e("btn"),Dt(o).e("prev"),Dt(o).is("disabled",!e.infinite&&Dt(_))]),onClick:L},[Mi(Dt(ib),null,{default:vn((()=>[Mi(Dt(dp))])),_:1})],2),Ti("span",{class:l([Dt(o).e("btn"),Dt(o).e("next"),Dt(o).is("disabled",!e.infinite&&Dt(b))]),onClick:k},[Mi(Dt(ib),null,{default:vn((()=>[Mi(Dt(mp))])),_:1})],2)],64)),Li(" ACTIONS "),Ti("div",{class:l([Dt(o).e("btn"),Dt(o).e("actions")])},[Ti("div",{class:l(Dt(o).e("actions__inner"))},[Mi(Dt(ib),{onClick:t[1]||(t[1]=e=>D("zoomOut"))},{default:vn((()=>[Mi(Dt(cg))])),_:1}),Mi(Dt(ib),{onClick:t[2]||(t[2]=e=>D("zoomIn"))},{default:vn((()=>[Mi(Dt(sg))])),_:1}),Ti("i",{class:l(Dt(o).e("actions__divider"))},null,2),Mi(Dt(ib),{onClick:P},{default:vn((()=>[(fi(),_i(dr(Dt(g).icon)))])),_:1}),Ti("i",{class:l(Dt(o).e("actions__divider"))},null,2),Mi(Dt(ib),{onClick:t[3]||(t[3]=e=>D("anticlockwise"))},{default:vn((()=>[Mi(Dt(gm))])),_:1}),Mi(Dt(ib),{onClick:t[4]||(t[4]=e=>D("clockwise"))},{default:vn((()=>[Mi(Dt(bm))])),_:1})],2)],2),Li(" CANVAS "),Ti("div",{class:l(Dt(o).e("canvas"))},[(fi(!0),yi(li,null,mr(e.urlList,((e,t)=>ar((fi(),yi("img",{ref_for:!0,ref:e=>d.value[t]=e,key:e,src:e,style:r(Dt(w)),class:l(Dt(o).e("img")),onLoad:T,onError:M,onMousedown:E},null,46,mk)),[[is,t===m.value]]))),128))],2),vr(e.$slots,"default")],6)])),_:3})],8,["disabled"]))}});const yk=_g(J_(vk,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]])),_k=pg({hideOnClickModal:{type:Boolean,default:!1},src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:{type:Boolean,default:!1},scrollContainer:{type:[String,Object]},previewSrcList:{type:Array,default:()=>[]},previewTeleported:{type:Boolean,default:!1},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),bk={load:e=>e instanceof Event,error:e=>e instanceof Event,switch:e=>Bs(e),close:()=>!0,show:()=>!0},xk=["src","loading"],wk={key:0},Sk=Fn({name:"ElImage",inheritAttrs:!1}),Ck=Fn({...Sk,props:_k,emits:bk,setup(e,{emit:t}){const n=e;let i="";const{t:a}=Jg(),s=rv("image"),o=Ji(),u=Wg(),c=At(),d=At(!1),h=At(!0),p=At(!1),m=At(),g=At(),v=Os&&"loading"in HTMLImageElement.prototype;let y,_;const b=Ki((()=>o.style)),x=Ki((()=>{const{fit:e}=n;return Os&&e?{objectFit:e}:{}})),w=Ki((()=>{const{previewSrcList:e}=n;return Array.isArray(e)&&e.length>0})),S=Ki((()=>{const{previewSrcList:e,initialIndex:t}=n;let r=t;return t>e.length-1&&(r=0),r})),C=Ki((()=>"eager"!==n.loading&&(!v&&"lazy"===n.loading||n.lazy))),T=()=>{Os&&(h.value=!0,d.value=!1,c.value=n.src)};function M(e){h.value=!1,d.value=!1,t("load",e)}function E(e){h.value=!1,d.value=!0,t("error",e)}function A(){((e,t)=>{if(!Os||!e||!t)return!1;const n=e.getBoundingClientRect();let r;return r=t instanceof Element?t.getBoundingClientRect():{top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},n.top<r.bottom&&n.bottom>r.top&&n.right>r.left&&n.left<r.right})(m.value,g.value)&&(T(),L())}const P=Ws(A,200);async function R(){var e;if(!Os)return;await en();const{scrollContainer:t}=n;zh(t)?g.value=t:D(t)&&""!==t?g.value=null!=(e=document.querySelector(t))?e:void 0:m.value&&(g.value=Qh(m.value)),g.value&&(y=Zs(g,"scroll",P),setTimeout((()=>A()),100))}function L(){Os&&g.value&&P&&(null==y||y(),g.value=void 0)}function k(e){if(e.ctrlKey)return e.deltaY<0||e.deltaY>0?(e.preventDefault(),!1):void 0}function I(){w.value&&(_=Zs("wheel",k,{passive:!1}),i=document.body.style.overflow,document.body.style.overflow="hidden",p.value=!0,t("show"))}function O(){null==_||_(),document.body.style.overflow=i,p.value=!1,t("close")}function N(e){t("switch",e)}return Mn((()=>n.src),(()=>{C.value?(h.value=!0,d.value=!1,L(),R()):T()})),Kn((()=>{C.value?R():T()})),(e,t)=>(fi(),yi("div",{ref_key:"container",ref:m,class:l([Dt(s).b(),e.$attrs.class]),style:r(Dt(b))},[void 0===c.value||d.value?Li("v-if",!0):(fi(),yi("img",Oi({key:0},Dt(u),{src:c.value,loading:e.loading,style:Dt(x),class:[Dt(s).e("inner"),Dt(w)&&Dt(s).e("preview"),h.value&&Dt(s).is("loading")],onClick:I,onLoad:M,onError:E}),null,16,xk)),h.value||d.value?(fi(),yi("div",{key:1,class:l(Dt(s).e("wrapper"))},[h.value?vr(e.$slots,"placeholder",{key:0},(()=>[Ti("div",{class:l(Dt(s).e("placeholder"))},null,2)])):d.value?vr(e.$slots,"error",{key:1},(()=>[Ti("div",{class:l(Dt(s).e("error"))},f(Dt(a)("el.image.error")),3)])):Li("v-if",!0)],2)):Li("v-if",!0),Dt(w)?(fi(),yi(li,{key:2},[p.value?(fi(),_i(Dt(yk),{key:0,"z-index":e.zIndex,"initial-index":Dt(S),infinite:e.infinite,"zoom-rate":e.zoomRate,"url-list":e.previewSrcList,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:O,onSwitch:N},{default:vn((()=>[e.$slots.viewer?(fi(),yi("div",wk,[vr(e.$slots,"viewer")])):Li("v-if",!0)])),_:3},8,["z-index","initial-index","infinite","zoom-rate","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):Li("v-if",!0)],64)):Li("v-if",!0)],6))}});const Tk=_g(J_(Ck,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image/src/image.vue"]])),Mk=pg({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.POSITIVE_INFINITY},min:{type:Number,default:Number.NEGATIVE_INFINITY},modelValue:Number,readonly:Boolean,disabled:Boolean,size:z_,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:e=>null===e||Bs(e)||["min","max"].includes(e),default:null},name:String,label:String,placeholder:String,precision:{type:Number,validator:e=>e>=0&&e===Number.parseInt(`${e}`,10)},validateEvent:{type:Boolean,default:!0}}),Ek={[Mg]:(e,t)=>t!==e,blur:e=>e instanceof FocusEvent,focus:e=>e instanceof FocusEvent,[Eg]:e=>Bs(e)||Ah(e),[Tg]:e=>Bs(e)||Ah(e)},Ak=["aria-label","onKeydown"],Pk=["aria-label","onKeydown"],Rk=Fn({name:"ElInputNumber"}),Lk=Fn({...Rk,props:Mk,emits:Ek,setup(e,{expose:t,emit:n}){const r=e,{t:i}=Jg(),a=rv("input-number"),s=At(),o=pt({currentValue:r.modelValue,userInput:null}),{formItem:u}=pb(),c=Ki((()=>Bs(r.modelValue)&&r.modelValue<=r.min)),d=Ki((()=>Bs(r.modelValue)&&r.modelValue>=r.max)),h=Ki((()=>{const e=y(r.step);return Bh(r.precision)?Math.max(y(r.modelValue),e):(r.precision,r.precision)})),p=Ki((()=>r.controls&&"right"===r.controlsPosition)),f=db(),m=hb(),g=Ki((()=>{if(null!==o.userInput)return o.userInput;let e=o.currentValue;if(Ah(e))return"";if(Bs(e)){if(Number.isNaN(e))return"";Bh(r.precision)||(e=e.toFixed(r.precision))}return e})),v=(e,t)=>{if(Bh(t)&&(t=h.value),0===t)return Math.round(e);let n=String(e);const r=n.indexOf(".");if(-1===r)return e;if(!n.replace(".","").split("")[r+t])return e;const i=n.length;return"5"===n.charAt(i-1)&&(n=`${n.slice(0,Math.max(0,i-1))}6`),Number.parseFloat(Number(n).toFixed(t))},y=e=>{if(Ah(e))return 0;const t=e.toString(),n=t.indexOf(".");let r=0;return-1!==n&&(r=t.length-n-1),r},_=(e,t=1)=>Bs(e)?v(e+r.step*t):o.currentValue,b=()=>{if(r.readonly||m.value||d.value)return;const e=Number(g.value)||0,t=_(e);S(t),n(Eg,o.currentValue)},x=()=>{if(r.readonly||m.value||c.value)return;const e=Number(g.value)||0,t=_(e,-1);S(t),n(Eg,o.currentValue)},w=(e,t)=>{const{max:i,min:a,step:s,precision:o,stepStrictly:l,valueOnClear:u}=r;let c=Number(e);if(Ah(e)||Number.isNaN(c))return null;if(""===e){if(null===u)return null;c=D(u)?{min:a,max:i}[u]:u}return l&&(c=v(Math.round(c/s)*s,o)),Bh(o)||(c=v(c,o)),(c>i||c<a)&&(c=c>i?i:a,t&&n(Tg,c)),c},S=(e,t=!0)=>{var i;const a=o.currentValue,s=w(e);t?a!==s&&(o.userInput=null,n(Tg,s),n(Mg,s,a),r.validateEvent&&(null==(i=null==u?void 0:u.validate)||i.call(u,"change").catch((e=>{}))),o.currentValue=s):n(Tg,s)},C=e=>{o.userInput=e;const t=""===e?null:Number(e);n(Eg,t),S(t,!1)},T=e=>{const t=""!==e?Number(e):"";(Bs(t)&&!Number.isNaN(t)||""===e)&&S(t),o.userInput=null},M=e=>{n("focus",e)},E=e=>{var t;n("blur",e),r.validateEvent&&(null==(t=null==u?void 0:u.validate)||t.call(u,"blur").catch((e=>{})))};return Mn((()=>r.modelValue),(e=>{const t=w(o.userInput),n=w(e,!0);Bs(t)||t&&t===n||(o.currentValue=n,o.userInput=null)}),{immediate:!0}),Kn((()=>{var e;const{min:t,max:i,modelValue:a}=r,l=null==(e=s.value)?void 0:e.input;if(l.setAttribute("role","spinbutton"),Number.isFinite(i)?l.setAttribute("aria-valuemax",String(i)):l.removeAttribute("aria-valuemax"),Number.isFinite(t)?l.setAttribute("aria-valuemin",String(t)):l.removeAttribute("aria-valuemin"),l.setAttribute("aria-valuenow",String(o.currentValue)),l.setAttribute("aria-disabled",String(m.value)),!Bs(a)&&null!=a){let e=Number(a);Number.isNaN(e)&&(e=null),n(Tg,e)}})),Jn((()=>{var e;const t=null==(e=s.value)?void 0:e.input;null==t||t.setAttribute("aria-valuenow",`${o.currentValue}`)})),t({focus:()=>{var e,t;null==(t=null==(e=s.value)?void 0:e.focus)||t.call(e)},blur:()=>{var e,t;null==(t=null==(e=s.value)?void 0:e.blur)||t.call(e)}}),(e,t)=>(fi(),yi("div",{class:l([Dt(a).b(),Dt(a).m(Dt(f)),Dt(a).is("disabled",Dt(m)),Dt(a).is("without-controls",!e.controls),Dt(a).is("controls-right",Dt(p))]),onDragstart:t[1]||(t[1]=ts((()=>{}),["prevent"]))},[e.controls?ar((fi(),yi("span",{key:0,role:"button","aria-label":Dt(i)("el.inputNumber.decrease"),class:l([Dt(a).e("decrease"),Dt(a).is("disabled",Dt(c))]),onKeydown:rs(x,["enter"])},[Mi(Dt(ib),null,{default:vn((()=>[Dt(p)?(fi(),_i(Dt(op),{key:0})):(fi(),_i(Dt(Yf),{key:1}))])),_:1})],42,Ak)),[[Dt(RC),x]]):Li("v-if",!0),e.controls?ar((fi(),yi("span",{key:1,role:"button","aria-label":Dt(i)("el.inputNumber.increase"),class:l([Dt(a).e("increase"),Dt(a).is("disabled",Dt(d))]),onKeydown:rs(b,["enter"])},[Mi(Dt(ib),null,{default:vn((()=>[Dt(p)?(fi(),_i(Dt(_p),{key:0})):(fi(),_i(Dt(lm),{key:1}))])),_:1})],42,Pk)),[[Dt(RC),b]]):Li("v-if",!0),Mi(Dt(mx),{id:e.id,ref_key:"input",ref:s,type:"number",step:e.step,"model-value":Dt(g),placeholder:e.placeholder,readonly:e.readonly,disabled:Dt(m),size:Dt(f),max:e.max,min:e.min,name:e.name,label:e.label,"validate-event":!1,onWheel:t[0]||(t[0]=ts((()=>{}),["prevent"])),onKeydown:[rs(ts(b,["prevent"]),["up"]),rs(ts(x,["prevent"]),["down"])],onBlur:E,onFocus:M,onInput:C,onChange:T},null,8,["id","step","model-value","placeholder","readonly","disabled","size","max","min","name","label","onKeydown"])],34))}});const kk=_g(J_(Lk,[["__file","/home/runner/work/element-plus/element-plus/packages/components/input-number/src/input-number.vue"]])),Dk=pg({type:{type:String,values:["primary","success","warning","info","danger","default"],default:"default"},underline:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},href:{type:String,default:""},icon:{type:fg}}),Ik={click:e=>e instanceof MouseEvent},Ok=["href"],Nk=Fn({name:"ElLink"});const Bk=_g(J_(Fn({...Nk,props:Dk,emits:Ik,setup(e,{emit:t}){const n=e,r=rv("link"),i=Ki((()=>[r.b(),r.m(n.type),r.is("disabled",n.disabled),r.is("underline",n.underline&&!n.disabled)]));function a(e){n.disabled||t("click",e)}return(e,t)=>(fi(),yi("a",{class:l(Dt(i)),href:e.disabled||!e.href?void 0:e.href,onClick:a},[e.icon?(fi(),_i(Dt(ib),{key:0},{default:vn((()=>[(fi(),_i(dr(e.icon)))])),_:1})):Li("v-if",!0),e.$slots.default?(fi(),yi("span",{key:1,class:l(Dt(r).e("inner"))},[vr(e.$slots,"default")],2)):Li("v-if",!0),e.$slots.icon?vr(e.$slots,"icon",{key:2}):Li("v-if",!0)],10,Ok))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/link/src/link.vue"]]));var Uk=J_(Fn({name:"ElMenuCollapseTransition",setup(){const e=rv("menu");return{listeners:{onBeforeEnter:e=>e.style.opacity="0.2",onEnter(t,n){Xh(t,`${e.namespace.value}-opacity-transition`),t.style.opacity="1",n()},onAfterEnter(t){qh(t,`${e.namespace.value}-opacity-transition`),t.style.opacity=""},onBeforeLeave(t){t.dataset||(t.dataset={}),$h(t,e.m("collapse"))?(qh(t,e.m("collapse")),t.dataset.oldOverflow=t.style.overflow,t.dataset.scrollWidth=t.clientWidth.toString(),Xh(t,e.m("collapse"))):(Xh(t,e.m("collapse")),t.dataset.oldOverflow=t.style.overflow,t.dataset.scrollWidth=t.clientWidth.toString(),qh(t,e.m("collapse"))),t.style.width=`${t.scrollWidth}px`,t.style.overflow="hidden"},onLeave(e){Xh(e,"horizontal-collapse-transition"),e.style.width=`${e.dataset.scrollWidth}px`}}}}}),[["render",function(e,t,n,r,i,a){return fi(),_i(xa,Oi({mode:"out-in"},e.listeners),{default:vn((()=>[vr(e.$slots,"default")])),_:3},16)}],["__file","/home/runner/work/element-plus/element-plus/packages/components/menu/src/menu-collapse-transition.vue"]]);function zk(e,t){const n=Ki((()=>{let n=e.parent;const r=[t.value];for(;"ElMenu"!==n.type.name;)n.props.index&&r.unshift(n.props.index),n=n.parent;return r}));return{parentMenu:Ki((()=>{let t=e.parent;for(;t&&!["ElMenu","ElSubMenu"].includes(t.type.name);)t=t.parent;return t})),indexPath:n}}function Fk(e){return Ki((()=>{const t=e.backgroundColor;return t?new NS(t).shade(20).toString():""}))}const Vk=(e,t)=>{const n=rv("menu");return Ki((()=>n.cssVarBlock({"text-color":e.textColor||"","hover-text-color":e.textColor||"","bg-color":e.backgroundColor||"","hover-bg-color":Fk(e).value||"","active-color":e.activeTextColor||"",level:`${t}`})))},Gk=pg({index:{type:String,required:!0},showTimeout:{type:Number,default:300},hideTimeout:{type:Number,default:300},popperClass:String,disabled:Boolean,popperAppendToBody:{type:Boolean,default:void 0},teleported:{type:Boolean,default:void 0},popperOffset:{type:Number,default:6},expandCloseIcon:{type:fg},expandOpenIcon:{type:fg},collapseCloseIcon:{type:fg},collapseOpenIcon:{type:fg}}),Hk="ElSubMenu";var jk=Fn({name:Hk,props:Gk,setup(e,{slots:t,expose:n}){Yg({from:"popper-append-to-body",replacement:"teleported",scope:Hk,version:"2.3.0",ref:"https://element-plus.org/en-US/component/menu.html#submenu-attributes"},Ki((()=>void 0!==e.popperAppendToBody)));const r=Fi(),{indexPath:i,parentMenu:a}=zk(r,Ki((()=>e.index))),s=rv("menu"),o=rv("sub-menu"),l=Sn("rootMenu");l||Wh(Hk,"can not inject root menu");const u=Sn(`subMenu:${a.value.uid}`);u||Wh(Hk,"can not inject sub menu");const c=At({}),d=At({});let h;const p=At(!1),f=At(),m=At(null),g=Ki((()=>"horizontal"===E.value&&y.value?"bottom-start":"right-start")),v=Ki((()=>"horizontal"===E.value&&y.value||"vertical"===E.value&&!l.props.collapse?e.expandCloseIcon&&e.expandOpenIcon?w.value?e.expandOpenIcon:e.expandCloseIcon:op:e.collapseCloseIcon&&e.collapseOpenIcon?w.value?e.collapseOpenIcon:e.collapseCloseIcon:mp)),y=Ki((()=>0===u.level)),_=Ki((()=>{var t;const n=null!=(t=e.teleported)?t:e.popperAppendToBody;return void 0===n?y.value:n})),b=Ki((()=>l.props.collapse?`${s.namespace.value}-zoom-in-left`:`${s.namespace.value}-zoom-in-top`)),x=Ki((()=>"horizontal"===E.value&&y.value?["bottom-start","bottom-end","top-start","top-end","right-start","left-start"]:["right-start","left-start","bottom-start","bottom-end","top-start","top-end"])),w=Ki((()=>l.openedMenus.includes(e.index))),S=Ki((()=>{let e=!1;return Object.values(c.value).forEach((t=>{t.active&&(e=!0)})),Object.values(d.value).forEach((t=>{t.active&&(e=!0)})),e})),C=Ki((()=>l.props.backgroundColor||"")),T=Ki((()=>l.props.activeTextColor||"")),M=Ki((()=>l.props.textColor||"")),E=Ki((()=>l.props.mode)),A=pt({index:e.index,indexPath:i,active:S}),P=Ki((()=>"horizontal"!==E.value?{color:M.value}:{borderBottomColor:S.value?l.props.activeTextColor?T.value:"":"transparent",color:S.value?T.value:M.value})),R=e=>{var t,n,r;e||null==(r=null==(n=null==(t=m.value)?void 0:t.popperRef)?void 0:n.popperInstanceRef)||r.destroy()},L=()=>{"hover"===l.props.menuTrigger&&"horizontal"===l.props.mode||l.props.collapse&&"vertical"===l.props.mode||e.disabled||l.handleSubMenuClick({index:e.index,indexPath:i.value,active:S.value})},k=(t,n=e.showTimeout)=>{var r;"focus"!==t.type&&("click"===l.props.menuTrigger&&"horizontal"===l.props.mode||!l.props.collapse&&"vertical"===l.props.mode||e.disabled||(u.mouseInChild.value=!0,null==h||h(),({stop:h}=$s((()=>{l.openMenu(e.index,i.value)}),n)),_.value&&(null==(r=a.value.vnode.el)||r.dispatchEvent(new MouseEvent("mouseenter")))))},I=(t=!1)=>{var n,a;"click"===l.props.menuTrigger&&"horizontal"===l.props.mode||!l.props.collapse&&"vertical"===l.props.mode||(null==h||h(),u.mouseInChild.value=!1,({stop:h}=$s((()=>!p.value&&l.closeMenu(e.index,i.value)),e.hideTimeout)),_.value&&t&&"ElSubMenu"===(null==(n=r.parent)?void 0:n.type.name)&&(null==(a=u.handleMouseleave)||a.call(u,!0)))};Mn((()=>l.props.collapse),(e=>R(Boolean(e))));{const e=e=>{d.value[e.index]=e},t=e=>{delete d.value[e.index]};wn(`subMenu:${r.uid}`,{addSubMenu:e,removeSubMenu:t,handleMouseleave:I,mouseInChild:p,level:u.level+1})}return n({opened:w}),Kn((()=>{l.addSubMenu(A),u.addSubMenu(A)})),Qn((()=>{u.removeSubMenu(A),l.removeSubMenu(A)})),()=>{var n;const i=[null==(n=t.title)?void 0:n.call(t),ea(ib,{class:o.e("icon-arrow"),style:{transform:w.value?e.expandCloseIcon&&e.expandOpenIcon||e.collapseCloseIcon&&e.collapseOpenIcon&&l.props.collapse?"none":"rotateZ(180deg)":"none"}},{default:()=>D(v.value)?ea(r.appContext.components[v.value]):ea(v.value)})],a=Vk(l.props,u.level+1),c=l.isMenuPopup?ea(Ow,{ref:m,visible:w.value,effect:"light",pure:!0,offset:e.popperOffset,showArrow:!1,persistent:!0,popperClass:e.popperClass,placement:g.value,teleported:_.value,fallbackPlacements:x.value,transition:b.value,gpuAcceleration:!1},{content:()=>{var n;return ea("div",{class:[s.m(E.value),s.m("popup-container"),e.popperClass],onMouseenter:e=>k(e,100),onMouseleave:()=>I(!0),onFocus:e=>k(e,100)},[ea("ul",{class:[s.b(),s.m("popup"),s.m(`popup-${g.value}`)],style:a.value},[null==(n=t.default)?void 0:n.call(t)])])},default:()=>ea("div",{class:o.e("title"),style:[P.value,{backgroundColor:C.value}],onClick:L},i)}):ea(li,{},[ea("div",{class:o.e("title"),style:[P.value,{backgroundColor:C.value}],ref:f,onClick:L},i),ea(NE,{},{default:()=>{var e;return ar(ea("ul",{role:"menu",class:[s.b(),s.m("inline")],style:a.value},[null==(e=t.default)?void 0:e.call(t)]),[[is,w.value]])}})]);return ea("li",{class:[o.b(),o.is("active",S.value),o.is("opened",w.value),o.is("disabled",e.disabled)],role:"menuitem",ariaHaspopup:!0,ariaExpanded:w.value,onMouseenter:k,onMouseleave:()=>I(!0),onFocus:k},[c])}}});const Wk=pg({mode:{type:String,values:["horizontal","vertical"],default:"vertical"},defaultActive:{type:String,default:""},defaultOpeneds:{type:Array,default:()=>[]},uniqueOpened:Boolean,router:Boolean,menuTrigger:{type:String,values:["hover","click"],default:"hover"},collapse:Boolean,backgroundColor:String,textColor:String,activeTextColor:String,collapseTransition:{type:Boolean,default:!0},ellipsis:{type:Boolean,default:!0},popperEffect:{type:String,values:["dark","light"],default:"dark"}}),Yk=e=>Array.isArray(e)&&e.every((e=>D(e)));var $k=Fn({name:"ElMenu",props:Wk,emits:{close:(e,t)=>D(e)&&Yk(t),open:(e,t)=>D(e)&&Yk(t),select:(e,t,n,r)=>D(e)&&Yk(t)&&O(n)&&(void 0===r||r instanceof Promise)},setup(e,{emit:t,slots:n,expose:r}){const i=Fi(),a=i.appContext.config.globalProperties.$router,s=At(),o=rv("menu"),l=rv("sub-menu"),u=At(-1),c=At(e.defaultOpeneds&&!e.collapse?e.defaultOpeneds.slice(0):[]),d=At(e.defaultActive),h=At({}),p=At({}),f=Ki((()=>"horizontal"===e.mode||"vertical"===e.mode&&e.collapse)),m=(n,r)=>{c.value.includes(n)||(e.uniqueOpened&&(c.value=c.value.filter((e=>r.includes(e)))),c.value.push(n),t("open",n,r))},g=e=>{const t=c.value.indexOf(e);-1!==t&&c.value.splice(t,1)},v=(e,n)=>{g(e),t("close",e,n)},y=({index:e,indexPath:t})=>{c.value.includes(e)?v(e,t):m(e,t)},_=n=>{("horizontal"===e.mode||e.collapse)&&(c.value=[]);const{index:r,indexPath:i}=n;if(!Ah(r)&&!Ah(i))if(e.router&&a){const e=n.route||r,s=a.push(e).then((e=>(e||(d.value=r),e)));t("select",r,i,{index:r,indexPath:i,route:e},s)}else d.value=r,t("select",r,i,{index:r,indexPath:i})};let b=!0;const x=()=>{const e=()=>{u.value=-1,en((()=>{u.value=(()=>{var e,t;if(!s.value)return-1;const n=Array.from(null!=(t=null==(e=s.value)?void 0:e.childNodes)?t:[]).filter((e=>"#text"!==e.nodeName||e.nodeValue)),r=Number.parseInt(getComputedStyle(s.value).paddingLeft,10),i=Number.parseInt(getComputedStyle(s.value).paddingRight,10),a=s.value.clientWidth-r-i;let o=0,l=0;return n.forEach(((e,t)=>{o+=e.offsetWidth||0,o<=a-64&&(l=t+1)})),l===n.length?-1:l})()}))};b?e():((e,t=33.34)=>{let n;return()=>{n&&clearTimeout(n),n=setTimeout((()=>{e()}),t)}})(e)(),b=!1};let w;Mn((()=>e.defaultActive),(t=>{h.value[t]||(d.value=""),(t=>{const n=h.value,r=n[t]||d.value&&n[d.value]||n[e.defaultActive];d.value=r?r.index:t})(t)})),Mn((()=>e.collapse),(e=>{e&&(c.value=[])})),Mn(h.value,(()=>{const t=d.value&&h.value[d.value];if(!t||"horizontal"===e.mode||e.collapse)return;t.indexPath.forEach((e=>{const t=p.value[e];t&&m(e,t.indexPath)}))})),Cn((()=>{"horizontal"===e.mode&&e.ellipsis?w=lo(s,x).stop:null==w||w()}));{const t=e=>{p.value[e.index]=e},n=e=>{delete p.value[e.index]},r=e=>{h.value[e.index]=e},a=e=>{delete h.value[e.index]};wn("rootMenu",pt({props:e,openedMenus:c,items:h,subMenus:p,activeIndex:d,isMenuPopup:f,addMenuItem:r,removeMenuItem:a,addSubMenu:t,removeSubMenu:n,openMenu:m,closeMenu:v,handleMenuItemClick:_,handleSubMenuClick:y})),wn(`subMenu:${i.uid}`,{addSubMenu:t,removeSubMenu:n,mouseInChild:At(!1),level:0})}Kn((()=>{"horizontal"===e.mode&&new class{constructor(e,t){this.domNode=e,this.init(t)}init(e){const t=this.domNode.childNodes;Array.from(t).forEach((t=>{1===t.nodeType&&new class{constructor(e,t){this.domNode=e,this.submenu=null,this.submenu=null,this.init(t)}init(e){this.domNode.setAttribute("tabindex","0");const t=this.domNode.querySelector(`.${e}-menu`);t&&(this.submenu=new class{constructor(e,t){this.parent=e,this.domNode=t,this.subIndex=0,this.subIndex=0,this.init()}init(){this.subMenuItems=this.domNode.querySelectorAll("li"),this.addListeners()}gotoSubIndex(e){e===this.subMenuItems.length?e=0:e<0&&(e=this.subMenuItems.length-1),this.subMenuItems[e].focus(),this.subIndex=e}addListeners(){const e=this.parent.domNode;Array.prototype.forEach.call(this.subMenuItems,(t=>{t.addEventListener("keydown",(t=>{let n=!1;switch(t.code){case Sg.down:this.gotoSubIndex(this.subIndex+1),n=!0;break;case Sg.up:this.gotoSubIndex(this.subIndex-1),n=!0;break;case Sg.tab:bs(e,"mouseleave");break;case Sg.enter:case Sg.space:n=!0,t.currentTarget.click()}return n&&(t.preventDefault(),t.stopPropagation()),!1}))}))}}(this,t)),this.addListeners()}addListeners(){this.domNode.addEventListener("keydown",(e=>{let t=!1;switch(e.code){case Sg.down:bs(e.currentTarget,"mouseenter"),this.submenu&&this.submenu.gotoSubIndex(0),t=!0;break;case Sg.up:bs(e.currentTarget,"mouseenter"),this.submenu&&this.submenu.gotoSubIndex(this.submenu.subMenuItems.length-1),t=!0;break;case Sg.tab:bs(e.currentTarget,"mouseleave");break;case Sg.enter:case Sg.space:t=!0,e.currentTarget.click()}t&&e.preventDefault()}))}}(t,e)}))}}(i.vnode.el,o.namespace.value)}));r({open:e=>{const{indexPath:t}=p.value[e];t.forEach((e=>m(e,t)))},close:g,handleResize:x});return()=>{var t,r;let i=null!=(r=null==(t=n.default)?void 0:t.call(n))?r:[];const a=[];if("horizontal"===e.mode&&s.value){const t=Og(i),n=-1===u.value?t:t.slice(0,u.value),r=-1===u.value?[]:t.slice(u.value);(null==r?void 0:r.length)&&e.ellipsis&&(i=n,a.push(ea(jk,{index:"sub-menu-more",class:l.e("hide-arrow")},{title:()=>ea(ib,{class:l.e("icon-more")},{default:()=>ea(em)}),default:()=>r})))}const c=Vk(e,0),d=ea("ul",{key:String(e.collapse),role:"menubar",ref:s,style:c.value,class:{[o.b()]:!0,[o.m(e.mode)]:!0,[o.m("collapse")]:e.collapse}},[...i,...a]);return e.collapseTransition&&"vertical"===e.mode?ea(Uk,(()=>d)):d}}});const Xk=pg({index:{type:[String,null],default:null},route:{type:[String,Object]},disabled:Boolean}),qk="ElMenuItem";var Kk=J_(Fn({name:qk,components:{ElTooltip:Ow},props:Xk,emits:{click:e=>D(e.index)&&Array.isArray(e.indexPath)},setup(e,{emit:t}){const n=Fi(),r=Sn("rootMenu"),i=rv("menu"),a=rv("menu-item");r||Wh(qk,"can not inject root menu");const{parentMenu:s,indexPath:o}=zk(n,Ut(e,"index")),l=Sn(`subMenu:${s.value.uid}`);l||Wh(qk,"can not inject sub menu");const u=Ki((()=>e.index===r.activeIndex)),c=pt({index:e.index,indexPath:o,active:u});return Kn((()=>{l.addSubMenu(c),r.addMenuItem(c)})),Qn((()=>{l.removeSubMenu(c),r.removeMenuItem(c)})),{parentMenu:s,rootMenu:r,active:u,nsMenu:i,nsMenuItem:a,handleClick:()=>{e.disabled||(r.handleMenuItemClick({index:e.index,indexPath:o.value,route:e.route}),t("click",c))}}}}),[["render",function(e,t,n,r,i,a){const s=ur("el-tooltip");return fi(),yi("li",{class:l([e.nsMenuItem.b(),e.nsMenuItem.is("active",e.active),e.nsMenuItem.is("disabled",e.disabled)]),role:"menuitem",tabindex:"-1",onClick:t[0]||(t[0]=(...t)=>e.handleClick&&e.handleClick(...t))},["ElMenu"===e.parentMenu.type.name&&e.rootMenu.props.collapse&&e.$slots.title?(fi(),_i(s,{key:0,effect:e.rootMenu.props.popperEffect,placement:"right","fallback-placements":["left"],persistent:""},{content:vn((()=>[vr(e.$slots,"title")])),default:vn((()=>[Ti("div",{class:l(e.nsMenu.be("tooltip","trigger"))},[vr(e.$slots,"default")],2)])),_:3},8,["effect"])):(fi(),yi(li,{key:1},[vr(e.$slots,"default"),vr(e.$slots,"title")],64))],2)}],["__file","/home/runner/work/element-plus/element-plus/packages/components/menu/src/menu-item.vue"]]);var Zk=J_(Fn({name:"ElMenuItemGroup",props:{title:String},setup:()=>({ns:rv("menu-item-group")})}),[["render",function(e,t,n,r,i,a){return fi(),yi("li",{class:l(e.ns.b())},[Ti("div",{class:l(e.ns.e("title"))},[e.$slots.title?vr(e.$slots,"title",{key:1}):(fi(),yi(li,{key:0},[Pi(f(e.title),1)],64))],2),Ti("ul",null,[vr(e.$slots,"default")])],2)}],["__file","/home/runner/work/element-plus/element-plus/packages/components/menu/src/menu-item-group.vue"]]);const Jk=_g($k,{MenuItem:Kk,MenuItemGroup:Zk,SubMenu:jk}),Qk=xg(Kk),eD=xg(Zk),tD=xg(jk),nD=pg({icon:{type:fg,default:()=>Sp},title:String,content:{type:String,default:""}}),rD=["aria-label"],iD=Fn({name:"ElPageHeader"}),aD=Fn({...iD,props:nD,emits:{back:()=>!0},setup(e,{emit:t}){const n=Zi(),{t:r}=Jg(),i=rv("page-header"),a=Ki((()=>[i.b(),{[i.m("has-breadcrumb")]:!!n.breadcrumb,[i.m("has-extra")]:!!n.extra,[i.is("contentful")]:!!n.default}]));function s(){t("back")}return(e,t)=>(fi(),yi("div",{class:l(Dt(a))},[e.$slots.breadcrumb?(fi(),yi("div",{key:0,class:l(Dt(i).e("breadcrumb"))},[vr(e.$slots,"breadcrumb")],2)):Li("v-if",!0),Ti("div",{class:l(Dt(i).e("header"))},[Ti("div",{class:l(Dt(i).e("left"))},[Ti("div",{class:l(Dt(i).e("back")),role:"button",tabindex:"0",onClick:s},[e.icon||e.$slots.icon?(fi(),yi("div",{key:0,"aria-label":e.title||Dt(r)("el.pageHeader.title"),class:l(Dt(i).e("icon"))},[vr(e.$slots,"icon",{},(()=>[e.icon?(fi(),_i(Dt(ib),{key:0},{default:vn((()=>[(fi(),_i(dr(e.icon)))])),_:1})):Li("v-if",!0)]))],10,rD)):Li("v-if",!0),Ti("div",{class:l(Dt(i).e("title"))},[vr(e.$slots,"title",{},(()=>[Pi(f(e.title||Dt(r)("el.pageHeader.title")),1)]))],2)],2),Mi(Dt(OR),{direction:"vertical"}),Ti("div",{class:l(Dt(i).e("content"))},[vr(e.$slots,"content",{},(()=>[Pi(f(e.content),1)]))],2)],2),e.$slots.extra?(fi(),yi("div",{key:0,class:l(Dt(i).e("extra"))},[vr(e.$slots,"extra")],2)):Li("v-if",!0)],2),e.$slots.default?(fi(),yi("div",{key:1,class:l(Dt(i).e("main"))},[vr(e.$slots,"default")],2)):Li("v-if",!0)],2))}});const sD=_g(J_(aD,[["__file","/home/runner/work/element-plus/element-plus/packages/components/page-header/src/page-header.vue"]])),oD=Symbol("elPaginationKey"),lD=pg({disabled:Boolean,currentPage:{type:Number,default:1},prevText:{type:String},prevIcon:{type:fg}}),uD={click:e=>e instanceof MouseEvent},cD=["disabled","aria-label","aria-disabled"],dD={key:0},hD=Fn({name:"ElPaginationPrev"}),pD=Fn({...hD,props:lD,emits:uD,setup(e){const t=e,{t:n}=Jg(),r=Ki((()=>t.disabled||t.currentPage<=1));return(e,t)=>(fi(),yi("button",{type:"button",class:"btn-prev",disabled:Dt(r),"aria-label":e.prevText||Dt(n)("el.pagination.prev"),"aria-disabled":Dt(r),onClick:t[0]||(t[0]=t=>e.$emit("click",t))},[e.prevText?(fi(),yi("span",dD,f(e.prevText),1)):(fi(),_i(Dt(ib),{key:1},{default:vn((()=>[(fi(),_i(dr(e.prevIcon)))])),_:1}))],8,cD))}});var fD=J_(pD,[["__file","/home/runner/work/element-plus/element-plus/packages/components/pagination/src/components/prev.vue"]]);const mD=pg({disabled:Boolean,currentPage:{type:Number,default:1},pageCount:{type:Number,default:50},nextText:{type:String},nextIcon:{type:fg}}),gD=["disabled","aria-label","aria-disabled"],vD={key:0},yD=Fn({name:"ElPaginationNext"}),_D=Fn({...yD,props:mD,emits:["click"],setup(e){const t=e,{t:n}=Jg(),r=Ki((()=>t.disabled||t.currentPage===t.pageCount||0===t.pageCount));return(e,t)=>(fi(),yi("button",{type:"button",class:"btn-next",disabled:Dt(r),"aria-label":e.nextText||Dt(n)("el.pagination.next"),"aria-disabled":Dt(r),onClick:t[0]||(t[0]=t=>e.$emit("click",t))},[e.nextText?(fi(),yi("span",vD,f(e.nextText),1)):(fi(),_i(Dt(ib),{key:1},{default:vn((()=>[(fi(),_i(dr(e.nextIcon)))])),_:1}))],8,gD))}});var bD=J_(_D,[["__file","/home/runner/work/element-plus/element-plus/packages/components/pagination/src/components/next.vue"]]);const xD=Symbol("ElSelectGroup"),wD=Symbol("ElSelect");var SD=J_(Fn({name:"ElOption",componentName:"ElOption",props:{value:{required:!0,type:[String,Number,Boolean,Object]},label:[String,Number],created:Boolean,disabled:{type:Boolean,default:!1}},setup(e){const t=rv("select"),n=pt({index:-1,groupDisabled:!1,visible:!0,hitState:!1,hover:!1}),{currentLabel:r,itemSelected:i,isDisabled:a,select:s,hoverItem:o}=function(e,t){const n=Sn(wD),r=Sn(xD,{disabled:!1}),i=Ki((()=>"[object object]"===Object.prototype.toString.call(e.value).toLowerCase())),a=Ki((()=>n.props.multiple?d(n.props.modelValue,e.value):h(e.value,n.props.modelValue))),s=Ki((()=>{if(n.props.multiple){const e=n.props.modelValue||[];return!a.value&&e.length>=n.props.multipleLimit&&n.props.multipleLimit>0}return!1})),o=Ki((()=>e.label||(i.value?"":e.value))),l=Ki((()=>e.value||e.label||"")),u=Ki((()=>e.disabled||t.groupDisabled||s.value)),c=Fi(),d=(e=[],t)=>{if(i.value){const r=n.props.valueKey;return e&&e.some((e=>xt(Vu(e,r))===Vu(t,r)))}return e&&e.includes(t)},h=(e,t)=>{if(i.value){const{valueKey:r}=n.props;return Vu(e,r)===Vu(t,r)}return e===t};Mn((()=>o.value),(()=>{e.created||n.props.remote||n.setSelected()})),Mn((()=>e.value),((t,r)=>{const{remote:i,valueKey:a}=n.props;if(Object.is(t,r)||(n.onOptionDestroy(r,c.proxy),n.onOptionCreate(c.proxy)),!e.created&&!i){if(a&&"object"==typeof t&&"object"==typeof r&&t[a]===r[a])return;n.setSelected()}})),Mn((()=>r.disabled),(()=>{t.groupDisabled=r.disabled}),{immediate:!0});const{queryChange:p}=xt(n);return Mn(p,(r=>{const{query:i}=Dt(r),a=new RegExp(Fh(i),"i");t.visible=a.test(o.value)||e.created,t.visible||n.filteredOptionsCount--}),{immediate:!0}),{select:n,currentLabel:o,currentValue:l,itemSelected:a,isDisabled:u,hoverItem:()=>{e.disabled||r.disabled||(n.hoverIndex=n.optionsArray.indexOf(c.proxy))}}}(e,n),{visible:l,hover:u}=Nt(n),c=Fi().proxy;return s.onOptionCreate(c),Qn((()=>{const e=c.value,{selected:t}=s,n=(s.props.multiple?t:[t]).some((e=>e.value===c.value));en((()=>{s.cachedOptions.get(e)!==c||n||s.cachedOptions.delete(e)})),s.onOptionDestroy(e,c)})),{ns:t,currentLabel:r,itemSelected:i,isDisabled:a,select:s,hoverItem:o,visible:l,hover:u,selectOptionClick:function(){!0!==e.disabled&&!0!==n.groupDisabled&&s.handleOptionSelect(c,!0)},states:n}}}),[["render",function(e,t,n,r,i,a){return ar((fi(),yi("li",{class:l([e.ns.be("dropdown","item"),e.ns.is("disabled",e.isDisabled),{selected:e.itemSelected,hover:e.hover}]),onMouseenter:t[0]||(t[0]=(...t)=>e.hoverItem&&e.hoverItem(...t)),onClick:t[1]||(t[1]=ts(((...t)=>e.selectOptionClick&&e.selectOptionClick(...t)),["stop"]))},[vr(e.$slots,"default",{},(()=>[Ti("span",null,f(e.currentLabel),1)]))],34)),[[is,e.visible]])}],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/option.vue"]]);var CD=J_(Fn({name:"ElSelectDropdown",componentName:"ElSelectDropdown",setup(){const e=Sn(wD),t=rv("select"),n=Ki((()=>e.props.popperClass)),r=Ki((()=>e.props.multiple)),i=Ki((()=>e.props.fitInputWidth)),a=At("");function s(){var t;a.value=`${null==(t=e.selectWrapper)?void 0:t.offsetWidth}px`}return Kn((()=>{s(),lo(e.selectWrapper,s)})),{ns:t,minWidth:a,popperClass:n,isMultiple:r,isFitInputWidth:i}}}),[["render",function(e,t,n,i,a,s){return fi(),yi("div",{class:l([e.ns.b("dropdown"),e.ns.is("multiple",e.isMultiple),e.popperClass]),style:r({[e.isFitInputWidth?"width":"minWidth"]:e.minWidth})},[vr(e.$slots,"default")],6)}],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/select-dropdown.vue"]]);const TD=(e,t,n)=>{const{t:r}=Jg(),i=rv("select");Yg({from:"suffixTransition",replacement:"override style scheme",version:"2.3.0",scope:"props",ref:"https://element-plus.org/en-US/component/select.html#select-attributes"},Ki((()=>!1===e.suffixTransition)));const a=At(null),s=At(null),o=At(null),l=At(null),u=At(null),c=At(null),d=At(null),h=At(-1),p=Pt({query:""}),f=Pt(""),m=At([]);let g=0;const{form:v,formItem:y}=pb(),_=Ki((()=>!e.filterable||e.multiple||!t.visible)),b=Ki((()=>e.disabled||(null==v?void 0:v.disabled))),x=Ki((()=>{const n=e.multiple?Array.isArray(e.modelValue)&&e.modelValue.length>0:void 0!==e.modelValue&&null!==e.modelValue&&""!==e.modelValue;return e.clearable&&!b.value&&t.inputHovering&&n})),w=Ki((()=>e.remote&&e.filterable&&!e.remoteShowSuffix?"":e.suffixIcon)),S=Ki((()=>i.is("reverse",w.value&&t.visible&&e.suffixTransition))),C=Ki((()=>e.remote?300:0)),T=Ki((()=>e.loading?e.loadingText||r("el.select.loading"):(!e.remote||""!==t.query||0!==t.options.size)&&(e.filterable&&t.query&&t.options.size>0&&0===t.filteredOptionsCount?e.noMatchText||r("el.select.noMatch"):0===t.options.size?e.noDataText||r("el.select.noData"):null))),M=Ki((()=>{const e=Array.from(t.options.values()),n=[];return m.value.forEach((t=>{const r=e.findIndex((e=>e.currentLabel===t));r>-1&&n.push(e[r])})),n.length?n:e})),E=Ki((()=>Array.from(t.cachedOptions.values()))),A=Ki((()=>{const n=M.value.filter((e=>!e.created)).some((e=>e.currentLabel===t.query));return e.filterable&&e.allowCreate&&""!==t.query&&!n})),P=db(),R=Ki((()=>["small"].includes(P.value)?"small":"default")),L=Ki({get:()=>t.visible&&!1!==T.value,set(e){t.visible=e}});Mn([()=>b.value,()=>P.value,()=>null==v?void 0:v.size],(()=>{en((()=>{I()}))})),Mn((()=>e.placeholder),(e=>{t.cachedPlaceHolder=t.currentPlaceholder=e})),Mn((()=>e.modelValue),((n,r)=>{e.multiple&&(I(),n&&n.length>0||s.value&&""!==t.query?t.currentPlaceholder="":t.currentPlaceholder=t.cachedPlaceHolder,e.filterable&&!e.reserveKeyword&&(t.query="",N(t.query))),F(),e.filterable&&!e.multiple&&(t.inputLength=20),!Eh(n,r)&&e.validateEvent&&(null==y||y.validate("change").catch((e=>{})))}),{flush:"post",deep:!0}),Mn((()=>t.visible),(r=>{var i,a,u,c,d;r?(null==(a=null==(i=l.value)?void 0:i.updatePopper)||a.call(i),e.filterable&&(t.filteredOptionsCount=t.optionsCount,t.query=e.remote?"":t.selectedLabel,null==(c=null==(u=o.value)?void 0:u.focus)||c.call(u),e.multiple?null==(d=s.value)||d.focus():t.selectedLabel&&(t.currentPlaceholder=`${t.selectedLabel}`,t.selectedLabel=""),N(t.query),e.multiple||e.remote||(p.value.query="",kt(p),kt(f)))):(e.filterable&&(k(e.filterMethod)&&e.filterMethod(""),k(e.remoteMethod)&&e.remoteMethod("")),s.value&&s.value.blur(),t.query="",t.previousQuery=null,t.selectedLabel="",t.inputLength=20,t.menuVisibleOnFocus=!1,G(),en((()=>{s.value&&""===s.value.value&&0===t.selected.length&&(t.currentPlaceholder=t.cachedPlaceHolder)})),e.multiple||(t.selected&&(e.filterable&&e.allowCreate&&t.createdSelected&&t.createdLabel?t.selectedLabel=t.createdLabel:t.selectedLabel=t.selected.currentLabel,e.filterable&&(t.query=t.selectedLabel)),e.filterable&&(t.currentPlaceholder=t.cachedPlaceHolder))),n.emit("visible-change",r)})),Mn((()=>t.options.entries()),(()=>{var n,r,i;if(!Os)return;null==(r=null==(n=l.value)?void 0:n.updatePopper)||r.call(n),e.multiple&&I();const a=(null==(i=c.value)?void 0:i.querySelectorAll("input"))||[];Array.from(a).includes(document.activeElement)||F(),e.defaultFirstOption&&(e.filterable||e.remote)&&t.filteredOptionsCount&&U()}),{flush:"post"}),Mn((()=>t.hoverIndex),(e=>{Bs(e)&&e>-1?h.value=M.value[e]||{}:h.value={},M.value.forEach((e=>{e.hover=h.value===e}))}));const I=()=>{en((()=>{var e,n;if(!a.value)return;const r=a.value.$el.querySelector("input");g=g||(r.clientHeight>0?r.clientHeight+2:0);const i=u.value,s=(o=P.value||(null==v?void 0:v.size),Rg[o||"default"]);var o;const c=s===g||g<=0?s:g;!(null===r.offsetParent)&&(r.style.height=(0===t.selected.length?c:Math.max(i?i.clientHeight+(i.clientHeight>c?6:0):0,c))-2+"px"),t.tagInMultiLine=Number.parseFloat(r.style.height)>=c,t.visible&&!1!==T.value&&(null==(n=null==(e=l.value)?void 0:e.updatePopper)||n.call(e))}))},N=async n=>{t.previousQuery===n||t.isOnComposition||(null!==t.previousQuery||!k(e.filterMethod)&&!k(e.remoteMethod)?(t.previousQuery=n,en((()=>{var e,n;t.visible&&(null==(n=null==(e=l.value)?void 0:e.updatePopper)||n.call(e))})),t.hoverIndex=-1,e.multiple&&e.filterable&&en((()=>{const n=15*s.value.value.length+20;t.inputLength=e.collapseTags?Math.min(50,n):n,B(),I()})),e.remote&&k(e.remoteMethod)?(t.hoverIndex=-1,e.remoteMethod(n)):k(e.filterMethod)?(e.filterMethod(n),kt(f)):(t.filteredOptionsCount=t.optionsCount,p.value.query=n,kt(p),kt(f)),e.defaultFirstOption&&(e.filterable||e.remote)&&t.filteredOptionsCount&&(await en(),U())):t.previousQuery=n)},B=()=>{""!==t.currentPlaceholder&&(t.currentPlaceholder=s.value.value?"":t.cachedPlaceHolder)},U=()=>{const e=M.value.filter((e=>e.visible&&!e.disabled&&!e.states.groupDisabled)),n=e.find((e=>e.created)),r=e[0];t.hoverIndex=q(M.value,n||r)},F=()=>{var n;if(!e.multiple){const r=V(e.modelValue);return(null==(n=r.props)?void 0:n.created)?(t.createdLabel=r.props.value,t.createdSelected=!0):t.createdSelected=!1,t.selectedLabel=r.currentLabel,t.selected=r,void(e.filterable&&(t.query=t.selectedLabel))}t.selectedLabel="";const r=[];Array.isArray(e.modelValue)&&e.modelValue.forEach((e=>{r.push(V(e))})),t.selected=r,en((()=>{I()}))},V=n=>{let r;const i="object"===z(n).toLowerCase(),a="null"===z(n).toLowerCase(),s="undefined"===z(n).toLowerCase();for(let l=t.cachedOptions.size-1;l>=0;l--){const t=E.value[l];if(i?Vu(t.value,e.valueKey)===Vu(n,e.valueKey):t.value===n){r={value:n,currentLabel:t.currentLabel,isDisabled:t.isDisabled};break}}if(r)return r;const o={value:n,currentLabel:i?n.label:a||s?"":n};return e.multiple&&(o.hitState=!1),o},G=()=>{setTimeout((()=>{const n=e.valueKey;e.multiple?t.selected.length>0?t.hoverIndex=Math.min.apply(null,t.selected.map((e=>M.value.findIndex((t=>Vu(t,n)===Vu(e,n)))))):t.hoverIndex=-1:t.hoverIndex=M.value.findIndex((e=>ee(e)===ee(t.selected)))}),300)},H=()=>{var e;t.inputWidth=null==(e=a.value)?void 0:e.$el.offsetWidth},j=gh((()=>{e.filterable&&t.query!==t.selectedLabel&&(t.query=t.selectedLabel,N(t.query))}),C.value),W=gh((e=>{N(e.target.value)}),C.value),Y=t=>{Eh(e.modelValue,t)||n.emit(Mg,t)},$=r=>{r.stopPropagation();const i=e.multiple?[]:"";if(!D(i))for(const e of t.selected)e.isDisabled&&i.push(e.value);n.emit(Tg,i),Y(i),t.hoverIndex=-1,t.visible=!1,n.emit("clear")},X=(r,i)=>{var a;if(e.multiple){const i=(e.modelValue||[]).slice(),o=q(i,r.value);o>-1?i.splice(o,1):(e.multipleLimit<=0||i.length<e.multipleLimit)&&i.push(r.value),n.emit(Tg,i),Y(i),r.created&&(t.query="",N(""),t.inputLength=20),e.filterable&&(null==(a=s.value)||a.focus())}else n.emit(Tg,r.value),Y(r.value),t.visible=!1;t.isSilentBlur=i,K(),t.visible||en((()=>{Z(r)}))},q=(t=[],n)=>{if(!O(n))return t.indexOf(n);const r=e.valueKey;let i=-1;return t.some(((e,t)=>xt(Vu(e,r))===Vu(n,r)&&(i=t,!0))),i},K=()=>{t.softFocus=!0;const e=s.value||a.value;e&&(null==e||e.focus())},Z=e=>{var t,n,r,a,s;const o=Array.isArray(e)?e[0]:e;let u=null;if(null==o?void 0:o.value){const e=M.value.filter((e=>e.value===o.value));e.length>0&&(u=e[0].$el)}if(l.value&&u){const e=null==(a=null==(r=null==(n=null==(t=l.value)?void 0:t.popperRef)?void 0:n.contentRef)?void 0:r.querySelector)?void 0:a.call(r,`.${i.be("dropdown","wrap")}`);e&&np(e,u)}null==(s=d.value)||s.handleScroll()},J=e=>{if(!Array.isArray(t.selected))return;const n=t.selected[t.selected.length-1];return n?!0===e||!1===e?(n.hitState=e,e):(n.hitState=!n.hitState,n.hitState):void 0},Q=e=>{var n;e&&!t.mouseEnter||b.value||(t.menuVisibleOnFocus?t.menuVisibleOnFocus=!1:l.value&&l.value.isFocusInsideContent()||(t.visible=!t.visible),t.visible&&(null==(n=s.value||a.value)||n.focus()))},ee=t=>O(t.value)?Vu(t.value,e.valueKey):t.value,te=Ki((()=>M.value.filter((e=>e.visible)).every((e=>e.disabled)))),ne=Ki((()=>t.selected.slice(0,e.maxCollapseTags))),re=Ki((()=>t.selected.slice(e.maxCollapseTags))),ie=e=>{if(t.visible){if(0!==t.options.size&&0!==t.filteredOptionsCount&&!t.isOnComposition&&!te.value){"next"===e?(t.hoverIndex++,t.hoverIndex===t.options.size&&(t.hoverIndex=0)):"prev"===e&&(t.hoverIndex--,t.hoverIndex<0&&(t.hoverIndex=t.options.size-1));const n=M.value[t.hoverIndex];!0!==n.disabled&&!0!==n.states.groupDisabled&&n.visible||ie(e),en((()=>Z(h.value)))}}else t.visible=!0};return{optionList:m,optionsArray:M,selectSize:P,handleResize:()=>{var t,n;H(),null==(n=null==(t=l.value)?void 0:t.updatePopper)||n.call(t),e.multiple&&I()},debouncedOnInputChange:j,debouncedQueryChange:W,deletePrevTag:r=>{if(r.target.value.length<=0&&!J()){const t=e.modelValue.slice();t.pop(),n.emit(Tg,t),Y(t)}1===r.target.value.length&&0===e.modelValue.length&&(t.currentPlaceholder=t.cachedPlaceHolder)},deleteTag:(r,i)=>{const a=t.selected.indexOf(i);if(a>-1&&!b.value){const t=e.modelValue.slice();t.splice(a,1),n.emit(Tg,t),Y(t),n.emit("remove-tag",i.value)}r.stopPropagation()},deleteSelected:$,handleOptionSelect:X,scrollToOption:Z,readonly:_,resetInputHeight:I,showClose:x,iconComponent:w,iconReverse:S,showNewOption:A,collapseTagSize:R,setSelected:F,managePlaceholder:B,selectDisabled:b,emptyText:T,toggleLastOptionHitState:J,resetInputState:e=>{e.code!==Sg.backspace&&J(!1),t.inputLength=15*s.value.value.length+20,I()},handleComposition:e=>{const n=e.target.value;if("compositionend"===e.type)t.isOnComposition=!1,en((()=>N(n)));else{const e=n[n.length-1]||"";t.isOnComposition=!zg(e)}},onOptionCreate:e=>{t.optionsCount++,t.filteredOptionsCount++,t.options.set(e.value,e),t.cachedOptions.set(e.value,e)},onOptionDestroy:(e,n)=>{t.options.get(e)===n&&(t.optionsCount--,t.filteredOptionsCount--,t.options.delete(e))},handleMenuEnter:()=>{en((()=>Z(t.selected)))},handleFocus:r=>{t.softFocus?t.softFocus=!1:((e.automaticDropdown||e.filterable)&&(e.filterable&&!t.visible&&(t.menuVisibleOnFocus=!0),t.visible=!0),n.emit("focus",r))},blur:()=>{var e,n,r;t.visible=!1,null==(e=a.value)||e.blur(),null==(r=null==(n=o.value)?void 0:n.blur)||r.call(n)},handleBlur:e=>{en((()=>{t.isSilentBlur?t.isSilentBlur=!1:n.emit("blur",e)})),t.softFocus=!1},handleClearClick:e=>{$(e)},handleClose:()=>{t.visible=!1},handleKeydownEscape:e=>{t.visible&&(e.preventDefault(),e.stopPropagation(),t.visible=!1)},toggleMenu:Q,selectOption:()=>{t.visible?M.value[t.hoverIndex]&&X(M.value[t.hoverIndex],void 0):Q()},getValueKey:ee,navigateOptions:ie,dropMenuVisible:L,queryChange:p,groupQueryChange:f,showTagList:ne,collapseTagList:re,reference:a,input:s,iOSInput:o,tooltipRef:l,tags:u,selectWrapper:c,scrollbar:d,handleMouseEnter:()=>{t.mouseEnter=!0},handleMouseLeave:()=>{t.mouseEnter=!1}}};var MD=Fn({name:"ElOptions",emits:["update-options"],setup(e,{slots:t,emit:n}){let r=[];return()=>{var e,i;const a=null==(e=t.default)?void 0:e.call(t),s=[];return a.length&&function e(t){Array.isArray(t)&&t.forEach((t=>{var n,r,i,a;const o=null==(n=(null==t?void 0:t.type)||{})?void 0:n.name;"ElOptionGroup"===o?e(D(t.children)||Array.isArray(t.children)||!k(null==(r=t.children)?void 0:r.default)?t.children:null==(i=t.children)?void 0:i.default()):"ElOption"===o?s.push(null==(a=t.props)?void 0:a.label):Array.isArray(t.children)&&e(t.children)}))}(null==(i=a[0])?void 0:i.children),function(e,t){if(e.length!==t.length)return!1;for(const[n]of e.entries())if(e[n]!=t[n])return!1;return!0}(s,r)||(r=s,n("update-options",s)),a}}});const ED="ElSelect",AD=Fn({name:ED,componentName:ED,components:{ElInput:mx,ElSelectMenu:CD,ElOption:SD,ElOptions:MD,ElTag:sE,ElScrollbar:Tx,ElTooltip:Ow,ElIcon:ib},directives:{ClickOutside:EC},props:{name:String,id:String,modelValue:{type:[Array,String,Number,Boolean,Object],default:void 0},autocomplete:{type:String,default:"off"},automaticDropdown:Boolean,size:{type:String,validator:Lg},effect:{type:String,default:"light"},disabled:Boolean,clearable:Boolean,filterable:Boolean,allowCreate:Boolean,loading:Boolean,popperClass:{type:String,default:""},popperOptions:{type:Object,default:()=>({})},remote:Boolean,loadingText:String,noMatchText:String,noDataText:String,remoteMethod:Function,filterMethod:Function,multiple:Boolean,multipleLimit:{type:Number,default:0},placeholder:{type:String},defaultFirstOption:Boolean,reserveKeyword:{type:Boolean,default:!0},valueKey:{type:String,default:"value"},collapseTags:Boolean,collapseTagsTooltip:{type:Boolean,default:!1},maxCollapseTags:{type:Number,default:1},teleported:_w.teleported,persistent:{type:Boolean,default:!0},clearIcon:{type:fg,default:tf},fitInputWidth:{type:Boolean,default:!1},suffixIcon:{type:fg,default:op},tagType:{...rE.type,default:"info"},validateEvent:{type:Boolean,default:!0},remoteShowSuffix:{type:Boolean,default:!1},suffixTransition:{type:Boolean,default:!0},placement:{type:String,values:wv,default:"bottom-start"}},emits:[Tg,Mg,"remove-tag","clear","visible-change","focus","blur"],setup(e,t){const n=rv("select"),r=rv("input"),{t:i}=Jg(),a=function(e){const{t:t}=Jg();return pt({options:new Map,cachedOptions:new Map,createdLabel:null,createdSelected:!1,selected:e.multiple?[]:{},inputLength:20,inputWidth:0,optionsCount:0,filteredOptionsCount:0,visible:!1,softFocus:!1,selectedLabel:"",hoverIndex:-1,query:"",previousQuery:null,inputHovering:!1,cachedPlaceHolder:"",currentPlaceholder:t("el.select.placeholder"),menuVisibleOnFocus:!1,isOnComposition:!1,isSilentBlur:!1,prefixWidth:11,tagInMultiLine:!1,mouseEnter:!1})}(e),{optionList:s,optionsArray:o,selectSize:l,readonly:u,handleResize:c,collapseTagSize:d,debouncedOnInputChange:h,debouncedQueryChange:p,deletePrevTag:f,deleteTag:m,deleteSelected:g,handleOptionSelect:v,scrollToOption:y,setSelected:_,resetInputHeight:b,managePlaceholder:x,showClose:w,selectDisabled:S,iconComponent:C,iconReverse:T,showNewOption:M,emptyText:E,toggleLastOptionHitState:A,resetInputState:P,handleComposition:R,onOptionCreate:L,onOptionDestroy:k,handleMenuEnter:D,handleFocus:I,blur:O,handleBlur:N,handleClearClick:B,handleClose:U,handleKeydownEscape:z,toggleMenu:F,selectOption:V,getValueKey:G,navigateOptions:H,dropMenuVisible:j,reference:W,input:Y,iOSInput:$,tooltipRef:X,tags:q,selectWrapper:K,scrollbar:Z,queryChange:J,groupQueryChange:Q,handleMouseEnter:ee,handleMouseLeave:te,showTagList:ne,collapseTagList:re}=TD(e,a,t),{focus:ie}=(ae=W,{focus:()=>{var e,t;null==(t=null==(e=ae.value)?void 0:e.focus)||t.call(e)}});var ae;const{inputWidth:se,selected:oe,inputLength:le,filteredOptionsCount:ue,visible:ce,softFocus:de,selectedLabel:he,hoverIndex:pe,query:fe,inputHovering:me,currentPlaceholder:ge,menuVisibleOnFocus:ve,isOnComposition:ye,isSilentBlur:_e,options:be,cachedOptions:xe,optionsCount:we,prefixWidth:Se,tagInMultiLine:Ce}=Nt(a),Te=Ki((()=>{const t=[n.b()],r=Dt(l);return r&&t.push(n.m(r)),e.disabled&&t.push(n.m("disabled")),t})),Me=Ki((()=>({maxWidth:Dt(se)-32+"px",width:"100%"}))),Ee=Ki((()=>({maxWidth:`${Dt(se)>123?Dt(se)-123:Dt(se)-75}px`})));wn(wD,pt({props:e,options:be,optionsArray:o,cachedOptions:xe,optionsCount:we,filteredOptionsCount:ue,hoverIndex:pe,handleOptionSelect:v,onOptionCreate:L,onOptionDestroy:k,selectWrapper:K,selected:oe,setSelected:_,queryChange:J,groupQueryChange:Q})),Kn((()=>{a.cachedPlaceHolder=ge.value=e.placeholder||(()=>i("el.select.placeholder")),e.multiple&&Array.isArray(e.modelValue)&&e.modelValue.length>0&&(ge.value=""),lo(K,c),e.remote&&e.multiple&&b(),en((()=>{const e=W.value&&W.value.$el;if(e&&(se.value=e.getBoundingClientRect().width,t.slots.prefix)){const t=e.querySelector(`.${r.e("prefix")}`);Se.value=Math.max(t.getBoundingClientRect().width+5,30)}})),_()})),e.multiple&&!Array.isArray(e.modelValue)&&t.emit(Tg,[]),!e.multiple&&Array.isArray(e.modelValue)&&t.emit(Tg,"");const Ae=Ki((()=>{var e,t;return null==(t=null==(e=X.value)?void 0:e.popperRef)?void 0:t.contentRef}));return{isIOS:Fs,onOptionsRendered:e=>{s.value=e},tagInMultiLine:Ce,prefixWidth:Se,selectSize:l,readonly:u,handleResize:c,collapseTagSize:d,debouncedOnInputChange:h,debouncedQueryChange:p,deletePrevTag:f,deleteTag:m,deleteSelected:g,handleOptionSelect:v,scrollToOption:y,inputWidth:se,selected:oe,inputLength:le,filteredOptionsCount:ue,visible:ce,softFocus:de,selectedLabel:he,hoverIndex:pe,query:fe,inputHovering:me,currentPlaceholder:ge,menuVisibleOnFocus:ve,isOnComposition:ye,isSilentBlur:_e,options:be,resetInputHeight:b,managePlaceholder:x,showClose:w,selectDisabled:S,iconComponent:C,iconReverse:T,showNewOption:M,emptyText:E,toggleLastOptionHitState:A,resetInputState:P,handleComposition:R,handleMenuEnter:D,handleFocus:I,blur:O,handleBlur:N,handleClearClick:B,handleClose:U,handleKeydownEscape:z,toggleMenu:F,selectOption:V,getValueKey:G,navigateOptions:H,dropMenuVisible:j,focus:ie,reference:W,input:Y,iOSInput:$,tooltipRef:X,popperPaneRef:Ae,tags:q,selectWrapper:K,scrollbar:Z,wrapperKls:Te,selectTagsStyle:Me,nsSelect:n,tagTextStyle:Ee,handleMouseEnter:ee,handleMouseLeave:te,showTagList:ne,collapseTagList:re}}}),PD=["disabled","autocomplete"],RD=["disabled"],LD={style:{height:"100%",display:"flex","justify-content":"center","align-items":"center"}};var kD=J_(AD,[["render",function(e,t,n,i,a,s){const o=ur("el-tag"),u=ur("el-tooltip"),c=ur("el-icon"),d=ur("el-input"),h=ur("el-option"),p=ur("el-options"),m=ur("el-scrollbar"),g=ur("el-select-menu"),v=hr("click-outside");return ar((fi(),yi("div",{ref:"selectWrapper",class:l(e.wrapperKls),onMouseenter:t[21]||(t[21]=(...t)=>e.handleMouseEnter&&e.handleMouseEnter(...t)),onMouseleave:t[22]||(t[22]=(...t)=>e.handleMouseLeave&&e.handleMouseLeave(...t)),onClick:t[23]||(t[23]=ts(((...t)=>e.toggleMenu&&e.toggleMenu(...t)),["stop"]))},[Mi(u,{ref:"tooltipRef",visible:e.dropMenuVisible,placement:e.placement,teleported:e.teleported,"popper-class":[e.nsSelect.e("popper"),e.popperClass],"popper-options":e.popperOptions,"fallback-placements":["bottom-start","top-start","right","left"],effect:e.effect,pure:"",trigger:"click",transition:`${e.nsSelect.namespace.value}-zoom-in-top`,"stop-popper-mouse-event":!1,"gpu-acceleration":!1,persistent:e.persistent,onShow:e.handleMenuEnter},{default:vn((()=>[Ti("div",{class:"select-trigger",onMouseenter:t[19]||(t[19]=t=>e.inputHovering=!0),onMouseleave:t[20]||(t[20]=t=>e.inputHovering=!1)},[e.multiple?(fi(),yi("div",{key:0,ref:"tags",class:l([e.nsSelect.e("tags"),e.nsSelect.is("disabled",e.selectDisabled)]),style:r(e.selectTagsStyle)},[e.collapseTags&&e.selected.length?(fi(),_i(xa,{key:0,onAfterLeave:e.resetInputHeight},{default:vn((()=>[Ti("span",{class:l([e.nsSelect.b("tags-wrapper"),{"has-prefix":e.prefixWidth&&e.selected.length}])},[(fi(!0),yi(li,null,mr(e.showTagList,(t=>(fi(),_i(o,{key:e.getValueKey(t),closable:!e.selectDisabled&&!t.isDisabled,size:e.collapseTagSize,hit:t.hitState,type:e.tagType,"disable-transitions":"",onClose:n=>e.deleteTag(n,t)},{default:vn((()=>[Ti("span",{class:l(e.nsSelect.e("tags-text")),style:r(e.tagTextStyle)},f(t.currentLabel),7)])),_:2},1032,["closable","size","hit","type","onClose"])))),128)),e.selected.length>e.maxCollapseTags?(fi(),_i(o,{key:0,closable:!1,size:e.collapseTagSize,type:e.tagType,"disable-transitions":""},{default:vn((()=>[e.collapseTagsTooltip?(fi(),_i(u,{key:0,disabled:e.dropMenuVisible,"fallback-placements":["bottom","top","right","left"],effect:e.effect,placement:"bottom",teleported:e.teleported},{default:vn((()=>[Ti("span",{class:l(e.nsSelect.e("tags-text"))},"+ "+f(e.selected.length-e.maxCollapseTags),3)])),content:vn((()=>[Ti("div",{class:l(e.nsSelect.e("collapse-tags"))},[(fi(!0),yi(li,null,mr(e.collapseTagList,(t=>(fi(),yi("div",{key:e.getValueKey(t),class:l(e.nsSelect.e("collapse-tag"))},[Mi(o,{class:"in-tooltip",closable:!e.selectDisabled&&!t.isDisabled,size:e.collapseTagSize,hit:t.hitState,type:e.tagType,"disable-transitions":"",style:{margin:"2px"},onClose:n=>e.deleteTag(n,t)},{default:vn((()=>[Ti("span",{class:l(e.nsSelect.e("tags-text")),style:r({maxWidth:e.inputWidth-75+"px"})},f(t.currentLabel),7)])),_:2},1032,["closable","size","hit","type","onClose"])],2)))),128))],2)])),_:1},8,["disabled","effect","teleported"])):(fi(),yi("span",{key:1,class:l(e.nsSelect.e("tags-text"))},"+ "+f(e.selected.length-e.maxCollapseTags),3))])),_:1},8,["size","type"])):Li("v-if",!0)],2)])),_:1},8,["onAfterLeave"])):Li("v-if",!0),e.collapseTags?Li("v-if",!0):(fi(),_i(xa,{key:1,onAfterLeave:e.resetInputHeight},{default:vn((()=>[Ti("span",{class:l([e.nsSelect.b("tags-wrapper"),{"has-prefix":e.prefixWidth&&e.selected.length}])},[(fi(!0),yi(li,null,mr(e.selected,(t=>(fi(),_i(o,{key:e.getValueKey(t),closable:!e.selectDisabled&&!t.isDisabled,size:e.collapseTagSize,hit:t.hitState,type:e.tagType,"disable-transitions":"",onClose:n=>e.deleteTag(n,t)},{default:vn((()=>[Ti("span",{class:l(e.nsSelect.e("tags-text")),style:r({maxWidth:e.inputWidth-75+"px"})},f(t.currentLabel),7)])),_:2},1032,["closable","size","hit","type","onClose"])))),128))],2)])),_:1},8,["onAfterLeave"])),e.filterable?ar((fi(),yi("input",{key:2,ref:"input","onUpdate:modelValue":t[0]||(t[0]=t=>e.query=t),type:"text",class:l([e.nsSelect.e("input"),e.nsSelect.is(e.selectSize),e.nsSelect.is("disabled",e.selectDisabled)]),disabled:e.selectDisabled,autocomplete:e.autocomplete,style:r({marginLeft:e.prefixWidth&&!e.selected.length||e.tagInMultiLine?`${e.prefixWidth}px`:"",flexGrow:1,width:e.inputLength/(e.inputWidth-32)+"%",maxWidth:e.inputWidth-42+"px"}),onFocus:t[1]||(t[1]=(...t)=>e.handleFocus&&e.handleFocus(...t)),onBlur:t[2]||(t[2]=(...t)=>e.handleBlur&&e.handleBlur(...t)),onKeyup:t[3]||(t[3]=(...t)=>e.managePlaceholder&&e.managePlaceholder(...t)),onKeydown:[t[4]||(t[4]=(...t)=>e.resetInputState&&e.resetInputState(...t)),t[5]||(t[5]=rs(ts((t=>e.navigateOptions("next")),["prevent"]),["down"])),t[6]||(t[6]=rs(ts((t=>e.navigateOptions("prev")),["prevent"]),["up"])),t[7]||(t[7]=rs(((...t)=>e.handleKeydownEscape&&e.handleKeydownEscape(...t)),["esc"])),t[8]||(t[8]=rs(ts(((...t)=>e.selectOption&&e.selectOption(...t)),["stop","prevent"]),["enter"])),t[9]||(t[9]=rs(((...t)=>e.deletePrevTag&&e.deletePrevTag(...t)),["delete"])),t[10]||(t[10]=rs((t=>e.visible=!1),["tab"]))],onCompositionstart:t[11]||(t[11]=(...t)=>e.handleComposition&&e.handleComposition(...t)),onCompositionupdate:t[12]||(t[12]=(...t)=>e.handleComposition&&e.handleComposition(...t)),onCompositionend:t[13]||(t[13]=(...t)=>e.handleComposition&&e.handleComposition(...t)),onInput:t[14]||(t[14]=(...t)=>e.debouncedQueryChange&&e.debouncedQueryChange(...t))},null,46,PD)),[[$a,e.query]]):Li("v-if",!0)],6)):Li("v-if",!0),Li(" fix: https://github.com/element-plus/element-plus/issues/11415 "),e.isIOS&&!e.multiple&&e.filterable&&e.readonly?(fi(),yi("input",{key:1,ref:"iOSInput",class:l([e.nsSelect.e("input"),e.nsSelect.is(e.selectSize),e.nsSelect.em("input","iOS")]),disabled:e.selectDisabled,type:"text"},null,10,RD)):Li("v-if",!0),Mi(d,{id:e.id,ref:"reference",modelValue:e.selectedLabel,"onUpdate:modelValue":t[15]||(t[15]=t=>e.selectedLabel=t),type:"text",placeholder:"function"==typeof e.currentPlaceholder?e.currentPlaceholder():e.currentPlaceholder,name:e.name,autocomplete:e.autocomplete,size:e.selectSize,disabled:e.selectDisabled,readonly:e.readonly,"validate-event":!1,class:l([e.nsSelect.is("focus",e.visible)]),tabindex:e.multiple&&e.filterable?-1:void 0,onFocus:e.handleFocus,onBlur:e.handleBlur,onInput:e.debouncedOnInputChange,onPaste:e.debouncedOnInputChange,onCompositionstart:e.handleComposition,onCompositionupdate:e.handleComposition,onCompositionend:e.handleComposition,onKeydown:[t[16]||(t[16]=rs(ts((t=>e.navigateOptions("next")),["stop","prevent"]),["down"])),t[17]||(t[17]=rs(ts((t=>e.navigateOptions("prev")),["stop","prevent"]),["up"])),rs(ts(e.selectOption,["stop","prevent"]),["enter"]),rs(e.handleKeydownEscape,["esc"]),t[18]||(t[18]=rs((t=>e.visible=!1),["tab"]))]},gr({suffix:vn((()=>[e.iconComponent&&!e.showClose?(fi(),_i(c,{key:0,class:l([e.nsSelect.e("caret"),e.nsSelect.e("icon"),e.iconReverse])},{default:vn((()=>[(fi(),_i(dr(e.iconComponent)))])),_:1},8,["class"])):Li("v-if",!0),e.showClose&&e.clearIcon?(fi(),_i(c,{key:1,class:l([e.nsSelect.e("caret"),e.nsSelect.e("icon")]),onClick:e.handleClearClick},{default:vn((()=>[(fi(),_i(dr(e.clearIcon)))])),_:1},8,["class","onClick"])):Li("v-if",!0)])),_:2},[e.$slots.prefix?{name:"prefix",fn:vn((()=>[Ti("div",LD,[vr(e.$slots,"prefix")])]))}:void 0]),1032,["id","modelValue","placeholder","name","autocomplete","size","disabled","readonly","class","tabindex","onFocus","onBlur","onInput","onPaste","onCompositionstart","onCompositionupdate","onCompositionend","onKeydown"])],32)])),content:vn((()=>[Mi(g,null,{default:vn((()=>[ar(Mi(m,{ref:"scrollbar",tag:"ul","wrap-class":e.nsSelect.be("dropdown","wrap"),"view-class":e.nsSelect.be("dropdown","list"),class:l([e.nsSelect.is("empty",!e.allowCreate&&Boolean(e.query)&&0===e.filteredOptionsCount)])},{default:vn((()=>[e.showNewOption?(fi(),_i(h,{key:0,value:e.query,created:!0},null,8,["value"])):Li("v-if",!0),Mi(p,{onUpdateOptions:e.onOptionsRendered},{default:vn((()=>[vr(e.$slots,"default")])),_:3},8,["onUpdateOptions"])])),_:3},8,["wrap-class","view-class","class"]),[[is,e.options.size>0&&!e.loading]]),e.emptyText&&(!e.allowCreate||e.loading||e.allowCreate&&0===e.options.size)?(fi(),yi(li,{key:0},[e.$slots.empty?vr(e.$slots,"empty",{key:0}):(fi(),yi("p",{key:1,class:l(e.nsSelect.be("dropdown","empty"))},f(e.emptyText),3))],64)):Li("v-if",!0)])),_:3})])),_:3},8,["visible","placement","teleported","popper-class","popper-options","effect","transition","persistent","onShow"])],34)),[[v,e.handleClose,e.popperPaneRef]])}],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/select.vue"]]);var DD=J_(Fn({name:"ElOptionGroup",componentName:"ElOptionGroup",props:{label:String,disabled:{type:Boolean,default:!1}},setup(e){const t=rv("select"),n=At(!0),r=Fi(),i=At([]);wn(xD,pt({...Nt(e)}));const a=Sn(wD);Kn((()=>{i.value=s(r.subTree)}));const s=e=>{const t=[];return Array.isArray(e.children)&&e.children.forEach((e=>{var n;e.type&&"ElOption"===e.type.name&&e.component&&e.component.proxy?t.push(e.component.proxy):(null==(n=e.children)?void 0:n.length)&&t.push(...s(e))})),t},{groupQueryChange:o}=xt(a);return Mn(o,(()=>{n.value=i.value.some((e=>!0===e.visible))}),{flush:"post"}),{visible:n,ns:t}}}),[["render",function(e,t,n,r,i,a){return ar((fi(),yi("ul",{class:l(e.ns.be("group","wrap"))},[Ti("li",{class:l(e.ns.be("group","title"))},f(e.label),3),Ti("li",null,[Ti("ul",{class:l(e.ns.b("group"))},[vr(e.$slots,"default")],2)])],2)),[[is,e.visible]])}],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/option-group.vue"]]);const ID=_g(kD,{Option:SD,OptionGroup:DD}),OD=xg(SD),ND=xg(DD),BD=()=>Sn(oD,{}),UD=pg({pageSize:{type:Number,required:!0},pageSizes:{type:Array,default:()=>[10,20,30,40,50,100]},popperClass:{type:String},disabled:Boolean,size:{type:String,values:Pg}}),zD=Fn({name:"ElPaginationSizes"}),FD=Fn({...zD,props:UD,emits:["page-size-change"],setup(e,{emit:t}){const n=e,{t:r}=Jg(),i=rv("pagination"),a=BD(),s=At(n.pageSize);Mn((()=>n.pageSizes),((e,r)=>{if(!Eh(e,r)&&Array.isArray(e)){const r=e.includes(n.pageSize)?n.pageSize:n.pageSizes[0];t("page-size-change",r)}})),Mn((()=>n.pageSize),(e=>{s.value=e}));const o=Ki((()=>n.pageSizes));function u(e){var t;e!==s.value&&(s.value=e,null==(t=a.handleSizeChange)||t.call(a,Number(e)))}return(e,t)=>(fi(),yi("span",{class:l(Dt(i).e("sizes"))},[Mi(Dt(ID),{"model-value":s.value,disabled:e.disabled,"popper-class":e.popperClass,size:e.size,"validate-event":!1,onChange:u},{default:vn((()=>[(fi(!0),yi(li,null,mr(Dt(o),(e=>(fi(),_i(Dt(OD),{key:e,value:e,label:e+Dt(r)("el.pagination.pagesize")},null,8,["value","label"])))),128))])),_:1},8,["model-value","disabled","popper-class","size"])],2))}});var VD=J_(FD,[["__file","/home/runner/work/element-plus/element-plus/packages/components/pagination/src/components/sizes.vue"]]);const GD=pg({size:{type:String,values:Pg}}),HD=["disabled"],jD=Fn({name:"ElPaginationJumper"}),WD=Fn({...jD,props:GD,setup(e){const{t:t}=Jg(),n=rv("pagination"),{pageCount:r,disabled:i,currentPage:a,changeEvent:s}=BD(),o=At(),u=Ki((()=>{var e;return null!=(e=o.value)?e:null==a?void 0:a.value}));function c(e){o.value=e?+e:""}function d(e){e=Math.trunc(+e),null==s||s(e),o.value=void 0}return(e,a)=>(fi(),yi("span",{class:l(Dt(n).e("jump")),disabled:Dt(i)},[Ti("span",{class:l([Dt(n).e("goto")])},f(Dt(t)("el.pagination.goto")),3),Mi(Dt(mx),{size:e.size,class:l([Dt(n).e("editor"),Dt(n).is("in-pagination")]),min:1,max:Dt(r),disabled:Dt(i),"model-value":Dt(u),"validate-event":!1,label:Dt(t)("el.pagination.page"),type:"number","onUpdate:modelValue":c,onChange:d},null,8,["size","class","max","disabled","model-value","label"]),Ti("span",{class:l([Dt(n).e("classifier")])},f(Dt(t)("el.pagination.pageClassifier")),3)],10,HD))}});var YD=J_(WD,[["__file","/home/runner/work/element-plus/element-plus/packages/components/pagination/src/components/jumper.vue"]]);const $D=pg({total:{type:Number,default:1e3}}),XD=["disabled"],qD=Fn({name:"ElPaginationTotal"}),KD=Fn({...qD,props:$D,setup(e){const{t:t}=Jg(),n=rv("pagination"),{disabled:r}=BD();return(e,i)=>(fi(),yi("span",{class:l(Dt(n).e("total")),disabled:Dt(r)},f(Dt(t)("el.pagination.total",{total:e.total})),11,XD))}});var ZD=J_(KD,[["__file","/home/runner/work/element-plus/element-plus/packages/components/pagination/src/components/total.vue"]]);const JD=pg({currentPage:{type:Number,default:1},pageCount:{type:Number,required:!0},pagerCount:{type:Number,default:7},disabled:Boolean}),QD=["onKeyup"],eI=["aria-current","aria-label","tabindex"],tI=["tabindex","aria-label"],nI=["aria-current","aria-label","tabindex"],rI=["tabindex","aria-label"],iI=["aria-current","aria-label","tabindex"],aI=Fn({name:"ElPaginationPager"}),sI=Fn({...aI,props:JD,emits:["change"],setup(e,{emit:t}){const n=e,r=rv("pager"),i=rv("icon"),{t:a}=Jg(),s=At(!1),o=At(!1),u=At(!1),c=At(!1),d=At(!1),h=At(!1),p=Ki((()=>{const e=n.pagerCount,t=(e-1)/2,r=Number(n.currentPage),i=Number(n.pageCount);let a=!1,s=!1;i>e&&(r>e-t&&(a=!0),r<i-t&&(s=!0));const o=[];if(a&&!s){for(let t=i-(e-2);t<i;t++)o.push(t)}else if(!a&&s)for(let n=2;n<e;n++)o.push(n);else if(a&&s){const t=Math.floor(e/2)-1;for(let e=r-t;e<=r+t;e++)o.push(e)}else for(let n=2;n<i;n++)o.push(n);return o})),m=Ki((()=>n.disabled?-1:0));function g(e=!1){n.disabled||(e?u.value=!0:c.value=!0)}function v(e=!1){e?d.value=!0:h.value=!0}function y(e){const r=e.target;if("li"===r.tagName.toLowerCase()&&Array.from(r.classList).includes("number")){const e=Number(r.textContent);e!==n.currentPage&&t("change",e)}else"li"===r.tagName.toLowerCase()&&Array.from(r.classList).includes("more")&&_(e)}function _(e){const r=e.target;if("ul"===r.tagName.toLowerCase()||n.disabled)return;let i=Number(r.textContent);const a=n.pageCount,s=n.currentPage,o=n.pagerCount-2;r.className.includes("more")&&(r.className.includes("quickprev")?i=s-o:r.className.includes("quicknext")&&(i=s+o)),Number.isNaN(+i)||(i<1&&(i=1),i>a&&(i=a)),i!==s&&t("change",i)}return Cn((()=>{const e=(n.pagerCount-1)/2;s.value=!1,o.value=!1,n.pageCount>n.pagerCount&&(n.currentPage>n.pagerCount-e&&(s.value=!0),n.currentPage<n.pageCount-e&&(o.value=!0))})),(e,t)=>(fi(),yi("ul",{class:l(Dt(r).b()),onClick:_,onKeyup:rs(y,["enter"])},[e.pageCount>0?(fi(),yi("li",{key:0,class:l([[Dt(r).is("active",1===e.currentPage),Dt(r).is("disabled",e.disabled)],"number"]),"aria-current":1===e.currentPage,"aria-label":Dt(a)("el.pagination.currentPage",{pager:1}),tabindex:Dt(m)}," 1 ",10,eI)):Li("v-if",!0),s.value?(fi(),yi("li",{key:1,class:l(["more","btn-quickprev",Dt(i).b(),Dt(r).is("disabled",e.disabled)]),tabindex:Dt(m),"aria-label":Dt(a)("el.pagination.prevPages",{pager:e.pagerCount-2}),onMouseenter:t[0]||(t[0]=e=>g(!0)),onMouseleave:t[1]||(t[1]=e=>u.value=!1),onFocus:t[2]||(t[2]=e=>v(!0)),onBlur:t[3]||(t[3]=e=>d.value=!1)},[!u.value&&!d.value||e.disabled?(fi(),_i(Dt(Kf),{key:1})):(fi(),_i(Dt(ff),{key:0}))],42,tI)):Li("v-if",!0),(fi(!0),yi(li,null,mr(Dt(p),(t=>(fi(),yi("li",{key:t,class:l([[Dt(r).is("active",e.currentPage===t),Dt(r).is("disabled",e.disabled)],"number"]),"aria-current":e.currentPage===t,"aria-label":Dt(a)("el.pagination.currentPage",{pager:t}),tabindex:Dt(m)},f(t),11,nI)))),128)),o.value?(fi(),yi("li",{key:2,class:l(["more","btn-quicknext",Dt(i).b(),Dt(r).is("disabled",e.disabled)]),tabindex:Dt(m),"aria-label":Dt(a)("el.pagination.nextPages",{pager:e.pagerCount-2}),onMouseenter:t[4]||(t[4]=e=>g()),onMouseleave:t[5]||(t[5]=e=>c.value=!1),onFocus:t[6]||(t[6]=e=>v()),onBlur:t[7]||(t[7]=e=>h.value=!1)},[!c.value&&!h.value||e.disabled?(fi(),_i(Dt(Kf),{key:1})):(fi(),_i(Dt(yf),{key:0}))],42,rI)):Li("v-if",!0),e.pageCount>1?(fi(),yi("li",{key:3,class:l([[Dt(r).is("active",e.currentPage===e.pageCount),Dt(r).is("disabled",e.disabled)],"number"]),"aria-current":e.currentPage===e.pageCount,"aria-label":Dt(a)("el.pagination.currentPage",{pager:e.pageCount}),tabindex:Dt(m)},f(e.pageCount),11,iI)):Li("v-if",!0)],42,QD))}});var oI=J_(sI,[["__file","/home/runner/work/element-plus/element-plus/packages/components/pagination/src/components/pager.vue"]]);const lI=e=>"number"!=typeof e,uI=pg({total:Number,pageSize:Number,defaultPageSize:Number,currentPage:Number,defaultCurrentPage:Number,pageCount:Number,pagerCount:{type:Number,validator:e=>Bs(e)&&Math.trunc(e)===e&&e>4&&e<22&&e%2==1,default:7},layout:{type:String,default:["prev","pager","next","jumper","->","total"].join(", ")},pageSizes:{type:Array,default:()=>[10,20,30,40,50,100]},popperClass:{type:String,default:""},prevText:{type:String,default:""},prevIcon:{type:fg,default:()=>dp},nextText:{type:String,default:""},nextIcon:{type:fg,default:()=>mp},small:Boolean,background:Boolean,disabled:Boolean,hideOnSinglePage:Boolean}),cI="ElPagination";var dI=Fn({name:cI,props:uI,emits:{"update:current-page":e=>Bs(e),"update:page-size":e=>Bs(e),"size-change":e=>Bs(e),"current-change":e=>Bs(e),"prev-click":e=>Bs(e),"next-click":e=>Bs(e)},setup(e,{emit:t,slots:n}){const{t:r}=Jg(),i=rv("pagination"),a=Fi().vnode.props||{},s="onUpdate:currentPage"in a||"onUpdate:current-page"in a||"onCurrentChange"in a,o="onUpdate:pageSize"in a||"onUpdate:page-size"in a||"onSizeChange"in a,l=Ki((()=>{if(lI(e.total)&&lI(e.pageCount))return!1;if(!lI(e.currentPage)&&!s)return!1;if(e.layout.includes("sizes"))if(lI(e.pageCount)){if(!lI(e.total)&&!lI(e.pageSize)&&!o)return!1}else if(!o)return!1;return!0})),u=At(lI(e.defaultPageSize)?10:e.defaultPageSize),c=At(lI(e.defaultCurrentPage)?1:e.defaultCurrentPage),d=Ki({get:()=>lI(e.pageSize)?u.value:e.pageSize,set(n){lI(e.pageSize)&&(u.value=n),o&&(t("update:page-size",n),t("size-change",n))}}),h=Ki((()=>{let t=0;return lI(e.pageCount)?lI(e.total)||(t=Math.max(1,Math.ceil(e.total/d.value))):t=e.pageCount,t})),p=Ki({get:()=>lI(e.currentPage)?c.value:e.currentPage,set(n){let r=n;n<1?r=1:n>h.value&&(r=h.value),lI(e.currentPage)&&(c.value=r),s&&(t("update:current-page",r),t("current-change",r))}});function f(e){p.value=e}function m(){e.disabled||(p.value-=1,t("prev-click",p.value))}function g(){e.disabled||(p.value+=1,t("next-click",p.value))}function v(e,t){e&&(e.props||(e.props={}),e.props.class=[e.props.class,t].join(" "))}return Mn(h,(e=>{p.value>e&&(p.value=e)})),wn(oD,{pageCount:h,disabled:Ki((()=>e.disabled)),currentPage:p,changeEvent:f,handleSizeChange:function(e){d.value=e;const t=h.value;p.value>t&&(p.value=t)}}),()=>{var t,a;if(!l.value)return r("el.pagination.deprecationWarning"),null;if(!e.layout)return null;if(e.hideOnSinglePage&&h.value<=1)return null;const s=[],o=[],u=ea("div",{class:i.e("rightwrapper")},o),c={prev:ea(fD,{disabled:e.disabled,currentPage:p.value,prevText:e.prevText,prevIcon:e.prevIcon,onClick:m}),jumper:ea(YD,{size:e.small?"small":"default"}),pager:ea(oI,{currentPage:p.value,pageCount:h.value,pagerCount:e.pagerCount,onChange:f,disabled:e.disabled}),next:ea(bD,{disabled:e.disabled,currentPage:p.value,pageCount:h.value,nextText:e.nextText,nextIcon:e.nextIcon,onClick:g}),sizes:ea(VD,{pageSize:d.value,pageSizes:e.pageSizes,popperClass:e.popperClass,disabled:e.disabled,size:e.small?"small":"default"}),slot:null!=(a=null==(t=null==n?void 0:n.default)?void 0:t.call(n))?a:null,total:ea(ZD,{total:lI(e.total)?0:e.total})},y=e.layout.split(",").map((e=>e.trim()));let _=!1;return y.forEach((e=>{"->"!==e?_?o.push(c[e]):s.push(c[e]):_=!0})),v(s[0],i.is("first")),v(s[s.length-1],i.is("last")),_&&o.length>0&&(v(o[0],i.is("first")),v(o[o.length-1],i.is("last")),s.push(u)),ea("div",{class:[i.b(),i.is("background",e.background),{[i.m("small")]:e.small}]},s)}}});const hI=_g(dI),pI=pg({title:String,confirmButtonText:String,cancelButtonText:String,confirmButtonType:{type:String,values:mS,default:"primary"},cancelButtonType:{type:String,values:mS,default:"text"},icon:{type:fg,default:()=>hm},iconColor:{type:String,default:"#f90"},hideIcon:{type:Boolean,default:!1},hideAfter:{type:Number,default:200},teleported:_w.teleported,persistent:_w.persistent,width:{type:[String,Number],default:150}}),fI={confirm:e=>e instanceof MouseEvent,cancel:e=>e instanceof MouseEvent},mI=Fn({name:"ElPopconfirm"}),gI=Fn({...mI,props:pI,emits:fI,setup(e,{emit:t}){const n=e,{t:i}=Jg(),a=rv("popconfirm"),s=At(),o=()=>{var e,t;null==(t=null==(e=s.value)?void 0:e.onClose)||t.call(e)},u=Ki((()=>({width:Zh(n.width)}))),c=e=>{t("confirm",e),o()},d=e=>{t("cancel",e),o()},h=Ki((()=>n.confirmButtonText||i("el.popconfirm.confirmButtonText"))),p=Ki((()=>n.cancelButtonText||i("el.popconfirm.cancelButtonText")));return(e,t)=>(fi(),_i(Dt(Ow),Oi({ref_key:"tooltipRef",ref:s,trigger:"click",effect:"light"},e.$attrs,{"popper-class":`${Dt(a).namespace.value}-popover`,"popper-style":Dt(u),teleported:e.teleported,"fallback-placements":["bottom","top","right","left"],"hide-after":e.hideAfter,persistent:e.persistent}),{content:vn((()=>[Ti("div",{class:l(Dt(a).b())},[Ti("div",{class:l(Dt(a).e("main"))},[!e.hideIcon&&e.icon?(fi(),_i(Dt(ib),{key:0,class:l(Dt(a).e("icon")),style:r({color:e.iconColor})},{default:vn((()=>[(fi(),_i(dr(e.icon)))])),_:1},8,["class","style"])):Li("v-if",!0),Pi(" "+f(e.title),1)],2),Ti("div",{class:l(Dt(a).e("action"))},[Mi(Dt(jS),{size:"small",type:"text"===e.cancelButtonType?"":e.cancelButtonType,text:"text"===e.cancelButtonType,onClick:d},{default:vn((()=>[Pi(f(Dt(p)),1)])),_:1},8,["type","text"]),Mi(Dt(jS),{size:"small",type:"text"===e.confirmButtonType?"":e.confirmButtonType,text:"text"===e.confirmButtonType,onClick:c},{default:vn((()=>[Pi(f(Dt(h)),1)])),_:1},8,["type","text"])],2)],2)])),default:vn((()=>[e.$slots.reference?vr(e.$slots,"reference",{key:0}):Li("v-if",!0)])),_:3},16,["popper-class","popper-style","teleported","hide-after","persistent"]))}});const vI=_g(J_(gI,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popconfirm/src/popconfirm.vue"]])),yI=pg({trigger:bw.trigger,placement:cL.placement,disabled:bw.disabled,visible:_w.visible,transition:_w.transition,popperOptions:cL.popperOptions,tabindex:cL.tabindex,content:_w.content,popperStyle:_w.popperStyle,popperClass:_w.popperClass,enterable:{..._w.enterable,default:!0},effect:{..._w.effect,default:"light"},teleported:_w.teleported,title:String,width:{type:[String,Number],default:150},offset:{type:Number,default:void 0},showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0},showArrow:{type:Boolean,default:!0},persistent:{type:Boolean,default:!0},"onUpdate:visible":{type:Function}}),_I={"update:visible":e=>Ns(e),"before-enter":()=>!0,"before-leave":()=>!0,"after-enter":()=>!0,"after-leave":()=>!0},bI=Fn({name:"ElPopover"});var xI=J_(Fn({...bI,props:yI,emits:_I,setup(e,{expose:t,emit:n}){const r=e,i=Ki((()=>r["onUpdate:visible"])),a=rv("popover"),s=At(),o=Ki((()=>{var e;return null==(e=Dt(s))?void 0:e.popperRef})),u=Ki((()=>[{width:Zh(r.width)},r.popperStyle])),c=Ki((()=>[a.b(),r.popperClass,{[a.m("plain")]:!!r.content}])),d=Ki((()=>r.transition===`${a.namespace.value}-fade-in-linear`)),h=()=>{n("before-enter")},p=()=>{n("before-leave")},m=()=>{n("after-enter")},g=()=>{n("update:visible",!1),n("after-leave")};return t({popperRef:o,hide:()=>{var e;null==(e=s.value)||e.hide()}}),(e,t)=>(fi(),_i(Dt(Ow),Oi({ref_key:"tooltipRef",ref:s},e.$attrs,{trigger:e.trigger,placement:e.placement,disabled:e.disabled,visible:e.visible,transition:e.transition,"popper-options":e.popperOptions,tabindex:e.tabindex,content:e.content,offset:e.offset,"show-after":e.showAfter,"hide-after":e.hideAfter,"auto-close":e.autoClose,"show-arrow":e.showArrow,"aria-label":e.title,effect:e.effect,enterable:e.enterable,"popper-class":Dt(c),"popper-style":Dt(u),teleported:e.teleported,persistent:e.persistent,"gpu-acceleration":Dt(d),"onUpdate:visible":Dt(i),onBeforeShow:h,onBeforeHide:p,onShow:m,onHide:g}),{content:vn((()=>[e.title?(fi(),yi("div",{key:0,class:l(Dt(a).e("title")),role:"title"},f(e.title),3)):Li("v-if",!0),vr(e.$slots,"default",{},(()=>[Pi(f(e.content),1)]))])),default:vn((()=>[e.$slots.reference?vr(e.$slots,"reference",{key:0}):Li("v-if",!0)])),_:3},16,["trigger","placement","disabled","visible","transition","popper-options","tabindex","content","offset","show-after","hide-after","auto-close","show-arrow","aria-label","effect","enterable","popper-class","popper-style","teleported","persistent","gpu-acceleration","onUpdate:visible"]))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/popover/src/popover.vue"]]);const wI=(e,t)=>{const n=t.arg||t.value,r=null==n?void 0:n.popperRef;r&&(r.triggerRef=e)};const SI=(TI="popover",(CI={mounted(e,t){wI(e,t)},updated(e,t){wI(e,t)}}).install=e=>{e.directive(TI,CI)},CI);var CI,TI;const MI=_g(xI,{directive:SI}),EI=pg({type:{type:String,default:"line",values:["line","circle","dashboard"]},percentage:{type:Number,default:0,validator:e=>e>=0&&e<=100},status:{type:String,default:"",values:["","success","exception","warning"]},indeterminate:{type:Boolean,default:!1},duration:{type:Number,default:3},strokeWidth:{type:Number,default:6},strokeLinecap:{type:String,default:"round"},textInside:{type:Boolean,default:!1},width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:[String,Array,Function],default:""},format:{type:Function,default:e=>`${e}%`}}),AI=["aria-valuenow"],PI={viewBox:"0 0 100 100"},RI=["d","stroke","stroke-width"],LI=["d","stroke","opacity","stroke-linecap","stroke-width"],kI={key:0},DI=Fn({name:"ElProgress"});const II=_g(J_(Fn({...DI,props:EI,setup(e){const t=e,n={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},i=rv("progress"),a=Ki((()=>({width:`${t.percentage}%`,animationDuration:`${t.duration}s`,backgroundColor:b(t.percentage)}))),s=Ki((()=>(t.strokeWidth/t.width*100).toFixed(1))),o=Ki((()=>["circle","dashboard"].includes(t.type)?Number.parseInt(""+(50-Number.parseFloat(s.value)/2),10):0)),u=Ki((()=>{const e=o.value,n="dashboard"===t.type;return`\n          M 50 50\n          m 0 ${n?"":"-"}${e}\n          a ${e} ${e} 0 1 1 0 ${n?"-":""}${2*e}\n          a ${e} ${e} 0 1 1 0 ${n?"":"-"}${2*e}\n          `})),c=Ki((()=>2*Math.PI*o.value)),d=Ki((()=>"dashboard"===t.type?.75:1)),h=Ki((()=>`${-1*c.value*(1-d.value)/2}px`)),p=Ki((()=>({strokeDasharray:`${c.value*d.value}px, ${c.value}px`,strokeDashoffset:h.value}))),m=Ki((()=>({strokeDasharray:`${c.value*d.value*(t.percentage/100)}px, ${c.value}px`,strokeDashoffset:h.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"}))),g=Ki((()=>{let e;return e=t.color?b(t.percentage):n[t.status]||n.default,e})),v=Ki((()=>"warning"===t.status?ng:"line"===t.type?"success"===t.status?$p:tf:"success"===t.status?zp:cf)),y=Ki((()=>"line"===t.type?12+.4*t.strokeWidth:.111111*t.width+2)),_=Ki((()=>t.format(t.percentage)));const b=e=>{var n;const{color:r}=t;if(k(r))return r(e);if(D(r))return r;{const t=function(e){const t=100/e.length;return e.map(((e,n)=>D(e)?{color:e,percentage:(n+1)*t}:e)).sort(((e,t)=>e.percentage-t.percentage))}(r);for(const n of t)if(n.percentage>e)return n.color;return null==(n=t[t.length-1])?void 0:n.color}};return(e,t)=>(fi(),yi("div",{class:l([Dt(i).b(),Dt(i).m(e.type),Dt(i).is(e.status),{[Dt(i).m("without-text")]:!e.showText,[Dt(i).m("text-inside")]:e.textInside}]),role:"progressbar","aria-valuenow":e.percentage,"aria-valuemin":"0","aria-valuemax":"100"},["line"===e.type?(fi(),yi("div",{key:0,class:l(Dt(i).b("bar"))},[Ti("div",{class:l(Dt(i).be("bar","outer")),style:r({height:`${e.strokeWidth}px`})},[Ti("div",{class:l([Dt(i).be("bar","inner"),{[Dt(i).bem("bar","inner","indeterminate")]:e.indeterminate}]),style:r(Dt(a))},[(e.showText||e.$slots.default)&&e.textInside?(fi(),yi("div",{key:0,class:l(Dt(i).be("bar","innerText"))},[vr(e.$slots,"default",{percentage:e.percentage},(()=>[Ti("span",null,f(Dt(_)),1)]))],2)):Li("v-if",!0)],6)],6)],2)):(fi(),yi("div",{key:1,class:l(Dt(i).b("circle")),style:r({height:`${e.width}px`,width:`${e.width}px`})},[(fi(),yi("svg",PI,[Ti("path",{class:l(Dt(i).be("circle","track")),d:Dt(u),stroke:`var(${Dt(i).cssVarName("fill-color-light")}, #e5e9f2)`,"stroke-width":Dt(s),fill:"none",style:r(Dt(p))},null,14,RI),Ti("path",{class:l(Dt(i).be("circle","path")),d:Dt(u),stroke:Dt(g),fill:"none",opacity:e.percentage?1:0,"stroke-linecap":e.strokeLinecap,"stroke-width":Dt(s),style:r(Dt(m))},null,14,LI)]))],6)),!e.showText&&!e.$slots.default||e.textInside?Li("v-if",!0):(fi(),yi("div",{key:2,class:l(Dt(i).e("text")),style:r({fontSize:`${Dt(y)}px`})},[vr(e.$slots,"default",{percentage:e.percentage},(()=>[e.status?(fi(),_i(Dt(ib),{key:1},{default:vn((()=>[(fi(),_i(dr(Dt(v))))])),_:1})):(fi(),yi("span",kI,f(Dt(_)),1))]))],6))],10,AI))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/progress/src/progress.vue"]])),OI=pg({modelValue:{type:Number,default:0},id:{type:String,default:void 0},lowThreshold:{type:Number,default:2},highThreshold:{type:Number,default:4},max:{type:Number,default:5},colors:{type:[Array,Object],default:()=>["","",""]},voidColor:{type:String,default:""},disabledVoidColor:{type:String,default:""},icons:{type:[Array,Object],default:()=>[Fm,Fm,Fm]},voidIcon:{type:fg,default:()=>jm},disabledVoidIcon:{type:fg,default:()=>Fm},disabled:Boolean,allowHalf:Boolean,showText:Boolean,showScore:Boolean,textColor:{type:String,default:""},texts:{type:Array,default:()=>["Extremely bad","Disappointed","Fair","Satisfied","Surprise"]},scoreTemplate:{type:String,default:"{value}"},size:z_,label:{type:String,default:void 0},clearable:{type:Boolean,default:!1}}),NI={[Mg]:e=>Bs(e),[Tg]:e=>Bs(e)},BI=["id","aria-label","aria-labelledby","aria-valuenow","aria-valuetext","aria-valuemax"],UI=["onMousemove","onClick"],zI=Fn({name:"ElRate"}),FI=Fn({...zI,props:OI,emits:NI,setup(e,{expose:t,emit:n}){const i=e;function a(e,t){const n=e=>O(e),r=Object.keys(t).map((e=>+e)).filter((r=>{const i=t[r];return!!n(i)&&i.excluded?e<r:e<=r})).sort(((e,t)=>e-t)),i=t[r[0]];return n(i)&&i.value||i}const s=Sn(ub,void 0),o=Sn(cb,void 0),u=db(),c=rv("rate"),{inputId:d,isLabeledByFormItem:h}=fb(i,{formItemContext:o}),p=At(i.modelValue),m=At(-1),g=At(!0),v=Ki((()=>[c.b(),c.m(u.value)])),y=Ki((()=>i.disabled||(null==s?void 0:s.disabled))),_=Ki((()=>c.cssVarBlock({"void-color":i.voidColor,"disabled-void-color":i.disabledVoidColor,"fill-color":S.value}))),b=Ki((()=>{let e="";return i.showScore?e=i.scoreTemplate.replace(/\{\s*value\s*\}/,y.value?`${i.modelValue}`:`${p.value}`):i.showText&&(e=i.texts[Math.ceil(p.value)-1]),e})),x=Ki((()=>100*i.modelValue-100*Math.floor(i.modelValue))),w=Ki((()=>E(i.colors)?{[i.lowThreshold]:i.colors[0],[i.highThreshold]:{value:i.colors[1],excluded:!0},[i.max]:i.colors[2]}:i.colors)),S=Ki((()=>{const e=a(p.value,w.value);return O(e)?"":e})),C=Ki((()=>{let e="";return y.value?e=`${x.value}%`:i.allowHalf&&(e="50%"),{color:S.value,width:e}})),T=Ki((()=>{let e=E(i.icons)?[...i.icons]:{...i.icons};return e=wt(e),E(e)?{[i.lowThreshold]:e[0],[i.highThreshold]:{value:e[1],excluded:!0},[i.max]:e[2]}:e})),M=Ki((()=>a(i.modelValue,T.value))),A=Ki((()=>y.value?D(i.disabledVoidIcon)?i.disabledVoidIcon:wt(i.disabledVoidIcon):D(i.voidIcon)?i.voidIcon:wt(i.voidIcon))),P=Ki((()=>a(p.value,T.value)));function R(e){const t=y.value&&x.value>0&&e-1<i.modelValue&&e>i.modelValue,n=i.allowHalf&&g.value&&e-.5<=p.value&&e>p.value;return t||n}function L(e){i.clearable&&e===i.modelValue&&(e=0),n(Tg,e),i.modelValue!==e&&n("change",e)}function k(e){if(y.value)return;let t=p.value;const r=e.code;return r===Sg.up||r===Sg.right?(i.allowHalf?t+=.5:t+=1,e.stopPropagation(),e.preventDefault()):r!==Sg.left&&r!==Sg.down||(i.allowHalf?t-=.5:t-=1,e.stopPropagation(),e.preventDefault()),t=t<0?0:t,t=t>i.max?i.max:t,n(Tg,t),n("change",t),t}function I(e,t){if(!y.value){if(i.allowHalf&&t){let n=t.target;$h(n,c.e("item"))&&(n=n.querySelector(`.${c.e("icon")}`)),(0===n.clientWidth||$h(n,c.e("decimal")))&&(n=n.parentNode),g.value=2*t.offsetX<=n.clientWidth,p.value=g.value?e-.5:e}else p.value=e;m.value=e}}function N(){y.value||(i.allowHalf&&(g.value=i.modelValue!==Math.floor(i.modelValue)),p.value=i.modelValue,m.value=-1)}return Mn((()=>i.modelValue),(e=>{p.value=e,g.value=i.modelValue!==Math.floor(i.modelValue)})),i.modelValue||n(Tg,0),t({setCurrentValue:I,resetCurrentValue:N}),(e,t)=>{var n;return fi(),yi("div",{id:Dt(d),class:l([Dt(v),Dt(c).is("disabled",Dt(y))]),role:"slider","aria-label":Dt(h)?void 0:e.label||"rating","aria-labelledby":Dt(h)?null==(n=Dt(o))?void 0:n.labelId:void 0,"aria-valuenow":p.value,"aria-valuetext":Dt(b)||void 0,"aria-valuemin":"0","aria-valuemax":e.max,tabindex:"0",style:r(Dt(_)),onKeydown:k},[(fi(!0),yi(li,null,mr(e.max,((e,t)=>(fi(),yi("span",{key:t,class:l(Dt(c).e("item")),onMousemove:t=>I(e,t),onMouseleave:N,onClick:t=>{return n=e,void(y.value||(i.allowHalf&&g.value?L(p.value):L(n)));var n}},[Mi(Dt(ib),{class:l([Dt(c).e("icon"),{hover:m.value===e},Dt(c).is("active",e<=p.value)])},{default:vn((()=>[R(e)?Li("v-if",!0):(fi(),yi(li,{key:0},[ar((fi(),_i(dr(Dt(P)),null,null,512)),[[is,e<=p.value]]),ar((fi(),_i(dr(Dt(A)),null,null,512)),[[is,!(e<=p.value)]])],64)),R(e)?(fi(),_i(Dt(ib),{key:1,style:r(Dt(C)),class:l([Dt(c).e("icon"),Dt(c).e("decimal")])},{default:vn((()=>[(fi(),_i(dr(Dt(M))))])),_:1},8,["style","class"])):Li("v-if",!0)])),_:2},1032,["class"])],42,UI)))),128)),e.showText||e.showScore?(fi(),yi("span",{key:0,class:l(Dt(c).e("text"))},f(Dt(b)),3)):Li("v-if",!0)],46,BI)}}});const VI=_g(J_(FI,[["__file","/home/runner/work/element-plus/element-plus/packages/components/rate/src/rate.vue"]])),GI={success:"icon-success",warning:"icon-warning",error:"icon-error",info:"icon-info"},HI={[GI.success]:Hp,[GI.warning]:ng,[GI.error]:Zp,[GI.info]:Uf},jI=pg({title:{type:String,default:""},subTitle:{type:String,default:""},icon:{type:String,values:["success","warning","info","error"],default:"info"}}),WI=Fn({name:"ElResult"});const YI=_g(J_(Fn({...WI,props:jI,setup(e){const t=e,n=rv("result"),r=Ki((()=>{const e=t.icon,n=e&&GI[e]?GI[e]:"icon-info";return{class:n,component:HI[n]||HI["icon-info"]}}));return(e,t)=>(fi(),yi("div",{class:l(Dt(n).b())},[Ti("div",{class:l(Dt(n).e("icon"))},[vr(e.$slots,"icon",{},(()=>[Dt(r).component?(fi(),_i(dr(Dt(r).component),{key:0,class:l(Dt(r).class)},null,8,["class"])):Li("v-if",!0)]))],2),e.title||e.$slots.title?(fi(),yi("div",{key:0,class:l(Dt(n).e("title"))},[vr(e.$slots,"title",{},(()=>[Ti("p",null,f(e.title),1)]))],2)):Li("v-if",!0),e.subTitle||e.$slots["sub-title"]?(fi(),yi("div",{key:1,class:l(Dt(n).e("subtitle"))},[vr(e.$slots,"sub-title",{},(()=>[Ti("p",null,f(e.subTitle),1)]))],2)):Li("v-if",!0),e.$slots.extra?(fi(),yi("div",{key:2,class:l(Dt(n).e("extra"))},[vr(e.$slots,"extra")],2)):Li("v-if",!0)],2))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/result/src/result.vue"]]));var $I=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function XI(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(r=e[n],i=t[n],!(r===i||$I(r)&&$I(i)))return!1;var r,i;return!0}const qI=()=>{const e=Fi().proxy.$props;return Ki((()=>{const t=(e,t,n)=>({});return e.perfMode?ku(t):function(e,t){void 0===t&&(t=XI);var n=null;function r(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(n&&n.lastThis===this&&t(r,n.lastArgs))return n.lastResult;var a=e.apply(this,r);return n={lastResult:a,lastArgs:r,lastThis:this},a}return r.clear=function(){n=null},r}(t)}))},KI="itemRendered",ZI="scroll",JI="forward",QI="backward",eO="auto",tO="smart",nO="start",rO="center",iO="end",aO="horizontal",sO="vertical",oO="rtl",lO="negative",uO="positive-ascending",cO="positive-descending",dO={[aO]:"left",[sO]:"top"},hO={[aO]:"deltaX",[sO]:"deltaY"},pO=hg({type:[Number,Function],required:!0}),fO=hg({type:Number}),mO=hg({type:Number,default:2}),gO=hg({type:String,values:["ltr","rtl"],default:"ltr"}),vO=hg({type:Number,default:0}),yO=hg({type:Number,required:!0}),_O=hg({type:String,values:["horizontal","vertical"],default:sO}),bO=pg({className:{type:String,default:""},containerElement:{type:[String,Object],default:"div"},data:{type:Array,default:()=>[]},direction:gO,height:{type:[String,Number],required:!0},innerElement:{type:[String,Object],default:"div"},style:{type:[Object,String,Array]},useIsScrolling:{type:Boolean,default:!1},width:{type:[Number,String],required:!1},perfMode:{type:Boolean,default:!0},scrollbarAlwaysOn:{type:Boolean,default:!1}}),xO=pg({cache:mO,estimatedItemSize:fO,layout:_O,initScrollOffset:vO,total:yO,itemSize:pO,...bO}),wO={type:Number,default:6},SO={type:Number,default:0},CO={type:Number,default:2},TO=pg({columnCache:mO,columnWidth:pO,estimatedColumnWidth:fO,estimatedRowHeight:fO,initScrollLeft:vO,initScrollTop:vO,itemKey:{type:Function,default:({columnIndex:e,rowIndex:t})=>`${t}:${e}`},rowCache:mO,rowHeight:pO,totalColumn:yO,totalRow:yO,hScrollbarSize:wO,vScrollbarSize:wO,scrollbarStartGap:SO,scrollbarEndGap:CO,role:String,...bO}),MO=pg({alwaysOn:Boolean,class:String,layout:_O,total:yO,ratio:{type:Number,required:!0},clientSize:{type:Number,required:!0},scrollFrom:{type:Number,required:!0},scrollbarSize:wO,startGap:SO,endGap:CO,visible:Boolean}),EO=(e,t)=>e<t?JI:QI,AO=e=>"ltr"===e||e===oO||e===aO,PO=e=>e===oO;let RO=null;function LO(e=!1){if(null===RO||e){const e=document.createElement("div"),t=e.style;t.width="50px",t.height="50px",t.overflow="scroll",t.direction="rtl";const n=document.createElement("div"),r=n.style;return r.width="100px",r.height="100px",e.appendChild(n),document.body.appendChild(e),e.scrollLeft>0?RO=cO:(e.scrollLeft=1,RO=0===e.scrollLeft?lO:uO),document.body.removeChild(e),RO}return RO}const kO=Fn({name:"ElVirtualScrollBar",props:MO,emits:["scroll","start-move","stop-move"],setup(e,{emit:t}){const n=Ki((()=>e.startGap+e.endGap)),r=rv("virtual-scrollbar"),i=rv("scrollbar"),a=At(),s=At();let o=null,l=null;const u=pt({isDragging:!1,traveled:0}),c=Ki((()=>gx[e.layout])),d=Ki((()=>e.clientSize-Dt(n))),h=Ki((()=>({position:"absolute",width:`${aO===e.layout?d.value:e.scrollbarSize}px`,height:`${aO===e.layout?e.scrollbarSize:d.value}px`,[dO[e.layout]]:"2px",right:"2px",bottom:"2px",borderRadius:"4px"}))),p=Ki((()=>{const t=e.ratio,n=e.clientSize;if(t>=100)return Number.POSITIVE_INFINITY;if(t>=50)return t*n/100;const r=n/3;return Math.floor(Math.min(Math.max(t*n,20),r))})),f=Ki((()=>{if(!Number.isFinite(p.value))return{display:"none"};const t=`${p.value}px`,n=function({move:e,size:t,bar:n},r){const i={},a=`translate${n.axis}(${e}px)`;return i[n.size]=t,i.transform=a,i.msTransform=a,i.webkitTransform=a,"horizontal"===r?i.height="100%":i.width="100%",i}({bar:c.value,size:t,move:u.traveled},e.layout);return n})),m=Ki((()=>Math.floor(e.clientSize-p.value-Dt(n)))),g=()=>{window.removeEventListener("mousemove",_),window.removeEventListener("mouseup",y),document.onselectstart=l,l=null;const e=Dt(s);e&&(e.removeEventListener("touchmove",_),e.removeEventListener("touchend",y))},v=e=>{e.stopImmediatePropagation(),e.ctrlKey||[1,2].includes(e.button)||(u.isDragging=!0,u[c.value.axis]=e.currentTarget[c.value.offset]-(e[c.value.client]-e.currentTarget.getBoundingClientRect()[c.value.direction]),t("start-move"),(()=>{window.addEventListener("mousemove",_),window.addEventListener("mouseup",y);const e=Dt(s);e&&(l=document.onselectstart,document.onselectstart=()=>!1,e.addEventListener("touchmove",_),e.addEventListener("touchend",y))})())},y=()=>{u.isDragging=!1,u[c.value.axis]=0,t("stop-move"),g()},_=n=>{const{isDragging:r}=u;if(!r)return;if(!s.value||!a.value)return;const i=u[c.value.axis];if(!i)return;Vg(o);const l=-1*(a.value.getBoundingClientRect()[c.value.direction]-n[c.value.client])-(s.value[c.value.offset]-i);o=Fg((()=>{u.traveled=Math.max(e.startGap,Math.min(l,m.value)),t("scroll",l,m.value)}))},b=e=>{const n=Math.abs(e.target.getBoundingClientRect()[c.value.direction]-e[c.value.client])-s.value[c.value.offset]/2;u.traveled=Math.max(0,Math.min(n,m.value)),t("scroll",n,m.value)};return Mn((()=>e.scrollFrom),(e=>{u.isDragging||(u.traveled=Math.ceil(e*m.value))})),Qn((()=>{g()})),()=>ea("div",{role:"presentation",ref:a,class:[r.b(),e.class,(e.alwaysOn||u.isDragging)&&"always-on"],style:h.value,onMousedown:ts(b,["stop","prevent"]),onTouchstartPrevent:v},ea("div",{ref:s,class:i.e("thumb"),style:f.value,onMousedown:v},[]))}}),DO=({name:e,getOffset:t,getItemSize:n,getItemOffset:r,getEstimatedTotalSize:i,getStartIndexForOffset:a,getStopIndexForStartIndex:s,initCache:o,clearCache:l,validateProps:u})=>Fn({name:null!=e?e:"ElVirtualList",props:xO,emits:[KI,ZI],setup(e,{emit:c,expose:d}){u(e);const h=Fi(),p=rv("vl"),f=At(o(e,h)),m=qI(),g=At(),v=At(),y=At(),_=At({isScrolling:!1,scrollDir:"forward",scrollOffset:Bs(e.initScrollOffset)?e.initScrollOffset:0,updateRequested:!1,isScrollbarDragging:!1,scrollbarAlwaysOn:e.scrollbarAlwaysOn}),b=Ki((()=>{const{total:t,cache:n}=e,{isScrolling:r,scrollDir:i,scrollOffset:o}=Dt(_);if(0===t)return[0,0,0,0];const l=a(e,o,Dt(f)),u=s(e,l,o,Dt(f)),c=r&&i!==QI?1:Math.max(1,n),d=r&&i!==JI?1:Math.max(1,n);return[Math.max(0,l-c),Math.max(0,Math.min(t-1,u+d)),l,u]})),x=Ki((()=>i(e,Dt(f)))),w=Ki((()=>AO(e.layout))),S=Ki((()=>[{position:"relative",["overflow-"+(w.value?"x":"y")]:"scroll",WebkitOverflowScrolling:"touch",willChange:"transform"},{direction:e.direction,height:Bs(e.height)?`${e.height}px`:e.height,width:Bs(e.width)?`${e.width}px`:e.width},e.style])),C=Ki((()=>{const e=Dt(x),t=Dt(w);return{height:t?"100%":`${e}px`,pointerEvents:Dt(_).isScrolling?"none":void 0,width:t?`${e}px`:"100%"}})),T=Ki((()=>w.value?e.width:e.height)),{onWheel:E}=(({atEndEdge:e,atStartEdge:t,layout:n},r)=>{let i,a=0;const s=n=>n<0&&t.value||n>0&&e.value;return{hasReachedEdge:s,onWheel:e=>{Vg(i);const t=e[hO[n.value]];s(a)&&s(a+t)||(a+=t,Ug()||e.preventDefault(),i=Fg((()=>{r(a),a=0})))}}})({atStartEdge:Ki((()=>_.value.scrollOffset<=0)),atEndEdge:Ki((()=>_.value.scrollOffset>=x.value)),layout:Ki((()=>e.layout))},(e=>{var t,n;null==(n=(t=y.value).onMouseUp)||n.call(t),P(Math.min(_.value.scrollOffset+e,x.value-T.value))})),A=()=>{const{total:t}=e;if(t>0){const[e,t,n,r]=Dt(b);c(KI,e,t,n,r)}const{scrollDir:n,scrollOffset:r,updateRequested:i}=Dt(_);c(ZI,n,r,i)},P=e=>{(e=Math.max(e,0))!==Dt(_).scrollOffset&&(_.value={...Dt(_),scrollOffset:e,scrollDir:EO(Dt(_).scrollOffset,e),updateRequested:!0},en(L))},R=(n,r=eO)=>{const{scrollOffset:i}=Dt(_);n=Math.max(0,Math.min(n,e.total-1)),P(t(e,n,r,i,Dt(f)))},L=()=>{_.value.isScrolling=!1,en((()=>{m.value(-1,null,null)}))},k=()=>{const e=g.value;e&&(e.scrollTop=0)};Kn((()=>{if(!Os)return;const{initScrollOffset:t}=e,n=Dt(g);Bs(t)&&n&&(Dt(w)?n.scrollLeft=t:n.scrollTop=t),A()})),Jn((()=>{const{direction:t,layout:n}=e,{scrollOffset:r,updateRequested:i}=Dt(_),a=Dt(g);if(i&&a)if(n===aO)if(t===oO)switch(LO()){case lO:a.scrollLeft=-r;break;case uO:a.scrollLeft=r;break;default:{const{clientWidth:e,scrollWidth:t}=a;a.scrollLeft=t-e-r;break}}else a.scrollLeft=r;else a.scrollTop=r}));const D={ns:p,clientSize:T,estimatedTotalSize:x,windowStyle:S,windowRef:g,innerRef:v,innerStyle:C,itemsToRender:b,scrollbarRef:y,states:_,getItemStyle:t=>{const{direction:i,itemSize:a,layout:s}=e,o=m.value(l&&a,l&&s,l&&i);let u;if(M(o,String(t)))u=o[t];else{const a=r(e,t,Dt(f)),s=n(e,t,Dt(f)),l=Dt(w),c=i===oO,d=l?a:0;o[t]=u={position:"absolute",left:c?void 0:`${d}px`,right:c?`${d}px`:void 0,top:l?0:`${a}px`,height:l?"100%":`${s}px`,width:l?`${s}px`:"100%"}}return u},onScroll:t=>{Dt(w)?(t=>{const{clientWidth:n,scrollLeft:r,scrollWidth:i}=t.currentTarget,a=Dt(_);if(a.scrollOffset===r)return;const{direction:s}=e;let o=r;if(s===oO)switch(LO()){case lO:o=-r;break;case cO:o=i-n-r}o=Math.max(0,Math.min(o,i-n)),_.value={...a,isScrolling:!0,scrollDir:EO(a.scrollOffset,o),scrollOffset:o,updateRequested:!1},en(L)})(t):(e=>{const{clientHeight:t,scrollHeight:n,scrollTop:r}=e.currentTarget,i=Dt(_);if(i.scrollOffset===r)return;const a=Math.max(0,Math.min(r,n-t));_.value={...i,isScrolling:!0,scrollDir:EO(i.scrollOffset,a),scrollOffset:a,updateRequested:!1},en(L)})(t),A()},onScrollbarScroll:(e,t)=>{const n=(x.value-T.value)/t*e;P(Math.min(x.value-T.value,n))},onWheel:E,scrollTo:P,scrollToItem:R,resetScrollTop:k};return d({windowRef:g,innerRef:v,getItemStyleCache:m,scrollTo:P,scrollToItem:R,resetScrollTop:k,states:_}),D},render(e){var t;const{$slots:n,className:r,clientSize:i,containerElement:a,data:s,getItemStyle:o,innerElement:l,itemsToRender:u,innerStyle:c,layout:d,total:h,onScroll:p,onScrollbarScroll:f,onWheel:m,states:g,useIsScrolling:v,windowStyle:y,ns:_}=e,[b,x]=u,w=dr(a),S=dr(l),C=[];if(h>0)for(let A=b;A<=x;A++)C.push(null==(t=n.default)?void 0:t.call(n,{data:s,key:A,index:A,isScrolling:v?g.isScrolling:void 0,style:o(A)}));const T=[ea(S,{style:c,ref:"innerRef"},D(S)?C:{default:()=>C})],M=ea(kO,{ref:"scrollbarRef",clientSize:i,layout:d,onScroll:f,ratio:100*i/this.estimatedTotalSize,scrollFrom:g.scrollOffset/(this.estimatedTotalSize-i),total:h}),E=ea(w,{class:[_.e("window"),r],style:y,onScroll:p,onWheel:m,ref:"windowRef",key:0},D(w)?[T]:{default:()=>[T]});return ea("div",{key:0,class:[_.e("wrapper"),g.scrollbarAlwaysOn?"always-on":""]},[E,M])}}),IO=DO({name:"ElFixedSizeList",getItemOffset:({itemSize:e},t)=>t*e,getItemSize:({itemSize:e})=>e,getEstimatedTotalSize:({total:e,itemSize:t})=>t*e,getOffset:({height:e,total:t,itemSize:n,layout:r,width:i},a,s,o)=>{const l=AO(r)?i:e,u=Math.max(0,t*n-l),c=Math.min(u,a*n),d=Math.max(0,(a+1)*n-l);switch(s===tO&&(s=o>=d-l&&o<=c+l?eO:rO),s){case nO:return c;case iO:return d;case rO:{const e=Math.round(d+(c-d)/2);return e<Math.ceil(l/2)?0:e>u+Math.floor(l/2)?u:e}default:return o>=d&&o<=c?o:o<d?d:c}},getStartIndexForOffset:({total:e,itemSize:t},n)=>Math.max(0,Math.min(e-1,Math.floor(n/t))),getStopIndexForStartIndex:({height:e,total:t,itemSize:n,layout:r,width:i},a,s)=>{const o=a*n,l=AO(r)?i:e,u=Math.ceil((l+s-o)/n);return Math.max(0,Math.min(t-1,a+u-1))},initCache(){},clearCache:!0,validateProps(){}}),OO=(e,t,n)=>{const{itemSize:r}=e,{items:i,lastVisitedIndex:a}=n;if(t>a){let e=0;if(a>=0){const t=i[a];e=t.offset+t.size}for(let n=a+1;n<=t;n++){const t=r(n);i[n]={offset:e,size:t},e+=t}n.lastVisitedIndex=t}return i[t]},NO=(e,t,n,r,i)=>{for(;n<=r;){const a=n+Math.floor((r-n)/2),s=OO(e,a,t).offset;if(s===i)return a;s<i?n=a+1:s>i&&(r=a-1)}return Math.max(0,n-1)},BO=(e,t,n,r)=>{const{total:i}=e;let a=1;for(;n<i&&OO(e,n,t).offset<r;)n+=a,a*=2;return NO(e,t,Math.floor(n/2),Math.min(n,i-1),r)},UO=({total:e},{items:t,estimatedItemSize:n,lastVisitedIndex:r})=>{let i=0;if(r>=e&&(r=e-1),r>=0){const e=t[r];i=e.offset+e.size}return i+(e-r-1)*n},zO=DO({name:"ElDynamicSizeList",getItemOffset:(e,t,n)=>OO(e,t,n).offset,getItemSize:(e,t,{items:n})=>n[t].size,getEstimatedTotalSize:UO,getOffset:(e,t,n,r,i)=>{const{height:a,layout:s,width:o}=e,l=AO(s)?o:a,u=OO(e,t,i),c=UO(e,i),d=Math.max(0,Math.min(c-l,u.offset)),h=Math.max(0,u.offset-l+u.size);switch(n===tO&&(n=r>=h-l&&r<=d+l?eO:rO),n){case nO:return d;case iO:return h;case rO:return Math.round(h+(d-h)/2);default:return r>=h&&r<=d?r:r<h?h:d}},getStartIndexForOffset:(e,t,n)=>((e,t,n)=>{const{items:r,lastVisitedIndex:i}=t;return(i>0?r[i].offset:0)>=n?NO(e,t,0,i,n):BO(e,t,Math.max(0,i),n)})(e,n,t),getStopIndexForStartIndex:(e,t,n,r)=>{const{height:i,total:a,layout:s,width:o}=e,l=AO(s)?o:i,u=OO(e,t,r),c=n+l;let d=u.offset+u.size,h=t;for(;h<a-1&&d<c;)h++,d+=OO(e,h,r).size;return h},initCache({estimatedItemSize:e=50},t){const n={items:{},estimatedItemSize:e,lastVisitedIndex:-1,clearCacheAfterIndex:(e,r=!0)=>{var i,a;n.lastVisitedIndex=Math.min(n.lastVisitedIndex,e-1),null==(i=t.exposed)||i.getItemStyleCache(-1),r&&(null==(a=t.proxy)||a.$forceUpdate())}};return n},clearCache:!1,validateProps:({itemSize:e})=>{}}),FO=({name:e,clearCache:t,getColumnPosition:n,getColumnStartIndexForOffset:r,getColumnStopIndexForStartIndex:i,getEstimatedTotalHeight:a,getEstimatedTotalWidth:s,getColumnOffset:o,getRowOffset:l,getRowPosition:u,getRowStartIndexForOffset:c,getRowStopIndexForStartIndex:d,initCache:h,injectToInstance:p,validateProps:f})=>Fn({name:null!=e?e:"ElVirtualList",props:TO,emits:[KI,ZI],setup(e,{emit:m,expose:g,slots:v}){const y=rv("vl");f(e);const _=Fi(),b=At(h(e,_));null==p||p(_,b);const x=At(),w=At(),S=At(),C=At(null),T=At({isScrolling:!1,scrollLeft:Bs(e.initScrollLeft)?e.initScrollLeft:0,scrollTop:Bs(e.initScrollTop)?e.initScrollTop:0,updateRequested:!1,xAxisScrollDir:JI,yAxisScrollDir:JI}),E=qI(),A=Ki((()=>Number.parseInt(`${e.height}`,10))),P=Ki((()=>Number.parseInt(`${e.width}`,10))),R=Ki((()=>{const{totalColumn:t,totalRow:n,columnCache:a}=e,{isScrolling:s,xAxisScrollDir:o,scrollLeft:l}=Dt(T);if(0===t||0===n)return[0,0,0,0];const u=r(e,l,Dt(b)),c=i(e,u,l,Dt(b)),d=s&&o!==QI?1:Math.max(1,a),h=s&&o!==JI?1:Math.max(1,a);return[Math.max(0,u-d),Math.max(0,Math.min(t-1,c+h)),u,c]})),L=Ki((()=>{const{totalColumn:t,totalRow:n,rowCache:r}=e,{isScrolling:i,yAxisScrollDir:a,scrollTop:s}=Dt(T);if(0===t||0===n)return[0,0,0,0];const o=c(e,s,Dt(b)),l=d(e,o,s,Dt(b)),u=i&&a!==QI?1:Math.max(1,r),h=i&&a!==JI?1:Math.max(1,r);return[Math.max(0,o-u),Math.max(0,Math.min(n-1,l+h)),o,l]})),k=Ki((()=>a(e,Dt(b)))),I=Ki((()=>s(e,Dt(b)))),O=Ki((()=>{var t;return[{position:"relative",overflow:"hidden",WebkitOverflowScrolling:"touch",willChange:"transform"},{direction:e.direction,height:Bs(e.height)?`${e.height}px`:e.height,width:Bs(e.width)?`${e.width}px`:e.width},null!=(t=e.style)?t:{}]})),N=Ki((()=>{const e=`${Dt(I)}px`;return{height:`${Dt(k)}px`,pointerEvents:Dt(T).isScrolling?"none":void 0,width:e}})),B=()=>{const{totalColumn:t,totalRow:n}=e;if(t>0&&n>0){const[e,t,n,r]=Dt(R),[i,a,s,o]=Dt(L);m(KI,{columnCacheStart:e,columnCacheEnd:t,rowCacheStart:i,rowCacheEnd:a,columnVisibleStart:n,columnVisibleEnd:r,rowVisibleStart:s,rowVisibleEnd:o})}const{scrollLeft:r,scrollTop:i,updateRequested:a,xAxisScrollDir:s,yAxisScrollDir:o}=Dt(T);m(ZI,{xAxisScrollDir:s,scrollLeft:r,yAxisScrollDir:o,scrollTop:i,updateRequested:a})},U=t=>{const{clientHeight:n,clientWidth:r,scrollHeight:i,scrollLeft:a,scrollTop:s,scrollWidth:o}=t.currentTarget,l=Dt(T);if(l.scrollTop===s&&l.scrollLeft===a)return;let u=a;if(PO(e.direction))switch(LO()){case lO:u=-a;break;case cO:u=o-r-a}T.value={...l,isScrolling:!0,scrollLeft:u,scrollTop:Math.max(0,Math.min(s,i-n)),updateRequested:!0,xAxisScrollDir:EO(l.scrollLeft,u),yAxisScrollDir:EO(l.scrollTop,s)},en((()=>j())),W(),B()},z=(e,t)=>{const n=Dt(A),r=(k.value-n)/t*e;G({scrollTop:Math.min(k.value-n,r)})},F=(e,t)=>{const n=Dt(P),r=(I.value-n)/t*e;G({scrollLeft:Math.min(I.value-n,r)})},{onWheel:V}=(({atXEndEdge:e,atXStartEdge:t,atYEndEdge:n,atYStartEdge:r},i)=>{let a=null,s=0,o=0;const l=(i,a)=>{const s=i<=0&&t.value||i>=0&&e.value,o=a<=0&&r.value||a>=0&&n.value;return s&&o};return{hasReachedEdge:l,onWheel:e=>{Vg(a);let t=e.deltaX,n=e.deltaY;Math.abs(t)>Math.abs(n)?n=0:t=0,e.shiftKey&&0!==n&&(t=n,n=0),l(s,o)&&l(s+t,o+n)||(s+=t,o+=n,e.preventDefault(),a=Fg((()=>{i(s,o),s=0,o=0})))}}})({atXStartEdge:Ki((()=>T.value.scrollLeft<=0)),atXEndEdge:Ki((()=>T.value.scrollLeft>=I.value-Dt(P))),atYStartEdge:Ki((()=>T.value.scrollTop<=0)),atYEndEdge:Ki((()=>T.value.scrollTop>=k.value-Dt(A)))},((e,t)=>{var n,r,i,a;null==(r=null==(n=w.value)?void 0:n.onMouseUp)||r.call(n),null==(a=null==(i=w.value)?void 0:i.onMouseUp)||a.call(i);const s=Dt(P),o=Dt(A);G({scrollLeft:Math.min(T.value.scrollLeft+e,I.value-s),scrollTop:Math.min(T.value.scrollTop+t,k.value-o)})})),G=({scrollLeft:e=T.value.scrollLeft,scrollTop:t=T.value.scrollTop})=>{e=Math.max(e,0),t=Math.max(t,0);const n=Dt(T);t===n.scrollTop&&e===n.scrollLeft||(T.value={...n,xAxisScrollDir:EO(n.scrollLeft,e),yAxisScrollDir:EO(n.scrollTop,t),scrollLeft:e,scrollTop:t,updateRequested:!0},en((()=>j())),W(),B())},H=(r,i)=>{const{columnWidth:a,direction:s,rowHeight:o}=e,l=E.value(t&&a,t&&o,t&&s),c=`${r},${i}`;if(M(l,c))return l[c];{const[,t]=n(e,i,Dt(b)),a=Dt(b),o=PO(s),[d,h]=u(e,r,a),[p]=n(e,i,a);return l[c]={position:"absolute",left:o?void 0:`${t}px`,right:o?`${t}px`:void 0,top:`${h}px`,height:`${d}px`,width:`${p}px`},l[c]}},j=()=>{T.value.isScrolling=!1,en((()=>{E.value(-1,null,null)}))};Kn((()=>{if(!Os)return;const{initScrollLeft:t,initScrollTop:n}=e,r=Dt(x);r&&(Bs(t)&&(r.scrollLeft=t),Bs(n)&&(r.scrollTop=n)),B()}));const W=()=>{const{direction:t}=e,{scrollLeft:n,scrollTop:r,updateRequested:i}=Dt(T),a=Dt(x);if(i&&a){if(t===oO)switch(LO()){case lO:a.scrollLeft=-n;break;case uO:a.scrollLeft=n;break;default:{const{clientWidth:e,scrollWidth:t}=a;a.scrollLeft=t-e-n;break}}else a.scrollLeft=Math.max(0,n);a.scrollTop=Math.max(0,r)}},{resetAfterColumnIndex:Y,resetAfterRowIndex:$,resetAfter:X}=_.proxy;g({windowRef:x,innerRef:C,getItemStyleCache:E,scrollTo:G,scrollToItem:(t=0,n=0,r=eO)=>{const i=Dt(T);n=Math.max(0,Math.min(n,e.totalColumn-1)),t=Math.max(0,Math.min(t,e.totalRow-1));const u=tp(y.namespace.value),c=Dt(b),d=a(e,c),h=s(e,c);G({scrollLeft:o(e,n,r,i.scrollLeft,c,h>e.width?u:0),scrollTop:l(e,t,r,i.scrollTop,c,d>e.height?u:0)})},states:T,resetAfterColumnIndex:Y,resetAfterRowIndex:$,resetAfter:X});const q=()=>{const t=dr(e.innerElement),n=(()=>{var t;const[n,r]=Dt(R),[i,a]=Dt(L),{data:s,totalColumn:o,totalRow:l,useIsScrolling:u,itemKey:c}=e,d=[];if(l>0&&o>0)for(let e=i;e<=a;e++)for(let i=n;i<=r;i++)d.push(null==(t=v.default)?void 0:t.call(v,{columnIndex:i,data:s,key:c({columnIndex:i,data:s,rowIndex:e}),isScrolling:u?Dt(T).isScrolling:void 0,style:H(e,i),rowIndex:e}));return d})();return[ea(t,{style:Dt(N),ref:C},D(t)?n:{default:()=>n})]};return()=>{const t=dr(e.containerElement),{horizontalScrollbar:n,verticalScrollbar:r}=(()=>{const{scrollbarAlwaysOn:t,scrollbarStartGap:n,scrollbarEndGap:r,totalColumn:i,totalRow:a}=e,s=Dt(P),o=Dt(A),l=Dt(I),u=Dt(k),{scrollLeft:c,scrollTop:d}=Dt(T);return{horizontalScrollbar:ea(kO,{ref:w,alwaysOn:t,startGap:n,endGap:r,class:y.e("horizontal"),clientSize:s,layout:"horizontal",onScroll:F,ratio:100*s/l,scrollFrom:c/(l-s),total:a,visible:!0}),verticalScrollbar:ea(kO,{ref:S,alwaysOn:t,startGap:n,endGap:r,class:y.e("vertical"),clientSize:o,layout:"vertical",onScroll:z,ratio:100*o/u,scrollFrom:d/(u-o),total:i,visible:!0})}})(),i=q();return ea("div",{key:0,class:y.e("wrapper"),role:e.role},[ea(t,{class:e.className,style:Dt(O),onScroll:U,onWheel:V,ref:x},D(t)?i:{default:()=>i}),n,r])}}}),VO=FO({name:"ElFixedSizeGrid",getColumnPosition:({columnWidth:e},t)=>[e,t*e],getRowPosition:({rowHeight:e},t)=>[e,t*e],getEstimatedTotalHeight:({totalRow:e,rowHeight:t})=>t*e,getEstimatedTotalWidth:({totalColumn:e,columnWidth:t})=>t*e,getColumnOffset:({totalColumn:e,columnWidth:t,width:n},r,i,a,s,o)=>{n=Number(n);const l=Math.max(0,e*t-n),u=Math.min(l,r*t),c=Math.max(0,r*t-n+o+t);switch("smart"===i&&(i=a>=c-n&&a<=u+n?eO:rO),i){case nO:return u;case iO:return c;case rO:{const e=Math.round(c+(u-c)/2);return e<Math.ceil(n/2)?0:e>l+Math.floor(n/2)?l:e}default:return a>=c&&a<=u?a:c>u||a<c?c:u}},getRowOffset:({rowHeight:e,height:t,totalRow:n},r,i,a,s,o)=>{t=Number(t);const l=Math.max(0,n*e-t),u=Math.min(l,r*e),c=Math.max(0,r*e-t+o+e);switch(i===tO&&(i=a>=c-t&&a<=u+t?eO:rO),i){case nO:return u;case iO:return c;case rO:{const e=Math.round(c+(u-c)/2);return e<Math.ceil(t/2)?0:e>l+Math.floor(t/2)?l:e}default:return a>=c&&a<=u?a:c>u||a<c?c:u}},getColumnStartIndexForOffset:({columnWidth:e,totalColumn:t},n)=>Math.max(0,Math.min(t-1,Math.floor(n/e))),getColumnStopIndexForStartIndex:({columnWidth:e,totalColumn:t,width:n},r,i)=>{const a=r*e,s=Math.ceil((n+i-a)/e);return Math.max(0,Math.min(t-1,r+s-1))},getRowStartIndexForOffset:({rowHeight:e,totalRow:t},n)=>Math.max(0,Math.min(t-1,Math.floor(n/e))),getRowStopIndexForStartIndex:({rowHeight:e,totalRow:t,height:n},r,i)=>{const a=r*e,s=Math.ceil((n+i-a)/e);return Math.max(0,Math.min(t-1,r+s-1))},initCache:()=>{},clearCache:!0,validateProps:({columnWidth:e,rowHeight:t})=>{}}),{max:GO,min:HO,floor:jO}=Math,WO={column:"columnWidth",row:"rowHeight"},YO={column:"lastVisitedColumnIndex",row:"lastVisitedRowIndex"},$O=(e,t,n,r)=>{const[i,a,s]=[n[r],e[WO[r]],n[YO[r]]];if(t>s){let e=0;if(s>=0){const t=i[s];e=t.offset+t.size}for(let n=s+1;n<=t;n++){const t=a(n);i[n]={offset:e,size:t},e+=t}n[YO[r]]=t}return i[t]},XO=(e,t,n,r,i,a)=>{for(;n<=r;){const s=n+jO((r-n)/2),o=$O(e,s,t,a).offset;if(o===i)return s;o<i?n=s+1:r=s-1}return GO(0,n-1)},qO=(e,t,n,r)=>{const[i,a]=[t[r],t[YO[r]]];return(a>0?i[a].offset:0)>=n?XO(e,t,0,a,n,r):((e,t,n,r,i)=>{const a="column"===i?e.totalColumn:e.totalRow;let s=1;for(;n<a&&$O(e,n,t,i).offset<r;)n+=s,s*=2;return XO(e,t,jO(n/2),HO(n,a-1),r,i)})(e,t,GO(0,a),n,r)},KO=({totalRow:e},{estimatedRowHeight:t,lastVisitedRowIndex:n,row:r})=>{let i=0;if(n>=e&&(n=e-1),n>=0){const e=r[n];i=e.offset+e.size}return i+(e-n-1)*t},ZO=({totalColumn:e},{column:t,estimatedColumnWidth:n,lastVisitedColumnIndex:r})=>{let i=0;if(r>e&&(r=e-1),r>=0){const e=t[r];i=e.offset+e.size}return i+(e-r-1)*n},JO={column:ZO,row:KO},QO=(e,t,n,r,i,a,s)=>{const[o,l]=["row"===a?e.height:e.width,JO[a]],u=$O(e,t,i,a),c=l(e,i),d=GO(0,HO(c-o,u.offset)),h=GO(0,u.offset-o+s+u.size);switch(n===tO&&(n=r>=h-o&&r<=d+o?eO:rO),n){case nO:return d;case iO:return h;case rO:return Math.round(h+(d-h)/2);default:return r>=h&&r<=d?r:h>d||r<h?h:d}},eN=FO({name:"ElDynamicSizeGrid",getColumnPosition:(e,t,n)=>{const r=$O(e,t,n,"column");return[r.size,r.offset]},getRowPosition:(e,t,n)=>{const r=$O(e,t,n,"row");return[r.size,r.offset]},getColumnOffset:(e,t,n,r,i,a)=>QO(e,t,n,r,i,"column",a),getRowOffset:(e,t,n,r,i,a)=>QO(e,t,n,r,i,"row",a),getColumnStartIndexForOffset:(e,t,n)=>qO(e,n,t,"column"),getColumnStopIndexForStartIndex:(e,t,n,r)=>{const i=$O(e,t,r,"column"),a=n+e.width;let s=i.offset+i.size,o=t;for(;o<e.totalColumn-1&&s<a;)o++,s+=$O(e,t,r,"column").size;return o},getEstimatedTotalHeight:KO,getEstimatedTotalWidth:ZO,getRowStartIndexForOffset:(e,t,n)=>qO(e,n,t,"row"),getRowStopIndexForStartIndex:(e,t,n,r)=>{const{totalRow:i,height:a}=e,s=$O(e,t,r,"row"),o=n+a;let l=s.size+s.offset,u=t;for(;u<i-1&&l<o;)u++,l+=$O(e,u,r,"row").size;return u},injectToInstance:(e,t)=>{const n=({columnIndex:n,rowIndex:r},i)=>{var a,s;i=!!Bh(i)||i,Bs(n)&&(t.value.lastVisitedColumnIndex=Math.min(t.value.lastVisitedColumnIndex,n-1)),Bs(r)&&(t.value.lastVisitedRowIndex=Math.min(t.value.lastVisitedRowIndex,r-1)),null==(a=e.exposed)||a.getItemStyleCache.value(-1,null,null),i&&(null==(s=e.proxy)||s.$forceUpdate())};Object.assign(e.proxy,{resetAfterColumnIndex:(e,t)=>{n({columnIndex:e},t)},resetAfterRowIndex:(e,t)=>{n({rowIndex:e},t)},resetAfter:n})},initCache:({estimatedColumnWidth:e=50,estimatedRowHeight:t=50})=>({column:{},estimatedColumnWidth:e,estimatedRowHeight:t,lastVisitedColumnIndex:-1,lastVisitedRowIndex:-1,row:{}}),clearCache:!1,validateProps:({columnWidth:e,rowHeight:t})=>{}});var tN=J_(Fn({props:{item:{type:Object,required:!0},style:Object,height:Number},setup:()=>({ns:rv("select")})}),[["render",function(e,t,n,i,a,s){return e.item.isTitle?(fi(),yi("div",{key:0,class:l(e.ns.be("group","title")),style:r([e.style,{lineHeight:`${e.height}px`}])},f(e.item.label),7)):(fi(),yi("div",{key:1,class:l(e.ns.be("group","split")),style:r(e.style)},[Ti("span",{class:l(e.ns.be("group","split-dash")),style:r({top:e.height/2+"px"})},null,6)],6))}],["__file","/home/runner/work/element-plus/element-plus/packages/components/select-v2/src/group-item.vue"]]);const nN={allowCreate:Boolean,autocomplete:{type:String,default:"none"},automaticDropdown:Boolean,clearable:Boolean,clearIcon:{type:[String,Object],default:tf},effect:{type:String,default:"light"},collapseTags:Boolean,collapseTagsTooltip:{type:Boolean,default:!1},maxCollapseTags:{type:Number,default:1},defaultFirstOption:Boolean,disabled:Boolean,estimatedOptionHeight:{type:Number,default:void 0},filterable:Boolean,filterMethod:Function,height:{type:Number,default:170},itemHeight:{type:Number,default:34},id:String,loading:Boolean,loadingText:String,label:String,modelValue:[Array,String,Number,Boolean,Object],multiple:Boolean,multipleLimit:{type:Number,default:0},name:String,noDataText:String,noMatchText:String,remoteMethod:Function,reserveKeyword:{type:Boolean,default:!0},options:{type:Array,required:!0},placeholder:{type:String},teleported:_w.teleported,persistent:{type:Boolean,default:!0},popperClass:{type:String,default:""},popperOptions:{type:Object,default:()=>({})},remote:Boolean,size:{type:String,validator:Lg},valueKey:{type:String,default:"value"},scrollbarAlwaysOn:{type:Boolean,default:!1},validateEvent:{type:Boolean,default:!0},placement:{type:String,values:wv,default:"bottom-start"}},rN=Fn({props:{data:Array,disabled:Boolean,hovering:Boolean,item:Object,index:Number,style:Object,selected:Boolean,created:Boolean},emits:["select","hover"],setup(e,{emit:t}){const n=rv("select"),{hoverItem:r,selectOptionClick:i}=function(e,{emit:t}){return{hoverItem:()=>{e.disabled||t("hover",e.index)},selectOptionClick:()=>{e.disabled||t("select",e.item,e.index)}}}(e,{emit:t});return{ns:n,hoverItem:r,selectOptionClick:i}}}),iN=["aria-selected"];var aN=J_(rN,[["render",function(e,t,n,i,a,s){return fi(),yi("li",{"aria-selected":e.selected,style:r(e.style),class:l([e.ns.be("dropdown","option-item"),e.ns.is("selected",e.selected),e.ns.is("disabled",e.disabled),e.ns.is("created",e.created),{hover:e.hovering}]),onMouseenter:t[0]||(t[0]=(...t)=>e.hoverItem&&e.hoverItem(...t)),onClick:t[1]||(t[1]=ts(((...t)=>e.selectOptionClick&&e.selectOptionClick(...t)),["stop"]))},[vr(e.$slots,"default",{item:e.item,index:e.index,disabled:e.disabled},(()=>[Ti("span",null,f(e.item.label),1)]))],46,iN)}],["__file","/home/runner/work/element-plus/element-plus/packages/components/select-v2/src/option-item.vue"]]);const sN=Symbol("ElSelectV2Injection");var oN=Fn({name:"ElSelectDropdown",props:{data:{type:Array,required:!0},hoveringIndex:Number,width:Number},setup(e,{slots:t,expose:n}){const r=Sn(sN),i=rv("select"),a=At([]),s=At(),o=Ki((()=>e.data.length));Mn((()=>o.value),(()=>{var e,t;null==(t=(e=r.popper.value).updatePopper)||t.call(e)}));const l=Ki((()=>Bh(r.props.estimatedOptionHeight))),u=Ki((()=>l.value?{itemSize:r.props.itemHeight}:{estimatedSize:r.props.estimatedOptionHeight,itemSize:e=>a.value[e]})),c=(e,t)=>{const{valueKey:n}=r.props;return r.props.multiple?((e=[],t)=>{const{props:{valueKey:n}}=r;return O(t)?e&&e.some((e=>Vu(e,n)===Vu(t,n))):e.includes(t)})(e,Vu(t,n)):((e,t)=>{if(O(t)){const{valueKey:n}=r.props;return Vu(e,n)===Vu(t,n)}return e===t})(e,Vu(t,n))},d=(e,t)=>{const{disabled:n,multiple:i,multipleLimit:a}=r.props;return n||!t&&!!i&&a>0&&e.length>=a},h=t=>e.hoveringIndex===t;n({listRef:s,isSized:l,isItemDisabled:d,isItemHovering:h,isItemSelected:c,scrollToItem:e=>{const t=s.value;t&&t.scrollToItem(e)},resetScrollTop:()=>{const e=s.value;e&&e.resetScrollTop()}});const p=e=>{const{index:n,data:i,style:a}=e,s=Dt(l),{itemSize:o,estimatedSize:p}=Dt(u),{modelValue:f}=r.props,{onSelect:m,onHover:g}=r,v=i[n];if("Group"===v.type)return Mi(tN,{item:v,style:a,height:s?o:p},null);const y=c(f,v),_=d(f,y),b=h(n);return Mi(aN,Oi(e,{selected:y,disabled:v.disabled||_,created:!!v.created,hovering:b,item:v,onSelect:m,onHover:g}),{default:e=>{var n;return(null==(n=t.default)?void 0:n.call(t,e))||Mi("span",null,[v.label])}})},{onKeyboardNavigate:f,onKeyboardSelect:m}=r,g=e=>{const{code:t}=e,{tab:n,esc:i,down:a,up:s,enter:o}=Sg;switch(t!==n&&(e.preventDefault(),e.stopPropagation()),t){case n:case i:r.expanded=!1;break;case a:f("forward");break;case s:f("backward");break;case o:m()}};return()=>{var n;const{data:a,width:o}=e,{height:c,multiple:d,scrollbarAlwaysOn:h}=r.props;if(0===a.length)return Mi("div",{class:i.b("dropdown"),style:{width:`${o}px`}},[null==(n=t.empty)?void 0:n.call(t)]);const f=Dt(l)?IO:zO;return Mi("div",{class:[i.b("dropdown"),i.is("multiple",d)]},[Mi(f,Oi({ref:s},Dt(u),{className:i.be("dropdown","list"),scrollbarAlwaysOn:h,data:a,height:c,width:o,total:a.length,onKeydown:g}),{default:e=>Mi(p,e,null)})])}}});function lN(e,t){const n=At(0),r=At(null),i=Ki((()=>e.allowCreate&&e.filterable));return{createNewOption:function(a){if(i.value)if(a&&a.length>0&&!function(n){const r=e=>e.value===n;return e.options&&e.options.some(r)||t.createdOptions.some(r)}(a)){const e={value:a,label:a,created:!0,disabled:!1};t.createdOptions.length>=n.value?t.createdOptions[n.value]=e:t.createdOptions.push(e)}else if(e.multiple)t.createdOptions.length=n.value;else{const e=r.value;t.createdOptions.length=0,e&&e.created&&t.createdOptions.push(e)}},removeNewOption:function(r){if(!i.value||!r||!r.created||r.created&&e.reserveKeyword&&t.inputValue===r.label)return;const a=t.createdOptions.findIndex((e=>e.value===r.value));~a&&(t.createdOptions.splice(a,1),n.value--)},selectNewOption:function(t){i.value&&(e.multiple&&t.created?n.value++:r.value=t)},clearAllNewOption:function(){i.value&&(t.createdOptions.length=0,n.value=0)}}}const uN={larget:51,default:42,small:33},cN=(e,t)=>{const{t:n}=Jg(),r=rv("select-v2"),i=rv("input"),{form:a,formItem:s}=pb(),o=pt({inputValue:"",displayInputValue:"",calculatedWidth:0,cachedPlaceholder:"",cachedOptions:[],createdOptions:[],createdLabel:"",createdSelected:!1,currentPlaceholder:"",hoveringIndex:-1,comboBoxHovering:!1,isOnComposition:!1,isSilentBlur:!1,isComposing:!1,inputLength:20,selectWidth:200,initialInputHeight:0,previousQuery:null,previousValue:void 0,query:"",selectedLabel:"",softFocus:!1,tagInMultiLine:!1}),l=At(-1),u=At(-1),c=At(null),d=At(null),h=At(null),p=At(null),f=At(null),m=At(null),g=At(null),v=At(!1),y=Ki((()=>e.disabled||(null==a?void 0:a.disabled))),_=Ki((()=>{const t=34*P.value.length;return t>e.height?e.height:t})),b=Ki((()=>!Ah(e.modelValue))),x=Ki((()=>{const t=e.multiple?Array.isArray(e.modelValue)&&e.modelValue.length>0:b.value;return e.clearable&&!y.value&&o.comboBoxHovering&&t})),w=Ki((()=>e.remote&&e.filterable?"":_p)),S=Ki((()=>w.value&&r.is("reverse",v.value))),C=Ki((()=>(null==s?void 0:s.validateState)||"")),T=Ki((()=>yg[C.value])),M=Ki((()=>e.remote?300:0)),A=Ki((()=>{const t=P.value;return e.loading?e.loadingText||n("el.select.loading"):(!e.remote||""!==o.inputValue||0!==t.length)&&(e.filterable&&o.inputValue&&t.length>0?e.noMatchText||n("el.select.noMatch"):0===t.length?e.noDataText||n("el.select.noData"):null)})),P=Ki((()=>{const t=e=>{const t=o.inputValue,n=new RegExp(Fh(t),"i");return!t||n.test(e.label||"")};return e.loading?[]:(e=>{const t=[];return e.forEach((e=>{E(e.options)?(t.push({label:e.label,isTitle:!0,type:"Group"}),e.options.forEach((e=>{t.push(e)})),t.push({type:"Group"})):t.push(e)})),t})(e.options.concat(o.createdOptions).map((n=>{if(E(n.options)){const e=n.options.filter(t);if(e.length>0)return{...n,options:e}}else if(e.remote||t(n))return n;return null})).filter((e=>null!==e)))})),R=Ki((()=>P.value.every((e=>e.disabled)))),L=db(),D=Ki((()=>"small"===L.value?"small":"default")),I=Ki((()=>{const e=m.value,t=D.value||"default",n=e?Number.parseInt(getComputedStyle(e).paddingLeft):0,r=e?Number.parseInt(getComputedStyle(e).paddingRight):0;return o.selectWidth-r-n-uN[t]})),N=()=>{var e;u.value=(null==(e=f.value)?void 0:e.offsetWidth)||200},B=Ki((()=>({width:`${0===o.calculatedWidth?11:Math.ceil(o.calculatedWidth)+11}px`}))),U=Ki((()=>E(e.modelValue)?0===e.modelValue.length&&!o.displayInputValue:!e.filterable||0===o.displayInputValue.length)),z=Ki((()=>{const t=e.placeholder||n("el.select.placeholder");return e.multiple||Ah(e.modelValue)?t:o.selectedLabel})),F=Ki((()=>{var e,t;return null==(t=null==(e=p.value)?void 0:e.popperRef)?void 0:t.contentRef})),V=Ki((()=>{if(e.multiple){const t=e.modelValue.length;if(e.modelValue.length>0)return P.value.findIndex((n=>n.value===e.modelValue[t-1]))}else if(e.modelValue)return P.value.findIndex((t=>t.value===e.modelValue));return-1})),G=Ki({get:()=>v.value&&!1!==A.value,set(e){v.value=e}}),H=Ki((()=>o.cachedOptions.slice(0,e.maxCollapseTags))),j=Ki((()=>o.cachedOptions.slice(e.maxCollapseTags))),{createNewOption:W,removeNewOption:Y,selectNewOption:$,clearAllNewOption:X}=lN(e,o),{handleCompositionStart:q,handleCompositionUpdate:K,handleCompositionEnd:Z}=function(e){const t=At(!1);return{handleCompositionStart:()=>{t.value=!0},handleCompositionUpdate:e=>{const n=e.target.value,r=n[n.length-1]||"";t.value=!zg(r)},handleCompositionEnd:n=>{t.value&&(t.value=!1,k(e)&&e(n))}}}((e=>me(e))),J=()=>{var e,t,n;null==(t=null==(e=d.value)?void 0:e.focus)||t.call(e),null==(n=p.value)||n.updatePopper()},Q=()=>{if(!e.automaticDropdown)return y.value?void 0:(o.isComposing&&(o.softFocus=!0),en((()=>{var e,t;v.value=!v.value,null==(t=null==(e=d.value)?void 0:e.focus)||t.call(e)})))},ee=()=>(e.filterable&&o.inputValue!==o.selectedLabel&&(o.query=o.selectedLabel),ne(o.inputValue),en((()=>{W(o.inputValue)}))),te=gh(ee,M.value),ne=t=>{o.previousQuery!==t&&(o.previousQuery=t,e.filterable&&k(e.filterMethod)?e.filterMethod(t):e.filterable&&e.remote&&k(e.remoteMethod)&&e.remoteMethod(t))},re=n=>{t(Tg,n),(n=>{Eh(e.modelValue,n)||t(Mg,n)})(n),o.previousValue=null==n?void 0:n.toString()},ie=t=>O(t)?Vu(t,e.valueKey):t,ae=()=>en((()=>{var e,t;if(!d.value)return;const n=m.value;f.value.height=n.offsetHeight,v.value&&!1!==A.value&&(null==(t=null==(e=p.value)?void 0:e.updatePopper)||t.call(e))})),se=()=>{var t,n;if(oe(),N(),null==(n=null==(t=p.value)?void 0:t.updatePopper)||n.call(t),e.multiple)return ae()},oe=()=>{const e=m.value;e&&(o.selectWidth=e.getBoundingClientRect().width)},le=(t,n,r=!0)=>{var i,a;if(e.multiple){let r=e.modelValue.slice();const s=((t=[],n)=>{if(!O(n))return t.indexOf(n);const r=e.valueKey;let i=-1;return t.some(((e,t)=>Vu(e,r)===Vu(n,r)&&(i=t,!0))),i})(r,ie(t));s>-1?(r=[...r.slice(0,s),...r.slice(s+1)],o.cachedOptions.splice(s,1),Y(t)):(e.multipleLimit<=0||r.length<e.multipleLimit)&&(r=[...r,ie(t)],o.cachedOptions.push(t),$(t),he(n)),re(r),t.created&&(o.query="",ne(""),o.inputLength=20),e.filterable&&!e.reserveKeyword&&(null==(a=(i=d.value).focus)||a.call(i),ce("")),e.filterable&&(o.calculatedWidth=g.value.getBoundingClientRect().width),ae(),fe()}else l.value=n,o.selectedLabel=t.label,re(ie(t)),v.value=!1,o.isComposing=!1,o.isSilentBlur=r,$(t),t.created||X(),he(n)},ue=e=>(o.softFocus=!1,en((()=>{var n,r;null==(r=null==(n=d.value)?void 0:n.blur)||r.call(n),g.value&&(o.calculatedWidth=g.value.getBoundingClientRect().width),o.isSilentBlur?o.isSilentBlur=!1:o.isComposing&&t("blur",e),o.isComposing=!1}))),ce=e=>{o.displayInputValue=e,o.inputValue=e},de=(e,t=void 0)=>{const n=P.value;if(!["forward","backward"].includes(e)||y.value||n.length<=0||R.value)return;if(!v.value)return Q();void 0===t&&(t=o.hoveringIndex);let r=-1;"forward"===e?(r=t+1,r>=n.length&&(r=0)):"backward"===e&&(r=t-1,(r<0||r>=n.length)&&(r=n.length-1));const i=n[r];if(i.disabled||"Group"===i.type)return de(e,r);he(r),ge(r)},he=e=>{o.hoveringIndex=e},pe=()=>{o.hoveringIndex=-1},fe=()=>{var e;const t=d.value;t&&(null==(e=t.focus)||e.call(t))},me=t=>{const n=t.target.value;if(ce(n),o.displayInputValue.length>0&&!v.value&&(v.value=!0),o.calculatedWidth=g.value.getBoundingClientRect().width,e.multiple&&ae(),!e.remote)return ee();te()},ge=e=>{h.value.scrollToItem(e)},ve=()=>{if(pe(),e.multiple)if(e.modelValue.length>0){let t=!1;o.cachedOptions.length=0,o.previousValue=e.modelValue.toString(),e.modelValue.forEach((e=>{const n=P.value.findIndex((t=>ie(t)===e));~n&&(o.cachedOptions.push(P.value[n]),t||he(n),t=!0)}))}else o.cachedOptions=[],o.previousValue=void 0;else if(b.value){o.previousValue=e.modelValue;const t=P.value,n=t.findIndex((t=>ie(t)===ie(e.modelValue)));~n?(o.selectedLabel=t[n].label,he(n)):o.selectedLabel=`${e.modelValue}`}else o.selectedLabel="",o.previousValue=void 0;X(),N()};return Mn(v,(e=>{var n,r;t("visible-change",e),e?null==(r=(n=p.value).update)||r.call(n):(o.displayInputValue="",o.previousQuery=null,W(""))})),Mn((()=>e.modelValue),((t,n)=>{var r;t&&t.toString()===o.previousValue||ve(),!Eh(t,n)&&e.validateEvent&&(null==(r=null==s?void 0:s.validate)||r.call(s,"change").catch((e=>{})))}),{deep:!0}),Mn((()=>e.options),(()=>{const e=d.value;(!e||e&&document.activeElement!==e)&&ve()}),{deep:!0}),Mn(P,(()=>en(h.value.resetScrollTop))),Mn((()=>G.value),(e=>{e||pe()})),Kn((()=>{ve()})),lo(f,se),{collapseTagSize:D,currentPlaceholder:z,expanded:v,emptyText:A,popupHeight:_,debounce:M,filteredOptions:P,iconComponent:w,iconReverse:S,inputWrapperStyle:B,popperSize:u,dropdownMenuVisible:G,hasModelValue:b,shouldShowPlaceholder:U,selectDisabled:y,selectSize:L,showClearBtn:x,states:o,tagMaxWidth:I,nsSelectV2:r,nsInput:i,calculatorRef:g,controlRef:c,inputRef:d,menuRef:h,popper:p,selectRef:f,selectionRef:m,popperRef:F,validateState:C,validateIcon:T,showTagList:H,collapseTagList:j,debouncedOnInputChange:te,deleteTag:(n,r)=>{const{valueKey:i}=e,a=e.modelValue.indexOf(Vu(r,i));if(a>-1&&!y.value){const n=[...e.modelValue.slice(0,a),...e.modelValue.slice(a+1)];return o.cachedOptions.splice(a,1),re(n),t("remove-tag",Vu(r,i)),o.softFocus=!0,Y(r),en(J)}n.stopPropagation()},getLabel:e=>O(e)?e.label:e,getValueKey:ie,handleBlur:ue,handleClear:()=>{let n;return n=E(e.modelValue)?[]:void 0,o.softFocus=!0,e.multiple?o.cachedOptions=[]:o.selectedLabel="",v.value=!1,re(n),t("clear"),X(),en(J)},handleClickOutside:()=>(v.value=!1,ue()),handleDel:t=>{if(0===o.displayInputValue.length){t.preventDefault();const n=e.modelValue.slice();n.pop(),Y(o.cachedOptions.pop()),re(n)}},handleEsc:()=>{o.displayInputValue.length>0?ce(""):v.value=!1},handleFocus:e=>{const n=o.isComposing;o.isComposing=!0,o.softFocus?o.softFocus=!1:n||t("focus",e)},handleMenuEnter:()=>(o.inputValue=o.displayInputValue,en((()=>{~V.value&&(he(V.value),ge(o.hoveringIndex))}))),handleResize:se,toggleMenu:Q,scrollTo:ge,onInput:me,onKeyboardNavigate:de,onKeyboardSelect:()=>{if(!v.value)return Q();~o.hoveringIndex&&P.value[o.hoveringIndex]&&le(P.value[o.hoveringIndex],o.hoveringIndex,!1)},onSelect:le,onHover:he,onUpdateInputValue:ce,handleCompositionStart:q,handleCompositionEnd:Z,handleCompositionUpdate:K}},dN=Fn({name:"ElSelectV2",components:{ElSelectMenu:oN,ElTag:sE,ElTooltip:Ow,ElIcon:ib},directives:{ClickOutside:EC,ModelText:$a},props:nN,emits:[Tg,Mg,"remove-tag","clear","visible-change","focus","blur"],setup(e,{emit:t}){const n=Ki((()=>{const{modelValue:t,multiple:n}=e,r=n?[]:void 0;return E(t)?n?t:r:n?r:t})),r=cN(pt({...Nt(e),modelValue:n}),t);return wn(sN,{props:pt({...Nt(e),height:r.popupHeight,modelValue:n}),popper:r.popper,onSelect:r.onSelect,onHover:r.onHover,onKeyboardNavigate:r.onKeyboardNavigate,onKeyboardSelect:r.onKeyboardSelect}),{...r,modelValue:n}}}),hN={key:0},pN=["id","autocomplete","aria-expanded","aria-labelledby","disabled","readonly","name","unselectable"],fN=["textContent"],mN=["id","aria-labelledby","aria-expanded","autocomplete","disabled","name","readonly","unselectable"],gN=["textContent"];var vN=J_(dN,[["render",function(e,t,n,i,a,s){const o=ur("el-tag"),c=ur("el-tooltip"),d=ur("el-icon"),h=ur("el-select-menu"),p=hr("model-text"),m=hr("click-outside");return ar((fi(),yi("div",{ref:"selectRef",class:l([e.nsSelectV2.b(),e.nsSelectV2.m(e.selectSize)]),onClick:t[24]||(t[24]=ts(((...t)=>e.toggleMenu&&e.toggleMenu(...t)),["stop"])),onMouseenter:t[25]||(t[25]=t=>e.states.comboBoxHovering=!0),onMouseleave:t[26]||(t[26]=t=>e.states.comboBoxHovering=!1)},[Mi(c,{ref:"popper",visible:e.dropdownMenuVisible,teleported:e.teleported,"popper-class":[e.nsSelectV2.e("popper"),e.popperClass],"gpu-acceleration":!1,"stop-popper-mouse-event":!1,"popper-options":e.popperOptions,"fallback-placements":["bottom-start","top-start","right","left"],effect:e.effect,placement:e.placement,pure:"",transition:`${e.nsSelectV2.namespace.value}-zoom-in-top`,trigger:"click",persistent:e.persistent,onBeforeShow:e.handleMenuEnter,onHide:t[23]||(t[23]=t=>e.states.inputValue=e.states.displayInputValue)},{default:vn((()=>[Ti("div",{ref:"selectionRef",class:l([e.nsSelectV2.e("wrapper"),e.nsSelectV2.is("focused",e.states.isComposing||e.expanded),e.nsSelectV2.is("hovering",e.states.comboBoxHovering),e.nsSelectV2.is("filterable",e.filterable),e.nsSelectV2.is("disabled",e.selectDisabled)])},[e.$slots.prefix?(fi(),yi("div",hN,[vr(e.$slots,"prefix")])):Li("v-if",!0),e.multiple?(fi(),yi("div",{key:1,class:l(e.nsSelectV2.e("selection"))},[e.collapseTags&&e.modelValue.length>0?(fi(),yi(li,{key:0},[(fi(!0),yi(li,null,mr(e.showTagList,(t=>(fi(),yi("div",{key:e.getValueKey(t),class:l(e.nsSelectV2.e("selected-item"))},[Mi(o,{closable:!e.selectDisabled&&!(null==t?void 0:t.disable),size:e.collapseTagSize,type:"info","disable-transitions":"",onClose:n=>e.deleteTag(n,t)},{default:vn((()=>[Ti("span",{class:l(e.nsSelectV2.e("tags-text")),style:r({maxWidth:`${e.tagMaxWidth}px`})},f(null==t?void 0:t.label),7)])),_:2},1032,["closable","size","onClose"])],2)))),128)),Ti("div",{class:l(e.nsSelectV2.e("selected-item"))},[e.modelValue.length>e.maxCollapseTags?(fi(),_i(o,{key:0,closable:!1,size:e.collapseTagSize,type:"info","disable-transitions":""},{default:vn((()=>[e.collapseTagsTooltip?(fi(),_i(c,{key:0,disabled:e.dropdownMenuVisible,"fallback-placements":["bottom","top","right","left"],effect:e.effect,placement:"bottom",teleported:!1},{default:vn((()=>[Ti("span",{class:l(e.nsSelectV2.e("tags-text")),style:r({maxWidth:`${e.tagMaxWidth}px`})},"+ "+f(e.modelValue.length-e.maxCollapseTags),7)])),content:vn((()=>[Ti("div",{class:l(e.nsSelectV2.e("selection"))},[(fi(!0),yi(li,null,mr(e.collapseTagList,(t=>(fi(),yi("div",{key:e.getValueKey(t),class:l(e.nsSelectV2.e("selected-item"))},[Mi(o,{closable:!e.selectDisabled&&!t.disabled,size:e.collapseTagSize,class:"in-tooltip",type:"info","disable-transitions":"",onClose:n=>e.deleteTag(n,t)},{default:vn((()=>[Ti("span",{class:l(e.nsSelectV2.e("tags-text")),style:r({maxWidth:`${e.tagMaxWidth}px`})},f(e.getLabel(t)),7)])),_:2},1032,["closable","size","onClose"])],2)))),128))],2)])),_:1},8,["disabled","effect"])):(fi(),yi("span",{key:1,class:l(e.nsSelectV2.e("tags-text")),style:r({maxWidth:`${e.tagMaxWidth}px`})},"+ "+f(e.modelValue.length-e.maxCollapseTags),7))])),_:1},8,["size"])):Li("v-if",!0)],2)],64)):(fi(!0),yi(li,{key:1},mr(e.states.cachedOptions,(t=>(fi(),yi("div",{key:e.getValueKey(t),class:l(e.nsSelectV2.e("selected-item"))},[Mi(o,{closable:!e.selectDisabled&&!t.disabled,size:e.collapseTagSize,type:"info","disable-transitions":"",onClose:n=>e.deleteTag(n,t)},{default:vn((()=>[Ti("span",{class:l(e.nsSelectV2.e("tags-text")),style:r({maxWidth:`${e.tagMaxWidth}px`})},f(e.getLabel(t)),7)])),_:2},1032,["closable","size","onClose"])],2)))),128)),Ti("div",{class:l([e.nsSelectV2.e("selected-item"),e.nsSelectV2.e("input-wrapper")]),style:r(e.inputWrapperStyle)},[ar(Ti("input",{id:e.id,ref:"inputRef",autocomplete:e.autocomplete,"aria-autocomplete":"list","aria-haspopup":"listbox",autocapitalize:"off","aria-expanded":e.expanded,"aria-labelledby":e.label,class:l([e.nsSelectV2.is(e.selectSize),e.nsSelectV2.e("combobox-input")]),disabled:e.disabled,role:"combobox",readonly:!e.filterable,spellcheck:"false",type:"text",name:e.name,unselectable:e.expanded?"on":void 0,"onUpdate:modelValue":t[0]||(t[0]=(...t)=>e.onUpdateInputValue&&e.onUpdateInputValue(...t)),onFocus:t[1]||(t[1]=(...t)=>e.handleFocus&&e.handleFocus(...t)),onBlur:t[2]||(t[2]=(...t)=>e.handleBlur&&e.handleBlur(...t)),onInput:t[3]||(t[3]=(...t)=>e.onInput&&e.onInput(...t)),onCompositionstart:t[4]||(t[4]=(...t)=>e.handleCompositionStart&&e.handleCompositionStart(...t)),onCompositionupdate:t[5]||(t[5]=(...t)=>e.handleCompositionUpdate&&e.handleCompositionUpdate(...t)),onCompositionend:t[6]||(t[6]=(...t)=>e.handleCompositionEnd&&e.handleCompositionEnd(...t)),onKeydown:[t[7]||(t[7]=rs(ts((t=>e.onKeyboardNavigate("backward")),["stop","prevent"]),["up"])),t[8]||(t[8]=rs(ts((t=>e.onKeyboardNavigate("forward")),["stop","prevent"]),["down"])),t[9]||(t[9]=rs(ts(((...t)=>e.onKeyboardSelect&&e.onKeyboardSelect(...t)),["stop","prevent"]),["enter"])),t[10]||(t[10]=rs(ts(((...t)=>e.handleEsc&&e.handleEsc(...t)),["stop","prevent"]),["esc"])),t[11]||(t[11]=rs(ts(((...t)=>e.handleDel&&e.handleDel(...t)),["stop"]),["delete"]))]},null,42,pN),[[p,e.states.displayInputValue]]),e.filterable?(fi(),yi("span",{key:0,ref:"calculatorRef","aria-hidden":"true",class:l(e.nsSelectV2.e("input-calculator")),textContent:f(e.states.displayInputValue)},null,10,fN)):Li("v-if",!0)],6)],2)):(fi(),yi(li,{key:2},[Ti("div",{class:l([e.nsSelectV2.e("selected-item"),e.nsSelectV2.e("input-wrapper")])},[ar(Ti("input",{id:e.id,ref:"inputRef","aria-autocomplete":"list","aria-haspopup":"listbox","aria-labelledby":e.label,"aria-expanded":e.expanded,autocapitalize:"off",autocomplete:e.autocomplete,class:l(e.nsSelectV2.e("combobox-input")),disabled:e.disabled,name:e.name,role:"combobox",readonly:!e.filterable,spellcheck:"false",type:"text",unselectable:e.expanded?"on":void 0,onCompositionstart:t[12]||(t[12]=(...t)=>e.handleCompositionStart&&e.handleCompositionStart(...t)),onCompositionupdate:t[13]||(t[13]=(...t)=>e.handleCompositionUpdate&&e.handleCompositionUpdate(...t)),onCompositionend:t[14]||(t[14]=(...t)=>e.handleCompositionEnd&&e.handleCompositionEnd(...t)),onFocus:t[15]||(t[15]=(...t)=>e.handleFocus&&e.handleFocus(...t)),onBlur:t[16]||(t[16]=(...t)=>e.handleBlur&&e.handleBlur(...t)),onInput:t[17]||(t[17]=(...t)=>e.onInput&&e.onInput(...t)),onKeydown:[t[18]||(t[18]=rs(ts((t=>e.onKeyboardNavigate("backward")),["stop","prevent"]),["up"])),t[19]||(t[19]=rs(ts((t=>e.onKeyboardNavigate("forward")),["stop","prevent"]),["down"])),t[20]||(t[20]=rs(ts(((...t)=>e.onKeyboardSelect&&e.onKeyboardSelect(...t)),["stop","prevent"]),["enter"])),t[21]||(t[21]=rs(ts(((...t)=>e.handleEsc&&e.handleEsc(...t)),["stop","prevent"]),["esc"]))],"onUpdate:modelValue":t[22]||(t[22]=(...t)=>e.onUpdateInputValue&&e.onUpdateInputValue(...t))},null,42,mN),[[p,e.states.displayInputValue]])],2),e.filterable?(fi(),yi("span",{key:0,ref:"calculatorRef","aria-hidden":"true",class:l([e.nsSelectV2.e("selected-item"),e.nsSelectV2.e("input-calculator")]),textContent:f(e.states.displayInputValue)},null,10,gN)):Li("v-if",!0)],64)),e.shouldShowPlaceholder?(fi(),yi("span",{key:3,class:l([e.nsSelectV2.e("placeholder"),e.nsSelectV2.is("transparent",e.multiple?0===e.modelValue.length:!e.hasModelValue)])},f(e.currentPlaceholder),3)):Li("v-if",!0),Ti("span",{class:l(e.nsSelectV2.e("suffix"))},[e.iconComponent?ar((fi(),_i(d,{key:0,class:l([e.nsSelectV2.e("caret"),e.nsInput.e("icon"),e.iconReverse])},{default:vn((()=>[(fi(),_i(dr(e.iconComponent)))])),_:1},8,["class"])),[[is,!e.showClearBtn]]):Li("v-if",!0),e.showClearBtn&&e.clearIcon?(fi(),_i(d,{key:1,class:l([e.nsSelectV2.e("caret"),e.nsInput.e("icon")]),onClick:ts(e.handleClear,["prevent","stop"])},{default:vn((()=>[(fi(),_i(dr(e.clearIcon)))])),_:1},8,["class","onClick"])):Li("v-if",!0),e.validateState&&e.validateIcon?(fi(),_i(d,{key:2,class:l([e.nsInput.e("icon"),e.nsInput.e("validateIcon")])},{default:vn((()=>[(fi(),_i(dr(e.validateIcon)))])),_:1},8,["class"])):Li("v-if",!0)],2)],2)])),content:vn((()=>[Mi(h,{ref:"menuRef",data:e.filteredOptions,width:e.popperSize,"hovering-index":e.states.hoveringIndex,"scrollbar-always-on":e.scrollbarAlwaysOn},{default:vn((t=>[vr(e.$slots,"default",u(Ei(t)))])),empty:vn((()=>[vr(e.$slots,"empty",{},(()=>[Ti("p",{class:l(e.nsSelectV2.e("empty"))},f(e.emptyText?e.emptyText:""),3)]))])),_:3},8,["data","width","hovering-index","scrollbar-always-on"])])),_:3},8,["visible","teleported","popper-class","popper-options","effect","placement","transition","persistent","onBeforeShow"])],34)),[[m,e.handleClickOutside,e.popperRef]])}],["__file","/home/runner/work/element-plus/element-plus/packages/components/select-v2/src/select.vue"]]);vN.install=e=>{e.component(vN.name,vN)};const yN=vN,_N=pg({animated:{type:Boolean,default:!1},count:{type:Number,default:1},rows:{type:Number,default:3},loading:{type:Boolean,default:!0},throttle:{type:Number}}),bN=pg({variant:{type:String,values:["circle","rect","h1","h3","text","caption","p","image","button"],default:"text"}}),xN=Fn({name:"ElSkeletonItem"});var wN=J_(Fn({...xN,props:bN,setup(e){const t=rv("skeleton");return(e,n)=>(fi(),yi("div",{class:l([Dt(t).e("item"),Dt(t).e(e.variant)])},["image"===e.variant?(fi(),_i(Dt(im),{key:0})):Li("v-if",!0)],2))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/skeleton/src/skeleton-item.vue"]]);const SN=Fn({name:"ElSkeleton"});const CN=_g(J_(Fn({...SN,props:_N,setup(e,{expose:t}){const n=e,r=rv("skeleton"),i=((e,t=0)=>{if(0===t)return e;const n=At(!1);let r=0;const i=()=>{r&&clearTimeout(r),r=window.setTimeout((()=>{n.value=e.value}),t)};return Kn(i),Mn((()=>e.value),(e=>{e?i():n.value=e})),n})(Ut(n,"loading"),n.throttle);return t({uiLoading:i}),(e,t)=>Dt(i)?(fi(),yi("div",Oi({key:0,class:[Dt(r).b(),Dt(r).is("animated",e.animated)]},e.$attrs),[(fi(!0),yi(li,null,mr(e.count,(t=>(fi(),yi(li,{key:t},[e.loading?vr(e.$slots,"template",{key:t},(()=>[Mi(wN,{class:l(Dt(r).is("first")),variant:"p"},null,8,["class"]),(fi(!0),yi(li,null,mr(e.rows,(t=>(fi(),_i(wN,{key:t,class:l([Dt(r).e("paragraph"),Dt(r).is("last",t===e.rows&&e.rows>1)]),variant:"p"},null,8,["class"])))),128))])):Li("v-if",!0)],64)))),128))],16)):vr(e.$slots,"default",u(Oi({key:1},e.$attrs)))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/skeleton/src/skeleton.vue"]]),{SkeletonItem:wN}),TN=xg(wN),MN=Symbol("sliderContextKey"),EN=pg({modelValue:{type:[Number,Array],default:0},id:{type:String,default:void 0},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},showInput:Boolean,showInputControls:{type:Boolean,default:!0},size:z_,inputSize:z_,showStops:Boolean,showTooltip:{type:Boolean,default:!0},formatTooltip:{type:Function,default:void 0},disabled:Boolean,range:Boolean,vertical:Boolean,height:String,debounce:{type:Number,default:300},label:{type:String,default:void 0},rangeStartLabel:{type:String,default:void 0},rangeEndLabel:{type:String,default:void 0},formatValueText:{type:Function,default:void 0},tooltipClass:{type:String,default:void 0},placement:{type:String,values:wv,default:"top"},marks:{type:Object},validateEvent:{type:Boolean,default:!0}}),AN=e=>Bs(e)||E(e)&&e.every(Bs),PN={[Tg]:AN,[Eg]:AN,[Mg]:AN},RN=(e,t,n)=>{const{form:r,formItem:i}=pb(),a=Pt(),s=At(),o=At(),l={firstButton:s,secondButton:o},u=Ki((()=>e.disabled||(null==r?void 0:r.disabled)||!1)),c=Ki((()=>Math.min(t.firstValue,t.secondValue))),d=Ki((()=>Math.max(t.firstValue,t.secondValue))),h=Ki((()=>e.range?100*(d.value-c.value)/(e.max-e.min)+"%":100*(t.firstValue-e.min)/(e.max-e.min)+"%")),p=Ki((()=>e.range?100*(c.value-e.min)/(e.max-e.min)+"%":"0%")),f=Ki((()=>e.vertical?{height:e.height}:{})),m=Ki((()=>e.vertical?{height:h.value,bottom:p.value}:{width:h.value,left:p.value})),g=()=>{a.value&&(t.sliderSize=a.value["client"+(e.vertical?"Height":"Width")])},v=n=>{const r=(n=>{const r=e.min+n*(e.max-e.min)/100;if(!e.range)return s;let i;return i=Math.abs(c.value-r)<Math.abs(d.value-r)?t.firstValue<t.secondValue?"firstButton":"secondButton":t.firstValue>t.secondValue?"firstButton":"secondButton",l[i]})(n);return r.value.setPosition(n),r},y=e=>{n(Tg,e),n(Eg,e)},_=async()=>{await en(),n(Mg,e.range?[c.value,d.value]:e.modelValue)},b=n=>{var r,i,s,o,l,c;if(u.value||t.dragging)return;g();let d=0;if(e.vertical){const e=null!=(s=null==(i=null==(r=n.touches)?void 0:r.item(0))?void 0:i.clientY)?s:n.clientY;d=(a.value.getBoundingClientRect().bottom-e)/t.sliderSize*100}else{d=((null!=(c=null==(l=null==(o=n.touches)?void 0:o.item(0))?void 0:l.clientX)?c:n.clientX)-a.value.getBoundingClientRect().left)/t.sliderSize*100}return d<0||d>100?void 0:v(d)};return{elFormItem:i,slider:a,firstButton:s,secondButton:o,sliderDisabled:u,minValue:c,maxValue:d,runwayStyle:f,barStyle:m,resetSize:g,setPosition:v,emitChange:_,onSliderWrapperPrevent:e=>{var t,n;((null==(t=l.firstButton.value)?void 0:t.dragging)||(null==(n=l.secondButton.value)?void 0:n.dragging))&&e.preventDefault()},onSliderClick:e=>{b(e)&&_()},onSliderDown:async e=>{const t=b(e);t&&(await en(),t.value.onButtonDown(e))},setFirstValue:n=>{t.firstValue=n,y(e.range?[c.value,d.value]:n)},setSecondValue:n=>{t.secondValue=n,e.range&&y([c.value,d.value])}}},{left:LN,down:kN,right:DN,up:IN,home:ON,end:NN,pageUp:BN,pageDown:UN}=Sg,zN=(e,t,n)=>{const{disabled:r,min:i,max:a,step:s,showTooltip:o,precision:l,sliderSize:u,formatTooltip:c,emitChange:d,resetSize:h,updateDragging:p}=Sn(MN),{tooltip:f,tooltipVisible:m,formatValue:g,displayTooltip:v,hideTooltip:y}=((e,t,n)=>{const r=At(),i=At(!1),a=Ki((()=>t.value instanceof Function)),s=Ki((()=>a.value&&t.value(e.modelValue)||e.modelValue)),o=gh((()=>{n.value&&(i.value=!0)}),50),l=gh((()=>{n.value&&(i.value=!1)}),50);return{tooltip:r,tooltipVisible:i,formatValue:s,displayTooltip:o,hideTooltip:l}})(e,c,o),_=At(),b=Ki((()=>(e.modelValue-i.value)/(a.value-i.value)*100+"%")),x=Ki((()=>e.vertical?{bottom:b.value}:{left:b.value})),w=e=>{r.value||(t.newPosition=Number.parseFloat(b.value)+e/(a.value-i.value)*100,E(t.newPosition),d())},S=e=>{let t,n;return e.type.startsWith("touch")?(n=e.touches[0].clientY,t=e.touches[0].clientX):(n=e.clientY,t=e.clientX),{clientX:t,clientY:n}},C=n=>{t.dragging=!0,t.isClick=!0;const{clientX:r,clientY:i}=S(n);e.vertical?t.startY=i:t.startX=r,t.startPosition=Number.parseFloat(b.value),t.newPosition=t.startPosition},T=n=>{if(t.dragging){let r;t.isClick=!1,v(),h();const{clientX:i,clientY:a}=S(n);e.vertical?(t.currentY=a,r=(t.startY-t.currentY)/u.value*100):(t.currentX=i,r=(t.currentX-t.startX)/u.value*100),t.newPosition=t.startPosition+r,E(t.newPosition)}},M=()=>{t.dragging&&(setTimeout((()=>{t.dragging=!1,t.hovering||y(),t.isClick||E(t.newPosition),d()}),0),window.removeEventListener("mousemove",T),window.removeEventListener("touchmove",T),window.removeEventListener("mouseup",M),window.removeEventListener("touchend",M),window.removeEventListener("contextmenu",M))},E=async r=>{if(null===r||Number.isNaN(+r))return;r<0?r=0:r>100&&(r=100);const o=100/((a.value-i.value)/s.value);let u=Math.round(r/o)*o*(a.value-i.value)*.01+i.value;u=Number.parseFloat(u.toFixed(l.value)),u!==e.modelValue&&n(Tg,u),t.dragging||e.modelValue===t.oldValue||(t.oldValue=e.modelValue),await en(),t.dragging&&v(),f.value.updatePopper()};return Mn((()=>t.dragging),(e=>{p(e)})),{disabled:r,button:_,tooltip:f,tooltipVisible:m,showTooltip:o,wrapperStyle:x,formatValue:g,handleMouseEnter:()=>{t.hovering=!0,v()},handleMouseLeave:()=>{t.hovering=!1,t.dragging||y()},onButtonDown:e=>{r.value||(e.preventDefault(),C(e),window.addEventListener("mousemove",T),window.addEventListener("touchmove",T),window.addEventListener("mouseup",M),window.addEventListener("touchend",M),window.addEventListener("contextmenu",M),_.value.focus())},onKeyDown:e=>{let t=!0;[LN,kN].includes(e.key)?w(-s.value):[DN,IN].includes(e.key)?w(s.value):e.key===ON?r.value||(E(0),d()):e.key===NN?r.value||(E(100),d()):e.key===UN?w(4*-s.value):e.key===BN?w(4*s.value):t=!1,t&&e.preventDefault()},setPosition:E}},FN=pg({modelValue:{type:Number,default:0},vertical:Boolean,tooltipClass:String,placement:{type:String,values:wv,default:"top"}}),VN={[Tg]:e=>Bs(e)},GN=["tabindex"],HN=Fn({name:"ElSliderButton"});var jN=J_(Fn({...HN,props:FN,emits:VN,setup(e,{expose:t,emit:n}){const i=e,a=rv("slider"),s=pt({hovering:!1,dragging:!1,isClick:!1,startX:0,currentX:0,startY:0,currentY:0,startPosition:0,newPosition:0,oldValue:i.modelValue}),{disabled:o,button:u,tooltip:c,showTooltip:d,tooltipVisible:h,wrapperStyle:p,formatValue:m,handleMouseEnter:g,handleMouseLeave:v,onButtonDown:y,onKeyDown:_,setPosition:b}=zN(i,s,n),{hovering:x,dragging:w}=Nt(s);return t({onButtonDown:y,onKeyDown:_,setPosition:b,hovering:x,dragging:w}),(e,t)=>(fi(),yi("div",{ref_key:"button",ref:u,class:l([Dt(a).e("button-wrapper"),{hover:Dt(x),dragging:Dt(w)}]),style:r(Dt(p)),tabindex:Dt(o)?-1:0,onMouseenter:t[0]||(t[0]=(...e)=>Dt(g)&&Dt(g)(...e)),onMouseleave:t[1]||(t[1]=(...e)=>Dt(v)&&Dt(v)(...e)),onMousedown:t[2]||(t[2]=(...e)=>Dt(y)&&Dt(y)(...e)),onTouchstart:t[3]||(t[3]=(...e)=>Dt(y)&&Dt(y)(...e)),onFocus:t[4]||(t[4]=(...e)=>Dt(g)&&Dt(g)(...e)),onBlur:t[5]||(t[5]=(...e)=>Dt(v)&&Dt(v)(...e)),onKeydown:t[6]||(t[6]=(...e)=>Dt(_)&&Dt(_)(...e))},[Mi(Dt(Ow),{ref_key:"tooltip",ref:c,visible:Dt(h),placement:e.placement,"fallback-placements":["top","bottom","right","left"],"stop-popper-mouse-event":!1,"popper-class":e.tooltipClass,disabled:!Dt(d),persistent:""},{content:vn((()=>[Ti("span",null,f(Dt(m)),1)])),default:vn((()=>[Ti("div",{class:l([Dt(a).e("button"),{hover:Dt(x),dragging:Dt(w)}])},null,2)])),_:1},8,["visible","placement","popper-class","disabled"])],46,GN))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/slider/src/button.vue"]]);var WN=Fn({name:"ElSliderMarker",props:pg({mark:{type:[String,Object],default:void 0}}),setup(e){const t=rv("slider"),n=Ki((()=>D(e.mark)?e.mark:e.mark.label)),r=Ki((()=>D(e.mark)?void 0:e.mark.style));return()=>ea("div",{class:t.e("marks-text"),style:r.value},n.value)}});const YN=["id","role","aria-label","aria-labelledby"],$N={key:1},XN=Fn({name:"ElSlider"}),qN=Fn({...XN,props:EN,emits:PN,setup(e,{expose:t,emit:n}){const i=e,a=rv("slider"),{t:s}=Jg(),o=pt({firstValue:0,secondValue:0,oldValue:0,dragging:!1,sliderSize:1}),{elFormItem:u,slider:c,firstButton:d,secondButton:h,sliderDisabled:p,minValue:f,maxValue:m,runwayStyle:g,barStyle:v,resetSize:y,emitChange:_,onSliderWrapperPrevent:b,onSliderClick:x,onSliderDown:w,setFirstValue:S,setSecondValue:C}=RN(i,o,n),{stops:T,getStopStyle:M}=((e,t,n,r)=>({stops:Ki((()=>{if(!e.showStops||e.min>e.max)return[];if(0===e.step)return[];const i=(e.max-e.min)/e.step,a=100*e.step/(e.max-e.min),s=Array.from({length:i-1}).map(((e,t)=>(t+1)*a));return e.range?s.filter((t=>t<100*(n.value-e.min)/(e.max-e.min)||t>100*(r.value-e.min)/(e.max-e.min))):s.filter((n=>n>100*(t.firstValue-e.min)/(e.max-e.min)))})),getStopStyle:t=>e.vertical?{bottom:`${t}%`}:{left:`${t}%`}}))(i,o,f,m),{inputId:E,isLabeledByFormItem:A}=fb(i,{formItemContext:u}),P=db(),R=Ki((()=>i.inputSize||P.value)),L=Ki((()=>i.label||s("el.slider.defaultLabel",{min:i.min,max:i.max}))),k=Ki((()=>i.range?i.rangeStartLabel||s("el.slider.defaultRangeStartLabel"):L.value)),D=Ki((()=>i.formatValueText?i.formatValueText(F.value):`${F.value}`)),I=Ki((()=>i.rangeEndLabel||s("el.slider.defaultRangeEndLabel"))),O=Ki((()=>i.formatValueText?i.formatValueText(V.value):`${V.value}`)),N=Ki((()=>[a.b(),a.m(P.value),a.is("vertical",i.vertical),{[a.m("with-input")]:i.showInput}])),B=(e=>Ki((()=>e.marks?Object.keys(e.marks).map(Number.parseFloat).sort(((e,t)=>e-t)).filter((t=>t<=e.max&&t>=e.min)).map((t=>({point:t,position:100*(t-e.min)/(e.max-e.min),mark:e.marks[t]}))):[])))(i);((e,t,n,r,i,a)=>{const s=e=>{i(Tg,e),i(Eg,e)},o=()=>e.range?![n.value,r.value].every(((e,n)=>e===t.oldValue[n])):e.modelValue!==t.oldValue,l=()=>{var n,r;e.min>e.max&&Wh("Slider","min should not be greater than max.");const i=e.modelValue;e.range&&Array.isArray(i)?i[1]<e.min?s([e.min,e.min]):i[0]>e.max?s([e.max,e.max]):i[0]<e.min?s([e.min,i[1]]):i[1]>e.max?s([i[0],e.max]):(t.firstValue=i[0],t.secondValue=i[1],o()&&(e.validateEvent&&(null==(n=null==a?void 0:a.validate)||n.call(a,"change").catch((e=>{}))),t.oldValue=i.slice())):e.range||"number"!=typeof i||Number.isNaN(i)||(i<e.min?s(e.min):i>e.max?s(e.max):(t.firstValue=i,o()&&(e.validateEvent&&(null==(r=null==a?void 0:a.validate)||r.call(a,"change").catch((e=>{}))),t.oldValue=i)))};l(),Mn((()=>t.dragging),(e=>{e||l()})),Mn((()=>e.modelValue),((e,n)=>{t.dragging||Array.isArray(e)&&Array.isArray(n)&&e.every(((e,t)=>e===n[t]))&&t.firstValue===e[0]&&t.secondValue===e[1]||l()}),{deep:!0}),Mn((()=>[e.min,e.max]),(()=>{l()}))})(i,o,f,m,n,u);const U=Ki((()=>{const e=[i.min,i.max,i.step].map((e=>{const t=`${e}`.split(".")[1];return t?t.length:0}));return Math.max.apply(null,e)})),{sliderWrapper:z}=((e,t,n)=>{const r=At();return Kn((async()=>{e.range?(Array.isArray(e.modelValue)?(t.firstValue=Math.max(e.min,e.modelValue[0]),t.secondValue=Math.min(e.max,e.modelValue[1])):(t.firstValue=e.min,t.secondValue=e.max),t.oldValue=[t.firstValue,t.secondValue]):("number"!=typeof e.modelValue||Number.isNaN(e.modelValue)?t.firstValue=e.min:t.firstValue=Math.min(e.max,Math.max(e.min,e.modelValue)),t.oldValue=t.firstValue),Zs(window,"resize",n),await en(),n()})),{sliderWrapper:r}})(i,o,y),{firstValue:F,secondValue:V,sliderSize:G}=Nt(o);return wn(MN,{...Nt(i),sliderSize:G,disabled:p,precision:U,emitChange:_,resetSize:y,updateDragging:e=>{o.dragging=e}}),t({onSliderClick:x}),(e,t)=>{var n,i;return fi(),yi("div",{id:e.range?Dt(E):void 0,ref_key:"sliderWrapper",ref:z,class:l(Dt(N)),role:e.range?"group":void 0,"aria-label":e.range&&!Dt(A)?Dt(L):void 0,"aria-labelledby":e.range&&Dt(A)?null==(n=Dt(u))?void 0:n.labelId:void 0,onTouchstart:t[2]||(t[2]=(...e)=>Dt(b)&&Dt(b)(...e)),onTouchmove:t[3]||(t[3]=(...e)=>Dt(b)&&Dt(b)(...e))},[Ti("div",{ref_key:"slider",ref:c,class:l([Dt(a).e("runway"),{"show-input":e.showInput&&!e.range},Dt(a).is("disabled",Dt(p))]),style:r(Dt(g)),onMousedown:t[0]||(t[0]=(...e)=>Dt(w)&&Dt(w)(...e)),onTouchstart:t[1]||(t[1]=(...e)=>Dt(w)&&Dt(w)(...e))},[Ti("div",{class:l(Dt(a).e("bar")),style:r(Dt(v))},null,6),Mi(jN,{id:e.range?void 0:Dt(E),ref_key:"firstButton",ref:d,"model-value":Dt(F),vertical:e.vertical,"tooltip-class":e.tooltipClass,placement:e.placement,role:"slider","aria-label":e.range||!Dt(A)?Dt(k):void 0,"aria-labelledby":!e.range&&Dt(A)?null==(i=Dt(u))?void 0:i.labelId:void 0,"aria-valuemin":e.min,"aria-valuemax":e.range?Dt(V):e.max,"aria-valuenow":Dt(F),"aria-valuetext":Dt(D),"aria-orientation":e.vertical?"vertical":"horizontal","aria-disabled":Dt(p),"onUpdate:modelValue":Dt(S)},null,8,["id","model-value","vertical","tooltip-class","placement","aria-label","aria-labelledby","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"]),e.range?(fi(),_i(jN,{key:0,ref_key:"secondButton",ref:h,"model-value":Dt(V),vertical:e.vertical,"tooltip-class":e.tooltipClass,placement:e.placement,role:"slider","aria-label":Dt(I),"aria-valuemin":Dt(F),"aria-valuemax":e.max,"aria-valuenow":Dt(V),"aria-valuetext":Dt(O),"aria-orientation":e.vertical?"vertical":"horizontal","aria-disabled":Dt(p),"onUpdate:modelValue":Dt(C)},null,8,["model-value","vertical","tooltip-class","placement","aria-label","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"])):Li("v-if",!0),e.showStops?(fi(),yi("div",$N,[(fi(!0),yi(li,null,mr(Dt(T),((e,t)=>(fi(),yi("div",{key:t,class:l(Dt(a).e("stop")),style:r(Dt(M)(e))},null,6)))),128))])):Li("v-if",!0),Dt(B).length>0?(fi(),yi(li,{key:2},[Ti("div",null,[(fi(!0),yi(li,null,mr(Dt(B),((e,t)=>(fi(),yi("div",{key:t,style:r(Dt(M)(e.position)),class:l([Dt(a).e("stop"),Dt(a).e("marks-stop")])},null,6)))),128))]),Ti("div",{class:l(Dt(a).e("marks"))},[(fi(!0),yi(li,null,mr(Dt(B),((e,t)=>(fi(),_i(Dt(WN),{key:t,mark:e.mark,style:r(Dt(M)(e.position))},null,8,["mark","style"])))),128))],2)],64)):Li("v-if",!0)],38),e.showInput&&!e.range?(fi(),_i(Dt(kk),{key:0,ref:"input","model-value":Dt(F),class:l(Dt(a).e("input")),step:e.step,disabled:Dt(p),controls:e.showInputControls,min:e.min,max:e.max,debounce:e.debounce,size:Dt(R),"onUpdate:modelValue":Dt(S),onChange:Dt(_)},null,8,["model-value","class","step","disabled","controls","min","max","debounce","size","onUpdate:modelValue","onChange"])):Li("v-if",!0)],42,YN)}}});const KN=_g(J_(qN,[["__file","/home/runner/work/element-plus/element-plus/packages/components/slider/src/slider.vue"]])),ZN=Fn({name:"ElSpaceItem",props:pg({prefixCls:{type:String}}),setup(e,{slots:t}){const n=rv("space"),r=Ki((()=>`${e.prefixCls||n.b()}__item`));return()=>ea("div",{class:r.value},vr(t,"default"))}}),JN={small:8,default:12,large:16};const QN=_g(Fn({name:"ElSpace",props:pg({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},class:{type:[String,Object,Array],default:""},style:{type:[String,Array,Object],default:""},alignment:{type:String,default:"center"},prefixCls:{type:String},spacer:{type:[Object,String,Number,Array],default:null,validator:e=>bi(e)||Bs(e)||D(e)},wrap:Boolean,fill:Boolean,fillRatio:{type:Number,default:100},size:{type:[String,Array,Number],values:Pg,validator:e=>Bs(e)||E(e)&&2===e.length&&e.every(Bs)}}),setup(e,{slots:t}){const{classes:n,containerStyle:r,itemStyle:i}=function(e){const t=rv("space"),n=Ki((()=>[t.b(),t.m(e.direction),e.class])),r=At(0),i=At(0),a=Ki((()=>[e.wrap||e.fill?{flexWrap:"wrap",marginBottom:`-${i.value}px`}:{},{alignItems:e.alignment},e.style])),s=Ki((()=>[{paddingBottom:`${i.value}px`,marginRight:`${r.value}px`},e.fill?{flexGrow:1,minWidth:`${e.fillRatio}%`}:{}]));return Cn((()=>{const{size:t="small",wrap:n,direction:a,fill:s}=e;if(E(t)){const[e=0,n=0]=t;r.value=e,i.value=n}else{let e;e=Bs(t)?t:JN[t||"small"]||JN.small,(n||s)&&"horizontal"===a?r.value=i.value=e:"horizontal"===a?(r.value=e,i.value=0):(i.value=e,r.value=0)}})),{classes:n,containerStyle:a,itemStyle:s}}(e);function a(t,n="",r=[]){const{prefixCls:s}=e;return t.forEach(((e,t)=>{Dg(e)?E(e.children)&&e.children.forEach(((e,t)=>{Dg(e)&&E(e.children)?a(e.children,`${n+t}-`,r):r.push(Mi(ZN,{style:i.value,prefixCls:s,key:`nested-${n+t}`},{default:()=>[e]},kg.PROPS|kg.STYLE,["style","prefixCls"]))})):Ig(e)&&r.push(Mi(ZN,{style:i.value,prefixCls:s,key:`LoopKey${n+t}`},{default:()=>[e]},kg.PROPS|kg.STYLE,["style","prefixCls"]))})),r}return()=>{var s;const{spacer:o,direction:l}=e,u=vr(t,"default",{key:0},(()=>[]));if(0===(null!=(s=u.children)?s:[]).length)return null;if(E(u.children)){let e=a(u.children);if(o){const t=e.length-1;e=e.reduce(((e,n,r)=>{const a=[...e,n];return r!==t&&a.push(Mi("span",{style:[i.value,"vertical"===l?"width: 100%":null],key:r},[bi(o)?o:Pi(o,kg.TEXT)],kg.STYLE)),a}),[])}return Mi("div",{class:n.value,style:r.value},e,kg.STYLE|kg.CLASS)}return u.children}}})),eB=pg({decimalSeparator:{type:String,default:"."},groupSeparator:{type:String,default:","},precision:{type:Number,default:0},formatter:Function,value:{type:[Number,Object],default:0},prefix:String,suffix:String,title:String,valueStyle:{type:[String,Object,Array]}}),tB=Fn({name:"ElStatistic"});const nB=_g(J_(Fn({...tB,props:eB,setup(e,{expose:t}){const n=e,i=rv("statistic"),a=Ki((()=>{const{value:e,formatter:t,precision:r,decimalSeparator:i,groupSeparator:a}=n;if(k(t))return t(e);if(!Bs(e))return e;let[s,o=""]=String(e).split(".");return o=o.padEnd(r,"0").slice(0,r>0?r:0),s=s.replace(/\B(?=(\d{3})+(?!\d))/g,a),[s,o].join(o?i:"")}));return t({displayValue:a}),(e,t)=>(fi(),yi("div",{class:l(Dt(i).b())},[e.$slots.title||e.title?(fi(),yi("div",{key:0,class:l(Dt(i).e("head"))},[vr(e.$slots,"title",{},(()=>[Pi(f(e.title),1)]))],2)):Li("v-if",!0),Ti("div",{class:l(Dt(i).e("content"))},[e.$slots.prefix||e.prefix?(fi(),yi("div",{key:0,class:l(Dt(i).e("prefix"))},[vr(e.$slots,"prefix",{},(()=>[Ti("span",null,f(e.prefix),1)]))],2)):Li("v-if",!0),Ti("span",{class:l(Dt(i).e("number")),style:r(e.valueStyle)},f(Dt(a)),7),e.$slots.suffix||e.suffix?(fi(),yi("div",{key:1,class:l(Dt(i).e("suffix"))},[vr(e.$slots,"suffix",{},(()=>[Ti("span",null,f(e.suffix),1)]))],2)):Li("v-if",!0)],2)],2))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/statistic/src/statistic.vue"]])),rB=pg({format:{type:String,default:"HH:mm:ss"},prefix:String,suffix:String,title:String,value:{type:[Number,Object],default:0},valueStyle:{type:[String,Object,Array]}}),iB={finish:()=>!0,[Mg]:e=>Bs(e)},aB=[["Y",31536e6],["M",2592e6],["D",864e5],["H",36e5],["m",6e4],["s",1e3],["S",1]],sB=e=>Bs(e)?new Date(e).getTime():e.valueOf(),oB=(e,t)=>{let n=e;const r=aB.reduce(((e,[t,r])=>{const i=new RegExp(`${t}+(?![^\\[\\]]*\\])`,"g");if(i.test(e)){const t=Math.floor(n/r);return n-=t*r,e.replace(i,(e=>String(t).padStart(e.length,"0")))}return e}),t);return r.replace(/\[([^\]]*)]/g,"$1")},lB=Fn({name:"ElCountdown"}),uB=Fn({...lB,props:rB,emits:iB,setup(e,{expose:t,emit:n}){const r=e;let i;const a=At(sB(r.value)-Date.now()),s=Ki((()=>oB(a.value,r.format))),o=e=>oB(e,r.format),l=()=>{i&&(Vg(i),i=void 0)};return Mn((()=>[r.value,r.format]),(()=>{l(),(()=>{const e=sB(r.value),t=()=>{let r=e-Date.now();n("change",r),r<=0?(r=0,l(),n("finish")):i=Fg(t),a.value=r};i=Fg(t)})()}),{immediate:!0}),Qn((()=>{l()})),t({displayValue:s}),(e,t)=>(fi(),_i(Dt(nB),{value:a.value,title:e.title,prefix:e.prefix,suffix:e.suffix,"value-style":e.valueStyle,formatter:o},gr({_:2},[mr(e.$slots,((t,n)=>({name:n,fn:vn((()=>[vr(e.$slots,n)]))})))]),1032,["value","title","prefix","suffix","value-style"]))}});const cB=_g(J_(uB,[["__file","/home/runner/work/element-plus/element-plus/packages/components/countdown/src/countdown.vue"]])),dB=pg({space:{type:[Number,String],default:""},active:{type:Number,default:0},direction:{type:String,default:"horizontal",values:["horizontal","vertical"]},alignCenter:{type:Boolean},simple:{type:Boolean},finishStatus:{type:String,values:["wait","process","finish","error","success"],default:"finish"},processStatus:{type:String,values:["wait","process","finish","error","success"],default:"process"}}),hB={[Mg]:(e,t)=>[e,t].every(Bs)},pB=Fn({name:"ElSteps"});var fB=J_(Fn({...pB,props:dB,emits:hB,setup(e,{emit:t}){const n=e,r=rv("steps"),i=At([]);return Mn(i,(()=>{i.value.forEach(((e,t)=>{e.setIndex(t)}))})),wn("ElSteps",{props:n,steps:i}),Mn((()=>n.active),((e,n)=>{t(Mg,e,n)})),(e,t)=>(fi(),yi("div",{class:l([Dt(r).b(),Dt(r).m(e.simple?"simple":e.direction)])},[vr(e.$slots,"default")],2))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/steps/src/steps.vue"]]);const mB=pg({title:{type:String,default:""},icon:{type:fg},description:{type:String,default:""},status:{type:String,values:["","wait","process","finish","error","success"],default:""}}),gB=Fn({name:"ElStep"});var vB=J_(Fn({...gB,props:mB,setup(e){const t=e,n=rv("step"),i=At(-1),a=At({}),s=At(""),o=Sn("ElSteps"),u=Fi();Kn((()=>{Mn([()=>o.props.active,()=>o.props.processStatus,()=>o.props.finishStatus],(([e])=>{b(e)}),{immediate:!0})})),Qn((()=>{o.steps.value=o.steps.value.filter((e=>e.uid!==(null==u?void 0:u.uid)))}));const c=Ki((()=>t.status||s.value)),d=Ki((()=>{const e=o.steps.value[i.value-1];return e?e.currentStatus:"wait"})),h=Ki((()=>o.props.alignCenter)),p=Ki((()=>"vertical"===o.props.direction)),m=Ki((()=>o.props.simple)),g=Ki((()=>o.steps.value.length)),v=Ki((()=>{var e;return(null==(e=o.steps.value[g.value-1])?void 0:e.uid)===(null==u?void 0:u.uid)})),y=Ki((()=>m.value?"":o.props.space)),_=Ki((()=>{const e={flexBasis:Bs(y.value)?`${y.value}px`:y.value?y.value:100/(g.value-(h.value?0:1))+"%"};return p.value||v.value&&(e.maxWidth=100/g.value+"%"),e})),b=e=>{e>i.value?s.value=o.props.finishStatus:e===i.value&&"error"!==d.value?s.value=o.props.processStatus:s.value="wait";const t=o.steps.value[i.value-1];t&&t.calcProgress(s.value)},x=pt({uid:Ki((()=>null==u?void 0:u.uid)),currentStatus:c,setIndex:e=>{i.value=e},calcProgress:e=>{const t="wait"===e,n={transitionDelay:`${t?"-":""}${150*i.value}ms`},r=e===o.props.processStatus||t?0:100;n.borderWidth=r&&!m.value?"1px":0,n["vertical"===o.props.direction?"height":"width"]=`${r}%`,a.value=n}});return o.steps.value=[...o.steps.value,x],(e,t)=>(fi(),yi("div",{style:r(Dt(_)),class:l([Dt(n).b(),Dt(n).is(Dt(m)?"simple":Dt(o).props.direction),Dt(n).is("flex",Dt(v)&&!Dt(y)&&!Dt(h)),Dt(n).is("center",Dt(h)&&!Dt(p)&&!Dt(m))])},[Li(" icon & line "),Ti("div",{class:l([Dt(n).e("head"),Dt(n).is(Dt(c))])},[Dt(m)?Li("v-if",!0):(fi(),yi("div",{key:0,class:l(Dt(n).e("line"))},[Ti("i",{class:l(Dt(n).e("line-inner")),style:r(a.value)},null,6)],2)),Ti("div",{class:l([Dt(n).e("icon"),Dt(n).is(e.icon||e.$slots.icon?"icon":"text")])},[vr(e.$slots,"icon",{},(()=>[e.icon?(fi(),_i(Dt(ib),{key:0,class:l(Dt(n).e("icon-inner"))},{default:vn((()=>[(fi(),_i(dr(e.icon)))])),_:1},8,["class"])):"success"===Dt(c)?(fi(),_i(Dt(ib),{key:1,class:l([Dt(n).e("icon-inner"),Dt(n).is("status")])},{default:vn((()=>[Mi(Dt(zp))])),_:1},8,["class"])):"error"===Dt(c)?(fi(),_i(Dt(ib),{key:2,class:l([Dt(n).e("icon-inner"),Dt(n).is("status")])},{default:vn((()=>[Mi(Dt(cf))])),_:1},8,["class"])):Dt(m)?Li("v-if",!0):(fi(),yi("div",{key:3,class:l(Dt(n).e("icon-inner"))},f(i.value+1),3))]))],2)],2),Li(" title & description "),Ti("div",{class:l(Dt(n).e("main"))},[Ti("div",{class:l([Dt(n).e("title"),Dt(n).is(Dt(c))])},[vr(e.$slots,"title",{},(()=>[Pi(f(e.title),1)]))],2),Dt(m)?(fi(),yi("div",{key:0,class:l(Dt(n).e("arrow"))},null,2)):(fi(),yi("div",{key:1,class:l([Dt(n).e("description"),Dt(n).is(Dt(c))])},[vr(e.$slots,"description",{},(()=>[Pi(f(e.description),1)]))],2))],2)],6))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/steps/src/item.vue"]]);const yB=_g(fB,{Step:vB}),_B=xg(vB),bB=pg({modelValue:{type:[Boolean,String,Number],default:!1},value:{type:[Boolean,String,Number],default:!1},disabled:{type:Boolean,default:!1},width:{type:[String,Number],default:""},inlinePrompt:{type:Boolean,default:!1},activeIcon:{type:fg},inactiveIcon:{type:fg},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeColor:{type:String,default:""},inactiveColor:{type:String,default:""},borderColor:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},id:String,loading:{type:Boolean,default:!1},beforeChange:{type:Function},size:{type:String,validator:Lg},tabindex:{type:[String,Number]}}),xB={[Tg]:e=>Ns(e)||D(e)||Bs(e),[Mg]:e=>Ns(e)||D(e)||Bs(e),[Eg]:e=>Ns(e)||D(e)||Bs(e)},wB=["onClick"],SB=["id","aria-checked","aria-disabled","name","true-value","false-value","disabled","tabindex","onKeydown"],CB=["aria-hidden"],TB=["aria-hidden"],MB=["aria-hidden"],EB="ElSwitch",AB=Fn({name:EB});const PB=_g(J_(Fn({...AB,props:bB,emits:xB,setup(e,{expose:t,emit:n}){const i=e,a=Fi(),{formItem:s}=pb(),o=db(),u=rv("switch");Yg({from:'"value"',replacement:'"model-value" or "v-model"',scope:EB,version:"2.3.0",ref:"https://element-plus.org/en-US/component/switch.html#attributes",type:"Attribute"},Ki((()=>{var e;return!!(null==(e=a.vnode.props)?void 0:e.value)})));const{inputId:c}=fb(i,{formItemContext:s}),d=hb(Ki((()=>i.loading))),h=At(!1!==i.modelValue),p=At(),m=At(),g=Ki((()=>[u.b(),u.m(o.value),u.is("disabled",d.value),u.is("checked",_.value)])),v=Ki((()=>({width:Zh(i.width)})));Mn((()=>i.modelValue),(()=>{h.value=!0})),Mn((()=>i.value),(()=>{h.value=!1}));const y=Ki((()=>h.value?i.modelValue:i.value)),_=Ki((()=>y.value===i.activeValue));[i.activeValue,i.inactiveValue].includes(y.value)||(n(Tg,i.inactiveValue),n(Mg,i.inactiveValue),n(Eg,i.inactiveValue)),Mn(_,(e=>{var t;p.value.checked=e,i.validateEvent&&(null==(t=null==s?void 0:s.validate)||t.call(s,"change").catch((e=>{})))}));const b=()=>{const e=_.value?i.inactiveValue:i.activeValue;n(Tg,e),n(Mg,e),n(Eg,e),en((()=>{p.value.checked=_.value}))},x=()=>{if(d.value)return;const{beforeChange:e}=i;if(!e)return void b();const t=e();[N(t),Ns(t)].includes(!0)||Wh(EB,"beforeChange must return type `Promise<boolean>` or `boolean`"),N(t)?t.then((e=>{e&&b()})).catch((e=>{})):t&&b()},w=Ki((()=>u.cssVarBlock({...i.activeColor?{"on-color":i.activeColor}:null,...i.inactiveColor?{"off-color":i.inactiveColor}:null,...i.borderColor?{"border-color":i.borderColor}:null})));return Kn((()=>{p.value.checked=_.value})),t({focus:()=>{var e,t;null==(t=null==(e=p.value)?void 0:e.focus)||t.call(e)},checked:_}),(e,t)=>(fi(),yi("div",{class:l(Dt(g)),style:r(Dt(w)),onClick:ts(x,["prevent"])},[Ti("input",{id:Dt(c),ref_key:"input",ref:p,class:l(Dt(u).e("input")),type:"checkbox",role:"switch","aria-checked":Dt(_),"aria-disabled":Dt(d),name:e.name,"true-value":e.activeValue,"false-value":e.inactiveValue,disabled:Dt(d),tabindex:e.tabindex,onChange:b,onKeydown:rs(x,["enter"])},null,42,SB),e.inlinePrompt||!e.inactiveIcon&&!e.inactiveText?Li("v-if",!0):(fi(),yi("span",{key:0,class:l([Dt(u).e("label"),Dt(u).em("label","left"),Dt(u).is("active",!Dt(_))])},[e.inactiveIcon?(fi(),_i(Dt(ib),{key:0},{default:vn((()=>[(fi(),_i(dr(e.inactiveIcon)))])),_:1})):Li("v-if",!0),!e.inactiveIcon&&e.inactiveText?(fi(),yi("span",{key:1,"aria-hidden":Dt(_)},f(e.inactiveText),9,CB)):Li("v-if",!0)],2)),Ti("span",{ref_key:"core",ref:m,class:l(Dt(u).e("core")),style:r(Dt(v))},[e.inlinePrompt?(fi(),yi("div",{key:0,class:l(Dt(u).e("inner"))},[e.activeIcon||e.inactiveIcon?(fi(),_i(Dt(ib),{key:0,class:l(Dt(u).is("icon"))},{default:vn((()=>[(fi(),_i(dr(Dt(_)?e.activeIcon:e.inactiveIcon)))])),_:1},8,["class"])):e.activeText||e.inactiveText?(fi(),yi("span",{key:1,class:l(Dt(u).is("text")),"aria-hidden":!Dt(_)},f(Dt(_)?e.activeText:e.inactiveText),11,TB)):Li("v-if",!0)],2)):Li("v-if",!0),Ti("div",{class:l(Dt(u).e("action"))},[e.loading?(fi(),_i(Dt(ib),{key:0,class:l(Dt(u).is("loading"))},{default:vn((()=>[Mi(Dt(Gf))])),_:1},8,["class"])):Li("v-if",!0)],2)],6),e.inlinePrompt||!e.activeIcon&&!e.activeText?Li("v-if",!0):(fi(),yi("span",{key:1,class:l([Dt(u).e("label"),Dt(u).em("label","right"),Dt(u).is("active",Dt(_))])},[e.activeIcon?(fi(),_i(Dt(ib),{key:0},{default:vn((()=>[(fi(),_i(dr(e.activeIcon)))])),_:1})):Li("v-if",!0),!e.activeIcon&&e.activeText?(fi(),yi("span",{key:1,"aria-hidden":!Dt(_)},f(e.activeText),9,MB)):Li("v-if",!0)],2))],14,wB))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/switch/src/switch.vue"]]));
/*!
 * escape-html
 * Copyright(c) 2012-2013 TJ Holowaychuk
 * Copyright(c) 2015 Andreas Lubbe
 * Copyright(c) 2015 Tiancheng "Timothy" Gu
 * MIT Licensed
 */var RB=/["'&<>]/,LB=function(e){var t,n=""+e,r=RB.exec(n);if(!r)return n;var i="",a=0,s=0;for(a=r.index;a<n.length;a++){switch(n.charCodeAt(a)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#39;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}s!==a&&(i+=n.substring(s,a)),s=a+1,i+=t}return s!==a?i+n.substring(s,a):i};const kB=function(e){var t;return null==(t=e.target)?void 0:t.closest("td")},DB=function(e,t,n,r,i){if(!t&&!r&&(!i||Array.isArray(i)&&!i.length))return e;n="string"==typeof n?"descending"===n?-1:1:n&&n<0?-1:1;const a=r?null:function(n,r){return i?(Array.isArray(i)||(i=[i]),i.map((t=>"string"==typeof t?Vu(n,t):t(n,r,e)))):("$key"!==t&&O(n)&&"$value"in n&&(n=n.$value),[O(n)?Vu(n,t):n])};return e.map(((e,t)=>({value:e,index:t,key:a?a(e,t):null}))).sort(((e,t)=>{let i=function(e,t){if(r)return r(e.value,t.value);for(let n=0,r=e.key.length;n<r;n++){if(e.key[n]<t.key[n])return-1;if(e.key[n]>t.key[n])return 1}return 0}(e,t);return i||(i=e.index-t.index),i*+n})).map((e=>e.value))},IB=function(e,t){let n=null;return e.columns.forEach((e=>{e.id===t&&(n=e)})),n},OB=function(e,t){let n=null;for(let r=0;r<e.columns.length;r++){const i=e.columns[r];if(i.columnKey===t){n=i;break}}return n||Wh("ElTable",`No column matching with column-key: ${t}`),n},NB=function(e,t,n){const r=(t.className||"").match(new RegExp(`${n}-table_[^\\s]+`,"gm"));return r?IB(e,r[0]):null},BB=(e,t)=>{if(!e)throw new Error("Row is required when get row identity");if("string"==typeof t){if(!t.includes("."))return`${e[t]}`;const n=t.split(".");let r=e;for(const e of n)r=r[e];return`${r}`}if("function"==typeof t)return t.call(null,e)},UB=function(e,t){const n={};return(e||[]).forEach(((e,r)=>{n[BB(e,t)]={row:e,index:r}})),n};function zB(e){return""===e||void 0!==e&&(e=Number.parseInt(e,10),Number.isNaN(e)&&(e="")),e}function FB(e){return""===e||void 0!==e&&(e=zB(e),Number.isNaN(e)&&(e=80)),e}function VB(e,t,n){let r=!1;const i=e.indexOf(t),a=-1!==i,s=s=>{"add"===s?e.push(t):e.splice(i,1),r=!0,E(t.children)&&t.children.forEach((t=>{VB(e,t,null!=n?n:!a)}))};return Ns(n)?n&&!a?s("add"):!n&&a&&s("remove"):s(a?"remove":"add"),r}function GB(e,t,n="children",r="hasChildren"){const i=e=>!(Array.isArray(e)&&e.length);function a(e,s,o){t(e,s,o),s.forEach((e=>{if(e[r])return void t(e,null,o+1);const s=e[n];i(s)||a(e,s,o+1)}))}e.forEach((e=>{if(e[r])return void t(e,null,0);const s=e[n];i(s)||a(e,s,0)}))}let HB;function jB(e){return e.children?Ch(e.children,jB):[e]}function WB(e,t){return e+t.colSpan}const YB=(e,t,n,r)=>{let i=0,a=e;const s=n.states.columns.value;if(r){const t=jB(r[e]);i=s.slice(0,s.indexOf(t[0])).reduce(WB,0),a=i+t.reduce(WB,0)-1}else i=e;let o;switch(t){case"left":a<n.states.fixedLeafColumnsLength.value&&(o="left");break;case"right":i>=s.length-n.states.rightFixedLeafColumnsLength.value&&(o="right");break;default:a<n.states.fixedLeafColumnsLength.value?o="left":i>=s.length-n.states.rightFixedLeafColumnsLength.value&&(o="right")}return o?{direction:o,start:i,after:a}:{}},$B=(e,t,n,r,i,a=0)=>{const s=[],{direction:o,start:l,after:u}=YB(t,n,r,i);if(o){const t="left"===o;s.push(`${e}-fixed-column--${o}`),t&&u+a===r.states.fixedLeafColumnsLength.value-1?s.push("is-last-column"):t||l-a!=r.states.columns.value.length-r.states.rightFixedLeafColumnsLength.value||s.push("is-first-column")}return s};function XB(e,t){return e+(null===t.realWidth||Number.isNaN(t.realWidth)?Number(t.width):t.realWidth)}const qB=(e,t,n,r)=>{const{direction:i,start:a=0,after:s=0}=YB(e,t,n,r);if(!i)return;const o={},l="left"===i,u=n.states.columns.value;return l?o.left=u.slice(0,a).reduce(XB,0):o.right=u.slice(s+1).reverse().reduce(XB,0),o},KB=(e,t)=>{e&&(Number.isNaN(e[t])||(e[t]=`${e[t]}px`))};const ZB=(e,t)=>{const n=t.sortingColumn;return n&&"string"!=typeof n.sortable?DB(e,t.sortProp,t.sortOrder,n.sortMethod,n.sortBy):e},JB=e=>{const t=[];return e.forEach((e=>{e.children?t.push.apply(t,JB(e.children)):t.push(e)})),t};function QB(){var e;const t=Fi(),{size:n}=Nt(null==(e=t.proxy)?void 0:e.$props),r=At(null),i=At([]),a=At([]),s=At(!1),o=At([]),l=At([]),u=At([]),c=At([]),d=At([]),h=At([]),p=At([]),f=At([]),m=At(0),g=At(0),v=At(0),y=At(!1),_=At([]),b=At(!1),x=At(!1),w=At(null),S=At({}),C=At(null),T=At(null),E=At(null),A=At(null),P=At(null);Mn(i,(()=>t.state&&k(!1)),{deep:!0});const R=e=>{var t;null==(t=e.children)||t.forEach((t=>{t.fixed=e.fixed,R(t)}))},L=()=>{o.value.forEach((e=>{R(e)})),c.value=o.value.filter((e=>!0===e.fixed||"left"===e.fixed)),d.value=o.value.filter((e=>"right"===e.fixed)),c.value.length>0&&o.value[0]&&"selection"===o.value[0].type&&!o.value[0].fixed&&(o.value[0].fixed=!0,c.value.unshift(o.value[0]));const e=o.value.filter((e=>!e.fixed));l.value=[].concat(c.value).concat(e).concat(d.value);const t=JB(e),n=JB(c.value),r=JB(d.value);m.value=t.length,g.value=n.length,v.value=r.length,u.value=[].concat(n).concat(t).concat(r),s.value=c.value.length>0||d.value.length>0},k=(e,n=!1)=>{e&&L(),n?t.state.doLayout():t.state.debouncedUpdateLayout()},D=e=>{var n;if(!t||!t.store)return 0;const{treeData:r}=t.store.states;let i=0;const a=null==(n=r.value[e])?void 0:n.children;return a&&(i+=a.length,a.forEach((e=>{i+=D(e)}))),i},I=(e,t,n)=>{T.value&&T.value!==e&&(T.value.order=null),T.value=e,E.value=t,A.value=n},O=()=>{let e=Dt(a);Object.keys(S.value).forEach((t=>{const n=S.value[t];if(!n||0===n.length)return;const r=IB({columns:u.value},t);r&&r.filterMethod&&(e=e.filter((e=>n.some((t=>r.filterMethod.call(null,t,e,r))))))})),C.value=e},N=()=>{i.value=ZB(C.value,{sortingColumn:T.value,sortProp:E.value,sortOrder:A.value})},{setExpandRowKeys:B,toggleRowExpansion:U,updateExpandRows:z,states:F,isRowExpanded:V}=function(e){const t=Fi(),n=At(!1),r=At([]);return{updateExpandRows:()=>{const t=e.data.value||[],i=e.rowKey.value;if(n.value)r.value=t.slice();else if(i){const e=UB(r.value,i);r.value=t.reduce(((t,n)=>{const r=BB(n,i);return e[r]&&t.push(n),t}),[])}else r.value=[]},toggleRowExpansion:(e,n)=>{VB(r.value,e,n)&&t.emit("expand-change",e,r.value.slice())},setExpandRowKeys:n=>{t.store.assertRowKey();const i=e.data.value||[],a=e.rowKey.value,s=UB(i,a);r.value=n.reduce(((e,t)=>{const n=s[t];return n&&e.push(n.row),e}),[])},isRowExpanded:t=>{const n=e.rowKey.value;return n?!!UB(r.value,n)[BB(t,n)]:r.value.includes(t)},states:{expandRows:r,defaultExpandAll:n}}}({data:i,rowKey:r}),{updateTreeExpandKeys:G,toggleTreeExpansion:H,updateTreeData:j,loadOrToggle:W,states:Y}=function(e){const t=At([]),n=At({}),r=At(16),i=At(!1),a=At({}),s=At("hasChildren"),o=At("children"),l=Fi(),u=Ki((()=>{if(!e.rowKey.value)return{};const t=e.data.value||[];return d(t)})),c=Ki((()=>{const t=e.rowKey.value,n=Object.keys(a.value),r={};return n.length?(n.forEach((e=>{if(a.value[e].length){const n={children:[]};a.value[e].forEach((e=>{const i=BB(e,t);n.children.push(i),e[s.value]&&!r[i]&&(r[i]={children:[]})})),r[e]=n}})),r):r})),d=t=>{const n=e.rowKey.value,r={};return GB(t,((e,t,a)=>{const s=BB(e,n);Array.isArray(t)?r[s]={children:t.map((e=>BB(e,n))),level:a}:i.value&&(r[s]={children:[],lazy:!0,level:a})}),o.value,s.value),r},h=(e=!1,r=(e=>null==(e=l.store)?void 0:e.states.defaultExpandAll.value)())=>{var a;const s=u.value,o=c.value,d=Object.keys(s),h={};if(d.length){const a=Dt(n),l=[],u=(n,i)=>{if(e)return t.value?r||t.value.includes(i):!(!r&&!(null==n?void 0:n.expanded));{const e=r||t.value&&t.value.includes(i);return!(!(null==n?void 0:n.expanded)&&!e)}};d.forEach((e=>{const t=a[e],n={...s[e]};if(n.expanded=u(t,e),n.lazy){const{loaded:r=!1,loading:i=!1}=t||{};n.loaded=!!r,n.loading=!!i,l.push(e)}h[e]=n}));const c=Object.keys(o);i.value&&c.length&&l.length&&c.forEach((e=>{const t=a[e],n=o[e].children;if(l.includes(e)){if(0!==h[e].children.length)throw new Error("[ElTable]children must be an empty array.");h[e].children=n}else{const{loaded:r=!1,loading:i=!1}=t||{};h[e]={lazy:!0,loaded:!!r,loading:!!i,expanded:u(t,e),children:n,level:""}}}))}n.value=h,null==(a=l.store)||a.updateTableScrollY()};Mn((()=>t.value),(()=>{h(!0)})),Mn((()=>u.value),(()=>{h()})),Mn((()=>c.value),(()=>{h()}));const p=(t,r)=>{l.store.assertRowKey();const i=e.rowKey.value,a=BB(t,i),s=a&&n.value[a];if(a&&s&&"expanded"in s){const e=s.expanded;r=void 0===r?!s.expanded:r,n.value[a].expanded=r,e!==r&&l.emit("expand-change",t,r),l.store.updateTableScrollY()}},f=(e,t,r)=>{const{load:i}=l.props;i&&!n.value[t].loaded&&(n.value[t].loading=!0,i(e,r,(r=>{if(!Array.isArray(r))throw new TypeError("[ElTable] data must be an array");n.value[t].loading=!1,n.value[t].loaded=!0,n.value[t].expanded=!0,r.length&&(a.value[t]=r),l.emit("expand-change",e,!0)})))};return{loadData:f,loadOrToggle:t=>{l.store.assertRowKey();const r=e.rowKey.value,a=BB(t,r),s=n.value[a];i.value&&s&&"loaded"in s&&!s.loaded?f(t,a,s):p(t,void 0)},toggleTreeExpansion:p,updateTreeExpandKeys:e=>{t.value=e,h()},updateTreeData:h,normalize:d,states:{expandRowKeys:t,treeData:n,indent:r,lazy:i,lazyTreeNodeMap:a,lazyColumnIdentifier:s,childrenColumnName:o}}}({data:i,rowKey:r}),{updateCurrentRowData:$,updateCurrentRow:X,setCurrentRowKey:q,states:K}=function(e){const t=Fi(),n=At(null),r=At(null),i=()=>{n.value=null},a=n=>{const{data:i,rowKey:a}=e;let s=null;a.value&&(s=(Dt(i)||[]).find((e=>BB(e,a.value)===n))),r.value=s,t.emit("current-change",r.value,null)};return{setCurrentRowKey:e=>{t.store.assertRowKey(),n.value=e,a(e)},restoreCurrentRowKey:i,setCurrentRowByKey:a,updateCurrentRow:e=>{const n=r.value;if(e&&e!==n)return r.value=e,void t.emit("current-change",r.value,n);!e&&n&&(r.value=null,t.emit("current-change",null,n))},updateCurrentRowData:()=>{const s=e.rowKey.value,o=e.data.value||[],l=r.value;if(!o.includes(l)&&l){if(s){const e=BB(l,s);a(e)}else r.value=null;null===r.value&&t.emit("current-change",null,l)}else n.value&&(a(n.value),i())},states:{_currentRowKey:n,currentRow:r}}}({data:i,rowKey:r});return{assertRowKey:()=>{if(!r.value)throw new Error("[ElTable] prop row-key is required")},updateColumns:L,scheduleLayout:k,isSelected:e=>_.value.includes(e),clearSelection:()=>{y.value=!1;_.value.length&&(_.value=[],t.emit("selection-change",[]))},cleanSelection:()=>{let e;if(r.value){e=[];const t=UB(_.value,r.value),n=UB(i.value,r.value);for(const r in t)M(t,r)&&!n[r]&&e.push(t[r].row)}else e=_.value.filter((e=>!i.value.includes(e)));if(e.length){const n=_.value.filter((t=>!e.includes(t)));_.value=n,t.emit("selection-change",n.slice())}},getSelectionRows:()=>(_.value||[]).slice(),toggleRowSelection:(e,n=void 0,r=!0)=>{if(VB(_.value,e,n)){const n=(_.value||[]).slice();r&&t.emit("select",n,e),t.emit("selection-change",n)}},_toggleAllSelection:()=>{var e,n;const r=x.value?!y.value:!(y.value||_.value.length);y.value=r;let a=!1,s=0;const o=null==(n=null==(e=null==t?void 0:t.store)?void 0:e.states)?void 0:n.rowKey.value;i.value.forEach(((e,t)=>{const n=t+s;w.value?w.value.call(null,e,n)&&VB(_.value,e,r)&&(a=!0):VB(_.value,e,r)&&(a=!0),s+=D(BB(e,o))})),a&&t.emit("selection-change",_.value?_.value.slice():[]),t.emit("select-all",_.value)},toggleAllSelection:null,updateSelectionByRowKey:()=>{const e=UB(_.value,r.value);i.value.forEach((t=>{const n=BB(t,r.value),i=e[n];i&&(_.value[i.index]=t)}))},updateAllSelected:()=>{var e,n,a;if(0===(null==(e=i.value)?void 0:e.length))return void(y.value=!1);let s;r.value&&(s=UB(_.value,r.value));let o=!0,l=0,u=0;for(let d=0,h=(i.value||[]).length;d<h;d++){const e=null==(a=null==(n=null==t?void 0:t.store)?void 0:n.states)?void 0:a.rowKey.value,h=d+u,p=i.value[d],f=w.value&&w.value.call(null,p,h);if(c=p,s?s[BB(c,r.value)]:_.value.includes(c))l++;else if(!w.value||f){o=!1;break}u+=D(BB(p,e))}var c;0===l&&(o=!1),y.value=o},updateFilters:(e,t)=>{Array.isArray(e)||(e=[e]);const n={};return e.forEach((e=>{S.value[e.id]=t,n[e.columnKey||e.id]=t})),n},updateCurrentRow:X,updateSort:I,execFilter:O,execSort:N,execQuery:(e=void 0)=>{e&&e.filter||O(),N()},clearFilter:e=>{const{tableHeaderRef:n}=t.refs;if(!n)return;const r=Object.assign({},n.filterPanels),i=Object.keys(r);if(i.length)if("string"==typeof e&&(e=[e]),Array.isArray(e)){const n=e.map((e=>OB({columns:u.value},e)));i.forEach((e=>{const t=n.find((t=>t.id===e));t&&(t.filteredValue=[])})),t.store.commit("filterChange",{column:n,values:[],silent:!0,multi:!0})}else i.forEach((e=>{const t=u.value.find((t=>t.id===e));t&&(t.filteredValue=[])})),S.value={},t.store.commit("filterChange",{column:{},values:[],silent:!0})},clearSort:()=>{T.value&&(I(null,null,null),t.store.commit("changeSortCondition",{silent:!0}))},toggleRowExpansion:U,setExpandRowKeysAdapter:e=>{B(e),G(e)},setCurrentRowKey:q,toggleRowExpansionAdapter:(e,t)=>{u.value.some((({type:e})=>"expand"===e))?U(e,t):H(e,t)},isRowExpanded:V,updateExpandRows:z,updateCurrentRowData:$,loadOrToggle:W,updateTreeData:j,states:{tableSize:n,rowKey:r,data:i,_data:a,isComplex:s,_columns:o,originColumns:l,columns:u,fixedColumns:c,rightFixedColumns:d,leafColumns:h,fixedLeafColumns:p,rightFixedLeafColumns:f,updateOrderFns:[],leafColumnsLength:m,fixedLeafColumnsLength:g,rightFixedLeafColumnsLength:v,isAllSelected:y,selection:_,reserveSelection:b,selectOnIndeterminate:x,selectable:w,filters:S,filteredData:C,sortingColumn:T,sortProp:E,sortOrder:A,hoverRow:P,...F,...Y,...K}}}function eU(e,t){return e.map((e=>{var n;return e.id===t.id?t:((null==(n=e.children)?void 0:n.length)&&(e.children=eU(e.children,t)),e)}))}function tU(e){e.forEach((e=>{var t,n;e.no=null==(t=e.getColumnIndex)?void 0:t.call(e),(null==(n=e.children)?void 0:n.length)&&tU(e.children)})),e.sort(((e,t)=>e.no-t.no))}const nU={rowKey:"rowKey",defaultExpandAll:"defaultExpandAll",selectOnIndeterminate:"selectOnIndeterminate",indent:"indent",lazy:"lazy",data:"data","treeProps.hasChildren":{key:"lazyColumnIdentifier",default:"hasChildren"},"treeProps.children":{key:"childrenColumnName",default:"children"}};function rU(e,t){if(!e)throw new Error("Table is required.");const n=function(){const e=Fi(),t=QB();return{ns:rv("table"),...t,mutations:{setData(t,n){const r=Dt(t._data)!==n;t.data.value=n,t._data.value=n,e.store.execQuery(),e.store.updateCurrentRowData(),e.store.updateExpandRows(),e.store.updateTreeData(e.store.states.defaultExpandAll.value),Dt(t.reserveSelection)?(e.store.assertRowKey(),e.store.updateSelectionByRowKey()):r?e.store.clearSelection():e.store.cleanSelection(),e.store.updateAllSelected(),e.$ready&&e.store.scheduleLayout()},insertColumn(t,n,r,i){const a=Dt(t._columns);let s=[];r?(r&&!r.children&&(r.children=[]),r.children.push(n),s=eU(a,r)):(a.push(n),s=a),tU(s),t._columns.value=s,t.updateOrderFns.push(i),"selection"===n.type&&(t.selectable.value=n.selectable,t.reserveSelection.value=n.reserveSelection),e.$ready&&(e.store.updateColumns(),e.store.scheduleLayout())},updateColumnOrder(t,n){var r;(null==(r=n.getColumnIndex)?void 0:r.call(n))!==n.no&&(tU(t._columns.value),e.$ready&&e.store.updateColumns())},removeColumn(t,n,r,i){const a=Dt(t._columns)||[];if(r)r.children.splice(r.children.findIndex((e=>e.id===n.id)),1),en((()=>{var e;0===(null==(e=r.children)?void 0:e.length)&&delete r.children})),t._columns.value=eU(a,r);else{const e=a.indexOf(n);e>-1&&(a.splice(e,1),t._columns.value=a)}const s=t.updateOrderFns.indexOf(i);s>-1&&t.updateOrderFns.splice(s,1),e.$ready&&(e.store.updateColumns(),e.store.scheduleLayout())},sort(t,n){const{prop:r,order:i,init:a}=n;if(r){const n=Dt(t.columns).find((e=>e.property===r));n&&(n.order=i,e.store.updateSort(n,r,i),e.store.commit("changeSortCondition",{init:a}))}},changeSortCondition(t,n){const{sortingColumn:r,sortProp:i,sortOrder:a}=t,s=Dt(r),o=Dt(i),l=Dt(a);null===l&&(t.sortingColumn.value=null,t.sortProp.value=null),e.store.execQuery({filter:!0}),n&&(n.silent||n.init)||e.emit("sort-change",{column:s,prop:o,order:l}),e.store.updateTableScrollY()},filterChange(t,n){const{column:r,values:i,silent:a}=n,s=e.store.updateFilters(r,i);e.store.execQuery(),a||e.emit("filter-change",s),e.store.updateTableScrollY()},toggleAllSelection(){e.store.toggleAllSelection()},rowSelectedChanged(t,n){e.store.toggleRowSelection(n),e.store.updateAllSelected()},setHoverRow(e,t){e.hoverRow.value=t},setCurrentRow(t,n){e.store.updateCurrentRow(n)}},commit:function(t,...n){const r=e.store.mutations;if(!r[t])throw new Error(`Action not found: ${t}`);r[t].apply(e,[e.store.states].concat(n))},updateTableScrollY:function(){en((()=>e.layout.updateScrollY.apply(e.layout)))}}}();return n.toggleAllSelection=gh(n._toggleAllSelection,10),Object.keys(nU).forEach((e=>{iU(aU(t,e),e,n)})),function(e,t){Object.keys(nU).forEach((n=>{Mn((()=>aU(t,n)),(t=>{iU(t,n,e)}))}))}(n,t),n}function iU(e,t,n){let r=e,i=nU[t];"object"==typeof nU[t]&&(i=i.key,r=r||nU[t].default),n.states[i].value=r}function aU(e,t){if(t.includes(".")){const n=t.split(".");let r=e;return n.forEach((e=>{r=r[e]})),r}return e[t]}class sU{constructor(e){this.observers=[],this.table=null,this.store=null,this.columns=[],this.fit=!0,this.showHeader=!0,this.height=At(null),this.scrollX=At(!1),this.scrollY=At(!1),this.bodyWidth=At(null),this.fixedWidth=At(null),this.rightFixedWidth=At(null),this.gutterWidth=0;for(const t in e)M(e,t)&&(Et(this[t])?this[t].value=e[t]:this[t]=e[t]);if(!this.table)throw new Error("Table is required for Table Layout");if(!this.store)throw new Error("Store is required for Table Layout")}updateScrollY(){if(null===this.height.value)return!1;const e=this.table.refs.scrollBarRef;if(this.table.vnode.el&&(null==e?void 0:e.wrapRef)){let t=!0;const n=this.scrollY.value;return t=e.wrapRef.scrollHeight>e.wrapRef.clientHeight,this.scrollY.value=t,n!==t}return!1}setHeight(e,t="height"){if(!Os)return;const n=this.table.vnode.el;var r;if(e="number"==typeof(r=e)?r:"string"==typeof r?/^\d+(?:px)?$/.test(r)?Number.parseInt(r,10):r:null,this.height.value=Number(e),!n&&(e||0===e))return en((()=>this.setHeight(e,t)));"number"==typeof e?(n.style[t]=`${e}px`,this.updateElsHeight()):"string"==typeof e&&(n.style[t]=e,this.updateElsHeight())}setMaxHeight(e){this.setHeight(e,"max-height")}getFlattenColumns(){const e=[];return this.table.store.states.columns.value.forEach((t=>{t.isColumnGroup?e.push.apply(e,t.columns):e.push(t)})),e}updateElsHeight(){this.updateScrollY(),this.notifyObservers("scrollable")}headerDisplayNone(e){if(!e)return!0;let t=e;for(;"DIV"!==t.tagName;){if("none"===getComputedStyle(t).display)return!0;t=t.parentElement}return!1}updateColumnsWidth(){if(!Os)return;const e=this.fit,t=this.table.vnode.el.clientWidth;let n=0;const r=this.getFlattenColumns(),i=r.filter((e=>"number"!=typeof e.width));if(r.forEach((e=>{"number"==typeof e.width&&e.realWidth&&(e.realWidth=null)})),i.length>0&&e){if(r.forEach((e=>{n+=Number(e.width||e.minWidth||80)})),n<=t){this.scrollX.value=!1;const e=t-n;if(1===i.length)i[0].realWidth=Number(i[0].minWidth||80)+e;else{const t=e/i.reduce(((e,t)=>e+Number(t.minWidth||80)),0);let n=0;i.forEach(((e,r)=>{if(0===r)return;const i=Math.floor(Number(e.minWidth||80)*t);n+=i,e.realWidth=Number(e.minWidth||80)+i})),i[0].realWidth=Number(i[0].minWidth||80)+e-n}}else this.scrollX.value=!0,i.forEach((e=>{e.realWidth=Number(e.minWidth)}));this.bodyWidth.value=Math.max(n,t),this.table.state.resizeState.value.width=this.bodyWidth.value}else r.forEach((e=>{e.width||e.minWidth?e.realWidth=Number(e.width||e.minWidth):e.realWidth=80,n+=e.realWidth})),this.scrollX.value=n>t,this.bodyWidth.value=n;const a=this.store.states.fixedColumns.value;if(a.length>0){let e=0;a.forEach((t=>{e+=Number(t.realWidth||t.width)})),this.fixedWidth.value=e}const s=this.store.states.rightFixedColumns.value;if(s.length>0){let e=0;s.forEach((t=>{e+=Number(t.realWidth||t.width)})),this.rightFixedWidth.value=e}this.notifyObservers("columns")}addObserver(e){this.observers.push(e)}removeObserver(e){const t=this.observers.indexOf(e);-1!==t&&this.observers.splice(t,1)}notifyObservers(e){this.observers.forEach((t=>{var n,r;switch(e){case"columns":null==(n=t.state)||n.onColumnsChange(this);break;case"scrollable":null==(r=t.state)||r.onScrollableChange(this);break;default:throw new Error(`Table Layout don't have event ${e}.`)}}))}}const{CheckboxGroup:oU}=mM,lU=Fn({name:"ElTableFilterPanel",components:{ElCheckbox:mM,ElCheckboxGroup:oU,ElScrollbar:Tx,ElTooltip:Ow,ElIcon:ib,ArrowDown:op,ArrowUp:_p},directives:{ClickOutside:EC},props:{placement:{type:String,default:"bottom-start"},store:{type:Object},column:{type:Object},upDataColumn:{type:Function}},setup(e){const t=Fi(),{t:n}=Jg(),r=rv("table-filter"),i=null==t?void 0:t.parent;i.filterPanels.value[e.column.id]||(i.filterPanels.value[e.column.id]=t);const a=At(!1),s=At(null),o=Ki((()=>e.column&&e.column.filters)),l=Ki({get:()=>{var t;return((null==(t=e.column)?void 0:t.filteredValue)||[])[0]},set:e=>{u.value&&(null!=e?u.value.splice(0,1,e):u.value.splice(0,1))}}),u=Ki({get:()=>e.column&&e.column.filteredValue||[],set(t){e.column&&e.upDataColumn("filteredValue",t)}}),c=Ki((()=>!e.column||e.column.filterMultiple)),d=()=>{a.value=!1},h=t=>{e.store.commit("filterChange",{column:e.column,values:t}),e.store.updateAllSelected()};Mn(a,(t=>{e.column&&e.upDataColumn("filterOpened",t)}),{immediate:!0});const p=Ki((()=>{var e,t;return null==(t=null==(e=s.value)?void 0:e.popperRef)?void 0:t.contentRef}));return{tooltipVisible:a,multiple:c,filteredValue:u,filterValue:l,filters:o,handleConfirm:()=>{h(u.value),d()},handleReset:()=>{u.value=[],h(u.value),d()},handleSelect:e=>{l.value=e,h(null!=e?u.value:[]),d()},isActive:e=>e.value===l.value,t:n,ns:r,showFilterPanel:e=>{e.stopPropagation(),a.value=!a.value},hideFilterPanel:()=>{a.value=!1},popperPaneRef:p,tooltip:s}}}),uU={key:0},cU=["disabled"],dU=["label","onClick"];var hU=J_(lU,[["render",function(e,t,n,r,i,a){const s=ur("el-checkbox"),o=ur("el-checkbox-group"),u=ur("el-scrollbar"),c=ur("arrow-up"),d=ur("arrow-down"),h=ur("el-icon"),p=ur("el-tooltip"),m=hr("click-outside");return fi(),_i(p,{ref:"tooltip",visible:e.tooltipVisible,offset:0,placement:e.placement,"show-arrow":!1,"stop-popper-mouse-event":!1,teleported:"",effect:"light",pure:"","popper-class":e.ns.b(),persistent:""},{content:vn((()=>[e.multiple?(fi(),yi("div",uU,[Ti("div",{class:l(e.ns.e("content"))},[Mi(u,{"wrap-class":e.ns.e("wrap")},{default:vn((()=>[Mi(o,{modelValue:e.filteredValue,"onUpdate:modelValue":t[0]||(t[0]=t=>e.filteredValue=t),class:l(e.ns.e("checkbox-group"))},{default:vn((()=>[(fi(!0),yi(li,null,mr(e.filters,(e=>(fi(),_i(s,{key:e.value,label:e.value},{default:vn((()=>[Pi(f(e.text),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue","class"])])),_:1},8,["wrap-class"])],2),Ti("div",{class:l(e.ns.e("bottom"))},[Ti("button",{class:l({[e.ns.is("disabled")]:0===e.filteredValue.length}),disabled:0===e.filteredValue.length,type:"button",onClick:t[1]||(t[1]=(...t)=>e.handleConfirm&&e.handleConfirm(...t))},f(e.t("el.table.confirmFilter")),11,cU),Ti("button",{type:"button",onClick:t[2]||(t[2]=(...t)=>e.handleReset&&e.handleReset(...t))},f(e.t("el.table.resetFilter")),1)],2)])):(fi(),yi("ul",{key:1,class:l(e.ns.e("list"))},[Ti("li",{class:l([e.ns.e("list-item"),{[e.ns.is("active")]:void 0===e.filterValue||null===e.filterValue}]),onClick:t[3]||(t[3]=t=>e.handleSelect(null))},f(e.t("el.table.clearFilter")),3),(fi(!0),yi(li,null,mr(e.filters,(t=>(fi(),yi("li",{key:t.value,class:l([e.ns.e("list-item"),e.ns.is("active",e.isActive(t))]),label:t.value,onClick:n=>e.handleSelect(t.value)},f(t.text),11,dU)))),128))],2))])),default:vn((()=>[ar((fi(),yi("span",{class:l([`${e.ns.namespace.value}-table__column-filter-trigger`,`${e.ns.namespace.value}-none-outline`]),onClick:t[4]||(t[4]=(...t)=>e.showFilterPanel&&e.showFilterPanel(...t))},[Mi(h,null,{default:vn((()=>[e.column.filterOpened?(fi(),_i(c,{key:0})):(fi(),_i(d,{key:1}))])),_:1})],2)),[[m,e.hideFilterPanel,e.popperPaneRef]])])),_:1},8,["visible","placement","popper-class"])}],["__file","/home/runner/work/element-plus/element-plus/packages/components/table/src/filter-panel.vue"]]);function pU(e){const t=Fi();qn((()=>{n.value.addObserver(t)})),Kn((()=>{r(n.value),i(n.value)})),Jn((()=>{r(n.value),i(n.value)})),er((()=>{n.value.removeObserver(t)}));const n=Ki((()=>{const t=e.layout;if(!t)throw new Error("Can not find table layout.");return t})),r=t=>{var n;const r=(null==(n=e.vnode.el)?void 0:n.querySelectorAll("colgroup > col"))||[];if(!r.length)return;const i=t.getFlattenColumns(),a={};i.forEach((e=>{a[e.id]=e}));for(let e=0,s=r.length;e<s;e++){const t=r[e],n=t.getAttribute("name"),i=a[n];i&&t.setAttribute("width",i.realWidth||i.width)}},i=t=>{var n,r;const i=(null==(n=e.vnode.el)?void 0:n.querySelectorAll("colgroup > col[name=gutter]"))||[];for(let e=0,s=i.length;e<s;e++){i[e].setAttribute("width",t.scrollY.value?t.gutterWidth:"0")}const a=(null==(r=e.vnode.el)?void 0:r.querySelectorAll("th.gutter"))||[];for(let e=0,s=a.length;e<s;e++){const n=a[e];n.style.width=t.scrollY.value?`${t.gutterWidth}px`:"0",n.style.display=t.scrollY.value?"":"none"}};return{tableLayout:n.value,onColumnsChange:r,onScrollableChange:i}}const fU=Symbol("ElTable");const mU=e=>{const t=[];return e.forEach((e=>{e.children?(t.push(e),t.push.apply(t,mU(e.children))):t.push(e)})),t};function gU(e){const t=Sn(fU),n=Ki((()=>(e=>{let t=1;const n=(e,r)=>{if(r&&(e.level=r.level+1,t<e.level&&(t=e.level)),e.children){let t=0;e.children.forEach((r=>{n(r,e),t+=r.colSpan})),e.colSpan=t}else e.colSpan=1};e.forEach((e=>{e.level=1,n(e,void 0)}));const r=[];for(let i=0;i<t;i++)r.push([]);return mU(e).forEach((e=>{e.children?(e.rowSpan=1,e.children.forEach((e=>e.isSubColumn=!0))):e.rowSpan=t-e.level+1,r[e.level-1].push(e)})),r})(e.store.states.originColumns.value)));return{isGroup:Ki((()=>{const e=n.value.length>1;return e&&t&&(t.state.isGroup.value=!0),e})),toggleAllSelection:e=>{e.stopPropagation(),null==t||t.store.commit("toggleAllSelection")},columnRows:n}}var vU=Fn({name:"ElTableHeader",components:{ElCheckbox:mM},props:{fixed:{type:String,default:""},store:{required:!0,type:Object},border:Boolean,defaultSort:{type:Object,default:()=>({prop:"",order:""})}},setup(e,{emit:t}){const n=Fi(),r=Sn(fU),i=rv("table"),a=At({}),{onColumnsChange:s,onScrollableChange:o}=pU(r);Kn((async()=>{await en(),await en();const{prop:t,order:n}=e.defaultSort;null==r||r.store.commit("sort",{prop:t,order:n,init:!0})}));const{handleHeaderClick:l,handleHeaderContextMenu:u,handleMouseDown:c,handleMouseMove:d,handleMouseOut:h,handleSortClick:p,handleFilterClick:f}=function(e,t){const n=Fi(),r=Sn(fU),i=e=>{e.stopPropagation()},a=At(null),s=At(!1),o=At({}),l=(t,n,i)=>{var a;t.stopPropagation();const s=n.order===i?null:i||(({order:e,sortOrders:t})=>{if(""===e)return t[0];const n=t.indexOf(e||null);return t[n>t.length-2?0:n+1]})(n),o=null==(a=t.target)?void 0:a.closest("th");if(o&&$h(o,"noclick"))return void qh(o,"noclick");if(!n.sortable)return;const l=e.store.states;let u,c=l.sortProp.value;const d=l.sortingColumn.value;(d!==n||d===n&&null===d.order)&&(d&&(d.order=null),l.sortingColumn.value=n,c=n.property),u=n.order=s||null,l.sortProp.value=c,l.sortOrder.value=u,null==r||r.store.commit("changeSortCondition")};return{handleHeaderClick:(e,t)=>{!t.filters&&t.sortable?l(e,t,!1):t.filterable&&!t.sortable&&i(e),null==r||r.emit("header-click",t,e)},handleHeaderContextMenu:(e,t)=>{null==r||r.emit("header-contextmenu",t,e)},handleMouseDown:(i,l)=>{if(Os&&!(l.children&&l.children.length>0)&&a.value&&e.border){s.value=!0;const u=r;t("set-drag-visible",!0);const c=(null==u?void 0:u.vnode.el).getBoundingClientRect().left,d=n.vnode.el.querySelector(`th.${l.id}`),h=d.getBoundingClientRect(),p=h.left-c+30;Xh(d,"noclick"),o.value={startMouseLeft:i.clientX,startLeft:h.right-c,startColumnLeft:h.left-c,tableLeft:c};const f=null==u?void 0:u.refs.resizeProxy;f.style.left=`${o.value.startLeft}px`,document.onselectstart=function(){return!1},document.ondragstart=function(){return!1};const m=e=>{const t=e.clientX-o.value.startMouseLeft,n=o.value.startLeft+t;f.style.left=`${Math.max(p,n)}px`},g=()=>{if(s.value){const{startColumnLeft:n,startLeft:r}=o.value,c=Number.parseInt(f.style.left,10)-n;l.width=l.realWidth=c,null==u||u.emit("header-dragend",l.width,r-n,l,i),requestAnimationFrame((()=>{e.store.scheduleLayout(!1,!0)})),document.body.style.cursor="",s.value=!1,a.value=null,o.value={},t("set-drag-visible",!1)}document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",g),document.onselectstart=null,document.ondragstart=null,setTimeout((()=>{qh(d,"noclick")}),0)};document.addEventListener("mousemove",m),document.addEventListener("mouseup",g)}},handleMouseMove:(t,n)=>{var r;if(n.children&&n.children.length>0)return;const i=null==(r=t.target)?void 0:r.closest("th");if(n&&n.resizable&&!s.value&&e.border){const e=i.getBoundingClientRect(),r=document.body.style;e.width>12&&e.right-t.pageX<8?(r.cursor="col-resize",$h(i,"is-sortable")&&(i.style.cursor="col-resize"),a.value=n):s.value||(r.cursor="",$h(i,"is-sortable")&&(i.style.cursor="pointer"),a.value=null)}},handleMouseOut:()=>{Os&&(document.body.style.cursor="")},handleSortClick:l,handleFilterClick:i}}(e,t),{getHeaderRowStyle:m,getHeaderRowClass:g,getHeaderCellStyle:v,getHeaderCellClass:y}=function(e){const t=Sn(fU),n=rv("table");return{getHeaderRowStyle:e=>{const n=null==t?void 0:t.props.headerRowStyle;return"function"==typeof n?n.call(null,{rowIndex:e}):n},getHeaderRowClass:e=>{const n=[],r=null==t?void 0:t.props.headerRowClassName;return"string"==typeof r?n.push(r):"function"==typeof r&&n.push(r.call(null,{rowIndex:e})),n.join(" ")},getHeaderCellStyle:(n,r,i,a)=>{var s;let o=null!=(s=null==t?void 0:t.props.headerCellStyle)?s:{};"function"==typeof o&&(o=o.call(null,{rowIndex:n,columnIndex:r,row:i,column:a}));const l=qB(r,a.fixed,e.store,i);return KB(l,"left"),KB(l,"right"),Object.assign({},o,l)},getHeaderCellClass:(r,i,a,s)=>{const o=$B(n.b(),i,s.fixed,e.store,a),l=[s.id,s.order,s.headerAlign,s.className,s.labelClassName,...o];s.children||l.push("is-leaf"),s.sortable&&l.push("is-sortable");const u=null==t?void 0:t.props.headerCellClassName;return"string"==typeof u?l.push(u):"function"==typeof u&&l.push(u.call(null,{rowIndex:r,columnIndex:i,row:a,column:s})),l.push(n.e("cell")),l.filter((e=>Boolean(e))).join(" ")}}}(e),{isGroup:_,toggleAllSelection:b,columnRows:x}=gU(e);return n.state={onColumnsChange:s,onScrollableChange:o},n.filterPanels=a,{ns:i,filterPanels:a,onColumnsChange:s,onScrollableChange:o,columnRows:x,getHeaderRowClass:g,getHeaderRowStyle:m,getHeaderCellClass:y,getHeaderCellStyle:v,handleHeaderClick:l,handleHeaderContextMenu:u,handleMouseDown:c,handleMouseMove:d,handleMouseOut:h,handleSortClick:p,handleFilterClick:f,isGroup:_,toggleAllSelection:b}},render(){const{ns:e,isGroup:t,columnRows:n,getHeaderCellStyle:r,getHeaderCellClass:i,getHeaderRowClass:a,getHeaderRowStyle:s,handleHeaderClick:o,handleHeaderContextMenu:l,handleMouseDown:u,handleMouseMove:c,handleSortClick:d,handleMouseOut:h,store:p,$parent:f}=this;let m=1;return ea("thead",{class:{[e.is("group")]:t}},n.map(((e,t)=>ea("tr",{class:a(t),key:t,style:s(t)},e.map(((n,a)=>(n.rowSpan>m&&(m=n.rowSpan),ea("th",{class:i(t,a,e,n),colspan:n.colSpan,key:`${n.id}-thead`,rowspan:n.rowSpan,style:r(t,a,e,n),onClick:e=>o(e,n),onContextmenu:e=>l(e,n),onMousedown:e=>u(e,n),onMousemove:e=>c(e,n),onMouseout:h},[ea("div",{class:["cell",n.filteredValue&&n.filteredValue.length>0?"highlight":""]},[n.renderHeader?n.renderHeader({column:n,$index:a,store:p,_self:f}):n.label,n.sortable&&ea("span",{onClick:e=>d(e,n),class:"caret-wrapper"},[ea("i",{onClick:e=>d(e,n,"ascending"),class:"sort-caret ascending"}),ea("i",{onClick:e=>d(e,n,"descending"),class:"sort-caret descending"})]),n.filterable&&ea(hU,{store:p,placement:n.filterPlacement||"bottom-start",column:n,upDataColumn:(e,t)=>{n[e]=t}})])]))))))))}});function yU(e){const t=Sn(fU),n=At(""),r=At(ea("div")),{nextZIndex:i}=Yy(),a=(n,r,i)=>{var a;const s=t,o=kB(n);let l;const u=null==(a=null==s?void 0:s.vnode.el)?void 0:a.dataset.prefix;o&&(l=NB({columns:e.store.states.columns.value},o,u),l&&(null==s||s.emit(`cell-${i}`,r,l,o,n))),null==s||s.emit(`row-${i}`,r,l,n)};return{handleDoubleClick:(e,t)=>{a(e,t,"dblclick")},handleClick:(t,n)=>{e.store.commit("setCurrentRow",n),a(t,n,"click")},handleContextMenu:(e,t)=>{a(e,t,"contextmenu")},handleMouseEnter:gh((t=>{e.store.commit("setHoverRow",t)}),30),handleMouseLeave:gh((()=>{e.store.commit("setHoverRow",null)}),30),handleCellMouseEnter:(n,r,a)=>{var s;const o=t,l=kB(n),u=null==(s=null==o?void 0:o.vnode.el)?void 0:s.dataset.prefix;if(l){const t=NB({columns:e.store.states.columns.value},l,u),i=o.hoverState={cell:l,column:t,row:r};null==o||o.emit("cell-mouse-enter",i.row,i.column,i.cell,n)}if(!a)return;const c=n.target.querySelector(".cell");if(!$h(c,`${u}-tooltip`)||!c.childNodes.length)return;const d=document.createRange();d.setStart(c,0),d.setEnd(c,c.childNodes.length);(Math.round(d.getBoundingClientRect().width)+((Number.parseInt(Kh(c,"paddingLeft"),10)||0)+(Number.parseInt(Kh(c,"paddingRight"),10)||0))>c.offsetWidth||c.scrollWidth>c.offsetWidth)&&function(e,t,n,r,i){i=Ph({enterable:!0,showArrow:!0},i);const a=null==e?void 0:e.dataset.prefix,s=null==e?void 0:e.querySelector(`.${a}-scrollbar__wrap`);function o(){l&&l.update()}null==HB||HB(),HB=()=>{try{l&&l.destroy(),d&&(null==e||e.removeChild(d)),t.removeEventListener("mouseenter",u),t.removeEventListener("mouseleave",c),null==s||s.removeEventListener("scroll",HB),HB=void 0}catch(zA){}};let l=null,u=o,c=HB;i.enterable&&({onOpen:u,onClose:c}=Vy({showAfter:i.showAfter,hideAfter:i.hideAfter,open:o,close:HB}));const d=function(){const t="light"===i.effect,s=document.createElement("div");return s.className=[`${a}-popper`,t?"is-light":"is-dark",i.popperClass||""].join(" "),n=LB(n),s.innerHTML=n,s.style.zIndex=String(r()),null==e||e.appendChild(s),s}();d.onmouseenter=u,d.onmouseleave=c;const h=[];if(i.offset&&h.push({name:"offset",options:{offset:[0,i.offset]}}),i.showArrow){const e=d.appendChild(function(){const e=document.createElement("div");return e.className=`${a}-popper__arrow`,e}());h.push({name:"arrow",options:{element:e,padding:10}})}const p=i.popperOptions||{};l=Ey(t,d,{placement:i.placement||"top",strategy:"fixed",...p,modifiers:p.modifiers?h.concat(p.modifiers):h}),t.addEventListener("mouseenter",u),t.addEventListener("mouseleave",c),null==s||s.addEventListener("scroll",HB)}(null==t?void 0:t.refs.tableWrapper,l,l.innerText||l.textContent,i,a)},handleCellMouseLeave:e=>{if(!kB(e))return;const n=null==t?void 0:t.hoverState;null==t||t.emit("cell-mouse-leave",null==n?void 0:n.row,null==n?void 0:n.column,null==n?void 0:n.cell,e)},tooltipContent:n,tooltipTrigger:r}}function _U(e){const t=Sn(fU),n=rv("table"),{handleDoubleClick:r,handleClick:i,handleContextMenu:a,handleMouseEnter:s,handleMouseLeave:o,handleCellMouseEnter:l,handleCellMouseLeave:u,tooltipContent:c,tooltipTrigger:d}=yU(e),{getRowStyle:h,getRowClass:p,getCellStyle:f,getCellClass:m,getSpan:g,getColspanRealWidth:v}=function(e){const t=Sn(fU),n=rv("table");return{getRowStyle:(e,n)=>{const r=null==t?void 0:t.props.rowStyle;return"function"==typeof r?r.call(null,{row:e,rowIndex:n}):r||null},getRowClass:(r,i)=>{const a=[n.e("row")];(null==t?void 0:t.props.highlightCurrentRow)&&r===e.store.states.currentRow.value&&a.push("current-row"),e.stripe&&i%2==1&&a.push(n.em("row","striped"));const s=null==t?void 0:t.props.rowClassName;return"string"==typeof s?a.push(s):"function"==typeof s&&a.push(s.call(null,{row:r,rowIndex:i})),a},getCellStyle:(n,r,i,a)=>{const s=null==t?void 0:t.props.cellStyle;let o=null!=s?s:{};"function"==typeof s&&(o=s.call(null,{rowIndex:n,columnIndex:r,row:i,column:a}));const l=qB(r,null==e?void 0:e.fixed,e.store);return KB(l,"left"),KB(l,"right"),Object.assign({},o,l)},getCellClass:(r,i,a,s,o)=>{const l=$B(n.b(),i,null==e?void 0:e.fixed,e.store,void 0,o),u=[s.id,s.align,s.className,...l],c=null==t?void 0:t.props.cellClassName;return"string"==typeof c?u.push(c):"function"==typeof c&&u.push(c.call(null,{rowIndex:r,columnIndex:i,row:a,column:s})),u.push(n.e("cell")),u.filter((e=>Boolean(e))).join(" ")},getSpan:(e,n,r,i)=>{let a=1,s=1;const o=null==t?void 0:t.props.spanMethod;if("function"==typeof o){const t=o({row:e,column:n,rowIndex:r,columnIndex:i});Array.isArray(t)?(a=t[0],s=t[1]):"object"==typeof t&&(a=t.rowspan,s=t.colspan)}return{rowspan:a,colspan:s}},getColspanRealWidth:(e,t,n)=>{if(t<1)return e[n].realWidth;const r=e.map((({realWidth:e,width:t})=>e||t)).slice(n,n+t);return Number(r.reduce(((e,t)=>Number(e)+Number(t)),-1))}}}(e),y=Ki((()=>e.store.states.columns.value.findIndex((({type:e})=>"default"===e)))),_=(e,n)=>{const r=t.props.rowKey;return r?BB(e,r):n},b=(c,d,b,w=!1)=>{const{tooltipEffect:S,tooltipOptions:C,store:T}=e,{indent:M,columns:E}=T.states,A=p(c,d);let P=!0;b&&(A.push(n.em("row",`level-${b.level}`)),P=b.display);return ea("tr",{style:[P?null:{display:"none"},h(c,d)],class:A,key:_(c,d),onDblclick:e=>r(e,c),onClick:e=>i(e,c),onContextmenu:e=>a(e,c),onMouseenter:()=>s(d),onMouseleave:o},E.value.map(((n,r)=>{const{rowspan:i,colspan:a}=g(c,n,d,r);if(!i||!a)return null;const s={...n};s.realWidth=v(E.value,a,r);const o={store:e.store,_self:e.context||t,column:s,row:c,$index:d,cellIndex:r,expanded:w};r===y.value&&b&&(o.treeNode={indent:b.level*M.value,level:b.level},"boolean"==typeof b.expanded&&(o.treeNode.expanded=b.expanded,"loading"in b&&(o.treeNode.loading=b.loading),"noLazyChildren"in b&&(o.treeNode.noLazyChildren=b.noLazyChildren)));const h=`${d},${r}`,p=s.columnKey||s.rawColumnKey||"",_=x(r,n,o),T=n.showOverflowTooltip&&Ph({effect:S},C,n.showOverflowTooltip);return ea("td",{style:f(d,r,c,n),class:m(d,r,c,n,a-1),key:`${p}${h}`,rowspan:i,colspan:a,onMouseenter:e=>l(e,c,T),onMouseleave:u},[_])})))},x=(e,t,n)=>t.renderCell(n);return{wrappedRowRender:(r,i)=>{const a=e.store,{isRowExpanded:s,assertRowKey:o}=a,{treeData:l,lazyTreeNodeMap:u,childrenColumnName:c,rowKey:d}=a.states,h=a.states.columns.value;if(h.some((({type:e})=>"expand"===e))){const e=s(r),o=b(r,i,void 0,e),l=t.renderExpanded;return e?l?[[o,ea("tr",{key:`expanded-row__${o.key}`},[ea("td",{colspan:h.length,class:`${n.e("cell")} ${n.e("expanded-cell")}`},[l({row:r,$index:i,store:a,expanded:e})])])]]:(console.error("[Element Error]renderExpanded is required."),o):[[o]]}if(Object.keys(l.value).length){o();const e=BB(r,d.value);let t=l.value[e],n=null;t&&(n={expanded:t.expanded,level:t.level,display:!0},"boolean"==typeof t.lazy&&("boolean"==typeof t.loaded&&t.loaded&&(n.noLazyChildren=!(t.children&&t.children.length)),n.loading=t.loading));const a=[b(r,i,n)];if(t){let n=0;const s=(e,r)=>{e&&e.length&&r&&e.forEach((e=>{const o={display:r.display&&r.expanded,level:r.level+1,expanded:!1,noLazyChildren:!1,loading:!1},h=BB(e,d.value);if(null==h)throw new Error("For nested data item, row-key is required.");if(t={...l.value[h]},t&&(o.expanded=t.expanded,t.level=t.level||o.level,t.display=!(!t.expanded||!o.display),"boolean"==typeof t.lazy&&("boolean"==typeof t.loaded&&t.loaded&&(o.noLazyChildren=!(t.children&&t.children.length)),o.loading=t.loading)),n++,a.push(b(e,i+n,o)),t){const n=u.value[h]||e[c.value];s(n,t)}}))};t.display=!0;const o=u.value[e]||r[c.value];s(o,t)}return a}return b(r,i,void 0)},tooltipContent:c,tooltipTrigger:d}}var bU=Fn({name:"ElTableBody",props:{store:{required:!0,type:Object},stripe:Boolean,tooltipEffect:String,tooltipOptions:{type:Object},context:{default:()=>({}),type:Object},rowClassName:[String,Function],rowStyle:[Object,Function],fixed:{type:String,default:""},highlight:Boolean},setup(e){const t=Fi(),n=Sn(fU),r=rv("table"),{wrappedRowRender:i,tooltipContent:a,tooltipTrigger:s}=_U(e),{onColumnsChange:o,onScrollableChange:l}=pU(n);return Mn(e.store.states.hoverRow,((n,i)=>{if(!e.store.states.isComplex.value||!Os)return;let a=window.requestAnimationFrame;a||(a=e=>window.setTimeout(e,16)),a((()=>{const e=null==t?void 0:t.vnode.el,a=Array.from((null==e?void 0:e.children)||[]).filter((e=>null==e?void 0:e.classList.contains(`${r.e("row")}`))),s=a[i],o=a[n];s&&qh(s,"hover-row"),o&&Xh(o,"hover-row")}))})),er((()=>{var e;null==(e=HB)||e()})),{ns:r,onColumnsChange:o,onScrollableChange:l,wrappedRowRender:i,tooltipContent:a,tooltipTrigger:s}},render(){const{wrappedRowRender:e,store:t}=this;return ea("tbody",{},[(t.states.data.value||[]).reduce(((t,n)=>t.concat(e(n,t.length))),[])])}});function xU(e){const t="auto"===e.tableLayout;let n=e.columns||[];t&&n.every((e=>void 0===e.width))&&(n=[]);return ea("colgroup",{},n.map((n=>ea("col",(n=>{const r={key:`${e.tableLayout}_${n.id}`,style:{},name:void 0};return t?r.style={width:`${n.width}px`}:r.name=n.id,r})(n)))))}function wU(e){const{columns:t}=function(){const e=Sn(fU),t=null==e?void 0:e.store;return{leftFixedLeafCount:Ki((()=>t.states.fixedLeafColumnsLength.value)),rightFixedLeafCount:Ki((()=>t.states.rightFixedColumns.value.length)),columnsCount:Ki((()=>t.states.columns.value.length)),leftFixedCount:Ki((()=>t.states.fixedColumns.value.length)),rightFixedCount:Ki((()=>t.states.rightFixedColumns.value.length)),columns:t.states.columns}}(),n=rv("table");return{getCellClasses:(t,r)=>{const i=t[r],a=[n.e("cell"),i.id,i.align,i.labelClassName,...$B(n.b(),r,i.fixed,e.store)];return i.className&&a.push(i.className),i.children||a.push(n.is("leaf")),a},getCellStyles:(t,n)=>{const r=qB(n,t.fixed,e.store);return KB(r,"left"),KB(r,"right"),r},columns:t}}xU.props=["columns","tableLayout"];var SU=Fn({name:"ElTableFooter",props:{fixed:{type:String,default:""},store:{required:!0,type:Object},summaryMethod:Function,sumText:String,border:Boolean,defaultSort:{type:Object,default:()=>({prop:"",order:""})}},setup(e){const{getCellClasses:t,getCellStyles:n,columns:r}=wU(e);return{ns:rv("table"),getCellClasses:t,getCellStyles:n,columns:r}},render(){const{columns:e,getCellStyles:t,getCellClasses:n,summaryMethod:r,sumText:i,ns:a}=this,s=this.store.states.data.value;let o=[];return r?o=r({columns:e,data:s}):e.forEach(((e,t)=>{if(0===t)return void(o[t]=i);const n=s.map((t=>Number(t[e.property]))),r=[];let a=!0;n.forEach((e=>{if(!Number.isNaN(+e)){a=!1;const t=`${e}`.split(".")[1];r.push(t?t.length:0)}}));const l=Math.max.apply(null,r);o[t]=a?"":n.reduce(((e,t)=>{const n=Number(t);return Number.isNaN(+n)?e:Number.parseFloat((e+t).toFixed(Math.min(l,20)))}),0)})),ea("table",{class:a.e("footer"),cellspacing:"0",cellpadding:"0",border:"0"},[xU({columns:e}),ea("tbody",[ea("tr",{},[...e.map(((r,i)=>ea("td",{key:i,colspan:r.colSpan,rowspan:r.rowSpan,class:n(e,i),style:t(r,i)},[ea("div",{class:["cell",r.labelClassName]},[o[i]])])))])])])}});function CU(e,t,n,r){const i=At(!1),a=At(null),s=At(!1),o=At({width:null,height:null,headerHeight:null}),l=At(!1),u=At(),c=At(0),d=At(0),h=At(0),p=At(0);Cn((()=>{t.setHeight(e.height)})),Cn((()=>{t.setMaxHeight(e.maxHeight)})),Mn((()=>[e.currentRowKey,n.states.rowKey]),(([e,t])=>{Dt(t)&&Dt(e)&&n.setCurrentRowKey(`${e}`)}),{immediate:!0}),Mn((()=>e.data),(e=>{r.store.commit("setData",e)}),{immediate:!0,deep:!0}),Cn((()=>{e.expandRowKeys&&n.setExpandRowKeysAdapter(e.expandRowKeys)}));const f=Ki((()=>e.height||e.maxHeight||n.states.fixedColumns.value.length>0||n.states.rightFixedColumns.value.length>0)),m=Ki((()=>({width:t.bodyWidth.value?`${t.bodyWidth.value}px`:""}))),g=()=>{f.value&&t.updateElsHeight(),t.updateColumnsWidth(),requestAnimationFrame(y)};Kn((async()=>{await en(),n.updateColumns(),_(),requestAnimationFrame(g);const t=r.vnode.el,i=r.refs.headerWrapper;e.flexible&&t&&t.parentElement&&(t.parentElement.style.minWidth="0"),o.value={width:u.value=t.offsetWidth,height:t.offsetHeight,headerHeight:e.showHeader&&i?i.offsetHeight:null},n.states.columns.value.forEach((e=>{e.filteredValue&&e.filteredValue.length&&r.store.commit("filterChange",{column:e,values:e.filteredValue,silent:!0})})),r.$ready=!0}));const v=e=>{const{tableWrapper:n}=r.refs;((e,n)=>{if(!e)return;const r=Array.from(e.classList).filter((e=>!e.startsWith("is-scrolling-")));r.push(t.scrollX.value?n:"is-scrolling-none"),e.className=r.join(" ")})(n,e)},y=function(){if(!r.refs.scrollBarRef)return;if(!t.scrollX.value){const e="is-scrolling-none";return void((e=>{const{tableWrapper:t}=r.refs;return!(!t||!t.classList.contains(e))})(e)||v(e))}const e=r.refs.scrollBarRef.wrapRef;if(!e)return;const{scrollLeft:n,offsetWidth:i,scrollWidth:a}=e,{headerWrapper:s,footerWrapper:o}=r.refs;s&&(s.scrollLeft=n),o&&(o.scrollLeft=n);v(n>=a-i-1?"is-scrolling-right":0===n?"is-scrolling-left":"is-scrolling-middle")},_=()=>{r.refs.scrollBarRef&&(r.refs.scrollBarRef.wrapRef&&Zs(r.refs.scrollBarRef.wrapRef,"scroll",y,{passive:!0}),e.fit?lo(r.vnode.el,b):Zs(window,"resize",b),lo(r.refs.bodyWrapper,(()=>{var e,t;b(),null==(t=null==(e=r.refs)?void 0:e.scrollBarRef)||t.update()})))},b=()=>{var t,n,i;const a=r.vnode.el;if(!r.$ready||!a)return;let s=!1;const{width:l,height:m,headerHeight:v}=o.value,y=u.value=a.offsetWidth;l!==y&&(s=!0);const _=a.offsetHeight;(e.height||f.value)&&m!==_&&(s=!0);const b="fixed"===e.tableLayout?r.refs.headerWrapper:null==(t=r.refs.tableHeaderRef)?void 0:t.$el;e.showHeader&&(null==b?void 0:b.offsetHeight)!==v&&(s=!0),c.value=(null==(n=r.refs.tableWrapper)?void 0:n.scrollHeight)||0,h.value=(null==b?void 0:b.scrollHeight)||0,p.value=(null==(i=r.refs.footerWrapper)?void 0:i.offsetHeight)||0,d.value=c.value-h.value-p.value,s&&(o.value={width:y,height:_,headerHeight:e.showHeader&&(null==b?void 0:b.offsetHeight)||0},g())},x=db(),w=Ki((()=>{const{bodyWidth:e,scrollY:n,gutterWidth:r}=t;return e.value?e.value-(n.value?r:0)+"px":""})),S=Ki((()=>e.maxHeight?"fixed":e.tableLayout)),C=Ki((()=>{if(e.data&&e.data.length)return null;let t="100%";e.height&&d.value&&(t=`${d.value}px`);const n=u.value;return{width:n?`${n}px`:"",height:t}})),T=Ki((()=>e.height?{height:Number.isNaN(Number(e.height))?e.height:`${e.height}px`}:e.maxHeight?{maxHeight:Number.isNaN(Number(e.maxHeight))?e.maxHeight:`${e.maxHeight}px`}:{})),M=Ki((()=>{if(e.height)return{height:"100%"};if(e.maxHeight){if(Number.isNaN(Number(e.maxHeight)))return{maxHeight:`calc(${e.maxHeight} - ${h.value+p.value}px)`};{const t=e.maxHeight;if(c.value>=Number(t))return{maxHeight:c.value-h.value-p.value+"px"}}}return{}}));return{isHidden:i,renderExpanded:a,setDragVisible:e=>{s.value=e},isGroup:l,handleMouseLeave:()=>{r.store.commit("setHoverRow",null),r.hoverState&&(r.hoverState=null)},handleHeaderFooterMousewheel:(e,t)=>{const{pixelX:n,pixelY:i}=t;Math.abs(n)>=Math.abs(i)&&(r.refs.bodyWrapper.scrollLeft+=t.pixelX/5)},tableSize:x,emptyBlockStyle:C,handleFixedMousewheel:(e,t)=>{const n=r.refs.bodyWrapper;if(Math.abs(t.spinY)>0){const r=n.scrollTop;t.pixelY<0&&0!==r&&e.preventDefault(),t.pixelY>0&&n.scrollHeight-n.clientHeight>r&&e.preventDefault(),n.scrollTop+=Math.ceil(t.pixelY/5)}else n.scrollLeft+=Math.ceil(t.pixelX/5)},resizeProxyVisible:s,bodyWidth:w,resizeState:o,doLayout:g,tableBodyStyles:m,tableLayout:S,scrollbarViewStyle:{display:"inline-block",verticalAlign:"middle"},tableInnerStyle:T,scrollbarStyle:M}}function TU(e){const t=At();Kn((()=>{(()=>{const n=e.vnode.el.querySelector(".hidden-columns"),r=e.store.states.updateOrderFns;t.value=new MutationObserver((()=>{r.forEach((e=>e()))})),t.value.observe(n,{childList:!0,subtree:!0})})()})),er((()=>{var e;null==(e=t.value)||e.disconnect()}))}var MU={data:{type:Array,default:()=>[]},size:z_,width:[String,Number],height:[String,Number],maxHeight:[String,Number],fit:{type:Boolean,default:!0},stripe:Boolean,border:Boolean,rowKey:[String,Function],showHeader:{type:Boolean,default:!0},showSummary:Boolean,sumText:String,summaryMethod:Function,rowClassName:[String,Function],rowStyle:[Object,Function],cellClassName:[String,Function],cellStyle:[Object,Function],headerRowClassName:[String,Function],headerRowStyle:[Object,Function],headerCellClassName:[String,Function],headerCellStyle:[Object,Function],highlightCurrentRow:Boolean,currentRowKey:[String,Number],emptyText:String,expandRowKeys:Array,defaultExpandAll:Boolean,defaultSort:Object,tooltipEffect:String,tooltipOptions:Object,spanMethod:Function,selectOnIndeterminate:{type:Boolean,default:!0},indent:{type:Number,default:16},treeProps:{type:Object,default:()=>({hasChildren:"hasChildren",children:"children"})},lazy:Boolean,load:Function,style:{type:Object,default:()=>({})},className:{type:String,default:""},tableLayout:{type:String,default:"fixed"},scrollbarAlwaysOn:{type:Boolean,default:!1},flexible:Boolean};let EU=1;const AU=Fn({name:"ElTable",directives:{Mousewheel:sT},components:{TableHeader:vU,TableBody:bU,TableFooter:SU,ElScrollbar:Tx,hColgroup:xU},props:MU,emits:["select","select-all","selection-change","cell-mouse-enter","cell-mouse-leave","cell-contextmenu","cell-click","cell-dblclick","row-click","row-contextmenu","row-dblclick","header-click","header-contextmenu","sort-change","filter-change","current-change","header-dragend","expand-change"],setup(e){const{t:t}=Jg(),n=rv("table"),r=Fi();wn(fU,r);const i=rU(r,e);r.store=i;const a=new sU({store:r.store,table:r,fit:e.fit,showHeader:e.showHeader});r.layout=a;const s=Ki((()=>0===(i.states.data.value||[]).length)),{setCurrentRow:o,getSelectionRows:l,toggleRowSelection:u,clearSelection:c,clearFilter:d,toggleAllSelection:h,toggleRowExpansion:p,clearSort:f,sort:m}=function(e){return{setCurrentRow:t=>{e.commit("setCurrentRow",t)},getSelectionRows:()=>e.getSelectionRows(),toggleRowSelection:(t,n)=>{e.toggleRowSelection(t,n,!1),e.updateAllSelected()},clearSelection:()=>{e.clearSelection()},clearFilter:t=>{e.clearFilter(t)},toggleAllSelection:()=>{e.commit("toggleAllSelection")},toggleRowExpansion:(t,n)=>{e.toggleRowExpansionAdapter(t,n)},clearSort:()=>{e.clearSort()},sort:(t,n)=>{e.commit("sort",{prop:t,order:n})}}}(i),{isHidden:g,renderExpanded:v,setDragVisible:y,isGroup:_,handleMouseLeave:b,handleHeaderFooterMousewheel:x,tableSize:w,emptyBlockStyle:S,handleFixedMousewheel:C,resizeProxyVisible:T,bodyWidth:M,resizeState:E,doLayout:A,tableBodyStyles:P,tableLayout:R,scrollbarViewStyle:L,tableInnerStyle:k,scrollbarStyle:D}=CU(e,a,i,r),{scrollBarRef:I,scrollTo:O,setScrollLeft:N,setScrollTop:B}=(()=>{const e=At(),t=(t,n)=>{const r=e.value;r&&Bs(n)&&["Top","Left"].includes(t)&&r[`setScroll${t}`](n)};return{scrollBarRef:e,scrollTo:(t,n)=>{const r=e.value;r&&r.scrollTo(t,n)},setScrollTop:e=>t("Top",e),setScrollLeft:e=>t("Left",e)}})(),U=gh(A,50),z=`${n.namespace.value}-table_${EU++}`;r.tableId=z,r.state={isGroup:_,resizeState:E,doLayout:A,debouncedUpdateLayout:U};const F=Ki((()=>e.sumText||t("el.table.sumText"))),V=Ki((()=>e.emptyText||t("el.table.emptyText")));return TU(r),{ns:n,layout:a,store:i,handleHeaderFooterMousewheel:x,handleMouseLeave:b,tableId:z,tableSize:w,isHidden:g,isEmpty:s,renderExpanded:v,resizeProxyVisible:T,resizeState:E,isGroup:_,bodyWidth:M,tableBodyStyles:P,emptyBlockStyle:S,debouncedUpdateLayout:U,handleFixedMousewheel:C,setCurrentRow:o,getSelectionRows:l,toggleRowSelection:u,clearSelection:c,clearFilter:d,toggleAllSelection:h,toggleRowExpansion:p,clearSort:f,doLayout:A,sort:m,t:t,setDragVisible:y,context:r,computedSumText:F,computedEmptyText:V,tableLayout:R,scrollbarViewStyle:L,tableInnerStyle:k,scrollbarStyle:D,scrollBarRef:I,scrollTo:O,setScrollLeft:N,setScrollTop:B}}}),PU=["data-prefix"],RU={ref:"hiddenColumns",class:"hidden-columns"};var LU=J_(AU,[["render",function(e,t,n,i,a,s){const o=ur("hColgroup"),u=ur("table-header"),c=ur("table-body"),d=ur("el-scrollbar"),h=ur("table-footer"),p=hr("mousewheel");return fi(),yi("div",{ref:"tableWrapper",class:l([{[e.ns.m("fit")]:e.fit,[e.ns.m("striped")]:e.stripe,[e.ns.m("border")]:e.border||e.isGroup,[e.ns.m("hidden")]:e.isHidden,[e.ns.m("group")]:e.isGroup,[e.ns.m("fluid-height")]:e.maxHeight,[e.ns.m("scrollable-x")]:e.layout.scrollX.value,[e.ns.m("scrollable-y")]:e.layout.scrollY.value,[e.ns.m("enable-row-hover")]:!e.store.states.isComplex.value,[e.ns.m("enable-row-transition")]:0!==(e.store.states.data.value||[]).length&&(e.store.states.data.value||[]).length<100,"has-footer":e.showSummary},e.ns.m(e.tableSize),e.className,e.ns.b(),e.ns.m(`layout-${e.tableLayout}`)]),style:r(e.style),"data-prefix":e.ns.namespace.value,onMouseleave:t[0]||(t[0]=(...t)=>e.handleMouseLeave&&e.handleMouseLeave(...t))},[Ti("div",{class:l(e.ns.e("inner-wrapper")),style:r(e.tableInnerStyle)},[Ti("div",RU,[vr(e.$slots,"default")],512),e.showHeader&&"fixed"===e.tableLayout?ar((fi(),yi("div",{key:0,ref:"headerWrapper",class:l(e.ns.e("header-wrapper"))},[Ti("table",{ref:"tableHeader",class:l(e.ns.e("header")),style:r(e.tableBodyStyles),border:"0",cellpadding:"0",cellspacing:"0"},[Mi(o,{columns:e.store.states.columns.value,"table-layout":e.tableLayout},null,8,["columns","table-layout"]),Mi(u,{ref:"tableHeaderRef",border:e.border,"default-sort":e.defaultSort,store:e.store,onSetDragVisible:e.setDragVisible},null,8,["border","default-sort","store","onSetDragVisible"])],6)],2)),[[p,e.handleHeaderFooterMousewheel]]):Li("v-if",!0),Ti("div",{ref:"bodyWrapper",class:l(e.ns.e("body-wrapper"))},[Mi(d,{ref:"scrollBarRef","view-style":e.scrollbarViewStyle,"wrap-style":e.scrollbarStyle,always:e.scrollbarAlwaysOn},{default:vn((()=>[Ti("table",{ref:"tableBody",class:l(e.ns.e("body")),cellspacing:"0",cellpadding:"0",border:"0",style:r({width:e.bodyWidth,tableLayout:e.tableLayout})},[Mi(o,{columns:e.store.states.columns.value,"table-layout":e.tableLayout},null,8,["columns","table-layout"]),e.showHeader&&"auto"===e.tableLayout?(fi(),_i(u,{key:0,ref:"tableHeaderRef",border:e.border,"default-sort":e.defaultSort,store:e.store,onSetDragVisible:e.setDragVisible},null,8,["border","default-sort","store","onSetDragVisible"])):Li("v-if",!0),Mi(c,{context:e.context,highlight:e.highlightCurrentRow,"row-class-name":e.rowClassName,"tooltip-effect":e.tooltipEffect,"tooltip-options":e.tooltipOptions,"row-style":e.rowStyle,store:e.store,stripe:e.stripe},null,8,["context","highlight","row-class-name","tooltip-effect","tooltip-options","row-style","store","stripe"])],6),e.isEmpty?(fi(),yi("div",{key:0,ref:"emptyBlock",style:r(e.emptyBlockStyle),class:l(e.ns.e("empty-block"))},[Ti("span",{class:l(e.ns.e("empty-text"))},[vr(e.$slots,"empty",{},(()=>[Pi(f(e.computedEmptyText),1)]))],2)],6)):Li("v-if",!0),e.$slots.append?(fi(),yi("div",{key:1,ref:"appendWrapper",class:l(e.ns.e("append-wrapper"))},[vr(e.$slots,"append")],2)):Li("v-if",!0)])),_:3},8,["view-style","wrap-style","always"])],2),e.showSummary?ar((fi(),yi("div",{key:1,ref:"footerWrapper",class:l(e.ns.e("footer-wrapper"))},[Mi(h,{border:e.border,"default-sort":e.defaultSort,store:e.store,style:r(e.tableBodyStyles),"sum-text":e.computedSumText,"summary-method":e.summaryMethod},null,8,["border","default-sort","store","style","sum-text","summary-method"])],2)),[[is,!e.isEmpty],[p,e.handleHeaderFooterMousewheel]]):Li("v-if",!0),e.border||e.isGroup?(fi(),yi("div",{key:2,class:l(e.ns.e("border-left-patch"))},null,2)):Li("v-if",!0)],6),ar(Ti("div",{ref:"resizeProxy",class:l(e.ns.e("column-resize-proxy"))},null,2),[[is,e.resizeProxyVisible]])],46,PU)}],["__file","/home/runner/work/element-plus/element-plus/packages/components/table/src/table.vue"]]);const kU={selection:"table-column--selection",expand:"table__expand-column"},DU={default:{order:""},selection:{width:48,minWidth:48,realWidth:48,order:""},expand:{width:48,minWidth:48,realWidth:48,order:""},index:{width:48,minWidth:48,realWidth:48,order:""}},IU={selection:{renderHeader:({store:e})=>ea(mM,{disabled:e.states.data.value&&0===e.states.data.value.length,size:e.states.tableSize.value,indeterminate:e.states.selection.value.length>0&&!e.states.isAllSelected.value,"onUpdate:modelValue":e.toggleAllSelection,modelValue:e.states.isAllSelected.value}),renderCell:({row:e,column:t,store:n,$index:r})=>ea(mM,{disabled:!!t.selectable&&!t.selectable.call(null,e,r),size:n.states.tableSize.value,onChange:()=>{n.commit("rowSelectedChanged",e)},onClick:e=>e.stopPropagation(),modelValue:n.isSelected(e)}),sortable:!1,resizable:!1},index:{renderHeader:({column:e})=>e.label||"#",renderCell({column:e,$index:t}){let n=t+1;const r=e.index;return"number"==typeof r?n=t+r:"function"==typeof r&&(n=r(t)),ea("div",{},[n])},sortable:!1},expand:{renderHeader:({column:e})=>e.label||"",renderCell({row:e,store:t,expanded:n}){const{ns:r}=t,i=[r.e("expand-icon")];n&&i.push(r.em("expand-icon","expanded"));return ea("div",{class:i,onClick:function(n){n.stopPropagation(),t.toggleRowExpansion(e)}},{default:()=>[ea(ib,null,{default:()=>[ea(mp)]})]})},sortable:!1,resizable:!1}};function OU({row:e,column:t,$index:n}){var r;const i=t.property,a=i&&Hh(e,i).value;return t&&t.formatter?t.formatter(e,t,a,n):(null==(r=null==a?void 0:a.toString)?void 0:r.call(a))||""}function NU(e,t){return e.reduce(((e,t)=>(e[t]=t,e)),t)}function BU(e,t,n){const r=Fi(),i=At(""),a=At(!1),s=At(),o=At(),l=rv("table");Cn((()=>{s.value=e.align?`is-${e.align}`:null,s.value})),Cn((()=>{o.value=e.headerAlign?`is-${e.headerAlign}`:s.value,o.value}));const u=Ki((()=>{let e=r.vnode.vParent||r.parent;for(;e&&!e.tableId&&!e.columnId;)e=e.vnode.vParent||e.parent;return e})),c=Ki((()=>{const{store:e}=r.parent;if(!e)return!1;const{treeData:t}=e.states,n=t.value;return n&&Object.keys(n).length>0})),d=At(zB(e.width)),h=At(FB(e.minWidth));return{columnId:i,realAlign:s,isSubColumn:a,realHeaderAlign:o,columnOrTableParent:u,setColumnWidth:e=>(d.value&&(e.width=d.value),h.value&&(e.minWidth=h.value),!d.value&&h.value&&(e.width=void 0),e.minWidth||(e.minWidth=80),e.realWidth=Number(void 0===e.width?e.minWidth:e.width),e),setColumnForcedProps:e=>{const t=e.type,n=IU[t]||{};Object.keys(n).forEach((t=>{const r=n[t];"className"!==t&&void 0!==r&&(e[t]=r)}));const r=(e=>kU[e]||"")(t);if(r){const t=`${Dt(l.namespace)}-${r}`;e.className=e.className?`${e.className} ${t}`:t}return e},setColumnRenders:i=>{e.renderHeader||"selection"!==i.type&&(i.renderHeader=e=>{r.columnConfig.value.label;const n=t.header;return n?n(e):i.label});let a=i.renderCell;return"expand"===i.type?(i.renderCell=e=>ea("div",{class:"cell"},[a(e)]),n.value.renderExpanded=e=>t.default?t.default(e):t.default):(a=a||OU,i.renderCell=e=>{let s=null;if(t.default){const n=t.default(e);s=n.some((e=>e.type!==ci))?n:a(e)}else s=a(e);const{columns:o}=n.value.store.states,u=o.value.findIndex((e=>"default"===e.type)),d=function({row:e,treeNode:t,store:n},r=!1){const{ns:i}=n;if(!t)return r?[ea("span",{class:i.e("placeholder")})]:null;const a=[],s=function(r){r.stopPropagation(),t.loading||n.loadOrToggle(e)};if(t.indent&&a.push(ea("span",{class:i.e("indent"),style:{"padding-left":`${t.indent}px`}})),"boolean"!=typeof t.expanded||t.noLazyChildren)a.push(ea("span",{class:i.e("placeholder")}));else{const e=[i.e("expand-icon"),t.expanded?i.em("expand-icon","expanded"):""];let n=mp;t.loading&&(n=Gf),a.push(ea("div",{class:e,onClick:s},{default:()=>[ea(ib,{class:{[i.is("loading")]:t.loading}},{default:()=>[ea(n)]})]}))}return a}(e,c.value&&e.cellIndex===u),h={class:"cell",style:{}};return i.showOverflowTooltip&&(h.class=`${h.class} ${Dt(l.namespace)}-tooltip`,h.style={width:(e.column.realWidth||Number(e.column.width))-1+"px"}),(e=>{function t(e){var t;"ElTableColumn"===(null==(t=null==e?void 0:e.type)?void 0:t.name)&&(e.vParent=r)}Array.isArray(e)?e.forEach((e=>t(e))):t(e)})(s),ea("div",h,[d,s])}),i},getPropsData:(...t)=>t.reduce(((t,n)=>(Array.isArray(n)&&n.forEach((n=>{t[n]=e[n]})),t)),{}),getColumnElIndex:(e,t)=>Array.prototype.indexOf.call(e,t),updateColumnOrder:()=>{n.value.store.commit("updateColumnOrder",r.columnConfig.value)}}}var UU={type:{type:String,default:"default"},label:String,className:String,labelClassName:String,property:String,prop:String,width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},renderHeader:Function,sortable:{type:[Boolean,String],default:!1},sortMethod:Function,sortBy:[String,Function,Array],resizable:{type:Boolean,default:!0},columnKey:String,align:String,headerAlign:String,showOverflowTooltip:[Boolean,Object],fixed:[Boolean,String],formatter:Function,selectable:Function,reserveSelection:Boolean,filterMethod:Function,filteredValue:Array,filters:Array,filterPlacement:String,filterMultiple:{type:Boolean,default:!0},index:[Number,Function],sortOrders:{type:Array,default:()=>["ascending","descending",null],validator:e=>e.every((e=>["ascending","descending",null].includes(e)))}};let zU=1;var FU=Fn({name:"ElTableColumn",components:{ElCheckbox:mM},props:UU,setup(e,{slots:t}){const n=Fi(),r=At({}),i=Ki((()=>{let e=n.parent;for(;e&&!e.tableId;)e=e.parent;return e})),{registerNormalWatchers:a,registerComplexWatchers:s}=function(e,t){const n=Fi();return{registerComplexWatchers:()=>{const r={realWidth:"width",realMinWidth:"minWidth"},i=NU(["fixed"],r);Object.keys(i).forEach((i=>{const a=r[i];M(t,a)&&Mn((()=>t[a]),(t=>{let r=t;"width"===a&&"realWidth"===i&&(r=zB(t)),"minWidth"===a&&"realMinWidth"===i&&(r=FB(t)),n.columnConfig.value[a]=r,n.columnConfig.value[i]=r;const s="fixed"===a;e.value.store.scheduleLayout(s)}))}))},registerNormalWatchers:()=>{const e={property:"prop",align:"realAlign",headerAlign:"realHeaderAlign"},r=NU(["label","filters","filterMultiple","sortable","index","formatter","className","labelClassName","showOverflowTooltip"],e);Object.keys(r).forEach((r=>{const i=e[r];M(t,i)&&Mn((()=>t[i]),(e=>{n.columnConfig.value[r]=e}))}))}}}(i,e),{columnId:o,isSubColumn:l,realHeaderAlign:u,columnOrTableParent:c,setColumnWidth:d,setColumnForcedProps:h,setColumnRenders:p,getPropsData:f,getColumnElIndex:m,realAlign:g,updateColumnOrder:v}=BU(e,t,i),y=c.value;o.value=`${y.tableId||y.columnId}_column_${zU++}`,qn((()=>{l.value=i.value!==y;const t=e.type||"default",c=""===e.sortable||e.sortable,m={...DU[t],id:o.value,type:t,property:e.prop||e.property,align:g,headerAlign:u,showOverflowTooltip:e.showOverflowTooltip,filterable:e.filters||e.filterMethod,filteredValue:[],filterPlacement:"",isColumnGroup:!1,isSubColumn:!1,filterOpened:!1,sortable:c,index:e.index,rawColumnKey:n.vnode.key};let v=f(["columnKey","label","className","labelClassName","type","renderHeader","formatter","fixed","resizable"],["sortMethod","sortBy","sortOrders"],["selectable","reserveSelection"],["filterMethod","filters","filterMultiple","filterOpened","filteredValue","filterPlacement"]);v=function(e,t){const n={};let r;for(r in e)n[r]=e[r];for(r in t)if(M(t,r)){const e=t[r];void 0!==e&&(n[r]=e)}return n}(m,v);v=function(...e){return 0===e.length?e=>e:1===e.length?e[0]:e.reduce(((e,t)=>(...n)=>e(t(...n))))}(p,d,h)(v),r.value=v,a(),s()})),Kn((()=>{var e;const t=c.value,a=l.value?t.vnode.el.children:null==(e=t.refs.hiddenColumns)?void 0:e.children,s=()=>m(a||[],n.vnode.el);r.value.getColumnIndex=s;s()>-1&&i.value.store.commit("insertColumn",r.value,l.value?t.columnConfig.value:null,v)})),Qn((()=>{i.value.store.commit("removeColumn",r.value,l.value?y.columnConfig.value:null,v)})),n.columnId=o.value,n.columnConfig=r},render(){var e,t,n;try{const r=null==(t=(e=this.$slots).default)?void 0:t.call(e,{row:{},column:{},$index:-1}),i=[];if(Array.isArray(r))for(const e of r)"ElTableColumn"===(null==(n=e.type)?void 0:n.name)||2&e.shapeFlag?i.push(e):e.type===li&&Array.isArray(e.children)&&e.children.forEach((e=>{1024===(null==e?void 0:e.patchFlag)||D(null==e?void 0:e.children)||i.push(e)}));return ea("div",i)}catch(zA){return ea("div",[])}}});const VU=_g(LU,{TableColumn:FU}),GU=xg(FU);var HU=(e=>(e.ASC="asc",e.DESC="desc",e))(HU||{}),jU=(e=>(e.CENTER="center",e.RIGHT="right",e))(jU||{}),WU=(e=>(e.LEFT="left",e.RIGHT="right",e))(WU||{});const YU={asc:"desc",desc:"asc"},$U=Symbol("placeholder"),XU=(e,t,n)=>{var r;const i={flexGrow:0,flexShrink:0,...n?{}:{flexGrow:e.flexGrow||0,flexShrink:e.flexShrink||1}};n||(i.flexShrink=1);const a={...null!=(r=e.style)?r:{},...i,flexBasis:"auto",width:e.width};return t||(e.maxWidth&&(a.maxWidth=e.maxWidth),e.minWidth&&(a.minWidth=e.minWidth)),a};const qU=(e,{mainTableRef:t,leftTableRef:n,rightTableRef:r})=>{const i=Fi(),{emit:a}=i,s=Pt(!1),o=Pt(null),l=At(e.defaultExpandedRowKeys||[]),u=At(-1),c=Pt(null),d=At({}),h=At({}),p=Pt({}),f=Pt({}),m=Pt({}),g=Ki((()=>Bs(e.estimatedRowHeight)));const v=gh((()=>{var e,a,o,l;s.value=!0,d.value={...Dt(d),...Dt(h)},y(Dt(c),!1),h.value={},c.value=null,null==(e=t.value)||e.forceUpdate(),null==(a=n.value)||a.forceUpdate(),null==(o=r.value)||o.forceUpdate(),null==(l=i.proxy)||l.$forceUpdate(),s.value=!1}),0);function y(e,i=!1){Dt(g)&&[t,n,r].forEach((t=>{const n=Dt(t);n&&n.resetAfterRowIndex(e,i)}))}return{hoveringRowKey:o,expandedRowKeys:l,lastRenderedRowIndex:u,isDynamic:g,isResetting:s,rowHeights:d,resetAfterIndex:y,onRowExpanded:function({expanded:t,rowData:n,rowIndex:r,rowKey:i}){var s,o;const u=[...Dt(l)],c=u.indexOf(i);t?-1===c&&u.push(i):c>-1&&u.splice(c,1),l.value=u,a("update:expandedRowKeys",u),null==(s=e.onRowExpand)||s.call(e,{expanded:t,rowData:n,rowIndex:r,rowKey:i}),null==(o=e.onExpandedRowsChange)||o.call(e,u)},onRowHovered:function({hovered:e,rowKey:t}){o.value=e?t:null},onRowsRendered:function(t){var n;null==(n=e.onRowsRendered)||n.call(e,t),t.rowCacheEnd>Dt(u)&&(u.value=t.rowCacheEnd)},onRowHeightChange:function({rowKey:e,height:t,rowIndex:n},r){r?r===WU.RIGHT?m.value[e]=t:p.value[e]=t:f.value[e]=t;const i=Math.max(...[p,m,f].map((t=>t.value[e]||0)));Dt(d)[e]!==i&&(!function(e,t,n){const r=Dt(c);(null===r||r>n)&&(c.value=n),h.value[e]=t}(e,i,n),v())}}},KU=(e,t)=>e+t,ZU=e=>E(e)?e.reduce(KU,0):e,JU=(e,t,n={})=>k(e)?e(t):null!=e?e:n,QU=e=>(["width","maxWidth","minWidth","height"].forEach((t=>{e[t]=Zh(e[t])})),e),ez=e=>bi(e)?t=>ea(e,t):e;function tz(e){const t=At(),n=At(),r=At(),{columns:i,columnsStyles:a,columnsTotalWidth:s,fixedColumnsOnLeft:o,fixedColumnsOnRight:l,hasFixedColumns:u,mainColumns:c,onColumnSorted:d}=function(e,t,n){const r=Ki((()=>Dt(t).filter((e=>!e.hidden)))),i=Ki((()=>Dt(r).filter((e=>"left"===e.fixed||!0===e.fixed)))),a=Ki((()=>Dt(r).filter((e=>"right"===e.fixed)))),s=Ki((()=>Dt(r).filter((e=>!e.fixed)))),o=Ki((()=>{const e=[];return Dt(i).forEach((t=>{e.push({...t,placeholderSign:$U})})),Dt(s).forEach((t=>{e.push(t)})),Dt(a).forEach((t=>{e.push({...t,placeholderSign:$U})})),e})),l=Ki((()=>Dt(i).length||Dt(a).length)),u=Ki((()=>Dt(t).reduce(((t,r)=>(t[r.key]=XU(r,Dt(n),e.fixed),t)),{}))),c=Ki((()=>Dt(r).reduce(((e,t)=>e+t.width),0))),d=e=>Dt(t).find((t=>t.key===e));return{columns:t,columnsStyles:u,columnsTotalWidth:c,fixedColumnsOnLeft:i,fixedColumnsOnRight:a,hasFixedColumns:l,mainColumns:o,normalColumns:s,visibleColumns:r,getColumn:d,getColumnStyle:e=>Dt(u)[e],updateColumnWidth:(e,t)=>{e.width=t},onColumnSorted:function(t){var n;const{key:r}=t.currentTarget.dataset;if(!r)return;const{sortState:i,sortBy:a}=e;let s=HU.ASC;s=O(i)?YU[i[r]]:YU[a.order],null==(n=e.onColumnSort)||n.call(e,{column:d(r),key:r,order:s})}}}(e,Ut(e,"columns"),Ut(e,"fixed")),{scrollTo:h,scrollToLeft:p,scrollToTop:f,scrollToRow:m,onScroll:g,onVerticalScroll:v,scrollPos:y}=((e,{mainTableRef:t,leftTableRef:n,rightTableRef:r,onMaybeEndReached:i})=>{const a=At({scrollLeft:0,scrollTop:0});function s(e){var i,a,s;const{scrollTop:o}=e;null==(i=t.value)||i.scrollTo(e),null==(a=n.value)||a.scrollToTop(o),null==(s=r.value)||s.scrollToTop(o)}function o(e){a.value=e,s(e)}function l(e){a.value.scrollTop=e,s(Dt(a))}return Mn((()=>Dt(a).scrollTop),((e,t)=>{e>t&&i()})),{scrollPos:a,scrollTo:o,scrollToLeft:function(e){var n,r;a.value.scrollLeft=e,null==(r=null==(n=t.value)?void 0:n.scrollTo)||r.call(n,Dt(a))},scrollToTop:l,scrollToRow:function(e,n="auto"){var r;null==(r=t.value)||r.scrollToRow(e,n)},onScroll:function(t){var n;o(t),null==(n=e.onScroll)||n.call(e,t)},onVerticalScroll:function({scrollTop:e}){const{scrollTop:t}=Dt(a);e!==t&&l(e)}}})(e,{mainTableRef:t,leftTableRef:n,rightTableRef:r,onMaybeEndReached:function(){const{onEndReached:t}=e;if(!t)return;const{scrollTop:n}=Dt(y),r=Dt(F),i=Dt(V),a=r-(n+i)+e.hScrollbarSize;Dt(x)>=0&&r===n+Dt(N)-Dt(W)&&t(a)}}),{expandedRowKeys:_,hoveringRowKey:b,lastRenderedRowIndex:x,isDynamic:w,isResetting:S,rowHeights:C,resetAfterIndex:T,onRowExpanded:M,onRowHeightChange:A,onRowHovered:P,onRowsRendered:R}=qU(e,{mainTableRef:t,leftTableRef:n,rightTableRef:r}),{data:L,depthMap:k}=((e,{expandedRowKeys:t,lastRenderedRowIndex:n,resetAfterIndex:r})=>{const i=At({}),a=Ki((()=>{const n={},{data:r,rowKey:a}=e,s=Dt(t);if(!s||!s.length)return r;const o=[],l=new Set;s.forEach((e=>l.add(e)));let u=r.slice();for(u.forEach((e=>n[e[a]]=0));u.length>0;){const e=u.shift();o.push(e),l.has(e[a])&&Array.isArray(e.children)&&e.children.length>0&&(u=[...e.children,...u],e.children.forEach((t=>n[t[a]]=n[e[a]]+1)))}return i.value=n,o})),s=Ki((()=>{const{data:t,expandColumnKey:n}=e;return n?Dt(a):t}));return Mn(s,((e,t)=>{e!==t&&(n.value=-1,r(0,!0))})),{data:s,depthMap:i}})(e,{expandedRowKeys:_,lastRenderedRowIndex:x,resetAfterIndex:T}),{bodyWidth:D,fixedTableHeight:I,mainTableHeight:N,leftTableWidth:B,rightTableWidth:U,headerWidth:z,rowsHeight:F,windowHeight:V,footerHeight:G,emptyStyle:H,rootStyle:j,headerHeight:W}=((e,{columnsTotalWidth:t,data:n,fixedColumnsOnLeft:r,fixedColumnsOnRight:i})=>{const a=Ki((()=>{const{fixed:n,width:r,vScrollbarSize:i}=e,a=r-i;return n?Math.max(Math.round(Dt(t)),a):a})),s=Ki((()=>Dt(a)+(e.fixed?e.vScrollbarSize:0))),o=Ki((()=>{const{height:t=0,maxHeight:n=0,footerHeight:r,hScrollbarSize:i}=e;if(n>0){const e=Dt(f),t=Dt(l),a=Dt(p)+e+t+i;return Math.min(a,n-r)}return t-r})),l=Ki((()=>{const{rowHeight:t,estimatedRowHeight:r}=e,i=Dt(n);return Bs(r)?i.length*r:i.length*t})),u=Ki((()=>{const{maxHeight:t}=e,n=Dt(o);if(Bs(t)&&t>0)return n;const r=Dt(l)+Dt(p)+Dt(f);return Math.min(n,r)})),c=e=>e.width,d=Ki((()=>ZU(Dt(r).map(c)))),h=Ki((()=>ZU(Dt(i).map(c)))),p=Ki((()=>ZU(e.headerHeight))),f=Ki((()=>{var t;return((null==(t=e.fixedData)?void 0:t.length)||0)*e.rowHeight})),m=Ki((()=>Dt(o)-Dt(p)-Dt(f))),g=Ki((()=>{const{style:t={},height:n,width:r}=e;return QU({...t,height:n,width:r})})),v=Ki((()=>QU({height:e.footerHeight}))),y=Ki((()=>({top:Zh(Dt(p)),bottom:Zh(e.footerHeight),width:Zh(e.width)})));return{bodyWidth:a,fixedTableHeight:u,mainTableHeight:o,leftTableWidth:d,rightTableWidth:h,headerWidth:s,rowsHeight:l,windowHeight:m,footerHeight:v,emptyStyle:y,rootStyle:g,headerHeight:p}})(e,{columnsTotalWidth:s,data:L,fixedColumnsOnLeft:o,fixedColumnsOnRight:l}),Y=Pt(!1),$=At(),X=Ki((()=>{const t=0===Dt(L).length;return E(e.fixedData)?0===e.fixedData.length&&t:t}));return Mn((()=>e.expandedRowKeys),(e=>_.value=e),{deep:!0}),{columns:i,containerRef:$,mainTableRef:t,leftTableRef:n,rightTableRef:r,isDynamic:w,isResetting:S,isScrolling:Y,hoveringRowKey:b,hasFixedColumns:u,columnsStyles:a,columnsTotalWidth:s,data:L,expandedRowKeys:_,depthMap:k,fixedColumnsOnLeft:o,fixedColumnsOnRight:l,mainColumns:c,bodyWidth:D,emptyStyle:H,rootStyle:j,headerWidth:z,footerHeight:G,mainTableHeight:N,fixedTableHeight:I,leftTableWidth:B,rightTableWidth:U,showEmpty:X,getRowHeight:function(t){const{estimatedRowHeight:n,rowHeight:r,rowKey:i}=e;return n?Dt(C)[Dt(L)[t][i]]||n:r},onColumnSorted:d,onRowHovered:P,onRowExpanded:M,onRowsRendered:R,onRowHeightChange:A,scrollTo:h,scrollToLeft:p,scrollToTop:f,scrollToRow:m,onScroll:g,onVerticalScroll:v}}const nz=Symbol("tableV2"),rz=String,iz={type:Array,required:!0},az={type:Array},sz={...az,required:!0},oz={type:Array,default:()=>[]},lz={type:Number,required:!0},uz={type:[String,Number,Symbol],default:"id"},cz={type:Object},dz=pg({class:String,columns:iz,columnsStyles:{type:Object,required:!0},depth:Number,expandColumnKey:String,estimatedRowHeight:{...TO.estimatedRowHeight,default:void 0},isScrolling:Boolean,onRowExpand:{type:Function},onRowHover:{type:Function},onRowHeightChange:{type:Function},rowData:{type:Object,required:!0},rowEventHandlers:{type:Object},rowIndex:{type:Number,required:!0},rowKey:uz,style:{type:Object}}),hz={type:Number,required:!0},pz=pg({class:String,columns:iz,fixedHeaderData:{type:Array},headerData:{type:Array,required:!0},headerHeight:{type:[Number,Array],default:50},rowWidth:hz,rowHeight:{type:Number,default:50},height:hz,width:hz}),fz=pg({columns:iz,data:sz,fixedData:az,estimatedRowHeight:dz.estimatedRowHeight,width:lz,height:lz,headerWidth:lz,headerHeight:pz.headerHeight,bodyWidth:lz,rowHeight:lz,cache:xO.cache,useIsScrolling:Boolean,scrollbarAlwaysOn:TO.scrollbarAlwaysOn,scrollbarStartGap:TO.scrollbarStartGap,scrollbarEndGap:TO.scrollbarEndGap,class:rz,style:cz,containerStyle:cz,getRowHeight:{type:Function,required:!0},rowKey:dz.rowKey,onRowsRendered:{type:Function},onScroll:{type:Function}}),mz=pg({cache:fz.cache,estimatedRowHeight:dz.estimatedRowHeight,rowKey:uz,headerClass:{type:[String,Function]},headerProps:{type:[Object,Function]},headerCellProps:{type:[Object,Function]},headerHeight:pz.headerHeight,footerHeight:{type:Number,default:0},rowClass:{type:[String,Function]},rowProps:{type:[Object,Function]},rowHeight:{type:Number,default:50},cellProps:{type:[Object,Function]},columns:iz,data:sz,dataGetter:{type:Function},fixedData:az,expandColumnKey:dz.expandColumnKey,expandedRowKeys:oz,defaultExpandedRowKeys:oz,class:rz,fixed:Boolean,style:{type:Object},width:lz,height:lz,maxHeight:Number,useIsScrolling:Boolean,indentSize:{type:Number,default:12},iconSize:{type:Number,default:12},hScrollbarSize:TO.hScrollbarSize,vScrollbarSize:TO.vScrollbarSize,scrollbarAlwaysOn:MO.alwaysOn,sortBy:{type:Object,default:()=>({})},sortState:{type:Object,default:void 0},onColumnSort:{type:Function},onExpandedRowsChange:{type:Function},onEndReached:{type:Function},onRowExpand:dz.onRowExpand,onScroll:fz.onScroll,onRowsRendered:fz.onRowsRendered,rowEventHandlers:dz.rowEventHandlers}),gz=(e,{slots:t})=>{var n;const{cellData:r,style:i}=e,a=(null==(n=null==r?void 0:r.toString)?void 0:n.call(r))||"";return Mi("div",{class:e.class,title:a,style:i},[t.default?t.default(e):a])};gz.displayName="ElTableV2Cell",gz.inheritAttrs=!1;const vz=(e,{slots:t})=>{var n,r;return t.default?t.default(e):Mi("div",{class:e.class,title:null==(n=e.column)?void 0:n.title},[null==(r=e.column)?void 0:r.title])};vz.displayName="ElTableV2HeaderCell",vz.inheritAttrs=!1;const yz=Fn({name:"ElTableV2HeaderRow",props:pg({class:String,columns:iz,columnsStyles:{type:Object,required:!0},headerIndex:Number,style:{type:Object}}),setup:(e,{slots:t})=>()=>{const{columns:n,columnsStyles:r,headerIndex:i,style:a}=e;let s=n.map(((e,a)=>t.cell({columns:n,column:e,columnIndex:a,headerIndex:i,style:r[e.key]})));return t.header&&(s=t.header({cells:s.map((e=>E(e)&&1===e.length?e[0]:e)),columns:n,headerIndex:i})),Mi("div",{class:e.class,style:a,role:"row"},[s])}}),_z=Fn({name:"ElTableV2Header",props:pz,setup(e,{slots:t,expose:n}){const r=rv("table-v2"),i=At(),a=Ki((()=>QU({width:e.width,height:e.height}))),s=Ki((()=>QU({width:e.rowWidth,height:e.height}))),o=Ki((()=>ec(Dt(e.headerHeight)))),l=()=>{const n=r.e("fixed-header-row"),{columns:i,fixedHeaderData:a,rowHeight:s}=e;return null==a?void 0:a.map(((e,r)=>{var a;const o=QU({height:s,width:"100%"});return null==(a=t.fixed)?void 0:a.call(t,{class:n,columns:i,rowData:e,rowIndex:-(r+1),style:o})}))},u=()=>{const n=r.e("dynamic-header-row"),{columns:i}=e;return Dt(o).map(((e,r)=>{var a;const s=QU({width:"100%",height:e});return null==(a=t.dynamic)?void 0:a.call(t,{class:n,columns:i,headerIndex:r,style:s})}))};return n({scrollToLeft:e=>{const t=Dt(i);en((()=>{(null==t?void 0:t.scroll)&&t.scroll({left:e})}))}}),()=>{if(!(e.height<=0))return Mi("div",{ref:i,class:e.class,style:Dt(a),role:"rowgroup"},[Mi("div",{style:Dt(s),class:r.e("header")},[u(),l()])])}}}),bz=e=>{const{isScrolling:t}=Sn(nz),n=At(!1),r=At(),i=Ki((()=>Bs(e.estimatedRowHeight)&&e.rowIndex>=0)),a=Ki((()=>{const{rowData:t,rowIndex:n,rowKey:r,onRowHover:i}=e,a=e.rowEventHandlers||{},s={};return Object.entries(a).forEach((([e,i])=>{k(i)&&(s[e]=e=>{i({event:e,rowData:t,rowIndex:n,rowKey:r})})})),i&&[{name:"onMouseleave",hovered:!1},{name:"onMouseenter",hovered:!0}].forEach((({name:e,hovered:a})=>{const o=s[e];s[e]=e=>{i({event:e,hovered:a,rowData:t,rowIndex:n,rowKey:r}),null==o||o(e)}})),s}));return Kn((()=>{Dt(i)&&((t=!1)=>{const i=Dt(r);if(!i)return;const{columns:a,onRowHeightChange:s,rowKey:o,rowIndex:l,style:u}=e,{height:c}=i.getBoundingClientRect();n.value=!0,en((()=>{if(t||c!==Number.parseInt(u.height)){const e=a[0],t=(null==e?void 0:e.placeholderSign)===$U;null==s||s({rowKey:o,height:c,rowIndex:l},e&&!t&&e.fixed)}}))})(!0)})),{isScrolling:t,measurable:i,measured:n,rowRef:r,eventHandlers:a,onExpand:t=>{const{onRowExpand:n,rowData:r,rowIndex:i,rowKey:a}=e;null==n||n({expanded:t,rowData:r,rowIndex:i,rowKey:a})}}},xz=Fn({name:"ElTableV2TableRow",props:dz,setup(e,{expose:t,slots:n,attrs:r}){const{eventHandlers:i,isScrolling:a,measurable:s,measured:o,rowRef:l,onExpand:u}=bz(e);return t({onExpand:u}),()=>{const{columns:t,columnsStyles:c,expandColumnKey:d,depth:h,rowData:p,rowIndex:f,style:m}=e;let g=t.map(((e,r)=>{const i=E(p.children)&&p.children.length>0&&e.key===d;return n.cell({column:e,columns:t,columnIndex:r,depth:h,style:c[e.key],rowData:p,rowIndex:f,isScrolling:Dt(a),expandIconProps:i?{rowData:p,rowIndex:f,onExpand:u}:void 0})}));if(n.row&&(g=n.row({cells:g.map((e=>E(e)&&1===e.length?e[0]:e)),style:m,columns:t,depth:h,rowData:p,rowIndex:f,isScrolling:Dt(a)})),Dt(s)){const{height:t,...n}=m||{},a=Dt(o);return Mi("div",Oi({ref:l,class:e.class,style:a?m:n,role:"row"},r,Dt(i)),[g])}return Mi("div",Oi(r,{ref:l,class:e.class,style:m,role:"row"},Dt(i)),[g])}}}),wz=e=>{const{sortOrder:t}=e;return Mi(ib,{size:14,class:e.class},{default:()=>[t===HU.ASC?Mi(Nm,null,null):Mi(km,null,null)]})},Sz=e=>{const{expanded:t,expandable:n,onExpand:r,style:i,size:a}=e,s={onClick:n?()=>r(!t):void 0,class:e.class};return Mi(ib,Oi(s,{size:a,style:i}),{default:()=>[Mi(mp,null,null)]})},Cz=Fn({name:"ElTableV2Grid",props:fz,setup(e,{slots:t,expose:n}){const{ns:r}=Sn(nz),{bodyRef:i,fixedRowHeight:a,gridHeight:s,hasHeader:o,headerRef:l,headerHeight:u,totalHeight:c,forceUpdate:d,itemKey:h,onItemRendered:p,resetAfterRowIndex:f,scrollTo:m,scrollToTop:g,scrollToRow:v}=(e=>{const t=At(),n=At(),r=Ki((()=>{const{data:t,rowHeight:n,estimatedRowHeight:r}=e;if(!r)return t.length*n})),i=Ki((()=>{const{fixedData:t,rowHeight:n}=e;return((null==t?void 0:t.length)||0)*n})),a=Ki((()=>ZU(e.headerHeight))),s=Ki((()=>{const{height:t}=e;return Math.max(0,t-Dt(a)-Dt(i))})),o=Ki((()=>Dt(a)+Dt(i)>0));return{bodyRef:n,forceUpdate:function(){var e,r;null==(e=Dt(n))||e.$forceUpdate(),null==(r=Dt(t))||r.$forceUpdate()},fixedRowHeight:i,gridHeight:s,hasHeader:o,headerHeight:a,headerRef:t,totalHeight:r,itemKey:({data:t,rowIndex:n})=>t[n][e.rowKey],onItemRendered:function({rowCacheStart:t,rowCacheEnd:n,rowVisibleStart:r,rowVisibleEnd:i}){var a;null==(a=e.onRowsRendered)||a.call(e,{rowCacheStart:t,rowCacheEnd:n,rowVisibleStart:r,rowVisibleEnd:i})},resetAfterRowIndex:function(e,t){var r;null==(r=n.value)||r.resetAfterRowIndex(e,t)},scrollTo:function(e,r){const i=Dt(t),a=Dt(n);i&&a&&(O(e)?(i.scrollToLeft(e.scrollLeft),a.scrollTo(e)):(i.scrollToLeft(e),a.scrollTo({scrollLeft:e,scrollTop:r})))},scrollToTop:function(e){var t;null==(t=Dt(n))||t.scrollTo({scrollTop:e})},scrollToRow:function(e,t){var r;null==(r=Dt(n))||r.scrollToItem(e,1,t)}}})(e);n({forceUpdate:d,totalHeight:c,scrollTo:m,scrollToTop:g,scrollToRow:v,resetAfterRowIndex:f});const y=()=>e.bodyWidth;return()=>{const{cache:n,columns:c,data:d,fixedData:f,useIsScrolling:m,scrollbarAlwaysOn:g,scrollbarEndGap:v,scrollbarStartGap:_,style:b,rowHeight:x,bodyWidth:w,estimatedRowHeight:S,headerWidth:C,height:T,width:M,getRowHeight:E,onScroll:A}=e,P=Bs(S),R=P?eN:VO,L=Dt(u);return Mi("div",{role:"table",class:[r.e("table"),e.class],style:b},[Mi(R,{ref:i,data:d,useIsScrolling:m,itemKey:h,columnCache:0,columnWidth:P?y:w,totalColumn:1,totalRow:d.length,rowCache:n,rowHeight:P?E:x,width:M,height:Dt(s),class:r.e("body"),role:"rowgroup",scrollbarStartGap:_,scrollbarEndGap:v,scrollbarAlwaysOn:g,onScroll:A,onItemRendered:p,perfMode:!1},{default:e=>{var n;const r=d[e.rowIndex];return null==(n=t.row)?void 0:n.call(t,{...e,columns:c,rowData:r})}}),Dt(o)&&Mi(_z,{ref:l,class:r.e("header-wrapper"),columns:c,headerData:d,headerHeight:e.headerHeight,fixedHeaderData:f,rowWidth:C,rowHeight:x,width:M,height:Math.min(L+Dt(a),T)},{dynamic:t.header,fixed:t.row})])}}});const Tz=(e,{slots:t})=>{const{mainTableRef:n,...r}=e;return Mi(Cz,Oi({ref:n},r),"function"==typeof(i=t)||"[object Object]"===Object.prototype.toString.call(i)&&!bi(i)?t:{default:()=>[t]});var i};const Mz=(e,{slots:t})=>{if(!e.columns.length)return;const{leftTableRef:n,...r}=e;return Mi(Cz,Oi({ref:n},r),"function"==typeof(i=t)||"[object Object]"===Object.prototype.toString.call(i)&&!bi(i)?t:{default:()=>[t]});var i};const Ez=(e,{slots:t})=>{if(!e.columns.length)return;const{rightTableRef:n,...r}=e;return Mi(Cz,Oi({ref:n},r),"function"==typeof(i=t)||"[object Object]"===Object.prototype.toString.call(i)&&!bi(i)?t:{default:()=>[t]});var i};const Az=(e,{slots:t})=>{const{columns:n,columnsStyles:r,depthMap:i,expandColumnKey:a,expandedRowKeys:s,estimatedRowHeight:o,hasFixedColumns:l,hoveringRowKey:u,rowData:c,rowIndex:d,style:h,isScrolling:p,rowProps:f,rowClass:m,rowKey:g,rowEventHandlers:v,ns:y,onRowHovered:_,onRowExpanded:b}=e,x=JU(m,{columns:n,rowData:c,rowIndex:d},""),w=JU(f,{columns:n,rowData:c,rowIndex:d}),S=c[g],C=i[S]||0,T=Boolean(a),M=d<0,E={...w,columns:n,columnsStyles:r,class:[y.e("row"),x,{[y.e(`row-depth-${C}`)]:T&&d>=0,[y.is("expanded")]:T&&s.includes(S),[y.is("hovered")]:!p&&S===u,[y.is("fixed")]:!C&&M,[y.is("customized")]:Boolean(t.row)}],depth:C,expandColumnKey:a,estimatedRowHeight:M?void 0:o,isScrolling:p,rowIndex:d,rowData:c,rowKey:S,rowEventHandlers:v,style:h};return Mi(xz,Oi(E,{onRowHover:l?_:void 0,onRowExpand:b}),"function"==typeof(A=t)||"[object Object]"===Object.prototype.toString.call(A)&&!bi(A)?t:{default:()=>[t]});var A},Pz=({columns:e,column:t,columnIndex:n,depth:r,expandIconProps:i,isScrolling:a,rowData:s,rowIndex:o,style:l,expandedRowKeys:u,ns:c,cellProps:d,expandColumnKey:h,indentSize:p,iconSize:f,rowKey:m},{slots:g})=>{const v=QU(l);if(t.placeholderSign===$U)return Mi("div",{class:c.em("row-cell","placeholder"),style:v},null);const{cellRenderer:y,dataKey:_,dataGetter:b}=t,x=ez(y)||g.default||(e=>Mi(gz,e,null)),w=k(b)?b({columns:e,column:t,columnIndex:n,rowData:s,rowIndex:o}):Vu(s,null!=_?_:""),S=JU(d,{cellData:w,columns:e,column:t,columnIndex:n,rowIndex:o,rowData:s}),C=x({class:c.e("cell-text"),columns:e,column:t,columnIndex:n,cellData:w,isScrolling:a,rowData:s,rowIndex:o}),T=[c.e("row-cell"),t.class,t.align===jU.CENTER&&c.is("align-center"),t.align===jU.RIGHT&&c.is("align-right")],M=o>=0&&t.key===h,E=o>=0&&u.includes(s[m]);let A;const P=`margin-inline-start: ${r*p}px;`;return M&&(A=O(i)?Mi(Sz,Oi(i,{class:[c.e("expand-icon"),c.is("expanded",E)],size:f,expanded:E,style:P,expandable:!0}),null):Mi("div",{style:[P,`width: ${f}px; height: ${f}px;`].join(" ")},null)),Mi("div",Oi({class:T,style:v},S,{role:"cell"}),[A,C])};Pz.inheritAttrs=!1;const Rz=({columns:e,columnsStyles:t,headerIndex:n,style:r,headerClass:i,headerProps:a,ns:s},{slots:o})=>{const l={columns:e,headerIndex:n},u=[s.e("header-row"),JU(i,l,""),{[s.is("customized")]:Boolean(o.header)}],c={...JU(a,l),columnsStyles:t,class:u,columns:e,headerIndex:n,style:r};return Mi(yz,c,"function"==typeof(d=o)||"[object Object]"===Object.prototype.toString.call(d)&&!bi(d)?o:{default:()=>[o]});var d},Lz=(e,{slots:t})=>{const{column:n,ns:r,style:i,onColumnSorted:a}=e,s=QU(i);if(n.placeholderSign===$U)return Mi("div",{class:r.em("header-row-cell","placeholder"),style:s},null);const{headerCellRenderer:o,headerClass:l,sortable:u}=n,c={...e,class:r.e("header-cell-text")},d=(ez(o)||t.default||(e=>Mi(vz,e,null)))(c),{sortBy:h,sortState:p,headerCellProps:f}=e;let m,g;if(p){const e=p[n.key];m=Boolean(YU[e]),g=m?e:HU.ASC}else m=n.key===h.key,g=m?h.order:HU.ASC;const v=[r.e("header-cell"),JU(l,e,""),n.align===jU.CENTER&&r.is("align-center"),n.align===jU.RIGHT&&r.is("align-right"),u&&r.is("sortable")],y={...JU(f,e),onClick:n.sortable?a:void 0,class:v,style:s,"data-key":n.key};return Mi("div",Oi(y,{role:"columnheader"}),[d,u&&Mi(wz,{class:[r.e("sort-icon"),m&&r.is("sorting")],sortOrder:g},null)])},kz=(e,{slots:t})=>{var n;return Mi("div",{class:e.class,style:e.style},[null==(n=t.default)?void 0:n.call(t)])};kz.displayName="ElTableV2Footer";const Dz=(e,{slots:t})=>Mi("div",{class:e.class,style:e.style},[t.default?t.default():Mi(hk,null,null)]);Dz.displayName="ElTableV2Empty";const Iz=(e,{slots:t})=>{var n;return Mi("div",{class:e.class,style:e.style},[null==(n=t.default)?void 0:n.call(t)])};function Oz(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!bi(e)}Iz.displayName="ElTableV2Overlay";const Nz=Fn({name:"ElTableV2",props:mz,setup(e,{slots:t,expose:n}){const r=rv("table-v2"),{columnsStyles:i,fixedColumnsOnLeft:a,fixedColumnsOnRight:s,mainColumns:o,mainTableHeight:l,fixedTableHeight:u,leftTableWidth:c,rightTableWidth:d,data:h,depthMap:p,expandedRowKeys:f,hasFixedColumns:m,hoveringRowKey:g,mainTableRef:v,leftTableRef:y,rightTableRef:_,isDynamic:b,isResetting:x,isScrolling:w,bodyWidth:S,emptyStyle:C,rootStyle:T,headerWidth:M,footerHeight:E,showEmpty:A,scrollTo:P,scrollToLeft:R,scrollToTop:L,scrollToRow:k,getRowHeight:D,onColumnSorted:I,onRowHeightChange:O,onRowHovered:N,onRowExpanded:B,onRowsRendered:U,onScroll:z,onVerticalScroll:F}=tz(e);return n({scrollTo:P,scrollToLeft:R,scrollToTop:L,scrollToRow:k}),wn(nz,{ns:r,isResetting:x,hoveringRowKey:g,isScrolling:w}),()=>{const{cache:n,cellProps:x,estimatedRowHeight:w,expandColumnKey:P,fixedData:R,headerHeight:L,headerClass:k,headerProps:V,headerCellProps:G,sortBy:H,sortState:j,rowHeight:W,rowClass:Y,rowEventHandlers:$,rowKey:X,rowProps:q,scrollbarAlwaysOn:K,indentSize:Z,iconSize:J,useIsScrolling:Q,vScrollbarSize:ee,width:te}=e,ne=Dt(h),re={cache:n,class:r.e("main"),columns:Dt(o),data:ne,fixedData:R,estimatedRowHeight:w,bodyWidth:Dt(S),headerHeight:L,headerWidth:Dt(M),height:Dt(l),mainTableRef:v,rowKey:X,rowHeight:W,scrollbarAlwaysOn:K,scrollbarStartGap:2,scrollbarEndGap:ee,useIsScrolling:Q,width:te,getRowHeight:D,onRowsRendered:U,onScroll:z},ie=Dt(c),ae=Dt(u),se={cache:n,class:r.e("left"),columns:Dt(a),data:ne,estimatedRowHeight:w,leftTableRef:y,rowHeight:W,bodyWidth:ie,headerWidth:ie,headerHeight:L,height:ae,rowKey:X,scrollbarAlwaysOn:K,scrollbarStartGap:2,scrollbarEndGap:ee,useIsScrolling:Q,width:ie,getRowHeight:D,onScroll:F},oe=Dt(d)+ee,le={cache:n,class:r.e("right"),columns:Dt(s),data:ne,estimatedRowHeight:w,rightTableRef:_,rowHeight:W,bodyWidth:oe,headerWidth:oe,headerHeight:L,height:ae,rowKey:X,scrollbarAlwaysOn:K,scrollbarStartGap:2,scrollbarEndGap:ee,width:oe,style:`--${Dt(r.namespace)}-table-scrollbar-size: ${ee}px`,useIsScrolling:Q,getRowHeight:D,onScroll:F},ue=Dt(i),ce={ns:r,depthMap:Dt(p),columnsStyles:ue,expandColumnKey:P,expandedRowKeys:Dt(f),estimatedRowHeight:w,hasFixedColumns:Dt(m),hoveringRowKey:Dt(g),rowProps:q,rowClass:Y,rowKey:X,rowEventHandlers:$,onRowHovered:N,onRowExpanded:B,onRowHeightChange:O},de={cellProps:x,expandColumnKey:P,indentSize:Z,iconSize:J,rowKey:X,expandedRowKeys:Dt(f),ns:r},he={ns:r,headerClass:k,headerProps:V,columnsStyles:ue},pe={ns:r,sortBy:H,sortState:j,headerCellProps:G,onColumnSorted:I},fe={row:e=>Mi(Az,Oi(e,ce),{row:t.row,cell:e=>{let n;return t.cell?Mi(Pz,Oi(e,de,{style:ue[e.column.key]}),Oz(n=t.cell(e))?n:{default:()=>[n]}):Mi(Pz,Oi(e,de,{style:ue[e.column.key]}),null)}}),header:e=>Mi(Rz,Oi(e,he),{header:t.header,cell:e=>{let n;return t["header-cell"]?Mi(Lz,Oi(e,pe,{style:ue[e.column.key]}),Oz(n=t["header-cell"](e))?n:{default:()=>[n]}):Mi(Lz,Oi(e,pe,{style:ue[e.column.key]}),null)}})},me=[e.class,r.b(),r.e("root"),{[r.is("dynamic")]:Dt(b)}],ge={class:r.e("footer"),style:Dt(E)};return Mi("div",{class:me,style:Dt(T)},[Mi(Tz,re,Oz(fe)?fe:{default:()=>[fe]}),Mi(Mz,se,Oz(fe)?fe:{default:()=>[fe]}),Mi(Ez,le,Oz(fe)?fe:{default:()=>[fe]}),t.footer&&Mi(kz,ge,{default:t.footer}),Dt(A)&&Mi(Dz,{class:r.e("empty"),style:Dt(C)},{default:t.empty}),t.overlay&&Mi(Iz,{class:r.e("overlay")},{default:t.overlay})])}}}),Bz=Fn({name:"ElAutoResizer",props:pg({disableWidth:Boolean,disableHeight:Boolean,onResize:{type:Function}}),setup(e,{slots:t}){const n=rv("auto-resizer"),{height:r,width:i,sizer:a}=(e=>{const t=At(),n=At(0),r=At(0);let i;return Kn((()=>{i=lo(t,(([e])=>{const{width:t,height:i}=e.contentRect,{paddingLeft:a,paddingRight:s,paddingTop:o,paddingBottom:l}=getComputedStyle(e.target),u=Number.parseInt(a)||0,c=Number.parseInt(s)||0,d=Number.parseInt(o)||0,h=Number.parseInt(l)||0;n.value=t-u-c,r.value=i-d-h})).stop})),Qn((()=>{null==i||i()})),Mn([n,r],(([t,n])=>{var r;null==(r=e.onResize)||r.call(e,{width:t,height:n})})),{sizer:t,width:n,height:r}})(e),s={width:"100%",height:"100%"};return()=>{var e;return Mi("div",{ref:a,class:n.b(),style:s},[null==(e=t.default)?void 0:e.call(t,{height:r.value,width:i.value})])}}}),Uz=_g(Nz),zz=_g(Bz),Fz=Symbol("tabsRootContextKey"),Vz=pg({tabs:{type:Array,default:()=>[]}}),Gz="ElTabBar",Hz=Fn({name:Gz});var jz=J_(Fn({...Hz,props:Vz,setup(e,{expose:t}){const n=e,i=Fi(),a=Sn(Fz);a||Wh(Gz,"<el-tabs><el-tab-bar /></el-tabs>");const s=rv("tabs"),o=At(),u=At(),c=()=>u.value=(()=>{let e=0,t=0;const r=["top","bottom"].includes(a.props.tabPosition)?"width":"height",s="width"===r?"x":"y",o="x"===s?"left":"top";return n.tabs.every((a=>{var s,l;const u=null==(l=null==(s=i.parent)?void 0:s.refs)?void 0:l[`tab-${a.uid}`];if(!u)return!1;if(!a.active)return!0;e=u[`offset${Vh(o)}`],t=u[`client${Vh(r)}`];const c=window.getComputedStyle(u);return"width"===r&&(n.tabs.length>1&&(t-=Number.parseFloat(c.paddingLeft)+Number.parseFloat(c.paddingRight)),e+=Number.parseFloat(c.paddingLeft)),!1})),{[r]:`${t}px`,transform:`translate${Vh(s)}(${e}px)`}})();return Mn((()=>n.tabs),(async()=>{await en(),c()}),{immediate:!0}),lo(o,(()=>c())),t({ref:o,update:c}),(e,t)=>(fi(),yi("div",{ref_key:"barRef",ref:o,class:l([Dt(s).e("active-bar"),Dt(s).is(Dt(a).props.tabPosition)]),style:r(u.value)},null,6))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/tabs/src/tab-bar.vue"]]);const Wz=pg({panes:{type:Array,default:()=>[]},currentName:{type:[String,Number],default:""},editable:Boolean,type:{type:String,values:["card","border-card",""],default:""},stretch:Boolean}),Yz="ElTabNav",$z=Fn({name:Yz,props:Wz,emits:{tabClick:(e,t,n)=>n instanceof Event,tabRemove:(e,t)=>t instanceof Event},setup(e,{expose:t,emit:n}){const r=Fi(),i=Sn(Fz);i||Wh(Yz,"<el-tabs><tab-nav /></el-tabs>");const a=rv("tabs"),s=function({document:e=Ks}={}){if(!e)return At("visible");const t=At(e.visibilityState);return Zs(e,"visibilitychange",(()=>{t.value=e.visibilityState})),t}(),o=function({window:e=qs}={}){if(!e)return At(!1);const t=At(e.document.hasFocus());return Zs(e,"blur",(()=>{t.value=!1})),Zs(e,"focus",(()=>{t.value=!0})),t}(),l=At(),u=At(),c=At(),d=At(),h=At(!1),p=At(0),f=At(!1),m=At(!0),g=Ki((()=>["top","bottom"].includes(i.props.tabPosition)?"width":"height")),v=Ki((()=>({transform:`translate${"width"===g.value?"X":"Y"}(-${p.value}px)`}))),y=()=>{if(!l.value)return;const e=l.value[`offset${Vh(g.value)}`],t=p.value;if(!t)return;const n=t>e?t-e:0;p.value=n},_=()=>{if(!l.value||!u.value)return;const e=u.value[`offset${Vh(g.value)}`],t=l.value[`offset${Vh(g.value)}`],n=p.value;if(e-n<=t)return;const r=e-n>2*t?n+t:e-t;p.value=r},b=async()=>{const e=u.value;if(!(h.value&&c.value&&l.value&&e))return;await en();const t=c.value.querySelector(".is-active");if(!t)return;const n=l.value,r=["top","bottom"].includes(i.props.tabPosition),a=t.getBoundingClientRect(),s=n.getBoundingClientRect(),o=r?e.offsetWidth-s.width:e.offsetHeight-s.height,d=p.value;let f=d;r?(a.left<s.left&&(f=d-(s.left-a.left)),a.right>s.right&&(f=d+a.right-s.right)):(a.top<s.top&&(f=d-(s.top-a.top)),a.bottom>s.bottom&&(f=d+(a.bottom-s.bottom))),f=Math.max(f,0),p.value=Math.min(f,o)},x=()=>{var t;if(!u.value||!l.value)return;e.stretch&&(null==(t=d.value)||t.update());const n=u.value[`offset${Vh(g.value)}`],r=l.value[`offset${Vh(g.value)}`],i=p.value;r<n?(h.value=h.value||{},h.value.prev=i,h.value.next=i+r<n,n-i<r&&(p.value=n-r)):(h.value=!1,i>0&&(p.value=0))},w=e=>{const t=e.code,{up:n,down:r,left:i,right:a}=Sg;if(![n,r,i,a].includes(t))return;const s=Array.from(e.currentTarget.querySelectorAll("[role=tab]:not(.is-disabled)")),o=s.indexOf(e.target);let l;l=t===i||t===n?0===o?s.length-1:o-1:o<s.length-1?o+1:0,s[l].focus({preventScroll:!0}),s[l].click(),S()},S=()=>{m.value&&(f.value=!0)},C=()=>f.value=!1;return Mn(s,(e=>{"hidden"===e?m.value=!1:"visible"===e&&setTimeout((()=>m.value=!0),50)})),Mn(o,(e=>{e?setTimeout((()=>m.value=!0),50):m.value=!1})),lo(c,x),Kn((()=>setTimeout((()=>b()),0))),Jn((()=>x())),t({scrollToActiveTab:b,removeFocus:C}),Mn((()=>e.panes),(()=>r.update()),{flush:"post",deep:!0}),()=>{const t=h.value?[Mi("span",{class:[a.e("nav-prev"),a.is("disabled",!h.value.prev)],onClick:y},[Mi(ib,null,{default:()=>[Mi(dp,null,null)]})]),Mi("span",{class:[a.e("nav-next"),a.is("disabled",!h.value.next)],onClick:_},[Mi(ib,null,{default:()=>[Mi(mp,null,null)]})])]:null,r=e.panes.map(((t,r)=>{var s,o,l,u;const c=t.uid,d=t.props.disabled,h=null!=(o=null!=(s=t.props.name)?s:t.index)?o:`${r}`,p=!d&&(t.isClosable||e.editable);t.index=`${r}`;const m=p?Mi(ib,{class:"is-icon-close",onClick:e=>n("tabRemove",t,e)},{default:()=>[Mi(cf,null,null)]}):null,g=(null==(u=(l=t.slots).label)?void 0:u.call(l))||t.props.label,v=!d&&t.active?0:-1;return Mi("div",{ref:`tab-${c}`,class:[a.e("item"),a.is(i.props.tabPosition),a.is("active",t.active),a.is("disabled",d),a.is("closable",p),a.is("focus",f.value)],id:`tab-${h}`,key:`tab-${c}`,"aria-controls":`pane-${h}`,role:"tab","aria-selected":t.active,tabindex:v,onFocus:()=>S(),onBlur:()=>C(),onClick:e=>{C(),n("tabClick",t,h,e)},onKeydown:e=>{!p||e.code!==Sg.delete&&e.code!==Sg.backspace||n("tabRemove",t,e)}},[g,m])}));return Mi("div",{ref:c,class:[a.e("nav-wrap"),a.is("scrollable",!!h.value),a.is(i.props.tabPosition)]},[t,Mi("div",{class:a.e("nav-scroll"),ref:l},[Mi("div",{class:[a.e("nav"),a.is(i.props.tabPosition),a.is("stretch",e.stretch&&["top","bottom"].includes(i.props.tabPosition))],ref:u,style:v.value,role:"tablist",onKeydown:w},[e.type?null:Mi(jz,{ref:d,tabs:[...e.panes]},null),r])])])}}}),Xz=pg({type:{type:String,values:["card","border-card",""],default:""},activeName:{type:[String,Number]},closable:Boolean,addable:Boolean,modelValue:{type:[String,Number]},editable:Boolean,tabPosition:{type:String,values:["top","right","bottom","left"],default:"top"},beforeLeave:{type:Function,default:()=>!0},stretch:Boolean}),qz=e=>D(e)||Bs(e),Kz={[Tg]:e=>qz(e),tabClick:(e,t)=>t instanceof Event,tabChange:e=>qz(e),edit:(e,t)=>["remove","add"].includes(t),tabRemove:e=>qz(e),tabAdd:()=>!0};var Zz=Fn({name:"ElTabs",props:Xz,emits:Kz,setup(e,{emit:t,slots:n,expose:r}){var i,a;const s=rv("tabs"),{children:o,addChild:l,removeChild:u}=U_(Fi(),"ElTabPane"),c=At(),d=At(null!=(a=null!=(i=e.modelValue)?i:e.activeName)?a:"0"),h=async n=>{var r,i,a;if(d.value!==n&&!Bh(n))try{!1!==await(null==(r=e.beforeLeave)?void 0:r.call(e,n,d.value))&&((e=>{d.value=e,t(Tg,e),t("tabChange",e)})(n),null==(a=null==(i=c.value)?void 0:i.removeFocus)||a.call(i))}catch(zA){}},p=(e,n,r)=>{e.props.disabled||(h(n),t("tabClick",e,r))},f=(e,n)=>{e.props.disabled||Bh(e.props.name)||(n.stopPropagation(),t("edit",e.props.name,"remove"),t("tabRemove",e.props.name))},m=()=>{t("edit",void 0,"add"),t("tabAdd")};return Yg({from:'"activeName"',replacement:'"model-value" or "v-model"',scope:"ElTabs",version:"2.3.0",ref:"https://element-plus.org/en-US/component/tabs.html#attributes",type:"Attribute"},Ki((()=>!!e.activeName))),Mn((()=>e.activeName),(e=>h(e))),Mn((()=>e.modelValue),(e=>h(e))),Mn(d,(async()=>{var e;await en(),null==(e=c.value)||e.scrollToActiveTab()})),wn(Fz,{props:e,currentName:d,registerPane:l,unregisterPane:u}),r({currentName:d}),()=>{const t=e.editable||e.addable?Mi("span",{class:s.e("new-tab"),tabindex:"0",onClick:m,onKeydown:e=>{e.code===Sg.enter&&m()}},[Mi(ib,{class:s.is("icon-plus")},{default:()=>[Mi(lm,null,null)]})]):null,r=Mi("div",{class:[s.e("header"),s.is(e.tabPosition)]},[t,Mi($z,{ref:c,currentName:d.value,editable:e.editable,type:e.type,panes:o.value,stretch:e.stretch,onTabClick:p,onTabRemove:f},null)]),i=Mi("div",{class:s.e("content")},[vr(n,"default")]);return Mi("div",{class:[s.b(),s.m(e.tabPosition),{[s.m("card")]:"card"===e.type,[s.m("border-card")]:"border-card"===e.type}]},[..."bottom"!==e.tabPosition?[r,i]:[i,r]])}}});const Jz=pg({label:{type:String,default:""},name:{type:[String,Number]},closable:Boolean,disabled:Boolean,lazy:Boolean}),Qz=["id","aria-hidden","aria-labelledby"],eF="ElTabPane",tF=Fn({name:eF});var nF=J_(Fn({...tF,props:Jz,setup(e){const t=e,n=Fi(),r=Zi(),i=Sn(Fz);i||Wh(eF,"usage: <el-tabs><el-tab-pane /></el-tabs/>");const a=rv("tab-pane"),s=At(),o=Ki((()=>t.closable||i.props.closable)),u=Is((()=>{var e;return i.currentName.value===(null!=(e=t.name)?e:s.value)})),c=At(u.value),d=Ki((()=>{var e;return null!=(e=t.name)?e:s.value})),h=Is((()=>!t.lazy||c.value||u.value));Mn(u,(e=>{e&&(c.value=!0)}));const p=pt({uid:n.uid,slots:r,props:t,paneName:d,active:u,index:s,isClosable:o});return Kn((()=>{i.registerPane(p)})),er((()=>{i.unregisterPane(p.uid)})),(e,t)=>Dt(h)?ar((fi(),yi("div",{key:0,id:`pane-${Dt(d)}`,class:l(Dt(a).b()),role:"tabpanel","aria-hidden":!Dt(u),"aria-labelledby":`tab-${Dt(d)}`},[vr(e.$slots,"default")],10,Qz)),[[is,Dt(u)]]):Li("v-if",!0)}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/tabs/src/tab-pane.vue"]]);const rF=_g(Zz,{TabPane:nF}),iF=xg(nF),aF=pg({type:{type:String,values:["primary","success","info","warning","danger",""],default:""},size:{type:String,values:Pg,default:""},truncated:{type:Boolean},tag:{type:String,default:"span"}}),sF=Fn({name:"ElText"});const oF=_g(J_(Fn({...sF,props:aF,setup(e){const t=e,n=db(),r=rv("text"),i=Ki((()=>[r.b(),r.m(t.type),r.m(n.value),r.is("truncated",t.truncated)]));return(e,t)=>(fi(),_i(dr(e.tag),{class:l(Dt(i))},{default:vn((()=>[vr(e.$slots,"default")])),_:3},8,["class"]))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/text/src/text.vue"]])),lF=pg({format:{type:String,default:"HH:mm"},modelValue:String,disabled:Boolean,editable:{type:Boolean,default:!0},effect:{type:String,default:"light"},clearable:{type:Boolean,default:!0},size:z_,placeholder:String,start:{type:String,default:"09:00"},end:{type:String,default:"18:00"},step:{type:String,default:"00:30"},minTime:String,maxTime:String,name:String,prefixIcon:{type:[String,Object],default:()=>sf},clearIcon:{type:[String,Object],default:()=>tf}}),uF=e=>{const t=(e||"").split(":");if(t.length>=2){let n=Number.parseInt(t[0],10);const r=Number.parseInt(t[1],10),i=e.toUpperCase();return i.includes("AM")&&12===n?n=0:i.includes("PM")&&12!==n&&(n+=12),{hours:n,minutes:r}}return null},cF=(e,t)=>{const n=uF(e);if(!n)return-1;const r=uF(t);if(!r)return-1;const i=n.minutes+60*n.hours,a=r.minutes+60*r.hours;return i===a?0:i>a?1:-1},dF=e=>`${e}`.padStart(2,"0"),hF=e=>`${dF(e.hours)}:${dF(e.minutes)}`,pF=(e,t)=>{const n=uF(e);if(!n)return"";const r=uF(t);if(!r)return"";const i={hours:n.hours,minutes:n.minutes};return i.minutes+=r.minutes,i.hours+=r.hours,i.hours+=Math.floor(i.minutes/60),i.minutes=i.minutes%60,hF(i)},fF=Fn({name:"ElTimeSelect"});var mF=J_(Fn({...fF,props:lF,emits:["change","blur","focus","update:modelValue"],setup(e,{expose:t}){const n=e;XS.extend(KS);const{Option:r}=ID,i=rv("input"),a=At(),s=hb(),o=Ki((()=>n.modelValue)),u=Ki((()=>{const e=uF(n.start);return e?hF(e):null})),c=Ki((()=>{const e=uF(n.end);return e?hF(e):null})),d=Ki((()=>{const e=uF(n.step);return e?hF(e):null})),h=Ki((()=>{const e=uF(n.minTime||"");return e?hF(e):null})),p=Ki((()=>{const e=uF(n.maxTime||"");return e?hF(e):null})),f=Ki((()=>{const e=[];if(n.start&&n.end&&n.step){let t,r=u.value;for(;r&&c.value&&cF(r,c.value)<=0;)t=XS(r,"HH:mm").format(n.format),e.push({value:t,disabled:cF(r,h.value||"-1:-1")<=0||cF(r,p.value||"100:100")>=0}),r=pF(r,d.value)}return e}));return t({blur:()=>{var e,t;null==(t=null==(e=a.value)?void 0:e.blur)||t.call(e)},focus:()=>{var e,t;null==(t=null==(e=a.value)?void 0:e.focus)||t.call(e)}}),(e,t)=>(fi(),_i(Dt(ID),{ref_key:"select",ref:a,"model-value":Dt(o),disabled:Dt(s),clearable:e.clearable,"clear-icon":e.clearIcon,size:e.size,effect:e.effect,placeholder:e.placeholder,"default-first-option":"",filterable:e.editable,"onUpdate:modelValue":t[0]||(t[0]=t=>e.$emit("update:modelValue",t)),onChange:t[1]||(t[1]=t=>e.$emit("change",t)),onBlur:t[2]||(t[2]=t=>e.$emit("blur",t)),onFocus:t[3]||(t[3]=t=>e.$emit("focus",t))},{prefix:vn((()=>[e.prefixIcon?(fi(),_i(Dt(ib),{key:0,class:l(Dt(i).e("prefix-icon"))},{default:vn((()=>[(fi(),_i(dr(e.prefixIcon)))])),_:1},8,["class"])):Li("v-if",!0)])),default:vn((()=>[(fi(!0),yi(li,null,mr(Dt(f),(e=>(fi(),_i(Dt(r),{key:e.value,label:e.value,value:e.value,disabled:e.disabled},null,8,["label","value","disabled"])))),128))])),_:1},8,["model-value","disabled","clearable","clear-icon","size","effect","placeholder","filterable"]))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/time-select/src/time-select.vue"]]);mF.install=e=>{e.component(mF.name,mF)};const gF=mF,vF=Fn({name:"ElTimeline",setup(e,{slots:t}){const n=rv("timeline");return wn("timeline",t),()=>ea("ul",{class:[n.b()]},[vr(t,"default")])}}),yF=pg({timestamp:{type:String,default:""},hideTimestamp:{type:Boolean,default:!1},center:{type:Boolean,default:!1},placement:{type:String,values:["top","bottom"],default:"bottom"},type:{type:String,values:["primary","success","warning","danger","info"],default:""},color:{type:String,default:""},size:{type:String,values:["normal","large"],default:"normal"},icon:{type:fg},hollow:{type:Boolean,default:!1}}),_F=Fn({name:"ElTimelineItem"});var bF=J_(Fn({..._F,props:yF,setup(e){const t=rv("timeline-item");return(e,n)=>(fi(),yi("li",{class:l([Dt(t).b(),{[Dt(t).e("center")]:e.center}])},[Ti("div",{class:l(Dt(t).e("tail"))},null,2),e.$slots.dot?Li("v-if",!0):(fi(),yi("div",{key:0,class:l([Dt(t).e("node"),Dt(t).em("node",e.size||""),Dt(t).em("node",e.type||""),Dt(t).is("hollow",e.hollow)]),style:r({backgroundColor:e.color})},[e.icon?(fi(),_i(Dt(ib),{key:0,class:l(Dt(t).e("icon"))},{default:vn((()=>[(fi(),_i(dr(e.icon)))])),_:1},8,["class"])):Li("v-if",!0)],6)),e.$slots.dot?(fi(),yi("div",{key:1,class:l(Dt(t).e("dot"))},[vr(e.$slots,"dot")],2)):Li("v-if",!0),Ti("div",{class:l(Dt(t).e("wrapper"))},[e.hideTimestamp||"top"!==e.placement?Li("v-if",!0):(fi(),yi("div",{key:0,class:l([Dt(t).e("timestamp"),Dt(t).is("top")])},f(e.timestamp),3)),Ti("div",{class:l(Dt(t).e("content"))},[vr(e.$slots,"default")],2),e.hideTimestamp||"bottom"!==e.placement?Li("v-if",!0):(fi(),yi("div",{key:1,class:l([Dt(t).e("timestamp"),Dt(t).is("bottom")])},f(e.timestamp),3))],2)],2))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/timeline/src/timeline-item.vue"]]);const xF=_g(vF,{TimelineItem:bF}),wF=xg(bF),SF=pg({nowrap:Boolean});var CF=(e=>(e.top="top",e.bottom="bottom",e.left="left",e.right="right",e))(CF||{});const TF=Object.values(CF),MF=pg({width:{type:Number,default:10},height:{type:Number,default:10},style:{type:Object,default:null}}),EF=pg({side:{type:String,values:TF,required:!0}}),AF=pg({ariaLabel:String,arrowPadding:{type:Number,default:5},effect:{type:String,default:""},contentClass:String,placement:{type:String,values:["top-start","top-end","top","bottom-start","bottom-end","bottom","left-start","left-end","left","right-start","right-end","right"],default:"bottom"},reference:{type:Object,default:null},offset:{type:Number,default:8},strategy:{type:String,values:["absolute","fixed"],default:"absolute"},showArrow:{type:Boolean,default:!1}}),PF=pg({delayDuration:{type:Number,default:300},defaultOpen:Boolean,open:{type:Boolean,default:void 0},onOpenChange:{type:Function},"onUpdate:open":{type:Function}}),RF={type:Function},LF=pg({onBlur:RF,onClick:RF,onFocus:RF,onMouseDown:RF,onMouseEnter:RF,onMouseLeave:RF}),kF=pg({...PF,...MF,...LF,...AF,alwaysOn:Boolean,fullTransition:Boolean,transitionProps:{type:Object,default:null},teleported:Boolean,to:{type:String,default:"body"}}),DF=Symbol("tooltipV2"),IF=Symbol("tooltipV2Content"),OF="tooltip_v2.open",NF=Fn({name:"ElTooltipV2Root"});var BF=J_(Fn({...NF,props:PF,setup(e,{expose:t}){const n=e,r=At(n.defaultOpen),i=At(null),a=Ki({get:()=>Ah(n.open)?r.value:n.open,set:e=>{var t;r.value=e,null==(t=n["onUpdate:open"])||t.call(n,e)}}),s=Ki((()=>Bs(n.delayDuration)&&n.delayDuration>0)),{start:o,stop:l}=$s((()=>{a.value=!0}),Ki((()=>n.delayDuration)),{immediate:!1}),u=rv("tooltip-v2"),c=Iy(),d=()=>{l(),a.value=!0},h=d,p=()=>{l(),a.value=!1};return Mn(a,(e=>{var t;e&&(document.dispatchEvent(new CustomEvent(OF)),h()),null==(t=n.onOpenChange)||t.call(n,e)})),Kn((()=>{document.addEventListener(OF,p)})),Qn((()=>{l(),document.removeEventListener(OF,p)})),wn(DF,{contentId:c,triggerRef:i,ns:u,onClose:p,onDelayOpen:()=>{Dt(s)?o():d()},onOpen:h}),t({onOpen:h,onClose:p}),(e,t)=>vr(e.$slots,"default",{open:Dt(a)})}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip-v2/src/root.vue"]]);const UF=Fn({name:"ElTooltipV2Arrow"});var zF=J_(Fn({...UF,props:{...MF,...EF},setup(e){const t=e,{ns:n}=Sn(DF),{arrowRef:i}=Sn(IF),a=Ki((()=>{const{style:e,width:r,height:i}=t,a=n.namespace.value;return{[`--${a}-tooltip-v2-arrow-width`]:`${r}px`,[`--${a}-tooltip-v2-arrow-height`]:`${i}px`,[`--${a}-tooltip-v2-arrow-border-width`]:r/2+"px",[`--${a}-tooltip-v2-arrow-cover-width`]:r/2-1,...e||{}}}));return(e,t)=>(fi(),yi("span",{ref_key:"arrowRef",ref:i,style:r(Dt(a)),class:l(Dt(n).e("arrow"))},null,6))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip-v2/src/arrow.vue"]]);const FF=pg({style:{type:[String,Object,Array],default:()=>({})}}),VF=Fn({name:"ElVisuallyHidden"});var GF=J_(Fn({...VF,props:FF,setup(e){const t=e,n=Ki((()=>[t.style,{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}]));return(e,t)=>(fi(),yi("span",Oi(e.$attrs,{style:Dt(n)}),[vr(e.$slots,"default")],16))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/visual-hidden/src/visual-hidden.vue"]]);const HF=["data-side"],jF=Fn({name:"ElTooltipV2Content"});var WF=J_(Fn({...jF,props:{...AF,...SF},setup(e){const t=e,{triggerRef:n,contentId:i}=Sn(DF),a=At(t.placement),s=At(t.strategy),o=At(null),{referenceRef:u,contentRef:c,middlewareData:d,x:h,y:p,update:m}=B_({placement:a,strategy:s,middleware:Ki((()=>{const e=[n_(t.offset)];return t.showArrow&&e.push((({arrowRef:e,padding:t})=>({name:"arrow",options:{element:e,padding:t},fn(n){const r=Dt(e);return r?t_({element:r,padding:t}).fn(n):{}}}))({arrowRef:o})),e}))}),g=Yy().nextZIndex(),v=rv("tooltip-v2"),y=Ki((()=>a.value.split("-")[0])),_=Ki((()=>({position:Dt(s),top:`${Dt(p)||0}px`,left:`${Dt(h)||0}px`,zIndex:g}))),b=Ki((()=>{if(!t.showArrow)return{};const{arrow:e}=Dt(d);return{[`--${v.namespace.value}-tooltip-v2-arrow-x`]:`${null==e?void 0:e.x}px`||"",[`--${v.namespace.value}-tooltip-v2-arrow-y`]:`${null==e?void 0:e.y}px`||""}})),x=Ki((()=>[v.e("content"),v.is("dark","dark"===t.effect),v.is(Dt(s)),t.contentClass]));return Mn(o,(()=>m())),Mn((()=>t.placement),(e=>a.value=e)),Kn((()=>{Mn((()=>t.reference||n.value),(e=>{u.value=e||void 0}),{immediate:!0})})),wn(IF,{arrowRef:o}),(e,t)=>(fi(),yi("div",{ref_key:"contentRef",ref:c,style:r(Dt(_)),"data-tooltip-v2-root":""},[e.nowrap?Li("v-if",!0):(fi(),yi("div",{key:0,"data-side":Dt(y),class:l(Dt(x))},[vr(e.$slots,"default",{contentStyle:Dt(_),contentClass:Dt(x)}),Mi(Dt(GF),{id:Dt(i),role:"tooltip"},{default:vn((()=>[e.ariaLabel?(fi(),yi(li,{key:0},[Pi(f(e.ariaLabel),1)],64)):vr(e.$slots,"default",{key:1})])),_:3},8,["id"]),vr(e.$slots,"arrow",{style:r(Dt(b)),side:Dt(y)})],10,HF))],4))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip-v2/src/content.vue"]]);var YF=Fn({props:pg({setRef:{type:Function,required:!0},onlyChild:Boolean}),setup(e,{slots:t}){const n=At(),r=wg(n,(t=>{t?e.setRef(t.nextElementSibling):e.setRef(null)}));return()=>{var n;const[i]=(null==(n=t.default)?void 0:n.call(t))||[],a=e.onlyChild?(e=>{if(!E(e)||e.length>1)throw new Error("expect to receive a single Vue element child");return e[0]})(i.children):i.children;return Mi(li,{ref:r},[a])}}});const $F=Fn({name:"ElTooltipV2Trigger"}),XF=Fn({...$F,props:{...SF,...LF},setup(e){const t=e,{onClose:n,onOpen:r,onDelayOpen:i,triggerRef:a,contentId:s}=Sn(DF);let o=!1;const l=e=>{a.value=e},u=()=>{o=!1},c=Cs(t.onMouseEnter,i),d=Cs(t.onMouseLeave,n),h=Cs(t.onMouseDown,(()=>{n(),o=!0,document.addEventListener("mouseup",u,{once:!0})})),p=Cs(t.onFocus,(()=>{o||r()})),f=Cs(t.onBlur,n),m=Cs(t.onClick,(e=>{0===e.detail&&n()})),g={blur:f,click:m,focus:p,mousedown:h,mouseenter:c,mouseleave:d},v=(e,t,n)=>{e&&Object.entries(t).forEach((([t,r])=>{e[n](t,r)}))};return Mn(a,((e,t)=>{v(e,g,"addEventListener"),v(t,g,"removeEventListener"),e&&e.setAttribute("aria-describedby",s.value)})),Qn((()=>{v(a.value,g,"removeEventListener"),document.removeEventListener("mouseup",u)})),(e,t)=>e.nowrap?(fi(),_i(Dt(YF),{key:0,"set-ref":l,"only-child":""},{default:vn((()=>[vr(e.$slots,"default")])),_:3})):(fi(),yi("button",Oi({key:1,ref_key:"triggerRef",ref:a},e.$attrs),[vr(e.$slots,"default")],16))}});var qF=J_(XF,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip-v2/src/trigger.vue"]]);const KF=Fn({name:"ElTooltipV2"});const ZF=_g(J_(Fn({...KF,props:kF,setup(e){const t=Nt(e),n=pt(Dh(t,Object.keys(MF))),r=pt(Dh(t,Object.keys(AF))),i=pt(Dh(t,Object.keys(PF))),a=pt(Dh(t,Object.keys(LF)));return(e,t)=>(fi(),_i(BF,u(Ei(i)),{default:vn((({open:t})=>[Mi(qF,Oi(a,{nowrap:""}),{default:vn((()=>[vr(e.$slots,"trigger")])),_:3},16),(fi(),_i(si,{to:e.to,disabled:!e.teleported},[e.fullTransition?(fi(),_i(xa,u(Oi({key:0},e.transitionProps)),{default:vn((()=>[e.alwaysOn||t?(fi(),_i(WF,u(Oi({key:0},r)),{arrow:vn((({style:t,side:r})=>[e.showArrow?(fi(),_i(zF,Oi({key:0},n,{style:t,side:r}),null,16,["style","side"])):Li("v-if",!0)])),default:vn((()=>[vr(e.$slots,"default")])),_:3},16)):Li("v-if",!0)])),_:2},1040)):(fi(),yi(li,{key:1},[e.alwaysOn||t?(fi(),_i(WF,u(Oi({key:0},r)),{arrow:vn((({style:t,side:r})=>[e.showArrow?(fi(),_i(zF,Oi({key:0},n,{style:t,side:r}),null,16,["style","side"])):Li("v-if",!0)])),default:vn((()=>[vr(e.$slots,"default")])),_:3},16)):Li("v-if",!0)],64))],8,["to","disabled"]))])),_:3},16))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip-v2/src/tooltip.vue"]])),JF="left-check-change",QF="right-check-change",eV=pg({data:{type:Array,default:()=>[]},titles:{type:Array,default:()=>[]},buttonTexts:{type:Array,default:()=>[]},filterPlaceholder:String,filterMethod:{type:Function},leftDefaultChecked:{type:Array,default:()=>[]},rightDefaultChecked:{type:Array,default:()=>[]},renderContent:{type:Function},modelValue:{type:Array,default:()=>[]},format:{type:Object,default:()=>({})},filterable:Boolean,props:{type:Object,default:()=>({label:"label",key:"key",disabled:"disabled"})},targetOrder:{type:String,values:["original","push","unshift"],default:"original"},validateEvent:{type:Boolean,default:!0}}),tV=(e,t)=>[e,t].every(E)||E(e)&&Ah(t),nV={[Mg]:(e,t,n)=>[e,n].every(E)&&["left","right"].includes(t),[Tg]:e=>E(e),[JF]:tV,[QF]:tV},rV="checked-change",iV=pg({data:eV.data,optionRender:{type:Function},placeholder:String,title:String,filterable:Boolean,format:eV.format,filterMethod:eV.filterMethod,defaultChecked:eV.leftDefaultChecked,props:eV.props}),aV={[rV]:tV},sV=e=>{const t={label:"label",key:"key",disabled:"disabled"};return Ki((()=>({...t,...e.props})))},oV=Fn({name:"ElTransferPanel"}),lV=Fn({...oV,props:iV,emits:aV,setup(e,{expose:t,emit:n}){const r=e,i=Zi(),a=({option:e})=>e,{t:s}=Jg(),o=rv("transfer"),u=pt({checked:[],allChecked:!1,query:"",checkChangeByUser:!0}),c=sV(r),{filteredData:d,checkedSummary:h,isIndeterminate:p,handleAllCheckedChange:m}=((e,t,n)=>{const r=sV(e),i=Ki((()=>e.data.filter((n=>k(e.filterMethod)?e.filterMethod(t.query,n):String(n[r.value.label]||n[r.value.key]).toLowerCase().includes(t.query.toLowerCase()))))),a=Ki((()=>i.value.filter((e=>!e[r.value.disabled])))),s=Ki((()=>{const n=t.checked.length,r=e.data.length,{noChecked:i,hasChecked:a}=e.format;return i&&a?n>0?a.replace(/\${checked}/g,n.toString()).replace(/\${total}/g,r.toString()):i.replace(/\${total}/g,r.toString()):`${n}/${r}`})),o=Ki((()=>{const e=t.checked.length;return e>0&&e<a.value.length})),l=()=>{const e=a.value.map((e=>e[r.value.key]));t.allChecked=e.length>0&&e.every((e=>t.checked.includes(e)))};return Mn((()=>t.checked),((e,r)=>{if(l(),t.checkChangeByUser){const t=e.concat(r).filter((t=>!e.includes(t)||!r.includes(t)));n(rV,e,t)}else n(rV,e),t.checkChangeByUser=!0})),Mn(a,(()=>{l()})),Mn((()=>e.data),(()=>{const e=[],n=i.value.map((e=>e[r.value.key]));t.checked.forEach((t=>{n.includes(t)&&e.push(t)})),t.checkChangeByUser=!1,t.checked=e})),Mn((()=>e.defaultChecked),((e,n)=>{if(n&&e.length===n.length&&e.every((e=>n.includes(e))))return;const i=[],s=a.value.map((e=>e[r.value.key]));e.forEach((e=>{s.includes(e)&&i.push(e)})),t.checkChangeByUser=!1,t.checked=i}),{immediate:!0}),{filteredData:i,checkableData:a,checkedSummary:s,isIndeterminate:o,updateAllChecked:l,handleAllCheckedChange:e=>{t.checked=e?a.value.map((e=>e[r.value.key])):[]}}})(r,u,n),g=Ki((()=>!Uh(u.query)&&Uh(d.value))),v=Ki((()=>!Uh(i.default()[0].children))),{checked:y,allChecked:_,query:b}=Nt(u);return t({query:b}),(e,t)=>(fi(),yi("div",{class:l(Dt(o).b("panel"))},[Ti("p",{class:l(Dt(o).be("panel","header"))},[Mi(Dt(mM),{modelValue:Dt(_),"onUpdate:modelValue":t[0]||(t[0]=e=>Et(_)?_.value=e:null),indeterminate:Dt(p),"validate-event":!1,onChange:Dt(m)},{default:vn((()=>[Pi(f(e.title)+" ",1),Ti("span",null,f(Dt(h)),1)])),_:1},8,["modelValue","indeterminate","onChange"])],2),Ti("div",{class:l([Dt(o).be("panel","body"),Dt(o).is("with-footer",Dt(v))])},[e.filterable?(fi(),_i(Dt(mx),{key:0,modelValue:Dt(b),"onUpdate:modelValue":t[1]||(t[1]=e=>Et(b)?b.value=e:null),class:l(Dt(o).be("panel","filter")),size:"default",placeholder:e.placeholder,"prefix-icon":Dt(Am),clearable:"","validate-event":!1},null,8,["modelValue","class","placeholder","prefix-icon"])):Li("v-if",!0),ar(Mi(Dt(vM),{modelValue:Dt(y),"onUpdate:modelValue":t[2]||(t[2]=e=>Et(y)?y.value=e:null),"validate-event":!1,class:l([Dt(o).is("filterable",e.filterable),Dt(o).be("panel","list")])},{default:vn((()=>[(fi(!0),yi(li,null,mr(Dt(d),(t=>(fi(),_i(Dt(mM),{key:t[Dt(c).key],class:l(Dt(o).be("panel","item")),label:t[Dt(c).key],disabled:t[Dt(c).disabled],"validate-event":!1},{default:vn((()=>{var n;return[Mi(a,{option:null==(n=e.optionRender)?void 0:n.call(e,t)},null,8,["option"])]})),_:2},1032,["class","label","disabled"])))),128))])),_:1},8,["modelValue","class"]),[[is,!Dt(g)&&!Dt(Uh)(e.data)]]),ar(Ti("p",{class:l(Dt(o).be("panel","empty"))},f(Dt(g)?Dt(s)("el.transfer.noMatch"):Dt(s)("el.transfer.noData")),3),[[is,Dt(g)||Dt(Uh)(e.data)]])],2),Dt(v)?(fi(),yi("p",{key:0,class:l(Dt(o).be("panel","footer"))},[vr(e.$slots,"default")],2)):Li("v-if",!0)],2))}});var uV=J_(lV,[["__file","/home/runner/work/element-plus/element-plus/packages/components/transfer/src/transfer-panel.vue"]]);const cV={key:0},dV={key:0},hV=Fn({name:"ElTransfer"}),pV=Fn({...hV,props:eV,emits:nV,setup(e,{expose:t,emit:n}){const r=e,i=Zi(),{t:a}=Jg(),s=rv("transfer"),{formItem:o}=pb(),u=pt({leftChecked:[],rightChecked:[]}),c=sV(r),{sourceData:d,targetData:h}=(e=>{const t=sV(e),n=Ki((()=>e.data.reduce(((e,n)=>(e[n[t.value.key]]=n)&&e),{})));return{sourceData:Ki((()=>e.data.filter((n=>!e.modelValue.includes(n[t.value.key]))))),targetData:Ki((()=>"original"===e.targetOrder?e.data.filter((n=>e.modelValue.includes(n[t.value.key]))):e.modelValue.reduce(((e,t)=>{const r=n.value[t];return r&&e.push(r),e}),[])))}})(r),{onSourceCheckedChange:p,onTargetCheckedChange:m}=((e,t)=>({onSourceCheckedChange:(n,r)=>{e.leftChecked=n,r&&t(JF,n,r)},onTargetCheckedChange:(n,r)=>{e.rightChecked=n,r&&t(QF,n,r)}}))(u,n),{addToLeft:g,addToRight:v}=((e,t,n)=>{const r=sV(e),i=(e,t,r)=>{n(Tg,e),n(Mg,e,t,r)};return{addToLeft:()=>{const n=e.modelValue.slice();t.rightChecked.forEach((e=>{const t=n.indexOf(e);t>-1&&n.splice(t,1)})),i(n,"left",t.rightChecked)},addToRight:()=>{let n=e.modelValue.slice();const a=e.data.filter((n=>{const i=n[r.value.key];return t.leftChecked.includes(i)&&!e.modelValue.includes(i)})).map((e=>e[r.value.key]));n="unshift"===e.targetOrder?a.concat(n):n.concat(a),"original"===e.targetOrder&&(n=e.data.filter((e=>n.includes(e[r.value.key]))).map((e=>e[r.value.key]))),i(n,"right",t.leftChecked)}}})(r,u,n),y=At(),_=At(),b=Ki((()=>2===r.buttonTexts.length)),x=Ki((()=>r.titles[0]||a("el.transfer.titles.0"))),w=Ki((()=>r.titles[1]||a("el.transfer.titles.1"))),S=Ki((()=>r.filterPlaceholder||a("el.transfer.filterPlaceholder")));Mn((()=>r.modelValue),(()=>{var e;r.validateEvent&&(null==(e=null==o?void 0:o.validate)||e.call(o,"change").catch((e=>{})))}));const C=Ki((()=>e=>r.renderContent?r.renderContent(ea,e):i.default?i.default({option:e}):ea("span",e[c.value.label]||e[c.value.key])));return t({clearQuery:e=>{switch(e){case"left":y.value.query="";break;case"right":_.value.query=""}},leftPanel:y,rightPanel:_}),(e,t)=>(fi(),yi("div",{class:l(Dt(s).b())},[Mi(uV,{ref_key:"leftPanel",ref:y,data:Dt(d),"option-render":Dt(C),placeholder:Dt(S),title:Dt(x),filterable:e.filterable,format:e.format,"filter-method":e.filterMethod,"default-checked":e.leftDefaultChecked,props:r.props,onCheckedChange:Dt(p)},{default:vn((()=>[vr(e.$slots,"left-footer")])),_:3},8,["data","option-render","placeholder","title","filterable","format","filter-method","default-checked","props","onCheckedChange"]),Ti("div",{class:l(Dt(s).e("buttons"))},[Mi(Dt(jS),{type:"primary",class:l([Dt(s).e("button"),Dt(s).is("with-texts",Dt(b))]),disabled:Dt(Uh)(u.rightChecked),onClick:Dt(g)},{default:vn((()=>[Mi(Dt(ib),null,{default:vn((()=>[Mi(Dt(dp))])),_:1}),Dt(Bh)(e.buttonTexts[0])?Li("v-if",!0):(fi(),yi("span",cV,f(e.buttonTexts[0]),1))])),_:1},8,["class","disabled","onClick"]),Mi(Dt(jS),{type:"primary",class:l([Dt(s).e("button"),Dt(s).is("with-texts",Dt(b))]),disabled:Dt(Uh)(u.leftChecked),onClick:Dt(v)},{default:vn((()=>[Dt(Bh)(e.buttonTexts[1])?Li("v-if",!0):(fi(),yi("span",dV,f(e.buttonTexts[1]),1)),Mi(Dt(ib),null,{default:vn((()=>[Mi(Dt(mp))])),_:1})])),_:1},8,["class","disabled","onClick"])],2),Mi(uV,{ref_key:"rightPanel",ref:_,data:Dt(h),"option-render":Dt(C),placeholder:Dt(S),filterable:e.filterable,format:e.format,"filter-method":e.filterMethod,title:Dt(w),"default-checked":e.rightDefaultChecked,props:r.props,onCheckedChange:Dt(m)},{default:vn((()=>[vr(e.$slots,"right-footer")])),_:3},8,["data","option-render","placeholder","filterable","format","filter-method","title","default-checked","props","onCheckedChange"])],2))}});const fV=_g(J_(pV,[["__file","/home/runner/work/element-plus/element-plus/packages/components/transfer/src/transfer.vue"]])),mV="$treeNodeId",gV=function(e,t){t&&!t[mV]&&Object.defineProperty(t,mV,{value:e.id,enumerable:!1,configurable:!1,writable:!1})},vV=function(e,t){return e?t[e]:t[mV]},yV=(e,t,n)=>{const r=e.value.currentNode;n();const i=e.value.currentNode;r!==i&&t("current-change",i?i.data:null,i)},_V=e=>{let t=!0,n=!0,r=!0;for(let i=0,a=e.length;i<a;i++){const a=e[i];(!0!==a.checked||a.indeterminate)&&(t=!1,a.disabled||(r=!1)),(!1!==a.checked||a.indeterminate)&&(n=!1)}return{all:t,none:n,allWithoutDisable:r,half:!t&&!n}},bV=function(e){if(0===e.childNodes.length||e.loading)return;const{all:t,none:n,half:r}=_V(e.childNodes);t?(e.checked=!0,e.indeterminate=!1):r?(e.checked=!1,e.indeterminate=!0):n&&(e.checked=!1,e.indeterminate=!1);const i=e.parent;i&&0!==i.level&&(e.store.checkStrictly||bV(i))},xV=function(e,t){const n=e.store.props,r=e.data||{},i=n[t];if("function"==typeof i)return i(r,e);if("string"==typeof i)return r[i];if(void 0===i){const e=r[t];return void 0===e?"":e}};let wV=0;class SV{constructor(e){this.id=wV++,this.text=null,this.checked=!1,this.indeterminate=!1,this.data=null,this.expanded=!1,this.parent=null,this.visible=!0,this.isCurrent=!1,this.canFocus=!1;for(const t in e)M(e,t)&&(this[t]=e[t]);this.level=0,this.loaded=!1,this.childNodes=[],this.loading=!1,this.parent&&(this.level=this.parent.level+1)}initialize(){const e=this.store;if(!e)throw new Error("[Node]store is required!");e.registerNode(this);const t=e.props;if(t&&void 0!==t.isLeaf){const e=xV(this,"isLeaf");"boolean"==typeof e&&(this.isLeafByUser=e)}if(!0!==e.lazy&&this.data?(this.setData(this.data),e.defaultExpandAll&&(this.expanded=!0,this.canFocus=!0)):this.level>0&&e.lazy&&e.defaultExpandAll&&this.expand(),Array.isArray(this.data)||gV(this,this.data),!this.data)return;const n=e.defaultExpandedKeys,r=e.key;r&&n&&n.includes(this.key)&&this.expand(null,e.autoExpandParent),r&&void 0!==e.currentNodeKey&&this.key===e.currentNodeKey&&(e.currentNode=this,e.currentNode.isCurrent=!0),e.lazy&&e._initDefaultCheckedNode(this),this.updateLeafState(),!this.parent||1!==this.level&&!0!==this.parent.expanded||(this.canFocus=!0)}setData(e){let t;Array.isArray(e)||gV(this,e),this.data=e,this.childNodes=[],t=0===this.level&&Array.isArray(this.data)?this.data:xV(this,"children")||[];for(let n=0,r=t.length;n<r;n++)this.insertChild({data:t[n]})}get label(){return xV(this,"label")}get key(){const e=this.store.key;return this.data?this.data[e]:null}get disabled(){return xV(this,"disabled")}get nextSibling(){const e=this.parent;if(e){const t=e.childNodes.indexOf(this);if(t>-1)return e.childNodes[t+1]}return null}get previousSibling(){const e=this.parent;if(e){const t=e.childNodes.indexOf(this);if(t>-1)return t>0?e.childNodes[t-1]:null}return null}contains(e,t=!0){return(this.childNodes||[]).some((n=>n===e||t&&n.contains(e)))}remove(){const e=this.parent;e&&e.removeChild(this)}insertChild(e,t,n){if(!e)throw new Error("InsertChild error: child is required.");if(!(e instanceof SV)){if(!n){const n=this.getChildren(!0);n.includes(e.data)||(void 0===t||t<0?n.push(e.data):n.splice(t,0,e.data))}Object.assign(e,{parent:this,store:this.store}),(e=pt(new SV(e)))instanceof SV&&e.initialize()}e.level=this.level+1,void 0===t||t<0?this.childNodes.push(e):this.childNodes.splice(t,0,e),this.updateLeafState()}insertBefore(e,t){let n;t&&(n=this.childNodes.indexOf(t)),this.insertChild(e,n)}insertAfter(e,t){let n;t&&(n=this.childNodes.indexOf(t),-1!==n&&(n+=1)),this.insertChild(e,n)}removeChild(e){const t=this.getChildren()||[],n=t.indexOf(e.data);n>-1&&t.splice(n,1);const r=this.childNodes.indexOf(e);r>-1&&(this.store&&this.store.deregisterNode(e),e.parent=null,this.childNodes.splice(r,1)),this.updateLeafState()}removeChildByData(e){let t=null;for(let n=0;n<this.childNodes.length;n++)if(this.childNodes[n].data===e){t=this.childNodes[n];break}t&&this.removeChild(t)}expand(e,t){const n=()=>{if(t){let e=this.parent;for(;e.level>0;)e.expanded=!0,e=e.parent}this.expanded=!0,e&&e(),this.childNodes.forEach((e=>{e.canFocus=!0}))};this.shouldLoadData()?this.loadData((e=>{Array.isArray(e)&&(this.checked?this.setChecked(!0,!0):this.store.checkStrictly||bV(this),n())})):n()}doCreateChildren(e,t={}){e.forEach((e=>{this.insertChild(Object.assign({data:e},t),void 0,!0)}))}collapse(){this.expanded=!1,this.childNodes.forEach((e=>{e.canFocus=!1}))}shouldLoadData(){return!0===this.store.lazy&&this.store.load&&!this.loaded}updateLeafState(){if(!0===this.store.lazy&&!0!==this.loaded&&void 0!==this.isLeafByUser)return void(this.isLeaf=this.isLeafByUser);const e=this.childNodes;!this.store.lazy||!0===this.store.lazy&&!0===this.loaded?this.isLeaf=!e||0===e.length:this.isLeaf=!1}setChecked(e,t,n,r){if(this.indeterminate="half"===e,this.checked=!0===e,this.store.checkStrictly)return;if(!this.shouldLoadData()||this.store.checkDescendants){const{all:n,allWithoutDisable:i}=_V(this.childNodes);this.isLeaf||n||!i||(this.checked=!1,e=!1);const a=()=>{if(t){const n=this.childNodes;for(let s=0,o=n.length;s<o;s++){const i=n[s];r=r||!1!==e;const a=i.disabled?i.checked:r;i.setChecked(a,t,!0,r)}const{half:i,all:a}=_V(n);a||(this.checked=a,this.indeterminate=i)}};if(this.shouldLoadData())return void this.loadData((()=>{a(),bV(this)}),{checked:!1!==e});a()}const i=this.parent;i&&0!==i.level&&(n||bV(i))}getChildren(e=!1){if(0===this.level)return this.data;const t=this.data;if(!t)return null;const n=this.store.props;let r="children";return n&&(r=n.children||"children"),void 0===t[r]&&(t[r]=null),e&&!t[r]&&(t[r]=[]),t[r]}updateChildren(){const e=this.getChildren()||[],t=this.childNodes.map((e=>e.data)),n={},r=[];e.forEach(((e,i)=>{const a=e[mV];!!a&&t.findIndex((e=>e[mV]===a))>=0?n[a]={index:i,data:e}:r.push({index:i,data:e})})),this.store.lazy||t.forEach((e=>{n[e[mV]]||this.removeChildByData(e)})),r.forEach((({index:e,data:t})=>{this.insertChild({data:t},e)})),this.updateLeafState()}loadData(e,t={}){if(!0!==this.store.lazy||!this.store.load||this.loaded||this.loading&&!Object.keys(t).length)e&&e.call(this);else{this.loading=!0;const n=n=>{this.childNodes=[],this.doCreateChildren(n,t),this.loaded=!0,this.loading=!1,this.updateLeafState(),e&&e.call(this,n)};this.store.load(this,n)}}}class CV{constructor(e){this.currentNode=null,this.currentNodeKey=null;for(const t in e)M(e,t)&&(this[t]=e[t]);this.nodesMap={}}initialize(){if(this.root=new SV({data:this.data,store:this}),this.root.initialize(),this.lazy&&this.load){(0,this.load)(this.root,(e=>{this.root.doCreateChildren(e),this._initDefaultCheckedNodes()}))}else this._initDefaultCheckedNodes()}filter(e){const t=this.filterNodeMethod,n=this.lazy,r=function(i){const a=i.root?i.root.childNodes:i.childNodes;if(a.forEach((n=>{n.visible=t.call(n,e,n.data,n),r(n)})),!i.visible&&a.length){let e=!0;e=!a.some((e=>e.visible)),i.root?i.root.visible=!1===e:i.visible=!1===e}e&&(!i.visible||i.isLeaf||n||i.expand())};r(this)}setData(e){e!==this.root.data?(this.root.setData(e),this._initDefaultCheckedNodes()):this.root.updateChildren()}getNode(e){if(e instanceof SV)return e;const t=O(e)?vV(this.key,e):e;return this.nodesMap[t]||null}insertBefore(e,t){const n=this.getNode(t);n.parent.insertBefore({data:e},n)}insertAfter(e,t){const n=this.getNode(t);n.parent.insertAfter({data:e},n)}remove(e){const t=this.getNode(e);t&&t.parent&&(t===this.currentNode&&(this.currentNode=null),t.parent.removeChild(t))}append(e,t){const n=t?this.getNode(t):this.root;n&&n.insertChild({data:e})}_initDefaultCheckedNodes(){const e=this.defaultCheckedKeys||[],t=this.nodesMap;e.forEach((e=>{const n=t[e];n&&n.setChecked(!0,!this.checkStrictly)}))}_initDefaultCheckedNode(e){(this.defaultCheckedKeys||[]).includes(e.key)&&e.setChecked(!0,!this.checkStrictly)}setDefaultCheckedKey(e){e!==this.defaultCheckedKeys&&(this.defaultCheckedKeys=e,this._initDefaultCheckedNodes())}registerNode(e){const t=this.key;if(e&&e.data)if(t){void 0!==e.key&&(this.nodesMap[e.key]=e)}else this.nodesMap[e.id]=e}deregisterNode(e){this.key&&e&&e.data&&(e.childNodes.forEach((e=>{this.deregisterNode(e)})),delete this.nodesMap[e.key])}getCheckedNodes(e=!1,t=!1){const n=[],r=function(i){(i.root?i.root.childNodes:i.childNodes).forEach((i=>{(i.checked||t&&i.indeterminate)&&(!e||e&&i.isLeaf)&&n.push(i.data),r(i)}))};return r(this),n}getCheckedKeys(e=!1){return this.getCheckedNodes(e).map((e=>(e||{})[this.key]))}getHalfCheckedNodes(){const e=[],t=function(n){(n.root?n.root.childNodes:n.childNodes).forEach((n=>{n.indeterminate&&e.push(n.data),t(n)}))};return t(this),e}getHalfCheckedKeys(){return this.getHalfCheckedNodes().map((e=>(e||{})[this.key]))}_getAllNodes(){const e=[],t=this.nodesMap;for(const n in t)M(t,n)&&e.push(t[n]);return e}updateChildren(e,t){const n=this.nodesMap[e];if(!n)return;const r=n.childNodes;for(let i=r.length-1;i>=0;i--){const e=r[i];this.remove(e.data)}for(let i=0,a=t.length;i<a;i++){const e=t[i];this.append(e,n.data)}}_setCheckedKeys(e,t=!1,n){const r=this._getAllNodes().sort(((e,t)=>t.level-e.level)),i=Object.create(null),a=Object.keys(n);r.forEach((e=>e.setChecked(!1,!1)));for(let s=0,o=r.length;s<o;s++){const n=r[s],o=n.data[e].toString();if(!a.includes(o)){n.checked&&!i[o]&&n.setChecked(!1,!1);continue}let l=n.parent;for(;l&&l.level>0;)i[l.data[e]]=!0,l=l.parent;if(n.isLeaf||this.checkStrictly)n.setChecked(!0,!1);else if(n.setChecked(!0,!0),t){n.setChecked(!1,!1);const e=function(t){t.childNodes.forEach((t=>{t.isLeaf||t.setChecked(!1,!1),e(t)}))};e(n)}}}setCheckedNodes(e,t=!1){const n=this.key,r={};e.forEach((e=>{r[(e||{})[n]]=!0})),this._setCheckedKeys(n,t,r)}setCheckedKeys(e,t=!1){this.defaultCheckedKeys=e;const n=this.key,r={};e.forEach((e=>{r[e]=!0})),this._setCheckedKeys(n,t,r)}setDefaultExpandedKeys(e){e=e||[],this.defaultExpandedKeys=e,e.forEach((e=>{const t=this.getNode(e);t&&t.expand(null,this.autoExpandParent)}))}setChecked(e,t,n){const r=this.getNode(e);r&&r.setChecked(!!t,n)}getCurrentNode(){return this.currentNode}setCurrentNode(e){const t=this.currentNode;t&&(t.isCurrent=!1),this.currentNode=e,this.currentNode.isCurrent=!0}setUserCurrentNode(e,t=!0){const n=e[this.key],r=this.nodesMap[n];this.setCurrentNode(r),t&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0)}setCurrentNodeKey(e,t=!0){if(null==e)return this.currentNode&&(this.currentNode.isCurrent=!1),void(this.currentNode=null);const n=this.getNode(e);n&&(this.setCurrentNode(n),t&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0))}}var TV=J_(Fn({name:"ElTreeNodeContent",props:{node:{type:Object,required:!0},renderContent:Function},setup(e){const t=rv("tree"),n=Sn("NodeInstance"),r=Sn("RootTree");return()=>{const i=e.node,{data:a,store:s}=i;return e.renderContent?e.renderContent(ea,{_self:n,node:i,data:a,store:s}):r.ctx.slots.default?r.ctx.slots.default({node:i,data:a}):ea("span",{class:t.be("node","label")},[i.label])}}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/tree/src/tree-node-content.vue"]]);function MV(e){const t=Sn("TreeNodeMap",null),n={treeNodeExpand:t=>{e.node!==t&&e.node.collapse()},children:[]};return t&&t.children.push(n),wn("TreeNodeMap",n),{broadcastExpanded:t=>{if(e.accordion)for(const e of n.children)e.treeNodeExpand(t)}}}const EV=Symbol("dragEvents");const AV=Fn({name:"ElTreeNode",components:{ElCollapseTransition:NE,ElCheckbox:mM,NodeContent:TV,ElIcon:ib,Loading:Gf},props:{node:{type:SV,default:()=>({})},props:{type:Object,default:()=>({})},accordion:Boolean,renderContent:Function,renderAfterExpand:Boolean,showCheckbox:{type:Boolean,default:!1}},emits:["node-expand"],setup(e,t){const n=rv("tree"),{broadcastExpanded:r}=MV(e),i=Sn("RootTree"),a=At(!1),s=At(!1),o=At(null),l=At(null),u=At(null),c=Sn(EV),d=Fi();wn("NodeInstance",d),e.node.expanded&&(a.value=!0,s.value=!0);const h=i.props.children||"children";Mn((()=>{const t=e.node.data[h];return t&&[...t]}),(()=>{e.node.updateChildren()})),Mn((()=>e.node.indeterminate),(t=>{p(e.node.checked,t)})),Mn((()=>e.node.checked),(t=>{p(t,e.node.indeterminate)})),Mn((()=>e.node.expanded),(e=>{en((()=>a.value=e)),e&&(s.value=!0)}));const p=(t,n)=>{o.value===t&&l.value===n||i.ctx.emit("check-change",e.node.data,t,n),o.value=t,l.value=n},f=()=>{e.node.isLeaf||(a.value?(i.ctx.emit("node-collapse",e.node.data,e.node,d),e.node.collapse()):(e.node.expand(),t.emit("node-expand",e.node.data,e.node,d)))},m=(t,n)=>{e.node.setChecked(n.target.checked,!i.props.checkStrictly),en((()=>{const t=i.store.value;i.ctx.emit("check",e.node.data,{checkedNodes:t.getCheckedNodes(),checkedKeys:t.getCheckedKeys(),halfCheckedNodes:t.getHalfCheckedNodes(),halfCheckedKeys:t.getHalfCheckedKeys()})}))};return{ns:n,node$:u,tree:i,expanded:a,childNodeRendered:s,oldChecked:o,oldIndeterminate:l,getNodeKey:e=>vV(i.props.nodeKey,e.data),getNodeClass:t=>{const n=e.props.class;if(!n)return{};let r;if(k(n)){const{data:e}=t;r=n(e,t)}else r=n;return D(r)?{[r]:!0}:r},handleSelectChange:p,handleClick:t=>{yV(i.store,i.ctx.emit,(()=>i.store.value.setCurrentNode(e.node))),i.currentNode.value=e.node,i.props.expandOnClickNode&&f(),i.props.checkOnClickNode&&!e.node.disabled&&m(null,{target:{checked:!e.node.checked}}),i.ctx.emit("node-click",e.node.data,e.node,d,t)},handleContextMenu:t=>{i.instance.vnode.props.onNodeContextmenu&&(t.stopPropagation(),t.preventDefault()),i.ctx.emit("node-contextmenu",t,e.node.data,e.node,d)},handleExpandIconClick:f,handleCheckChange:m,handleChildNodeExpand:(e,t,n)=>{r(t),i.ctx.emit("node-expand",e,t,n)},handleDragStart:t=>{i.props.draggable&&c.treeNodeDragStart({event:t,treeNode:e})},handleDragOver:t=>{t.preventDefault(),i.props.draggable&&c.treeNodeDragOver({event:t,treeNode:{$el:u.value,node:e.node}})},handleDrop:e=>{e.preventDefault()},handleDragEnd:e=>{i.props.draggable&&c.treeNodeDragEnd(e)},CaretRight:Lp}}}),PV=["aria-expanded","aria-disabled","aria-checked","draggable","data-key"],RV=["aria-expanded"];const LV=Fn({name:"ElTree",components:{ElTreeNode:J_(AV,[["render",function(e,t,n,i,a,s){const o=ur("el-icon"),u=ur("el-checkbox"),c=ur("loading"),d=ur("node-content"),h=ur("el-tree-node"),p=ur("el-collapse-transition");return ar((fi(),yi("div",{ref:"node$",class:l([e.ns.b("node"),e.ns.is("expanded",e.expanded),e.ns.is("current",e.node.isCurrent),e.ns.is("hidden",!e.node.visible),e.ns.is("focusable",!e.node.disabled),e.ns.is("checked",!e.node.disabled&&e.node.checked),e.getNodeClass(e.node)]),role:"treeitem",tabindex:"-1","aria-expanded":e.expanded,"aria-disabled":e.node.disabled,"aria-checked":e.node.checked,draggable:e.tree.props.draggable,"data-key":e.getNodeKey(e.node),onClick:t[1]||(t[1]=ts(((...t)=>e.handleClick&&e.handleClick(...t)),["stop"])),onContextmenu:t[2]||(t[2]=(...t)=>e.handleContextMenu&&e.handleContextMenu(...t)),onDragstart:t[3]||(t[3]=ts(((...t)=>e.handleDragStart&&e.handleDragStart(...t)),["stop"])),onDragover:t[4]||(t[4]=ts(((...t)=>e.handleDragOver&&e.handleDragOver(...t)),["stop"])),onDragend:t[5]||(t[5]=ts(((...t)=>e.handleDragEnd&&e.handleDragEnd(...t)),["stop"])),onDrop:t[6]||(t[6]=ts(((...t)=>e.handleDrop&&e.handleDrop(...t)),["stop"]))},[Ti("div",{class:l(e.ns.be("node","content")),style:r({paddingLeft:(e.node.level-1)*e.tree.props.indent+"px"})},[e.tree.props.icon||e.CaretRight?(fi(),_i(o,{key:0,class:l([e.ns.be("node","expand-icon"),e.ns.is("leaf",e.node.isLeaf),{expanded:!e.node.isLeaf&&e.expanded}]),onClick:ts(e.handleExpandIconClick,["stop"])},{default:vn((()=>[(fi(),_i(dr(e.tree.props.icon||e.CaretRight)))])),_:1},8,["class","onClick"])):Li("v-if",!0),e.showCheckbox?(fi(),_i(u,{key:1,"model-value":e.node.checked,indeterminate:e.node.indeterminate,disabled:!!e.node.disabled,onClick:t[0]||(t[0]=ts((()=>{}),["stop"])),onChange:e.handleCheckChange},null,8,["model-value","indeterminate","disabled","onChange"])):Li("v-if",!0),e.node.loading?(fi(),_i(o,{key:2,class:l([e.ns.be("node","loading-icon"),e.ns.is("loading")])},{default:vn((()=>[Mi(c)])),_:1},8,["class"])):Li("v-if",!0),Mi(d,{node:e.node,"render-content":e.renderContent},null,8,["node","render-content"])],6),Mi(p,null,{default:vn((()=>[!e.renderAfterExpand||e.childNodeRendered?ar((fi(),yi("div",{key:0,class:l(e.ns.be("node","children")),role:"group","aria-expanded":e.expanded},[(fi(!0),yi(li,null,mr(e.node.childNodes,(t=>(fi(),_i(h,{key:e.getNodeKey(t),"render-content":e.renderContent,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,node:t,accordion:e.accordion,props:e.props,onNodeExpand:e.handleChildNodeExpand},null,8,["render-content","render-after-expand","show-checkbox","node","accordion","props","onNodeExpand"])))),128))],10,RV)),[[is,e.expanded]]):Li("v-if",!0)])),_:1})],42,PV)),[[is,e.node.visible]])}],["__file","/home/runner/work/element-plus/element-plus/packages/components/tree/src/tree-node.vue"]])},props:{data:{type:Array,default:()=>[]},emptyText:{type:String},renderAfterExpand:{type:Boolean,default:!0},nodeKey:String,checkStrictly:Boolean,defaultExpandAll:Boolean,expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:Boolean,checkDescendants:{type:Boolean,default:!1},autoExpandParent:{type:Boolean,default:!0},defaultCheckedKeys:Array,defaultExpandedKeys:Array,currentNodeKey:[String,Number],renderContent:Function,showCheckbox:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},allowDrag:Function,allowDrop:Function,props:{type:Object,default:()=>({children:"children",label:"label",disabled:"disabled"})},lazy:{type:Boolean,default:!1},highlightCurrent:Boolean,load:Function,filterNodeMethod:Function,accordion:Boolean,indent:{type:Number,default:18},icon:{type:fg}},emits:["check-change","current-change","node-click","node-contextmenu","node-collapse","node-expand","check","node-drag-start","node-drag-end","node-drop","node-drag-leave","node-drag-enter","node-drag-over"],setup(e,t){const{t:n}=Jg(),r=rv("tree"),i=At(new CV({key:e.nodeKey,data:e.data,lazy:e.lazy,props:e.props,load:e.load,currentNodeKey:e.currentNodeKey,checkStrictly:e.checkStrictly,checkDescendants:e.checkDescendants,defaultCheckedKeys:e.defaultCheckedKeys,defaultExpandedKeys:e.defaultExpandedKeys,autoExpandParent:e.autoExpandParent,defaultExpandAll:e.defaultExpandAll,filterNodeMethod:e.filterNodeMethod}));i.value.initialize();const a=At(i.value.root),s=At(null),o=At(null),l=At(null),{broadcastExpanded:u}=MV(e),{dragState:c}=function({props:e,ctx:t,el$:n,dropIndicator$:r,store:i}){const a=rv("tree"),s=At({showDropIndicator:!1,draggingNode:null,dropNode:null,allowDrop:!0,dropType:null});return wn(EV,{treeNodeDragStart:({event:n,treeNode:r})=>{if("function"==typeof e.allowDrag&&!e.allowDrag(r.node))return n.preventDefault(),!1;n.dataTransfer.effectAllowed="move";try{n.dataTransfer.setData("text/plain","")}catch(zA){}s.value.draggingNode=r,t.emit("node-drag-start",r.node,n)},treeNodeDragOver:({event:i,treeNode:o})=>{const l=o,u=s.value.dropNode;u&&u!==l&&qh(u.$el,a.is("drop-inner"));const c=s.value.draggingNode;if(!c||!l)return;let d=!0,h=!0,p=!0,f=!0;"function"==typeof e.allowDrop&&(d=e.allowDrop(c.node,l.node,"prev"),f=h=e.allowDrop(c.node,l.node,"inner"),p=e.allowDrop(c.node,l.node,"next")),i.dataTransfer.dropEffect=h||d||p?"move":"none",(d||h||p)&&u!==l&&(u&&t.emit("node-drag-leave",c.node,u.node,i),t.emit("node-drag-enter",c.node,l.node,i)),(d||h||p)&&(s.value.dropNode=l),l.node.nextSibling===c.node&&(p=!1),l.node.previousSibling===c.node&&(d=!1),l.node.contains(c.node,!1)&&(h=!1),(c.node===l.node||c.node.contains(l.node))&&(d=!1,h=!1,p=!1);const m=l.$el.getBoundingClientRect(),g=n.value.getBoundingClientRect();let v;const y=d?h?.25:p?.45:1:-1,_=p?h?.75:d?.55:0:1;let b=-9999;const x=i.clientY-m.top;v=x<m.height*y?"before":x>m.height*_?"after":h?"inner":"none";const w=l.$el.querySelector(`.${a.be("node","expand-icon")}`).getBoundingClientRect(),S=r.value;"before"===v?b=w.top-g.top:"after"===v&&(b=w.bottom-g.top),S.style.top=`${b}px`,S.style.left=w.right-g.left+"px","inner"===v?Xh(l.$el,a.is("drop-inner")):qh(l.$el,a.is("drop-inner")),s.value.showDropIndicator="before"===v||"after"===v,s.value.allowDrop=s.value.showDropIndicator||f,s.value.dropType=v,t.emit("node-drag-over",c.node,l.node,i)},treeNodeDragEnd:e=>{const{draggingNode:n,dropType:r,dropNode:o}=s.value;if(e.preventDefault(),e.dataTransfer.dropEffect="move",n&&o){const s={data:n.node.data};"none"!==r&&n.node.remove(),"before"===r?o.node.parent.insertBefore(s,o.node):"after"===r?o.node.parent.insertAfter(s,o.node):"inner"===r&&o.node.insertChild(s),"none"!==r&&i.value.registerNode(s),qh(o.$el,a.is("drop-inner")),t.emit("node-drag-end",n.node,o.node,r,e),"none"!==r&&t.emit("node-drop",n.node,o.node,r,e)}n&&!o&&t.emit("node-drag-end",n.node,null,r,e),s.value.showDropIndicator=!1,s.value.draggingNode=null,s.value.dropNode=null,s.value.allowDrop=!0}}),{dragState:s}}({props:e,ctx:t,el$:o,dropIndicator$:l,store:i});!function({el$:e},t){const n=rv("tree"),r=Pt([]),i=Pt([]);Kn((()=>{a()})),Jn((()=>{r.value=Array.from(e.value.querySelectorAll("[role=treeitem]")),i.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"))})),Mn(i,(e=>{e.forEach((e=>{e.setAttribute("tabindex","-1")}))})),Zs(e,"keydown",(i=>{const a=i.target;if(!a.className.includes(n.b("node")))return;const s=i.code;r.value=Array.from(e.value.querySelectorAll(`.${n.is("focusable")}[role=treeitem]`));const o=r.value.indexOf(a);let l;if([Sg.up,Sg.down].includes(s)){if(i.preventDefault(),s===Sg.up){l=-1===o?0:0!==o?o-1:r.value.length-1;const e=l;for(;!t.value.getNode(r.value[l].dataset.key).canFocus;){if(l--,l===e){l=-1;break}l<0&&(l=r.value.length-1)}}else{l=-1===o?0:o<r.value.length-1?o+1:0;const e=l;for(;!t.value.getNode(r.value[l].dataset.key).canFocus;){if(l++,l===e){l=-1;break}l>=r.value.length&&(l=0)}}-1!==l&&r.value[l].focus()}[Sg.left,Sg.right].includes(s)&&(i.preventDefault(),a.click());const u=a.querySelector('[type="checkbox"]');[Sg.enter,Sg.space].includes(s)&&u&&(i.preventDefault(),u.click())}));const a=()=>{var t;r.value=Array.from(e.value.querySelectorAll(`.${n.is("focusable")}[role=treeitem]`)),i.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"));const a=e.value.querySelectorAll(`.${n.is("checked")}[role=treeitem]`);a.length?a[0].setAttribute("tabindex","0"):null==(t=r.value[0])||t.setAttribute("tabindex","0")}}({el$:o},i);const d=Ki((()=>{const{childNodes:e}=a.value;return!e||0===e.length||e.every((({visible:e})=>!e))}));Mn((()=>e.currentNodeKey),(e=>{i.value.setCurrentNodeKey(e)})),Mn((()=>e.defaultCheckedKeys),(e=>{i.value.setDefaultCheckedKey(e)})),Mn((()=>e.defaultExpandedKeys),(e=>{i.value.setDefaultExpandedKeys(e)})),Mn((()=>e.data),(e=>{i.value.setData(e)}),{deep:!0}),Mn((()=>e.checkStrictly),(e=>{i.value.checkStrictly=e}));const h=()=>{const e=i.value.getCurrentNode();return e?e.data:null};return wn("RootTree",{ctx:t,props:e,store:i,root:a,currentNode:s,instance:Fi()}),wn(cb,void 0),{ns:r,store:i,root:a,currentNode:s,dragState:c,el$:o,dropIndicator$:l,isEmpty:d,filter:t=>{if(!e.filterNodeMethod)throw new Error("[Tree] filterNodeMethod is required when filter");i.value.filter(t)},getNodeKey:t=>vV(e.nodeKey,t.data),getNodePath:t=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getNodePath");const n=i.value.getNode(t);if(!n)return[];const r=[n.data];let s=n.parent;for(;s&&s!==a.value;)r.push(s.data),s=s.parent;return r.reverse()},getCheckedNodes:(e,t)=>i.value.getCheckedNodes(e,t),getCheckedKeys:e=>i.value.getCheckedKeys(e),getCurrentNode:h,getCurrentKey:()=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getCurrentKey");const t=h();return t?t[e.nodeKey]:null},setCheckedNodes:(t,n)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedNodes");i.value.setCheckedNodes(t,n)},setCheckedKeys:(t,n)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedKeys");i.value.setCheckedKeys(t,n)},setChecked:(e,t,n)=>{i.value.setChecked(e,t,n)},getHalfCheckedNodes:()=>i.value.getHalfCheckedNodes(),getHalfCheckedKeys:()=>i.value.getHalfCheckedKeys(),setCurrentNode:(n,r=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentNode");yV(i,t.emit,(()=>i.value.setUserCurrentNode(n,r)))},setCurrentKey:(n,r=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentKey");yV(i,t.emit,(()=>i.value.setCurrentNodeKey(n,r)))},t:n,getNode:e=>i.value.getNode(e),remove:e=>{i.value.remove(e)},append:(e,t)=>{i.value.append(e,t)},insertBefore:(e,t)=>{i.value.insertBefore(e,t)},insertAfter:(e,t)=>{i.value.insertAfter(e,t)},handleNodeExpand:(e,n,r)=>{u(n),t.emit("node-expand",e,n,r)},updateKeyChildren:(t,n)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in updateKeyChild");i.value.updateChildren(t,n)}}}});var kV=J_(LV,[["render",function(e,t,n,r,i,a){var s;const o=ur("el-tree-node");return fi(),yi("div",{ref:"el$",class:l([e.ns.b(),e.ns.is("dragging",!!e.dragState.draggingNode),e.ns.is("drop-not-allow",!e.dragState.allowDrop),e.ns.is("drop-inner","inner"===e.dragState.dropType),{[e.ns.m("highlight-current")]:e.highlightCurrent}]),role:"tree"},[(fi(!0),yi(li,null,mr(e.root.childNodes,(t=>(fi(),_i(o,{key:e.getNodeKey(t),node:t,props:e.props,accordion:e.accordion,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,"render-content":e.renderContent,onNodeExpand:e.handleNodeExpand},null,8,["node","props","accordion","render-after-expand","show-checkbox","render-content","onNodeExpand"])))),128)),e.isEmpty?(fi(),yi("div",{key:0,class:l(e.ns.e("empty-block"))},[Ti("span",{class:l(e.ns.e("empty-text"))},f(null!=(s=e.emptyText)?s:e.t("el.tree.emptyText")),3)],2)):Li("v-if",!0),ar(Ti("div",{ref:"dropIndicator$",class:l(e.ns.e("drop-indicator"))},null,2),[[is,e.dragState.showDropIndicator]])],2)}],["__file","/home/runner/work/element-plus/element-plus/packages/components/tree/src/tree.vue"]]);kV.install=e=>{e.component(kV.name,kV)};const DV=kV,IV=DV,OV=Fn({extends:OD,setup(e,t){const n=OD.setup(e,t);delete n.selectOptionClick;const r=Fi().proxy;return en((()=>{n.select.cachedOptions.get(r.value)||n.select.onOptionCreate(r)})),n},methods:{selectOptionClick(){this.$el.parentElement.click()}}});function NV(e){return e||0===e}function BV(e){return Array.isArray(e)&&e.length}function UV(e){return Array.isArray(e)?e:NV(e)?[e]:[]}function zV(e,t,n,r,i){for(let a=0;a<e.length;a++){const s=e[a];if(t(s,a,e,i))return r?r(s,a,e,i):s;{const e=n(s);if(BV(e)){const i=zV(e,t,n,r,s);if(i)return i}}}}function FV(e,t,n,r){for(let i=0;i<e.length;i++){const a=e[i];t(a,i,e,r);const s=n(a);BV(s)&&FV(s,t,n,a)}}const VV=(e,{attrs:t,slots:n,emit:r},{select:i,tree:a,key:s})=>{Mn((()=>e.modelValue),(()=>{e.showCheckbox&&en((()=>{const t=a.value;t&&!Eh(t.getCheckedKeys(),UV(e.modelValue))&&t.setCheckedKeys(UV(e.modelValue))}))}),{immediate:!0,deep:!0});const o=Ki((()=>({value:s.value,label:"label",children:"children",disabled:"disabled",isLeaf:"isLeaf",...e.props}))),l=(e,t)=>{var n;const r=o.value[e];return k(r)?r(t,null==(n=a.value)?void 0:n.getNode(l("value",t))):t[r]},u=UV(e.modelValue).map((t=>zV(e.data||[],(e=>l("value",e)===t),(e=>l("children",e)),((e,t,n,r)=>r&&l("value",r))))).filter((e=>NV(e))),c=Ki((()=>{if(!e.renderAfterExpand&&!e.lazy)return[];const t=[];return FV(e.data.concat(e.cacheData),(e=>{const n=l("value",e);t.push({value:n,currentLabel:l("label",e),isDisabled:l("disabled",e)})}),(e=>l("children",e))),t}));return{...Dh(Nt(e),Object.keys(DV.props)),...t,nodeKey:s,expandOnClickNode:Ki((()=>!e.checkStrictly&&e.expandOnClickNode)),defaultExpandedKeys:Ki((()=>e.defaultExpandedKeys?e.defaultExpandedKeys.concat(u):u)),renderContent:(t,{node:r,data:i,store:a})=>t(OV,{value:l("value",i),label:l("label",i),disabled:l("disabled",i)},e.renderContent?()=>e.renderContent(t,{node:r,data:i,store:a}):n.default?()=>n.default({node:r,data:i,store:a}):void 0),filterNodeMethod:(t,n,r)=>{var i;return e.filterNodeMethod?e.filterNodeMethod(t,n,r):!t||(null==(i=l("label",n))?void 0:i.includes(t))},onNodeClick:(n,r,a)=>{var s,o,u;if(null==(s=t.onNodeClick)||s.call(t,n,r,a),!e.showCheckbox||!e.checkOnClickNode)if(e.showCheckbox||!e.checkStrictly&&!r.isLeaf)e.expandOnClickNode&&a.proxy.handleExpandIconClick();else if(!l("disabled",n)){const e=null==(o=i.value)?void 0:o.options.get(l("value",n));null==(u=i.value)||u.handleOptionSelect(e,!0)}},onCheck:(n,i)=>{var s;null==(s=t.onCheck)||s.call(t,n,i);const o=l("value",n);if(e.checkStrictly)r(Tg,e.multiple?i.checkedKeys:i.checkedKeys.includes(o)?o:void 0);else if(e.multiple)r(Tg,a.value.getCheckedKeys(!0));else{const t=zV([n],(e=>!BV(l("children",e))&&!l("disabled",e)),(e=>l("children",e))),i=t?l("value",t):void 0,a=NV(e.modelValue)&&!!zV([n],(t=>l("value",t)===e.modelValue),(e=>l("children",e)));r(Tg,i===e.modelValue||a?void 0:i)}},cacheOptions:c}};var GV=Fn({props:{data:{type:Array,default:()=>[]}},setup(e){const t=Sn(wD);return Mn((()=>e.data),(()=>{var n;e.data.forEach((e=>{t.cachedOptions.has(e.value)||t.cachedOptions.set(e.value,e)}));const r=(null==(n=t.selectWrapper)?void 0:n.querySelectorAll("input"))||[];Array.from(r).includes(document.activeElement)||t.setSelected()}),{flush:"post",immediate:!0}),()=>{}}});const HV=Fn({name:"ElTreeSelect",inheritAttrs:!1,props:{...ID.props,...DV.props,cacheData:{type:Array,default:()=>[]}},setup(e,t){const{slots:n,expose:r}=t,i=At(),a=At(),s=Ki((()=>e.nodeKey||e.valueKey||"value")),o=((e,{attrs:t},{tree:n,key:r})=>{const i=rv("tree-select"),a={...Dh(Nt(e),Object.keys(ID.props)),...t,valueKey:r,popperClass:Ki((()=>{const t=[i.e("popper")];return e.popperClass&&t.push(e.popperClass),t.join(" ")})),filterMethod:(t="")=>{e.filterMethod&&e.filterMethod(t),en((()=>{var e;null==(e=n.value)||e.filter(t)}))},onVisibleChange:n=>{var r;null==(r=t.onVisibleChange)||r.call(t,n),e.filterable&&n&&a.filterMethod()}};return a})(e,t,{select:i,tree:a,key:s}),{cacheOptions:l,...u}=VV(e,t,{select:i,tree:a,key:s}),c=pt({});return r(c),Kn((()=>{Object.assign(c,{...Dh(a.value,["filter","updateKeyChildren","getCheckedNodes","setCheckedNodes","getCheckedKeys","setCheckedKeys","setChecked","getHalfCheckedNodes","getHalfCheckedKeys","getCurrentKey","getCurrentNode","setCurrentKey","setCurrentNode","getNode","remove","append","insertBefore","insertAfter"]),...Dh(i.value,["focus","blur"])})})),()=>ea(ID,pt({...o,ref:e=>i.value=e}),{...n,default:()=>[ea(GV,{data:l.value}),ea(DV,pt({...u,ref:e=>a.value=e}))]})}});var jV=J_(HV,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tree-select/src/tree-select.vue"]]);jV.install=e=>{e.component(jV.name,jV)};const WV=jV,YV=Symbol(),$V={key:-1,level:-1,data:{}};var XV=(e=>(e.KEY="id",e.LABEL="label",e.CHILDREN="children",e.DISABLED="disabled",e))(XV||{}),qV=(e=>(e.ADD="add",e.DELETE="delete",e))(qV||{});const KV={type:Number,default:26},ZV=pg({data:{type:Array,default:()=>[]},emptyText:{type:String},height:{type:Number,default:200},props:{type:Object,default:()=>({children:"children",label:"label",disabled:"disabled",value:"id"})},highlightCurrent:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!1},defaultCheckedKeys:{type:Array,default:()=>[]},checkStrictly:{type:Boolean,default:!1},defaultExpandedKeys:{type:Array,default:()=>[]},indent:{type:Number,default:16},itemSize:KV,icon:{type:fg},expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:{type:Boolean,default:!1},currentNodeKey:{type:[String,Number]},accordion:{type:Boolean,default:!1},filterMethod:{type:Function},perfMode:{type:Boolean,default:!0}}),JV=pg({node:{type:Object,default:()=>$V},expanded:{type:Boolean,default:!1},checked:{type:Boolean,default:!1},indeterminate:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},current:{type:Boolean,default:!1},hiddenExpandIcon:{type:Boolean,default:!1},itemSize:KV}),QV=pg({node:{type:Object,required:!0}}),eG="node-click",tG="node-expand",nG="node-collapse",rG="current-change",iG="check",aG="check-change",sG="node-contextmenu",oG={[eG]:(e,t,n)=>e&&t&&n,[tG]:(e,t)=>e&&t,[nG]:(e,t)=>e&&t,[rG]:(e,t)=>e&&t,[iG]:(e,t)=>e&&t,[aG]:(e,t)=>e&&"boolean"==typeof t,[sG]:(e,t,n)=>e&&t&&n};function lG(e,t){const n=At(new Set(e.defaultExpandedKeys)),r=At(),i=Pt();Mn((()=>e.currentNodeKey),(e=>{r.value=e}),{immediate:!0}),Mn((()=>e.data),(e=>{L(e)}),{immediate:!0});const{isIndeterminate:a,isChecked:s,toggleCheckbox:o,getCheckedKeys:l,getCheckedNodes:u,getHalfCheckedKeys:c,getHalfCheckedNodes:d,setChecked:h,setCheckedKeys:p}=function(e,t){const n=At(new Set),r=At(new Set),{emit:i}=Fi();Mn([()=>t.value,()=>e.defaultCheckedKeys],(()=>en((()=>{d(e.defaultCheckedKeys)}))),{immediate:!0});const a=()=>{if(!t.value||!e.showCheckbox||e.checkStrictly)return;const{levelTreeNodeMap:i,maxLevel:a}=t.value,s=n.value,o=new Set;for(let e=a-1;e>=1;--e){const t=i.get(e);t&&t.forEach((e=>{const t=e.children;if(t){let n=!0,r=!1;for(const e of t){const t=e.key;if(s.has(t))r=!0;else{if(o.has(t)){n=!1,r=!0;break}n=!1}}n?s.add(e.key):r?(o.add(e.key),s.delete(e.key)):(s.delete(e.key),o.delete(e.key))}}))}r.value=o},s=e=>n.value.has(e.key),o=(t,r,i=!0)=>{const s=n.value,o=(t,n)=>{s[n?qV.ADD:qV.DELETE](t.key);const r=t.children;!e.checkStrictly&&r&&r.forEach((e=>{e.disabled||o(e,n)}))};o(t,r),a(),i&&l(t,r)},l=(e,t)=>{const{checkedNodes:n,checkedKeys:r}=u(),{halfCheckedNodes:a,halfCheckedKeys:s}=c();i(iG,e.data,{checkedKeys:r,checkedNodes:n,halfCheckedKeys:s,halfCheckedNodes:a}),i(aG,e.data,t)};function u(r=!1){const i=[],a=[];if((null==t?void 0:t.value)&&e.showCheckbox){const{treeNodeMap:e}=t.value;n.value.forEach((t=>{const n=e.get(t);n&&(!r||r&&n.isLeaf)&&(a.push(t),i.push(n.data))}))}return{checkedKeys:a,checkedNodes:i}}function c(){const n=[],i=[];if((null==t?void 0:t.value)&&e.showCheckbox){const{treeNodeMap:e}=t.value;r.value.forEach((t=>{const r=e.get(t);r&&(i.push(t),n.push(r.data))}))}return{halfCheckedNodes:n,halfCheckedKeys:i}}function d(n){if(null==t?void 0:t.value){const{treeNodeMap:r}=t.value;if(e.showCheckbox&&r&&n)for(const e of n){const t=r.get(e);t&&!s(t)&&o(t,!0,!1)}}}return{updateCheckedKeys:a,toggleCheckbox:o,isChecked:s,isIndeterminate:e=>r.value.has(e.key),getCheckedKeys:function(e=!1){return u(e).checkedKeys},getCheckedNodes:function(e=!1){return u(e).checkedNodes},getHalfCheckedKeys:function(){return c().halfCheckedKeys},getHalfCheckedNodes:function(){return c().halfCheckedNodes},setChecked:function(n,r){if((null==t?void 0:t.value)&&e.showCheckbox){const e=t.value.treeNodeMap.get(n);e&&o(e,r,!1)}},setCheckedKeys:function(e){n.value.clear(),r.value.clear(),d(e)}}}(e,i),{doFilter:f,hiddenNodeKeySet:m,isForceHiddenExpandIcon:g}=function(e,t){const n=At(new Set([])),r=At(new Set([])),i=Ki((()=>k(e.filterMethod)));return{hiddenExpandIconKeySet:r,hiddenNodeKeySet:n,doFilter:function(a){var s;if(!i.value)return;const o=new Set,l=r.value,u=n.value,c=[],d=(null==(s=t.value)?void 0:s.treeNodes)||[],h=e.filterMethod;return u.clear(),function e(t){t.forEach((t=>{c.push(t),(null==h?void 0:h(a,t.data))?c.forEach((e=>{o.add(e.key)})):t.isLeaf&&u.add(t.key);const n=t.children;if(n&&e(n),!t.isLeaf)if(o.has(t.key)){if(n){let e=!0;for(const t of n)if(!u.has(t.key)){e=!1;break}e?l.add(t.key):l.delete(t.key)}}else u.add(t.key);c.pop()}))}(d),o},isForceHiddenExpandIcon:function(e){return r.value.has(e.key)}}}(e,i),v=Ki((()=>{var t;return(null==(t=e.props)?void 0:t.value)||XV.KEY})),y=Ki((()=>{var t;return(null==(t=e.props)?void 0:t.children)||XV.CHILDREN})),_=Ki((()=>{var t;return(null==(t=e.props)?void 0:t.disabled)||XV.DISABLED})),b=Ki((()=>{var t;return(null==(t=e.props)?void 0:t.label)||XV.LABEL})),x=Ki((()=>{const e=n.value,t=m.value,r=[],a=i.value&&i.value.treeNodes||[];return function(){const n=[];for(let e=a.length-1;e>=0;--e)n.push(a[e]);for(;n.length;){const i=n.pop();if(i&&(t.has(i.key)||r.push(i),e.has(i.key))){const e=i.children;if(e){for(let t=e.length-1;t>=0;--t)n.push(e[t])}}}}(),r})),w=Ki((()=>x.value.length>0));function S(e){return e[y.value]}function C(e){return e?e[v.value]:""}function T(e){return e[_.value]}function M(e){return e[b.value]}function E(e){n.value.has(e.key)?P(e):A(e)}function A(r){const a=n.value;if(i.value&&e.accordion){const{treeNodeMap:e}=i.value;a.forEach((t=>{const n=e.get(t);r&&r.level===(null==n?void 0:n.level)&&a.delete(t)}))}a.add(r.key),t(tG,r.data,r)}function P(e){n.value.delete(e.key),t(nG,e.data,e)}function R(e){const t=r.value;return!!t&&t===e.key}function L(e){en((()=>i.value=function(e){const t=new Map,n=new Map;let r=1;const i=function e(i,a=1,s){var o;const l=[];for(const r of i){const i=C(r),u={level:a,key:i,data:r};u.label=M(r),u.parent=s;const c=S(r);u.disabled=T(r),u.isLeaf=!c||0===c.length,c&&c.length&&(u.children=e(c,a+1,u)),l.push(u),t.set(i,u),n.has(a)||n.set(a,[]),null==(o=n.get(a))||o.push(u)}return a>r&&(r=a),l}(e);return{treeNodeMap:t,levelTreeNodeMap:n,maxLevel:r,treeNodes:i}}(e)))}return{tree:i,flattenTree:x,isNotEmpty:w,getKey:C,getChildren:S,toggleExpand:E,toggleCheckbox:o,isExpanded:function(e){return n.value.has(e.key)},isChecked:s,isIndeterminate:a,isDisabled:function(e){return!!e.disabled},isCurrent:R,isForceHiddenExpandIcon:g,handleNodeClick:function(n,i){t(eG,n.data,n,i),function(e){R(e)||(r.value=e.key,t(rG,e.data,e))}(n),e.expandOnClickNode&&E(n),e.showCheckbox&&e.checkOnClickNode&&!n.disabled&&o(n,!s(n),!0)},handleNodeCheck:function(e,t){o(e,t)},getCurrentNode:function(){var e,t;if(r.value)return null==(t=null==(e=i.value)?void 0:e.treeNodeMap.get(r.value))?void 0:t.data},getCurrentKey:function(){return r.value},setCurrentKey:function(e){r.value=e},getCheckedKeys:l,getCheckedNodes:u,getHalfCheckedKeys:c,getHalfCheckedNodes:d,setChecked:h,setCheckedKeys:p,filter:function(e){const t=f(e);t&&(n.value=t)},setData:L,getNode:function(e){var t;const n=O(e)?C(e):e;return null==(t=i.value)?void 0:t.treeNodeMap.get(n)},expandNode:A,collapseNode:P,setExpandedKeys:function(e){n.value=new Set(e)}}}var uG=Fn({name:"ElTreeNodeContent",props:QV,setup(e){const t=Sn(YV),n=rv("tree");return()=>{const r=e.node,{data:i}=r;return(null==t?void 0:t.ctx.slots.default)?t.ctx.slots.default({node:r,data:i}):ea("span",{class:n.be("node","label")},[null==r?void 0:r.label])}}});const cG=["aria-expanded","aria-disabled","aria-checked","data-key","onClick"],dG=Fn({name:"ElTreeNode"}),hG=Fn({...dG,props:JV,emits:{click:(e,t)=>!(!e||!t),toggle:e=>!!e,check:(e,t)=>e&&"boolean"==typeof t},setup(e,{emit:t}){const n=e,i=Sn(YV),a=rv("tree"),s=Ki((()=>{var e;return null!=(e=null==i?void 0:i.props.indent)?e:16})),o=Ki((()=>{var e;return null!=(e=null==i?void 0:i.props.icon)?e:Lp})),u=e=>{t("click",n.node,e)},c=()=>{t("toggle",n.node)},d=e=>{t("check",n.node,e)},h=e=>{var t,r,a,s;(null==(a=null==(r=null==(t=null==i?void 0:i.instance)?void 0:t.vnode)?void 0:r.props)?void 0:a.onNodeContextmenu)&&(e.stopPropagation(),e.preventDefault()),null==i||i.ctx.emit(sG,e,null==(s=n.node)?void 0:s.data,n.node)};return(e,t)=>{var n,i,p;return fi(),yi("div",{ref:"node$",class:l([Dt(a).b("node"),Dt(a).is("expanded",e.expanded),Dt(a).is("current",e.current),Dt(a).is("focusable",!e.disabled),Dt(a).is("checked",!e.disabled&&e.checked)]),role:"treeitem",tabindex:"-1","aria-expanded":e.expanded,"aria-disabled":e.disabled,"aria-checked":e.checked,"data-key":null==(n=e.node)?void 0:n.key,onClick:ts(u,["stop"]),onContextmenu:h},[Ti("div",{class:l(Dt(a).be("node","content")),style:r({paddingLeft:(e.node.level-1)*Dt(s)+"px",height:e.itemSize+"px"})},[Dt(o)?(fi(),_i(Dt(ib),{key:0,class:l([Dt(a).is("leaf",!!(null==(i=e.node)?void 0:i.isLeaf)),Dt(a).is("hidden",e.hiddenExpandIcon),{expanded:!(null==(p=e.node)?void 0:p.isLeaf)&&e.expanded},Dt(a).be("node","expand-icon")]),onClick:ts(c,["stop"])},{default:vn((()=>[(fi(),_i(dr(Dt(o))))])),_:1},8,["class","onClick"])):Li("v-if",!0),e.showCheckbox?(fi(),_i(Dt(mM),{key:1,"model-value":e.checked,indeterminate:e.indeterminate,disabled:e.disabled,onChange:d,onClick:t[0]||(t[0]=ts((()=>{}),["stop"]))},null,8,["model-value","indeterminate","disabled"])):Li("v-if",!0),Mi(Dt(uG),{node:e.node},null,8,["node"])],6)],42,cG)}}});var pG=J_(hG,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tree-v2/src/tree-node.vue"]]);const fG=Fn({name:"ElTreeV2"}),mG=Fn({...fG,props:ZV,emits:oG,setup(e,{expose:t,emit:n}){const i=e,a=Zi(),s=Ki((()=>i.itemSize));wn(YV,{ctx:{emit:n,slots:a},props:i,instance:Fi()}),wn(cb,void 0);const{t:o}=Jg(),u=rv("tree"),{flattenTree:c,isNotEmpty:d,toggleExpand:h,isExpanded:p,isIndeterminate:m,isChecked:g,isDisabled:v,isCurrent:y,isForceHiddenExpandIcon:_,handleNodeClick:b,handleNodeCheck:x,toggleCheckbox:w,getCurrentNode:S,getCurrentKey:C,setCurrentKey:T,getCheckedKeys:M,getCheckedNodes:E,getHalfCheckedKeys:A,getHalfCheckedNodes:P,setChecked:R,setCheckedKeys:L,filter:k,setData:D,getNode:I,expandNode:O,collapseNode:N,setExpandedKeys:B}=lG(i,n);return t({toggleCheckbox:w,getCurrentNode:S,getCurrentKey:C,setCurrentKey:T,getCheckedKeys:M,getCheckedNodes:E,getHalfCheckedKeys:A,getHalfCheckedNodes:P,setChecked:R,setCheckedKeys:L,filter:k,setData:D,getNode:I,expandNode:O,collapseNode:N,setExpandedKeys:B}),(e,t)=>{var n;return fi(),yi("div",{class:l([Dt(u).b(),{[Dt(u).m("highlight-current")]:e.highlightCurrent}]),role:"tree"},[Dt(d)?(fi(),_i(Dt(IO),{key:0,"class-name":Dt(u).b("virtual-list"),data:Dt(c),total:Dt(c).length,height:e.height,"item-size":Dt(s),"perf-mode":e.perfMode},{default:vn((({data:t,index:n,style:i})=>[(fi(),_i(pG,{key:t[n].key,style:r(i),node:t[n],expanded:Dt(p)(t[n]),"show-checkbox":e.showCheckbox,checked:Dt(g)(t[n]),indeterminate:Dt(m)(t[n]),"item-size":Dt(s),disabled:Dt(v)(t[n]),current:Dt(y)(t[n]),"hidden-expand-icon":Dt(_)(t[n]),onClick:Dt(b),onToggle:Dt(h),onCheck:Dt(x)},null,8,["style","node","expanded","show-checkbox","checked","indeterminate","item-size","disabled","current","hidden-expand-icon","onClick","onToggle","onCheck"]))])),_:1},8,["class-name","data","total","height","item-size","perf-mode"])):(fi(),yi("div",{key:1,class:l(Dt(u).e("empty-block"))},[Ti("span",{class:l(Dt(u).e("empty-text"))},f(null!=(n=e.emptyText)?n:Dt(o)("el.tree.emptyText")),3)],2))],2)}}});const gG=_g(J_(mG,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tree-v2/src/tree.vue"]])),vG=Symbol("uploadContextKey");class yG extends Error{constructor(e,t,n,r){super(e),this.name="UploadAjaxError",this.status=t,this.method=n,this.url=r}}function _G(e,t,n){let r;return r=n.response?`${n.response.error||n.response}`:n.responseText?`${n.responseText}`:`fail to ${t.method} ${e} ${n.status}`,new yG(r,n.status,t.method,e)}const bG=["text","picture","picture-card"];let xG=1;const wG=()=>Date.now()+xG++,SG=pg({action:{type:String,default:"#"},headers:{type:Object},method:{type:String,default:"post"},data:{type:Object,default:()=>({})},multiple:{type:Boolean,default:!1},name:{type:String,default:"file"},drag:{type:Boolean,default:!1},withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},type:{type:String,default:"select"},fileList:{type:Array,default:()=>[]},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:bG,default:"text"},httpRequest:{type:Function,default:e=>{"undefined"==typeof XMLHttpRequest&&Wh("ElUpload","XMLHttpRequest is undefined");const t=new XMLHttpRequest,n=e.action;t.upload&&t.upload.addEventListener("progress",(t=>{const n=t;n.percent=t.total>0?t.loaded/t.total*100:0,e.onProgress(n)}));const r=new FormData;if(e.data)for(const[a,s]of Object.entries(e.data))Array.isArray(s)?r.append(a,...s):r.append(a,s);r.append(e.filename,e.file,e.file.name),t.addEventListener("error",(()=>{e.onError(_G(n,e,t))})),t.addEventListener("load",(()=>{if(t.status<200||t.status>=300)return e.onError(_G(n,e,t));e.onSuccess(function(e){const t=e.responseText||e.response;if(!t)return t;try{return JSON.parse(t)}catch(zA){return t}}(t))})),t.open(e.method,n,!0),e.withCredentials&&"withCredentials"in t&&(t.withCredentials=!0);const i=e.headers||{};if(i instanceof Headers)i.forEach(((e,n)=>t.setRequestHeader(n,e)));else for(const[a,s]of Object.entries(i))Ah(s)||t.setRequestHeader(a,String(s));return t.send(r),t}},disabled:Boolean,limit:Number}),CG=pg({...SG,beforeUpload:{type:Function,default:y},beforeRemove:{type:Function},onRemove:{type:Function,default:y},onChange:{type:Function,default:y},onPreview:{type:Function,default:y},onSuccess:{type:Function,default:y},onProgress:{type:Function,default:y},onError:{type:Function,default:y},onExceed:{type:Function,default:y}}),TG=pg({files:{type:Array,default:()=>[]},disabled:{type:Boolean,default:!1},handlePreview:{type:Function,default:y},listType:{type:String,values:bG,default:"text"}}),MG=["onKeydown"],EG=["src"],AG=["onClick"],PG=["onClick"],RG=["onClick"],LG=Fn({name:"ElUploadList"}),kG=Fn({...LG,props:TG,emits:{remove:e=>!!e},setup(e,{emit:t}){const{t:n}=Jg(),i=rv("upload"),a=rv("icon"),s=rv("list"),o=hb(),u=At(!1),c=e=>{t("remove",e)};return(e,t)=>(fi(),_i(Fa,{tag:"ul",class:l([Dt(i).b("list"),Dt(i).bm("list",e.listType),Dt(i).is("disabled",Dt(o))]),name:Dt(s).b()},{default:vn((()=>[(fi(!0),yi(li,null,mr(e.files,(s=>(fi(),yi("li",{key:s.uid||s.name,class:l([Dt(i).be("list","item"),Dt(i).is(s.status),{focusing:u.value}]),tabindex:"0",onKeydown:rs((e=>!Dt(o)&&c(s)),["delete"]),onFocus:t[0]||(t[0]=e=>u.value=!0),onBlur:t[1]||(t[1]=e=>u.value=!1),onClick:t[2]||(t[2]=e=>u.value=!1)},[vr(e.$slots,"default",{file:s},(()=>["picture"===e.listType||"uploading"!==s.status&&"picture-card"===e.listType?(fi(),yi("img",{key:0,class:l(Dt(i).be("list","item-thumbnail")),src:s.url,alt:""},null,10,EG)):Li("v-if",!0),"uploading"===s.status||"picture-card"!==e.listType?(fi(),yi("div",{key:1,class:l(Dt(i).be("list","item-info"))},[Ti("a",{class:l(Dt(i).be("list","item-name")),onClick:ts((t=>e.handlePreview(s)),["prevent"])},[Mi(Dt(ib),{class:l(Dt(a).m("document"))},{default:vn((()=>[Mi(Dt(Mf))])),_:1},8,["class"]),Ti("span",{class:l(Dt(i).be("list","item-file-name"))},f(s.name),3)],10,AG),"uploading"===s.status?(fi(),_i(Dt(II),{key:0,type:"picture-card"===e.listType?"circle":"line","stroke-width":"picture-card"===e.listType?6:2,percentage:Number(s.percentage),style:r("picture-card"===e.listType?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):Li("v-if",!0)],2)):Li("v-if",!0),Ti("label",{class:l(Dt(i).be("list","item-status-label"))},["text"===e.listType?(fi(),_i(Dt(ib),{key:0,class:l([Dt(a).m("upload-success"),Dt(a).m("circle-check")])},{default:vn((()=>[Mi(Dt($p))])),_:1},8,["class"])):["picture-card","picture"].includes(e.listType)?(fi(),_i(Dt(ib),{key:1,class:l([Dt(a).m("upload-success"),Dt(a).m("check")])},{default:vn((()=>[Mi(Dt(zp))])),_:1},8,["class"])):Li("v-if",!0)],2),Dt(o)?Li("v-if",!0):(fi(),_i(Dt(ib),{key:2,class:l(Dt(a).m("close")),onClick:e=>c(s)},{default:vn((()=>[Mi(Dt(cf))])),_:2},1032,["class","onClick"])),Li(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),Li(" This is a bug which needs to be fixed "),Li(" TODO: Fix the incorrect navigation interaction "),Dt(o)?Li("v-if",!0):(fi(),yi("i",{key:3,class:l(Dt(a).m("close-tip"))},f(Dt(n)("el.upload.deleteTip")),3)),"picture-card"===e.listType?(fi(),yi("span",{key:4,class:l(Dt(i).be("list","item-actions"))},[Ti("span",{class:l(Dt(i).be("list","item-preview")),onClick:t=>e.handlePreview(s)},[Mi(Dt(ib),{class:l(Dt(a).m("zoom-in"))},{default:vn((()=>[Mi(Dt(sg))])),_:1},8,["class"])],10,PG),Dt(o)?Li("v-if",!0):(fi(),yi("span",{key:0,class:l(Dt(i).be("list","item-delete")),onClick:e=>c(s)},[Mi(Dt(ib),{class:l(Dt(a).m("delete"))},{default:vn((()=>[Mi(Dt(wf))])),_:1},8,["class"])],10,RG))],2)):Li("v-if",!0)]))],42,MG)))),128)),vr(e.$slots,"append")])),_:3},8,["class","name"]))}});var DG=J_(kG,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-list.vue"]]);const IG=pg({disabled:{type:Boolean,default:!1}}),OG={file:e=>E(e)},NG=["onDrop","onDragover"],BG="ElUploadDrag",UG=Fn({name:BG}),zG=Fn({...UG,props:IG,emits:OG,setup(e,{emit:t}){const n=Sn(vG);n||Wh(BG,"usage: <el-upload><el-upload-dragger /></el-upload>");const r=rv("upload"),i=At(!1),a=hb(),s=e=>{if(a.value)return;i.value=!1,e.stopPropagation();const r=Array.from(e.dataTransfer.files),s=n.accept.value;if(!s)return void t("file",r);const o=r.filter((e=>{const{type:t,name:n}=e,r=n.includes(".")?`.${n.split(".").pop()}`:"",i=t.replace(/\/.*$/,"");return s.split(",").map((e=>e.trim())).filter((e=>e)).some((e=>e.startsWith(".")?r===e:/\/\*$/.test(e)?i===e.replace(/\/\*$/,""):!!/^[^/]+\/[^/]+$/.test(e)&&t===e))}));t("file",o)},o=()=>{a.value||(i.value=!0)};return(e,t)=>(fi(),yi("div",{class:l([Dt(r).b("dragger"),Dt(r).is("dragover",i.value)]),onDrop:ts(s,["prevent"]),onDragover:ts(o,["prevent"]),onDragleave:t[0]||(t[0]=ts((e=>i.value=!1),["prevent"]))},[vr(e.$slots,"default")],42,NG))}});var FG=J_(zG,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-dragger.vue"]]);const VG=pg({...SG,beforeUpload:{type:Function,default:y},onRemove:{type:Function,default:y},onStart:{type:Function,default:y},onSuccess:{type:Function,default:y},onProgress:{type:Function,default:y},onError:{type:Function,default:y},onExceed:{type:Function,default:y}}),GG=["onKeydown"],HG=["name","multiple","accept"],jG=Fn({name:"ElUploadContent",inheritAttrs:!1}),WG=Fn({...jG,props:VG,setup(e,{expose:t}){const n=e,r=rv("upload"),i=hb(),a=Pt({}),s=Pt(),o=e=>{if(0===e.length)return;const{autoUpload:t,limit:r,fileList:i,multiple:a,onStart:s,onExceed:o}=n;if(r&&i.length+e.length>r)o(e,i);else{a||(e=e.slice(0,1));for(const n of e){const e=n;e.uid=wG(),s(e),t&&u(e)}}},u=async e=>{if(s.value.value="",!n.beforeUpload)return c(e);let t,r={};try{const i=n.beforeUpload(e);r=O(n.data)?yd(n.data):n.data,t=await i}catch(zA){t=!1}if(!1===t)return void n.onRemove(e);let i=e;t instanceof Blob&&(i=t instanceof File?t:new File([t],e.name,{type:e.type})),c(Object.assign(i,{uid:e.uid}),r)},c=(e,t)=>{const{headers:r,data:i,method:s,withCredentials:o,name:l,action:u,onProgress:c,onSuccess:d,onError:h,httpRequest:p}=n,{uid:f}=e,m={headers:r||{},withCredentials:o,file:e,data:null!=t?t:i,method:s,filename:l,action:u,onProgress:t=>{c(t,e)},onSuccess:t=>{d(t,e),delete a.value[f]},onError:t=>{h(t,e),delete a.value[f]}},g=p(m);a.value[f]=g,g instanceof Promise&&g.then(m.onSuccess,m.onError)},d=e=>{const t=e.target.files;t&&o(Array.from(t))},h=()=>{i.value||(s.value.value="",s.value.click())},p=()=>{h()};return t({abort:e=>{const t=(n=a.value,Object.entries(n)).filter(e?([t])=>String(e.uid)===t:()=>!0);var n;t.forEach((([e,t])=>{t instanceof XMLHttpRequest&&t.abort(),delete a.value[e]}))},upload:u}),(e,t)=>(fi(),yi("div",{class:l([Dt(r).b(),Dt(r).m(e.listType),Dt(r).is("drag",e.drag)]),tabindex:"0",onClick:h,onKeydown:rs(ts(p,["self"]),["enter","space"])},[e.drag?(fi(),_i(FG,{key:0,disabled:Dt(i),onFile:o},{default:vn((()=>[vr(e.$slots,"default")])),_:3},8,["disabled"])):vr(e.$slots,"default",{key:1}),Ti("input",{ref_key:"inputRef",ref:s,class:l(Dt(r).e("input")),name:e.name,multiple:e.multiple,accept:e.accept,type:"file",onChange:d,onClick:t[0]||(t[0]=ts((()=>{}),["stop"]))},null,42,HG)],42,GG))}});var YG=J_(WG,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-content.vue"]]);const $G="ElUpload",XG=(e,t)=>{const n=go(e,"fileList",void 0,{passive:!0}),r=e=>n.value.find((t=>t.uid===e.uid));function i(e){var n;null==(n=t.value)||n.abort(e)}return Mn((()=>e.listType),(t=>{"picture-card"!==t&&"picture"!==t||(n.value=n.value.map((t=>{const{raw:r,url:i}=t;if(!i&&r)try{t.url=URL.createObjectURL(r)}catch(a){e.onError(a,t,n.value)}return t})))})),Mn(n,(e=>{for(const t of e)t.uid||(t.uid=wG()),t.status||(t.status="success")}),{immediate:!0,deep:!0}),{uploadFiles:n,abort:i,clearFiles:function(e=["ready","uploading","success","fail"]){n.value=n.value.filter((t=>!e.includes(t.status)))},handleError:(t,i)=>{const a=r(i);a&&(console.error(t),a.status="fail",n.value.splice(n.value.indexOf(a),1),e.onError(t,a,n.value),e.onChange(a,n.value))},handleProgress:(t,i)=>{const a=r(i);a&&(e.onProgress(t,a,n.value),a.status="uploading",a.percentage=Math.round(t.percent))},handleStart:t=>{Ah(t.uid)&&(t.uid=wG());const r={name:t.name,percentage:0,status:"ready",size:t.size,raw:t,uid:t.uid};if("picture-card"===e.listType||"picture"===e.listType)try{r.url=URL.createObjectURL(t)}catch(i){i.message,e.onError(i,r,n.value)}n.value=[...n.value,r],e.onChange(r,n.value)},handleSuccess:(t,i)=>{const a=r(i);a&&(a.status="success",a.response=t,e.onSuccess(t,a,n.value),e.onChange(a,n.value))},handleRemove:async t=>{const a=t instanceof File?r(t):t;a||Wh($G,"file to be removed not found");const s=t=>{i(t);const r=n.value;r.splice(r.indexOf(t),1),e.onRemove(t,r),(e=>{var t;(null==(t=e.url)?void 0:t.startsWith("blob:"))&&URL.revokeObjectURL(e.url)})(t)};if(e.beforeRemove){!1!==await e.beforeRemove(a,n.value)&&s(a)}else s(a)},submit:function(){n.value.filter((({status:e})=>"ready"===e)).forEach((({raw:e})=>{var n;return e&&(null==(n=t.value)?void 0:n.upload(e))}))}}},qG=Fn({name:"ElUpload"});const KG=_g(J_(Fn({...qG,props:CG,setup(e,{expose:t}){const n=e,r=Zi(),i=hb(),a=Pt(),{abort:s,submit:o,clearFiles:l,uploadFiles:u,handleStart:c,handleError:d,handleRemove:h,handleSuccess:p,handleProgress:f}=XG(n,a),m=Ki((()=>"picture-card"===n.listType)),g=Ki((()=>({...n,fileList:u.value,onStart:c,onProgress:f,onSuccess:p,onError:d,onRemove:h})));return Qn((()=>{u.value.forEach((({url:e})=>{(null==e?void 0:e.startsWith("blob:"))&&URL.revokeObjectURL(e)}))})),wn(vG,{accept:Ut(n,"accept")}),t({abort:s,submit:o,clearFiles:l,handleStart:c,handleRemove:h}),(e,t)=>(fi(),yi("div",null,[Dt(m)&&e.showFileList?(fi(),_i(DG,{key:0,disabled:Dt(i),"list-type":e.listType,files:Dt(u),"handle-preview":e.onPreview,onRemove:Dt(h)},gr({append:vn((()=>[Mi(YG,Oi({ref_key:"uploadRef",ref:a},Dt(g)),{default:vn((()=>[Dt(r).trigger?vr(e.$slots,"trigger",{key:0}):Li("v-if",!0),!Dt(r).trigger&&Dt(r).default?vr(e.$slots,"default",{key:1}):Li("v-if",!0)])),_:3},16)])),_:2},[e.$slots.file?{name:"default",fn:vn((({file:t})=>[vr(e.$slots,"file",{file:t})]))}:void 0]),1032,["disabled","list-type","files","handle-preview","onRemove"])):Li("v-if",!0),!Dt(m)||Dt(m)&&!e.showFileList?(fi(),_i(YG,Oi({key:1,ref_key:"uploadRef",ref:a},Dt(g)),{default:vn((()=>[Dt(r).trigger?vr(e.$slots,"trigger",{key:0}):Li("v-if",!0),!Dt(r).trigger&&Dt(r).default?vr(e.$slots,"default",{key:1}):Li("v-if",!0)])),_:3},16)):Li("v-if",!0),e.$slots.trigger?vr(e.$slots,"default",{key:2}):Li("v-if",!0),vr(e.$slots,"tip"),!Dt(m)&&e.showFileList?(fi(),_i(DG,{key:3,disabled:Dt(i),"list-type":e.listType,files:Dt(u),"handle-preview":e.onPreview,onRemove:Dt(h)},gr({_:2},[e.$slots.file?{name:"default",fn:vn((({file:t})=>[vr(e.$slots,"file",{file:t})]))}:void 0]),1032,["disabled","list-type","files","handle-preview","onRemove"])):Li("v-if",!0)]))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload.vue"]]));var ZG=[tb,lb,Hw,zz,qw,eS,iS,hS,pS,jS,WS,DT,NT,qT,KT,mE,nE,_E,mM,gM,vM,ME,jE,WE,BE,xA,q_,kA,DA,IA,OA,NA,rR,mR,gR,kR,OR,GR,DL,IL,OL,hk,rx,ix,ib,Tk,yk,mx,kk,Bk,Jk,Qk,eD,tD,sD,hI,vI,MI,vw,II,NM,UM,BM,VI,YI,SE,Tx,ID,OD,ND,yN,CN,TN,KN,QN,nB,cB,yB,_B,PB,VU,GU,Uz,rF,iF,sE,oF,_T,gF,xF,wF,Ow,ZF,fV,IV,WV,gG,KG];const JG="ElInfiniteScroll",QG={delay:{type:Number,default:200},distance:{type:Number,default:0},disabled:{type:Boolean,default:!1},immediate:{type:Boolean,default:!0}},eH=(e,t)=>Object.entries(QG).reduce(((n,[r,i])=>{var a,s;const{type:o,default:l}=i,u=e.getAttribute(`infinite-scroll-${r}`);let c=null!=(s=null!=(a=t[u])?a:u)?s:l;return c="false"!==c&&c,c=o(c),n[r]=Number.isNaN(c)?l:c,n}),{}),tH=e=>{const{observer:t}=e[JG];t&&(t.disconnect(),delete e[JG].observer)},nH=(e,t)=>{const{container:n,containerEl:r,instance:i,observer:a,lastScrollTop:s}=e[JG],{disabled:o,distance:l}=eH(e,i),{clientHeight:u,scrollHeight:c,scrollTop:d}=r,h=d-s;if(e[JG].lastScrollTop=d,a||o||h<0)return;let p=!1;if(n===e)p=c-(u+d)<=l;else{const{clientTop:t,scrollHeight:n}=e,i=((e,t)=>Math.abs(vo(e)-vo(t)))(e,r);p=d+u>=i+t+n-l}p&&t.call(i)};function rH(e,t){const{containerEl:n,instance:r}=e[JG],{disabled:i}=eH(e,r);i||0===n.clientHeight||(n.scrollHeight<=n.clientHeight?t.call(r):tH(e))}const iH={async mounted(e,t){const{instance:n,value:r}=t;k(r)||Wh(JG,"'v-infinite-scroll' binding value must be a function"),await en();const{delay:i,immediate:a}=eH(e,n),s=Qh(e,!0),o=s===window?document.documentElement:s,l=Ih(nH.bind(null,e,r),i);if(s){if(e[JG]={instance:n,container:s,containerEl:o,delay:i,cb:r,onScroll:l,lastScrollTop:o.scrollTop},a){const t=new MutationObserver(Ih(rH.bind(null,e,r),50));e[JG].observer=t,t.observe(e,{childList:!0,subtree:!0}),rH(e,r)}s.addEventListener("scroll",l)}},unmounted(e){const{container:t,onScroll:n}=e[JG];null==t||t.removeEventListener("scroll",n),tH(e)},async updated(e){if(e[JG]){const{containerEl:t,cb:n,observer:r}=e[JG];t.clientHeight&&r&&rH(e,n)}else await en()},install:e=>{e.directive("InfiniteScroll",iH)}},aH=iH;function sH(e){let t;const n=At(!1),r=pt({...e,originalPosition:"",originalOverflow:"",visible:!1});function i(){var e,t;null==(t=null==(e=l.$el)?void 0:e.parentNode)||t.removeChild(l.$el)}function a(){if(!n.value)return;const e=r.parent;n.value=!1,e.vLoadingAddClassList=void 0,function(){const e=r.parent,t=l.ns;if(!e.vLoadingAddClassList){let n=e.getAttribute("loading-number");n=Number.parseInt(n)-1,n?e.setAttribute("loading-number",n.toString()):(qh(e,t.bm("parent","relative")),e.removeAttribute("loading-number")),qh(e,t.bm("parent","hidden"))}i(),o.unmount()}()}const s=Fn({name:"ElLoading",setup(e,{expose:t}){const{ns:n}=j_("loading"),i=Yy();return t({ns:n,zIndex:i}),()=>{const e=r.spinner||r.svg,t=ea("svg",{class:"circular",viewBox:r.svgViewBox?r.svgViewBox:"0 0 50 50",...e?{innerHTML:e}:{}},[ea("circle",{class:"path",cx:"25",cy:"25",r:"20",fill:"none"})]),i=r.text?ea("p",{class:n.b("text")},[r.text]):void 0;return ea(xa,{name:n.b("fade"),onAfterLeave:a},{default:vn((()=>[ar(Mi("div",{style:{backgroundColor:r.background||""},class:[n.b("mask"),r.customClass,r.fullscreen?"is-fullscreen":""]},[ea("div",{class:n.b("spinner")},[t,i])]),[[is,r.visible]])]))})}}}),o=cs(s),l=o.mount(document.createElement("div"));return{...Nt(r),setText:function(e){r.text=e},removeElLoadingChild:i,close:function(){var i;e.beforeClose&&!e.beforeClose()||(n.value=!0,clearTimeout(t),t=window.setTimeout(a,400),r.visible=!1,null==(i=e.closed)||i.call(e))},handleAfterLeave:a,vm:l,get $el(){return l.$el}}}let oH;const lH=function(e={}){if(!Os)return;const t=uH(e);if(t.fullscreen&&oH)return oH;const n=sH({...t,closed:()=>{var e;null==(e=t.closed)||e.call(t),t.fullscreen&&(oH=void 0)}});cH(t,t.parent,n),dH(t,t.parent,n),t.parent.vLoadingAddClassList=()=>dH(t,t.parent,n);let r=t.parent.getAttribute("loading-number");return r=r?`${Number.parseInt(r)+1}`:"1",t.parent.setAttribute("loading-number",r),t.parent.appendChild(n.$el),en((()=>n.visible.value=t.visible)),t.fullscreen&&(oH=n),n},uH=e=>{var t,n,r,i;let a;return a=D(e.target)?null!=(t=document.querySelector(e.target))?t:document.body:e.target||document.body,{parent:a===document.body||e.body?document.body:a,background:e.background||"",svg:e.svg||"",svgViewBox:e.svgViewBox||"",spinner:e.spinner||!1,text:e.text||"",fullscreen:a===document.body&&(null==(n=e.fullscreen)||n),lock:null!=(r=e.lock)&&r,customClass:e.customClass||"",visible:null==(i=e.visible)||i,target:a}},cH=async(e,t,n)=>{const{nextZIndex:r}=n.vm.zIndex,i={};if(e.fullscreen)n.originalPosition.value=Kh(document.body,"position"),n.originalOverflow.value=Kh(document.body,"overflow"),i.zIndex=r();else if(e.parent===document.body){n.originalPosition.value=Kh(document.body,"position"),await en();for(const t of["top","left"]){const n="top"===t?"scrollTop":"scrollLeft";i[t]=e.target.getBoundingClientRect()[t]+document.body[n]+document.documentElement[n]-Number.parseInt(Kh(document.body,`margin-${t}`),10)+"px"}for(const t of["height","width"])i[t]=`${e.target.getBoundingClientRect()[t]}px`}else n.originalPosition.value=Kh(t,"position");for(const[a,s]of Object.entries(i))n.$el.style[a]=s},dH=(e,t,n)=>{const r=n.vm.ns;["absolute","fixed","sticky"].includes(n.originalPosition.value)?qh(t,r.bm("parent","relative")):Xh(t,r.bm("parent","relative")),e.fullscreen&&e.lock?Xh(t,r.bm("parent","hidden")):qh(t,r.bm("parent","hidden"))},hH=Symbol("ElLoading"),pH=(e,t)=>{var n,r,i,a;const s=t.instance,o=e=>O(t.value)?t.value[e]:void 0,l=t=>(e=>{const t=D(e)&&(null==s?void 0:s[e])||e;return t?At(t):t})(o(t)||e.getAttribute(`element-loading-${X(t)}`)),u=null!=(n=o("fullscreen"))?n:t.modifiers.fullscreen,c={text:l("text"),svg:l("svg"),svgViewBox:l("svgViewBox"),spinner:l("spinner"),background:l("background"),customClass:l("customClass"),fullscreen:u,target:null!=(r=o("target"))?r:u?void 0:e,body:null!=(i=o("body"))?i:t.modifiers.body,lock:null!=(a=o("lock"))?a:t.modifiers.lock};e[hH]={options:c,instance:lH(c)}},fH={mounted(e,t){t.value&&pH(e,t)},updated(e,t){const n=e[hH];t.oldValue!==t.value&&(t.value&&!t.oldValue?pH(e,t):t.value&&t.oldValue?O(t.value)&&((e,t)=>{for(const n of Object.keys(t))Et(t[n])&&(t[n].value=e[n])})(t.value,n.options):null==n||n.instance.close())},unmounted(e){var t;null==(t=e[hH])||t.instance.close()}},mH={install(e){e.directive("loading",fH),e.config.globalProperties.$loading=lH},directive:fH,service:lH},gH=["success","info","warning","error"],vH={customClass:"",center:!1,dangerouslyUseHTMLString:!1,duration:3e3,icon:void 0,id:"",message:"",onClose:void 0,showClose:!1,type:"info",offset:16,zIndex:0,grouping:!1,repeatNum:1,appendTo:Os?document.body:void 0},yH=pg({customClass:{type:String,default:vH.customClass},center:{type:Boolean,default:vH.center},dangerouslyUseHTMLString:{type:Boolean,default:vH.dangerouslyUseHTMLString},duration:{type:Number,default:vH.duration},icon:{type:fg,default:vH.icon},id:{type:String,default:vH.id},message:{type:[String,Object,Function],default:vH.message},onClose:{type:Function,required:!1},showClose:{type:Boolean,default:vH.showClose},type:{type:String,values:gH,default:vH.type},offset:{type:Number,default:vH.offset},zIndex:{type:Number,default:vH.zIndex},grouping:{type:Boolean,default:vH.grouping},repeatNum:{type:Number,default:vH.repeatNum}}),_H=ft([]),bH=e=>{const{prev:t}=(e=>{const t=_H.findIndex((t=>t.id===e)),n=_H[t];let r;return t>0&&(r=_H[t-1]),{current:n,prev:r}})(e);return t?t.vm.exposed.bottom.value:0},xH=["id"],wH=["innerHTML"],SH=Fn({name:"ElMessage"});var CH=J_(Fn({...SH,props:yH,emits:{destroy:()=>!0},setup(e,{expose:t}){const n=e,{Close:i}=gg,{ns:a,zIndex:s}=j_("message"),{currentZIndex:o,nextZIndex:u}=s,c=At(),d=At(!1),h=At(0);let p;const m=Ki((()=>n.type?"error"===n.type?"danger":n.type:"info")),g=Ki((()=>{const e=n.type;return{[a.bm("icon",e)]:e&&vg[e]}})),v=Ki((()=>n.icon||vg[n.type]||"")),y=Ki((()=>bH(n.id))),_=Ki((()=>((e,t)=>_H.findIndex((t=>t.id===e))>0?20:t)(n.id,n.offset)+y.value)),b=Ki((()=>h.value+_.value)),x=Ki((()=>({top:`${_.value}px`,zIndex:o.value})));function w(){0!==n.duration&&({stop:p}=$s((()=>{C()}),n.duration))}function S(){null==p||p()}function C(){d.value=!1}return Kn((()=>{w(),u(),d.value=!0})),Mn((()=>n.repeatNum),(()=>{S(),w()})),Zs(document,"keydown",(function({code:e}){e===Sg.esc&&C()})),lo(c,(()=>{h.value=c.value.getBoundingClientRect().height})),t({visible:d,bottom:b,close:C}),(e,t)=>(fi(),_i(xa,{name:Dt(a).b("fade"),onBeforeLeave:e.onClose,onAfterLeave:t[0]||(t[0]=t=>e.$emit("destroy")),persisted:""},{default:vn((()=>[ar(Ti("div",{id:e.id,ref_key:"messageRef",ref:c,class:l([Dt(a).b(),{[Dt(a).m(e.type)]:e.type&&!e.icon},Dt(a).is("center",e.center),Dt(a).is("closable",e.showClose),e.customClass]),style:r(Dt(x)),role:"alert",onMouseenter:S,onMouseleave:w},[e.repeatNum>1?(fi(),_i(Dt(iS),{key:0,value:e.repeatNum,type:Dt(m),class:l(Dt(a).e("badge"))},null,8,["value","type","class"])):Li("v-if",!0),Dt(v)?(fi(),_i(Dt(ib),{key:1,class:l([Dt(a).e("icon"),Dt(g)])},{default:vn((()=>[(fi(),_i(dr(Dt(v))))])),_:1},8,["class"])):Li("v-if",!0),vr(e.$slots,"default",{},(()=>[e.dangerouslyUseHTMLString?(fi(),yi(li,{key:1},[Li(" Caution here, message could've been compromised, never use user's input as message "),Ti("p",{class:l(Dt(a).e("content")),innerHTML:e.message},null,10,wH)],2112)):(fi(),yi("p",{key:0,class:l(Dt(a).e("content"))},f(e.message),3))])),e.showClose?(fi(),_i(Dt(ib),{key:2,class:l(Dt(a).e("closeBtn")),onClick:ts(C,["stop"])},{default:vn((()=>[Mi(Dt(i))])),_:1},8,["class","onClick"])):Li("v-if",!0)],46,xH),[[is,d.value]])])),_:3},8,["name","onBeforeLeave"]))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/message/src/message.vue"]]);let TH=1;const MH=e=>{const t=!e||D(e)||bi(e)||k(e)?{message:e}:e,n={...vH,...t};if(n.appendTo){if(D(n.appendTo)){let e=document.querySelector(n.appendTo);zh(e)||(e=document.body),n.appendTo=e}}else n.appendTo=document.body;return n},EH=({appendTo:e,...t},n)=>{const r="message_"+TH++,i=t.onClose,a=document.createElement("div"),s={...t,id:r,onClose:()=>{null==i||i(),(e=>{const t=_H.indexOf(e);if(-1===t)return;_H.splice(t,1);const{handler:n}=e;n.close()})(c)},onDestroy:()=>{us(null,a)}},o=Mi(CH,s,k(s.message)||bi(s.message)?{default:k(s.message)?s.message:()=>s.message}:null);o.appContext=n||AH._context,us(o,a),e.appendChild(a.firstElementChild);const l=o.component,u={close:()=>{l.exposed.visible.value=!1}},c={id:r,vnode:o,vm:l,handler:u,props:o.component.props};return c},AH=(e={},t)=>{if(!Os)return{close:()=>{}};if(Bs(X_.max)&&_H.length>=X_.max)return{close:()=>{}};const n=MH(e);if(n.grouping&&_H.length){const e=_H.find((({vnode:e})=>{var t;return(null==(t=e.props)?void 0:t.message)===n.message}));if(e)return e.props.repeatNum+=1,e.props.type=n.type,e.handler}const r=EH(n,t);return _H.push(r),r.handler};gH.forEach((e=>{AH[e]=(t={},n)=>{const r=MH(t);return AH({...r,type:e},n)}})),AH.closeAll=function(e){for(const t of _H)e&&e!==t.props.type||t.handler.close()},AH._context=null;const PH=bg(AH,"$message"),RH=Fn({name:"ElMessageBox",directives:{TrapFocus:IC},components:{ElButton:jS,ElFocusTrap:ow,ElInput:mx,ElOverlay:_R,ElIcon:ib,...gg},inheritAttrs:!1,props:{buttonSize:{type:String,validator:Lg},modal:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},closeOnHashChange:{type:Boolean,default:!0},center:Boolean,draggable:Boolean,roundButton:{default:!1,type:Boolean},container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(e,{emit:t}){const{locale:n,zIndex:r,ns:i,size:a}=j_("message-box",Ki((()=>e.buttonSize))),{t:s}=n,{nextZIndex:o}=r,l=At(!1),u=pt({autofocus:!0,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",customClass:"",customStyle:{},dangerouslyUseHTMLString:!1,distinguishCancelAndClose:!1,icon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:null,inputValidator:null,inputErrorMessage:"",message:null,modalFade:!0,modalClass:"",showCancelButton:!1,showConfirmButton:!0,type:"",title:void 0,showInput:!1,action:"",confirmButtonLoading:!1,cancelButtonLoading:!1,confirmButtonDisabled:!1,editorErrorMessage:"",validateError:!1,zIndex:o()}),c=Ki((()=>{const e=u.type;return{[i.bm("icon",e)]:e&&vg[e]}})),d=Iy(),h=Iy(),p=Ki((()=>u.icon||vg[u.type]||"")),f=Ki((()=>!!u.message)),m=At(),g=At(),v=At(),y=At(),_=At(),b=Ki((()=>u.confirmButtonClass));Mn((()=>u.inputValue),(async t=>{await en(),"prompt"===e.boxType&&null!==t&&M()}),{immediate:!0}),Mn((()=>l.value),(t=>{var n,r;t&&("prompt"!==e.boxType&&(u.autofocus?v.value=null!=(r=null==(n=_.value)?void 0:n.$el)?r:m.value:v.value=m.value),u.zIndex=o()),"prompt"===e.boxType&&(t?en().then((()=>{var e;y.value&&y.value.$el&&(u.autofocus?v.value=null!=(e=E())?e:m.value:v.value=m.value)})):(u.editorErrorMessage="",u.validateError=!1))}));const x=Ki((()=>e.draggable));function w(){l.value&&(l.value=!1,en((()=>{u.action&&t("action",u.action)})))}$g(m,g,x),Kn((async()=>{await en(),e.closeOnHashChange&&window.addEventListener("hashchange",w)})),Qn((()=>{e.closeOnHashChange&&window.removeEventListener("hashchange",w)}));const S=()=>{e.closeOnClickModal&&T(u.distinguishCancelAndClose?"close":"cancel")},C=Py(S),T=t=>{var n;("prompt"!==e.boxType||"confirm"!==t||M())&&(u.action=t,u.beforeClose?null==(n=u.beforeClose)||n.call(u,t,u,w):w())},M=()=>{if("prompt"===e.boxType){const e=u.inputPattern;if(e&&!e.test(u.inputValue||""))return u.editorErrorMessage=u.inputErrorMessage||s("el.messagebox.error"),u.validateError=!0,!1;const t=u.inputValidator;if("function"==typeof t){const e=t(u.inputValue);if(!1===e)return u.editorErrorMessage=u.inputErrorMessage||s("el.messagebox.error"),u.validateError=!0,!1;if("string"==typeof e)return u.editorErrorMessage=e,u.validateError=!0,!1}}return u.editorErrorMessage="",u.validateError=!1,!0},E=()=>{const e=y.value.$refs;return e.input||e.textarea},A=()=>{T("close")};return e.lockScroll&&iv(l),((e,t)=>{let n;Mn((()=>e.value),(e=>{var r,i;e?(n=document.activeElement,Et(t)&&(null==(i=(r=t.value).focus)||i.call(r))):n.focus()}))})(l),{...Nt(u),ns:i,overlayEvent:C,visible:l,hasMessage:f,typeClass:c,contentId:d,inputId:h,btnSize:a,iconComponent:p,confirmButtonClasses:b,rootRef:m,focusStartRef:v,headerRef:g,inputRef:y,confirmRef:_,doClose:w,handleClose:A,onCloseRequested:()=>{e.closeOnPressEscape&&A()},handleWrapperClick:S,handleInputEnter:e=>{if("textarea"!==u.inputType)return e.preventDefault(),T("confirm")},handleAction:T,t:s}}}),LH=["aria-label","aria-describedby"],kH=["aria-label"],DH=["id"];var IH=J_(RH,[["render",function(e,t,n,i,a,s){const o=ur("el-icon"),u=ur("close"),c=ur("el-input"),d=ur("el-button"),h=ur("el-focus-trap"),p=ur("el-overlay");return fi(),_i(xa,{name:"fade-in-linear",onAfterLeave:t[11]||(t[11]=t=>e.$emit("vanish")),persisted:""},{default:vn((()=>[ar(Mi(p,{"z-index":e.zIndex,"overlay-class":[e.ns.is("message-box"),e.modalClass],mask:e.modal},{default:vn((()=>[Ti("div",{role:"dialog","aria-label":e.title,"aria-modal":"true","aria-describedby":e.showInput?void 0:e.contentId,class:l(`${e.ns.namespace.value}-overlay-message-box`),onClick:t[8]||(t[8]=(...t)=>e.overlayEvent.onClick&&e.overlayEvent.onClick(...t)),onMousedown:t[9]||(t[9]=(...t)=>e.overlayEvent.onMousedown&&e.overlayEvent.onMousedown(...t)),onMouseup:t[10]||(t[10]=(...t)=>e.overlayEvent.onMouseup&&e.overlayEvent.onMouseup(...t))},[Mi(h,{loop:"",trapped:e.visible,"focus-trap-el":e.rootRef,"focus-start-el":e.focusStartRef,onReleaseRequested:e.onCloseRequested},{default:vn((()=>[Ti("div",{ref:"rootRef",class:l([e.ns.b(),e.customClass,e.ns.is("draggable",e.draggable),{[e.ns.m("center")]:e.center}]),style:r(e.customStyle),tabindex:"-1",onClick:t[7]||(t[7]=ts((()=>{}),["stop"]))},[null!==e.title&&void 0!==e.title?(fi(),yi("div",{key:0,ref:"headerRef",class:l(e.ns.e("header"))},[Ti("div",{class:l(e.ns.e("title"))},[e.iconComponent&&e.center?(fi(),_i(o,{key:0,class:l([e.ns.e("status"),e.typeClass])},{default:vn((()=>[(fi(),_i(dr(e.iconComponent)))])),_:1},8,["class"])):Li("v-if",!0),Ti("span",null,f(e.title),1)],2),e.showClose?(fi(),yi("button",{key:0,type:"button",class:l(e.ns.e("headerbtn")),"aria-label":e.t("el.messagebox.close"),onClick:t[0]||(t[0]=t=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel")),onKeydown:t[1]||(t[1]=rs(ts((t=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel")),["prevent"]),["enter"]))},[Mi(o,{class:l(e.ns.e("close"))},{default:vn((()=>[Mi(u)])),_:1},8,["class"])],42,kH)):Li("v-if",!0)],2)):Li("v-if",!0),Ti("div",{id:e.contentId,class:l(e.ns.e("content"))},[Ti("div",{class:l(e.ns.e("container"))},[e.iconComponent&&!e.center&&e.hasMessage?(fi(),_i(o,{key:0,class:l([e.ns.e("status"),e.typeClass])},{default:vn((()=>[(fi(),_i(dr(e.iconComponent)))])),_:1},8,["class"])):Li("v-if",!0),e.hasMessage?(fi(),yi("div",{key:1,class:l(e.ns.e("message"))},[vr(e.$slots,"default",{},(()=>[e.dangerouslyUseHTMLString?(fi(),_i(dr(e.showInput?"label":"p"),{key:1,for:e.showInput?e.inputId:void 0,innerHTML:e.message},null,8,["for","innerHTML"])):(fi(),_i(dr(e.showInput?"label":"p"),{key:0,for:e.showInput?e.inputId:void 0},{default:vn((()=>[Pi(f(e.dangerouslyUseHTMLString?"":e.message),1)])),_:1},8,["for"]))]))],2)):Li("v-if",!0)],2),ar(Ti("div",{class:l(e.ns.e("input"))},[Mi(c,{id:e.inputId,ref:"inputRef",modelValue:e.inputValue,"onUpdate:modelValue":t[2]||(t[2]=t=>e.inputValue=t),type:e.inputType,placeholder:e.inputPlaceholder,"aria-invalid":e.validateError,class:l({invalid:e.validateError}),onKeydown:rs(e.handleInputEnter,["enter"])},null,8,["id","modelValue","type","placeholder","aria-invalid","class","onKeydown"]),Ti("div",{class:l(e.ns.e("errormsg")),style:r({visibility:e.editorErrorMessage?"visible":"hidden"})},f(e.editorErrorMessage),7)],2),[[is,e.showInput]])],10,DH),Ti("div",{class:l(e.ns.e("btns"))},[e.showCancelButton?(fi(),_i(d,{key:0,loading:e.cancelButtonLoading,class:l([e.cancelButtonClass]),round:e.roundButton,size:e.btnSize,onClick:t[3]||(t[3]=t=>e.handleAction("cancel")),onKeydown:t[4]||(t[4]=rs(ts((t=>e.handleAction("cancel")),["prevent"]),["enter"]))},{default:vn((()=>[Pi(f(e.cancelButtonText||e.t("el.messagebox.cancel")),1)])),_:1},8,["loading","class","round","size"])):Li("v-if",!0),ar(Mi(d,{ref:"confirmRef",type:"primary",loading:e.confirmButtonLoading,class:l([e.confirmButtonClasses]),round:e.roundButton,disabled:e.confirmButtonDisabled,size:e.btnSize,onClick:t[5]||(t[5]=t=>e.handleAction("confirm")),onKeydown:t[6]||(t[6]=rs(ts((t=>e.handleAction("confirm")),["prevent"]),["enter"]))},{default:vn((()=>[Pi(f(e.confirmButtonText||e.t("el.messagebox.confirm")),1)])),_:1},8,["loading","class","round","disabled","size"]),[[is,e.showConfirmButton]])],2)],6)])),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,LH)])),_:3},8,["z-index","overlay-class","mask"]),[[is,e.visible]])])),_:3})}],["__file","/home/runner/work/element-plus/element-plus/packages/components/message-box/src/index.vue"]]);const OH=new Map,NH=(e,t,n=null)=>{const r=Mi(IH,e,k(e.message)||bi(e.message)?{default:k(e.message)?e.message:()=>e.message}:null);return r.appContext=n,us(r,t),(e=>{let t=document.body;return e.appendTo&&(D(e.appendTo)&&(t=document.querySelector(e.appendTo)),zh(e.appendTo)&&(t=e.appendTo),zh(t)||(t=document.body)),t})(e).appendChild(t.firstElementChild),r.component},BH=(e,t)=>{const n=document.createElement("div");e.onVanish=()=>{us(null,n),OH.delete(i)},e.onAction=t=>{const n=OH.get(i);let a;a=e.showInput?{value:i.inputValue,action:t}:t,e.callback?e.callback(a,r.proxy):"cancel"===t||"close"===t?e.distinguishCancelAndClose&&"cancel"!==t?n.reject("close"):n.reject("cancel"):n.resolve(a)};const r=NH(e,n,t),i=r.proxy;for(const a in e)M(e,a)&&!M(i.$props,a)&&(i[a]=e[a]);return i.visible=!0,i};function UH(e,t=null){if(!Os)return Promise.reject();let n;return D(e)||bi(e)?e={message:e}:n=e.callback,new Promise(((r,i)=>{const a=BH(e,null!=t?t:UH._context);OH.set(a,{options:e,callback:n,resolve:r,reject:i})}))}const zH={alert:{closeOnPressEscape:!1,closeOnClickModal:!1},confirm:{showCancelButton:!0},prompt:{showCancelButton:!0,showInput:!0}};["alert","confirm","prompt"].forEach((e=>{UH[e]=function(e){return(t,n,r,i)=>{let a="";return O(n)?(r=n,a=""):a=Bh(n)?"":n,UH(Object.assign({title:a,message:t,type:"",...zH[e]},r,{boxType:e}),i)}}(e)})),UH.close=()=>{OH.forEach(((e,t)=>{t.doClose()})),OH.clear()},UH._context=null;const FH=UH;FH.install=e=>{FH._context=e._context,e.config.globalProperties.$msgbox=FH,e.config.globalProperties.$messageBox=FH,e.config.globalProperties.$alert=FH.alert,e.config.globalProperties.$confirm=FH.confirm,e.config.globalProperties.$prompt=FH.prompt};const VH=FH,GH=["success","info","warning","error"],HH=pg({customClass:{type:String,default:""},dangerouslyUseHTMLString:{type:Boolean,default:!1},duration:{type:Number,default:4500},icon:{type:fg},id:{type:String,default:""},message:{type:[String,Object],default:""},offset:{type:Number,default:0},onClick:{type:Function,default:()=>{}},onClose:{type:Function,required:!0},position:{type:String,values:["top-right","top-left","bottom-right","bottom-left"],default:"top-right"},showClose:{type:Boolean,default:!0},title:{type:String,default:""},type:{type:String,values:[...GH,""],default:""},zIndex:{type:Number,default:0}}),jH=["id"],WH=["textContent"],YH={key:0},$H=["innerHTML"],XH=Fn({name:"ElNotification"});var qH=J_(Fn({...XH,props:HH,emits:{destroy:()=>!0},setup(e,{expose:t}){const n=e,{ns:i,zIndex:a}=j_("notification"),{nextZIndex:s,currentZIndex:o}=a,{Close:u}=mg,c=At(!1);let d;const h=Ki((()=>{const e=n.type;return e&&vg[n.type]?i.m(e):""})),p=Ki((()=>n.type&&vg[n.type]||n.icon)),m=Ki((()=>n.position.endsWith("right")?"right":"left")),g=Ki((()=>n.position.startsWith("top")?"top":"bottom")),v=Ki((()=>({[g.value]:`${n.offset}px`,zIndex:o.value})));function y(){n.duration>0&&({stop:d}=$s((()=>{c.value&&b()}),n.duration))}function _(){null==d||d()}function b(){c.value=!1}return Kn((()=>{y(),s(),c.value=!0})),Zs(document,"keydown",(function({code:e}){e===Sg.delete||e===Sg.backspace?_():e===Sg.esc?c.value&&b():y()})),t({visible:c,close:b}),(e,t)=>(fi(),_i(xa,{name:Dt(i).b("fade"),onBeforeLeave:e.onClose,onAfterLeave:t[1]||(t[1]=t=>e.$emit("destroy")),persisted:""},{default:vn((()=>[ar(Ti("div",{id:e.id,class:l([Dt(i).b(),e.customClass,Dt(m)]),style:r(Dt(v)),role:"alert",onMouseenter:_,onMouseleave:y,onClick:t[0]||(t[0]=(...t)=>e.onClick&&e.onClick(...t))},[Dt(p)?(fi(),_i(Dt(ib),{key:0,class:l([Dt(i).e("icon"),Dt(h)])},{default:vn((()=>[(fi(),_i(dr(Dt(p))))])),_:1},8,["class"])):Li("v-if",!0),Ti("div",{class:l(Dt(i).e("group"))},[Ti("h2",{class:l(Dt(i).e("title")),textContent:f(e.title)},null,10,WH),ar(Ti("div",{class:l(Dt(i).e("content")),style:r(e.title?void 0:{margin:0})},[vr(e.$slots,"default",{},(()=>[e.dangerouslyUseHTMLString?(fi(),yi(li,{key:1},[Li(" Caution here, message could've been compromised, never use user's input as message "),Ti("p",{innerHTML:e.message},null,8,$H)],2112)):(fi(),yi("p",YH,f(e.message),1))]))],6),[[is,e.message]]),e.showClose?(fi(),_i(Dt(ib),{key:0,class:l(Dt(i).e("closeBtn")),onClick:ts(b,["stop"])},{default:vn((()=>[Mi(Dt(u))])),_:1},8,["class","onClick"])):Li("v-if",!0)],2)],46,jH),[[is,c.value]])])),_:3},8,["name","onBeforeLeave"]))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/notification/src/notification.vue"]]);const KH={"top-left":[],"top-right":[],"bottom-left":[],"bottom-right":[]};let ZH=1;const JH=function(e={},t=null){if(!Os)return{close:()=>{}};("string"==typeof e||bi(e))&&(e={message:e});const n=e.position||"top-right";let r=e.offset||0;KH[n].forEach((({vm:e})=>{var t;r+=((null==(t=e.el)?void 0:t.offsetHeight)||0)+16})),r+=16;const i="notification_"+ZH++,a=e.onClose,s={...e,offset:r,id:i,onClose:()=>{!function(e,t,n){const r=KH[t],i=r.findIndex((({vm:t})=>{var n;return(null==(n=t.component)?void 0:n.props.id)===e}));if(-1===i)return;const{vm:a}=r[i];if(!a)return;null==n||n(a);const s=a.el.offsetHeight,o=t.split("-")[0];r.splice(i,1);const l=r.length;if(l<1)return;for(let u=i;u<l;u++){const{el:e,component:t}=r[u].vm,n=Number.parseInt(e.style[o],10)-s-16;t.props.offset=n}}(i,n,a)}};let o=document.body;zh(e.appendTo)?o=e.appendTo:D(e.appendTo)&&(o=document.querySelector(e.appendTo)),zh(o)||(o=document.body);const l=document.createElement("div"),u=Mi(qH,s,bi(s.message)?{default:()=>s.message}:null);return u.appContext=null!=t?t:JH._context,u.props.onDestroy=()=>{us(null,l)},us(u,l),KH[n].push({vm:u}),o.appendChild(l.firstElementChild),{close:()=>{u.component.exposed.visible.value=!1}}};GH.forEach((e=>{JH[e]=(t={})=>(("string"==typeof t||bi(t))&&(t={message:t}),JH({...t,type:e}))})),JH.closeAll=function(){for(const e of Object.values(KH))e.forEach((({vm:e})=>{e.component.exposed.visible.value=!1}))},JH._context=null;const QH=bg(JH,"$notify");var ej=((e=[])=>({version:"2.3.3",install:(t,n)=>{t[Ag]||(t[Ag]=!0,e.forEach((e=>t.use(e))),n&&W_(n,t,!0))}}))([...ZG,...[aH,mH,PH,VH,QH,SI]]);const tj="undefined"!=typeof window;
/*!
  * vue-router v4.1.6
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const nj=Object.assign;function rj(e,t){const n={};for(const r in t){const i=t[r];n[r]=aj(i)?i.map(e):e(i)}return n}const ij=()=>{},aj=Array.isArray,sj=/\/$/,oj=e=>e.replace(sj,"");function lj(e,t,n="/"){let r,i={},a="",s="";const o=t.indexOf("#");let l=t.indexOf("?");return o<l&&o>=0&&(l=-1),l>-1&&(r=t.slice(0,l),a=t.slice(l+1,o>-1?o:t.length),i=e(a)),o>-1&&(r=r||t.slice(0,o),s=t.slice(o,t.length)),r=function(e,t){if(e.startsWith("/"))return e;if(!e)return t;const n=t.split("/"),r=e.split("/");let i,a,s=n.length-1;for(i=0;i<r.length;i++)if(a=r[i],"."!==a){if(".."!==a)break;s>1&&s--}return n.slice(0,s).join("/")+"/"+r.slice(i-(i===r.length?1:0)).join("/")}(null!=r?r:t,n),{fullPath:r+(a&&"?")+a+s,path:r,query:i,hash:s}}function uj(e,t){return t&&e.toLowerCase().startsWith(t.toLowerCase())?e.slice(t.length)||"/":e}function cj(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function dj(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(!hj(e[n],t[n]))return!1;return!0}function hj(e,t){return aj(e)?pj(e,t):aj(t)?pj(t,e):e===t}function pj(e,t){return aj(t)?e.length===t.length&&e.every(((e,n)=>e===t[n])):1===e.length&&e[0]===t}var fj,mj,gj,vj;(mj=fj||(fj={})).pop="pop",mj.push="push",(vj=gj||(gj={})).back="back",vj.forward="forward",vj.unknown="";const yj=/^[^#]+#/;function _j(e,t){return e.replace(yj,"#")+t}const bj=()=>({left:window.pageXOffset,top:window.pageYOffset});function xj(e){let t;if("el"in e){const n=e.el,r="string"==typeof n&&n.startsWith("#"),i="string"==typeof n?r?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!i)return;t=function(e,t){const n=document.documentElement.getBoundingClientRect(),r=e.getBoundingClientRect();return{behavior:t.behavior,left:r.left-n.left-(t.left||0),top:r.top-n.top-(t.top||0)}}(i,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(null!=t.left?t.left:window.pageXOffset,null!=t.top?t.top:window.pageYOffset)}function wj(e,t){return(history.state?history.state.position-t:-1)+e}const Sj=new Map;let Cj=()=>location.protocol+"//"+location.host;function Tj(e,t){const{pathname:n,search:r,hash:i}=t,a=e.indexOf("#");if(a>-1){let t=i.includes(e.slice(a))?e.slice(a).length:1,n=i.slice(t);return"/"!==n[0]&&(n="/"+n),uj(n,"")}return uj(n,e)+r+i}function Mj(e,t,n,r=!1,i=!1){return{back:e,current:t,forward:n,replaced:r,position:window.history.length,scroll:i?bj():null}}function Ej(e){const t=function(e){const{history:t,location:n}=window,r={value:Tj(e,n)},i={value:t.state};function a(r,a,s){const o=e.indexOf("#"),l=o>-1?(n.host&&document.querySelector("base")?e:e.slice(o))+r:Cj()+e+r;try{t[s?"replaceState":"pushState"](a,"",l),i.value=a}catch(u){console.error(u),n[s?"replace":"assign"](l)}}return i.value||a(r.value,{back:null,current:r.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0),{location:r,state:i,push:function(e,n){const s=nj({},i.value,t.state,{forward:e,scroll:bj()});a(s.current,s,!0),a(e,nj({},Mj(r.value,e,null),{position:s.position+1},n),!1),r.value=e},replace:function(e,n){a(e,nj({},t.state,Mj(i.value.back,e,i.value.forward,!0),n,{position:i.value.position}),!0),r.value=e}}}(e=function(e){if(!e)if(tj){const t=document.querySelector("base");e=(e=t&&t.getAttribute("href")||"/").replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return"/"!==e[0]&&"#"!==e[0]&&(e="/"+e),oj(e)}(e)),n=function(e,t,n,r){let i=[],a=[],s=null;const o=({state:a})=>{const o=Tj(e,location),l=n.value,u=t.value;let c=0;if(a){if(n.value=o,t.value=a,s&&s===l)return void(s=null);c=u?a.position-u.position:0}else r(o);i.forEach((e=>{e(n.value,l,{delta:c,type:fj.pop,direction:c?c>0?gj.forward:gj.back:gj.unknown})}))};function l(){const{history:e}=window;e.state&&e.replaceState(nj({},e.state,{scroll:bj()}),"")}return window.addEventListener("popstate",o),window.addEventListener("beforeunload",l),{pauseListeners:function(){s=n.value},listen:function(e){i.push(e);const t=()=>{const t=i.indexOf(e);t>-1&&i.splice(t,1)};return a.push(t),t},destroy:function(){for(const e of a)e();a=[],window.removeEventListener("popstate",o),window.removeEventListener("beforeunload",l)}}}(e,t.state,t.location,t.replace);const r=nj({location:"",base:e,go:function(e,t=!0){t||n.pauseListeners(),history.go(e)},createHref:_j.bind(null,e)},t,n);return Object.defineProperty(r,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(r,"state",{enumerable:!0,get:()=>t.state.value}),r}function Aj(e){return"string"==typeof e||"symbol"==typeof e}const Pj={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},Rj=Symbol("");var Lj,kj;function Dj(e,t){return nj(new Error,{type:e,[Rj]:!0},t)}function Ij(e,t){return e instanceof Error&&Rj in e&&(null==t||!!(e.type&t))}(kj=Lj||(Lj={}))[kj.aborted=4]="aborted",kj[kj.cancelled=8]="cancelled",kj[kj.duplicated=16]="duplicated";const Oj="[^/]+?",Nj={sensitive:!1,strict:!1,start:!0,end:!0},Bj=/[.+*?^${}()[\]/\\]/g;function Uj(e,t){let n=0;for(;n<e.length&&n<t.length;){const r=t[n]-e[n];if(r)return r;n++}return e.length<t.length?1===e.length&&80===e[0]?-1:1:e.length>t.length?1===t.length&&80===t[0]?1:-1:0}function zj(e,t){let n=0;const r=e.score,i=t.score;for(;n<r.length&&n<i.length;){const e=Uj(r[n],i[n]);if(e)return e;n++}if(1===Math.abs(i.length-r.length)){if(Fj(r))return 1;if(Fj(i))return-1}return i.length-r.length}function Fj(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const Vj={type:0,value:""},Gj=/[a-zA-Z0-9_]/;function Hj(e,t,n){const r=function(e,t){const n=nj({},Nj,t),r=[];let i=n.start?"^":"";const a=[];for(const l of e){const e=l.length?[]:[90];n.strict&&!l.length&&(i+="/");for(let t=0;t<l.length;t++){const r=l[t];let s=40+(n.sensitive?.25:0);if(0===r.type)t||(i+="/"),i+=r.value.replace(Bj,"\\$&"),s+=40;else if(1===r.type){const{value:e,repeatable:n,optional:u,regexp:c}=r;a.push({name:e,repeatable:n,optional:u});const d=c||Oj;if(d!==Oj){s+=10;try{new RegExp(`(${d})`)}catch(o){throw new Error(`Invalid custom RegExp for param "${e}" (${d}): `+o.message)}}let h=n?`((?:${d})(?:/(?:${d}))*)`:`(${d})`;t||(h=u&&l.length<2?`(?:/${h})`:"/"+h),u&&(h+="?"),i+=h,s+=20,u&&(s+=-8),n&&(s+=-20),".*"===d&&(s+=-50)}e.push(s)}r.push(e)}if(n.strict&&n.end){const e=r.length-1;r[e][r[e].length-1]+=.7000000000000001}n.strict||(i+="/?"),n.end?i+="$":n.strict&&(i+="(?:/|$)");const s=new RegExp(i,n.sensitive?"":"i");return{re:s,score:r,keys:a,parse:function(e){const t=e.match(s),n={};if(!t)return null;for(let r=1;r<t.length;r++){const e=t[r]||"",i=a[r-1];n[i.name]=e&&i.repeatable?e.split("/"):e}return n},stringify:function(t){let n="",r=!1;for(const i of e){r&&n.endsWith("/")||(n+="/"),r=!1;for(const e of i)if(0===e.type)n+=e.value;else if(1===e.type){const{value:a,repeatable:s,optional:o}=e,l=a in t?t[a]:"";if(aj(l)&&!s)throw new Error(`Provided param "${a}" is an array but it is not repeatable (* or + modifiers)`);const u=aj(l)?l.join("/"):l;if(!u){if(!o)throw new Error(`Missing required param "${a}"`);i.length<2&&(n.endsWith("/")?n=n.slice(0,-1):r=!0)}n+=u}}return n||"/"}}}(function(e){if(!e)return[[]];if("/"===e)return[[Vj]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(e){throw new Error(`ERR (${n})/"${u}": ${e}`)}let n=0,r=n;const i=[];let a;function s(){a&&i.push(a),a=[]}let o,l=0,u="",c="";function d(){u&&(0===n?a.push({type:0,value:u}):1===n||2===n||3===n?(a.length>1&&("*"===o||"+"===o)&&t(`A repeatable param (${u}) must be alone in its segment. eg: '/:ids+.`),a.push({type:1,value:u,regexp:c,repeatable:"*"===o||"+"===o,optional:"*"===o||"?"===o})):t("Invalid state to consume buffer"),u="")}function h(){u+=o}for(;l<e.length;)if(o=e[l++],"\\"!==o||2===n)switch(n){case 0:"/"===o?(u&&d(),s()):":"===o?(d(),n=1):h();break;case 4:h(),n=r;break;case 1:"("===o?n=2:Gj.test(o)?h():(d(),n=0,"*"!==o&&"?"!==o&&"+"!==o&&l--);break;case 2:")"===o?"\\"==c[c.length-1]?c=c.slice(0,-1)+o:n=3:c+=o;break;case 3:d(),n=0,"*"!==o&&"?"!==o&&"+"!==o&&l--,c="";break;default:t("Unknown state")}else r=n,n=4;return 2===n&&t(`Unfinished custom RegExp for param "${u}"`),d(),s(),i}(e.path),n),i=nj(r,{record:e,parent:t,children:[],alias:[]});return t&&!i.record.aliasOf==!t.record.aliasOf&&t.children.push(i),i}function jj(e,t){const n=[],r=new Map;function i(e,n,r){const o=!r,l=function(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:Yj(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}}}(e);l.aliasOf=r&&r.record;const u=qj(t,e),c=[l];if("alias"in e){const t="string"==typeof e.alias?[e.alias]:e.alias;for(const e of t)c.push(nj({},l,{components:r?r.record.components:l.components,path:e,aliasOf:r?r.record:l}))}let d,h;for(const t of c){const{path:c}=t;if(n&&"/"!==c[0]){const e=n.record.path,r="/"===e[e.length-1]?"":"/";t.path=n.record.path+(c&&r+c)}if(d=Hj(t,n,u),r?r.alias.push(d):(h=h||d,h!==d&&h.alias.push(d),o&&e.name&&!$j(d)&&a(e.name)),l.children){const e=l.children;for(let t=0;t<e.length;t++)i(e[t],d,r&&r.children[t])}r=r||d,(d.record.components&&Object.keys(d.record.components).length||d.record.name||d.record.redirect)&&s(d)}return h?()=>{a(h)}:ij}function a(e){if(Aj(e)){const t=r.get(e);t&&(r.delete(e),n.splice(n.indexOf(t),1),t.children.forEach(a),t.alias.forEach(a))}else{const t=n.indexOf(e);t>-1&&(n.splice(t,1),e.record.name&&r.delete(e.record.name),e.children.forEach(a),e.alias.forEach(a))}}function s(e){let t=0;for(;t<n.length&&zj(e,n[t])>=0&&(e.record.path!==n[t].record.path||!Kj(e,n[t]));)t++;n.splice(t,0,e),e.record.name&&!$j(e)&&r.set(e.record.name,e)}return t=qj({strict:!1,end:!0,sensitive:!1},t),e.forEach((e=>i(e))),{addRoute:i,resolve:function(e,t){let i,a,s,o={};if("name"in e&&e.name){if(i=r.get(e.name),!i)throw Dj(1,{location:e});s=i.record.name,o=nj(Wj(t.params,i.keys.filter((e=>!e.optional)).map((e=>e.name))),e.params&&Wj(e.params,i.keys.map((e=>e.name)))),a=i.stringify(o)}else if("path"in e)a=e.path,i=n.find((e=>e.re.test(a))),i&&(o=i.parse(a),s=i.record.name);else{if(i=t.name?r.get(t.name):n.find((e=>e.re.test(t.path))),!i)throw Dj(1,{location:e,currentLocation:t});s=i.record.name,o=nj({},t.params,e.params),a=i.stringify(o)}const l=[];let u=i;for(;u;)l.unshift(u.record),u=u.parent;return{name:s,path:a,params:o,matched:l,meta:Xj(l)}},removeRoute:a,getRoutes:function(){return n},getRecordMatcher:function(e){return r.get(e)}}}function Wj(e,t){const n={};for(const r of t)r in e&&(n[r]=e[r]);return n}function Yj(e){const t={},n=e.props||!1;if("component"in e)t.default=n;else for(const r in e.components)t[r]="boolean"==typeof n?n:n[r];return t}function $j(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function Xj(e){return e.reduce(((e,t)=>nj(e,t.meta)),{})}function qj(e,t){const n={};for(const r in e)n[r]=r in t?t[r]:e[r];return n}function Kj(e,t){return t.children.some((t=>t===e||Kj(e,t)))}const Zj=/#/g,Jj=/&/g,Qj=/\//g,eW=/=/g,tW=/\?/g,nW=/\+/g,rW=/%5B/g,iW=/%5D/g,aW=/%5E/g,sW=/%60/g,oW=/%7B/g,lW=/%7C/g,uW=/%7D/g,cW=/%20/g;function dW(e){return encodeURI(""+e).replace(lW,"|").replace(rW,"[").replace(iW,"]")}function hW(e){return dW(e).replace(nW,"%2B").replace(cW,"+").replace(Zj,"%23").replace(Jj,"%26").replace(sW,"`").replace(oW,"{").replace(uW,"}").replace(aW,"^")}function pW(e){return null==e?"":function(e){return dW(e).replace(Zj,"%23").replace(tW,"%3F")}(e).replace(Qj,"%2F")}function fW(e){try{return decodeURIComponent(""+e)}catch(t){}return""+e}function mW(e){const t={};if(""===e||"?"===e)return t;const n=("?"===e[0]?e.slice(1):e).split("&");for(let r=0;r<n.length;++r){const e=n[r].replace(nW," "),i=e.indexOf("="),a=fW(i<0?e:e.slice(0,i)),s=i<0?null:fW(e.slice(i+1));if(a in t){let e=t[a];aj(e)||(e=t[a]=[e]),e.push(s)}else t[a]=s}return t}function gW(e){let t="";for(let n in e){const r=e[n];if(n=hW(n).replace(eW,"%3D"),null==r){void 0!==r&&(t+=(t.length?"&":"")+n);continue}(aj(r)?r.map((e=>e&&hW(e))):[r&&hW(r)]).forEach((e=>{void 0!==e&&(t+=(t.length?"&":"")+n,null!=e&&(t+="="+e))}))}return t}function vW(e){const t={};for(const n in e){const r=e[n];void 0!==r&&(t[n]=aj(r)?r.map((e=>null==e?null:""+e)):null==r?r:""+r)}return t}const yW=Symbol(""),_W=Symbol(""),bW=Symbol(""),xW=Symbol(""),wW=Symbol("");function SW(){let e=[];return{add:function(t){return e.push(t),()=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)}},list:()=>e,reset:function(){e=[]}}}function CW(e,t,n,r,i){const a=r&&(r.enterCallbacks[i]=r.enterCallbacks[i]||[]);return()=>new Promise(((s,o)=>{const l=e=>{var l;!1===e?o(Dj(4,{from:n,to:t})):e instanceof Error?o(e):"string"==typeof(l=e)||l&&"object"==typeof l?o(Dj(2,{from:t,to:e})):(a&&r.enterCallbacks[i]===a&&"function"==typeof e&&a.push(e),s())},u=e.call(r&&r.instances[i],t,n,l);let c=Promise.resolve(u);e.length<3&&(c=c.then(l)),c.catch((e=>o(e)))}))}function TW(e,t,n,r){const i=[];for(const s of e)for(const e in s.components){let o=s.components[e];if("beforeRouteEnter"===t||s.instances[e])if("object"==typeof(a=o)||"displayName"in a||"props"in a||"__vccOpts"in a){const a=(o.__vccOpts||o)[t];a&&i.push(CW(a,n,r,s,e))}else{let a=o();i.push((()=>a.then((i=>{if(!i)return Promise.reject(new Error(`Couldn't resolve component "${e}" at "${s.path}"`));const a=(o=i).__esModule||"Module"===o[Symbol.toStringTag]?i.default:i;var o;s.components[e]=a;const l=(a.__vccOpts||a)[t];return l&&CW(l,n,r,s,e)()}))))}}var a;return i}function MW(e){const t=Sn(bW),n=Sn(xW),r=Ki((()=>t.resolve(Dt(e.to)))),i=Ki((()=>{const{matched:e}=r.value,{length:t}=e,i=e[t-1],a=n.matched;if(!i||!a.length)return-1;const s=a.findIndex(cj.bind(null,i));if(s>-1)return s;const o=AW(e[t-2]);return t>1&&AW(i)===o&&a[a.length-1].path!==o?a.findIndex(cj.bind(null,e[t-2])):s})),a=Ki((()=>i.value>-1&&function(e,t){for(const n in t){const r=t[n],i=e[n];if("string"==typeof r){if(r!==i)return!1}else if(!aj(i)||i.length!==r.length||r.some(((e,t)=>e!==i[t])))return!1}return!0}(n.params,r.value.params))),s=Ki((()=>i.value>-1&&i.value===n.matched.length-1&&dj(n.params,r.value.params)));return{route:r,href:Ki((()=>r.value.href)),isActive:a,isExactActive:s,navigate:function(n={}){return function(e){if(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)return;if(e.defaultPrevented)return;if(void 0!==e.button&&0!==e.button)return;if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}e.preventDefault&&e.preventDefault();return!0}(n)?t[Dt(e.replace)?"replace":"push"](Dt(e.to)).catch(ij):Promise.resolve()}}}const EW=Fn({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:MW,setup(e,{slots:t}){const n=pt(MW(e)),{options:r}=Sn(bW),i=Ki((()=>({[PW(e.activeClass,r.linkActiveClass,"router-link-active")]:n.isActive,[PW(e.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive})));return()=>{const r=t.default&&t.default(n);return e.custom?r:ea("a",{"aria-current":n.isExactActive?e.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:i.value},r)}}});function AW(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const PW=(e,t,n)=>null!=e?e:null!=t?t:n,RW=Fn({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:n}){const r=Sn(wW),i=Ki((()=>e.route||r.value)),a=Sn(_W,0),s=Ki((()=>{let e=Dt(a);const{matched:t}=i.value;let n;for(;(n=t[e])&&!n.components;)e++;return e})),o=Ki((()=>i.value.matched[s.value]));wn(_W,Ki((()=>s.value+1))),wn(yW,o),wn(wW,i);const l=At();return Mn((()=>[l.value,o.value,e.name]),(([e,t,n],[r,i,a])=>{t&&(t.instances[n]=e,i&&i!==t&&e&&e===r&&(t.leaveGuards.size||(t.leaveGuards=i.leaveGuards),t.updateGuards.size||(t.updateGuards=i.updateGuards))),!e||!t||i&&cj(t,i)&&r||(t.enterCallbacks[n]||[]).forEach((t=>t(e)))}),{flush:"post"}),()=>{const r=i.value,a=e.name,s=o.value,u=s&&s.components[a];if(!u)return LW(n.default,{Component:u,route:r});const c=s.props[a],d=c?!0===c?r.params:"function"==typeof c?c(r):c:null,h=ea(u,nj({},d,t,{onVnodeUnmounted:e=>{e.component.isUnmounted&&(s.instances[a]=null)},ref:l}));return LW(n.default,{Component:h,route:r})||h}}});function LW(e,t){if(!e)return null;const n=e(t);return 1===n.length?n[0]:n}const kW=RW;function DW(e){return e.reduce(((e,t)=>e.then((()=>t()))),Promise.resolve())}
/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */
const IW="153",OW=0,NW=1,BW=2,UW=0,zW=1,FW=2,VW=3,GW=1,HW=2,jW=3,WW=0,YW=1,$W=100,XW=0,qW=1,KW=2,ZW=0,JW=1,QW=2,eY=3,tY=4,nY=5,rY=301,iY=302,aY=306,sY=1e3,oY=1001,lY=1002,uY=1003,cY=1004,dY=1005,hY=1006,pY=1008,fY=1009,mY=1012,gY=1013,vY=1014,yY=1015,_Y=1016,bY=1020,xY=1023,wY=1026,SY=1027,CY=33776,TY=33777,MY=33778,EY=33779,AY=36492,PY=2300,RY=2301,LY=2302,kY=2400,DY=2401,IY=2402,OY=2500,NY=3001,BY="",UY="srgb",zY="srgb-linear",FY="display-p3",VY=7680,GY=35044,HY="300 es",jY=1035,WY=2e3,YY=2001;class $Y{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const n=this._listeners[e];if(void 0!==n){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const t=this._listeners[e.type];if(void 0!==t){e.target=this;const n=t.slice(0);for(let t=0,r=n.length;t<r;t++)n[t].call(this,e);e.target=null}}}const XY=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let qY=1234567;const KY=Math.PI/180,ZY=180/Math.PI;function JY(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(XY[255&e]+XY[e>>8&255]+XY[e>>16&255]+XY[e>>24&255]+"-"+XY[255&t]+XY[t>>8&255]+"-"+XY[t>>16&15|64]+XY[t>>24&255]+"-"+XY[63&n|128]+XY[n>>8&255]+"-"+XY[n>>16&255]+XY[n>>24&255]+XY[255&r]+XY[r>>8&255]+XY[r>>16&255]+XY[r>>24&255]).toLowerCase()}function QY(e,t,n){return Math.max(t,Math.min(n,e))}function e$(e,t){return(e%t+t)%t}function t$(e,t,n){return(1-n)*e+n*t}function n$(e){return 0==(e&e-1)&&0!==e}function r$(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function i$(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}function a$(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/4294967295;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/2147483647,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function s$(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(4294967295*e);case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int32Array:return Math.round(2147483647*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}}const o$={DEG2RAD:KY,RAD2DEG:ZY,generateUUID:JY,clamp:QY,euclideanModulo:e$,mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},inverseLerp:function(e,t,n){return e!==t?(n-e)/(t-e):0},lerp:t$,damp:function(e,t,n,r){return t$(e,t,1-Math.exp(-n*r))},pingpong:function(e,t=1){return t-Math.abs(e$(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){void 0!==e&&(qY=e);let t=qY+=1831565813;return t=Math.imul(t^t>>>15,1|t),t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/4294967296},degToRad:function(e){return e*KY},radToDeg:function(e){return e*ZY},isPowerOfTwo:n$,ceilPowerOfTwo:r$,floorPowerOfTwo:i$,setQuaternionFromProperEuler:function(e,t,n,r,i){const a=Math.cos,s=Math.sin,o=a(n/2),l=s(n/2),u=a((t+r)/2),c=s((t+r)/2),d=a((t-r)/2),h=s((t-r)/2),p=a((r-t)/2),f=s((r-t)/2);switch(i){case"XYX":e.set(o*c,l*d,l*h,o*u);break;case"YZY":e.set(l*h,o*c,l*d,o*u);break;case"ZXZ":e.set(l*d,l*h,o*c,o*u);break;case"XZX":e.set(o*c,l*f,l*p,o*u);break;case"YXY":e.set(l*p,o*c,l*f,o*u);break;case"ZYZ":e.set(l*f,l*p,o*c,o*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}},normalize:s$,denormalize:a$};class l${constructor(e=0,t=0){l$.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(QY(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,a=this.y-e.y;return this.x=i*n-a*r+e.x,this.y=i*r+a*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class u${constructor(e,t,n,r,i,a,s,o,l){u$.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,n,r,i,a,s,o,l)}set(e,t,n,r,i,a,s,o,l){const u=this.elements;return u[0]=e,u[1]=r,u[2]=s,u[3]=t,u[4]=i,u[5]=o,u[6]=n,u[7]=a,u[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,a=n[0],s=n[3],o=n[6],l=n[1],u=n[4],c=n[7],d=n[2],h=n[5],p=n[8],f=r[0],m=r[3],g=r[6],v=r[1],y=r[4],_=r[7],b=r[2],x=r[5],w=r[8];return i[0]=a*f+s*v+o*b,i[3]=a*m+s*y+o*x,i[6]=a*g+s*_+o*w,i[1]=l*f+u*v+c*b,i[4]=l*m+u*y+c*x,i[7]=l*g+u*_+c*w,i[2]=d*f+h*v+p*b,i[5]=d*m+h*y+p*x,i[8]=d*g+h*_+p*w,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],s=e[5],o=e[6],l=e[7],u=e[8];return t*a*u-t*s*l-n*i*u+n*s*o+r*i*l-r*a*o}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],s=e[5],o=e[6],l=e[7],u=e[8],c=u*a-s*l,d=s*o-u*i,h=l*i-a*o,p=t*c+n*d+r*h;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const f=1/p;return e[0]=c*f,e[1]=(r*l-u*n)*f,e[2]=(s*n-r*a)*f,e[3]=d*f,e[4]=(u*t-r*o)*f,e[5]=(r*i-s*t)*f,e[6]=h*f,e[7]=(n*o-l*t)*f,e[8]=(a*t-n*i)*f,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,i,a,s){const o=Math.cos(i),l=Math.sin(i);return this.set(n*o,n*l,-n*(o*a+l*s)+a+e,-r*l,r*o,-r*(-l*a+o*s)+s+t,0,0,1),this}scale(e,t){return this.premultiply(c$.makeScale(e,t)),this}rotate(e){return this.premultiply(c$.makeRotation(-e)),this}translate(e,t){return this.premultiply(c$.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const c$=new u$;function d$(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}function h$(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}const p$={};function f$(e){e in p$||(p$[e]=!0,console.warn(e))}function m$(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function g$(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}const v$=(new u$).fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),y$=(new u$).fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]);const _$={[zY]:e=>e,[UY]:e=>e.convertSRGBToLinear(),[FY]:function(e){return e.convertSRGBToLinear().applyMatrix3(y$)}},b$={[zY]:e=>e,[UY]:e=>e.convertLinearToSRGB(),[FY]:function(e){return e.applyMatrix3(v$).convertLinearToSRGB()}},x$={enabled:!0,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(e){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!e},get workingColorSpace(){return zY},set workingColorSpace(e){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(e,t,n){if(!1===this.enabled||t===n||!t||!n)return e;const r=_$[t],i=b$[n];if(void 0===r||void 0===i)throw new Error(`Unsupported color space conversion, "${t}" to "${n}".`);return i(r(e))},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)}};let w$;class S${static getDataURL(e){if(/^data:/i.test(e.src))return e.src;if("undefined"==typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===w$&&(w$=h$("canvas")),w$.width=e.width,w$.height=e.height;const n=w$.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=w$}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const t=h$("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),i=r.data;for(let e=0;e<i.length;e++)i[e]=255*m$(i[e]/255);return n.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*m$(t[e]/255)):t[e]=m$(t[e]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let C$=0;class T${constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:C$++}),this.uuid=JY(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(null!==r){let e;if(Array.isArray(r)){e=[];for(let t=0,n=r.length;t<n;t++)r[t].isDataTexture?e.push(M$(r[t].image)):e.push(M$(r[t]))}else e=M$(r);n.url=e}return t||(e.images[this.uuid]=n),n}}function M$(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?S$.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let E$=0;class A$ extends $Y{constructor(e=A$.DEFAULT_IMAGE,t=A$.DEFAULT_MAPPING,n=1001,r=1001,i=1006,a=1008,s=1023,o=1009,l=A$.DEFAULT_ANISOTROPY,u=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:E$++}),this.uuid=JY(),this.name="",this.source=new T$(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=i,this.minFilter=a,this.anisotropy=l,this.format=s,this.internalFormat=null,this.type=o,this.offset=new l$(0,0),this.repeat=new l$(1,1),this.center=new l$(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new u$,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,"string"==typeof u?this.colorSpace=u:(f$("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=u===NY?UY:BY),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case sY:e.x=e.x-Math.floor(e.x);break;case oY:e.x=e.x<0?0:1;break;case lY:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case sY:e.y=e.y-Math.floor(e.y);break;case oY:e.y=e.y<0?0:1;break;case lY:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return f$("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===UY?NY:3e3}set encoding(e){f$("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===NY?UY:BY}}A$.DEFAULT_IMAGE=null,A$.DEFAULT_MAPPING=300,A$.DEFAULT_ANISOTROPY=1;class P${constructor(e=0,t=0,n=0,r=1){P$.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r+a[12]*i,this.y=a[1]*t+a[5]*n+a[9]*r+a[13]*i,this.z=a[2]*t+a[6]*n+a[10]*r+a[14]*i,this.w=a[3]*t+a[7]*n+a[11]*r+a[15]*i,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,i;const a=.01,s=.1,o=e.elements,l=o[0],u=o[4],c=o[8],d=o[1],h=o[5],p=o[9],f=o[2],m=o[6],g=o[10];if(Math.abs(u-d)<a&&Math.abs(c-f)<a&&Math.abs(p-m)<a){if(Math.abs(u+d)<s&&Math.abs(c+f)<s&&Math.abs(p+m)<s&&Math.abs(l+h+g-3)<s)return this.set(1,0,0,0),this;t=Math.PI;const e=(l+1)/2,o=(h+1)/2,v=(g+1)/2,y=(u+d)/4,_=(c+f)/4,b=(p+m)/4;return e>o&&e>v?e<a?(n=0,r=.707106781,i=.707106781):(n=Math.sqrt(e),r=y/n,i=_/n):o>v?o<a?(n=.707106781,r=0,i=.707106781):(r=Math.sqrt(o),n=y/r,i=b/r):v<a?(n=.707106781,r=.707106781,i=0):(i=Math.sqrt(v),n=_/i,r=b/i),this.set(n,r,i,t),this}let v=Math.sqrt((m-p)*(m-p)+(c-f)*(c-f)+(d-u)*(d-u));return Math.abs(v)<.001&&(v=1),this.x=(m-p)/v,this.y=(c-f)/v,this.z=(d-u)/v,this.w=Math.acos((l+h+g-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class R$ extends $Y{constructor(e=1,t=1,n={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new P$(0,0,e,t),this.scissorTest=!1,this.viewport=new P$(0,0,e,t);const r={width:e,height:t,depth:1};void 0!==n.encoding&&(f$("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),n.colorSpace=n.encoding===NY?UY:BY),this.texture=new A$(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.internalFormat=void 0!==n.internalFormat?n.internalFormat:null,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:hY,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null,this.samples=void 0!==n.samples?n.samples:0}setSize(e,t,n=1){this.width===e&&this.height===t&&this.depth===n||(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new T$(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class L$ extends A${constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=uY,this.minFilter=uY,this.wrapR=oY,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class k$ extends A${constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=uY,this.minFilter=uY,this.wrapR=oY,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class D${constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,i,a,s){let o=n[r+0],l=n[r+1],u=n[r+2],c=n[r+3];const d=i[a+0],h=i[a+1],p=i[a+2],f=i[a+3];if(0===s)return e[t+0]=o,e[t+1]=l,e[t+2]=u,void(e[t+3]=c);if(1===s)return e[t+0]=d,e[t+1]=h,e[t+2]=p,void(e[t+3]=f);if(c!==f||o!==d||l!==h||u!==p){let e=1-s;const t=o*d+l*h+u*p+c*f,n=t>=0?1:-1,r=1-t*t;if(r>Number.EPSILON){const i=Math.sqrt(r),a=Math.atan2(i,t*n);e=Math.sin(e*a)/i,s=Math.sin(s*a)/i}const i=s*n;if(o=o*e+d*i,l=l*e+h*i,u=u*e+p*i,c=c*e+f*i,e===1-s){const e=1/Math.sqrt(o*o+l*l+u*u+c*c);o*=e,l*=e,u*=e,c*=e}}e[t]=o,e[t+1]=l,e[t+2]=u,e[t+3]=c}static multiplyQuaternionsFlat(e,t,n,r,i,a){const s=n[r],o=n[r+1],l=n[r+2],u=n[r+3],c=i[a],d=i[a+1],h=i[a+2],p=i[a+3];return e[t]=s*p+u*c+o*h-l*d,e[t+1]=o*p+u*d+l*c-s*h,e[t+2]=l*p+u*h+s*d-o*c,e[t+3]=u*p-s*c-o*d-l*h,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const n=e._x,r=e._y,i=e._z,a=e._order,s=Math.cos,o=Math.sin,l=s(n/2),u=s(r/2),c=s(i/2),d=o(n/2),h=o(r/2),p=o(i/2);switch(a){case"XYZ":this._x=d*u*c+l*h*p,this._y=l*h*c-d*u*p,this._z=l*u*p+d*h*c,this._w=l*u*c-d*h*p;break;case"YXZ":this._x=d*u*c+l*h*p,this._y=l*h*c-d*u*p,this._z=l*u*p-d*h*c,this._w=l*u*c+d*h*p;break;case"ZXY":this._x=d*u*c-l*h*p,this._y=l*h*c+d*u*p,this._z=l*u*p+d*h*c,this._w=l*u*c-d*h*p;break;case"ZYX":this._x=d*u*c-l*h*p,this._y=l*h*c+d*u*p,this._z=l*u*p-d*h*c,this._w=l*u*c+d*h*p;break;case"YZX":this._x=d*u*c+l*h*p,this._y=l*h*c+d*u*p,this._z=l*u*p-d*h*c,this._w=l*u*c-d*h*p;break;case"XZY":this._x=d*u*c-l*h*p,this._y=l*h*c-d*u*p,this._z=l*u*p+d*h*c,this._w=l*u*c+d*h*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],i=t[8],a=t[1],s=t[5],o=t[9],l=t[2],u=t[6],c=t[10],d=n+s+c;if(d>0){const e=.5/Math.sqrt(d+1);this._w=.25/e,this._x=(u-o)*e,this._y=(i-l)*e,this._z=(a-r)*e}else if(n>s&&n>c){const e=2*Math.sqrt(1+n-s-c);this._w=(u-o)/e,this._x=.25*e,this._y=(r+a)/e,this._z=(i+l)/e}else if(s>c){const e=2*Math.sqrt(1+s-n-c);this._w=(i-l)/e,this._x=(r+a)/e,this._y=.25*e,this._z=(o+u)/e}else{const e=2*Math.sqrt(1+c-n-s);this._w=(a-r)/e,this._x=(i+l)/e,this._y=(o+u)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(QY(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,i=e._z,a=e._w,s=t._x,o=t._y,l=t._z,u=t._w;return this._x=n*u+a*s+r*l-i*o,this._y=r*u+a*o+i*s-n*l,this._z=i*u+a*l+n*o-r*s,this._w=a*u-n*s-r*o-i*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,r=this._y,i=this._z,a=this._w;let s=a*e._w+n*e._x+r*e._y+i*e._z;if(s<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,s=-s):this.copy(e),s>=1)return this._w=a,this._x=n,this._y=r,this._z=i,this;const o=1-s*s;if(o<=Number.EPSILON){const e=1-t;return this._w=e*a+t*this._w,this._x=e*n+t*this._x,this._y=e*r+t*this._y,this._z=e*i+t*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(o),u=Math.atan2(l,s),c=Math.sin((1-t)*u)/l,d=Math.sin(t*u)/l;return this._w=a*c+this._w*d,this._x=n*c+this._x*d,this._y=r*c+this._y*d,this._z=i*c+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),r=2*Math.PI*Math.random(),i=2*Math.PI*Math.random();return this.set(t*Math.cos(r),n*Math.sin(i),n*Math.cos(i),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class I${constructor(e=0,t=0,n=0){I$.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(N$.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(N$.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=e.elements,a=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*a,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*a,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*a,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,i=e.x,a=e.y,s=e.z,o=e.w,l=o*t+a*r-s*n,u=o*n+s*t-i*r,c=o*r+i*n-a*t,d=-i*t-a*n-s*r;return this.x=l*o+d*-i+u*-s-c*-a,this.y=u*o+d*-a+c*-i-l*-s,this.z=c*o+d*-s+l*-a-u*-i,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,i=e.z,a=t.x,s=t.y,o=t.z;return this.x=r*o-i*s,this.y=i*a-n*o,this.z=n*s-r*a,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return O$.copy(this).projectOnVector(e),this.sub(O$)}reflect(e){return this.sub(O$.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(QY(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const O$=new I$,N$=new D$;class B${constructor(e=new I$(1/0,1/0,1/0),t=new I$(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(z$.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(z$.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=z$.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){if(e.updateWorldMatrix(!1,!1),void 0!==e.boundingBox)null===e.boundingBox&&e.computeBoundingBox(),F$.copy(e.boundingBox),F$.applyMatrix4(e.matrixWorld),this.union(F$);else{const n=e.geometry;if(void 0!==n)if(t&&void 0!==n.attributes&&void 0!==n.attributes.position){const t=n.attributes.position;for(let n=0,r=t.count;n<r;n++)z$.fromBufferAttribute(t,n).applyMatrix4(e.matrixWorld),this.expandByPoint(z$)}else null===n.boundingBox&&n.computeBoundingBox(),F$.copy(n.boundingBox),F$.applyMatrix4(e.matrixWorld),this.union(F$)}const n=e.children;for(let r=0,i=n.length;r<i;r++)this.expandByObject(n[r],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,z$),z$.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter($$),X$.subVectors(this.max,$$),V$.subVectors(e.a,$$),G$.subVectors(e.b,$$),H$.subVectors(e.c,$$),j$.subVectors(G$,V$),W$.subVectors(H$,G$),Y$.subVectors(V$,H$);let t=[0,-j$.z,j$.y,0,-W$.z,W$.y,0,-Y$.z,Y$.y,j$.z,0,-j$.x,W$.z,0,-W$.x,Y$.z,0,-Y$.x,-j$.y,j$.x,0,-W$.y,W$.x,0,-Y$.y,Y$.x,0];return!!Z$(t,V$,G$,H$,X$)&&(t=[1,0,0,0,1,0,0,0,1],!!Z$(t,V$,G$,H$,X$)&&(q$.crossVectors(j$,W$),t=[q$.x,q$.y,q$.z],Z$(t,V$,G$,H$,X$)))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,z$).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(z$).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(U$[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),U$[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),U$[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),U$[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),U$[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),U$[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),U$[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),U$[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(U$)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const U$=[new I$,new I$,new I$,new I$,new I$,new I$,new I$,new I$],z$=new I$,F$=new B$,V$=new I$,G$=new I$,H$=new I$,j$=new I$,W$=new I$,Y$=new I$,$$=new I$,X$=new I$,q$=new I$,K$=new I$;function Z$(e,t,n,r,i){for(let a=0,s=e.length-3;a<=s;a+=3){K$.fromArray(e,a);const s=i.x*Math.abs(K$.x)+i.y*Math.abs(K$.y)+i.z*Math.abs(K$.z),o=t.dot(K$),l=n.dot(K$),u=r.dot(K$);if(Math.max(-Math.max(o,l,u),Math.min(o,l,u))>s)return!1}return!0}const J$=new B$,Q$=new I$,eX=new I$;class tX{constructor(e=new I$,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):J$.setFromPoints(e).getCenter(n);let r=0;for(let i=0,a=e.length;i<a;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Q$.subVectors(e,this.center);const t=Q$.lengthSq();if(t>this.radius*this.radius){const e=Math.sqrt(t),n=.5*(e-this.radius);this.center.addScaledVector(Q$,n/e),this.radius+=n}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(eX.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Q$.copy(e.center).add(eX)),this.expandByPoint(Q$.copy(e.center).sub(eX))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const nX=new I$,rX=new I$,iX=new I$,aX=new I$,sX=new I$,oX=new I$,lX=new I$;class uX{constructor(e=new I$,t=new I$(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,nX)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=nX.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(nX.copy(this.origin).addScaledVector(this.direction,t),nX.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){rX.copy(e).add(t).multiplyScalar(.5),iX.copy(t).sub(e).normalize(),aX.copy(this.origin).sub(rX);const i=.5*e.distanceTo(t),a=-this.direction.dot(iX),s=aX.dot(this.direction),o=-aX.dot(iX),l=aX.lengthSq(),u=Math.abs(1-a*a);let c,d,h,p;if(u>0)if(c=a*o-s,d=a*s-o,p=i*u,c>=0)if(d>=-p)if(d<=p){const e=1/u;c*=e,d*=e,h=c*(c+a*d+2*s)+d*(a*c+d+2*o)+l}else d=i,c=Math.max(0,-(a*d+s)),h=-c*c+d*(d+2*o)+l;else d=-i,c=Math.max(0,-(a*d+s)),h=-c*c+d*(d+2*o)+l;else d<=-p?(c=Math.max(0,-(-a*i+s)),d=c>0?-i:Math.min(Math.max(-i,-o),i),h=-c*c+d*(d+2*o)+l):d<=p?(c=0,d=Math.min(Math.max(-i,-o),i),h=d*(d+2*o)+l):(c=Math.max(0,-(a*i+s)),d=c>0?i:Math.min(Math.max(-i,-o),i),h=-c*c+d*(d+2*o)+l);else d=a>0?-i:i,c=Math.max(0,-(a*d+s)),h=-c*c+d*(d+2*o)+l;return n&&n.copy(this.origin).addScaledVector(this.direction,c),r&&r.copy(rX).addScaledVector(iX,d),h}intersectSphere(e,t){nX.subVectors(e.center,this.origin);const n=nX.dot(this.direction),r=nX.dot(nX)-n*n,i=e.radius*e.radius;if(r>i)return null;const a=Math.sqrt(i-r),s=n-a,o=n+a;return o<0?null:s<0?this.at(o,t):this.at(s,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);if(0===t)return!0;return e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,i,a,s,o;const l=1/this.direction.x,u=1/this.direction.y,c=1/this.direction.z,d=this.origin;return l>=0?(n=(e.min.x-d.x)*l,r=(e.max.x-d.x)*l):(n=(e.max.x-d.x)*l,r=(e.min.x-d.x)*l),u>=0?(i=(e.min.y-d.y)*u,a=(e.max.y-d.y)*u):(i=(e.max.y-d.y)*u,a=(e.min.y-d.y)*u),n>a||i>r?null:((i>n||isNaN(n))&&(n=i),(a<r||isNaN(r))&&(r=a),c>=0?(s=(e.min.z-d.z)*c,o=(e.max.z-d.z)*c):(s=(e.max.z-d.z)*c,o=(e.min.z-d.z)*c),n>o||s>r?null:((s>n||n!=n)&&(n=s),(o<r||r!=r)&&(r=o),r<0?null:this.at(n>=0?n:r,t)))}intersectsBox(e){return null!==this.intersectBox(e,nX)}intersectTriangle(e,t,n,r,i){sX.subVectors(t,e),oX.subVectors(n,e),lX.crossVectors(sX,oX);let a,s=this.direction.dot(lX);if(s>0){if(r)return null;a=1}else{if(!(s<0))return null;a=-1,s=-s}aX.subVectors(this.origin,e);const o=a*this.direction.dot(oX.crossVectors(aX,oX));if(o<0)return null;const l=a*this.direction.dot(sX.cross(aX));if(l<0)return null;if(o+l>s)return null;const u=-a*aX.dot(lX);return u<0?null:this.at(u/s,i)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class cX{constructor(e,t,n,r,i,a,s,o,l,u,c,d,h,p,f,m){cX.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,n,r,i,a,s,o,l,u,c,d,h,p,f,m)}set(e,t,n,r,i,a,s,o,l,u,c,d,h,p,f,m){const g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=r,g[1]=i,g[5]=a,g[9]=s,g[13]=o,g[2]=l,g[6]=u,g[10]=c,g[14]=d,g[3]=h,g[7]=p,g[11]=f,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new cX).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/dX.setFromMatrixColumn(e,0).length(),i=1/dX.setFromMatrixColumn(e,1).length(),a=1/dX.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,i=e.z,a=Math.cos(n),s=Math.sin(n),o=Math.cos(r),l=Math.sin(r),u=Math.cos(i),c=Math.sin(i);if("XYZ"===e.order){const e=a*u,n=a*c,r=s*u,i=s*c;t[0]=o*u,t[4]=-o*c,t[8]=l,t[1]=n+r*l,t[5]=e-i*l,t[9]=-s*o,t[2]=i-e*l,t[6]=r+n*l,t[10]=a*o}else if("YXZ"===e.order){const e=o*u,n=o*c,r=l*u,i=l*c;t[0]=e+i*s,t[4]=r*s-n,t[8]=a*l,t[1]=a*c,t[5]=a*u,t[9]=-s,t[2]=n*s-r,t[6]=i+e*s,t[10]=a*o}else if("ZXY"===e.order){const e=o*u,n=o*c,r=l*u,i=l*c;t[0]=e-i*s,t[4]=-a*c,t[8]=r+n*s,t[1]=n+r*s,t[5]=a*u,t[9]=i-e*s,t[2]=-a*l,t[6]=s,t[10]=a*o}else if("ZYX"===e.order){const e=a*u,n=a*c,r=s*u,i=s*c;t[0]=o*u,t[4]=r*l-n,t[8]=e*l+i,t[1]=o*c,t[5]=i*l+e,t[9]=n*l-r,t[2]=-l,t[6]=s*o,t[10]=a*o}else if("YZX"===e.order){const e=a*o,n=a*l,r=s*o,i=s*l;t[0]=o*u,t[4]=i-e*c,t[8]=r*c+n,t[1]=c,t[5]=a*u,t[9]=-s*u,t[2]=-l*u,t[6]=n*c+r,t[10]=e-i*c}else if("XZY"===e.order){const e=a*o,n=a*l,r=s*o,i=s*l;t[0]=o*u,t[4]=-c,t[8]=l*u,t[1]=e*c+i,t[5]=a*u,t[9]=n*c-r,t[2]=r*c-n,t[6]=s*u,t[10]=i*c+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(pX,e,fX)}lookAt(e,t,n){const r=this.elements;return vX.subVectors(e,t),0===vX.lengthSq()&&(vX.z=1),vX.normalize(),mX.crossVectors(n,vX),0===mX.lengthSq()&&(1===Math.abs(n.z)?vX.x+=1e-4:vX.z+=1e-4,vX.normalize(),mX.crossVectors(n,vX)),mX.normalize(),gX.crossVectors(vX,mX),r[0]=mX.x,r[4]=gX.x,r[8]=vX.x,r[1]=mX.y,r[5]=gX.y,r[9]=vX.y,r[2]=mX.z,r[6]=gX.z,r[10]=vX.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,a=n[0],s=n[4],o=n[8],l=n[12],u=n[1],c=n[5],d=n[9],h=n[13],p=n[2],f=n[6],m=n[10],g=n[14],v=n[3],y=n[7],_=n[11],b=n[15],x=r[0],w=r[4],S=r[8],C=r[12],T=r[1],M=r[5],E=r[9],A=r[13],P=r[2],R=r[6],L=r[10],k=r[14],D=r[3],I=r[7],O=r[11],N=r[15];return i[0]=a*x+s*T+o*P+l*D,i[4]=a*w+s*M+o*R+l*I,i[8]=a*S+s*E+o*L+l*O,i[12]=a*C+s*A+o*k+l*N,i[1]=u*x+c*T+d*P+h*D,i[5]=u*w+c*M+d*R+h*I,i[9]=u*S+c*E+d*L+h*O,i[13]=u*C+c*A+d*k+h*N,i[2]=p*x+f*T+m*P+g*D,i[6]=p*w+f*M+m*R+g*I,i[10]=p*S+f*E+m*L+g*O,i[14]=p*C+f*A+m*k+g*N,i[3]=v*x+y*T+_*P+b*D,i[7]=v*w+y*M+_*R+b*I,i[11]=v*S+y*E+_*L+b*O,i[15]=v*C+y*A+_*k+b*N,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],a=e[1],s=e[5],o=e[9],l=e[13],u=e[2],c=e[6],d=e[10],h=e[14];return e[3]*(+i*o*c-r*l*c-i*s*d+n*l*d+r*s*h-n*o*h)+e[7]*(+t*o*h-t*l*d+i*a*d-r*a*h+r*l*u-i*o*u)+e[11]*(+t*l*c-t*s*h-i*a*c+n*a*h+i*s*u-n*l*u)+e[15]*(-r*s*u-t*o*c+t*s*d+r*a*c-n*a*d+n*o*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],s=e[5],o=e[6],l=e[7],u=e[8],c=e[9],d=e[10],h=e[11],p=e[12],f=e[13],m=e[14],g=e[15],v=c*m*l-f*d*l+f*o*h-s*m*h-c*o*g+s*d*g,y=p*d*l-u*m*l-p*o*h+a*m*h+u*o*g-a*d*g,_=u*f*l-p*c*l+p*s*h-a*f*h-u*s*g+a*c*g,b=p*c*o-u*f*o-p*s*d+a*f*d+u*s*m-a*c*m,x=t*v+n*y+r*_+i*b;if(0===x)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const w=1/x;return e[0]=v*w,e[1]=(f*d*i-c*m*i-f*r*h+n*m*h+c*r*g-n*d*g)*w,e[2]=(s*m*i-f*o*i+f*r*l-n*m*l-s*r*g+n*o*g)*w,e[3]=(c*o*i-s*d*i-c*r*l+n*d*l+s*r*h-n*o*h)*w,e[4]=y*w,e[5]=(u*m*i-p*d*i+p*r*h-t*m*h-u*r*g+t*d*g)*w,e[6]=(p*o*i-a*m*i-p*r*l+t*m*l+a*r*g-t*o*g)*w,e[7]=(a*d*i-u*o*i+u*r*l-t*d*l-a*r*h+t*o*h)*w,e[8]=_*w,e[9]=(p*c*i-u*f*i-p*n*h+t*f*h+u*n*g-t*c*g)*w,e[10]=(a*f*i-p*s*i+p*n*l-t*f*l-a*n*g+t*s*g)*w,e[11]=(u*s*i-a*c*i-u*n*l+t*c*l+a*n*h-t*s*h)*w,e[12]=b*w,e[13]=(u*f*r-p*c*r+p*n*d-t*f*d-u*n*m+t*c*m)*w,e[14]=(p*s*r-a*f*r-p*n*o+t*f*o+a*n*m-t*s*m)*w,e[15]=(a*c*r-u*s*r+u*n*o-t*c*o-a*n*d+t*s*d)*w,this}scale(e){const t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),i=1-n,a=e.x,s=e.y,o=e.z,l=i*a,u=i*s;return this.set(l*a+n,l*s-r*o,l*o+r*s,0,l*s+r*o,u*s+n,u*o-r*a,0,l*o-r*s,u*o+r*a,i*o*o+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,i,a){return this.set(1,n,i,0,e,1,a,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,i=t._x,a=t._y,s=t._z,o=t._w,l=i+i,u=a+a,c=s+s,d=i*l,h=i*u,p=i*c,f=a*u,m=a*c,g=s*c,v=o*l,y=o*u,_=o*c,b=n.x,x=n.y,w=n.z;return r[0]=(1-(f+g))*b,r[1]=(h+_)*b,r[2]=(p-y)*b,r[3]=0,r[4]=(h-_)*x,r[5]=(1-(d+g))*x,r[6]=(m+v)*x,r[7]=0,r[8]=(p+y)*w,r[9]=(m-v)*w,r[10]=(1-(d+f))*w,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let i=dX.set(r[0],r[1],r[2]).length();const a=dX.set(r[4],r[5],r[6]).length(),s=dX.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],hX.copy(this);const o=1/i,l=1/a,u=1/s;return hX.elements[0]*=o,hX.elements[1]*=o,hX.elements[2]*=o,hX.elements[4]*=l,hX.elements[5]*=l,hX.elements[6]*=l,hX.elements[8]*=u,hX.elements[9]*=u,hX.elements[10]*=u,t.setFromRotationMatrix(hX),n.x=i,n.y=a,n.z=s,this}makePerspective(e,t,n,r,i,a,s=2e3){const o=this.elements,l=2*i/(t-e),u=2*i/(n-r),c=(t+e)/(t-e),d=(n+r)/(n-r);let h,p;if(s===WY)h=-(a+i)/(a-i),p=-2*a*i/(a-i);else{if(s!==YY)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+s);h=-a/(a-i),p=-a*i/(a-i)}return o[0]=l,o[4]=0,o[8]=c,o[12]=0,o[1]=0,o[5]=u,o[9]=d,o[13]=0,o[2]=0,o[6]=0,o[10]=h,o[14]=p,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(e,t,n,r,i,a,s=2e3){const o=this.elements,l=1/(t-e),u=1/(n-r),c=1/(a-i),d=(t+e)*l,h=(n+r)*u;let p,f;if(s===WY)p=(a+i)*c,f=-2*c;else{if(s!==YY)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+s);p=i*c,f=-1*c}return o[0]=2*l,o[4]=0,o[8]=0,o[12]=-d,o[1]=0,o[5]=2*u,o[9]=0,o[13]=-h,o[2]=0,o[6]=0,o[10]=f,o[14]=-p,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const dX=new I$,hX=new cX,pX=new I$(0,0,0),fX=new I$(1,1,1),mX=new I$,gX=new I$,vX=new I$,yX=new cX,_X=new D$;class bX{constructor(e=0,t=0,n=0,r=bX.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,r=this._order){return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const r=e.elements,i=r[0],a=r[4],s=r[8],o=r[1],l=r[5],u=r[9],c=r[2],d=r[6],h=r[10];switch(t){case"XYZ":this._y=Math.asin(QY(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-u,h),this._z=Math.atan2(-a,i)):(this._x=Math.atan2(d,l),this._z=0);break;case"YXZ":this._x=Math.asin(-QY(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(s,h),this._z=Math.atan2(o,l)):(this._y=Math.atan2(-c,i),this._z=0);break;case"ZXY":this._x=Math.asin(QY(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-c,h),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(o,i));break;case"ZYX":this._y=Math.asin(-QY(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(d,h),this._z=Math.atan2(o,i)):(this._x=0,this._z=Math.atan2(-a,l));break;case"YZX":this._z=Math.asin(QY(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-u,l),this._y=Math.atan2(-c,i)):(this._x=0,this._y=Math.atan2(s,h));break;case"XZY":this._z=Math.asin(-QY(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(d,l),this._y=Math.atan2(s,i)):(this._x=Math.atan2(-u,h),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return yX.makeRotationFromQuaternion(e),this.setFromRotationMatrix(yX,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return _X.setFromEuler(this),this.setFromQuaternion(_X,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}bX.DEFAULT_ORDER="XYZ";class xX{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let wX=0;const SX=new I$,CX=new D$,TX=new cX,MX=new I$,EX=new I$,AX=new I$,PX=new D$,RX=new I$(1,0,0),LX=new I$(0,1,0),kX=new I$(0,0,1),DX={type:"added"},IX={type:"removed"};class OX extends $Y{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:wX++}),this.uuid=JY(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=OX.DEFAULT_UP.clone();const e=new I$,t=new bX,n=new D$,r=new I$(1,1,1);t._onChange((function(){n.setFromEuler(t,!1)})),n._onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new cX},normalMatrix:{value:new u$}}),this.matrix=new cX,this.matrixWorld=new cX,this.matrixAutoUpdate=OX.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=OX.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new xX,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return CX.setFromAxisAngle(e,t),this.quaternion.multiply(CX),this}rotateOnWorldAxis(e,t){return CX.setFromAxisAngle(e,t),this.quaternion.premultiply(CX),this}rotateX(e){return this.rotateOnAxis(RX,e)}rotateY(e){return this.rotateOnAxis(LX,e)}rotateZ(e){return this.rotateOnAxis(kX,e)}translateOnAxis(e,t){return SX.copy(e).applyQuaternion(this.quaternion),this.position.add(SX.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(RX,e)}translateY(e){return this.translateOnAxis(LX,e)}translateZ(e){return this.translateOnAxis(kX,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(TX.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?MX.copy(e):MX.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),EX.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?TX.lookAt(EX,MX,this.up):TX.lookAt(MX,EX,this.up),this.quaternion.setFromRotationMatrix(TX),r&&(TX.extractRotation(r.matrixWorld),CX.setFromRotationMatrix(TX),this.quaternion.premultiply(CX.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(DX)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(IX)),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(IX)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),TX.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),TX.multiply(e.parent.matrixWorld)),e.applyMatrix4(TX),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const r=this.children[n].getObjectByProperty(e,t);if(void 0!==r)return r}}getObjectsByProperty(e,t){let n=[];this[e]===t&&n.push(this);for(let r=0,i=this.children.length;r<i;r++){const i=this.children[r].getObjectsByProperty(e,t);i.length>0&&(n=n.concat(i))}return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(EX,e,AX),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(EX,PX,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++){const r=t[n];!0!==r.matrixWorldAutoUpdate&&!0!==e||r.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const n=this.parent;if(!0===e&&null!==n&&!0===n.matrixWorldAutoUpdate&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){const e=this.children;for(let t=0,n=e.length;t<n;t++){const n=e[t];!0===n.matrixWorldAutoUpdate&&n.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};function i(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);const t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){const n=t.shapes;if(Array.isArray(n))for(let t=0,r=n.length;t<r;t++){const r=n[t];i(e.shapes,r)}else i(e.shapes,n)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const t=[];for(let n=0,r=this.material.length;n<r;n++)t.push(i(e.materials,this.material[n]));r.material=t}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(let t=0;t<this.children.length;t++)r.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let t=0;t<this.animations.length;t++){const n=this.animations[t];r.animations.push(i(e.animations,n))}}if(t){const t=a(e.geometries),r=a(e.materials),i=a(e.textures),s=a(e.images),o=a(e.shapes),l=a(e.skeletons),u=a(e.animations),c=a(e.nodes);t.length>0&&(n.geometries=t),r.length>0&&(n.materials=r),i.length>0&&(n.textures=i),s.length>0&&(n.images=s),o.length>0&&(n.shapes=o),l.length>0&&(n.skeletons=l),u.length>0&&(n.animations=u),c.length>0&&(n.nodes=c)}return n.object=r,n;function a(e){const t=[];for(const n in e){const r=e[n];delete r.metadata,t.push(r)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let n=0;n<e.children.length;n++){const t=e.children[n];this.add(t.clone())}return this}}OX.DEFAULT_UP=new I$(0,1,0),OX.DEFAULT_MATRIX_AUTO_UPDATE=!0,OX.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const NX=new I$,BX=new I$,UX=new I$,zX=new I$,FX=new I$,VX=new I$,GX=new I$,HX=new I$,jX=new I$,WX=new I$;let YX=!1;class $X{constructor(e=new I$,t=new I$,n=new I$){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),NX.subVectors(e,t),r.cross(NX);const i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}static getBarycoord(e,t,n,r,i){NX.subVectors(r,t),BX.subVectors(n,t),UX.subVectors(e,t);const a=NX.dot(NX),s=NX.dot(BX),o=NX.dot(UX),l=BX.dot(BX),u=BX.dot(UX),c=a*l-s*s;if(0===c)return i.set(-2,-1,-1);const d=1/c,h=(l*o-s*u)*d,p=(a*u-s*o)*d;return i.set(1-h-p,p,h)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,zX),zX.x>=0&&zX.y>=0&&zX.x+zX.y<=1}static getUV(e,t,n,r,i,a,s,o){return!1===YX&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),YX=!0),this.getInterpolation(e,t,n,r,i,a,s,o)}static getInterpolation(e,t,n,r,i,a,s,o){return this.getBarycoord(e,t,n,r,zX),o.setScalar(0),o.addScaledVector(i,zX.x),o.addScaledVector(a,zX.y),o.addScaledVector(s,zX.z),o}static isFrontFacing(e,t,n,r){return NX.subVectors(n,t),BX.subVectors(e,t),NX.cross(BX).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return NX.subVectors(this.c,this.b),BX.subVectors(this.a,this.b),.5*NX.cross(BX).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return $X.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return $X.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,r,i){return!1===YX&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),YX=!0),$X.getInterpolation(e,this.a,this.b,this.c,t,n,r,i)}getInterpolation(e,t,n,r,i){return $X.getInterpolation(e,this.a,this.b,this.c,t,n,r,i)}containsPoint(e){return $X.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return $X.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,i=this.c;let a,s;FX.subVectors(r,n),VX.subVectors(i,n),HX.subVectors(e,n);const o=FX.dot(HX),l=VX.dot(HX);if(o<=0&&l<=0)return t.copy(n);jX.subVectors(e,r);const u=FX.dot(jX),c=VX.dot(jX);if(u>=0&&c<=u)return t.copy(r);const d=o*c-u*l;if(d<=0&&o>=0&&u<=0)return a=o/(o-u),t.copy(n).addScaledVector(FX,a);WX.subVectors(e,i);const h=FX.dot(WX),p=VX.dot(WX);if(p>=0&&h<=p)return t.copy(i);const f=h*l-o*p;if(f<=0&&l>=0&&p<=0)return s=l/(l-p),t.copy(n).addScaledVector(VX,s);const m=u*p-h*c;if(m<=0&&c-u>=0&&h-p>=0)return GX.subVectors(i,r),s=(c-u)/(c-u+(h-p)),t.copy(r).addScaledVector(GX,s);const g=1/(m+f+d);return a=f*g,s=d*g,t.copy(n).addScaledVector(FX,a).addScaledVector(VX,s)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let XX=0;class qX extends $Y{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:XX++}),this.uuid=JY(),this.name="",this.type="Material",this.blending=1,this.side=WW,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=$W,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=VY,this.stencilZFail=VY,this.stencilZPass=VY,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function r(e){const t=[];for(const n in e){const r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(n.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),this.side!==WW&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.forceSinglePass&&(n.forceSinglePass=this.forceSinglePass),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),t){const t=r(e.textures),i=r(e.images);t.length>0&&(n.textures=t),i.length>0&&(n.images=i)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const e=t.length;n=new Array(e);for(let r=0;r!==e;++r)n[r]=t[r].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}const KX={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ZX={h:0,s:0,l:0},JX={h:0,s:0,l:0};function QX(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}class eq{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(void 0===t&&void 0===n){const t=e;t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=UY){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,x$.toWorkingColorSpace(this,t),this}setRGB(e,t,n,r=x$.workingColorSpace){return this.r=e,this.g=t,this.b=n,x$.toWorkingColorSpace(this,r),this}setHSL(e,t,n,r=x$.workingColorSpace){if(e=e$(e,1),t=QY(t,0,1),n=QY(n,0,1),0===t)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+t):n+t-n*t,i=2*n-r;this.r=QX(i,r,e+1/3),this.g=QX(i,r,e),this.b=QX(i,r,e-1/3)}return x$.toWorkingColorSpace(this,r),this}setStyle(e,t=UY){function n(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let i;const a=r[1],s=r[2];switch(a){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return n(i[4]),this.setRGB(Math.min(255,parseInt(i[1],10))/255,Math.min(255,parseInt(i[2],10))/255,Math.min(255,parseInt(i[3],10))/255,t);if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return n(i[4]),this.setRGB(Math.min(100,parseInt(i[1],10))/100,Math.min(100,parseInt(i[2],10))/100,Math.min(100,parseInt(i[3],10))/100,t);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return n(i[4]),this.setHSL(parseFloat(i[1])/360,parseFloat(i[2])/100,parseFloat(i[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const n=r[1],i=n.length;if(3===i)return this.setRGB(parseInt(n.charAt(0),16)/15,parseInt(n.charAt(1),16)/15,parseInt(n.charAt(2),16)/15,t);if(6===i)return this.setHex(parseInt(n,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=UY){const n=KX[e.toLowerCase()];return void 0!==n?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=m$(e.r),this.g=m$(e.g),this.b=m$(e.b),this}copyLinearToSRGB(e){return this.r=g$(e.r),this.g=g$(e.g),this.b=g$(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=UY){return x$.fromWorkingColorSpace(tq.copy(this),e),65536*Math.round(QY(255*tq.r,0,255))+256*Math.round(QY(255*tq.g,0,255))+Math.round(QY(255*tq.b,0,255))}getHexString(e=UY){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=x$.workingColorSpace){x$.fromWorkingColorSpace(tq.copy(this),t);const n=tq.r,r=tq.g,i=tq.b,a=Math.max(n,r,i),s=Math.min(n,r,i);let o,l;const u=(s+a)/2;if(s===a)o=0,l=0;else{const e=a-s;switch(l=u<=.5?e/(a+s):e/(2-a-s),a){case n:o=(r-i)/e+(r<i?6:0);break;case r:o=(i-n)/e+2;break;case i:o=(n-r)/e+4}o/=6}return e.h=o,e.s=l,e.l=u,e}getRGB(e,t=x$.workingColorSpace){return x$.fromWorkingColorSpace(tq.copy(this),t),e.r=tq.r,e.g=tq.g,e.b=tq.b,e}getStyle(e=UY){x$.fromWorkingColorSpace(tq.copy(this),e);const t=tq.r,n=tq.g,r=tq.b;return e!==UY?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*n)},${Math.round(255*r)})`}offsetHSL(e,t,n){return this.getHSL(ZX),ZX.h+=e,ZX.s+=t,ZX.l+=n,this.setHSL(ZX.h,ZX.s,ZX.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(ZX),e.getHSL(JX);const n=t$(ZX.h,JX.h,t),r=t$(ZX.s,JX.s,t),i=t$(ZX.l,JX.l,t);return this.setHSL(n,r,i),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,r=this.b,i=e.elements;return this.r=i[0]*t+i[3]*n+i[6]*r,this.g=i[1]*t+i[4]*n+i[7]*r,this.b=i[2]*t+i[5]*n+i[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const tq=new eq;eq.NAMES=KX;class nq extends qX{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new eq(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=XW,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const rq=iq();function iq(){const e=new ArrayBuffer(4),t=new Float32Array(e),n=new Uint32Array(e),r=new Uint32Array(512),i=new Uint32Array(512);for(let l=0;l<256;++l){const e=l-127;e<-27?(r[l]=0,r[256|l]=32768,i[l]=24,i[256|l]=24):e<-14?(r[l]=1024>>-e-14,r[256|l]=1024>>-e-14|32768,i[l]=-e-1,i[256|l]=-e-1):e<=15?(r[l]=e+15<<10,r[256|l]=e+15<<10|32768,i[l]=13,i[256|l]=13):e<128?(r[l]=31744,r[256|l]=64512,i[l]=24,i[256|l]=24):(r[l]=31744,r[256|l]=64512,i[l]=13,i[256|l]=13)}const a=new Uint32Array(2048),s=new Uint32Array(64),o=new Uint32Array(64);for(let l=1;l<1024;++l){let e=l<<13,t=0;for(;0==(8388608&e);)e<<=1,t-=8388608;e&=-8388609,t+=947912704,a[l]=e|t}for(let l=1024;l<2048;++l)a[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)s[l]=l<<23;s[31]=1199570944,s[32]=2147483648;for(let l=33;l<63;++l)s[l]=2147483648+(l-32<<23);s[63]=3347054592;for(let l=1;l<64;++l)32!==l&&(o[l]=1024);return{floatView:t,uint32View:n,baseTable:r,shiftTable:i,mantissaTable:a,exponentTable:s,offsetTable:o}}const aq={toHalfFloat:function(e){Math.abs(e)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),e=QY(e,-65504,65504),rq.floatView[0]=e;const t=rq.uint32View[0],n=t>>23&511;return rq.baseTable[n]+((8388607&t)>>rq.shiftTable[n])},fromHalfFloat:function(e){const t=e>>10;return rq.uint32View[0]=rq.mantissaTable[rq.offsetTable[t]+(1023&e)]+rq.exponentTable[t],rq.floatView[0]}},sq=new I$,oq=new l$;class lq{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=n,this.usage=GY,this.updateRange={offset:0,count:-1},this.gpuType=yY,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)oq.fromBufferAttribute(this,t),oq.applyMatrix3(e),this.setXY(t,oq.x,oq.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)sq.fromBufferAttribute(this,t),sq.applyMatrix3(e),this.setXYZ(t,sq.x,sq.y,sq.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)sq.fromBufferAttribute(this,t),sq.applyMatrix4(e),this.setXYZ(t,sq.x,sq.y,sq.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)sq.fromBufferAttribute(this,t),sq.applyNormalMatrix(e),this.setXYZ(t,sq.x,sq.y,sq.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)sq.fromBufferAttribute(this,t),sq.transformDirection(e),this.setXYZ(t,sq.x,sq.y,sq.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=a$(t,this.array)),t}setX(e,t){return this.normalized&&(t=s$(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=a$(t,this.array)),t}setY(e,t){return this.normalized&&(t=s$(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=a$(t,this.array)),t}setZ(e,t){return this.normalized&&(t=s$(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=a$(t,this.array)),t}setW(e,t){return this.normalized&&(t=s$(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=s$(t,this.array),n=s$(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=s$(t,this.array),n=s$(n,this.array),r=s$(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,i){return e*=this.itemSize,this.normalized&&(t=s$(t,this.array),n=s$(n,this.array),r=s$(r,this.array),i=s$(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==GY&&(e.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class uq extends lq{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class cq extends lq{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class dq extends lq{constructor(e,t,n){super(new Float32Array(e),t,n)}}let hq=0;const pq=new cX,fq=new OX,mq=new I$,gq=new B$,vq=new B$,yq=new I$;class _q extends $Y{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:hq++}),this.uuid=JY(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(d$(e)?cq:uq)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const t=(new u$).getNormalMatrix(e);n.applyNormalMatrix(t),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return pq.makeRotationFromQuaternion(e),this.applyMatrix4(pq),this}rotateX(e){return pq.makeRotationX(e),this.applyMatrix4(pq),this}rotateY(e){return pq.makeRotationY(e),this.applyMatrix4(pq),this}rotateZ(e){return pq.makeRotationZ(e),this.applyMatrix4(pq),this}translate(e,t,n){return pq.makeTranslation(e,t,n),this.applyMatrix4(pq),this}scale(e,t,n){return pq.makeScale(e,t,n),this.applyMatrix4(pq),this}lookAt(e){return fq.lookAt(e),fq.updateMatrix(),this.applyMatrix4(fq.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(mq).negate(),this.translate(mq.x,mq.y,mq.z),this}setFromPoints(e){const t=[];for(let n=0,r=e.length;n<r;n++){const r=e[n];t.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new dq(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new B$);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new I$(-1/0,-1/0,-1/0),new I$(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++){const e=t[n];gq.setFromBufferAttribute(e),this.morphTargetsRelative?(yq.addVectors(this.boundingBox.min,gq.min),this.boundingBox.expandByPoint(yq),yq.addVectors(this.boundingBox.max,gq.max),this.boundingBox.expandByPoint(yq)):(this.boundingBox.expandByPoint(gq.min),this.boundingBox.expandByPoint(gq.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new tX);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new I$,1/0);if(e){const n=this.boundingSphere.center;if(gq.setFromBufferAttribute(e),t)for(let e=0,i=t.length;e<i;e++){const n=t[e];vq.setFromBufferAttribute(n),this.morphTargetsRelative?(yq.addVectors(gq.min,vq.min),gq.expandByPoint(yq),yq.addVectors(gq.max,vq.max),gq.expandByPoint(yq)):(gq.expandByPoint(vq.min),gq.expandByPoint(vq.max))}gq.getCenter(n);let r=0;for(let t=0,i=e.count;t<i;t++)yq.fromBufferAttribute(e,t),r=Math.max(r,n.distanceToSquared(yq));if(t)for(let i=0,a=t.length;i<a;i++){const a=t[i],s=this.morphTargetsRelative;for(let t=0,i=a.count;t<i;t++)yq.fromBufferAttribute(a,t),s&&(mq.fromBufferAttribute(e,t),yq.add(mq)),r=Math.max(r,n.distanceToSquared(yq))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=e.array,r=t.position.array,i=t.normal.array,a=t.uv.array,s=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new lq(new Float32Array(4*s),4));const o=this.getAttribute("tangent").array,l=[],u=[];for(let T=0;T<s;T++)l[T]=new I$,u[T]=new I$;const c=new I$,d=new I$,h=new I$,p=new l$,f=new l$,m=new l$,g=new I$,v=new I$;function y(e,t,n){c.fromArray(r,3*e),d.fromArray(r,3*t),h.fromArray(r,3*n),p.fromArray(a,2*e),f.fromArray(a,2*t),m.fromArray(a,2*n),d.sub(c),h.sub(c),f.sub(p),m.sub(p);const i=1/(f.x*m.y-m.x*f.y);isFinite(i)&&(g.copy(d).multiplyScalar(m.y).addScaledVector(h,-f.y).multiplyScalar(i),v.copy(h).multiplyScalar(f.x).addScaledVector(d,-m.x).multiplyScalar(i),l[e].add(g),l[t].add(g),l[n].add(g),u[e].add(v),u[t].add(v),u[n].add(v))}let _=this.groups;0===_.length&&(_=[{start:0,count:n.length}]);for(let T=0,M=_.length;T<M;++T){const e=_[T],t=e.start;for(let r=t,i=t+e.count;r<i;r+=3)y(n[r+0],n[r+1],n[r+2])}const b=new I$,x=new I$,w=new I$,S=new I$;function C(e){w.fromArray(i,3*e),S.copy(w);const t=l[e];b.copy(t),b.sub(w.multiplyScalar(w.dot(t))).normalize(),x.crossVectors(S,t);const n=x.dot(u[e])<0?-1:1;o[4*e]=b.x,o[4*e+1]=b.y,o[4*e+2]=b.z,o[4*e+3]=n}for(let T=0,M=_.length;T<M;++T){const e=_[T],t=e.start;for(let r=t,i=t+e.count;r<i;r+=3)C(n[r+0]),C(n[r+1]),C(n[r+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new lq(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let e=0,t=n.count;e<t;e++)n.setXYZ(e,0,0,0);const r=new I$,i=new I$,a=new I$,s=new I$,o=new I$,l=new I$,u=new I$,c=new I$;if(e)for(let d=0,h=e.count;d<h;d+=3){const h=e.getX(d+0),p=e.getX(d+1),f=e.getX(d+2);r.fromBufferAttribute(t,h),i.fromBufferAttribute(t,p),a.fromBufferAttribute(t,f),u.subVectors(a,i),c.subVectors(r,i),u.cross(c),s.fromBufferAttribute(n,h),o.fromBufferAttribute(n,p),l.fromBufferAttribute(n,f),s.add(u),o.add(u),l.add(u),n.setXYZ(h,s.x,s.y,s.z),n.setXYZ(p,o.x,o.y,o.z),n.setXYZ(f,l.x,l.y,l.z)}else for(let e=0,d=t.count;e<d;e+=3)r.fromBufferAttribute(t,e+0),i.fromBufferAttribute(t,e+1),a.fromBufferAttribute(t,e+2),u.subVectors(a,i),c.subVectors(r,i),u.cross(c),n.setXYZ(e+0,u.x,u.y,u.z),n.setXYZ(e+1,u.x,u.y,u.z),n.setXYZ(e+2,u.x,u.y,u.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeGeometries() instead."),this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)yq.fromBufferAttribute(e,t),yq.normalize(),e.setXYZ(t,yq.x,yq.y,yq.z)}toNonIndexed(){function e(e,t){const n=e.array,r=e.itemSize,i=e.normalized,a=new n.constructor(t.length*r);let s=0,o=0;for(let l=0,u=t.length;l<u;l++){s=e.isInterleavedBufferAttribute?t[l]*e.data.stride+e.offset:t[l]*r;for(let e=0;e<r;e++)a[o++]=n[s++]}return new lq(a,r,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new _q,n=this.index.array,r=this.attributes;for(const s in r){const i=e(r[s],n);t.setAttribute(s,i)}const i=this.morphAttributes;for(const s in i){const r=[],a=i[s];for(let t=0,i=a.length;t<i;t++){const i=e(a[t],n);r.push(i)}t.morphAttributes[s]=r}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let s=0,o=a.length;s<o;s++){const e=a[s];t.addGroup(e.start,e.count,e.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const t=this.parameters;for(const n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const o in n){const t=n[o];e.data.attributes[o]=t.toJSON(e.data)}const r={};let i=!1;for(const o in this.morphAttributes){const t=this.morphAttributes[o],n=[];for(let r=0,i=t.length;r<i;r++){const i=t[r];n.push(i.toJSON(e.data))}n.length>0&&(r[o]=n,i=!0)}i&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const s=this.boundingSphere;return null!==s&&(e.data.boundingSphere={center:s.center.toArray(),radius:s.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone(t));const r=e.attributes;for(const l in r){const e=r[l];this.setAttribute(l,e.clone(t))}const i=e.morphAttributes;for(const l in i){const e=[],n=i[l];for(let r=0,i=n.length;r<i;r++)e.push(n[r].clone(t));this.morphAttributes[l]=e}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let l=0,u=a.length;l<u;l++){const e=a[l];this.addGroup(e.start,e.count,e.materialIndex)}const s=e.boundingBox;null!==s&&(this.boundingBox=s.clone());const o=e.boundingSphere;return null!==o&&(this.boundingSphere=o.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const bq=new cX,xq=new uX,wq=new tX,Sq=new I$,Cq=new I$,Tq=new I$,Mq=new I$,Eq=new I$,Aq=new I$,Pq=new l$,Rq=new l$,Lq=new l$,kq=new I$,Dq=new I$,Iq=new I$,Oq=new I$,Nq=new I$;class Bq extends OX{constructor(e=new _q,t=new nq){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}getVertexPosition(e,t){const n=this.geometry,r=n.attributes.position,i=n.morphAttributes.position,a=n.morphTargetsRelative;t.fromBufferAttribute(r,e);const s=this.morphTargetInfluences;if(i&&s){Aq.set(0,0,0);for(let n=0,r=i.length;n<r;n++){const r=s[n],o=i[n];0!==r&&(Eq.fromBufferAttribute(o,e),a?Aq.addScaledVector(Eq,r):Aq.addScaledVector(Eq.sub(t),r))}t.add(Aq)}return t}raycast(e,t){const n=this.geometry,r=this.material,i=this.matrixWorld;if(void 0!==r){if(null===n.boundingSphere&&n.computeBoundingSphere(),wq.copy(n.boundingSphere),wq.applyMatrix4(i),xq.copy(e.ray).recast(e.near),!1===wq.containsPoint(xq.origin)){if(null===xq.intersectSphere(wq,Sq))return;if(xq.origin.distanceToSquared(Sq)>(e.far-e.near)**2)return}bq.copy(i).invert(),xq.copy(e.ray).applyMatrix4(bq),null!==n.boundingBox&&!1===xq.intersectsBox(n.boundingBox)||this._computeIntersections(e,t,xq)}}_computeIntersections(e,t,n){let r;const i=this.geometry,a=this.material,s=i.index,o=i.attributes.position,l=i.attributes.uv,u=i.attributes.uv1,c=i.attributes.normal,d=i.groups,h=i.drawRange;if(null!==s)if(Array.isArray(a))for(let p=0,f=d.length;p<f;p++){const i=d[p],o=a[i.materialIndex];for(let a=Math.max(i.start,h.start),d=Math.min(s.count,Math.min(i.start+i.count,h.start+h.count));a<d;a+=3){r=Uq(this,o,e,n,l,u,c,s.getX(a),s.getX(a+1),s.getX(a+2)),r&&(r.faceIndex=Math.floor(a/3),r.face.materialIndex=i.materialIndex,t.push(r))}}else{for(let i=Math.max(0,h.start),o=Math.min(s.count,h.start+h.count);i<o;i+=3){r=Uq(this,a,e,n,l,u,c,s.getX(i),s.getX(i+1),s.getX(i+2)),r&&(r.faceIndex=Math.floor(i/3),t.push(r))}}else if(void 0!==o)if(Array.isArray(a))for(let p=0,f=d.length;p<f;p++){const i=d[p],s=a[i.materialIndex];for(let a=Math.max(i.start,h.start),d=Math.min(o.count,Math.min(i.start+i.count,h.start+h.count));a<d;a+=3){r=Uq(this,s,e,n,l,u,c,a,a+1,a+2),r&&(r.faceIndex=Math.floor(a/3),r.face.materialIndex=i.materialIndex,t.push(r))}}else{for(let i=Math.max(0,h.start),s=Math.min(o.count,h.start+h.count);i<s;i+=3){r=Uq(this,a,e,n,l,u,c,i,i+1,i+2),r&&(r.faceIndex=Math.floor(i/3),t.push(r))}}}}function Uq(e,t,n,r,i,a,s,o,l,u){e.getVertexPosition(o,Cq),e.getVertexPosition(l,Tq),e.getVertexPosition(u,Mq);const c=function(e,t,n,r,i,a,s,o){let l;if(l=t.side===YW?r.intersectTriangle(s,a,i,!0,o):r.intersectTriangle(i,a,s,t.side===WW,o),null===l)return null;Nq.copy(o),Nq.applyMatrix4(e.matrixWorld);const u=n.ray.origin.distanceTo(Nq);return u<n.near||u>n.far?null:{distance:u,point:Nq.clone(),object:e}}(e,t,n,r,Cq,Tq,Mq,Oq);if(c){i&&(Pq.fromBufferAttribute(i,o),Rq.fromBufferAttribute(i,l),Lq.fromBufferAttribute(i,u),c.uv=$X.getInterpolation(Oq,Cq,Tq,Mq,Pq,Rq,Lq,new l$)),a&&(Pq.fromBufferAttribute(a,o),Rq.fromBufferAttribute(a,l),Lq.fromBufferAttribute(a,u),c.uv1=$X.getInterpolation(Oq,Cq,Tq,Mq,Pq,Rq,Lq,new l$),c.uv2=c.uv1),s&&(kq.fromBufferAttribute(s,o),Dq.fromBufferAttribute(s,l),Iq.fromBufferAttribute(s,u),c.normal=$X.getInterpolation(Oq,Cq,Tq,Mq,kq,Dq,Iq,new I$),c.normal.dot(r.direction)>0&&c.normal.multiplyScalar(-1));const e={a:o,b:l,c:u,normal:new I$,materialIndex:0};$X.getNormal(Cq,Tq,Mq,e.normal),c.face=e}return c}class zq extends _q{constructor(e=1,t=1,n=1,r=1,i=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:a};const s=this;r=Math.floor(r),i=Math.floor(i),a=Math.floor(a);const o=[],l=[],u=[],c=[];let d=0,h=0;function p(e,t,n,r,i,a,p,f,m,g,v){const y=a/m,_=p/g,b=a/2,x=p/2,w=f/2,S=m+1,C=g+1;let T=0,M=0;const E=new I$;for(let s=0;s<C;s++){const a=s*_-x;for(let o=0;o<S;o++){const d=o*y-b;E[e]=d*r,E[t]=a*i,E[n]=w,l.push(E.x,E.y,E.z),E[e]=0,E[t]=0,E[n]=f>0?1:-1,u.push(E.x,E.y,E.z),c.push(o/m),c.push(1-s/g),T+=1}}for(let s=0;s<g;s++)for(let e=0;e<m;e++){const t=d+e+S*s,n=d+e+S*(s+1),r=d+(e+1)+S*(s+1),i=d+(e+1)+S*s;o.push(t,n,i),o.push(n,r,i),M+=6}s.addGroup(h,M,v),h+=M,d+=T}p("z","y","x",-1,-1,n,t,e,a,i,0),p("z","y","x",1,-1,n,t,-e,a,i,1),p("x","z","y",1,1,e,n,t,r,a,2),p("x","z","y",1,-1,e,n,-t,r,a,3),p("x","y","z",1,-1,e,t,n,r,i,4),p("x","y","z",-1,-1,e,t,-n,r,i,5),this.setIndex(o),this.setAttribute("position",new dq(l,3)),this.setAttribute("normal",new dq(u,3)),this.setAttribute("uv",new dq(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new zq(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Fq(e){const t={};for(const n in e){t[n]={};for(const r in e[n]){const i=e[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[n][r]=null):t[n][r]=i.clone():Array.isArray(i)?t[n][r]=i.slice():t[n][r]=i}}return t}function Vq(e){const t={};for(let n=0;n<e.length;n++){const r=Fq(e[n]);for(const e in r)t[e]=r[e]}return t}function Gq(e){return null===e.getRenderTarget()?e.outputColorSpace:zY}const Hq={clone:Fq,merge:Vq};class jq extends qX{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Fq(e.uniforms),this.uniformsGroups=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const n=this.uniforms[r].value;n&&n.isTexture?t.uniforms[r]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[r]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[r]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[r]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[r]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[r]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[r]={type:"m4",value:n.toArray()}:t.uniforms[r]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const r in this.extensions)!0===this.extensions[r]&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class Wq extends OX{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new cX,this.projectionMatrix=new cX,this.projectionMatrixInverse=new cX,this.coordinateSystem=WY}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class Yq extends Wq{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*ZY*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*KY*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*ZY*Math.atan(Math.tan(.5*KY*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,n,r,i,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*KY*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r;const a=this.view;if(null!==this.view&&this.view.enabled){const e=a.fullWidth,s=a.fullHeight;i+=a.offsetX*r/e,t-=a.offsetY*n/s,r*=a.width/e,n*=a.height/s}const s=this.filmOffset;0!==s&&(i+=e*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const $q=-90;class Xq extends OX{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null;const r=new Yq($q,1,e,t);r.layers=this.layers,this.add(r);const i=new Yq($q,1,e,t);i.layers=this.layers,this.add(i);const a=new Yq($q,1,e,t);a.layers=this.layers,this.add(a);const s=new Yq($q,1,e,t);s.layers=this.layers,this.add(s);const o=new Yq($q,1,e,t);o.layers=this.layers,this.add(o);const l=new Yq($q,1,e,t);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,r,i,a,s,o]=t;for(const l of t)this.remove(l);if(e===WY)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),i.up.set(0,0,-1),i.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),s.up.set(0,1,0),s.lookAt(0,0,1),o.up.set(0,1,0),o.lookAt(0,0,-1);else{if(e!==YY)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),i.up.set(0,0,1),i.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),s.up.set(0,-1,0),s.lookAt(0,0,1),o.up.set(0,-1,0),o.lookAt(0,0,-1)}for(const l of t)this.add(l),l.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const n=this.renderTarget;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[r,i,a,s,o,l]=this.children,u=e.getRenderTarget(),c=e.toneMapping,d=e.xr.enabled;e.toneMapping=ZW,e.xr.enabled=!1;const h=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,r),e.setRenderTarget(n,1),e.render(t,i),e.setRenderTarget(n,2),e.render(t,a),e.setRenderTarget(n,3),e.render(t,s),e.setRenderTarget(n,4),e.render(t,o),n.texture.generateMipmaps=h,e.setRenderTarget(n,5),e.render(t,l),e.setRenderTarget(u),e.toneMapping=c,e.xr.enabled=d,n.texture.needsPMREMUpdate=!0}}class qq extends A${constructor(e,t,n,r,i,a,s,o,l,u){super(e=void 0!==e?e:[],t=void 0!==t?t:rY,n,r,i,a,s,o,l,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Kq extends R${constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];void 0!==t.encoding&&(f$("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===NY?UY:BY),this.texture=new qq(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:hY}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t"},r=new zq(5,5,5),i=new jq({name:"CubemapFromEquirect",uniforms:Fq(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:YW,blending:0});i.uniforms.tEquirect.value=t;const a=new Bq(r,i),s=t.minFilter;t.minFilter===pY&&(t.minFilter=hY);return new Xq(1,10,this).update(e,a),t.minFilter=s,a.geometry.dispose(),a.material.dispose(),this}clear(e,t,n,r){const i=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,n,r);e.setRenderTarget(i)}}const Zq=new I$,Jq=new I$,Qq=new u$;class eK{constructor(e=new I$(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=Zq.subVectors(n,t).cross(Jq.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(Zq),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:t.copy(e.start).addScaledVector(n,i)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||Qq.getNormalMatrix(e),r=this.coplanarPoint(Zq).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const tK=new tX,nK=new I$;class rK{constructor(e=new eK,t=new eK,n=new eK,r=new eK,i=new eK,a=new eK){this.planes=[e,t,n,r,i,a]}set(e,t,n,r,i,a){const s=this.planes;return s[0].copy(e),s[1].copy(t),s[2].copy(n),s[3].copy(r),s[4].copy(i),s[5].copy(a),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=2e3){const n=this.planes,r=e.elements,i=r[0],a=r[1],s=r[2],o=r[3],l=r[4],u=r[5],c=r[6],d=r[7],h=r[8],p=r[9],f=r[10],m=r[11],g=r[12],v=r[13],y=r[14],_=r[15];if(n[0].setComponents(o-i,d-l,m-h,_-g).normalize(),n[1].setComponents(o+i,d+l,m+h,_+g).normalize(),n[2].setComponents(o+a,d+u,m+p,_+v).normalize(),n[3].setComponents(o-a,d-u,m-p,_-v).normalize(),n[4].setComponents(o-s,d-c,m-f,_-y).normalize(),t===WY)n[5].setComponents(o+s,d+c,m+f,_+y).normalize();else{if(t!==YY)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);n[5].setComponents(s,c,f,y).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),tK.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),tK.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(tK)}intersectsSprite(e){return tK.center.set(0,0,0),tK.radius=.7071067811865476,tK.applyMatrix4(e.matrixWorld),this.intersectsSphere(tK)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let i=0;i<6;i++){if(t[i].distanceToPoint(n)<r)return!1}return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(nK.x=r.normal.x>0?e.max.x:e.min.x,nK.y=r.normal.y>0?e.max.y:e.min.y,nK.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(nK)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function iK(){let e=null,t=!1,n=null,r=null;function i(t,a){n(t,a),r=e.requestAnimationFrame(i)}return{start:function(){!0!==t&&null!==n&&(r=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function aK(e,t){const n=t.isWebGL2,r=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),r.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);const n=r.get(t);n&&(e.deleteBuffer(n.buffer),r.delete(t))},update:function(t,i){if(t.isGLBufferAttribute){const e=r.get(t);return void((!e||e.version<t.version)&&r.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version}))}t.isInterleavedBufferAttribute&&(t=t.data);const a=r.get(t);void 0===a?r.set(t,function(t,r){const i=t.array,a=t.usage,s=e.createBuffer();let o;if(e.bindBuffer(r,s),e.bufferData(r,i,a),t.onUploadCallback(),i instanceof Float32Array)o=e.FLOAT;else if(i instanceof Uint16Array)if(t.isFloat16BufferAttribute){if(!n)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");o=e.HALF_FLOAT}else o=e.UNSIGNED_SHORT;else if(i instanceof Int16Array)o=e.SHORT;else if(i instanceof Uint32Array)o=e.UNSIGNED_INT;else if(i instanceof Int32Array)o=e.INT;else if(i instanceof Int8Array)o=e.BYTE;else if(i instanceof Uint8Array)o=e.UNSIGNED_BYTE;else{if(!(i instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+i);o=e.UNSIGNED_BYTE}return{buffer:s,type:o,bytesPerElement:i.BYTES_PER_ELEMENT,version:t.version}}(t,i)):a.version<t.version&&(!function(t,r,i){const a=r.array,s=r.updateRange;e.bindBuffer(i,t),-1===s.count?e.bufferSubData(i,0,a):(n?e.bufferSubData(i,s.offset*a.BYTES_PER_ELEMENT,a,s.offset,s.count):e.bufferSubData(i,s.offset*a.BYTES_PER_ELEMENT,a.subarray(s.offset,s.offset+s.count)),s.count=-1),r.onUploadCallback()}(a.buffer,t,i),a.version=t.version)}}}class sK extends _q{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const i=e/2,a=t/2,s=Math.floor(n),o=Math.floor(r),l=s+1,u=o+1,c=e/s,d=t/o,h=[],p=[],f=[],m=[];for(let g=0;g<u;g++){const e=g*d-a;for(let t=0;t<l;t++){const n=t*c-i;p.push(n,-e,0),f.push(0,0,1),m.push(t/s),m.push(1-g/o)}}for(let g=0;g<o;g++)for(let e=0;e<s;e++){const t=e+l*g,n=e+l*(g+1),r=e+1+l*(g+1),i=e+1+l*g;h.push(t,n,i),h.push(n,r,i)}this.setIndex(h),this.setAttribute("position",new dq(p,3)),this.setAttribute("normal",new dq(f,3)),this.setAttribute("uv",new dq(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new sK(e.width,e.height,e.widthSegments,e.heightSegments)}}const oK={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\t return vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat R21 = R12;\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tanisotropyV /= material.anisotropy;\n\tmaterial.anisotropy = saturate( material.anisotropy );\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometry.viewDir, geometry.normal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, vMapUv );\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal, vNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#ifdef USE_UV\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},lK={common:{diffuse:{value:new eq(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new u$},alphaMap:{value:null},alphaMapTransform:{value:new u$},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new u$}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new u$}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new u$}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new u$},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new u$},normalScale:{value:new l$(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new u$},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new u$}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new u$}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new u$}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new eq(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new eq(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new u$},alphaTest:{value:0},uvTransform:{value:new u$}},sprite:{diffuse:{value:new eq(16777215)},opacity:{value:1},center:{value:new l$(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new u$},alphaMap:{value:null},alphaMapTransform:{value:new u$},alphaTest:{value:0}}},uK={basic:{uniforms:Vq([lK.common,lK.specularmap,lK.envmap,lK.aomap,lK.lightmap,lK.fog]),vertexShader:oK.meshbasic_vert,fragmentShader:oK.meshbasic_frag},lambert:{uniforms:Vq([lK.common,lK.specularmap,lK.envmap,lK.aomap,lK.lightmap,lK.emissivemap,lK.bumpmap,lK.normalmap,lK.displacementmap,lK.fog,lK.lights,{emissive:{value:new eq(0)}}]),vertexShader:oK.meshlambert_vert,fragmentShader:oK.meshlambert_frag},phong:{uniforms:Vq([lK.common,lK.specularmap,lK.envmap,lK.aomap,lK.lightmap,lK.emissivemap,lK.bumpmap,lK.normalmap,lK.displacementmap,lK.fog,lK.lights,{emissive:{value:new eq(0)},specular:{value:new eq(1118481)},shininess:{value:30}}]),vertexShader:oK.meshphong_vert,fragmentShader:oK.meshphong_frag},standard:{uniforms:Vq([lK.common,lK.envmap,lK.aomap,lK.lightmap,lK.emissivemap,lK.bumpmap,lK.normalmap,lK.displacementmap,lK.roughnessmap,lK.metalnessmap,lK.fog,lK.lights,{emissive:{value:new eq(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:oK.meshphysical_vert,fragmentShader:oK.meshphysical_frag},toon:{uniforms:Vq([lK.common,lK.aomap,lK.lightmap,lK.emissivemap,lK.bumpmap,lK.normalmap,lK.displacementmap,lK.gradientmap,lK.fog,lK.lights,{emissive:{value:new eq(0)}}]),vertexShader:oK.meshtoon_vert,fragmentShader:oK.meshtoon_frag},matcap:{uniforms:Vq([lK.common,lK.bumpmap,lK.normalmap,lK.displacementmap,lK.fog,{matcap:{value:null}}]),vertexShader:oK.meshmatcap_vert,fragmentShader:oK.meshmatcap_frag},points:{uniforms:Vq([lK.points,lK.fog]),vertexShader:oK.points_vert,fragmentShader:oK.points_frag},dashed:{uniforms:Vq([lK.common,lK.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:oK.linedashed_vert,fragmentShader:oK.linedashed_frag},depth:{uniforms:Vq([lK.common,lK.displacementmap]),vertexShader:oK.depth_vert,fragmentShader:oK.depth_frag},normal:{uniforms:Vq([lK.common,lK.bumpmap,lK.normalmap,lK.displacementmap,{opacity:{value:1}}]),vertexShader:oK.meshnormal_vert,fragmentShader:oK.meshnormal_frag},sprite:{uniforms:Vq([lK.sprite,lK.fog]),vertexShader:oK.sprite_vert,fragmentShader:oK.sprite_frag},background:{uniforms:{uvTransform:{value:new u$},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:oK.background_vert,fragmentShader:oK.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:oK.backgroundCube_vert,fragmentShader:oK.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:oK.cube_vert,fragmentShader:oK.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:oK.equirect_vert,fragmentShader:oK.equirect_frag},distanceRGBA:{uniforms:Vq([lK.common,lK.displacementmap,{referencePosition:{value:new I$},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:oK.distanceRGBA_vert,fragmentShader:oK.distanceRGBA_frag},shadow:{uniforms:Vq([lK.lights,lK.fog,{color:{value:new eq(0)},opacity:{value:1}}]),vertexShader:oK.shadow_vert,fragmentShader:oK.shadow_frag}};uK.physical={uniforms:Vq([uK.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new u$},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new u$},clearcoatNormalScale:{value:new l$(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new u$},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new u$},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new u$},sheen:{value:0},sheenColor:{value:new eq(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new u$},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new u$},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new u$},transmissionSamplerSize:{value:new l$},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new u$},attenuationDistance:{value:0},attenuationColor:{value:new eq(0)},specularColor:{value:new eq(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new u$},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new u$},anisotropyVector:{value:new l$},anisotropyMap:{value:null},anisotropyMapTransform:{value:new u$}}]),vertexShader:oK.meshphysical_vert,fragmentShader:oK.meshphysical_frag};const cK={r:0,b:0,g:0};function dK(e,t,n,r,i,a,s){const o=new eq(0);let l,u,c=!0===a?0:1,d=null,h=0,p=null;function f(t,n){t.getRGB(cK,Gq(e)),r.buffers.color.setClear(cK.r,cK.g,cK.b,n,s)}return{getClearColor:function(){return o},setClearColor:function(e,t=1){o.set(e),c=t,f(o,c)},getClearAlpha:function(){return c},setClearAlpha:function(e){c=e,f(o,c)},render:function(a,m){let g=!1,v=!0===m.isScene?m.background:null;if(v&&v.isTexture){v=(m.backgroundBlurriness>0?n:t).get(v)}switch(null===v?f(o,c):v&&v.isColor&&(f(v,1),g=!0),e.xr.getEnvironmentBlendMode()){case"opaque":g=!0;break;case"additive":r.buffers.color.setClear(0,0,0,1,s),g=!0;break;case"alpha-blend":r.buffers.color.setClear(0,0,0,0,s),g=!0}(e.autoClear||g)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),v&&(v.isCubeTexture||v.mapping===aY)?(void 0===u&&(u=new Bq(new zq(1,1,1),new jq({name:"BackgroundCubeMaterial",uniforms:Fq(uK.backgroundCube.uniforms),vertexShader:uK.backgroundCube.vertexShader,fragmentShader:uK.backgroundCube.fragmentShader,side:YW,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(u)),u.material.uniforms.envMap.value=v,u.material.uniforms.flipEnvMap.value=v.isCubeTexture&&!1===v.isRenderTargetTexture?-1:1,u.material.uniforms.backgroundBlurriness.value=m.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,u.material.toneMapped=v.colorSpace!==UY,d===v&&h===v.version&&p===e.toneMapping||(u.material.needsUpdate=!0,d=v,h=v.version,p=e.toneMapping),u.layers.enableAll(),a.unshift(u,u.geometry,u.material,0,0,null)):v&&v.isTexture&&(void 0===l&&(l=new Bq(new sK(2,2),new jq({name:"BackgroundMaterial",uniforms:Fq(uK.background.uniforms),vertexShader:uK.background.vertexShader,fragmentShader:uK.background.fragmentShader,side:WW,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(l)),l.material.uniforms.t2D.value=v,l.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,l.material.toneMapped=v.colorSpace!==UY,!0===v.matrixAutoUpdate&&v.updateMatrix(),l.material.uniforms.uvTransform.value.copy(v.matrix),d===v&&h===v.version&&p===e.toneMapping||(l.material.needsUpdate=!0,d=v,h=v.version,p=e.toneMapping),l.layers.enableAll(),a.unshift(l,l.geometry,l.material,0,0,null))}}}function hK(e,t,n,r){const i=e.getParameter(e.MAX_VERTEX_ATTRIBS),a=r.isWebGL2?null:t.get("OES_vertex_array_object"),s=r.isWebGL2||null!==a,o={},l=p(null);let u=l,c=!1;function d(t){return r.isWebGL2?e.bindVertexArray(t):a.bindVertexArrayOES(t)}function h(t){return r.isWebGL2?e.deleteVertexArray(t):a.deleteVertexArrayOES(t)}function p(e){const t=[],n=[],r=[];for(let a=0;a<i;a++)t[a]=0,n[a]=0,r[a]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:n,attributeDivisors:r,object:e,attributes:{},index:null}}function f(){const e=u.newAttributes;for(let t=0,n=e.length;t<n;t++)e[t]=0}function m(e){g(e,0)}function g(n,i){const a=u.newAttributes,s=u.enabledAttributes,o=u.attributeDivisors;if(a[n]=1,0===s[n]&&(e.enableVertexAttribArray(n),s[n]=1),o[n]!==i){(r.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),o[n]=i}}function v(){const t=u.newAttributes,n=u.enabledAttributes;for(let r=0,i=n.length;r<i;r++)n[r]!==t[r]&&(e.disableVertexAttribArray(r),n[r]=0)}function y(t,n,r,i,a,s,o){!0===o?e.vertexAttribIPointer(t,n,r,a,s):e.vertexAttribPointer(t,n,r,i,a,s)}function _(){b(),c=!0,u!==l&&(u=l,d(u.object))}function b(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(i,l,h,_,b){let x=!1;if(s){const t=function(t,n,i){const s=!0===i.wireframe;let l=o[t.id];void 0===l&&(l={},o[t.id]=l);let u=l[n.id];void 0===u&&(u={},l[n.id]=u);let c=u[s];void 0===c&&(c=p(r.isWebGL2?e.createVertexArray():a.createVertexArrayOES()),u[s]=c);return c}(_,h,l);u!==t&&(u=t,d(u.object)),x=function(e,t,n,r){const i=u.attributes,a=t.attributes;let s=0;const o=n.getAttributes();for(const l in o){if(o[l].location>=0){const t=i[l];let n=a[l];if(void 0===n&&("instanceMatrix"===l&&e.instanceMatrix&&(n=e.instanceMatrix),"instanceColor"===l&&e.instanceColor&&(n=e.instanceColor)),void 0===t)return!0;if(t.attribute!==n)return!0;if(n&&t.data!==n.data)return!0;s++}}return u.attributesNum!==s||u.index!==r}(i,_,h,b),x&&function(e,t,n,r){const i={},a=t.attributes;let s=0;const o=n.getAttributes();for(const l in o){if(o[l].location>=0){let t=a[l];void 0===t&&("instanceMatrix"===l&&e.instanceMatrix&&(t=e.instanceMatrix),"instanceColor"===l&&e.instanceColor&&(t=e.instanceColor));const n={};n.attribute=t,t&&t.data&&(n.data=t.data),i[l]=n,s++}}u.attributes=i,u.attributesNum=s,u.index=r}(i,_,h,b)}else{const e=!0===l.wireframe;u.geometry===_.id&&u.program===h.id&&u.wireframe===e||(u.geometry=_.id,u.program=h.id,u.wireframe=e,x=!0)}null!==b&&n.update(b,e.ELEMENT_ARRAY_BUFFER),(x||c)&&(c=!1,function(i,a,s,o){if(!1===r.isWebGL2&&(i.isInstancedMesh||o.isInstancedBufferGeometry)&&null===t.get("ANGLE_instanced_arrays"))return;f();const l=o.attributes,u=s.getAttributes(),c=a.defaultAttributeValues;for(const t in u){const a=u[t];if(a.location>=0){let s=l[t];if(void 0===s&&("instanceMatrix"===t&&i.instanceMatrix&&(s=i.instanceMatrix),"instanceColor"===t&&i.instanceColor&&(s=i.instanceColor)),void 0!==s){const t=s.normalized,l=s.itemSize,u=n.get(s);if(void 0===u)continue;const c=u.buffer,d=u.type,h=u.bytesPerElement,p=!0===r.isWebGL2&&(d===e.INT||d===e.UNSIGNED_INT||s.gpuType===gY);if(s.isInterleavedBufferAttribute){const n=s.data,r=n.stride,u=s.offset;if(n.isInstancedInterleavedBuffer){for(let e=0;e<a.locationSize;e++)g(a.location+e,n.meshPerAttribute);!0!==i.isInstancedMesh&&void 0===o._maxInstanceCount&&(o._maxInstanceCount=n.meshPerAttribute*n.count)}else for(let e=0;e<a.locationSize;e++)m(a.location+e);e.bindBuffer(e.ARRAY_BUFFER,c);for(let e=0;e<a.locationSize;e++)y(a.location+e,l/a.locationSize,d,t,r*h,(u+l/a.locationSize*e)*h,p)}else{if(s.isInstancedBufferAttribute){for(let e=0;e<a.locationSize;e++)g(a.location+e,s.meshPerAttribute);!0!==i.isInstancedMesh&&void 0===o._maxInstanceCount&&(o._maxInstanceCount=s.meshPerAttribute*s.count)}else for(let e=0;e<a.locationSize;e++)m(a.location+e);e.bindBuffer(e.ARRAY_BUFFER,c);for(let e=0;e<a.locationSize;e++)y(a.location+e,l/a.locationSize,d,t,l*h,l/a.locationSize*e*h,p)}}else if(void 0!==c){const n=c[t];if(void 0!==n)switch(n.length){case 2:e.vertexAttrib2fv(a.location,n);break;case 3:e.vertexAttrib3fv(a.location,n);break;case 4:e.vertexAttrib4fv(a.location,n);break;default:e.vertexAttrib1fv(a.location,n)}}}}v()}(i,l,h,_),null!==b&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n.get(b).buffer))},reset:_,resetDefaultState:b,dispose:function(){_();for(const e in o){const t=o[e];for(const e in t){const n=t[e];for(const e in n)h(n[e].object),delete n[e];delete t[e]}delete o[e]}},releaseStatesOfGeometry:function(e){if(void 0===o[e.id])return;const t=o[e.id];for(const n in t){const e=t[n];for(const t in e)h(e[t].object),delete e[t];delete t[n]}delete o[e.id]},releaseStatesOfProgram:function(e){for(const t in o){const n=o[t];if(void 0===n[e.id])continue;const r=n[e.id];for(const e in r)h(r[e].object),delete r[e];delete n[e.id]}},initAttributes:f,enableAttribute:m,disableUnusedAttributes:v}}function pK(e,t,n,r){const i=r.isWebGL2;let a;this.setMode=function(e){a=e},this.render=function(t,r){e.drawArrays(a,t,r),n.update(r,a,1)},this.renderInstances=function(r,s,o){if(0===o)return;let l,u;if(i)l=e,u="drawArraysInstanced";else if(l=t.get("ANGLE_instanced_arrays"),u="drawArraysInstancedANGLE",null===l)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[u](a,r,s,o),n.update(s,a,o)}}function fK(e,t,n){let r;function i(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const a="undefined"!=typeof WebGL2RenderingContext&&"WebGL2RenderingContext"===e.constructor.name;let s=void 0!==n.precision?n.precision:"highp";const o=i(s);o!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",o,"instead."),s=o);const l=a||t.has("WEBGL_draw_buffers"),u=!0===n.logarithmicDepthBuffer,c=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),d=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),h=e.getParameter(e.MAX_TEXTURE_SIZE),p=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),f=e.getParameter(e.MAX_VERTEX_ATTRIBS),m=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),g=e.getParameter(e.MAX_VARYING_VECTORS),v=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),y=d>0,_=a||t.has("OES_texture_float");return{isWebGL2:a,drawBuffers:l,getMaxAnisotropy:function(){if(void 0!==r)return r;if(!0===t.has("EXT_texture_filter_anisotropic")){const n=t.get("EXT_texture_filter_anisotropic");r=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:i,precision:s,logarithmicDepthBuffer:u,maxTextures:c,maxVertexTextures:d,maxTextureSize:h,maxCubemapSize:p,maxAttributes:f,maxVertexUniforms:m,maxVaryings:g,maxFragmentUniforms:v,vertexTextures:y,floatFragmentTextures:_,floatVertexTextures:y&&_,maxSamples:a?e.getParameter(e.MAX_SAMPLES):0}}function mK(e){const t=this;let n=null,r=0,i=!1,a=!1;const s=new eK,o=new u$,l={value:null,needsUpdate:!1};function u(e,n,r,i){const a=null!==e?e.length:0;let u=null;if(0!==a){if(u=l.value,!0!==i||null===u){const t=r+4*a,i=n.matrixWorldInverse;o.getNormalMatrix(i),(null===u||u.length<t)&&(u=new Float32Array(t));for(let n=0,l=r;n!==a;++n,l+=4)s.copy(e[n]).applyMatrix4(i,o),s.normal.toArray(u,l),u[l+3]=s.constant}l.value=u,l.needsUpdate=!0}return t.numPlanes=a,t.numIntersection=0,u}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t){const n=0!==e.length||t||0!==r||i;return i=t,r=e.length,n},this.beginShadows=function(){a=!0,u(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(e,t){n=u(e,t,0)},this.setState=function(s,o,c){const d=s.clippingPlanes,h=s.clipIntersection,p=s.clipShadows,f=e.get(s);if(!i||null===d||0===d.length||a&&!p)a?u(null):function(){l.value!==n&&(l.value=n,l.needsUpdate=r>0);t.numPlanes=r,t.numIntersection=0}();else{const e=a?0:r,t=4*e;let i=f.clippingState||null;l.value=i,i=u(d,o,t,c);for(let r=0;r!==t;++r)i[r]=n[r];f.clippingState=i,this.numIntersection=h?this.numPlanes:0,this.numPlanes+=e}}}function gK(e){let t=new WeakMap;function n(e,t){return 303===t?e.mapping=rY:304===t&&(e.mapping=iY),e}function r(e){const n=e.target;n.removeEventListener("dispose",r);const i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture&&!1===i.isRenderTargetTexture){const a=i.mapping;if(303===a||304===a){if(t.has(i)){return n(t.get(i).texture,i.mapping)}{const a=i.image;if(a&&a.height>0){const s=new Kq(a.height/2);return s.fromEquirectangularTexture(e,i),t.set(i,s),i.addEventListener("dispose",r),n(s.texture,i.mapping)}return null}}}return i},dispose:function(){t=new WeakMap}}}class vK extends Wq{constructor(e=-1,t=1,n=1,r=-1,i=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=i,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,i,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let i=n-e,a=n+e,s=r+t,o=r-t;if(null!==this.view&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=e*this.view.offsetX,a=i+e*this.view.width,s-=t*this.view.offsetY,o=s-t*this.view.height}this.projectionMatrix.makeOrthographic(i,a,s,o,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const yK=[.125,.215,.35,.446,.526,.582],_K=20,bK=new vK,xK=new eq;let wK=null;const SK=(1+Math.sqrt(5))/2,CK=1/SK,TK=[new I$(1,1,1),new I$(-1,1,1),new I$(1,1,-1),new I$(-1,1,-1),new I$(0,SK,CK),new I$(0,SK,-CK),new I$(CK,0,SK),new I$(-CK,0,SK),new I$(SK,CK,0),new I$(-SK,CK,0)];class MK{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,r=100){wK=this._renderer.getRenderTarget(),this._setSize(256);const i=this._allocateTargets();return i.depthBuffer=!0,this._sceneToCubeUV(e,n,r,i),t>0&&this._blur(i,0,0,t),this._applyPMREM(i),this._cleanup(i),i}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=RK(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=PK(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(wK),e.scissorTest=!1,AK(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===rY||e.mapping===iY?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),wK=this._renderer.getRenderTarget();const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:hY,minFilter:hY,generateMipmaps:!1,type:_Y,format:xY,colorSpace:zY,depthBuffer:!1},r=EK(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=EK(e,t,n);const{_lodMax:r}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(e){const t=[],n=[],r=[];let i=e;const a=e-4+1+yK.length;for(let s=0;s<a;s++){const a=Math.pow(2,i);n.push(a);let o=1/a;s>e-4?o=yK[s-e+4-1]:0===s&&(o=0),r.push(o);const l=1/(a-2),u=-l,c=1+l,d=[u,u,c,u,c,c,u,u,c,c,u,c],h=6,p=6,f=3,m=2,g=1,v=new Float32Array(f*p*h),y=new Float32Array(m*p*h),_=new Float32Array(g*p*h);for(let e=0;e<h;e++){const t=e%3*2/3-1,n=e>2?0:-1,r=[t,n,0,t+2/3,n,0,t+2/3,n+1,0,t,n,0,t+2/3,n+1,0,t,n+1,0];v.set(r,f*p*e),y.set(d,m*p*e);const i=[e,e,e,e,e,e];_.set(i,g*p*e)}const b=new _q;b.setAttribute("position",new lq(v,f)),b.setAttribute("uv",new lq(y,m)),b.setAttribute("faceIndex",new lq(_,g)),t.push(b),i>4&&i--}return{lodPlanes:t,sizeLods:n,sigmas:r}}(r)),this._blurMaterial=function(e,t,n){const r=new Float32Array(_K),i=new I$(0,1,0),a=new jq({name:"SphericalGaussianBlur",defines:{n:_K,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:LK(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1});return a}(r,e,t)}return r}_compileMaterial(e){const t=new Bq(this._lodPlanes[0],e);this._renderer.compile(t,bK)}_sceneToCubeUV(e,t,n,r){const i=new Yq(90,1,t,n),a=[1,-1,1,1,1,1],s=[1,1,1,-1,-1,-1],o=this._renderer,l=o.autoClear,u=o.toneMapping;o.getClearColor(xK),o.toneMapping=ZW,o.autoClear=!1;const c=new nq({name:"PMREM.Background",side:YW,depthWrite:!1,depthTest:!1}),d=new Bq(new zq,c);let h=!1;const p=e.background;p?p.isColor&&(c.color.copy(p),e.background=null,h=!0):(c.color.copy(xK),h=!0);for(let f=0;f<6;f++){const t=f%3;0===t?(i.up.set(0,a[f],0),i.lookAt(s[f],0,0)):1===t?(i.up.set(0,0,a[f]),i.lookAt(0,s[f],0)):(i.up.set(0,a[f],0),i.lookAt(0,0,s[f]));const n=this._cubeSize;AK(r,t*n,f>2?n:0,n,n),o.setRenderTarget(r),h&&o.render(d,i),o.render(e,i)}d.geometry.dispose(),d.material.dispose(),o.toneMapping=u,o.autoClear=l,e.background=p}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===rY||e.mapping===iY;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=RK()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=PK());const i=r?this._cubemapMaterial:this._equirectMaterial,a=new Bq(this._lodPlanes[0],i);i.uniforms.envMap.value=e;const s=this._cubeSize;AK(t,0,0,3*s,2*s),n.setRenderTarget(t),n.render(a,bK)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const t=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),n=TK[(r-1)%TK.length];this._blur(e,r-1,r,t,n)}t.autoClear=n}_blur(e,t,n,r,i){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,r,"latitudinal",i),this._halfBlur(a,e,n,n,r,"longitudinal",i)}_halfBlur(e,t,n,r,i,a,s){const o=this._renderer,l=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");const u=new Bq(this._lodPlanes[r],l),c=l.uniforms,d=this._sizeLods[n]-1,h=isFinite(i)?Math.PI/(2*d):2*Math.PI/39,p=i/h,f=isFinite(i)?1+Math.floor(3*p):_K;f>_K&&console.warn(`sigmaRadians, ${i}, is too large and will clip, as it requested ${f} samples when the maximum is set to 20`);const m=[];let g=0;for(let _=0;_<_K;++_){const e=_/p,t=Math.exp(-e*e/2);m.push(t),0===_?g+=t:_<f&&(g+=2*t)}for(let _=0;_<m.length;_++)m[_]=m[_]/g;c.envMap.value=e.texture,c.samples.value=f,c.weights.value=m,c.latitudinal.value="latitudinal"===a,s&&(c.poleAxis.value=s);const{_lodMax:v}=this;c.dTheta.value=h,c.mipInt.value=v-n;const y=this._sizeLods[r];AK(t,3*y*(r>v-4?r-v+4:0),4*(this._cubeSize-y),3*y,2*y),o.setRenderTarget(t),o.render(u,bK)}}function EK(e,t,n){const r=new R$(e,t,n);return r.texture.mapping=aY,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function AK(e,t,n,r,i){e.viewport.set(t,n,r,i),e.scissor.set(t,n,r,i)}function PK(){return new jq({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:LK(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function RK(){return new jq({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:LK(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function LK(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t"}function kK(e){let t=new WeakMap,n=null;function r(e){const n=e.target;n.removeEventListener("dispose",r);const i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture){const a=i.mapping,s=303===a||304===a,o=a===rY||a===iY;if(s||o){if(i.isRenderTargetTexture&&!0===i.needsPMREMUpdate){i.needsPMREMUpdate=!1;let r=t.get(i);return null===n&&(n=new MK(e)),r=s?n.fromEquirectangular(i,r):n.fromCubemap(i,r),t.set(i,r),r.texture}if(t.has(i))return t.get(i).texture;{const a=i.image;if(s&&a&&a.height>0||o&&a&&function(e){let t=0;const n=6;for(let r=0;r<n;r++)void 0!==e[r]&&t++;return t===n}(a)){null===n&&(n=new MK(e));const a=s?n.fromEquirectangular(i):n.fromCubemap(i);return t.set(i,a),i.addEventListener("dispose",r),a.texture}return null}}}return i},dispose:function(){t=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function DK(e){const t={};function n(n){if(void 0!==t[n])return t[n];let r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return t[n]=r,r}return{has:function(e){return null!==n(e)},init:function(e){e.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(e){const t=n(e);return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function IK(e,t,n,r){const i={},a=new WeakMap;function s(e){const o=e.target;null!==o.index&&t.remove(o.index);for(const n in o.attributes)t.remove(o.attributes[n]);for(const n in o.morphAttributes){const e=o.morphAttributes[n];for(let n=0,r=e.length;n<r;n++)t.remove(e[n])}o.removeEventListener("dispose",s),delete i[o.id];const l=a.get(o);l&&(t.remove(l),a.delete(o)),r.releaseStatesOfGeometry(o),!0===o.isInstancedBufferGeometry&&delete o._maxInstanceCount,n.memory.geometries--}function o(e){const n=[],r=e.index,i=e.attributes.position;let s=0;if(null!==r){const e=r.array;s=r.version;for(let t=0,r=e.length;t<r;t+=3){const r=e[t+0],i=e[t+1],a=e[t+2];n.push(r,i,i,a,a,r)}}else{const e=i.array;s=i.version;for(let t=0,r=e.length/3-1;t<r;t+=3){const e=t+0,r=t+1,i=t+2;n.push(e,r,r,i,i,e)}}const o=new(d$(n)?cq:uq)(n,1);o.version=s;const l=a.get(e);l&&t.remove(l),a.set(e,o)}return{get:function(e,t){return!0===i[t.id]||(t.addEventListener("dispose",s),i[t.id]=!0,n.memory.geometries++),t},update:function(n){const r=n.attributes;for(const a in r)t.update(r[a],e.ARRAY_BUFFER);const i=n.morphAttributes;for(const a in i){const n=i[a];for(let r=0,i=n.length;r<i;r++)t.update(n[r],e.ARRAY_BUFFER)}},getWireframeAttribute:function(e){const t=a.get(e);if(t){const n=e.index;null!==n&&t.version<n.version&&o(e)}else o(e);return a.get(e)}}}function OK(e,t,n,r){const i=r.isWebGL2;let a,s,o;this.setMode=function(e){a=e},this.setIndex=function(e){s=e.type,o=e.bytesPerElement},this.render=function(t,r){e.drawElements(a,r,s,t*o),n.update(r,a,1)},this.renderInstances=function(r,l,u){if(0===u)return;let c,d;if(i)c=e,d="drawElementsInstanced";else if(c=t.get("ANGLE_instanced_arrays"),d="drawElementsInstancedANGLE",null===c)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");c[d](a,l,s,r*o,u),n.update(l,a,u)}}function NK(e){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(n,r,i){switch(t.calls++,r){case e.TRIANGLES:t.triangles+=i*(n/3);break;case e.LINES:t.lines+=i*(n/2);break;case e.LINE_STRIP:t.lines+=i*(n-1);break;case e.LINE_LOOP:t.lines+=i*n;break;case e.POINTS:t.points+=i*n;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",r)}}}}function BK(e,t){return e[0]-t[0]}function UK(e,t){return Math.abs(t[1])-Math.abs(e[1])}function zK(e,t,n){const r={},i=new Float32Array(8),a=new WeakMap,s=new P$,o=[];for(let l=0;l<8;l++)o[l]=[l,0];return{update:function(l,u,c){const d=l.morphTargetInfluences;if(!0===t.isWebGL2){const r=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,i=void 0!==r?r.length:0;let o=a.get(u);if(void 0===o||o.count!==i){let e=function(){v.dispose(),a.delete(u),u.removeEventListener("dispose",e)};void 0!==o&&o.texture.dispose();const n=void 0!==u.morphAttributes.position,r=void 0!==u.morphAttributes.normal,l=void 0!==u.morphAttributes.color,c=u.morphAttributes.position||[],d=u.morphAttributes.normal||[],h=u.morphAttributes.color||[];let p=0;!0===n&&(p=1),!0===r&&(p=2),!0===l&&(p=3);let f=u.attributes.position.count*p,m=1;f>t.maxTextureSize&&(m=Math.ceil(f/t.maxTextureSize),f=t.maxTextureSize);const g=new Float32Array(f*m*4*i),v=new L$(g,f,m,i);v.type=yY,v.needsUpdate=!0;const y=4*p;for(let t=0;t<i;t++){const e=c[t],i=d[t],a=h[t],o=f*m*4*t;for(let t=0;t<e.count;t++){const u=t*y;!0===n&&(s.fromBufferAttribute(e,t),g[o+u+0]=s.x,g[o+u+1]=s.y,g[o+u+2]=s.z,g[o+u+3]=0),!0===r&&(s.fromBufferAttribute(i,t),g[o+u+4]=s.x,g[o+u+5]=s.y,g[o+u+6]=s.z,g[o+u+7]=0),!0===l&&(s.fromBufferAttribute(a,t),g[o+u+8]=s.x,g[o+u+9]=s.y,g[o+u+10]=s.z,g[o+u+11]=4===a.itemSize?s.w:1)}}o={count:i,texture:v,size:new l$(f,m)},a.set(u,o),u.addEventListener("dispose",e)}let l=0;for(let e=0;e<d.length;e++)l+=d[e];const h=u.morphTargetsRelative?1:1-l;c.getUniforms().setValue(e,"morphTargetBaseInfluence",h),c.getUniforms().setValue(e,"morphTargetInfluences",d),c.getUniforms().setValue(e,"morphTargetsTexture",o.texture,n),c.getUniforms().setValue(e,"morphTargetsTextureSize",o.size)}else{const t=void 0===d?0:d.length;let n=r[u.id];if(void 0===n||n.length!==t){n=[];for(let e=0;e<t;e++)n[e]=[e,0];r[u.id]=n}for(let e=0;e<t;e++){const t=n[e];t[0]=e,t[1]=d[e]}n.sort(UK);for(let e=0;e<8;e++)e<t&&n[e][1]?(o[e][0]=n[e][0],o[e][1]=n[e][1]):(o[e][0]=Number.MAX_SAFE_INTEGER,o[e][1]=0);o.sort(BK);const a=u.morphAttributes.position,s=u.morphAttributes.normal;let l=0;for(let e=0;e<8;e++){const t=o[e],n=t[0],r=t[1];n!==Number.MAX_SAFE_INTEGER&&r?(a&&u.getAttribute("morphTarget"+e)!==a[n]&&u.setAttribute("morphTarget"+e,a[n]),s&&u.getAttribute("morphNormal"+e)!==s[n]&&u.setAttribute("morphNormal"+e,s[n]),i[e]=r,l+=r):(a&&!0===u.hasAttribute("morphTarget"+e)&&u.deleteAttribute("morphTarget"+e),s&&!0===u.hasAttribute("morphNormal"+e)&&u.deleteAttribute("morphNormal"+e),i[e]=0)}const h=u.morphTargetsRelative?1:1-l;c.getUniforms().setValue(e,"morphTargetBaseInfluence",h),c.getUniforms().setValue(e,"morphTargetInfluences",i)}}}}function FK(e,t,n,r){let i=new WeakMap;function a(e){const t=e.target;t.removeEventListener("dispose",a),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(s){const o=r.render.frame,l=s.geometry,u=t.get(s,l);return i.get(u)!==o&&(t.update(u),i.set(u,o)),s.isInstancedMesh&&(!1===s.hasEventListener("dispose",a)&&s.addEventListener("dispose",a),n.update(s.instanceMatrix,e.ARRAY_BUFFER),null!==s.instanceColor&&n.update(s.instanceColor,e.ARRAY_BUFFER)),u},dispose:function(){i=new WeakMap}}}const VK=new A$,GK=new L$,HK=new k$,jK=new qq,WK=[],YK=[],$K=new Float32Array(16),XK=new Float32Array(9),qK=new Float32Array(4);function KK(e,t,n){const r=e[0];if(r<=0||r>0)return e;const i=t*n;let a=WK[i];if(void 0===a&&(a=new Float32Array(i),WK[i]=a),0!==t){r.toArray(a,0);for(let r=1,i=0;r!==t;++r)i+=n,e[r].toArray(a,i)}return a}function ZK(e,t){if(e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function JK(e,t){for(let n=0,r=t.length;n<r;n++)e[n]=t[n]}function QK(e,t){let n=YK[t];void 0===n&&(n=new Int32Array(t),YK[t]=n);for(let r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function eZ(e,t){const n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function tZ(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(ZK(n,t))return;e.uniform2fv(this.addr,t),JK(n,t)}}function nZ(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(ZK(n,t))return;e.uniform3fv(this.addr,t),JK(n,t)}}function rZ(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(ZK(n,t))return;e.uniform4fv(this.addr,t),JK(n,t)}}function iZ(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(ZK(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),JK(n,t)}else{if(ZK(n,r))return;qK.set(r),e.uniformMatrix2fv(this.addr,!1,qK),JK(n,r)}}function aZ(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(ZK(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),JK(n,t)}else{if(ZK(n,r))return;XK.set(r),e.uniformMatrix3fv(this.addr,!1,XK),JK(n,r)}}function sZ(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(ZK(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),JK(n,t)}else{if(ZK(n,r))return;$K.set(r),e.uniformMatrix4fv(this.addr,!1,$K),JK(n,r)}}function oZ(e,t){const n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function lZ(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2i(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(ZK(n,t))return;e.uniform2iv(this.addr,t),JK(n,t)}}function uZ(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3i(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(ZK(n,t))return;e.uniform3iv(this.addr,t),JK(n,t)}}function cZ(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(ZK(n,t))return;e.uniform4iv(this.addr,t),JK(n,t)}}function dZ(e,t){const n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function hZ(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2ui(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(ZK(n,t))return;e.uniform2uiv(this.addr,t),JK(n,t)}}function pZ(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3ui(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(ZK(n,t))return;e.uniform3uiv(this.addr,t),JK(n,t)}}function fZ(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(ZK(n,t))return;e.uniform4uiv(this.addr,t),JK(n,t)}}function mZ(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2D(t||VK,i)}function gZ(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||HK,i)}function vZ(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTextureCube(t||jK,i)}function yZ(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||GK,i)}function _Z(e,t){e.uniform1fv(this.addr,t)}function bZ(e,t){const n=KK(t,this.size,2);e.uniform2fv(this.addr,n)}function xZ(e,t){const n=KK(t,this.size,3);e.uniform3fv(this.addr,n)}function wZ(e,t){const n=KK(t,this.size,4);e.uniform4fv(this.addr,n)}function SZ(e,t){const n=KK(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function CZ(e,t){const n=KK(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function TZ(e,t){const n=KK(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function MZ(e,t){e.uniform1iv(this.addr,t)}function EZ(e,t){e.uniform2iv(this.addr,t)}function AZ(e,t){e.uniform3iv(this.addr,t)}function PZ(e,t){e.uniform4iv(this.addr,t)}function RZ(e,t){e.uniform1uiv(this.addr,t)}function LZ(e,t){e.uniform2uiv(this.addr,t)}function kZ(e,t){e.uniform3uiv(this.addr,t)}function DZ(e,t){e.uniform4uiv(this.addr,t)}function IZ(e,t,n){const r=this.cache,i=t.length,a=QK(n,i);ZK(r,a)||(e.uniform1iv(this.addr,a),JK(r,a));for(let s=0;s!==i;++s)n.setTexture2D(t[s]||VK,a[s])}function OZ(e,t,n){const r=this.cache,i=t.length,a=QK(n,i);ZK(r,a)||(e.uniform1iv(this.addr,a),JK(r,a));for(let s=0;s!==i;++s)n.setTexture3D(t[s]||HK,a[s])}function NZ(e,t,n){const r=this.cache,i=t.length,a=QK(n,i);ZK(r,a)||(e.uniform1iv(this.addr,a),JK(r,a));for(let s=0;s!==i;++s)n.setTextureCube(t[s]||jK,a[s])}function BZ(e,t,n){const r=this.cache,i=t.length,a=QK(n,i);ZK(r,a)||(e.uniform1iv(this.addr,a),JK(r,a));for(let s=0;s!==i;++s)n.setTexture2DArray(t[s]||GK,a[s])}class UZ{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(e){switch(e){case 5126:return eZ;case 35664:return tZ;case 35665:return nZ;case 35666:return rZ;case 35674:return iZ;case 35675:return aZ;case 35676:return sZ;case 5124:case 35670:return oZ;case 35667:case 35671:return lZ;case 35668:case 35672:return uZ;case 35669:case 35673:return cZ;case 5125:return dZ;case 36294:return hZ;case 36295:return pZ;case 36296:return fZ;case 35678:case 36198:case 36298:case 36306:case 35682:return mZ;case 35679:case 36299:case 36307:return gZ;case 35680:case 36300:case 36308:case 36293:return vZ;case 36289:case 36303:case 36311:case 36292:return yZ}}(t.type)}}class zZ{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return _Z;case 35664:return bZ;case 35665:return xZ;case 35666:return wZ;case 35674:return SZ;case 35675:return CZ;case 35676:return TZ;case 5124:case 35670:return MZ;case 35667:case 35671:return EZ;case 35668:case 35672:return AZ;case 35669:case 35673:return PZ;case 5125:return RZ;case 36294:return LZ;case 36295:return kZ;case 36296:return DZ;case 35678:case 36198:case 36298:case 36306:case 35682:return IZ;case 35679:case 36299:case 36307:return OZ;case 35680:case 36300:case 36308:case 36293:return NZ;case 36289:case 36303:case 36311:case 36292:return BZ}}(t.type)}}class FZ{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let i=0,a=r.length;i!==a;++i){const a=r[i];a.setValue(e,t[a.id],n)}}}const VZ=/(\w+)(\])?(\[|\.)?/g;function GZ(e,t){e.seq.push(t),e.map[t.id]=t}function HZ(e,t,n){const r=e.name,i=r.length;for(VZ.lastIndex=0;;){const a=VZ.exec(r),s=VZ.lastIndex;let o=a[1];const l="]"===a[2],u=a[3];if(l&&(o|=0),void 0===u||"["===u&&s+2===i){GZ(n,void 0===u?new UZ(o,e,t):new zZ(o,e,t));break}{let e=n.map[o];void 0===e&&(e=new FZ(o),GZ(n,e)),n=e}}}class jZ{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<n;++r){const n=e.getActiveUniform(t,r);HZ(n,e.getUniformLocation(t,n.name),this)}}setValue(e,t,n,r){const i=this.map[t];void 0!==i&&i.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];void 0!==r&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let i=0,a=t.length;i!==a;++i){const a=t[i],s=n[a.id];!1!==s.needsUpdate&&a.setValue(e,s.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,i=e.length;r!==i;++r){const i=e[r];i.id in t&&n.push(i)}return n}}function WZ(e,t,n){const r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}let YZ=0;function $Z(e,t,n){const r=e.getShaderParameter(t,e.COMPILE_STATUS),i=e.getShaderInfoLog(t).trim();if(r&&""===i)return"";const a=/ERROR: 0:(\d+)/.exec(i);if(a){const r=parseInt(a[1]);return n.toUpperCase()+"\n\n"+i+"\n\n"+function(e,t){const n=e.split("\n"),r=[],i=Math.max(t-6,0),a=Math.min(t+6,n.length);for(let s=i;s<a;s++){const e=s+1;r.push(`${e===t?">":" "} ${e}: ${n[s]}`)}return r.join("\n")}(e.getShaderSource(t),r)}return i}function XZ(e,t){const n=function(e){switch(e){case zY:return["Linear","( value )"];case UY:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",e),["Linear","( value )"]}}(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function qZ(e,t){let n;switch(t){case JW:n="Linear";break;case QW:n="Reinhard";break;case eY:n="OptimizedCineon";break;case tY:n="ACESFilmic";break;case nY:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function KZ(e){return""!==e}function ZZ(e,t){const n=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function JZ(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const QZ=/^[ \t]*#include +<([\w\d./]+)>/gm;function eJ(e){return e.replace(QZ,tJ)}function tJ(e,t){const n=oK[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return eJ(n)}const nJ=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function rJ(e){return e.replace(nJ,iJ)}function iJ(e,t,n,r){let i="";for(let a=parseInt(t);a<parseInt(n);a++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return i}function aJ(e){let t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function sJ(e,t,n,r){const i=e.getContext(),a=n.defines;let s=n.vertexShader,o=n.fragmentShader;const l=function(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===GW?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===HW?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===jW&&(t="SHADOWMAP_TYPE_VSM"),t}(n),u=function(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case rY:case iY:t="ENVMAP_TYPE_CUBE";break;case aY:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),c=function(e){let t="ENVMAP_MODE_REFLECTION";e.envMap&&e.envMapMode===iY&&(t="ENVMAP_MODE_REFRACTION");return t}(n),d=function(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case XW:t="ENVMAP_BLENDING_MULTIPLY";break;case qW:t="ENVMAP_BLENDING_MIX";break;case KW:t="ENVMAP_BLENDING_ADD"}return t}(n),h=function(e){const t=e.envMapCubeUVHeight;if(null===t)return null;const n=Math.log2(t)-2,r=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:r,maxMip:n}}(n),p=n.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUVHeight||e.bumpMap||e.normalMapTangentSpace||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(KZ).join("\n")}(n),f=function(e){const t=[];for(const n in e){const r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(a),m=i.createProgram();let g,v,y=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(g=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,f].filter(KZ).join("\n"),g.length>0&&(g+="\n"),v=[p,"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,f].filter(KZ).join("\n"),v.length>0&&(v+="\n")):(g=[aJ(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,f,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors&&n.isWebGL2?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.useLegacyLights?"#define LEGACY_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(KZ).join("\n"),v=[p,aJ(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,f,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.envMap?"#define "+c:"",n.envMap?"#define "+d:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.useLegacyLights?"#define LEGACY_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==ZW?"#define TONE_MAPPING":"",n.toneMapping!==ZW?oK.tonemapping_pars_fragment:"",n.toneMapping!==ZW?qZ("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",oK.encodings_pars_fragment,XZ("linearToOutputTexel",n.outputColorSpace),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(KZ).join("\n")),s=eJ(s),s=ZZ(s,n),s=JZ(s,n),o=eJ(o),o=ZZ(o,n),o=JZ(o,n),s=rJ(s),o=rJ(o),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(y="#version 300 es\n",g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,v=["#define varying in",n.glslVersion===HY?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===HY?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+v);const _=y+g+s,b=y+v+o,x=WZ(i,i.VERTEX_SHADER,_),w=WZ(i,i.FRAGMENT_SHADER,b);if(i.attachShader(m,x),i.attachShader(m,w),void 0!==n.index0AttributeName?i.bindAttribLocation(m,0,n.index0AttributeName):!0===n.morphTargets&&i.bindAttribLocation(m,0,"position"),i.linkProgram(m),e.debug.checkShaderErrors){const t=i.getProgramInfoLog(m).trim(),n=i.getShaderInfoLog(x).trim(),r=i.getShaderInfoLog(w).trim();let a=!0,s=!0;if(!1===i.getProgramParameter(m,i.LINK_STATUS))if(a=!1,"function"==typeof e.debug.onShaderError)e.debug.onShaderError(i,m,x,w);else{const e=$Z(i,x,"vertex"),n=$Z(i,w,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(m,i.VALIDATE_STATUS)+"\n\nProgram Info Log: "+t+"\n"+e+"\n"+n)}else""!==t?console.warn("THREE.WebGLProgram: Program Info Log:",t):""!==n&&""!==r||(s=!1);s&&(this.diagnostics={runnable:a,programLog:t,vertexShader:{log:n,prefix:g},fragmentShader:{log:r,prefix:v}})}let S,C;return i.deleteShader(x),i.deleteShader(w),this.getUniforms=function(){return void 0===S&&(S=new jZ(i,m)),S},this.getAttributes=function(){return void 0===C&&(C=function(e,t){const n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const r=e.getActiveAttrib(t,i),a=r.name;let s=1;r.type===e.FLOAT_MAT2&&(s=2),r.type===e.FLOAT_MAT3&&(s=3),r.type===e.FLOAT_MAT4&&(s=4),n[a]={type:r.type,location:e.getAttribLocation(t,a),locationSize:s}}return n}(i,m)),C},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(m),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=YZ++,this.cacheKey=t,this.usedTimes=1,this.program=m,this.vertexShader=x,this.fragmentShader=w,this}let oJ=0;class lJ{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),i=this._getShaderStage(n),a=this._getShaderCacheForMaterial(e);return!1===a.has(r)&&(a.add(r),r.usedTimes++),!1===a.has(i)&&(a.add(i),i.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return void 0===n&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return void 0===n&&(n=new uJ(e),t.set(e,n)),n}}class uJ{constructor(e){this.id=oJ++,this.code=e,this.usedTimes=0}}function cJ(e,t,n,r,i,a,s){const o=new xX,l=new lJ,u=[],c=i.isWebGL2,d=i.logarithmicDepthBuffer,h=i.vertexTextures;let p=i.precision;const f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function m(e){return 0===e?"uv":`uv${e}`}return{getParameters:function(a,o,u,g,v){const y=g.fog,_=v.geometry,b=a.isMeshStandardMaterial?g.environment:null,x=(a.isMeshStandardMaterial?n:t).get(a.envMap||b),w=x&&x.mapping===aY?x.image.height:null,S=f[a.type];null!==a.precision&&(p=i.getMaxPrecision(a.precision),p!==a.precision&&console.warn("THREE.WebGLProgram.getParameters:",a.precision,"not supported, using",p,"instead."));const C=_.morphAttributes.position||_.morphAttributes.normal||_.morphAttributes.color,T=void 0!==C?C.length:0;let M,E,A,P,R=0;if(void 0!==_.morphAttributes.position&&(R=1),void 0!==_.morphAttributes.normal&&(R=2),void 0!==_.morphAttributes.color&&(R=3),S){const e=uK[S];M=e.vertexShader,E=e.fragmentShader}else M=a.vertexShader,E=a.fragmentShader,l.update(a),A=l.getVertexShaderID(a),P=l.getFragmentShaderID(a);const L=e.getRenderTarget(),k=!0===v.isInstancedMesh,D=!!a.map,I=!!a.matcap,O=!!x,N=!!a.aoMap,B=!!a.lightMap,U=!!a.bumpMap,z=!!a.normalMap,F=!!a.displacementMap,V=!!a.emissiveMap,G=!!a.metalnessMap,H=!!a.roughnessMap,j=a.anisotropy>0,W=a.clearcoat>0,Y=a.iridescence>0,$=a.sheen>0,X=a.transmission>0,q=j&&!!a.anisotropyMap,K=W&&!!a.clearcoatMap,Z=W&&!!a.clearcoatNormalMap,J=W&&!!a.clearcoatRoughnessMap,Q=Y&&!!a.iridescenceMap,ee=Y&&!!a.iridescenceThicknessMap,te=$&&!!a.sheenColorMap,ne=$&&!!a.sheenRoughnessMap,re=!!a.specularMap,ie=!!a.specularColorMap,ae=!!a.specularIntensityMap,se=X&&!!a.transmissionMap,oe=X&&!!a.thicknessMap,le=!!a.gradientMap,ue=!!a.alphaMap,ce=a.alphaTest>0,de=!!a.extensions,he=!!_.attributes.uv1,pe=!!_.attributes.uv2,fe=!!_.attributes.uv3;return{isWebGL2:c,shaderID:S,shaderType:a.type,shaderName:a.name,vertexShader:M,fragmentShader:E,defines:a.defines,customVertexShaderID:A,customFragmentShaderID:P,isRawShaderMaterial:!0===a.isRawShaderMaterial,glslVersion:a.glslVersion,precision:p,instancing:k,instancingColor:k&&null!==v.instanceColor,supportsVertexTextures:h,outputColorSpace:null===L?e.outputColorSpace:!0===L.isXRRenderTarget?L.texture.colorSpace:zY,map:D,matcap:I,envMap:O,envMapMode:O&&x.mapping,envMapCubeUVHeight:w,aoMap:N,lightMap:B,bumpMap:U,normalMap:z,displacementMap:h&&F,emissiveMap:V,normalMapObjectSpace:z&&1===a.normalMapType,normalMapTangentSpace:z&&0===a.normalMapType,metalnessMap:G,roughnessMap:H,anisotropy:j,anisotropyMap:q,clearcoat:W,clearcoatMap:K,clearcoatNormalMap:Z,clearcoatRoughnessMap:J,iridescence:Y,iridescenceMap:Q,iridescenceThicknessMap:ee,sheen:$,sheenColorMap:te,sheenRoughnessMap:ne,specularMap:re,specularColorMap:ie,specularIntensityMap:ae,transmission:X,transmissionMap:se,thicknessMap:oe,gradientMap:le,opaque:!1===a.transparent&&1===a.blending,alphaMap:ue,alphaTest:ce,combine:a.combine,mapUv:D&&m(a.map.channel),aoMapUv:N&&m(a.aoMap.channel),lightMapUv:B&&m(a.lightMap.channel),bumpMapUv:U&&m(a.bumpMap.channel),normalMapUv:z&&m(a.normalMap.channel),displacementMapUv:F&&m(a.displacementMap.channel),emissiveMapUv:V&&m(a.emissiveMap.channel),metalnessMapUv:G&&m(a.metalnessMap.channel),roughnessMapUv:H&&m(a.roughnessMap.channel),anisotropyMapUv:q&&m(a.anisotropyMap.channel),clearcoatMapUv:K&&m(a.clearcoatMap.channel),clearcoatNormalMapUv:Z&&m(a.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:J&&m(a.clearcoatRoughnessMap.channel),iridescenceMapUv:Q&&m(a.iridescenceMap.channel),iridescenceThicknessMapUv:ee&&m(a.iridescenceThicknessMap.channel),sheenColorMapUv:te&&m(a.sheenColorMap.channel),sheenRoughnessMapUv:ne&&m(a.sheenRoughnessMap.channel),specularMapUv:re&&m(a.specularMap.channel),specularColorMapUv:ie&&m(a.specularColorMap.channel),specularIntensityMapUv:ae&&m(a.specularIntensityMap.channel),transmissionMapUv:se&&m(a.transmissionMap.channel),thicknessMapUv:oe&&m(a.thicknessMap.channel),alphaMapUv:ue&&m(a.alphaMap.channel),vertexTangents:!!_.attributes.tangent&&(z||j),vertexColors:a.vertexColors,vertexAlphas:!0===a.vertexColors&&!!_.attributes.color&&4===_.attributes.color.itemSize,vertexUv1s:he,vertexUv2s:pe,vertexUv3s:fe,pointsUvs:!0===v.isPoints&&!!_.attributes.uv&&(D||ue),fog:!!y,useFog:!0===a.fog,fogExp2:y&&y.isFogExp2,flatShading:!0===a.flatShading,sizeAttenuation:!0===a.sizeAttenuation,logarithmicDepthBuffer:d,skinning:!0===v.isSkinnedMesh,morphTargets:void 0!==_.morphAttributes.position,morphNormals:void 0!==_.morphAttributes.normal,morphColors:void 0!==_.morphAttributes.color,morphTargetsCount:T,morphTextureStride:R,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numSpotLightMaps:o.spotLightMap.length,numRectAreaLights:o.rectArea.length,numHemiLights:o.hemi.length,numDirLightShadows:o.directionalShadowMap.length,numPointLightShadows:o.pointShadowMap.length,numSpotLightShadows:o.spotShadowMap.length,numSpotLightShadowsWithMaps:o.numSpotLightShadowsWithMaps,numClippingPlanes:s.numPlanes,numClipIntersection:s.numIntersection,dithering:a.dithering,shadowMapEnabled:e.shadowMap.enabled&&u.length>0,shadowMapType:e.shadowMap.type,toneMapping:a.toneMapped?e.toneMapping:ZW,useLegacyLights:e.useLegacyLights,premultipliedAlpha:a.premultipliedAlpha,doubleSided:2===a.side,flipSided:a.side===YW,useDepthPacking:a.depthPacking>=0,depthPacking:a.depthPacking||0,index0AttributeName:a.index0AttributeName,extensionDerivatives:de&&!0===a.extensions.derivatives,extensionFragDepth:de&&!0===a.extensions.fragDepth,extensionDrawBuffers:de&&!0===a.extensions.drawBuffers,extensionShaderTextureLOD:de&&!0===a.extensions.shaderTextureLOD,rendererExtensionFragDepth:c||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:c||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:c||r.has("EXT_shader_texture_lod"),customProgramCacheKey:a.customProgramCacheKey()}},getProgramCacheKey:function(t){const n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.customVertexShaderID),n.push(t.customFragmentShaderID)),void 0!==t.defines)for(const e in t.defines)n.push(e),n.push(t.defines[e]);return!1===t.isRawShaderMaterial&&(!function(e,t){e.push(t.precision),e.push(t.outputColorSpace),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.mapUv),e.push(t.alphaMapUv),e.push(t.lightMapUv),e.push(t.aoMapUv),e.push(t.bumpMapUv),e.push(t.normalMapUv),e.push(t.displacementMapUv),e.push(t.emissiveMapUv),e.push(t.metalnessMapUv),e.push(t.roughnessMapUv),e.push(t.anisotropyMapUv),e.push(t.clearcoatMapUv),e.push(t.clearcoatNormalMapUv),e.push(t.clearcoatRoughnessMapUv),e.push(t.iridescenceMapUv),e.push(t.iridescenceThicknessMapUv),e.push(t.sheenColorMapUv),e.push(t.sheenRoughnessMapUv),e.push(t.specularMapUv),e.push(t.specularColorMapUv),e.push(t.specularIntensityMapUv),e.push(t.transmissionMapUv),e.push(t.thicknessMapUv),e.push(t.combine),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numSpotLightMaps),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.numSpotLightShadowsWithMaps),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.depthPacking)}(n,t),function(e,t){o.disableAll(),t.isWebGL2&&o.enable(0);t.supportsVertexTextures&&o.enable(1);t.instancing&&o.enable(2);t.instancingColor&&o.enable(3);t.matcap&&o.enable(4);t.envMap&&o.enable(5);t.normalMapObjectSpace&&o.enable(6);t.normalMapTangentSpace&&o.enable(7);t.clearcoat&&o.enable(8);t.iridescence&&o.enable(9);t.alphaTest&&o.enable(10);t.vertexColors&&o.enable(11);t.vertexAlphas&&o.enable(12);t.vertexUv1s&&o.enable(13);t.vertexUv2s&&o.enable(14);t.vertexUv3s&&o.enable(15);t.vertexTangents&&o.enable(16);t.anisotropy&&o.enable(17);e.push(o.mask),o.disableAll(),t.fog&&o.enable(0);t.useFog&&o.enable(1);t.flatShading&&o.enable(2);t.logarithmicDepthBuffer&&o.enable(3);t.skinning&&o.enable(4);t.morphTargets&&o.enable(5);t.morphNormals&&o.enable(6);t.morphColors&&o.enable(7);t.premultipliedAlpha&&o.enable(8);t.shadowMapEnabled&&o.enable(9);t.useLegacyLights&&o.enable(10);t.doubleSided&&o.enable(11);t.flipSided&&o.enable(12);t.useDepthPacking&&o.enable(13);t.dithering&&o.enable(14);t.transmission&&o.enable(15);t.sheen&&o.enable(16);t.opaque&&o.enable(17);t.pointsUvs&&o.enable(18);e.push(o.mask)}(n,t),n.push(e.outputColorSpace)),n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){const t=f[e.type];let n;if(t){const e=uK[t];n=Hq.clone(e.uniforms)}else n=e.uniforms;return n},acquireProgram:function(t,n){let r;for(let e=0,i=u.length;e<i;e++){const t=u[e];if(t.cacheKey===n){r=t,++r.usedTimes;break}}return void 0===r&&(r=new sJ(e,n,t,a),u.push(r)),r},releaseProgram:function(e){if(0==--e.usedTimes){const t=u.indexOf(e);u[t]=u[u.length-1],u.pop(),e.destroy()}},releaseShaderCache:function(e){l.remove(e)},programs:u,dispose:function(){l.dispose()}}}function dJ(){let e=new WeakMap;return{get:function(t){let n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}}function hJ(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function pJ(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function fJ(){const e=[];let t=0;const n=[],r=[],i=[];function a(n,r,i,a,s,o){let l=e[t];return void 0===l?(l={id:n.id,object:n,geometry:r,material:i,groupOrder:a,renderOrder:n.renderOrder,z:s,group:o},e[t]=l):(l.id=n.id,l.object=n,l.geometry=r,l.material=i,l.groupOrder=a,l.renderOrder=n.renderOrder,l.z=s,l.group=o),t++,l}return{opaque:n,transmissive:r,transparent:i,init:function(){t=0,n.length=0,r.length=0,i.length=0},push:function(e,t,s,o,l,u){const c=a(e,t,s,o,l,u);s.transmission>0?r.push(c):!0===s.transparent?i.push(c):n.push(c)},unshift:function(e,t,s,o,l,u){const c=a(e,t,s,o,l,u);s.transmission>0?r.unshift(c):!0===s.transparent?i.unshift(c):n.unshift(c)},finish:function(){for(let n=t,r=e.length;n<r;n++){const t=e[n];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.group=null}},sort:function(e,t){n.length>1&&n.sort(e||hJ),r.length>1&&r.sort(t||pJ),i.length>1&&i.sort(t||pJ)}}}function mJ(){let e=new WeakMap;return{get:function(t,n){const r=e.get(t);let i;return void 0===r?(i=new fJ,e.set(t,[i])):n>=r.length?(i=new fJ,r.push(i)):i=r[n],i},dispose:function(){e=new WeakMap}}}function gJ(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":n={direction:new I$,color:new eq};break;case"SpotLight":n={position:new I$,direction:new I$,color:new eq,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new I$,color:new eq,distance:0,decay:0};break;case"HemisphereLight":n={direction:new I$,skyColor:new eq,groundColor:new eq};break;case"RectAreaLight":n={color:new eq,position:new I$,halfWidth:new I$,halfHeight:new I$}}return e[t.id]=n,n}}}let vJ=0;function yJ(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function _J(e,t){const n=new gJ,r=function(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new l$};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new l$,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}}(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let l=0;l<9;l++)i.probe.push(new I$);const a=new I$,s=new cX,o=new cX;return{setup:function(a,s){let o=0,l=0,u=0;for(let e=0;e<9;e++)i.probe[e].set(0,0,0);let c=0,d=0,h=0,p=0,f=0,m=0,g=0,v=0,y=0,_=0;a.sort(yJ);const b=!0===s?Math.PI:1;for(let e=0,t=a.length;e<t;e++){const t=a[e],s=t.color,x=t.intensity,w=t.distance,S=t.shadow&&t.shadow.map?t.shadow.map.texture:null;if(t.isAmbientLight)o+=s.r*x*b,l+=s.g*x*b,u+=s.b*x*b;else if(t.isLightProbe)for(let e=0;e<9;e++)i.probe[e].addScaledVector(t.sh.coefficients[e],x);else if(t.isDirectionalLight){const e=n.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity*b),t.castShadow){const e=t.shadow,n=r.get(t);n.shadowBias=e.bias,n.shadowNormalBias=e.normalBias,n.shadowRadius=e.radius,n.shadowMapSize=e.mapSize,i.directionalShadow[c]=n,i.directionalShadowMap[c]=S,i.directionalShadowMatrix[c]=t.shadow.matrix,m++}i.directional[c]=e,c++}else if(t.isSpotLight){const e=n.get(t);e.position.setFromMatrixPosition(t.matrixWorld),e.color.copy(s).multiplyScalar(x*b),e.distance=w,e.coneCos=Math.cos(t.angle),e.penumbraCos=Math.cos(t.angle*(1-t.penumbra)),e.decay=t.decay,i.spot[h]=e;const a=t.shadow;if(t.map&&(i.spotLightMap[y]=t.map,y++,a.updateMatrices(t),t.castShadow&&_++),i.spotLightMatrix[h]=a.matrix,t.castShadow){const e=r.get(t);e.shadowBias=a.bias,e.shadowNormalBias=a.normalBias,e.shadowRadius=a.radius,e.shadowMapSize=a.mapSize,i.spotShadow[h]=e,i.spotShadowMap[h]=S,v++}h++}else if(t.isRectAreaLight){const e=n.get(t);e.color.copy(s).multiplyScalar(x),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),i.rectArea[p]=e,p++}else if(t.isPointLight){const e=n.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity*b),e.distance=t.distance,e.decay=t.decay,t.castShadow){const e=t.shadow,n=r.get(t);n.shadowBias=e.bias,n.shadowNormalBias=e.normalBias,n.shadowRadius=e.radius,n.shadowMapSize=e.mapSize,n.shadowCameraNear=e.camera.near,n.shadowCameraFar=e.camera.far,i.pointShadow[d]=n,i.pointShadowMap[d]=S,i.pointShadowMatrix[d]=t.shadow.matrix,g++}i.point[d]=e,d++}else if(t.isHemisphereLight){const e=n.get(t);e.skyColor.copy(t.color).multiplyScalar(x*b),e.groundColor.copy(t.groundColor).multiplyScalar(x*b),i.hemi[f]=e,f++}}p>0&&(t.isWebGL2||!0===e.has("OES_texture_float_linear")?(i.rectAreaLTC1=lK.LTC_FLOAT_1,i.rectAreaLTC2=lK.LTC_FLOAT_2):!0===e.has("OES_texture_half_float_linear")?(i.rectAreaLTC1=lK.LTC_HALF_1,i.rectAreaLTC2=lK.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=o,i.ambient[1]=l,i.ambient[2]=u;const x=i.hash;x.directionalLength===c&&x.pointLength===d&&x.spotLength===h&&x.rectAreaLength===p&&x.hemiLength===f&&x.numDirectionalShadows===m&&x.numPointShadows===g&&x.numSpotShadows===v&&x.numSpotMaps===y||(i.directional.length=c,i.spot.length=h,i.rectArea.length=p,i.point.length=d,i.hemi.length=f,i.directionalShadow.length=m,i.directionalShadowMap.length=m,i.pointShadow.length=g,i.pointShadowMap.length=g,i.spotShadow.length=v,i.spotShadowMap.length=v,i.directionalShadowMatrix.length=m,i.pointShadowMatrix.length=g,i.spotLightMatrix.length=v+y-_,i.spotLightMap.length=y,i.numSpotLightShadowsWithMaps=_,x.directionalLength=c,x.pointLength=d,x.spotLength=h,x.rectAreaLength=p,x.hemiLength=f,x.numDirectionalShadows=m,x.numPointShadows=g,x.numSpotShadows=v,x.numSpotMaps=y,i.version=vJ++)},setupView:function(e,t){let n=0,r=0,l=0,u=0,c=0;const d=t.matrixWorldInverse;for(let h=0,p=e.length;h<p;h++){const t=e[h];if(t.isDirectionalLight){const e=i.directional[n];e.direction.setFromMatrixPosition(t.matrixWorld),a.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(a),e.direction.transformDirection(d),n++}else if(t.isSpotLight){const e=i.spot[l];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(d),e.direction.setFromMatrixPosition(t.matrixWorld),a.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(a),e.direction.transformDirection(d),l++}else if(t.isRectAreaLight){const e=i.rectArea[u];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(d),o.identity(),s.copy(t.matrixWorld),s.premultiply(d),o.extractRotation(s),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),e.halfWidth.applyMatrix4(o),e.halfHeight.applyMatrix4(o),u++}else if(t.isPointLight){const e=i.point[r];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(d),r++}else if(t.isHemisphereLight){const e=i.hemi[c];e.direction.setFromMatrixPosition(t.matrixWorld),e.direction.transformDirection(d),c++}}},state:i}}function bJ(e,t){const n=new _J(e,t),r=[],i=[];return{init:function(){r.length=0,i.length=0},state:{lightsArray:r,shadowsArray:i,lights:n},setupLights:function(e){n.setup(r,e)},setupLightsView:function(e){n.setupView(r,e)},pushLight:function(e){r.push(e)},pushShadow:function(e){i.push(e)}}}function xJ(e,t){let n=new WeakMap;return{get:function(r,i=0){const a=n.get(r);let s;return void 0===a?(s=new bJ(e,t),n.set(r,[s])):i>=a.length?(s=new bJ(e,t),a.push(s)):s=a[i],s},dispose:function(){n=new WeakMap}}}class wJ extends qX{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class SJ extends qX{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function CJ(e,t,n){let r=new rK;const i=new l$,a=new l$,s=new P$,o=new wJ({depthPacking:3201}),l=new SJ,u={},c=n.maxTextureSize,d={[WW]:YW,[YW]:WW,2:2},h=new jq({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new l$},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),p=h.clone();p.defines.HORIZONTAL_PASS=1;const f=new _q;f.setAttribute("position",new lq(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new Bq(f,h),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=GW;let v=this.type;function y(n,r){const a=t.update(m);h.defines.VSM_SAMPLES!==n.blurSamples&&(h.defines.VSM_SAMPLES=n.blurSamples,p.defines.VSM_SAMPLES=n.blurSamples,h.needsUpdate=!0,p.needsUpdate=!0),null===n.mapPass&&(n.mapPass=new R$(i.x,i.y)),h.uniforms.shadow_pass.value=n.map.texture,h.uniforms.resolution.value=n.mapSize,h.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(r,null,a,h,m,null),p.uniforms.shadow_pass.value=n.mapPass.texture,p.uniforms.resolution.value=n.mapSize,p.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(r,null,a,p,m,null)}function _(t,n,r,i){let a=null;const s=!0===r.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(void 0!==s)a=s;else if(a=!0===r.isPointLight?l:o,e.localClippingEnabled&&!0===n.clipShadows&&Array.isArray(n.clippingPlanes)&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0||n.map&&n.alphaTest>0){const e=a.uuid,t=n.uuid;let r=u[e];void 0===r&&(r={},u[e]=r);let i=r[t];void 0===i&&(i=a.clone(),r[t]=i),a=i}if(a.visible=n.visible,a.wireframe=n.wireframe,a.side=i===jW?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:d[n.side],a.alphaMap=n.alphaMap,a.alphaTest=n.alphaTest,a.map=n.map,a.clipShadows=n.clipShadows,a.clippingPlanes=n.clippingPlanes,a.clipIntersection=n.clipIntersection,a.displacementMap=n.displacementMap,a.displacementScale=n.displacementScale,a.displacementBias=n.displacementBias,a.wireframeLinewidth=n.wireframeLinewidth,a.linewidth=n.linewidth,!0===r.isPointLight&&!0===a.isMeshDistanceMaterial){e.properties.get(a).light=r}return a}function b(n,i,a,s,o){if(!1===n.visible)return;if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&o===jW)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,n.matrixWorld);const r=t.update(n),i=n.material;if(Array.isArray(i)){const t=r.groups;for(let l=0,u=t.length;l<u;l++){const u=t[l],c=i[u.materialIndex];if(c&&c.visible){const t=_(n,c,s,o);e.renderBufferDirect(a,null,r,t,n,u)}}}else if(i.visible){const t=_(n,i,s,o);e.renderBufferDirect(a,null,r,t,n,null)}}const l=n.children;for(let e=0,t=l.length;e<t;e++)b(l[e],i,a,s,o)}this.render=function(t,n,o){if(!1===g.enabled)return;if(!1===g.autoUpdate&&!1===g.needsUpdate)return;if(0===t.length)return;const l=e.getRenderTarget(),u=e.getActiveCubeFace(),d=e.getActiveMipmapLevel(),h=e.state;h.setBlending(0),h.buffers.color.setClear(1,1,1,1),h.buffers.depth.setTest(!0),h.setScissorTest(!1);const p=v!==jW&&this.type===jW,f=v===jW&&this.type!==jW;for(let m=0,g=t.length;m<g;m++){const l=t[m],u=l.shadow;if(void 0===u){console.warn("THREE.WebGLShadowMap:",l,"has no shadow.");continue}if(!1===u.autoUpdate&&!1===u.needsUpdate)continue;i.copy(u.mapSize);const d=u.getFrameExtents();if(i.multiply(d),a.copy(u.mapSize),(i.x>c||i.y>c)&&(i.x>c&&(a.x=Math.floor(c/d.x),i.x=a.x*d.x,u.mapSize.x=a.x),i.y>c&&(a.y=Math.floor(c/d.y),i.y=a.y*d.y,u.mapSize.y=a.y)),null===u.map||!0===p||!0===f){const e=this.type!==jW?{minFilter:uY,magFilter:uY}:{};null!==u.map&&u.map.dispose(),u.map=new R$(i.x,i.y,e),u.map.texture.name=l.name+".shadowMap",u.camera.updateProjectionMatrix()}e.setRenderTarget(u.map),e.clear();const g=u.getViewportCount();for(let e=0;e<g;e++){const t=u.getViewport(e);s.set(a.x*t.x,a.y*t.y,a.x*t.z,a.y*t.w),h.viewport(s),u.updateMatrices(l,e),r=u.getFrustum(),b(n,o,u.camera,l,this.type)}!0!==u.isPointLightShadow&&this.type===jW&&y(u,o),u.needsUpdate=!1}v=this.type,g.needsUpdate=!1,e.setRenderTarget(l,u,d)}}function TJ(e,t,n){const r=n.isWebGL2;const i=new function(){let t=!1;const n=new P$;let r=null;const i=new P$(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,a,s,o){!0===o&&(t*=s,r*=s,a*=s),n.set(t,r,a,s),!1===i.equals(n)&&(e.clearColor(t,r,a,s),i.copy(n))},reset:function(){t=!1,r=null,i.set(-1,0,0,0)}}},a=new function(){let t=!1,n=null,r=null,i=null;return{setTest:function(t){t?F(e.DEPTH_TEST):V(e.DEPTH_TEST)},setMask:function(r){n===r||t||(e.depthMask(r),n=r)},setFunc:function(t){if(r!==t){switch(t){case 0:e.depthFunc(e.NEVER);break;case 1:e.depthFunc(e.ALWAYS);break;case 2:e.depthFunc(e.LESS);break;case 3:default:e.depthFunc(e.LEQUAL);break;case 4:e.depthFunc(e.EQUAL);break;case 5:e.depthFunc(e.GEQUAL);break;case 6:e.depthFunc(e.GREATER);break;case 7:e.depthFunc(e.NOTEQUAL)}r=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,n=null,r=null,i=null}}},s=new function(){let t=!1,n=null,r=null,i=null,a=null,s=null,o=null,l=null,u=null;return{setTest:function(n){t||(n?F(e.STENCIL_TEST):V(e.STENCIL_TEST))},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,s){r===t&&i===n&&a===s||(e.stencilFunc(t,n,s),r=t,i=n,a=s)},setOp:function(t,n,r){s===t&&o===n&&l===r||(e.stencilOp(t,n,r),s=t,o=n,l=r)},setLocked:function(e){t=e},setClear:function(t){u!==t&&(e.clearStencil(t),u=t)},reset:function(){t=!1,n=null,r=null,i=null,a=null,s=null,o=null,l=null,u=null}}},o=new WeakMap,l=new WeakMap;let u={},c={},d=new WeakMap,h=[],p=null,f=!1,m=null,g=null,v=null,y=null,_=null,b=null,x=null,w=!1,S=null,C=null,T=null,M=null,E=null;const A=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let P=!1,R=0;const L=e.getParameter(e.VERSION);-1!==L.indexOf("WebGL")?(R=parseFloat(/^WebGL (\d)/.exec(L)[1]),P=R>=1):-1!==L.indexOf("OpenGL ES")&&(R=parseFloat(/^OpenGL ES (\d)/.exec(L)[1]),P=R>=2);let k=null,D={};const I=e.getParameter(e.SCISSOR_BOX),O=e.getParameter(e.VIEWPORT),N=(new P$).fromArray(I),B=(new P$).fromArray(O);function U(t,n,i,a){const s=new Uint8Array(4),o=e.createTexture();e.bindTexture(t,o),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(let l=0;l<i;l++)!r||t!==e.TEXTURE_3D&&t!==e.TEXTURE_2D_ARRAY?e.texImage2D(n+l,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,s):e.texImage3D(n,0,e.RGBA,1,1,a,0,e.RGBA,e.UNSIGNED_BYTE,s);return o}const z={};function F(t){!0!==u[t]&&(e.enable(t),u[t]=!0)}function V(t){!1!==u[t]&&(e.disable(t),u[t]=!1)}z[e.TEXTURE_2D]=U(e.TEXTURE_2D,e.TEXTURE_2D,1),z[e.TEXTURE_CUBE_MAP]=U(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),r&&(z[e.TEXTURE_2D_ARRAY]=U(e.TEXTURE_2D_ARRAY,e.TEXTURE_2D_ARRAY,1,1),z[e.TEXTURE_3D]=U(e.TEXTURE_3D,e.TEXTURE_3D,1,1)),i.setClear(0,0,0,1),a.setClear(1),s.setClear(0),F(e.DEPTH_TEST),a.setFunc(3),W(!1),Y(1),F(e.CULL_FACE),j(0);const G={[$W]:e.FUNC_ADD,101:e.FUNC_SUBTRACT,102:e.FUNC_REVERSE_SUBTRACT};if(r)G[103]=e.MIN,G[104]=e.MAX;else{const e=t.get("EXT_blend_minmax");null!==e&&(G[103]=e.MIN_EXT,G[104]=e.MAX_EXT)}const H={200:e.ZERO,201:e.ONE,202:e.SRC_COLOR,204:e.SRC_ALPHA,210:e.SRC_ALPHA_SATURATE,208:e.DST_COLOR,206:e.DST_ALPHA,203:e.ONE_MINUS_SRC_COLOR,205:e.ONE_MINUS_SRC_ALPHA,209:e.ONE_MINUS_DST_COLOR,207:e.ONE_MINUS_DST_ALPHA};function j(t,n,r,i,a,s,o,l){if(0!==t){if(!1===f&&(F(e.BLEND),f=!0),5===t)a=a||n,s=s||r,o=o||i,n===g&&a===_||(e.blendEquationSeparate(G[n],G[a]),g=n,_=a),r===v&&i===y&&s===b&&o===x||(e.blendFuncSeparate(H[r],H[i],H[s],H[o]),v=r,y=i,b=s,x=o),m=t,w=!1;else if(t!==m||l!==w){if(g===$W&&_===$W||(e.blendEquation(e.FUNC_ADD),g=$W,_=$W),l)switch(t){case 1:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case 2:e.blendFunc(e.ONE,e.ONE);break;case 3:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case 4:e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case 1:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case 2:e.blendFunc(e.SRC_ALPHA,e.ONE);break;case 3:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case 4:e.blendFunc(e.ZERO,e.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}v=null,y=null,b=null,x=null,m=t,w=l}}else!0===f&&(V(e.BLEND),f=!1)}function W(t){S!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),S=t)}function Y(t){0!==t?(F(e.CULL_FACE),t!==C&&(1===t?e.cullFace(e.BACK):2===t?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):V(e.CULL_FACE),C=t}function $(t,n,r){t?(F(e.POLYGON_OFFSET_FILL),M===n&&E===r||(e.polygonOffset(n,r),M=n,E=r)):V(e.POLYGON_OFFSET_FILL)}return{buffers:{color:i,depth:a,stencil:s},enable:F,disable:V,bindFramebuffer:function(t,n){return c[t]!==n&&(e.bindFramebuffer(t,n),c[t]=n,r&&(t===e.DRAW_FRAMEBUFFER&&(c[e.FRAMEBUFFER]=n),t===e.FRAMEBUFFER&&(c[e.DRAW_FRAMEBUFFER]=n)),!0)},drawBuffers:function(r,i){let a=h,s=!1;if(r)if(a=d.get(i),void 0===a&&(a=[],d.set(i,a)),r.isWebGLMultipleRenderTargets){const t=r.texture;if(a.length!==t.length||a[0]!==e.COLOR_ATTACHMENT0){for(let n=0,r=t.length;n<r;n++)a[n]=e.COLOR_ATTACHMENT0+n;a.length=t.length,s=!0}}else a[0]!==e.COLOR_ATTACHMENT0&&(a[0]=e.COLOR_ATTACHMENT0,s=!0);else a[0]!==e.BACK&&(a[0]=e.BACK,s=!0);s&&(n.isWebGL2?e.drawBuffers(a):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(a))},useProgram:function(t){return p!==t&&(e.useProgram(t),p=t,!0)},setBlending:j,setMaterial:function(t,n){2===t.side?V(e.CULL_FACE):F(e.CULL_FACE);let r=t.side===YW;n&&(r=!r),W(r),1===t.blending&&!1===t.transparent?j(0):j(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),a.setFunc(t.depthFunc),a.setTest(t.depthTest),a.setMask(t.depthWrite),i.setMask(t.colorWrite);const o=t.stencilWrite;s.setTest(o),o&&(s.setMask(t.stencilWriteMask),s.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),s.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),$(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?F(e.SAMPLE_ALPHA_TO_COVERAGE):V(e.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:W,setCullFace:Y,setLineWidth:function(t){t!==T&&(P&&e.lineWidth(t),T=t)},setPolygonOffset:$,setScissorTest:function(t){t?F(e.SCISSOR_TEST):V(e.SCISSOR_TEST)},activeTexture:function(t){void 0===t&&(t=e.TEXTURE0+A-1),k!==t&&(e.activeTexture(t),k=t)},bindTexture:function(t,n,r){void 0===r&&(r=null===k?e.TEXTURE0+A-1:k);let i=D[r];void 0===i&&(i={type:void 0,texture:void 0},D[r]=i),i.type===t&&i.texture===n||(k!==r&&(e.activeTexture(r),k=r),e.bindTexture(t,n||z[t]),i.type=t,i.texture=n)},unbindTexture:function(){const t=D[k];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexImage3D:function(){try{e.compressedTexImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},updateUBOMapping:function(t,n){let r=l.get(n);void 0===r&&(r=new WeakMap,l.set(n,r));let i=r.get(t);void 0===i&&(i=e.getUniformBlockIndex(n,t.name),r.set(t,i))},uniformBlockBinding:function(t,n){const r=l.get(n).get(t);o.get(n)!==r&&(e.uniformBlockBinding(n,r,t.__bindingPointIndex),o.set(n,r))},texStorage2D:function(){try{e.texStorage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texStorage3D:function(){try{e.texStorage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage2D:function(){try{e.texSubImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage3D:function(){try{e.texSubImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexSubImage3D:function(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(t){!1===N.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),N.copy(t))},viewport:function(t){!1===B.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),B.copy(t))},reset:function(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),!0===r&&(e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),u={},k=null,D={},c={},d=new WeakMap,h=[],p=null,f=!1,m=null,g=null,v=null,y=null,_=null,b=null,x=null,w=!1,S=null,C=null,T=null,M=null,E=null,N.set(0,0,e.canvas.width,e.canvas.height),B.set(0,0,e.canvas.width,e.canvas.height),i.reset(),a.reset(),s.reset()}}}function MJ(e,t,n,r,i,a,s){const o=i.isWebGL2,l=i.maxTextures,u=i.maxCubemapSize,c=i.maxTextureSize,d=i.maxSamples,h=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,p="undefined"!=typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),f=new WeakMap;let m;const g=new WeakMap;let v=!1;try{v="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(H){}function y(e,t){return v?new OffscreenCanvas(e,t):h$("canvas")}function _(e,t,n,r){let i=1;if((e.width>r||e.height>r)&&(i=r/Math.max(e.width,e.height)),i<1||!0===t){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const r=t?i$:Math.floor,a=r(i*e.width),s=r(i*e.height);void 0===m&&(m=y(a,s));const o=n?y(a,s):m;o.width=a,o.height=s;return o.getContext("2d").drawImage(e,0,0,a,s),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+a+"x"+s+")."),o}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function b(e){return n$(e.width)&&n$(e.height)}function x(e,t){return e.generateMipmaps&&t&&e.minFilter!==uY&&e.minFilter!==hY}function w(t){e.generateMipmap(t)}function S(n,r,i,a,s=!1){if(!1===o)return r;if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let l=r;return r===e.RED&&(i===e.FLOAT&&(l=e.R32F),i===e.HALF_FLOAT&&(l=e.R16F),i===e.UNSIGNED_BYTE&&(l=e.R8)),r===e.RG&&(i===e.FLOAT&&(l=e.RG32F),i===e.HALF_FLOAT&&(l=e.RG16F),i===e.UNSIGNED_BYTE&&(l=e.RG8)),r===e.RGBA&&(i===e.FLOAT&&(l=e.RGBA32F),i===e.HALF_FLOAT&&(l=e.RGBA16F),i===e.UNSIGNED_BYTE&&(l=a===UY&&!1===s?e.SRGB8_ALPHA8:e.RGBA8),i===e.UNSIGNED_SHORT_4_4_4_4&&(l=e.RGBA4),i===e.UNSIGNED_SHORT_5_5_5_1&&(l=e.RGB5_A1)),l!==e.R16F&&l!==e.R32F&&l!==e.RG16F&&l!==e.RG32F&&l!==e.RGBA16F&&l!==e.RGBA32F||t.get("EXT_color_buffer_float"),l}function C(e,t,n){return!0===x(e,n)||e.isFramebufferTexture&&e.minFilter!==uY&&e.minFilter!==hY?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function T(t){return t===uY||t===cY||t===dY?e.NEAREST:e.LINEAR}function M(e){const t=e.target;t.removeEventListener("dispose",M),function(e){const t=r.get(e);if(void 0===t.__webglInit)return;const n=e.source,i=g.get(n);if(i){const r=i[t.__cacheKey];r.usedTimes--,0===r.usedTimes&&A(e),0===Object.keys(i).length&&g.delete(n)}r.remove(e)}(t),t.isVideoTexture&&f.delete(t)}function E(t){const n=t.target;n.removeEventListener("dispose",E),function(t){const n=t.texture,i=r.get(t),a=r.get(n);void 0!==a.__webglTexture&&(e.deleteTexture(a.__webglTexture),s.memory.textures--);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLCubeRenderTarget)for(let r=0;r<6;r++)e.deleteFramebuffer(i.__webglFramebuffer[r]),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer[r]);else{if(e.deleteFramebuffer(i.__webglFramebuffer),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer),i.__webglMultisampledFramebuffer&&e.deleteFramebuffer(i.__webglMultisampledFramebuffer),i.__webglColorRenderbuffer)for(let t=0;t<i.__webglColorRenderbuffer.length;t++)i.__webglColorRenderbuffer[t]&&e.deleteRenderbuffer(i.__webglColorRenderbuffer[t]);i.__webglDepthRenderbuffer&&e.deleteRenderbuffer(i.__webglDepthRenderbuffer)}if(t.isWebGLMultipleRenderTargets)for(let o=0,l=n.length;o<l;o++){const t=r.get(n[o]);t.__webglTexture&&(e.deleteTexture(t.__webglTexture),s.memory.textures--),r.remove(n[o])}r.remove(n),r.remove(t)}(n)}function A(t){const n=r.get(t);e.deleteTexture(n.__webglTexture);const i=t.source;delete g.get(i)[n.__cacheKey],s.memory.textures--}let P=0;function R(t,i){const a=r.get(t);if(t.isVideoTexture&&function(e){const t=s.render.frame;f.get(e)!==t&&(f.set(e,t),e.update())}(t),!1===t.isRenderTargetTexture&&t.version>0&&a.__version!==t.version){const e=t.image;if(null===e)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==e.complete)return void N(a,t,i);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.bindTexture(e.TEXTURE_2D,a.__webglTexture,e.TEXTURE0+i)}const L={[sY]:e.REPEAT,[oY]:e.CLAMP_TO_EDGE,[lY]:e.MIRRORED_REPEAT},k={[uY]:e.NEAREST,[cY]:e.NEAREST_MIPMAP_NEAREST,[dY]:e.NEAREST_MIPMAP_LINEAR,[hY]:e.LINEAR,1007:e.LINEAR_MIPMAP_NEAREST,[pY]:e.LINEAR_MIPMAP_LINEAR},D={512:e.NEVER,519:e.ALWAYS,513:e.LESS,515:e.LEQUAL,514:e.EQUAL,518:e.GEQUAL,516:e.GREATER,517:e.NOTEQUAL};function I(n,a,s){if(s?(e.texParameteri(n,e.TEXTURE_WRAP_S,L[a.wrapS]),e.texParameteri(n,e.TEXTURE_WRAP_T,L[a.wrapT]),n!==e.TEXTURE_3D&&n!==e.TEXTURE_2D_ARRAY||e.texParameteri(n,e.TEXTURE_WRAP_R,L[a.wrapR]),e.texParameteri(n,e.TEXTURE_MAG_FILTER,k[a.magFilter]),e.texParameteri(n,e.TEXTURE_MIN_FILTER,k[a.minFilter])):(e.texParameteri(n,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(n,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),n!==e.TEXTURE_3D&&n!==e.TEXTURE_2D_ARRAY||e.texParameteri(n,e.TEXTURE_WRAP_R,e.CLAMP_TO_EDGE),a.wrapS===oY&&a.wrapT===oY||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,e.TEXTURE_MAG_FILTER,T(a.magFilter)),e.texParameteri(n,e.TEXTURE_MIN_FILTER,T(a.minFilter)),a.minFilter!==uY&&a.minFilter!==hY&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),a.compareFunction&&(e.texParameteri(n,e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE),e.texParameteri(n,e.TEXTURE_COMPARE_FUNC,D[a.compareFunction])),!0===t.has("EXT_texture_filter_anisotropic")){const s=t.get("EXT_texture_filter_anisotropic");if(a.magFilter===uY)return;if(a.minFilter!==dY&&a.minFilter!==pY)return;if(a.type===yY&&!1===t.has("OES_texture_float_linear"))return;if(!1===o&&a.type===_Y&&!1===t.has("OES_texture_half_float_linear"))return;(a.anisotropy>1||r.get(a).__currentAnisotropy)&&(e.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),r.get(a).__currentAnisotropy=a.anisotropy)}}function O(t,n){let r=!1;void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",M));const i=n.source;let a=g.get(i);void 0===a&&(a={},g.set(i,a));const o=function(e){const t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.wrapR||0),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.colorSpace),t.join()}(n);if(o!==t.__cacheKey){void 0===a[o]&&(a[o]={texture:e.createTexture(),usedTimes:0},s.memory.textures++,r=!0),a[o].usedTimes++;const i=a[t.__cacheKey];void 0!==i&&(a[t.__cacheKey].usedTimes--,0===i.usedTimes&&A(n)),t.__cacheKey=o,t.__webglTexture=a[o].texture}return r}function N(t,i,s){let l=e.TEXTURE_2D;(i.isDataArrayTexture||i.isCompressedArrayTexture)&&(l=e.TEXTURE_2D_ARRAY),i.isData3DTexture&&(l=e.TEXTURE_3D);const u=O(t,i),d=i.source;n.bindTexture(l,t.__webglTexture,e.TEXTURE0+s);const h=r.get(d);if(d.version!==h.__version||!0===u){n.activeTexture(e.TEXTURE0+s),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,i.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,i.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE);const t=function(e){return!o&&(e.wrapS!==oY||e.wrapT!==oY||e.minFilter!==uY&&e.minFilter!==hY)}(i)&&!1===b(i.image);let r=_(i.image,t,!1,c);r=G(i,r);const p=b(r)||o,f=a.convert(i.format,i.colorSpace);let m,g=a.convert(i.type),v=S(i.internalFormat,f,g,i.colorSpace);I(l,i,p);const y=i.mipmaps,T=o&&!0!==i.isVideoTexture,M=void 0===h.__version||!0===u,E=C(i,r,p);if(i.isDepthTexture)v=e.DEPTH_COMPONENT,o?v=i.type===yY?e.DEPTH_COMPONENT32F:i.type===vY?e.DEPTH_COMPONENT24:i.type===bY?e.DEPTH24_STENCIL8:e.DEPTH_COMPONENT16:i.type===yY&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),i.format===wY&&v===e.DEPTH_COMPONENT&&i.type!==mY&&i.type!==vY&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),i.type=vY,g=a.convert(i.type)),i.format===SY&&v===e.DEPTH_COMPONENT&&(v=e.DEPTH_STENCIL,i.type!==bY&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),i.type=bY,g=a.convert(i.type))),M&&(T?n.texStorage2D(e.TEXTURE_2D,1,v,r.width,r.height):n.texImage2D(e.TEXTURE_2D,0,v,r.width,r.height,0,f,g,null));else if(i.isDataTexture)if(y.length>0&&p){T&&M&&n.texStorage2D(e.TEXTURE_2D,E,v,y[0].width,y[0].height);for(let t=0,r=y.length;t<r;t++)m=y[t],T?n.texSubImage2D(e.TEXTURE_2D,t,0,0,m.width,m.height,f,g,m.data):n.texImage2D(e.TEXTURE_2D,t,v,m.width,m.height,0,f,g,m.data);i.generateMipmaps=!1}else T?(M&&n.texStorage2D(e.TEXTURE_2D,E,v,r.width,r.height),n.texSubImage2D(e.TEXTURE_2D,0,0,0,r.width,r.height,f,g,r.data)):n.texImage2D(e.TEXTURE_2D,0,v,r.width,r.height,0,f,g,r.data);else if(i.isCompressedTexture)if(i.isCompressedArrayTexture){T&&M&&n.texStorage3D(e.TEXTURE_2D_ARRAY,E,v,y[0].width,y[0].height,r.depth);for(let t=0,a=y.length;t<a;t++)m=y[t],i.format!==xY?null!==f?T?n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,m.width,m.height,r.depth,f,m.data,0,0):n.compressedTexImage3D(e.TEXTURE_2D_ARRAY,t,v,m.width,m.height,r.depth,0,m.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):T?n.texSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,m.width,m.height,r.depth,f,g,m.data):n.texImage3D(e.TEXTURE_2D_ARRAY,t,v,m.width,m.height,r.depth,0,f,g,m.data)}else{T&&M&&n.texStorage2D(e.TEXTURE_2D,E,v,y[0].width,y[0].height);for(let t=0,r=y.length;t<r;t++)m=y[t],i.format!==xY?null!==f?T?n.compressedTexSubImage2D(e.TEXTURE_2D,t,0,0,m.width,m.height,f,m.data):n.compressedTexImage2D(e.TEXTURE_2D,t,v,m.width,m.height,0,m.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):T?n.texSubImage2D(e.TEXTURE_2D,t,0,0,m.width,m.height,f,g,m.data):n.texImage2D(e.TEXTURE_2D,t,v,m.width,m.height,0,f,g,m.data)}else if(i.isDataArrayTexture)T?(M&&n.texStorage3D(e.TEXTURE_2D_ARRAY,E,v,r.width,r.height,r.depth),n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,0,r.width,r.height,r.depth,f,g,r.data)):n.texImage3D(e.TEXTURE_2D_ARRAY,0,v,r.width,r.height,r.depth,0,f,g,r.data);else if(i.isData3DTexture)T?(M&&n.texStorage3D(e.TEXTURE_3D,E,v,r.width,r.height,r.depth),n.texSubImage3D(e.TEXTURE_3D,0,0,0,0,r.width,r.height,r.depth,f,g,r.data)):n.texImage3D(e.TEXTURE_3D,0,v,r.width,r.height,r.depth,0,f,g,r.data);else if(i.isFramebufferTexture){if(M)if(T)n.texStorage2D(e.TEXTURE_2D,E,v,r.width,r.height);else{let t=r.width,i=r.height;for(let r=0;r<E;r++)n.texImage2D(e.TEXTURE_2D,r,v,t,i,0,f,g,null),t>>=1,i>>=1}}else if(y.length>0&&p){T&&M&&n.texStorage2D(e.TEXTURE_2D,E,v,y[0].width,y[0].height);for(let t=0,r=y.length;t<r;t++)m=y[t],T?n.texSubImage2D(e.TEXTURE_2D,t,0,0,f,g,m):n.texImage2D(e.TEXTURE_2D,t,v,f,g,m);i.generateMipmaps=!1}else T?(M&&n.texStorage2D(e.TEXTURE_2D,E,v,r.width,r.height),n.texSubImage2D(e.TEXTURE_2D,0,0,0,f,g,r)):n.texImage2D(e.TEXTURE_2D,0,v,f,g,r);x(i,p)&&w(l),h.__version=d.version,i.onUpdate&&i.onUpdate(i)}t.__version=i.version}function B(t,i,s,o,l){const u=a.convert(s.format,s.colorSpace),c=a.convert(s.type),d=S(s.internalFormat,u,c,s.colorSpace);r.get(i).__hasExternalTextures||(l===e.TEXTURE_3D||l===e.TEXTURE_2D_ARRAY?n.texImage3D(l,0,d,i.width,i.height,i.depth,0,u,c,null):n.texImage2D(l,0,d,i.width,i.height,0,u,c,null)),n.bindFramebuffer(e.FRAMEBUFFER,t),V(i)?h.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,o,l,r.get(s).__webglTexture,0,F(i)):(l===e.TEXTURE_2D||l>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&l<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&e.framebufferTexture2D(e.FRAMEBUFFER,o,l,r.get(s).__webglTexture,0),n.bindFramebuffer(e.FRAMEBUFFER,null)}function U(t,n,r){if(e.bindRenderbuffer(e.RENDERBUFFER,t),n.depthBuffer&&!n.stencilBuffer){let i=e.DEPTH_COMPONENT16;if(r||V(n)){const t=n.depthTexture;t&&t.isDepthTexture&&(t.type===yY?i=e.DEPTH_COMPONENT32F:t.type===vY&&(i=e.DEPTH_COMPONENT24));const r=F(n);V(n)?h.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,r,i,n.width,n.height):e.renderbufferStorageMultisample(e.RENDERBUFFER,r,i,n.width,n.height)}else e.renderbufferStorage(e.RENDERBUFFER,i,n.width,n.height);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t)}else if(n.depthBuffer&&n.stencilBuffer){const i=F(n);r&&!1===V(n)?e.renderbufferStorageMultisample(e.RENDERBUFFER,i,e.DEPTH24_STENCIL8,n.width,n.height):V(n)?h.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,i,e.DEPTH24_STENCIL8,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,n.width,n.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t)}else{const t=!0===n.isWebGLMultipleRenderTargets?n.texture:[n.texture];for(let i=0;i<t.length;i++){const s=t[i],o=a.convert(s.format,s.colorSpace),l=a.convert(s.type),u=S(s.internalFormat,o,l,s.colorSpace),c=F(n);r&&!1===V(n)?e.renderbufferStorageMultisample(e.RENDERBUFFER,c,u,n.width,n.height):V(n)?h.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,c,u,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,u,n.width,n.height)}}e.bindRenderbuffer(e.RENDERBUFFER,null)}function z(t){const i=r.get(t),a=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture&&!i.__autoAllocateDepthBuffer){if(a)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,i){if(i&&i.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(e.FRAMEBUFFER,t),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(i.depthTexture).__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),R(i.depthTexture,0);const a=r.get(i.depthTexture).__webglTexture,s=F(i);if(i.depthTexture.format===wY)V(i)?h.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a,0,s):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a,0);else{if(i.depthTexture.format!==SY)throw new Error("Unknown depthTexture format");V(i)?h.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,a,0,s):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,a,0)}}(i.__webglFramebuffer,t)}else if(a){i.__webglDepthbuffer=[];for(let r=0;r<6;r++)n.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer[r]),i.__webglDepthbuffer[r]=e.createRenderbuffer(),U(i.__webglDepthbuffer[r],t,!1)}else n.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer),i.__webglDepthbuffer=e.createRenderbuffer(),U(i.__webglDepthbuffer,t,!1);n.bindFramebuffer(e.FRAMEBUFFER,null)}function F(e){return Math.min(d,e.samples)}function V(e){const n=r.get(e);return o&&e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==n.__useRenderToTexture}function G(e,n){const r=e.colorSpace,i=e.format,a=e.type;return!0===e.isCompressedTexture||e.format===jY||r!==zY&&r!==BY&&(r===UY?!1===o?!0===t.has("EXT_sRGB")&&i===xY?(e.format=jY,e.minFilter=hY,e.generateMipmaps=!1):n=S$.sRGBToLinear(n):i===xY&&a===fY||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",r)),n}this.allocateTextureUnit=function(){const e=P;return e>=l&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+l),P+=1,e},this.resetTextureUnits=function(){P=0},this.setTexture2D=R,this.setTexture2DArray=function(t,i){const a=r.get(t);t.version>0&&a.__version!==t.version?N(a,t,i):n.bindTexture(e.TEXTURE_2D_ARRAY,a.__webglTexture,e.TEXTURE0+i)},this.setTexture3D=function(t,i){const a=r.get(t);t.version>0&&a.__version!==t.version?N(a,t,i):n.bindTexture(e.TEXTURE_3D,a.__webglTexture,e.TEXTURE0+i)},this.setTextureCube=function(t,i){const s=r.get(t);t.version>0&&s.__version!==t.version?function(t,i,s){if(6!==i.image.length)return;const l=O(t,i),c=i.source;n.bindTexture(e.TEXTURE_CUBE_MAP,t.__webglTexture,e.TEXTURE0+s);const d=r.get(c);if(c.version!==d.__version||!0===l){n.activeTexture(e.TEXTURE0+s),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,i.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,i.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE);const t=i.isCompressedTexture||i.image[0].isCompressedTexture,r=i.image[0]&&i.image[0].isDataTexture,h=[];for(let e=0;e<6;e++)h[e]=t||r?r?i.image[e].image:i.image[e]:_(i.image[e],!1,!0,u),h[e]=G(i,h[e]);const p=h[0],f=b(p)||o,m=a.convert(i.format,i.colorSpace),g=a.convert(i.type),v=S(i.internalFormat,m,g,i.colorSpace),y=o&&!0!==i.isVideoTexture,T=void 0===d.__version||!0===l;let M,E=C(i,p,f);if(I(e.TEXTURE_CUBE_MAP,i,f),t){y&&T&&n.texStorage2D(e.TEXTURE_CUBE_MAP,E,v,p.width,p.height);for(let t=0;t<6;t++){M=h[t].mipmaps;for(let r=0;r<M.length;r++){const a=M[r];i.format!==xY?null!==m?y?n.compressedTexSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r,0,0,a.width,a.height,m,a.data):n.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r,v,a.width,a.height,0,a.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):y?n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r,0,0,a.width,a.height,m,g,a.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r,v,a.width,a.height,0,m,g,a.data)}}}else{M=i.mipmaps,y&&T&&(M.length>0&&E++,n.texStorage2D(e.TEXTURE_CUBE_MAP,E,v,h[0].width,h[0].height));for(let t=0;t<6;t++)if(r){y?n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,h[t].width,h[t].height,m,g,h[t].data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,v,h[t].width,h[t].height,0,m,g,h[t].data);for(let r=0;r<M.length;r++){const i=M[r].image[t].image;y?n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,0,0,i.width,i.height,m,g,i.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,v,i.width,i.height,0,m,g,i.data)}}else{y?n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,m,g,h[t]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,v,m,g,h[t]);for(let r=0;r<M.length;r++){const i=M[r];y?n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,0,0,m,g,i.image[t]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,v,m,g,i.image[t])}}}x(i,f)&&w(e.TEXTURE_CUBE_MAP),d.__version=c.version,i.onUpdate&&i.onUpdate(i)}t.__version=i.version}(s,t,i):n.bindTexture(e.TEXTURE_CUBE_MAP,s.__webglTexture,e.TEXTURE0+i)},this.rebindTextures=function(t,n,i){const a=r.get(t);void 0!==n&&B(a.__webglFramebuffer,t,t.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D),void 0!==i&&z(t)},this.setupRenderTarget=function(t){const l=t.texture,u=r.get(t),c=r.get(l);t.addEventListener("dispose",E),!0!==t.isWebGLMultipleRenderTargets&&(void 0===c.__webglTexture&&(c.__webglTexture=e.createTexture()),c.__version=l.version,s.memory.textures++);const d=!0===t.isWebGLCubeRenderTarget,h=!0===t.isWebGLMultipleRenderTargets,p=b(t)||o;if(d){u.__webglFramebuffer=[];for(let t=0;t<6;t++)u.__webglFramebuffer[t]=e.createFramebuffer()}else{if(u.__webglFramebuffer=e.createFramebuffer(),h)if(i.drawBuffers){const n=t.texture;for(let t=0,i=n.length;t<i;t++){const i=r.get(n[t]);void 0===i.__webglTexture&&(i.__webglTexture=e.createTexture(),s.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(o&&t.samples>0&&!1===V(t)){const r=h?l:[l];u.__webglMultisampledFramebuffer=e.createFramebuffer(),u.__webglColorRenderbuffer=[],n.bindFramebuffer(e.FRAMEBUFFER,u.__webglMultisampledFramebuffer);for(let n=0;n<r.length;n++){const i=r[n];u.__webglColorRenderbuffer[n]=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,u.__webglColorRenderbuffer[n]);const s=a.convert(i.format,i.colorSpace),o=a.convert(i.type),l=S(i.internalFormat,s,o,i.colorSpace,!0===t.isXRRenderTarget),c=F(t);e.renderbufferStorageMultisample(e.RENDERBUFFER,c,l,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+n,e.RENDERBUFFER,u.__webglColorRenderbuffer[n])}e.bindRenderbuffer(e.RENDERBUFFER,null),t.depthBuffer&&(u.__webglDepthRenderbuffer=e.createRenderbuffer(),U(u.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(e.FRAMEBUFFER,null)}}if(d){n.bindTexture(e.TEXTURE_CUBE_MAP,c.__webglTexture),I(e.TEXTURE_CUBE_MAP,l,p);for(let n=0;n<6;n++)B(u.__webglFramebuffer[n],t,l,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+n);x(l,p)&&w(e.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(h){const i=t.texture;for(let a=0,s=i.length;a<s;a++){const s=i[a],o=r.get(s);n.bindTexture(e.TEXTURE_2D,o.__webglTexture),I(e.TEXTURE_2D,s,p),B(u.__webglFramebuffer,t,s,e.COLOR_ATTACHMENT0+a,e.TEXTURE_2D),x(s,p)&&w(e.TEXTURE_2D)}n.unbindTexture()}else{let r=e.TEXTURE_2D;(t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(o?r=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),n.bindTexture(r,c.__webglTexture),I(r,l,p),B(u.__webglFramebuffer,t,l,e.COLOR_ATTACHMENT0,r),x(l,p)&&w(r),n.unbindTexture()}t.depthBuffer&&z(t)},this.updateRenderTargetMipmap=function(t){const i=b(t)||o,a=!0===t.isWebGLMultipleRenderTargets?t.texture:[t.texture];for(let s=0,o=a.length;s<o;s++){const o=a[s];if(x(o,i)){const i=t.isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D,a=r.get(o).__webglTexture;n.bindTexture(i,a),w(i),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(o&&t.samples>0&&!1===V(t)){const i=t.isWebGLMultipleRenderTargets?t.texture:[t.texture],a=t.width,s=t.height;let o=e.COLOR_BUFFER_BIT;const l=[],u=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,c=r.get(t),d=!0===t.isWebGLMultipleRenderTargets;if(d)for(let t=0;t<i.length;t++)n.bindFramebuffer(e.FRAMEBUFFER,c.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,null),n.bindFramebuffer(e.FRAMEBUFFER,c.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,null,0);n.bindFramebuffer(e.READ_FRAMEBUFFER,c.__webglMultisampledFramebuffer),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,c.__webglFramebuffer);for(let n=0;n<i.length;n++){l.push(e.COLOR_ATTACHMENT0+n),t.depthBuffer&&l.push(u);const h=void 0!==c.__ignoreDepthValues&&c.__ignoreDepthValues;if(!1===h&&(t.depthBuffer&&(o|=e.DEPTH_BUFFER_BIT),t.stencilBuffer&&(o|=e.STENCIL_BUFFER_BIT)),d&&e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,c.__webglColorRenderbuffer[n]),!0===h&&(e.invalidateFramebuffer(e.READ_FRAMEBUFFER,[u]),e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[u])),d){const t=r.get(i[n]).__webglTexture;e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}e.blitFramebuffer(0,0,a,s,0,0,a,s,o,e.NEAREST),p&&e.invalidateFramebuffer(e.READ_FRAMEBUFFER,l)}if(n.bindFramebuffer(e.READ_FRAMEBUFFER,null),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),d)for(let t=0;t<i.length;t++){n.bindFramebuffer(e.FRAMEBUFFER,c.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,c.__webglColorRenderbuffer[t]);const a=r.get(i[t]).__webglTexture;n.bindFramebuffer(e.FRAMEBUFFER,c.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,a,0)}n.bindFramebuffer(e.DRAW_FRAMEBUFFER,c.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=z,this.setupFrameBufferTexture=B,this.useMultisampledRTT=V}function EJ(e,t,n){const r=n.isWebGL2;return{convert:function(n,i=""){let a;if(n===fY)return e.UNSIGNED_BYTE;if(1017===n)return e.UNSIGNED_SHORT_4_4_4_4;if(1018===n)return e.UNSIGNED_SHORT_5_5_5_1;if(1010===n)return e.BYTE;if(1011===n)return e.SHORT;if(n===mY)return e.UNSIGNED_SHORT;if(n===gY)return e.INT;if(n===vY)return e.UNSIGNED_INT;if(n===yY)return e.FLOAT;if(n===_Y)return r?e.HALF_FLOAT:(a=t.get("OES_texture_half_float"),null!==a?a.HALF_FLOAT_OES:null);if(1021===n)return e.ALPHA;if(n===xY)return e.RGBA;if(1024===n)return e.LUMINANCE;if(1025===n)return e.LUMINANCE_ALPHA;if(n===wY)return e.DEPTH_COMPONENT;if(n===SY)return e.DEPTH_STENCIL;if(n===jY)return a=t.get("EXT_sRGB"),null!==a?a.SRGB_ALPHA_EXT:null;if(1028===n)return e.RED;if(1029===n)return e.RED_INTEGER;if(1030===n)return e.RG;if(1031===n)return e.RG_INTEGER;if(1033===n)return e.RGBA_INTEGER;if(n===CY||n===TY||n===MY||n===EY)if(i===UY){if(a=t.get("WEBGL_compressed_texture_s3tc_srgb"),null===a)return null;if(n===CY)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===TY)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===MY)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===EY)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(a=t.get("WEBGL_compressed_texture_s3tc"),null===a)return null;if(n===CY)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===TY)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===MY)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===EY)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===n||35841===n||35842===n||35843===n){if(a=t.get("WEBGL_compressed_texture_pvrtc"),null===a)return null;if(35840===n)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===n)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===n)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===n)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===n)return a=t.get("WEBGL_compressed_texture_etc1"),null!==a?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===n||37496===n){if(a=t.get("WEBGL_compressed_texture_etc"),null===a)return null;if(37492===n)return i===UY?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(37496===n)return i===UY?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(37808===n||37809===n||37810===n||37811===n||37812===n||37813===n||37814===n||37815===n||37816===n||37817===n||37818===n||37819===n||37820===n||37821===n){if(a=t.get("WEBGL_compressed_texture_astc"),null===a)return null;if(37808===n)return i===UY?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===n)return i===UY?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===n)return i===UY?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===n)return i===UY?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===n)return i===UY?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===n)return i===UY?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===n)return i===UY?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===n)return i===UY?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===n)return i===UY?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===n)return i===UY?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===n)return i===UY?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===n)return i===UY?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===n)return i===UY?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===n)return i===UY?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(n===AY){if(a=t.get("EXT_texture_compression_bptc"),null===a)return null;if(n===AY)return i===UY?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(36283===n||36284===n||36285===n||36286===n){if(a=t.get("EXT_texture_compression_rgtc"),null===a)return null;if(n===AY)return a.COMPRESSED_RED_RGTC1_EXT;if(36284===n)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===n)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===n)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return n===bY?r?e.UNSIGNED_INT_24_8:(a=t.get("WEBGL_depth_texture"),null!==a?a.UNSIGNED_INT_24_8_WEBGL:null):void 0!==e[n]?e[n]:null}}}class AJ extends Yq{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class PJ extends OX{constructor(){super(),this.isGroup=!0,this.type="Group"}}const RJ={type:"move"};class LJ{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new PJ,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new PJ,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new I$,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new I$),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new PJ,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new I$,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new I$),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let r=null,i=null,a=null;const s=this._targetRay,o=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){a=!0;for(const a of e.hand.values()){const e=t.getJointPose(a,n),r=this._getHandJoint(l,a);null!==e&&(r.matrix.fromArray(e.transform.matrix),r.matrix.decompose(r.position,r.rotation,r.scale),r.matrixWorldNeedsUpdate=!0,r.jointRadius=e.radius),r.visible=null!==e}const r=l.joints["index-finger-tip"],i=l.joints["thumb-tip"],s=r.position.distanceTo(i.position),o=.02,u=.005;l.inputState.pinching&&s>o+u?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&s<=o-u&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==o&&e.gripSpace&&(i=t.getPose(e.gripSpace,n),null!==i&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1));null!==s&&(r=t.getPose(e.targetRaySpace,n),null===r&&null!==i&&(r=i),null!==r&&(s.matrix.fromArray(r.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),s.matrixWorldNeedsUpdate=!0,r.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(r.linearVelocity)):s.hasLinearVelocity=!1,r.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(r.angularVelocity)):s.hasAngularVelocity=!1,this.dispatchEvent(RJ)))}return null!==s&&(s.visible=null!==r),null!==o&&(o.visible=null!==i),null!==l&&(l.visible=null!==a),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const n=new PJ;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class kJ extends A${constructor(e,t,n,r,i,a,s,o,l,u){if((u=void 0!==u?u:wY)!==wY&&u!==SY)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&u===wY&&(n=vY),void 0===n&&u===SY&&(n=bY),super(null,r,i,a,s,o,u,n,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==s?s:uY,this.minFilter=void 0!==o?o:uY,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class DJ extends $Y{constructor(e,t){super();const n=this;let r=null,i=1,a=null,s="local-floor",o=1,l=null,u=null,c=null,d=null,h=null,p=null;const f=t.getContextAttributes();let m=null,g=null;const v=[],y=[];let _=null;const b=new Yq;b.layers.enable(1),b.viewport=new P$;const x=new Yq;x.layers.enable(2),x.viewport=new P$;const w=[b,x],S=new AJ;S.layers.enable(1),S.layers.enable(2);let C=null,T=null;function M(e){const t=y.indexOf(e.inputSource);if(-1===t)return;const n=v[t];void 0!==n&&(n.update(e.inputSource,e.frame,l||a),n.dispatchEvent({type:e.type,data:e.inputSource}))}function E(){r.removeEventListener("select",M),r.removeEventListener("selectstart",M),r.removeEventListener("selectend",M),r.removeEventListener("squeeze",M),r.removeEventListener("squeezestart",M),r.removeEventListener("squeezeend",M),r.removeEventListener("end",E),r.removeEventListener("inputsourceschange",A);for(let e=0;e<v.length;e++){const t=y[e];null!==t&&(y[e]=null,v[e].disconnect(t))}C=null,T=null,e.setRenderTarget(m),h=null,d=null,c=null,r=null,g=null,D.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function A(e){for(let t=0;t<e.removed.length;t++){const n=e.removed[t],r=y.indexOf(n);r>=0&&(y[r]=null,v[r].disconnect(n))}for(let t=0;t<e.added.length;t++){const n=e.added[t];let r=y.indexOf(n);if(-1===r){for(let e=0;e<v.length;e++){if(e>=y.length){y.push(n),r=e;break}if(null===y[e]){y[e]=n,r=e;break}}if(-1===r)break}const i=v[r];i&&i.connect(n)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getCamera=function(){},this.setUserCamera=function(e){_=e},this.getController=function(e){let t=v[e];return void 0===t&&(t=new LJ,v[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=v[e];return void 0===t&&(t=new LJ,v[e]=t),t.getGripSpace()},this.getHand=function(e){let t=v[e];return void 0===t&&(t=new LJ,v[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){i=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){s=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||a},this.setReferenceSpace=function(e){l=e},this.getBaseLayer=function(){return null!==d?d:h},this.getBinding=function(){return c},this.getFrame=function(){return p},this.getSession=function(){return r},this.setSession=async function(u){if(r=u,null!==r){if(m=e.getRenderTarget(),r.addEventListener("select",M),r.addEventListener("selectstart",M),r.addEventListener("selectend",M),r.addEventListener("squeeze",M),r.addEventListener("squeezestart",M),r.addEventListener("squeezeend",M),r.addEventListener("end",E),r.addEventListener("inputsourceschange",A),!0!==f.xrCompatible&&await t.makeXRCompatible(),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2){const n={antialias:void 0!==r.renderState.layers||f.antialias,alpha:!0,depth:f.depth,stencil:f.stencil,framebufferScaleFactor:i};h=new XRWebGLLayer(r,t,n),r.updateRenderState({baseLayer:h}),g=new R$(h.framebufferWidth,h.framebufferHeight,{format:xY,type:fY,colorSpace:e.outputColorSpace,stencilBuffer:f.stencil})}else{let n=null,a=null,s=null;f.depth&&(s=f.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,n=f.stencil?SY:wY,a=f.stencil?bY:vY);const o={colorFormat:t.RGBA8,depthFormat:s,scaleFactor:i};c=new XRWebGLBinding(r,t),d=c.createProjectionLayer(o),r.updateRenderState({layers:[d]}),g=new R$(d.textureWidth,d.textureHeight,{format:xY,type:fY,depthTexture:new kJ(d.textureWidth,d.textureHeight,a,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:f.stencil,colorSpace:e.outputColorSpace,samples:f.antialias?4:0});e.properties.get(g).__ignoreDepthValues=d.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(o),l=null,a=await r.requestReferenceSpace(s),D.setContext(r),D.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(null!==r)return r.environmentBlendMode};const P=new I$,R=new I$;function L(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCameraXR=function(e){if(null===r)return e;_&&(e=_),S.near=x.near=b.near=e.near,S.far=x.far=b.far=e.far,C===S.near&&T===S.far||(r.updateRenderState({depthNear:S.near,depthFar:S.far}),C=S.near,T=S.far);const t=e.parent,n=S.cameras;L(S,t);for(let r=0;r<n.length;r++)L(n[r],t);return 2===n.length?function(e,t,n){P.setFromMatrixPosition(t.matrixWorld),R.setFromMatrixPosition(n.matrixWorld);const r=P.distanceTo(R),i=t.projectionMatrix.elements,a=n.projectionMatrix.elements,s=i[14]/(i[10]-1),o=i[14]/(i[10]+1),l=(i[9]+1)/i[5],u=(i[9]-1)/i[5],c=(i[8]-1)/i[0],d=(a[8]+1)/a[0],h=s*c,p=s*d,f=r/(-c+d),m=f*-c;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(f),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();const g=s+f,v=o+f,y=h-m,_=p+(r-m),b=l*o/v*g,x=u*o/v*g;e.projectionMatrix.makePerspective(y,_,b,x,g,v),e.projectionMatrixInverse.copy(e.projectionMatrix).invert()}(S,b,x):S.projectionMatrix.copy(b.projectionMatrix),_&&function(e,t){const n=_;null===t?n.matrix.copy(e.matrixWorld):(n.matrix.copy(t.matrixWorld),n.matrix.invert(),n.matrix.multiply(e.matrixWorld));n.matrix.decompose(n.position,n.quaternion,n.scale),n.updateMatrixWorld(!0);const r=n.children;for(let i=0,a=r.length;i<a;i++)r[i].updateMatrixWorld(!0);n.projectionMatrix.copy(e.projectionMatrix),n.projectionMatrixInverse.copy(e.projectionMatrixInverse),n.isPerspectiveCamera&&(n.fov=2*ZY*Math.atan(1/n.projectionMatrix.elements[5]),n.zoom=1)}(S,t),S},this.getFoveation=function(){if(null!==d||null!==h)return o},this.setFoveation=function(e){o=e,null!==d&&(d.fixedFoveation=e),null!==h&&void 0!==h.fixedFoveation&&(h.fixedFoveation=e)};let k=null;const D=new iK;D.setAnimationLoop((function(t,r){if(u=r.getViewerPose(l||a),p=r,null!==u){const t=u.views;null!==h&&(e.setRenderTargetFramebuffer(g,h.framebuffer),e.setRenderTarget(g));let n=!1;t.length!==S.cameras.length&&(S.cameras.length=0,n=!0);for(let r=0;r<t.length;r++){const i=t[r];let a=null;if(null!==h)a=h.getViewport(i);else{const t=c.getViewSubImage(d,i);a=t.viewport,0===r&&(e.setRenderTargetTextures(g,t.colorTexture,d.ignoreDepthValues?void 0:t.depthStencilTexture),e.setRenderTarget(g))}let s=w[r];void 0===s&&(s=new Yq,s.layers.enable(r),s.viewport=new P$,w[r]=s),s.matrix.fromArray(i.transform.matrix),s.matrix.decompose(s.position,s.quaternion,s.scale),s.projectionMatrix.fromArray(i.projectionMatrix),s.projectionMatrixInverse.copy(s.projectionMatrix).invert(),s.viewport.set(a.x,a.y,a.width,a.height),0===r&&(S.matrix.copy(s.matrix),S.matrix.decompose(S.position,S.quaternion,S.scale)),!0===n&&S.cameras.push(s)}}for(let e=0;e<v.length;e++){const t=y[e],n=v[e];null!==t&&void 0!==n&&n.update(t,r,l||a)}k&&k(t,r),r.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:r}),p=null})),this.setAnimationLoop=function(e){k=e},this.dispose=function(){}}}function IJ(e,t){function n(e,t){!0===e.matrixAutoUpdate&&e.updateMatrix(),t.value.copy(e.matrix)}function r(r,i){r.opacity.value=i.opacity,i.color&&r.diffuse.value.copy(i.color),i.emissive&&r.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),i.map&&(r.map.value=i.map,n(i.map,r.mapTransform)),i.alphaMap&&(r.alphaMap.value=i.alphaMap,n(i.alphaMap,r.alphaMapTransform)),i.bumpMap&&(r.bumpMap.value=i.bumpMap,n(i.bumpMap,r.bumpMapTransform),r.bumpScale.value=i.bumpScale,i.side===YW&&(r.bumpScale.value*=-1)),i.normalMap&&(r.normalMap.value=i.normalMap,n(i.normalMap,r.normalMapTransform),r.normalScale.value.copy(i.normalScale),i.side===YW&&r.normalScale.value.negate()),i.displacementMap&&(r.displacementMap.value=i.displacementMap,n(i.displacementMap,r.displacementMapTransform),r.displacementScale.value=i.displacementScale,r.displacementBias.value=i.displacementBias),i.emissiveMap&&(r.emissiveMap.value=i.emissiveMap,n(i.emissiveMap,r.emissiveMapTransform)),i.specularMap&&(r.specularMap.value=i.specularMap,n(i.specularMap,r.specularMapTransform)),i.alphaTest>0&&(r.alphaTest.value=i.alphaTest);const a=t.get(i).envMap;if(a&&(r.envMap.value=a,r.flipEnvMap.value=a.isCubeTexture&&!1===a.isRenderTargetTexture?-1:1,r.reflectivity.value=i.reflectivity,r.ior.value=i.ior,r.refractionRatio.value=i.refractionRatio),i.lightMap){r.lightMap.value=i.lightMap;const t=!0===e.useLegacyLights?Math.PI:1;r.lightMapIntensity.value=i.lightMapIntensity*t,n(i.lightMap,r.lightMapTransform)}i.aoMap&&(r.aoMap.value=i.aoMap,r.aoMapIntensity.value=i.aoMapIntensity,n(i.aoMap,r.aoMapTransform))}return{refreshFogUniforms:function(t,n){n.color.getRGB(t.fogColor.value,Gq(e)),n.isFog?(t.fogNear.value=n.near,t.fogFar.value=n.far):n.isFogExp2&&(t.fogDensity.value=n.density)},refreshMaterialUniforms:function(e,i,a,s,o){i.isMeshBasicMaterial||i.isMeshLambertMaterial?r(e,i):i.isMeshToonMaterial?(r(e,i),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(e,i)):i.isMeshPhongMaterial?(r(e,i),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}(e,i)):i.isMeshStandardMaterial?(r(e,i),function(e,r){e.metalness.value=r.metalness,r.metalnessMap&&(e.metalnessMap.value=r.metalnessMap,n(r.metalnessMap,e.metalnessMapTransform));e.roughness.value=r.roughness,r.roughnessMap&&(e.roughnessMap.value=r.roughnessMap,n(r.roughnessMap,e.roughnessMapTransform));const i=t.get(r).envMap;i&&(e.envMapIntensity.value=r.envMapIntensity)}(e,i),i.isMeshPhysicalMaterial&&function(e,t,r){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap,n(t.sheenColorMap,e.sheenColorMapTransform)),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap,n(t.sheenRoughnessMap,e.sheenRoughnessMapTransform)));t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap,n(t.clearcoatMap,e.clearcoatMapTransform)),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap,n(t.clearcoatRoughnessMap,e.clearcoatRoughnessMapTransform)),t.clearcoatNormalMap&&(e.clearcoatNormalMap.value=t.clearcoatNormalMap,n(t.clearcoatNormalMap,e.clearcoatNormalMapTransform),e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),t.side===YW&&e.clearcoatNormalScale.value.negate()));t.iridescence>0&&(e.iridescence.value=t.iridescence,e.iridescenceIOR.value=t.iridescenceIOR,e.iridescenceThicknessMinimum.value=t.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=t.iridescenceThicknessRange[1],t.iridescenceMap&&(e.iridescenceMap.value=t.iridescenceMap,n(t.iridescenceMap,e.iridescenceMapTransform)),t.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=t.iridescenceThicknessMap,n(t.iridescenceThicknessMap,e.iridescenceThicknessMapTransform)));t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=r.texture,e.transmissionSamplerSize.value.set(r.width,r.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap,n(t.transmissionMap,e.transmissionMapTransform)),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap,n(t.thicknessMap,e.thicknessMapTransform)),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor));t.anisotropy>0&&(e.anisotropyVector.value.set(t.anisotropy*Math.cos(t.anisotropyRotation),t.anisotropy*Math.sin(t.anisotropyRotation)),t.anisotropyMap&&(e.anisotropyMap.value=t.anisotropyMap,n(t.anisotropyMap,e.anisotropyMapTransform)));e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap,n(t.specularColorMap,e.specularColorMapTransform));t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap,n(t.specularIntensityMap,e.specularIntensityMapTransform))}(e,i,o)):i.isMeshMatcapMaterial?(r(e,i),function(e,t){t.matcap&&(e.matcap.value=t.matcap)}(e,i)):i.isMeshDepthMaterial?r(e,i):i.isMeshDistanceMaterial?(r(e,i),function(e,n){const r=t.get(n).light;e.referencePosition.value.setFromMatrixPosition(r.matrixWorld),e.nearDistance.value=r.shadow.camera.near,e.farDistance.value=r.shadow.camera.far}(e,i)):i.isMeshNormalMaterial?r(e,i):i.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform))}(e,i),i.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,i)):i.isPointsMaterial?function(e,t,r,i){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*r,e.scale.value=.5*i,t.map&&(e.map.value=t.map,n(t.map,e.uvTransform));t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform));t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,i,a,s):i.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform));t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform));t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,i):i.isShadowMaterial?(e.color.value.copy(i.color),e.opacity.value=i.opacity):i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)}}}function OJ(e,t,n,r){let i={},a={},s=[];const o=n.isWebGL2?e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(e,t,n){const r=e.value;if(void 0===n[t]){if("number"==typeof r)n[t]=r;else{const e=Array.isArray(r)?r:[r],i=[];for(let t=0;t<e.length;t++)i.push(e[t].clone());n[t]=i}return!0}if("number"==typeof r){if(n[t]!==r)return n[t]=r,!0}else{const e=Array.isArray(n[t])?n[t]:[n[t]],i=Array.isArray(r)?r:[r];for(let t=0;t<e.length;t++){const n=e[t];if(!1===n.equals(i[t]))return n.copy(i[t]),!0}}return!1}function u(e){const t={boundary:0,storage:0};return"number"==typeof e?(t.boundary=4,t.storage=4):e.isVector2?(t.boundary=8,t.storage=8):e.isVector3||e.isColor?(t.boundary=16,t.storage=12):e.isVector4?(t.boundary=16,t.storage=16):e.isMatrix3?(t.boundary=48,t.storage=48):e.isMatrix4?(t.boundary=64,t.storage=64):e.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",e),t}function c(t){const n=t.target;n.removeEventListener("dispose",c);const r=s.indexOf(n.__bindingPointIndex);s.splice(r,1),e.deleteBuffer(i[n.id]),delete i[n.id],delete a[n.id]}return{bind:function(e,t){const n=t.program;r.uniformBlockBinding(e,n)},update:function(n,d){let h=i[n.id];void 0===h&&(!function(e){const t=e.uniforms;let n=0;const r=16;let i=0;for(let a=0,s=t.length;a<s;a++){const e=t[a],s={boundary:0,storage:0},o=Array.isArray(e.value)?e.value:[e.value];for(let t=0,n=o.length;t<n;t++){const e=u(o[t]);s.boundary+=e.boundary,s.storage+=e.storage}if(e.__data=new Float32Array(s.storage/Float32Array.BYTES_PER_ELEMENT),e.__offset=n,a>0){i=n%r;0!==i&&r-i-s.boundary<0&&(n+=r-i,e.__offset=n)}n+=s.storage}i=n%r,i>0&&(n+=r-i);e.__size=n,e.__cache={}}(n),h=function(t){const n=function(){for(let e=0;e<o;e++)if(-1===s.indexOf(e))return s.push(e),e;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();t.__bindingPointIndex=n;const r=e.createBuffer(),i=t.__size,a=t.usage;return e.bindBuffer(e.UNIFORM_BUFFER,r),e.bufferData(e.UNIFORM_BUFFER,i,a),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,n,r),r}(n),i[n.id]=h,n.addEventListener("dispose",c));const p=d.program;r.updateUBOMapping(n,p);const f=t.render.frame;a[n.id]!==f&&(!function(t){const n=i[t.id],r=t.uniforms,a=t.__cache;e.bindBuffer(e.UNIFORM_BUFFER,n);for(let i=0,s=r.length;i<s;i++){const t=r[i];if(!0===l(t,i,a)){const n=t.__offset,r=Array.isArray(t.value)?t.value:[t.value];let i=0;for(let a=0;a<r.length;a++){const s=r[a],o=u(s);"number"==typeof s?(t.__data[0]=s,e.bufferSubData(e.UNIFORM_BUFFER,n+i,t.__data)):s.isMatrix3?(t.__data[0]=s.elements[0],t.__data[1]=s.elements[1],t.__data[2]=s.elements[2],t.__data[3]=s.elements[0],t.__data[4]=s.elements[3],t.__data[5]=s.elements[4],t.__data[6]=s.elements[5],t.__data[7]=s.elements[0],t.__data[8]=s.elements[6],t.__data[9]=s.elements[7],t.__data[10]=s.elements[8],t.__data[11]=s.elements[0]):(s.toArray(t.__data,i),i+=o.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(e.UNIFORM_BUFFER,n,t.__data)}}e.bindBuffer(e.UNIFORM_BUFFER,null)}(n),a[n.id]=f)},dispose:function(){for(const t in i)e.deleteBuffer(i[t]);s=[],i={},a={}}}}function NJ(){const e=h$("canvas");return e.style.display="block",e}class BJ{constructor(e={}){const{canvas:t=NJ(),context:n=null,depth:r=!0,stencil:i=!0,alpha:a=!1,antialias:s=!1,premultipliedAlpha:o=!0,preserveDrawingBuffer:l=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:c=!1}=e;let d;this.isWebGLRenderer=!0,d=null!==n?n.getContextAttributes().alpha:a;const h=new Uint32Array(4),p=new Int32Array(4);let f=null,m=null;const g=[],v=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputColorSpace=UY,this.useLegacyLights=!0,this.toneMapping=ZW,this.toneMappingExposure=1;const y=this;let _=!1,b=0,x=0,w=null,S=-1,C=null;const T=new P$,M=new P$;let E=null;const A=new eq(0);let P=0,R=t.width,L=t.height,k=1,D=null,I=null;const O=new P$(0,0,R,L),N=new P$(0,0,R,L);let B=!1;const U=new rK;let z=!1,F=!1,V=null;const G=new cX,H=new l$,j=new I$,W={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Y(){return null===w?k:1}let $,X,q,K,Z,J,Q,ee,te,ne,re,ie,ae,se,oe,le,ue,ce,de,he,pe,fe,me,ge,ve=n;function ye(e,n){for(let r=0;r<e.length;r++){const i=e[r],a=t.getContext(i,n);if(null!==a)return a}return null}try{const e={alpha:!0,depth:r,stencil:i,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:l,powerPreference:u,failIfMajorPerformanceCaveat:c};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${IW}`),t.addEventListener("webglcontextlost",xe,!1),t.addEventListener("webglcontextrestored",we,!1),t.addEventListener("webglcontextcreationerror",Se,!1),null===ve){const t=["webgl2","webgl","experimental-webgl"];if(!0===y.isWebGL1Renderer&&t.shift(),ve=ye(t,e),null===ve)throw ye(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}ve instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),void 0===ve.getShaderPrecisionFormat&&(ve.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Oe){throw console.error("THREE.WebGLRenderer: "+Oe.message),Oe}function _e(){$=new DK(ve),X=new fK(ve,$,e),$.init(X),fe=new EJ(ve,$,X),q=new TJ(ve,$,X),K=new NK(ve),Z=new dJ,J=new MJ(ve,$,q,Z,X,fe,K),Q=new gK(y),ee=new kK(y),te=new aK(ve,X),me=new hK(ve,$,te,X),ne=new IK(ve,te,K,me),re=new FK(ve,ne,te,K),de=new zK(ve,X,J),le=new mK(Z),ie=new cJ(y,Q,ee,$,X,me,le),ae=new IJ(y,Z),se=new mJ,oe=new xJ($,X),ce=new dK(y,Q,ee,q,re,d,o),ue=new CJ(y,re,X),ge=new OJ(ve,K,X,q),he=new pK(ve,$,K,X),pe=new OK(ve,$,K,X),K.programs=ie.programs,y.capabilities=X,y.extensions=$,y.properties=Z,y.renderLists=se,y.shadowMap=ue,y.state=q,y.info=K}_e();const be=new DJ(y,ve);function xe(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),_=!0}function we(){console.log("THREE.WebGLRenderer: Context Restored."),_=!1;const e=K.autoReset,t=ue.enabled,n=ue.autoUpdate,r=ue.needsUpdate,i=ue.type;_e(),K.autoReset=e,ue.enabled=t,ue.autoUpdate=n,ue.needsUpdate=r,ue.type=i}function Se(e){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",e.statusMessage)}function Ce(e){const t=e.target;t.removeEventListener("dispose",Ce),function(e){(function(e){const t=Z.get(e).programs;void 0!==t&&(t.forEach((function(e){ie.releaseProgram(e)})),e.isShaderMaterial&&ie.releaseShaderCache(e))})(e),Z.remove(e)}(t)}this.xr=be,this.getContext=function(){return ve},this.getContextAttributes=function(){return ve.getContextAttributes()},this.forceContextLoss=function(){const e=$.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){const e=$.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return k},this.setPixelRatio=function(e){void 0!==e&&(k=e,this.setSize(R,L,!1))},this.getSize=function(e){return e.set(R,L)},this.setSize=function(e,n,r=!0){be.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(R=e,L=n,t.width=Math.floor(e*k),t.height=Math.floor(n*k),!0===r&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return e.set(R*k,L*k).floor()},this.setDrawingBufferSize=function(e,n,r){R=e,L=n,k=r,t.width=Math.floor(e*r),t.height=Math.floor(n*r),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return e.copy(T)},this.getViewport=function(e){return e.copy(O)},this.setViewport=function(e,t,n,r){e.isVector4?O.set(e.x,e.y,e.z,e.w):O.set(e,t,n,r),q.viewport(T.copy(O).multiplyScalar(k).floor())},this.getScissor=function(e){return e.copy(N)},this.setScissor=function(e,t,n,r){e.isVector4?N.set(e.x,e.y,e.z,e.w):N.set(e,t,n,r),q.scissor(M.copy(N).multiplyScalar(k).floor())},this.getScissorTest=function(){return B},this.setScissorTest=function(e){q.setScissorTest(B=e)},this.setOpaqueSort=function(e){D=e},this.setTransparentSort=function(e){I=e},this.getClearColor=function(e){return e.copy(ce.getClearColor())},this.setClearColor=function(){ce.setClearColor.apply(ce,arguments)},this.getClearAlpha=function(){return ce.getClearAlpha()},this.setClearAlpha=function(){ce.setClearAlpha.apply(ce,arguments)},this.clear=function(e=!0,t=!0,n=!0){let r=0;if(e){let e=!1;if(null!==w){const t=w.texture.format;e=1033===t||1031===t||1029===t}if(e){const e=w.texture.type,t=e===fY||e===vY||e===mY||e===bY||1017===e||1018===e,n=ce.getClearColor(),r=ce.getClearAlpha(),i=n.r,a=n.g,s=n.b,o=Z.get(w).__webglFramebuffer;t?(h[0]=i,h[1]=a,h[2]=s,h[3]=r,ve.clearBufferuiv(ve.COLOR,o,h)):(p[0]=i,p[1]=a,p[2]=s,p[3]=r,ve.clearBufferiv(ve.COLOR,o,p))}else r|=ve.COLOR_BUFFER_BIT}t&&(r|=ve.DEPTH_BUFFER_BIT),n&&(r|=ve.STENCIL_BUFFER_BIT),ve.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",xe,!1),t.removeEventListener("webglcontextrestored",we,!1),t.removeEventListener("webglcontextcreationerror",Se,!1),se.dispose(),oe.dispose(),Z.dispose(),Q.dispose(),ee.dispose(),re.dispose(),me.dispose(),ge.dispose(),ie.dispose(),be.dispose(),be.removeEventListener("sessionstart",Me),be.removeEventListener("sessionend",Ee),V&&(V.dispose(),V=null),Ae.stop()},this.renderBufferDirect=function(e,t,n,r,i,a){null===t&&(t=W);const s=i.isMesh&&i.matrixWorld.determinant()<0,o=function(e,t,n,r,i){!0!==t.isScene&&(t=W);J.resetTextureUnits();const a=t.fog,s=r.isMeshStandardMaterial?t.environment:null,o=null===w?y.outputColorSpace:!0===w.isXRRenderTarget?w.texture.colorSpace:zY,l=(r.isMeshStandardMaterial?ee:Q).get(r.envMap||s),u=!0===r.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,c=!!n.attributes.tangent&&(!!r.normalMap||r.anisotropy>0),d=!!n.morphAttributes.position,h=!!n.morphAttributes.normal,p=!!n.morphAttributes.color,f=r.toneMapped?y.toneMapping:ZW,g=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,v=void 0!==g?g.length:0,_=Z.get(r),b=m.state.lights;if(!0===z&&(!0===F||e!==C)){const t=e===C&&r.id===S;le.setState(r,e,t)}let x=!1;r.version===_.__version?_.needsLights&&_.lightsStateVersion!==b.state.version||_.outputColorSpace!==o||i.isInstancedMesh&&!1===_.instancing?x=!0:i.isInstancedMesh||!0!==_.instancing?i.isSkinnedMesh&&!1===_.skinning?x=!0:i.isSkinnedMesh||!0!==_.skinning?_.envMap!==l||!0===r.fog&&_.fog!==a?x=!0:void 0===_.numClippingPlanes||_.numClippingPlanes===le.numPlanes&&_.numIntersection===le.numIntersection?(_.vertexAlphas!==u||_.vertexTangents!==c||_.morphTargets!==d||_.morphNormals!==h||_.morphColors!==p||_.toneMapping!==f||!0===X.isWebGL2&&_.morphTargetsCount!==v)&&(x=!0):x=!0:x=!0:x=!0:(x=!0,_.__version=r.version);let T=_.currentProgram;!0===x&&(T=De(r,t,i));let M=!1,E=!1,A=!1;const P=T.getUniforms(),R=_.uniforms;q.useProgram(T.program)&&(M=!0,E=!0,A=!0);r.id!==S&&(S=r.id,E=!0);if(M||C!==e){if(P.setValue(ve,"projectionMatrix",e.projectionMatrix),X.logarithmicDepthBuffer&&P.setValue(ve,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),C!==e&&(C=e,E=!0,A=!0),r.isShaderMaterial||r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshStandardMaterial||r.envMap){const t=P.map.cameraPosition;void 0!==t&&t.setValue(ve,j.setFromMatrixPosition(e.matrixWorld))}(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial)&&P.setValue(ve,"isOrthographic",!0===e.isOrthographicCamera),(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial||r.isShadowMaterial||i.isSkinnedMesh)&&P.setValue(ve,"viewMatrix",e.matrixWorldInverse)}if(i.isSkinnedMesh){P.setOptional(ve,i,"bindMatrix"),P.setOptional(ve,i,"bindMatrixInverse");const e=i.skeleton;e&&(X.floatVertexTextures?(null===e.boneTexture&&e.computeBoneTexture(),P.setValue(ve,"boneTexture",e.boneTexture,J),P.setValue(ve,"boneTextureSize",e.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const D=n.morphAttributes;(void 0!==D.position||void 0!==D.normal||void 0!==D.color&&!0===X.isWebGL2)&&de.update(i,n,T);(E||_.receiveShadow!==i.receiveShadow)&&(_.receiveShadow=i.receiveShadow,P.setValue(ve,"receiveShadow",i.receiveShadow));r.isMeshGouraudMaterial&&null!==r.envMap&&(R.envMap.value=l,R.flipEnvMap.value=l.isCubeTexture&&!1===l.isRenderTargetTexture?-1:1);E&&(P.setValue(ve,"toneMappingExposure",y.toneMappingExposure),_.needsLights&&(O=A,(I=R).ambientLightColor.needsUpdate=O,I.lightProbe.needsUpdate=O,I.directionalLights.needsUpdate=O,I.directionalLightShadows.needsUpdate=O,I.pointLights.needsUpdate=O,I.pointLightShadows.needsUpdate=O,I.spotLights.needsUpdate=O,I.spotLightShadows.needsUpdate=O,I.rectAreaLights.needsUpdate=O,I.hemisphereLights.needsUpdate=O),a&&!0===r.fog&&ae.refreshFogUniforms(R,a),ae.refreshMaterialUniforms(R,r,k,L,V),jZ.upload(ve,_.uniformsList,R,J));var I,O;r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(jZ.upload(ve,_.uniformsList,R,J),r.uniformsNeedUpdate=!1);r.isSpriteMaterial&&P.setValue(ve,"center",i.center);if(P.setValue(ve,"modelViewMatrix",i.modelViewMatrix),P.setValue(ve,"normalMatrix",i.normalMatrix),P.setValue(ve,"modelMatrix",i.matrixWorld),r.isShaderMaterial||r.isRawShaderMaterial){const e=r.uniformsGroups;for(let t=0,n=e.length;t<n;t++)if(X.isWebGL2){const n=e[t];ge.update(n,T),ge.bind(n,T)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return T}(e,t,n,r,i);q.setMaterial(r,s);let l=n.index,u=1;!0===r.wireframe&&(l=ne.getWireframeAttribute(n),u=2);const c=n.drawRange,d=n.attributes.position;let h=c.start*u,p=(c.start+c.count)*u;null!==a&&(h=Math.max(h,a.start*u),p=Math.min(p,(a.start+a.count)*u)),null!==l?(h=Math.max(h,0),p=Math.min(p,l.count)):null!=d&&(h=Math.max(h,0),p=Math.min(p,d.count));const f=p-h;if(f<0||f===1/0)return;let g;me.setup(i,r,o,n,l);let v=he;if(null!==l&&(g=te.get(l),v=pe,v.setIndex(g)),i.isMesh)!0===r.wireframe?(q.setLineWidth(r.wireframeLinewidth*Y()),v.setMode(ve.LINES)):v.setMode(ve.TRIANGLES);else if(i.isLine){let e=r.linewidth;void 0===e&&(e=1),q.setLineWidth(e*Y()),i.isLineSegments?v.setMode(ve.LINES):i.isLineLoop?v.setMode(ve.LINE_LOOP):v.setMode(ve.LINE_STRIP)}else i.isPoints?v.setMode(ve.POINTS):i.isSprite&&v.setMode(ve.TRIANGLES);if(i.isInstancedMesh)v.renderInstances(h,f,i.count);else if(n.isInstancedBufferGeometry){const e=void 0!==n._maxInstanceCount?n._maxInstanceCount:1/0,t=Math.min(n.instanceCount,e);v.renderInstances(h,f,t)}else v.render(h,f)},this.compile=function(e,t){function n(e,t,n){!0===e.transparent&&2===e.side&&!1===e.forceSinglePass?(e.side=YW,e.needsUpdate=!0,De(e,t,n),e.side=WW,e.needsUpdate=!0,De(e,t,n),e.side=2):De(e,t,n)}m=oe.get(e),m.init(),v.push(m),e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(m.pushLight(e),e.castShadow&&m.pushShadow(e))})),m.setupLights(y.useLegacyLights),e.traverse((function(t){const r=t.material;if(r)if(Array.isArray(r))for(let i=0;i<r.length;i++){n(r[i],e,t)}else n(r,e,t)})),v.pop(),m=null};let Te=null;function Me(){Ae.stop()}function Ee(){Ae.start()}const Ae=new iK;function Pe(e,t,n,r){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)m.pushLight(e),e.castShadow&&m.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||U.intersectsSprite(e)){r&&j.setFromMatrixPosition(e.matrixWorld).applyMatrix4(G);const t=re.update(e),i=e.material;i.visible&&f.push(e,t,i,n,j.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(!e.frustumCulled||U.intersectsObject(e))){e.isSkinnedMesh&&e.skeleton.frame!==K.render.frame&&(e.skeleton.update(),e.skeleton.frame=K.render.frame);const t=re.update(e),i=e.material;if(r&&(void 0!==e.boundingSphere?(null===e.boundingSphere&&e.computeBoundingSphere(),j.copy(e.boundingSphere.center)):(null===t.boundingSphere&&t.computeBoundingSphere(),j.copy(t.boundingSphere.center)),j.applyMatrix4(e.matrixWorld).applyMatrix4(G)),Array.isArray(i)){const r=t.groups;for(let a=0,s=r.length;a<s;a++){const s=r[a],o=i[s.materialIndex];o&&o.visible&&f.push(e,t,o,n,j.z,s)}}else i.visible&&f.push(e,t,i,n,j.z,null)}const i=e.children;for(let a=0,s=i.length;a<s;a++)Pe(i[a],t,n,r)}function Re(e,t,n,r){const i=e.opaque,a=e.transmissive,o=e.transparent;m.setupLightsView(n),!0===z&&le.setGlobalState(y.clippingPlanes,n),a.length>0&&function(e,t,n,r){const i=X.isWebGL2;null===V&&(V=new R$(1,1,{generateMipmaps:!0,type:$.has("EXT_color_buffer_half_float")?_Y:fY,minFilter:pY,samples:i&&!0===s?4:0}));y.getDrawingBufferSize(H),i?V.setSize(H.x,H.y):V.setSize(i$(H.x),i$(H.y));const a=y.getRenderTarget();y.setRenderTarget(V),y.getClearColor(A),P=y.getClearAlpha(),P<1&&y.setClearColor(16777215,.5);y.clear();const o=y.toneMapping;y.toneMapping=ZW,Le(e,n,r),J.updateMultisampleRenderTarget(V),J.updateRenderTargetMipmap(V);let l=!1;for(let s=0,u=t.length;s<u;s++){const e=t[s],i=e.object,a=e.geometry,o=e.material,u=e.group;if(2===o.side&&i.layers.test(r.layers)){const e=o.side;o.side=YW,o.needsUpdate=!0,ke(i,n,r,a,o,u),o.side=e,o.needsUpdate=!0,l=!0}}!0===l&&(J.updateMultisampleRenderTarget(V),J.updateRenderTargetMipmap(V));y.setRenderTarget(a),y.setClearColor(A,P),y.toneMapping=o}(i,a,t,n),r&&q.viewport(T.copy(r)),i.length>0&&Le(i,t,n),a.length>0&&Le(a,t,n),o.length>0&&Le(o,t,n),q.buffers.depth.setTest(!0),q.buffers.depth.setMask(!0),q.buffers.color.setMask(!0),q.setPolygonOffset(!1)}function Le(e,t,n){const r=!0===t.isScene?t.overrideMaterial:null;for(let i=0,a=e.length;i<a;i++){const a=e[i],s=a.object,o=a.geometry,l=null===r?a.material:r,u=a.group;s.layers.test(n.layers)&&ke(s,t,n,o,l,u)}}function ke(e,t,n,r,i,a){e.onBeforeRender(y,t,n,r,i,a),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),i.onBeforeRender(y,t,n,r,e,a),!0===i.transparent&&2===i.side&&!1===i.forceSinglePass?(i.side=YW,i.needsUpdate=!0,y.renderBufferDirect(n,t,r,i,e,a),i.side=WW,i.needsUpdate=!0,y.renderBufferDirect(n,t,r,i,e,a),i.side=2):y.renderBufferDirect(n,t,r,i,e,a),e.onAfterRender(y,t,n,r,i,a)}function De(e,t,n){!0!==t.isScene&&(t=W);const r=Z.get(e),i=m.state.lights,a=m.state.shadowsArray,s=i.state.version,o=ie.getParameters(e,i.state,a,t,n),l=ie.getProgramCacheKey(o);let u=r.programs;r.environment=e.isMeshStandardMaterial?t.environment:null,r.fog=t.fog,r.envMap=(e.isMeshStandardMaterial?ee:Q).get(e.envMap||r.environment),void 0===u&&(e.addEventListener("dispose",Ce),u=new Map,r.programs=u);let c=u.get(l);if(void 0!==c){if(r.currentProgram===c&&r.lightsStateVersion===s)return Ie(e,o),c}else o.uniforms=ie.getUniforms(e),e.onBuild(n,o,y),e.onBeforeCompile(o,y),c=ie.acquireProgram(o,l),u.set(l,c),r.uniforms=o.uniforms;const d=r.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(d.clippingPlanes=le.uniform),Ie(e,o),r.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),r.lightsStateVersion=s,r.needsLights&&(d.ambientLightColor.value=i.state.ambient,d.lightProbe.value=i.state.probe,d.directionalLights.value=i.state.directional,d.directionalLightShadows.value=i.state.directionalShadow,d.spotLights.value=i.state.spot,d.spotLightShadows.value=i.state.spotShadow,d.rectAreaLights.value=i.state.rectArea,d.ltc_1.value=i.state.rectAreaLTC1,d.ltc_2.value=i.state.rectAreaLTC2,d.pointLights.value=i.state.point,d.pointLightShadows.value=i.state.pointShadow,d.hemisphereLights.value=i.state.hemi,d.directionalShadowMap.value=i.state.directionalShadowMap,d.directionalShadowMatrix.value=i.state.directionalShadowMatrix,d.spotShadowMap.value=i.state.spotShadowMap,d.spotLightMatrix.value=i.state.spotLightMatrix,d.spotLightMap.value=i.state.spotLightMap,d.pointShadowMap.value=i.state.pointShadowMap,d.pointShadowMatrix.value=i.state.pointShadowMatrix);const h=c.getUniforms(),p=jZ.seqWithValue(h.seq,d);return r.currentProgram=c,r.uniformsList=p,c}function Ie(e,t){const n=Z.get(e);n.outputColorSpace=t.outputColorSpace,n.instancing=t.instancing,n.skinning=t.skinning,n.morphTargets=t.morphTargets,n.morphNormals=t.morphNormals,n.morphColors=t.morphColors,n.morphTargetsCount=t.morphTargetsCount,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas,n.vertexTangents=t.vertexTangents,n.toneMapping=t.toneMapping}Ae.setAnimationLoop((function(e){Te&&Te(e)})),"undefined"!=typeof self&&Ae.setContext(self),this.setAnimationLoop=function(e){Te=e,be.setAnimationLoop(e),null===e?Ae.stop():Ae.start()},be.addEventListener("sessionstart",Me),be.addEventListener("sessionend",Ee),this.render=function(e,t){if(void 0!==t&&!0!==t.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===_)return;!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0===be.enabled&&!0===be.isPresenting&&(t=be.updateCameraXR(t)),!0===e.isScene&&e.onBeforeRender(y,e,t,w),m=oe.get(e,v.length),m.init(),v.push(m),G.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),U.setFromProjectionMatrix(G),F=this.localClippingEnabled,z=le.init(this.clippingPlanes,F),f=se.get(e,g.length),f.init(),g.push(f),Pe(e,t,0,y.sortObjects),f.finish(),!0===y.sortObjects&&f.sort(D,I),!0===z&&le.beginShadows();const n=m.state.shadowsArray;if(ue.render(n,e,t),!0===z&&le.endShadows(),!0===this.info.autoReset&&this.info.reset(),this.info.render.frame++,ce.render(f,e),m.setupLights(y.useLegacyLights),t.isArrayCamera){const n=t.cameras;for(let t=0,r=n.length;t<r;t++){const r=n[t];Re(f,e,r,r.viewport)}}else Re(f,e,t);null!==w&&(J.updateMultisampleRenderTarget(w),J.updateRenderTargetMipmap(w)),!0===e.isScene&&e.onAfterRender(y,e,t),me.resetDefaultState(),S=-1,C=null,v.pop(),m=v.length>0?v[v.length-1]:null,g.pop(),f=g.length>0?g[g.length-1]:null},this.getActiveCubeFace=function(){return b},this.getActiveMipmapLevel=function(){return x},this.getRenderTarget=function(){return w},this.setRenderTargetTextures=function(e,t,n){Z.get(e.texture).__webglTexture=t,Z.get(e.depthTexture).__webglTexture=n;const r=Z.get(e);r.__hasExternalTextures=!0,r.__hasExternalTextures&&(r.__autoAllocateDepthBuffer=void 0===n,r.__autoAllocateDepthBuffer||!0===$.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),r.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(e,t){const n=Z.get(e);n.__webglFramebuffer=t,n.__useDefaultFramebuffer=void 0===t},this.setRenderTarget=function(e,t=0,n=0){w=e,b=t,x=n;let r=!0,i=null,a=!1,s=!1;if(e){const n=Z.get(e);void 0!==n.__useDefaultFramebuffer?(q.bindFramebuffer(ve.FRAMEBUFFER,null),r=!1):void 0===n.__webglFramebuffer?J.setupRenderTarget(e):n.__hasExternalTextures&&J.rebindTextures(e,Z.get(e.texture).__webglTexture,Z.get(e.depthTexture).__webglTexture);const o=e.texture;(o.isData3DTexture||o.isDataArrayTexture||o.isCompressedArrayTexture)&&(s=!0);const l=Z.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(i=l[t],a=!0):i=X.isWebGL2&&e.samples>0&&!1===J.useMultisampledRTT(e)?Z.get(e).__webglMultisampledFramebuffer:l,T.copy(e.viewport),M.copy(e.scissor),E=e.scissorTest}else T.copy(O).multiplyScalar(k).floor(),M.copy(N).multiplyScalar(k).floor(),E=B;if(q.bindFramebuffer(ve.FRAMEBUFFER,i)&&X.drawBuffers&&r&&q.drawBuffers(e,i),q.viewport(T),q.scissor(M),q.setScissorTest(E),a){const r=Z.get(e.texture);ve.framebufferTexture2D(ve.FRAMEBUFFER,ve.COLOR_ATTACHMENT0,ve.TEXTURE_CUBE_MAP_POSITIVE_X+t,r.__webglTexture,n)}else if(s){const r=Z.get(e.texture),i=t||0;ve.framebufferTextureLayer(ve.FRAMEBUFFER,ve.COLOR_ATTACHMENT0,r.__webglTexture,n||0,i)}S=-1},this.readRenderTargetPixels=function(e,t,n,r,i,a,s){if(!e||!e.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let o=Z.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==s&&(o=o[s]),o){q.bindFramebuffer(ve.FRAMEBUFFER,o);try{const s=e.texture,o=s.format,l=s.type;if(o!==xY&&fe.convert(o)!==ve.getParameter(ve.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const u=l===_Y&&($.has("EXT_color_buffer_half_float")||X.isWebGL2&&$.has("EXT_color_buffer_float"));if(!(l===fY||fe.convert(l)===ve.getParameter(ve.IMPLEMENTATION_COLOR_READ_TYPE)||l===yY&&(X.isWebGL2||$.has("OES_texture_float")||$.has("WEBGL_color_buffer_float"))||u))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i&&ve.readPixels(t,n,r,i,fe.convert(o),fe.convert(l),a)}finally{const e=null!==w?Z.get(w).__webglFramebuffer:null;q.bindFramebuffer(ve.FRAMEBUFFER,e)}}},this.copyFramebufferToTexture=function(e,t,n=0){const r=Math.pow(2,-n),i=Math.floor(t.image.width*r),a=Math.floor(t.image.height*r);J.setTexture2D(t,0),ve.copyTexSubImage2D(ve.TEXTURE_2D,n,0,0,e.x,e.y,i,a),q.unbindTexture()},this.copyTextureToTexture=function(e,t,n,r=0){const i=t.image.width,a=t.image.height,s=fe.convert(n.format),o=fe.convert(n.type);J.setTexture2D(n,0),ve.pixelStorei(ve.UNPACK_FLIP_Y_WEBGL,n.flipY),ve.pixelStorei(ve.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),ve.pixelStorei(ve.UNPACK_ALIGNMENT,n.unpackAlignment),t.isDataTexture?ve.texSubImage2D(ve.TEXTURE_2D,r,e.x,e.y,i,a,s,o,t.image.data):t.isCompressedTexture?ve.compressedTexSubImage2D(ve.TEXTURE_2D,r,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,s,t.mipmaps[0].data):ve.texSubImage2D(ve.TEXTURE_2D,r,e.x,e.y,s,o,t.image),0===r&&n.generateMipmaps&&ve.generateMipmap(ve.TEXTURE_2D),q.unbindTexture()},this.copyTextureToTexture3D=function(e,t,n,r,i=0){if(y.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const a=e.max.x-e.min.x+1,s=e.max.y-e.min.y+1,o=e.max.z-e.min.z+1,l=fe.convert(r.format),u=fe.convert(r.type);let c;if(r.isData3DTexture)J.setTexture3D(r,0),c=ve.TEXTURE_3D;else{if(!r.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");J.setTexture2DArray(r,0),c=ve.TEXTURE_2D_ARRAY}ve.pixelStorei(ve.UNPACK_FLIP_Y_WEBGL,r.flipY),ve.pixelStorei(ve.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.premultiplyAlpha),ve.pixelStorei(ve.UNPACK_ALIGNMENT,r.unpackAlignment);const d=ve.getParameter(ve.UNPACK_ROW_LENGTH),h=ve.getParameter(ve.UNPACK_IMAGE_HEIGHT),p=ve.getParameter(ve.UNPACK_SKIP_PIXELS),f=ve.getParameter(ve.UNPACK_SKIP_ROWS),m=ve.getParameter(ve.UNPACK_SKIP_IMAGES),g=n.isCompressedTexture?n.mipmaps[0]:n.image;ve.pixelStorei(ve.UNPACK_ROW_LENGTH,g.width),ve.pixelStorei(ve.UNPACK_IMAGE_HEIGHT,g.height),ve.pixelStorei(ve.UNPACK_SKIP_PIXELS,e.min.x),ve.pixelStorei(ve.UNPACK_SKIP_ROWS,e.min.y),ve.pixelStorei(ve.UNPACK_SKIP_IMAGES,e.min.z),n.isDataTexture||n.isData3DTexture?ve.texSubImage3D(c,i,t.x,t.y,t.z,a,s,o,l,u,g.data):n.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ve.compressedTexSubImage3D(c,i,t.x,t.y,t.z,a,s,o,l,g.data)):ve.texSubImage3D(c,i,t.x,t.y,t.z,a,s,o,l,u,g),ve.pixelStorei(ve.UNPACK_ROW_LENGTH,d),ve.pixelStorei(ve.UNPACK_IMAGE_HEIGHT,h),ve.pixelStorei(ve.UNPACK_SKIP_PIXELS,p),ve.pixelStorei(ve.UNPACK_SKIP_ROWS,f),ve.pixelStorei(ve.UNPACK_SKIP_IMAGES,m),0===i&&r.generateMipmaps&&ve.generateMipmap(c),q.unbindTexture()},this.initTexture=function(e){e.isCubeTexture?J.setTextureCube(e,0):e.isData3DTexture?J.setTexture3D(e,0):e.isDataArrayTexture||e.isCompressedArrayTexture?J.setTexture2DArray(e,0):J.setTexture2D(e,0),q.unbindTexture()},this.resetState=function(){b=0,x=0,w=null,q.reset(),me.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return WY}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===UY?NY:3e3}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===NY?UY:zY}}(class extends BJ{}).prototype.isWebGL1Renderer=!0;class UJ extends OX{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}}class zJ{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=GY,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=JY()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=JY()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=JY()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const FJ=new I$;class VJ{constructor(e,t,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)FJ.fromBufferAttribute(this,t),FJ.applyMatrix4(e),this.setXYZ(t,FJ.x,FJ.y,FJ.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)FJ.fromBufferAttribute(this,t),FJ.applyNormalMatrix(e),this.setXYZ(t,FJ.x,FJ.y,FJ.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)FJ.fromBufferAttribute(this,t),FJ.transformDirection(e),this.setXYZ(t,FJ.x,FJ.y,FJ.z);return this}setX(e,t){return this.normalized&&(t=s$(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=s$(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=s$(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=s$(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=a$(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=a$(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=a$(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=a$(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=s$(t,this.array),n=s$(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=s$(t,this.array),n=s$(n,this.array),r=s$(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=s$(t,this.array),n=s$(n,this.array),r=s$(r,this.array),i=s$(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return new lq(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new VJ(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class GJ extends qX{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new eq(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let HJ;const jJ=new I$,WJ=new I$,YJ=new I$,$J=new l$,XJ=new l$,qJ=new cX,KJ=new I$,ZJ=new I$,JJ=new I$,QJ=new l$,eQ=new l$,tQ=new l$;class nQ extends OX{constructor(e){if(super(),this.isSprite=!0,this.type="Sprite",void 0===HJ){HJ=new _q;const e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),t=new zJ(e,5);HJ.setIndex([0,1,2,0,2,3]),HJ.setAttribute("position",new VJ(t,3,0,!1)),HJ.setAttribute("uv",new VJ(t,2,3,!1))}this.geometry=HJ,this.material=void 0!==e?e:new GJ,this.center=new l$(.5,.5)}raycast(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),WJ.setFromMatrixScale(this.matrixWorld),qJ.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),YJ.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&WJ.multiplyScalar(-YJ.z);const n=this.material.rotation;let r,i;0!==n&&(i=Math.cos(n),r=Math.sin(n));const a=this.center;rQ(KJ.set(-.5,-.5,0),YJ,a,WJ,r,i),rQ(ZJ.set(.5,-.5,0),YJ,a,WJ,r,i),rQ(JJ.set(.5,.5,0),YJ,a,WJ,r,i),QJ.set(0,0),eQ.set(1,0),tQ.set(1,1);let s=e.ray.intersectTriangle(KJ,ZJ,JJ,!1,jJ);if(null===s&&(rQ(ZJ.set(-.5,.5,0),YJ,a,WJ,r,i),eQ.set(0,1),s=e.ray.intersectTriangle(KJ,JJ,ZJ,!1,jJ),null===s))return;const o=e.ray.origin.distanceTo(jJ);o<e.near||o>e.far||t.push({distance:o,point:jJ.clone(),uv:$X.getInterpolation(jJ,KJ,ZJ,JJ,QJ,eQ,tQ,new l$),face:null,object:this})}copy(e,t){return super.copy(e,t),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}function rQ(e,t,n,r,i,a){$J.subVectors(e,n).addScalar(.5).multiply(r),void 0!==i?(XJ.x=a*$J.x-i*$J.y,XJ.y=i*$J.x+a*$J.y):XJ.copy($J),e.copy(t),e.x+=XJ.x,e.y+=XJ.y,e.applyMatrix4(qJ)}const iQ=new I$,aQ=new P$,sQ=new P$,oQ=new I$,lQ=new cX,uQ=new I$,cQ=new tX,dQ=new cX,hQ=new uX;class pQ extends Bq{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new cX,this.bindMatrixInverse=new cX,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;null===this.boundingBox&&(this.boundingBox=new B$),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)uQ.fromBufferAttribute(t,n),this.applyBoneTransform(n,uQ),this.boundingBox.expandByPoint(uQ)}computeBoundingSphere(){const e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new tX),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)uQ.fromBufferAttribute(t,n),this.applyBoneTransform(n,uQ),this.boundingSphere.expandByPoint(uQ)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,r=this.matrixWorld;void 0!==n&&(null===this.boundingSphere&&this.computeBoundingSphere(),cQ.copy(this.boundingSphere),cQ.applyMatrix4(r),!1!==e.ray.intersectsSphere(cQ)&&(dQ.copy(r).invert(),hQ.copy(e.ray).applyMatrix4(dQ),null!==this.boundingBox&&!1===hQ.intersectsBox(this.boundingBox)||this._computeIntersections(e,t,hQ)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new P$,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);const r=1/e.manhattanLength();r!==1/0?e.multiplyScalar(r):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,r=this.geometry;aQ.fromBufferAttribute(r.attributes.skinIndex,e),sQ.fromBufferAttribute(r.attributes.skinWeight,e),iQ.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let i=0;i<4;i++){const e=sQ.getComponent(i);if(0!==e){const r=aQ.getComponent(i);lQ.multiplyMatrices(n.bones[r].matrixWorld,n.boneInverses[r]),t.addScaledVector(oQ.copy(iQ).applyMatrix4(lQ),e)}}return t.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,t){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,t)}}class fQ extends OX{constructor(){super(),this.isBone=!0,this.type="Bone"}}class mQ extends A${constructor(e=null,t=1,n=1,r,i,a,s,o,l=1003,u=1003,c,d){super(null,a,s,o,l,u,r,i,c,d),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const gQ=new cX,vQ=new cX;class yQ{constructor(e=[],t=[]){this.uuid=JY(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new cX)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const t=new cX;this.bones[e]&&t.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(t)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&t.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&(t.parent&&t.parent.isBone?(t.matrix.copy(t.parent.matrixWorld).invert(),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let i=0,a=e.length;i<a;i++){const r=e[i]?e[i].matrixWorld:vQ;gQ.multiplyMatrices(r,t[i]),gQ.toArray(n,16*i)}null!==r&&(r.needsUpdate=!0)}clone(){return new yQ(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=r$(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new mQ(t,e,e,xY,yY);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const n=this.bones[t];if(n.name===e)return n}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){const r=e.bones[n];let i=t[r];void 0===i&&(console.warn("THREE.Skeleton: No bone found with UUID:",r),i=new fQ),this.bones.push(i),this.boneInverses.push((new cX).fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let r=0,i=t.length;r<i;r++){const i=t[r];e.bones.push(i.uuid);const a=n[r];e.boneInverses.push(a.toArray())}return e}}class _Q extends lq{constructor(e,t,n,r=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const bQ=new cX,xQ=new cX,wQ=[],SQ=new B$,CQ=new cX,TQ=new Bq,MQ=new tX;class EQ extends Bq{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new _Q(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<n;r++)this.setMatrixAt(r,CQ)}computeBoundingBox(){const e=this.geometry,t=this.count;null===this.boundingBox&&(this.boundingBox=new B$),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,bQ),SQ.copy(e.boundingBox).applyMatrix4(bQ),this.boundingBox.union(SQ)}computeBoundingSphere(){const e=this.geometry,t=this.count;null===this.boundingSphere&&(this.boundingSphere=new tX),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,bQ),MQ.copy(e.boundingSphere).applyMatrix4(bQ),this.boundingSphere.union(MQ)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const n=this.matrixWorld,r=this.count;if(TQ.geometry=this.geometry,TQ.material=this.material,void 0!==TQ.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),MQ.copy(this.boundingSphere),MQ.applyMatrix4(n),!1!==e.ray.intersectsSphere(MQ)))for(let i=0;i<r;i++){this.getMatrixAt(i,bQ),xQ.multiplyMatrices(n,bQ),TQ.matrixWorld=xQ,TQ.raycast(e,wQ);for(let e=0,n=wQ.length;e<n;e++){const n=wQ[e];n.instanceId=i,n.object=this,t.push(n)}wQ.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new _Q(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class AQ extends qX{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new eq(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const PQ=new I$,RQ=new I$,LQ=new cX,kQ=new uX,DQ=new tX;class IQ extends OX{constructor(e=new _q,t=new AQ){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[0];for(let e=1,r=t.count;e<r;e++)PQ.fromBufferAttribute(t,e-1),RQ.fromBufferAttribute(t,e),n[e]=n[e-1],n[e]+=PQ.distanceTo(RQ);e.setAttribute("lineDistance",new dq(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,i=e.params.Line.threshold,a=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),DQ.copy(n.boundingSphere),DQ.applyMatrix4(r),DQ.radius+=i,!1===e.ray.intersectsSphere(DQ))return;LQ.copy(r).invert(),kQ.copy(e.ray).applyMatrix4(LQ);const s=i/((this.scale.x+this.scale.y+this.scale.z)/3),o=s*s,l=new I$,u=new I$,c=new I$,d=new I$,h=this.isLineSegments?2:1,p=n.index,f=n.attributes.position;if(null!==p){for(let n=Math.max(0,a.start),r=Math.min(p.count,a.start+a.count)-1;n<r;n+=h){const r=p.getX(n),i=p.getX(n+1);l.fromBufferAttribute(f,r),u.fromBufferAttribute(f,i);if(kQ.distanceSqToSegment(l,u,d,c)>o)continue;d.applyMatrix4(this.matrixWorld);const a=e.ray.origin.distanceTo(d);a<e.near||a>e.far||t.push({distance:a,point:c.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}else{for(let n=Math.max(0,a.start),r=Math.min(f.count,a.start+a.count)-1;n<r;n+=h){l.fromBufferAttribute(f,n),u.fromBufferAttribute(f,n+1);if(kQ.distanceSqToSegment(l,u,d,c)>o)continue;d.applyMatrix4(this.matrixWorld);const r=e.ray.origin.distanceTo(d);r<e.near||r>e.far||t.push({distance:r,point:c.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}const OQ=new I$,NQ=new I$;class BQ extends IQ{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[];for(let e=0,r=t.count;e<r;e+=2)OQ.fromBufferAttribute(t,e),NQ.fromBufferAttribute(t,e+1),n[e]=0===e?0:n[e-1],n[e+1]=n[e]+OQ.distanceTo(NQ);e.setAttribute("lineDistance",new dq(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class UQ extends IQ{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class zQ extends qX{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new eq(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const FQ=new cX,VQ=new uX,GQ=new tX,HQ=new I$;class jQ extends OX{constructor(e=new _q,t=new zQ){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,i=e.params.Points.threshold,a=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),GQ.copy(n.boundingSphere),GQ.applyMatrix4(r),GQ.radius+=i,!1===e.ray.intersectsSphere(GQ))return;FQ.copy(r).invert(),VQ.copy(e.ray).applyMatrix4(FQ);const s=i/((this.scale.x+this.scale.y+this.scale.z)/3),o=s*s,l=n.index,u=n.attributes.position;if(null!==l){for(let n=Math.max(0,a.start),i=Math.min(l.count,a.start+a.count);n<i;n++){const i=l.getX(n);HQ.fromBufferAttribute(u,i),WQ(HQ,i,o,r,e,t,this)}}else{for(let n=Math.max(0,a.start),i=Math.min(u.count,a.start+a.count);n<i;n++)HQ.fromBufferAttribute(u,n),WQ(HQ,n,o,r,e,t,this)}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}function WQ(e,t,n,r,i,a,s){const o=VQ.distanceSqToPoint(e);if(o<n){const n=new I$;VQ.closestPointToPoint(e,n),n.applyMatrix4(r);const l=i.ray.origin.distanceTo(n);if(l<i.near||l>i.far)return;a.push({distance:l,distanceToRay:Math.sqrt(o),point:n,index:t,face:null,object:s})}}class YQ{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,r=this.getPoint(0),i=0;t.push(0);for(let a=1;a<=e;a++)n=this.getPoint(a/e),i+=n.distanceTo(r),t.push(i),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let r=0;const i=n.length;let a;a=t||e*n[i-1];let s,o=0,l=i-1;for(;o<=l;)if(r=Math.floor(o+(l-o)/2),s=n[r]-a,s<0)o=r+1;else{if(!(s>0)){l=r;break}l=r-1}if(r=l,n[r]===a)return r/(i-1);const u=n[r];return(r+(a-u)/(n[r+1]-u))/(i-1)}getTangent(e,t){const n=1e-4;let r=e-n,i=e+n;r<0&&(r=0),i>1&&(i=1);const a=this.getPoint(r),s=this.getPoint(i),o=t||(a.isVector2?new l$:new I$);return o.copy(s).sub(a).normalize(),o}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new I$,r=[],i=[],a=[],s=new I$,o=new cX;for(let h=0;h<=e;h++){const t=h/e;r[h]=this.getTangentAt(t,new I$)}i[0]=new I$,a[0]=new I$;let l=Number.MAX_VALUE;const u=Math.abs(r[0].x),c=Math.abs(r[0].y),d=Math.abs(r[0].z);u<=l&&(l=u,n.set(1,0,0)),c<=l&&(l=c,n.set(0,1,0)),d<=l&&n.set(0,0,1),s.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],s),a[0].crossVectors(r[0],i[0]);for(let h=1;h<=e;h++){if(i[h]=i[h-1].clone(),a[h]=a[h-1].clone(),s.crossVectors(r[h-1],r[h]),s.length()>Number.EPSILON){s.normalize();const e=Math.acos(QY(r[h-1].dot(r[h]),-1,1));i[h].applyMatrix4(o.makeRotationAxis(s,e))}a[h].crossVectors(r[h],i[h])}if(!0===t){let t=Math.acos(QY(i[0].dot(i[e]),-1,1));t/=e,r[0].dot(s.crossVectors(i[0],i[e]))>0&&(t=-t);for(let n=1;n<=e;n++)i[n].applyMatrix4(o.makeRotationAxis(r[n],t*n)),a[n].crossVectors(r[n],i[n])}return{tangents:r,normals:i,binormals:a}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}function $Q(){let e=0,t=0,n=0,r=0;function i(i,a,s,o){e=i,t=s,n=-3*i+3*a-2*s-o,r=2*i-2*a+s+o}return{initCatmullRom:function(e,t,n,r,a){i(t,n,a*(n-e),a*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,a,s,o){let l=(t-e)/a-(n-e)/(a+s)+(n-t)/s,u=(n-t)/s-(r-t)/(s+o)+(r-n)/o;l*=s,u*=s,i(t,n,l,u)},calc:function(i){const a=i*i;return e+t*i+n*a+r*(a*i)}}}const XQ=new I$,qQ=new $Q,KQ=new $Q,ZQ=new $Q;class JQ extends YQ{constructor(e=[],t=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e,t=new I$){const n=t,r=this.points,i=r.length,a=(i-(this.closed?0:1))*e;let s,o,l=Math.floor(a),u=a-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/i)+1)*i:0===u&&l===i-1&&(l=i-2,u=1),this.closed||l>0?s=r[(l-1)%i]:(XQ.subVectors(r[0],r[1]).add(r[0]),s=XQ);const c=r[l%i],d=r[(l+1)%i];if(this.closed||l+2<i?o=r[(l+2)%i]:(XQ.subVectors(r[i-1],r[i-2]).add(r[i-1]),o=XQ),"centripetal"===this.curveType||"chordal"===this.curveType){const e="chordal"===this.curveType?.5:.25;let t=Math.pow(s.distanceToSquared(c),e),n=Math.pow(c.distanceToSquared(d),e),r=Math.pow(d.distanceToSquared(o),e);n<1e-4&&(n=1),t<1e-4&&(t=n),r<1e-4&&(r=n),qQ.initNonuniformCatmullRom(s.x,c.x,d.x,o.x,t,n,r),KQ.initNonuniformCatmullRom(s.y,c.y,d.y,o.y,t,n,r),ZQ.initNonuniformCatmullRom(s.z,c.z,d.z,o.z,t,n,r)}else"catmullrom"===this.curveType&&(qQ.initCatmullRom(s.x,c.x,d.x,o.x,this.tension),KQ.initCatmullRom(s.y,c.y,d.y,o.y,this.tension),ZQ.initCatmullRom(s.z,c.z,d.z,o.z,this.tension));return n.set(qQ.calc(u),KQ.calc(u),ZQ.calc(u)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new I$).fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}class QQ extends _q{constructor(e=1,t=32,n=0,r=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},t=Math.max(3,t);const i=[],a=[],s=[],o=[],l=new I$,u=new l$;a.push(0,0,0),s.push(0,0,1),o.push(.5,.5);for(let c=0,d=3;c<=t;c++,d+=3){const i=n+c/t*r;l.x=e*Math.cos(i),l.y=e*Math.sin(i),a.push(l.x,l.y,l.z),s.push(0,0,1),u.x=(a[d]/e+1)/2,u.y=(a[d+1]/e+1)/2,o.push(u.x,u.y)}for(let c=1;c<=t;c++)i.push(c,c+1,0);this.setIndex(i),this.setAttribute("position",new dq(a,3)),this.setAttribute("normal",new dq(s,3)),this.setAttribute("uv",new dq(o,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new QQ(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class e0 extends _q{constructor(e=1,t=32,n=16,r=0,i=2*Math.PI,a=0,s=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:a,thetaLength:s},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const o=Math.min(a+s,Math.PI);let l=0;const u=[],c=new I$,d=new I$,h=[],p=[],f=[],m=[];for(let g=0;g<=n;g++){const h=[],v=g/n;let y=0;0===g&&0===a?y=.5/t:g===n&&o===Math.PI&&(y=-.5/t);for(let n=0;n<=t;n++){const o=n/t;c.x=-e*Math.cos(r+o*i)*Math.sin(a+v*s),c.y=e*Math.cos(a+v*s),c.z=e*Math.sin(r+o*i)*Math.sin(a+v*s),p.push(c.x,c.y,c.z),d.copy(c).normalize(),f.push(d.x,d.y,d.z),m.push(o+y,1-v),h.push(l++)}u.push(h)}for(let g=0;g<n;g++)for(let e=0;e<t;e++){const t=u[g][e+1],r=u[g][e],i=u[g+1][e],s=u[g+1][e+1];(0!==g||a>0)&&h.push(t,r,s),(g!==n-1||o<Math.PI)&&h.push(r,i,s)}this.setIndex(h),this.setAttribute("position",new dq(p,3)),this.setAttribute("normal",new dq(f,3)),this.setAttribute("uv",new dq(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new e0(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class t0 extends _q{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},null!==e){const t=[],n=new Set,r=new I$,i=new I$;if(null!==e.index){const a=e.attributes.position,s=e.index;let o=e.groups;0===o.length&&(o=[{start:0,count:s.count,materialIndex:0}]);for(let e=0,l=o.length;e<l;++e){const l=o[e],u=l.start;for(let e=u,o=u+l.count;e<o;e+=3)for(let l=0;l<3;l++){const o=s.getX(e+l),u=s.getX(e+(l+1)%3);r.fromBufferAttribute(a,o),i.fromBufferAttribute(a,u),!0===n0(r,i,n)&&(t.push(r.x,r.y,r.z),t.push(i.x,i.y,i.z))}}}else{const a=e.attributes.position;for(let e=0,s=a.count/3;e<s;e++)for(let o=0;o<3;o++){const s=3*e+o,l=3*e+(o+1)%3;r.fromBufferAttribute(a,s),i.fromBufferAttribute(a,l),!0===n0(r,i,n)&&(t.push(r.x,r.y,r.z),t.push(i.x,i.y,i.z))}}this.setAttribute("position",new dq(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function n0(e,t,n){const r=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`,i=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`;return!0!==n.has(r)&&!0!==n.has(i)&&(n.add(r),n.add(i),!0)}class r0 extends qX{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new eq(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new eq(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new l$(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class i0 extends r0{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new l$(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return QY(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new eq(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new eq(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new eq(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class a0 extends qX{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new eq(16777215),this.specular=new eq(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new eq(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new l$(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=XW,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class s0 extends qX{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new eq(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new eq(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new l$(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=XW,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class o0 extends AQ{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function l0(e,t,n){return c0(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)}function u0(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)}function c0(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function d0(e){const t=e.length,n=new Array(t);for(let r=0;r!==t;++r)n[r]=r;return n.sort((function(t,n){return e[t]-e[n]})),n}function h0(e,t,n){const r=e.length,i=new e.constructor(r);for(let a=0,s=0;s!==r;++a){const r=n[a]*t;for(let n=0;n!==t;++n)i[s++]=e[r+n]}return i}function p0(e,t,n,r){let i=1,a=e[0];for(;void 0!==a&&void 0===a[r];)a=e[i++];if(void 0===a)return;let s=a[r];if(void 0!==s)if(Array.isArray(s))do{s=a[r],void 0!==s&&(t.push(a.time),n.push.apply(n,s)),a=e[i++]}while(void 0!==a);else if(void 0!==s.toArray)do{s=a[r],void 0!==s&&(t.push(a.time),s.toArray(n,n.length)),a=e[i++]}while(void 0!==a);else do{s=a[r],void 0!==s&&(t.push(a.time),n.push(s)),a=e[i++]}while(void 0!==a)}class f0{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{let a;n:{r:if(!(e<r)){for(let a=n+2;;){if(void 0===r){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===a)break;if(i=r,r=t[++n],e<r)break t}a=t.length;break n}if(e>=i)break e;{const s=t[1];e<s&&(n=2,i=s);for(let a=n-2;;){if(void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(n===a)break;if(r=i,i=t[--n-1],e>=i)break t}a=n,n=0}}for(;n<a;){const r=n+a>>>1;e<t[r]?a=r:n=r+1}if(r=t[n],i=t[n-1],void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r;for(let a=0;a!==r;++a)t[a]=n[i+a];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class m0 extends f0{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:kY,endingEnd:kY}}intervalChanged_(e,t,n){const r=this.parameterPositions;let i=e-2,a=e+1,s=r[i],o=r[a];if(void 0===s)switch(this.getSettings_().endingStart){case DY:i=e,s=2*t-n;break;case IY:i=r.length-2,s=t+r[i]-r[i+1];break;default:i=e,s=n}if(void 0===o)switch(this.getSettings_().endingEnd){case DY:a=e,o=2*n-t;break;case IY:a=1,o=n+r[1]-r[0];break;default:a=e-1,o=t}const l=.5*(n-t),u=this.valueSize;this._weightPrev=l/(t-s),this._weightNext=l/(o-n),this._offsetPrev=i*u,this._offsetNext=a*u}interpolate_(e,t,n,r){const i=this.resultBuffer,a=this.sampleValues,s=this.valueSize,o=e*s,l=o-s,u=this._offsetPrev,c=this._offsetNext,d=this._weightPrev,h=this._weightNext,p=(n-t)/(r-t),f=p*p,m=f*p,g=-d*m+2*d*f-d*p,v=(1+d)*m+(-1.5-2*d)*f+(-.5+d)*p+1,y=(-1-h)*m+(1.5+h)*f+.5*p,_=h*m-h*f;for(let b=0;b!==s;++b)i[b]=g*a[u+b]+v*a[l+b]+y*a[o+b]+_*a[c+b];return i}}class g0 extends f0{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const i=this.resultBuffer,a=this.sampleValues,s=this.valueSize,o=e*s,l=o-s,u=(n-t)/(r-t),c=1-u;for(let d=0;d!==s;++d)i[d]=a[l+d]*c+a[o+d]*u;return i}}class v0 extends f0{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class y0{constructor(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=u0(t,this.TimeBufferType),this.values=u0(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:u0(e.times,Array),values:u0(e.values,Array)};const t=e.getInterpolation();t!==e.DefaultInterpolation&&(n.interpolation=t)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new v0(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new g0(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new m0(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case PY:t=this.InterpolantFactoryMethodDiscrete;break;case RY:t=this.InterpolantFactoryMethodLinear;break;case LY:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return PY;case this.InterpolantFactoryMethodLinear:return RY;case this.InterpolantFactoryMethodSmooth:return LY}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let i=0,a=r-1;for(;i!==r&&n[i]<e;)++i;for(;-1!==a&&n[a]>t;)--a;if(++a,0!==i||a!==r){i>=a&&(a=Math.max(a,1),i=a-1);const e=this.getValueSize();this.times=l0(n,i,a),this.values=l0(this.values,i*e,a*e)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let s=0;s!==i;s++){const t=n[s];if("number"==typeof t&&isNaN(t)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,s,t),e=!1;break}if(null!==a&&a>t){console.error("THREE.KeyframeTrack: Out of order keys.",this,s,t,a),e=!1;break}a=t}if(void 0!==r&&c0(r))for(let s=0,o=r.length;s!==o;++s){const t=r[s];if(isNaN(t)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,s,t),e=!1;break}}return e}optimize(){const e=l0(this.times),t=l0(this.values),n=this.getValueSize(),r=this.getInterpolation()===LY,i=e.length-1;let a=1;for(let s=1;s<i;++s){let i=!1;const o=e[s];if(o!==e[s+1]&&(1!==s||o!==e[0]))if(r)i=!0;else{const e=s*n,r=e-n,a=e+n;for(let s=0;s!==n;++s){const n=t[e+s];if(n!==t[r+s]||n!==t[a+s]){i=!0;break}}}if(i){if(s!==a){e[a]=e[s];const r=s*n,i=a*n;for(let e=0;e!==n;++e)t[i+e]=t[r+e]}++a}}if(i>0){e[a]=e[i];for(let e=i*n,r=a*n,s=0;s!==n;++s)t[r+s]=t[e+s];++a}return a!==e.length?(this.times=l0(e,0,a),this.values=l0(t,0,a*n)):(this.times=e,this.values=t),this}clone(){const e=l0(this.times,0),t=l0(this.values,0),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}y0.prototype.TimeBufferType=Float32Array,y0.prototype.ValueBufferType=Float32Array,y0.prototype.DefaultInterpolation=RY;class _0 extends y0{}_0.prototype.ValueTypeName="bool",_0.prototype.ValueBufferType=Array,_0.prototype.DefaultInterpolation=PY,_0.prototype.InterpolantFactoryMethodLinear=void 0,_0.prototype.InterpolantFactoryMethodSmooth=void 0;class b0 extends y0{}b0.prototype.ValueTypeName="color";class x0 extends y0{}x0.prototype.ValueTypeName="number";class w0 extends f0{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const i=this.resultBuffer,a=this.sampleValues,s=this.valueSize,o=(n-t)/(r-t);let l=e*s;for(let u=l+s;l!==u;l+=4)D$.slerpFlat(i,0,a,l-s,a,l,o);return i}}class S0 extends y0{InterpolantFactoryMethodLinear(e){return new w0(this.times,this.values,this.getValueSize(),e)}}S0.prototype.ValueTypeName="quaternion",S0.prototype.DefaultInterpolation=RY,S0.prototype.InterpolantFactoryMethodSmooth=void 0;class C0 extends y0{}C0.prototype.ValueTypeName="string",C0.prototype.ValueBufferType=Array,C0.prototype.DefaultInterpolation=PY,C0.prototype.InterpolantFactoryMethodLinear=void 0,C0.prototype.InterpolantFactoryMethodSmooth=void 0;class T0 extends y0{}T0.prototype.ValueTypeName="vector";class M0{constructor(e,t=-1,n,r=2500){this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=JY(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,r=1/(e.fps||1);for(let a=0,s=n.length;a!==s;++a)t.push(E0(n[a]).scale(r));const i=new this(e.name,e.duration,t,e.blendMode);return i.uuid=e.uuid,i}static toJSON(e){const t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let i=0,a=n.length;i!==a;++i)t.push(y0.toJSON(n[i]));return r}static CreateFromMorphTargetSequence(e,t,n,r){const i=t.length,a=[];for(let s=0;s<i;s++){let e=[],o=[];e.push((s+i-1)%i,s,(s+1)%i),o.push(0,1,0);const l=d0(e);e=h0(e,1,l),o=h0(o,1,l),r||0!==e[0]||(e.push(i),o.push(o[0])),a.push(new x0(".morphTargetInfluences["+t[s].name+"]",e,o).scale(1/n))}return new this(e,-1,a)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const t=e;n=t.geometry&&t.geometry.animations||t.animations}for(let r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const r={},i=/^([\w-]*?)([\d]+)$/;for(let s=0,o=e.length;s<o;s++){const t=e[s],n=t.name.match(i);if(n&&n.length>1){const e=n[1];let i=r[e];i||(r[e]=i=[]),i.push(t)}}const a=[];for(const s in r)a.push(this.CreateFromMorphTargetSequence(s,r[s],t,n));return a}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(e,t,n,r,i){if(0!==n.length){const a=[],s=[];p0(n,a,s,r),0!==a.length&&i.push(new e(t,a,s))}},r=[],i=e.name||"default",a=e.fps||30,s=e.blendMode;let o=e.length||-1;const l=e.hierarchy||[];for(let u=0;u<l.length;u++){const e=l[u].keys;if(e&&0!==e.length)if(e[0].morphTargets){const t={};let n;for(n=0;n<e.length;n++)if(e[n].morphTargets)for(let r=0;r<e[n].morphTargets.length;r++)t[e[n].morphTargets[r]]=-1;for(const i in t){const t=[],a=[];for(let r=0;r!==e[n].morphTargets.length;++r){const r=e[n];t.push(r.time),a.push(r.morphTarget===i?1:0)}r.push(new x0(".morphTargetInfluence["+i+"]",t,a))}o=t.length*a}else{const i=".bones["+t[u].name+"]";n(T0,i+".position",e,"pos",r),n(S0,i+".quaternion",e,"rot",r),n(T0,i+".scale",e,"scl",r)}}if(0===r.length)return null;return new this(i,o,r,s)}resetDuration(){let e=0;for(let t=0,n=this.tracks.length;t!==n;++t){const n=this.tracks[t];e=Math.max(e,n.times[n.times.length-1])}return this.duration=e,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function E0(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return x0;case"vector":case"vector2":case"vector3":case"vector4":return T0;case"color":return b0;case"quaternion":return S0;case"bool":case"boolean":return _0;case"string":return C0}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){const t=[],n=[];p0(e.keys,t,n,"value"),e.times=t,e.values=n}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}const A0={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};class P0{constructor(e,t,n){const r=this;let i,a=!1,s=0,o=0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){o++,!1===a&&void 0!==r.onStart&&r.onStart(e,s,o),a=!0},this.itemEnd=function(e){s++,void 0!==r.onProgress&&r.onProgress(e,s,o),s===o&&(a=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return i?i(e):e},this.setURLModifier=function(e){return i=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){const t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,n=l.length;t<n;t+=2){const n=l[t],r=l[t+1];if(n.global&&(n.lastIndex=0),n.test(e))return r}return null}}}const R0=new P0;class L0{constructor(e){this.manager=void 0!==e?e:R0,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise((function(r,i){n.load(e,r,t,i)}))}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const k0={};class D0 extends Error{constructor(e,t){super(e),this.response=t}}class I0 extends L0{constructor(e){super(e)}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=A0.get(e);if(void 0!==i)return this.manager.itemStart(e),setTimeout((()=>{t&&t(i),this.manager.itemEnd(e)}),0),i;if(void 0!==k0[e])return void k0[e].push({onLoad:t,onProgress:n,onError:r});k0[e]=[],k0[e].push({onLoad:t,onProgress:n,onError:r});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),s=this.mimeType,o=this.responseType;fetch(a).then((t=>{if(200===t.status||0===t.status){if(0===t.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===t.body||void 0===t.body.getReader)return t;const n=k0[e],r=t.body.getReader(),i=t.headers.get("Content-Length")||t.headers.get("X-File-Size"),a=i?parseInt(i):0,s=0!==a;let o=0;const l=new ReadableStream({start(e){!function t(){r.read().then((({done:r,value:i})=>{if(r)e.close();else{o+=i.byteLength;const r=new ProgressEvent("progress",{lengthComputable:s,loaded:o,total:a});for(let e=0,t=n.length;e<t;e++){const t=n[e];t.onProgress&&t.onProgress(r)}e.enqueue(i),t()}}))}()}});return new Response(l)}throw new D0(`fetch for "${t.url}" responded with ${t.status}: ${t.statusText}`,t)})).then((e=>{switch(o){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then((e=>(new DOMParser).parseFromString(e,s)));case"json":return e.json();default:if(void 0===s)return e.text();{const t=/charset="?([^;"\s]*)"?/i.exec(s),n=t&&t[1]?t[1].toLowerCase():void 0,r=new TextDecoder(n);return e.arrayBuffer().then((e=>r.decode(e)))}}})).then((t=>{A0.add(e,t);const n=k0[e];delete k0[e];for(let e=0,r=n.length;e<r;e++){const r=n[e];r.onLoad&&r.onLoad(t)}})).catch((t=>{const n=k0[e];if(void 0===n)throw this.manager.itemError(e),t;delete k0[e];for(let e=0,r=n.length;e<r;e++){const r=n[e];r.onError&&r.onError(t)}this.manager.itemError(e)})).finally((()=>{this.manager.itemEnd(e)})),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class O0 extends L0{constructor(e){super(e)}load(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,a=A0.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;const s=h$("img");function o(){u(),A0.add(e,this),t&&t(this),i.manager.itemEnd(e)}function l(t){u(),r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}function u(){s.removeEventListener("load",o,!1),s.removeEventListener("error",l,!1)}return s.addEventListener("load",o,!1),s.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(s.crossOrigin=this.crossOrigin),i.manager.itemStart(e),s.src=e,s}}class N0 extends L0{constructor(e){super(e)}load(e,t,n,r){const i=this,a=new mQ,s=new I0(this.manager);return s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setPath(this.path),s.setWithCredentials(i.withCredentials),s.load(e,(function(e){const n=i.parse(e);n&&(void 0!==n.image?a.image=n.image:void 0!==n.data&&(a.image.width=n.width,a.image.height=n.height,a.image.data=n.data),a.wrapS=void 0!==n.wrapS?n.wrapS:oY,a.wrapT=void 0!==n.wrapT?n.wrapT:oY,a.magFilter=void 0!==n.magFilter?n.magFilter:hY,a.minFilter=void 0!==n.minFilter?n.minFilter:hY,a.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.colorSpace?a.colorSpace=n.colorSpace:void 0!==n.encoding&&(a.encoding=n.encoding),void 0!==n.flipY&&(a.flipY=n.flipY),void 0!==n.format&&(a.format=n.format),void 0!==n.type&&(a.type=n.type),void 0!==n.mipmaps&&(a.mipmaps=n.mipmaps,a.minFilter=pY),1===n.mipmapCount&&(a.minFilter=hY),void 0!==n.generateMipmaps&&(a.generateMipmaps=n.generateMipmaps),a.needsUpdate=!0,t&&t(a,n))}),n,r),a}}class B0 extends L0{constructor(e){super(e)}load(e,t,n,r){const i=new A$,a=new O0(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,(function(e){i.image=e,i.needsUpdate=!0,void 0!==t&&t(i)}),n,r),i}}class U0 extends OX{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new eq(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}const z0=new cX,F0=new I$,V0=new I$;class G0{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new l$(512,512),this.map=null,this.mapPass=null,this.matrix=new cX,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new rK,this._frameExtents=new l$(1,1),this._viewportCount=1,this._viewports=[new P$(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;F0.setFromMatrixPosition(e.matrixWorld),t.position.copy(F0),V0.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(V0),t.updateMatrixWorld(),z0.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(z0),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(z0)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class H0 extends G0{constructor(){super(new Yq(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,n=2*ZY*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;n===t.fov&&r===t.aspect&&i===t.far||(t.fov=n,t.aspect=r,t.far=i,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class j0 extends U0{constructor(e,t,n=0,r=Math.PI/3,i=0,a=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(OX.DEFAULT_UP),this.updateMatrix(),this.target=new OX,this.distance=n,this.angle=r,this.penumbra=i,this.decay=a,this.map=null,this.shadow=new H0}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const W0=new cX,Y0=new I$,$0=new I$;class X0 extends G0{constructor(){super(new Yq(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new l$(4,2),this._viewportCount=6,this._viewports=[new P$(2,1,1,1),new P$(0,1,1,1),new P$(3,1,1,1),new P$(1,1,1,1),new P$(3,0,1,1),new P$(1,0,1,1)],this._cubeDirections=[new I$(1,0,0),new I$(-1,0,0),new I$(0,0,1),new I$(0,0,-1),new I$(0,1,0),new I$(0,-1,0)],this._cubeUps=[new I$(0,1,0),new I$(0,1,0),new I$(0,1,0),new I$(0,1,0),new I$(0,0,1),new I$(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,r=this.matrix,i=e.distance||n.far;i!==n.far&&(n.far=i,n.updateProjectionMatrix()),Y0.setFromMatrixPosition(e.matrixWorld),n.position.copy(Y0),$0.copy(n.position),$0.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt($0),n.updateMatrixWorld(),r.makeTranslation(-Y0.x,-Y0.y,-Y0.z),W0.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(W0)}}class q0 extends U0{constructor(e,t,n=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new X0}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class K0 extends G0{constructor(){super(new vK(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Z0 extends U0{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(OX.DEFAULT_UP),this.updateMatrix(),this.target=new OX,this.shadow=new K0}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class J0 extends U0{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Q0{static decodeText(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);let t="";for(let n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(zA){return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class e1 extends _q{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class t1 extends L0{constructor(e){super(e),this.isImageBitmapLoader=!0,"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,a=A0.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;const s={};s.credentials="anonymous"===this.crossOrigin?"same-origin":"include",s.headers=this.requestHeader,fetch(e,s).then((function(e){return e.blob()})).then((function(e){return createImageBitmap(e,Object.assign(i.options,{colorSpaceConversion:"none"}))})).then((function(n){A0.add(e,n),t&&t(n),i.manager.itemEnd(e)})).catch((function(t){r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)})),i.manager.itemStart(e)}}class n1{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=r1(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=r1();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function r1(){return("undefined"==typeof performance?Date:performance).now()}class i1{constructor(e,t,n){let r,i,a;switch(this.binding=e,this.valueSize=n,t){case"quaternion":r=this._slerp,i=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":r=this._select,i=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:r=this._lerp,i=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=i,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,r=this.valueSize,i=e*r+r;let a=this.cumulativeWeight;if(0===a){for(let e=0;e!==r;++e)n[i+e]=n[e];a=t}else{a+=t;const e=t/a;this._mixBufferRegion(n,i,0,e,r)}this.cumulativeWeight=a}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,r=e*t+t,i=this.cumulativeWeight,a=this.cumulativeWeightAdditive,s=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){const e=t*this._origIndex;this._mixBufferRegion(n,r,e,1-i,t)}a>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(let o=t,l=t+t;o!==l;++o)if(n[o]!==n[o+t]){s.setValue(n,r);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(let i=n,a=r;i!==a;++i)t[i]=t[r+i%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=3*this.valueSize;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,r,i){if(r>=.5)for(let a=0;a!==i;++a)e[t+a]=e[n+a]}_slerp(e,t,n,r){D$.slerpFlat(e,t,e,t,e,n,r)}_slerpAdditive(e,t,n,r,i){const a=this._workIndex*i;D$.multiplyQuaternionsFlat(e,a,e,t,e,n),D$.slerpFlat(e,t,e,t,e,a,r)}_lerp(e,t,n,r,i){const a=1-r;for(let s=0;s!==i;++s){const i=t+s;e[i]=e[i]*a+e[n+s]*r}}_lerpAdditive(e,t,n,r,i){for(let a=0;a!==i;++a){const i=t+a;e[i]=e[i]+e[n+a]*r}}}const a1="\\[\\]\\.:\\/",s1=new RegExp("["+a1+"]","g"),o1="[^"+a1+"]",l1="[^"+a1.replace("\\.","")+"]",u1=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",o1)+/(WCOD+)?/.source.replace("WCOD",l1)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",o1)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",o1)+"$"),c1=["material","materials","bones","map"];class d1{constructor(e,t,n){this.path=t,this.parsedPath=n||d1.parseTrackName(t),this.node=d1.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new d1.Composite(e,t,n):new d1(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(s1,"")}static parseTrackName(e){const t=u1.exec(e);if(null===t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){const e=n.nodeName.substring(r+1);-1!==c1.indexOf(e)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=e)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){const n=function(e){for(let r=0;r<e.length;r++){const i=e[r];if(i.name===t||i.uuid===t)return i;const a=n(i.children);if(a)return a}return null},r=n(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)e[t++]=n[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,r=t.propertyName;let i=t.propertyIndex;if(e||(e=d1.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(n){let r=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===r){r=t;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);e=e.material.map;break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==r){if(void 0===e[r])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[r]}}const a=e[r];if(void 0===a){const n=t.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n+"."+r+" but it wasn't found.",e)}let s=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?s=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(s=this.Versioning.MatrixWorldNeedsUpdate);let o=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[i]&&(i=e.morphTargetDictionary[i])}o=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=i}else void 0!==a.fromArray&&void 0!==a.toArray?(o=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(o=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=r;this.getValue=this.GetterByBindingType[o],this.setValue=this.SetterByBindingTypeAndVersioning[o][s]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}d1.Composite=class{constructor(e,t,n){const r=n||d1.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}},d1.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},d1.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},d1.prototype.GetterByBindingType=[d1.prototype._getValue_direct,d1.prototype._getValue_array,d1.prototype._getValue_arrayElement,d1.prototype._getValue_toArray],d1.prototype.SetterByBindingTypeAndVersioning=[[d1.prototype._setValue_direct,d1.prototype._setValue_direct_setNeedsUpdate,d1.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[d1.prototype._setValue_array,d1.prototype._setValue_array_setNeedsUpdate,d1.prototype._setValue_array_setMatrixWorldNeedsUpdate],[d1.prototype._setValue_arrayElement,d1.prototype._setValue_arrayElement_setNeedsUpdate,d1.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[d1.prototype._setValue_fromArray,d1.prototype._setValue_fromArray_setNeedsUpdate,d1.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class h1{constructor(e,t,n=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=r;const i=t.tracks,a=i.length,s=new Array(a),o={endingStart:kY,endingEnd:kY};for(let l=0;l!==a;++l){const e=i[l].createInterpolant(null);s[l]=e,e.settings=o}this._interpolantSettings=o,this._interpolants=s,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){const n=this._clip.duration,r=e._clip.duration,i=r/n,a=n/r;e.warp(1,i,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const r=this._mixer,i=r.time,a=this.timeScale;let s=this._timeScaleInterpolant;null===s&&(s=r._lendControlInterpolant(),this._timeScaleInterpolant=s);const o=s.parameterPositions,l=s.sampleValues;return o[0]=i,o[1]=i+n,l[0]=e/a,l[1]=t/a,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,r){if(!this.enabled)return void this._updateWeight(e);const i=this._startTime;if(null!==i){const r=(e-i)*n;r<0||0===n?t=0:(this._startTime=null,t=n*r)}t*=this._updateTimeScale(e);const a=this._updateTime(t),s=this._updateWeight(e);if(s>0){const e=this._interpolants,t=this._propertyBindings;if(2501===this.blendMode)for(let n=0,r=e.length;n!==r;++n)e[n].evaluate(a),t[n].accumulateAdditive(s);else for(let n=0,i=e.length;n!==i;++n)e[n].evaluate(a),t[n].accumulate(r,s)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(null!==n){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(null!==n){t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let r=this.time+e,i=this._loopCount;const a=2202===n;if(0===e)return-1===i?r:a&&1==(1&i)?t-r:r;if(2200===n){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===i&&(e>=0?(i=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),r>=t||r<0){const n=Math.floor(r/t);r-=t*n,i+=Math.abs(n);const s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===s){const t=e<0;this._setEndings(t,!t,a)}else this._setEndings(!1,!1,a);this._loopCount=i,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n})}}else this.time=r;if(a&&1==(1&i))return t-r}return r}_setEndings(e,t,n){const r=this._interpolantSettings;n?(r.endingStart=DY,r.endingEnd=DY):(r.endingStart=e?this.zeroSlopeAtStart?DY:kY:IY,r.endingEnd=t?this.zeroSlopeAtEnd?DY:kY:IY)}_scheduleFading(e,t,n){const r=this._mixer,i=r.time;let a=this._weightInterpolant;null===a&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);const s=a.parameterPositions,o=a.sampleValues;return s[0]=i,o[0]=t,s[1]=i+e,o[1]=n,this}}const p1=new Float32Array(1);class f1 extends $Y{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,r=e._clip.tracks,i=r.length,a=e._propertyBindings,s=e._interpolants,o=n.uuid,l=this._bindingsByRootAndName;let u=l[o];void 0===u&&(u={},l[o]=u);for(let c=0;c!==i;++c){const e=r[c],i=e.name;let l=u[i];if(void 0!==l)++l.referenceCount,a[c]=l;else{if(l=a[c],void 0!==l){null===l._cacheIndex&&(++l.referenceCount,this._addInactiveBinding(l,o,i));continue}const r=t&&t._propertyBindings[c].binding.parsedPath;l=new i1(d1.create(n,i,r),e.ValueTypeName,e.getValueSize()),++l.referenceCount,this._addInactiveBinding(l,o,i),a[c]=l}s[c].resultBuffer=l.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,t)}const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0==n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0==--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,n){const r=this._actions,i=this._actionsByClip;let a=i[t];if(void 0===a)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=a;else{const t=a.knownActions;e._byClipCacheIndex=t.length,t.push(e)}e._cacheIndex=r.length,r.push(e),a.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;const i=e._clip.uuid,a=this._actionsByClip,s=a[i],o=s.knownActions,l=o[o.length-1],u=e._byClipCacheIndex;l._byClipCacheIndex=u,o[u]=l,o.pop(),e._byClipCacheIndex=null;delete s.actionByRoot[(e._localRoot||this._root).uuid],0===o.length&&delete a[i],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const e=t[n];0==--e.referenceCount&&this._removeInactiveBinding(e)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_addInactiveBinding(e,t,n){const r=this._bindingsByRootAndName,i=this._bindings;let a=r[t];void 0===a&&(a={},r[t]=a),a[n]=e,e._cacheIndex=i.length,i.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,r=n.rootNode.uuid,i=n.path,a=this._bindingsByRootAndName,s=a[r],o=t[t.length-1],l=e._cacheIndex;o._cacheIndex=l,t[l]=o,t.pop(),delete s[i],0===Object.keys(s).length&&delete a[r]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return void 0===n&&(n=new g0(new Float32Array(2),new Float32Array(2),1,p1),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,i=t[r];e.__cacheIndex=r,t[r]=e,i.__cacheIndex=n,t[n]=i}clipAction(e,t,n){const r=t||this._root,i=r.uuid;let a="string"==typeof e?M0.findByName(r,e):e;const s=null!==a?a.uuid:e,o=this._actionsByClip[s];let l=null;if(void 0===n&&(n=null!==a?a.blendMode:OY),void 0!==o){const e=o.actionByRoot[i];if(void 0!==e&&e.blendMode===n)return e;l=o.knownActions[0],null===a&&(a=l._clip)}if(null===a)return null;const u=new h1(this,a,t,n);return this._bindAction(u,l),this._addInactiveAction(u,s,i),u}existingAction(e,t){const n=t||this._root,r=n.uuid,i="string"==typeof e?M0.findByName(n,e):e,a=i?i.uuid:e,s=this._actionsByClip[a];return void 0!==s&&s.actionByRoot[r]||null}stopAllAction(){const e=this._actions;for(let t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,r=this.time+=e,i=Math.sign(e),a=this._accuIndex^=1;for(let l=0;l!==n;++l){t[l]._update(r,e,i,a)}const s=this._bindings,o=this._nActiveBindings;for(let l=0;l!==o;++l)s[l].apply(a);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){const e=i.knownActions;for(let n=0,r=e.length;n!==r;++n){const r=e[n];this._deactivateAction(r);const i=r._cacheIndex,a=t[t.length-1];r._cacheIndex=null,r._byClipCacheIndex=null,a._cacheIndex=i,t[i]=a,t.pop(),this._removeInactiveBindingsForAction(r)}delete r[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const i in n){const e=n[i].actionByRoot[t];void 0!==e&&(this._deactivateAction(e),this._removeInactiveAction(e))}const r=this._bindingsByRootAndName[t];if(void 0!==r)for(const i in r){const e=r[i];e.restoreOriginalState(),this._removeInactiveBinding(e)}}uncacheAction(e,t){const n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class m1 extends zJ{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class g1{constructor(e,t,n=0,r=1/0){this.ray=new uX(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new xX,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,n=[]){return y1(e,this,n,t),n.sort(v1),n}intersectObjects(e,t=!0,n=[]){for(let r=0,i=e.length;r<i;r++)y1(e[r],this,n,t);return n.sort(v1),n}}function v1(e,t){return e.distance-t.distance}function y1(e,t,n,r){if(e.layers.test(t.layers)&&e.raycast(t,n),!0===r){const r=e.children;for(let e=0,i=r.length;e<i;e++)y1(r[e],t,n,!0)}}class _1{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){const e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(QY(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}const b1=new I$,x1=new I$;function w1(e,t){if(0===t)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(2===t||1===t){let n=e.getIndex();if(null===n){const t=[],r=e.getAttribute("position");if(void 0===r)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(let e=0;e<r.count;e++)t.push(e);e.setIndex(t),n=e.getIndex()}const r=n.count-2,i=[];if(2===t)for(let e=1;e<=r;e++)i.push(n.getX(0)),i.push(n.getX(e)),i.push(n.getX(e+1));else for(let e=0;e<r;e++)e%2==0?(i.push(n.getX(e)),i.push(n.getX(e+1)),i.push(n.getX(e+2))):(i.push(n.getX(e+2)),i.push(n.getX(e+1)),i.push(n.getX(e)));i.length/3!==r&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const a=e.clone();return a.setIndex(i),a.clearGroups(),a}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t),e}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:IW}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=IW);class S1 extends L0{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register((function(e){return new P1(e)})),this.register((function(e){return new B1(e)})),this.register((function(e){return new U1(e)})),this.register((function(e){return new z1(e)})),this.register((function(e){return new L1(e)})),this.register((function(e){return new k1(e)})),this.register((function(e){return new D1(e)})),this.register((function(e){return new I1(e)})),this.register((function(e){return new A1(e)})),this.register((function(e){return new O1(e)})),this.register((function(e){return new R1(e)})),this.register((function(e){return new N1(e)})),this.register((function(e){return new M1(e)})),this.register((function(e){return new F1(e)})),this.register((function(e){return new V1(e)}))}load(e,t,n,r){const i=this;let a;a=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:Q0.extractUrlBase(e),this.manager.itemStart(e);const s=function(t){r?r(t):console.error(t),i.manager.itemError(e),i.manager.itemEnd(e)},o=new I0(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(function(n){try{i.parse(n,a,(function(n){t(n),i.manager.itemEnd(e)}),s)}catch(zA){s(zA)}}),n,s)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,r){let i;const a={},s={},o=new TextDecoder;if("string"==typeof e)i=JSON.parse(e);else if(e instanceof ArrayBuffer){if(o.decode(new Uint8Array(e,0,4))===G1){try{a[T1.KHR_BINARY_GLTF]=new W1(e)}catch(u){return void(r&&r(u))}i=JSON.parse(a[T1.KHR_BINARY_GLTF].content)}else i=JSON.parse(o.decode(e))}else i=e;if(void 0===i.asset||i.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const l=new g2(i,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let c=0;c<this.pluginCallbacks.length;c++){const e=this.pluginCallbacks[c](l);s[e.name]=e,a[e.name]=!0}if(i.extensionsUsed)for(let c=0;c<i.extensionsUsed.length;++c){const e=i.extensionsUsed[c],t=i.extensionsRequired||[];switch(e){case T1.KHR_MATERIALS_UNLIT:a[e]=new E1;break;case T1.KHR_DRACO_MESH_COMPRESSION:a[e]=new Y1(i,this.dracoLoader);break;case T1.KHR_TEXTURE_TRANSFORM:a[e]=new $1;break;case T1.KHR_MESH_QUANTIZATION:a[e]=new X1;break;default:t.indexOf(e)>=0&&void 0===s[e]&&console.warn('THREE.GLTFLoader: Unknown extension "'+e+'".')}}l.setExtensions(a),l.setPlugins(s),l.parse(n,r)}parseAsync(e,t){const n=this;return new Promise((function(r,i){n.parse(e,t,r,i)}))}}function C1(){let e={};return{get:function(t){return e[t]},add:function(t,n){e[t]=n},remove:function(t){delete e[t]},removeAll:function(){e={}}}}const T1={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class M1{constructor(e){this.parser=e,this.name=T1.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,r=t.length;n<r;n++){const r=t[n];r.extensions&&r.extensions[this.name]&&void 0!==r.extensions[this.name].light&&e._addNodeRef(this.cache,r.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let r=t.cache.get(n);if(r)return r;const i=t.json,a=((i.extensions&&i.extensions[this.name]||{}).lights||[])[e];let s;const o=new eq(16777215);void 0!==a.color&&o.fromArray(a.color);const l=void 0!==a.range?a.range:0;switch(a.type){case"directional":s=new Z0(o),s.target.position.set(0,0,-1),s.add(s.target);break;case"point":s=new q0(o),s.distance=l;break;case"spot":s=new j0(o),s.distance=l,a.spot=a.spot||{},a.spot.innerConeAngle=void 0!==a.spot.innerConeAngle?a.spot.innerConeAngle:0,a.spot.outerConeAngle=void 0!==a.spot.outerConeAngle?a.spot.outerConeAngle:Math.PI/4,s.angle=a.spot.outerConeAngle,s.penumbra=1-a.spot.innerConeAngle/a.spot.outerConeAngle,s.target.position.set(0,0,-1),s.add(s.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+a.type)}return s.position.set(0,0,0),s.decay=2,c2(s,a),void 0!==a.intensity&&(s.intensity=a.intensity),s.name=t.createUniqueName(a.name||"light_"+e),r=Promise.resolve(s),t.cache.add(n,r),r}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,r=n.json.nodes[e],i=(r.extensions&&r.extensions[this.name]||{}).light;return void 0===i?null:this._loadLight(i).then((function(e){return n._getNodeRef(t.cache,i,e)}))}}class E1{constructor(){this.name=T1.KHR_MATERIALS_UNLIT}getMaterialType(){return nq}extendParams(e,t,n){const r=[];e.color=new eq(1,1,1),e.opacity=1;const i=t.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){const t=i.baseColorFactor;e.color.fromArray(t),e.opacity=t[3]}void 0!==i.baseColorTexture&&r.push(n.assignTexture(e,"map",i.baseColorTexture,UY))}return Promise.all(r)}}class A1{constructor(e){this.parser=e,this.name=T1.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=n.extensions[this.name].emissiveStrength;return void 0!==r&&(t.emissiveIntensity=r),Promise.resolve()}}class P1{constructor(e){this.parser=e,this.name=T1.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?i0:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],a=r.extensions[this.name];if(void 0!==a.clearcoatFactor&&(t.clearcoat=a.clearcoatFactor),void 0!==a.clearcoatTexture&&i.push(n.assignTexture(t,"clearcoatMap",a.clearcoatTexture)),void 0!==a.clearcoatRoughnessFactor&&(t.clearcoatRoughness=a.clearcoatRoughnessFactor),void 0!==a.clearcoatRoughnessTexture&&i.push(n.assignTexture(t,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),void 0!==a.clearcoatNormalTexture&&(i.push(n.assignTexture(t,"clearcoatNormalMap",a.clearcoatNormalTexture)),void 0!==a.clearcoatNormalTexture.scale)){const e=a.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new l$(e,e)}return Promise.all(i)}}class R1{constructor(e){this.parser=e,this.name=T1.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?i0:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],a=r.extensions[this.name];return void 0!==a.iridescenceFactor&&(t.iridescence=a.iridescenceFactor),void 0!==a.iridescenceTexture&&i.push(n.assignTexture(t,"iridescenceMap",a.iridescenceTexture)),void 0!==a.iridescenceIor&&(t.iridescenceIOR=a.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==a.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=a.iridescenceThicknessMinimum),void 0!==a.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=a.iridescenceThicknessMaximum),void 0!==a.iridescenceThicknessTexture&&i.push(n.assignTexture(t,"iridescenceThicknessMap",a.iridescenceThicknessTexture)),Promise.all(i)}}class L1{constructor(e){this.parser=e,this.name=T1.KHR_MATERIALS_SHEEN}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?i0:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[];t.sheenColor=new eq(0,0,0),t.sheenRoughness=0,t.sheen=1;const a=r.extensions[this.name];return void 0!==a.sheenColorFactor&&t.sheenColor.fromArray(a.sheenColorFactor),void 0!==a.sheenRoughnessFactor&&(t.sheenRoughness=a.sheenRoughnessFactor),void 0!==a.sheenColorTexture&&i.push(n.assignTexture(t,"sheenColorMap",a.sheenColorTexture,UY)),void 0!==a.sheenRoughnessTexture&&i.push(n.assignTexture(t,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(i)}}class k1{constructor(e){this.parser=e,this.name=T1.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?i0:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],a=r.extensions[this.name];return void 0!==a.transmissionFactor&&(t.transmission=a.transmissionFactor),void 0!==a.transmissionTexture&&i.push(n.assignTexture(t,"transmissionMap",a.transmissionTexture)),Promise.all(i)}}class D1{constructor(e){this.parser=e,this.name=T1.KHR_MATERIALS_VOLUME}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?i0:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],a=r.extensions[this.name];t.thickness=void 0!==a.thicknessFactor?a.thicknessFactor:0,void 0!==a.thicknessTexture&&i.push(n.assignTexture(t,"thicknessMap",a.thicknessTexture)),t.attenuationDistance=a.attenuationDistance||1/0;const s=a.attenuationColor||[1,1,1];return t.attenuationColor=new eq(s[0],s[1],s[2]),Promise.all(i)}}class I1{constructor(e){this.parser=e,this.name=T1.KHR_MATERIALS_IOR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?i0:null}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=n.extensions[this.name];return t.ior=void 0!==r.ior?r.ior:1.5,Promise.resolve()}}class O1{constructor(e){this.parser=e,this.name=T1.KHR_MATERIALS_SPECULAR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?i0:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],a=r.extensions[this.name];t.specularIntensity=void 0!==a.specularFactor?a.specularFactor:1,void 0!==a.specularTexture&&i.push(n.assignTexture(t,"specularIntensityMap",a.specularTexture));const s=a.specularColorFactor||[1,1,1];return t.specularColor=new eq(s[0],s[1],s[2]),void 0!==a.specularColorTexture&&i.push(n.assignTexture(t,"specularColorMap",a.specularColorTexture,UY)),Promise.all(i)}}class N1{constructor(e){this.parser=e,this.name=T1.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?i0:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],a=r.extensions[this.name];return void 0!==a.anisotropyStrength&&(t.anisotropy=a.anisotropyStrength),void 0!==a.anisotropyRotation&&(t.anisotropyRotation=a.anisotropyRotation),void 0!==a.anisotropyTexture&&i.push(n.assignTexture(t,"anisotropyMap",a.anisotropyTexture)),Promise.all(i)}}class B1{constructor(e){this.parser=e,this.name=T1.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const i=r.extensions[this.name],a=t.options.ktx2Loader;if(!a){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,i.source,a)}}class U1{constructor(e){this.parser=e,this.name=T1.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,i=r.textures[e];if(!i.extensions||!i.extensions[t])return null;const a=i.extensions[t],s=r.images[a.source];let o=n.textureLoader;if(s.uri){const e=n.options.manager.getHandler(s.uri);null!==e&&(o=e)}return this.detectSupport().then((function(i){if(i)return n.loadTextureImage(e,a.source,o);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported}}class z1{constructor(e){this.parser=e,this.name=T1.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,i=r.textures[e];if(!i.extensions||!i.extensions[t])return null;const a=i.extensions[t],s=r.images[a.source];let o=n.textureLoader;if(s.uri){const e=n.options.manager.getHandler(s.uri);null!==e&&(o=e)}return this.detectSupport().then((function(i){if(i)return n.loadTextureImage(e,a.source,o);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported}}class F1{constructor(e){this.name=T1.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const e=n.extensions[this.name],r=this.parser.getDependency("buffer",e.buffer),i=this.parser.options.meshoptDecoder;if(!i||!i.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return r.then((function(t){const n=e.byteOffset||0,r=e.byteLength||0,a=e.count,s=e.byteStride,o=new Uint8Array(t,n,r);return i.decodeGltfBufferAsync?i.decodeGltfBufferAsync(a,s,o,e.mode,e.filter).then((function(e){return e.buffer})):i.ready.then((function(){const t=new ArrayBuffer(a*s);return i.decodeGltfBuffer(new Uint8Array(t),a,s,o,e.mode,e.filter),t}))}))}return null}}class V1{constructor(e){this.name=T1.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||void 0===n.mesh)return null;const r=t.meshes[n.mesh];for(const o of r.primitives)if(o.mode!==J1.TRIANGLES&&o.mode!==J1.TRIANGLE_STRIP&&o.mode!==J1.TRIANGLE_FAN&&void 0!==o.mode)return null;const i=n.extensions[this.name].attributes,a=[],s={};for(const o in i)a.push(this.parser.getDependency("accessor",i[o]).then((e=>(s[o]=e,s[o]))));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then((e=>{const t=e.pop(),n=t.isGroup?t.children:[t],r=e[0].count,i=[];for(const a of n){const e=new cX,t=new I$,n=new D$,o=new I$(1,1,1),l=new EQ(a.geometry,a.material,r);for(let i=0;i<r;i++)s.TRANSLATION&&t.fromBufferAttribute(s.TRANSLATION,i),s.ROTATION&&n.fromBufferAttribute(s.ROTATION,i),s.SCALE&&o.fromBufferAttribute(s.SCALE,i),l.setMatrixAt(i,e.compose(t,n,o));for(const r in s)"TRANSLATION"!==r&&"ROTATION"!==r&&"SCALE"!==r&&a.geometry.setAttribute(r,s[r]);OX.prototype.copy.call(l,a),this.parser.assignFinalMaterial(l),i.push(l)}return t.isGroup?(t.clear(),t.add(...i),t):i[0]})))}}const G1="glTF",H1=1313821514,j1=5130562;class W1{constructor(e){this.name=T1.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12),n=new TextDecoder;if(this.header={magic:n.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==G1)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-12,i=new DataView(e,12);let a=0;for(;a<r;){const t=i.getUint32(a,!0);a+=4;const r=i.getUint32(a,!0);if(a+=4,r===H1){const r=new Uint8Array(e,12+a,t);this.content=n.decode(r)}else if(r===j1){const n=12+a;this.body=e.slice(n,n+t)}a+=t}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Y1{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=T1.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,r=this.dracoLoader,i=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,s={},o={},l={};for(const u in a){const e=r2[u]||u.toLowerCase();s[e]=a[u]}for(const u in e.attributes){const t=r2[u]||u.toLowerCase();if(void 0!==a[u]){const r=n.accessors[e.attributes[u]],i=Q1[r.componentType];l[t]=i.name,o[t]=!0===r.normalized}}return t.getDependency("bufferView",i).then((function(e){return new Promise((function(t){r.decodeDracoFile(e,(function(e){for(const t in e.attributes){const n=e.attributes[t],r=o[t];void 0!==r&&(n.normalized=r)}t(e)}),s,l)}))}))}}class $1{constructor(){this.name=T1.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return void 0!==t.texCoord&&t.texCoord!==e.channel||void 0!==t.offset||void 0!==t.rotation||void 0!==t.scale?(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0,e):e}}class X1{constructor(){this.name=T1.KHR_MESH_QUANTIZATION}}class q1 extends f0{constructor(e,t,n,r){super(e,t,n,r)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r*3+r;for(let a=0;a!==r;a++)t[a]=n[i+a];return t}interpolate_(e,t,n,r){const i=this.resultBuffer,a=this.sampleValues,s=this.valueSize,o=2*s,l=3*s,u=r-t,c=(n-t)/u,d=c*c,h=d*c,p=e*l,f=p-l,m=-2*h+3*d,g=h-d,v=1-m,y=g-d+c;for(let _=0;_!==s;_++){const e=a[f+_+s],t=a[f+_+o]*u,n=a[p+_+s],r=a[p+_]*u;i[_]=v*e+y*t+m*n+g*r}return i}}const K1=new D$;class Z1 extends q1{interpolate_(e,t,n,r){const i=super.interpolate_(e,t,n,r);return K1.fromArray(i).normalize().toArray(i),i}}const J1={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Q1={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},e2={9728:uY,9729:hY,9984:cY,9985:1007,9986:dY,9987:pY},t2={33071:oY,33648:lY,10497:sY},n2={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},r2={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},i2={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},a2={CUBICSPLINE:void 0,LINEAR:RY,STEP:PY},s2="OPAQUE",o2="MASK",l2="BLEND";function u2(e,t,n){for(const r in n.extensions)void 0===e[r]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[r]=n.extensions[r])}function c2(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function d2(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(let n=0,r=t.weights.length;n<r;n++)e.morphTargetInfluences[n]=t.weights[n];if(t.extras&&Array.isArray(t.extras.targetNames)){const n=t.extras.targetNames;if(e.morphTargetInfluences.length===n.length){e.morphTargetDictionary={};for(let t=0,r=n.length;t<r;t++)e.morphTargetDictionary[n[t]]=t}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function h2(e){let t;const n=e.extensions&&e.extensions[T1.KHR_DRACO_MESH_COMPRESSION];if(t=n?"draco:"+n.bufferView+":"+n.indices+":"+p2(n.attributes):e.indices+":"+p2(e.attributes)+":"+e.mode,void 0!==e.targets)for(let r=0,i=e.targets.length;r<i;r++)t+=":"+p2(e.targets[r]);return t}function p2(e){let t="";const n=Object.keys(e).sort();for(let r=0,i=n.length;r<i;r++)t+=n[r]+":"+e[n[r]]+";";return t}function f2(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const m2=new cX;class g2{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new C1,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,r=!1,i=-1;"undefined"!=typeof navigator&&(n=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),r=navigator.userAgent.indexOf("Firefox")>-1,i=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),"undefined"==typeof createImageBitmap||n||r&&i<98?this.textureLoader=new B0(this.options.manager):this.textureLoader=new t1(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new I0(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,r=this.json,i=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll((function(e){return e._markDefs&&e._markDefs()})),Promise.all(this._invokeAll((function(e){return e.beforeRoot&&e.beforeRoot()}))).then((function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])})).then((function(t){const a={scene:t[0][r.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:r.asset,parser:n,userData:{}};u2(i,a,r),c2(a,r),Promise.all(n._invokeAll((function(e){return e.afterRoot&&e.afterRoot(a)}))).then((function(){e(a)}))})).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let r=0,i=t.length;r<i;r++){const n=t[r].joints;for(let t=0,r=n.length;t<r;t++)e[n[t]].isBone=!0}for(let r=0,i=e.length;r<i;r++){const t=e[r];void 0!==t.mesh&&(this._addNodeRef(this.meshCache,t.mesh),void 0!==t.skin&&(n[t.mesh].isSkinnedMesh=!0)),void 0!==t.camera&&this._addNodeRef(this.cameraCache,t.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const r=n.clone(),i=(e,t)=>{const n=this.associations.get(e);null!=n&&this.associations.set(t,n);for(const[r,a]of e.children.entries())i(a,t.children[r])};return i(n,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const r=e(t[n]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let r=0;r<t.length;r++){const i=e(t[r]);i&&n.push(i)}return n}getDependency(e,t){const n=e+":"+t;let r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne((function(e){return e.loadNode&&e.loadNode(t)}));break;case"mesh":r=this._invokeOne((function(e){return e.loadMesh&&e.loadMesh(t)}));break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne((function(e){return e.loadBufferView&&e.loadBufferView(t)}));break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne((function(e){return e.loadMaterial&&e.loadMaterial(t)}));break;case"texture":r=this._invokeOne((function(e){return e.loadTexture&&e.loadTexture(t)}));break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne((function(e){return e.loadAnimation&&e.loadAnimation(t)}));break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne((function(n){return n!=this&&n.getDependency&&n.getDependency(e,t)})),!r)throw new Error("Unknown type: "+e)}this.cache.add(n,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,r=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(r.map((function(t,r){return n.getDependency(e,r)}))),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[T1.KHR_BINARY_GLTF].body);const r=this.options;return new Promise((function(e,i){n.load(Q0.resolveURL(t.uri,r.path),e,void 0,(function(){i(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){const n=t.byteLength||0,r=t.byteOffset||0;return e.slice(r,r+n)}))}loadAccessor(e){const t=this,n=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse){const e=n2[r.type],t=Q1[r.componentType],n=!0===r.normalized,i=new t(r.count*e);return Promise.resolve(new lq(i,e,n))}const i=[];return void 0!==r.bufferView?i.push(this.getDependency("bufferView",r.bufferView)):i.push(null),void 0!==r.sparse&&(i.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(i).then((function(e){const i=e[0],a=n2[r.type],s=Q1[r.componentType],o=s.BYTES_PER_ELEMENT,l=o*a,u=r.byteOffset||0,c=void 0!==r.bufferView?n.bufferViews[r.bufferView].byteStride:void 0,d=!0===r.normalized;let h,p;if(c&&c!==l){const e=Math.floor(u/c),n="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+e+":"+r.count;let l=t.cache.get(n);l||(h=new s(i,e*c,r.count*c/o),l=new zJ(h,c/o),t.cache.add(n,l)),p=new VJ(l,a,u%c/o,d)}else h=null===i?new s(r.count*a):new s(i,u,r.count*a),p=new lq(h,a,d);if(void 0!==r.sparse){const t=n2.SCALAR,n=Q1[r.sparse.indices.componentType],o=r.sparse.indices.byteOffset||0,l=r.sparse.values.byteOffset||0,u=new n(e[1],o,r.sparse.count*t),c=new s(e[2],l,r.sparse.count*a);null!==i&&(p=new lq(p.array.slice(),p.itemSize,p.normalized));for(let e=0,r=u.length;e<r;e++){const t=u[e];if(p.setX(t,c[e*a]),a>=2&&p.setY(t,c[e*a+1]),a>=3&&p.setZ(t,c[e*a+2]),a>=4&&p.setW(t,c[e*a+3]),a>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return p}))}loadTexture(e){const t=this.json,n=this.options,r=t.textures[e].source,i=t.images[r];let a=this.textureLoader;if(i.uri){const e=n.manager.getHandler(i.uri);null!==e&&(a=e)}return this.loadTextureImage(e,r,a)}loadTextureImage(e,t,n){const r=this,i=this.json,a=i.textures[e],s=i.images[t],o=(s.uri||s.bufferView)+":"+a.sampler;if(this.textureCache[o])return this.textureCache[o];const l=this.loadImageSource(t,n).then((function(t){t.flipY=!1,t.name=a.name||s.name||"",""===t.name&&"string"==typeof s.uri&&!1===s.uri.startsWith("data:image/")&&(t.name=s.uri);const n=(i.samplers||{})[a.sampler]||{};return t.magFilter=e2[n.magFilter]||hY,t.minFilter=e2[n.minFilter]||pY,t.wrapS=t2[n.wrapS]||sY,t.wrapT=t2[n.wrapT]||sY,r.associations.set(t,{textures:e}),t})).catch((function(){return null}));return this.textureCache[o]=l,l}loadImageSource(e,t){const n=this,r=this.json,i=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then((e=>e.clone()));const a=r.images[e],s=self.URL||self.webkitURL;let o=a.uri||"",l=!1;if(void 0!==a.bufferView)o=n.getDependency("bufferView",a.bufferView).then((function(e){l=!0;const t=new Blob([e],{type:a.mimeType});return o=s.createObjectURL(t),o}));else if(void 0===a.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const u=Promise.resolve(o).then((function(e){return new Promise((function(n,r){let a=n;!0===t.isImageBitmapLoader&&(a=function(e){const t=new A$(e);t.needsUpdate=!0,n(t)}),t.load(Q0.resolveURL(e,i.path),a,void 0,r)}))})).then((function(e){var t;return!0===l&&s.revokeObjectURL(o),e.userData.mimeType=a.mimeType||((t=a.uri).search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/)?"image/jpeg":t.search(/\.webp($|\?)/i)>0||0===t.search(/^data\:image\/webp/)?"image/webp":"image/png"),e})).catch((function(e){throw console.error("THREE.GLTFLoader: Couldn't load texture",o),e}));return this.sourceCache[e]=u,u}assignTexture(e,t,n,r){const i=this;return this.getDependency("texture",n.index).then((function(a){if(!a)return null;if(void 0!==n.texCoord&&n.texCoord>0&&((a=a.clone()).channel=n.texCoord),i.extensions[T1.KHR_TEXTURE_TRANSFORM]){const e=void 0!==n.extensions?n.extensions[T1.KHR_TEXTURE_TRANSFORM]:void 0;if(e){const t=i.associations.get(a);a=i.extensions[T1.KHR_TEXTURE_TRANSFORM].extendTexture(a,e),i.associations.set(a,t)}}return void 0!==r&&(a.colorSpace=r),e[t]=a,a}))}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const r=void 0===t.attributes.tangent,i=void 0!==t.attributes.color,a=void 0===t.attributes.normal;if(e.isPoints){const e="PointsMaterial:"+n.uuid;let t=this.cache.get(e);t||(t=new zQ,qX.prototype.copy.call(t,n),t.color.copy(n.color),t.map=n.map,t.sizeAttenuation=!1,this.cache.add(e,t)),n=t}else if(e.isLine){const e="LineBasicMaterial:"+n.uuid;let t=this.cache.get(e);t||(t=new AQ,qX.prototype.copy.call(t,n),t.color.copy(n.color),t.map=n.map,this.cache.add(e,t)),n=t}if(r||i||a){let e="ClonedMaterial:"+n.uuid+":";r&&(e+="derivative-tangents:"),i&&(e+="vertex-colors:"),a&&(e+="flat-shading:");let t=this.cache.get(e);t||(t=n.clone(),i&&(t.vertexColors=!0),a&&(t.flatShading=!0),r&&(t.normalScale&&(t.normalScale.y*=-1),t.clearcoatNormalScale&&(t.clearcoatNormalScale.y*=-1)),this.cache.add(e,t),this.associations.set(t,this.associations.get(n))),n=t}e.material=n}getMaterialType(){return r0}loadMaterial(e){const t=this,n=this.json,r=this.extensions,i=n.materials[e];let a;const s={},o=[];if((i.extensions||{})[T1.KHR_MATERIALS_UNLIT]){const e=r[T1.KHR_MATERIALS_UNLIT];a=e.getMaterialType(),o.push(e.extendParams(s,i,t))}else{const n=i.pbrMetallicRoughness||{};if(s.color=new eq(1,1,1),s.opacity=1,Array.isArray(n.baseColorFactor)){const e=n.baseColorFactor;s.color.fromArray(e),s.opacity=e[3]}void 0!==n.baseColorTexture&&o.push(t.assignTexture(s,"map",n.baseColorTexture,UY)),s.metalness=void 0!==n.metallicFactor?n.metallicFactor:1,s.roughness=void 0!==n.roughnessFactor?n.roughnessFactor:1,void 0!==n.metallicRoughnessTexture&&(o.push(t.assignTexture(s,"metalnessMap",n.metallicRoughnessTexture)),o.push(t.assignTexture(s,"roughnessMap",n.metallicRoughnessTexture))),a=this._invokeOne((function(t){return t.getMaterialType&&t.getMaterialType(e)})),o.push(Promise.all(this._invokeAll((function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,s)}))))}!0===i.doubleSided&&(s.side=2);const l=i.alphaMode||s2;if(l===l2?(s.transparent=!0,s.depthWrite=!1):(s.transparent=!1,l===o2&&(s.alphaTest=void 0!==i.alphaCutoff?i.alphaCutoff:.5)),void 0!==i.normalTexture&&a!==nq&&(o.push(t.assignTexture(s,"normalMap",i.normalTexture)),s.normalScale=new l$(1,1),void 0!==i.normalTexture.scale)){const e=i.normalTexture.scale;s.normalScale.set(e,e)}return void 0!==i.occlusionTexture&&a!==nq&&(o.push(t.assignTexture(s,"aoMap",i.occlusionTexture)),void 0!==i.occlusionTexture.strength&&(s.aoMapIntensity=i.occlusionTexture.strength)),void 0!==i.emissiveFactor&&a!==nq&&(s.emissive=(new eq).fromArray(i.emissiveFactor)),void 0!==i.emissiveTexture&&a!==nq&&o.push(t.assignTexture(s,"emissiveMap",i.emissiveTexture,UY)),Promise.all(o).then((function(){const n=new a(s);return i.name&&(n.name=i.name),c2(n,i),t.associations.set(n,{materials:e}),i.extensions&&u2(r,n,i),n}))}createUniqueName(e){const t=d1.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,n=this.extensions,r=this.primitiveCache;function i(e){return n[T1.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(n){return v2(n,e,t)}))}const a=[];for(let s=0,o=e.length;s<o;s++){const n=e[s],o=h2(n),l=r[o];if(l)a.push(l.promise);else{let e;e=n.extensions&&n.extensions[T1.KHR_DRACO_MESH_COMPRESSION]?i(n):v2(new _q,n,t),r[o]={primitive:n,promise:e},a.push(e)}}return Promise.all(a)}loadMesh(e){const t=this,n=this.json,r=this.extensions,i=n.meshes[e],a=i.primitives,s=[];for(let l=0,u=a.length;l<u;l++){const e=void 0===a[l].material?(void 0===(o=this.cache).DefaultMaterial&&(o.DefaultMaterial=new r0({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:WW})),o.DefaultMaterial):this.getDependency("material",a[l].material);s.push(e)}var o;return s.push(t.loadGeometries(a)),Promise.all(s).then((function(n){const s=n.slice(0,n.length-1),o=n[n.length-1],l=[];for(let c=0,d=o.length;c<d;c++){const n=o[c],u=a[c];let d;const h=s[c];if(u.mode===J1.TRIANGLES||u.mode===J1.TRIANGLE_STRIP||u.mode===J1.TRIANGLE_FAN||void 0===u.mode)d=!0===i.isSkinnedMesh?new pQ(n,h):new Bq(n,h),!0===d.isSkinnedMesh&&d.normalizeSkinWeights(),u.mode===J1.TRIANGLE_STRIP?d.geometry=w1(d.geometry,1):u.mode===J1.TRIANGLE_FAN&&(d.geometry=w1(d.geometry,2));else if(u.mode===J1.LINES)d=new BQ(n,h);else if(u.mode===J1.LINE_STRIP)d=new IQ(n,h);else if(u.mode===J1.LINE_LOOP)d=new UQ(n,h);else{if(u.mode!==J1.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+u.mode);d=new jQ(n,h)}Object.keys(d.geometry.morphAttributes).length>0&&d2(d,i),d.name=t.createUniqueName(i.name||"mesh_"+e),c2(d,i),u.extensions&&u2(r,d,u),t.assignFinalMaterial(d),l.push(d)}for(let r=0,i=l.length;r<i;r++)t.associations.set(l[r],{meshes:e,primitives:r});if(1===l.length)return i.extensions&&u2(r,l[0],i),l[0];const u=new PJ;i.extensions&&u2(r,u,i),t.associations.set(u,{meshes:e});for(let e=0,t=l.length;e<t;e++)u.add(l[e]);return u}))}loadCamera(e){let t;const n=this.json.cameras[e],r=n[n.type];if(r)return"perspective"===n.type?t=new Yq(o$.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===n.type&&(t=new vK(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),c2(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],n=[];for(let r=0,i=t.joints.length;r<i;r++)n.push(this._loadNodeShallow(t.joints[r]));return void 0!==t.inverseBindMatrices?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then((function(e){const n=e.pop(),r=e,i=[],a=[];for(let s=0,o=r.length;s<o;s++){const e=r[s];if(e){i.push(e);const t=new cX;null!==n&&t.fromArray(n.array,16*s),a.push(t)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[s])}return new yQ(i,a)}))}loadAnimation(e){const t=this.json.animations[e],n=t.name?t.name:"animation_"+e,r=[],i=[],a=[],s=[],o=[];for(let l=0,u=t.channels.length;l<u;l++){const e=t.channels[l],n=t.samplers[e.sampler],u=e.target,c=u.node,d=void 0!==t.parameters?t.parameters[n.input]:n.input,h=void 0!==t.parameters?t.parameters[n.output]:n.output;void 0!==u.node&&(r.push(this.getDependency("node",c)),i.push(this.getDependency("accessor",d)),a.push(this.getDependency("accessor",h)),s.push(n),o.push(u))}return Promise.all([Promise.all(r),Promise.all(i),Promise.all(a),Promise.all(s),Promise.all(o)]).then((function(e){const t=e[0],r=e[1],i=e[2],a=e[3],s=e[4],o=[];for(let n=0,l=t.length;n<l;n++){const e=t[n],l=r[n],u=i[n],c=a[n],d=s[n];if(void 0===e)continue;let h;switch(e.updateMatrix(),i2[d.path]){case i2.weights:h=x0;break;case i2.rotation:h=S0;break;default:h=T0}const p=e.name?e.name:e.uuid,f=void 0!==c.interpolation?a2[c.interpolation]:RY,m=[];i2[d.path]===i2.weights?e.traverse((function(e){e.morphTargetInfluences&&m.push(e.name?e.name:e.uuid)})):m.push(p);let g=u.array;if(u.normalized){const e=f2(g.constructor),t=new Float32Array(g.length);for(let n=0,r=g.length;n<r;n++)t[n]=g[n]*e;g=t}for(let t=0,n=m.length;t<n;t++){const e=new h(m[t]+"."+i2[d.path],l.array,g,f);"CUBICSPLINE"===c.interpolation&&(e.createInterpolant=function(e){return new(this instanceof S0?Z1:q1)(this.times,this.values,this.getValueSize()/3,e)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),o.push(e)}}return new M0(n,void 0,o)}))}createNodeMesh(e){const t=this.json,n=this,r=t.nodes[e];return void 0===r.mesh?null:n.getDependency("mesh",r.mesh).then((function(e){const t=n._getNodeRef(n.meshCache,r.mesh,e);return void 0!==r.weights&&t.traverse((function(e){if(e.isMesh)for(let t=0,n=r.weights.length;t<n;t++)e.morphTargetInfluences[t]=r.weights[t]})),t}))}loadNode(e){const t=this,n=this.json.nodes[e],r=t._loadNodeShallow(e),i=[],a=n.children||[];for(let o=0,l=a.length;o<l;o++)i.push(t.getDependency("node",a[o]));const s=void 0===n.skin?Promise.resolve(null):t.getDependency("skin",n.skin);return Promise.all([r,Promise.all(i),s]).then((function(e){const t=e[0],n=e[1],r=e[2];null!==r&&t.traverse((function(e){e.isSkinnedMesh&&e.bind(r,m2)}));for(let i=0,a=n.length;i<a;i++)t.add(n[i]);return t}))}_loadNodeShallow(e){const t=this.json,n=this.extensions,r=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const i=t.nodes[e],a=i.name?r.createUniqueName(i.name):"",s=[],o=r._invokeOne((function(t){return t.createNodeMesh&&t.createNodeMesh(e)}));return o&&s.push(o),void 0!==i.camera&&s.push(r.getDependency("camera",i.camera).then((function(e){return r._getNodeRef(r.cameraCache,i.camera,e)}))),r._invokeAll((function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)})).forEach((function(e){s.push(e)})),this.nodeCache[e]=Promise.all(s).then((function(t){let s;if(s=!0===i.isBone?new fQ:t.length>1?new PJ:1===t.length?t[0]:new OX,s!==t[0])for(let e=0,n=t.length;e<n;e++)s.add(t[e]);if(i.name&&(s.userData.name=i.name,s.name=a),c2(s,i),i.extensions&&u2(n,s,i),void 0!==i.matrix){const e=new cX;e.fromArray(i.matrix),s.applyMatrix4(e)}else void 0!==i.translation&&s.position.fromArray(i.translation),void 0!==i.rotation&&s.quaternion.fromArray(i.rotation),void 0!==i.scale&&s.scale.fromArray(i.scale);return r.associations.has(s)||r.associations.set(s,{}),r.associations.get(s).nodes=e,s})),this.nodeCache[e]}loadScene(e){const t=this.extensions,n=this.json.scenes[e],r=this,i=new PJ;n.name&&(i.name=r.createUniqueName(n.name)),c2(i,n),n.extensions&&u2(t,i,n);const a=n.nodes||[],s=[];for(let o=0,l=a.length;o<l;o++)s.push(r.getDependency("node",a[o]));return Promise.all(s).then((function(e){for(let t=0,n=e.length;t<n;t++)i.add(e[t]);return r.associations=(e=>{const t=new Map;for(const[n,i]of r.associations)(n instanceof qX||n instanceof A$)&&t.set(n,i);return e.traverse((e=>{const n=r.associations.get(e);null!=n&&t.set(e,n)})),t})(i),i}))}}function v2(e,t,n){const r=t.attributes,i=[];function a(t,r){return n.getDependency("accessor",t).then((function(t){e.setAttribute(r,t)}))}for(const s in r){const t=r2[s]||s.toLowerCase();t in e.attributes||i.push(a(r[s],t))}if(void 0!==t.indices&&!e.index){const r=n.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));i.push(r)}return c2(e,t),function(e,t,n){const r=t.attributes,i=new B$;if(void 0===r.POSITION)return;{const e=n.json.accessors[r.POSITION],t=e.min,a=e.max;if(void 0===t||void 0===a)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(i.set(new I$(t[0],t[1],t[2]),new I$(a[0],a[1],a[2])),e.normalized){const t=f2(Q1[e.componentType]);i.min.multiplyScalar(t),i.max.multiplyScalar(t)}}const a=t.targets;if(void 0!==a){const e=new I$,t=new I$;for(let r=0,i=a.length;r<i;r++){const i=a[r];if(void 0!==i.POSITION){const r=n.json.accessors[i.POSITION],a=r.min,s=r.max;if(void 0!==a&&void 0!==s){if(t.setX(Math.max(Math.abs(a[0]),Math.abs(s[0]))),t.setY(Math.max(Math.abs(a[1]),Math.abs(s[1]))),t.setZ(Math.max(Math.abs(a[2]),Math.abs(s[2]))),r.normalized){const e=f2(Q1[r.componentType]);t.multiplyScalar(e)}e.max(t)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(e)}e.boundingBox=i;const s=new tX;i.getCenter(s.center),s.radius=i.min.distanceTo(i.max)/2,e.boundingSphere=s}(e,t,n),Promise.all(i).then((function(){return void 0!==t.targets?function(e,t,n){let r=!1,i=!1,a=!1;for(let u=0,c=t.length;u<c;u++){const e=t[u];if(void 0!==e.POSITION&&(r=!0),void 0!==e.NORMAL&&(i=!0),void 0!==e.COLOR_0&&(a=!0),r&&i&&a)break}if(!r&&!i&&!a)return Promise.resolve(e);const s=[],o=[],l=[];for(let u=0,c=t.length;u<c;u++){const c=t[u];if(r){const t=void 0!==c.POSITION?n.getDependency("accessor",c.POSITION):e.attributes.position;s.push(t)}if(i){const t=void 0!==c.NORMAL?n.getDependency("accessor",c.NORMAL):e.attributes.normal;o.push(t)}if(a){const t=void 0!==c.COLOR_0?n.getDependency("accessor",c.COLOR_0):e.attributes.color;l.push(t)}}return Promise.all([Promise.all(s),Promise.all(o),Promise.all(l)]).then((function(t){const n=t[0],s=t[1],o=t[2];return r&&(e.morphAttributes.position=n),i&&(e.morphAttributes.normal=s),a&&(e.morphAttributes.color=o),e.morphTargetsRelative=!0,e}))}(e,t.targets,n):e}))}const y2=new WeakMap;class _2 extends L0{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,n,r){const i=new I0(this.manager);i.setPath(this.path),i.setResponseType("arraybuffer"),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(e,(e=>{this.parse(e,t,r)}),n,r)}parse(e,t,n){this.decodeDracoFile(e,t,null,null,UY).catch(n)}decodeDracoFile(e,t,n,r,i=zY){const a={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!n,vertexColorSpace:i};return this.decodeGeometry(e,a).then(t)}decodeGeometry(e,t){const n=JSON.stringify(t);if(y2.has(e)){const t=y2.get(e);if(t.key===n)return t.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r;const i=this.workerNextTaskID++,a=e.byteLength,s=this._getWorker(i,a).then((n=>(r=n,new Promise(((n,a)=>{r._callbacks[i]={resolve:n,reject:a},r.postMessage({type:"decode",id:i,taskConfig:t,buffer:e},[e])}))))).then((e=>this._createGeometry(e.geometry)));return s.catch((()=>!0)).then((()=>{r&&i&&this._releaseTask(r,i)})),y2.set(e,{key:n,promise:s}),s}_createGeometry(e){const t=new _q;e.index&&t.setIndex(new lq(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const r=e.attributes[n],i=r.name,a=r.array,s=r.itemSize,o=new lq(a,s);"color"===i&&(this._assignVertexColorSpace(o,r.vertexColorSpace),o.normalized=a instanceof Float32Array==!1),t.setAttribute(i,o)}return t}_assignVertexColorSpace(e,t){if(t!==UY)return;const n=new eq;for(let r=0,i=e.count;r<i;r++)n.fromBufferAttribute(e,r).convertSRGBToLinear(),e.setXYZ(r,n.r,n.g,n.b)}_loadLibrary(e,t){const n=new I0(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise(((t,r)=>{n.load(e,t,void 0,r)}))}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then((t=>{const n=t[0];e||(this.decoderConfig.wasmBinary=t[1]);const r=b2.toString(),i=["/* draco decoder */",n,"","/* worker */",r.substring(r.indexOf("{")+1,r.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([i]))})),this.decoderPending}_getWorker(e,t){return this._initDecoder().then((()=>{if(this.workerPool.length<this.workerLimit){const e=new Worker(this.workerSourceURL);e._callbacks={},e._taskCosts={},e._taskLoad=0,e.postMessage({type:"init",decoderConfig:this.decoderConfig}),e.onmessage=function(t){const n=t.data;switch(n.type){case"decode":e._callbacks[n.id].resolve(n);break;case"error":e._callbacks[n.id].reject(n);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+n.type+'"')}},this.workerPool.push(e)}else this.workerPool.sort((function(e,t){return e._taskLoad>t._taskLoad?-1:1}));const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=t,n._taskLoad+=t,n}))}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map((e=>e._taskLoad)))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,""!==this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),this}}function b2(){let e,t;function n(e,t,n,r,i,a){const s=a.num_components(),o=n.num_points()*s,l=o*i.BYTES_PER_ELEMENT,u=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(e,i),c=e._malloc(l);t.GetAttributeDataArrayForAllPoints(n,a,u,l,c);const d=new i(e.HEAPF32.buffer,c,o).slice();return e._free(c),{name:r,array:d,itemSize:s}}onmessage=function(r){const i=r.data;switch(i.type){case"init":e=i.decoderConfig,t=new Promise((function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)}));break;case"decode":const r=i.buffer,a=i.taskConfig;t.then((e=>{const t=e.draco,s=new t.Decoder;try{const e=function(e,t,r,i){const a=i.attributeIDs,s=i.attributeTypes;let o,l;const u=t.GetEncodedGeometryType(r);if(u===e.TRIANGULAR_MESH)o=new e.Mesh,l=t.DecodeArrayToMesh(r,r.byteLength,o);else{if(u!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");o=new e.PointCloud,l=t.DecodeArrayToPointCloud(r,r.byteLength,o)}if(!l.ok()||0===o.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+l.error_msg());const c={index:null,attributes:[]};for(const d in a){const r=self[s[d]];let l,u;if(i.useUniqueIDs)u=a[d],l=t.GetAttributeByUniqueId(o,u);else{if(u=t.GetAttributeId(o,e[a[d]]),-1===u)continue;l=t.GetAttribute(o,u)}const h=n(e,t,o,d,r,l);"color"===d&&(h.vertexColorSpace=i.vertexColorSpace),c.attributes.push(h)}u===e.TRIANGULAR_MESH&&(c.index=function(e,t,n){const r=n.num_faces(),i=3*r,a=4*i,s=e._malloc(a);t.GetTrianglesUInt32Array(n,a,s);const o=new Uint32Array(e.HEAPF32.buffer,s,i).slice();return e._free(s),{array:o,itemSize:1}}(e,t,o));return e.destroy(o),c}(t,s,new Int8Array(r),a),o=e.attributes.map((e=>e.array.buffer));e.index&&o.push(e.index.array.buffer),self.postMessage({type:"decode",id:i.id,geometry:e},o)}catch(o){console.error(o),self.postMessage({type:"error",id:i.id,error:o.message})}finally{t.destroy(s)}}))}}}const x2={modelValue:{type:Boolean,default:!0},list:{type:Array,required:!0,default:[]},step:{type:Number,default:1},limitScrollNum:{type:Number,default:3},hover:{type:Boolean,default:!1},direction:{type:String,default:"up"},singleHeight:{type:Number,default:0},singleWidth:{type:Number,default:0},singleWaitTime:{type:Number,default:1e3},isRemUnit:{type:Boolean,default:!1},isWatch:{type:Boolean,default:!0},delay:{type:Number,default:0},ease:{type:[String,Object],default:"ease-in"},count:{type:Number,default:-1},copyNum:{type:Number,default:1},wheel:{type:Boolean,default:!1},singleLine:{type:Boolean,default:!1}};globalThis.window.cancelAnimationFrame=globalThis.window.cancelAnimationFrame||globalThis.window.webkitCancelAnimationFrame||globalThis.window.mozCancelAnimationFrame||globalThis.window.oCancelAnimationFrame||globalThis.window.msCancelAnimationFrame||function(e){return globalThis.window.clearTimeout(e)},globalThis.window.requestAnimationFrame=globalThis.window.requestAnimationFrame||globalThis.window.webkitRequestAnimationFrame||globalThis.window.mozRequestAnimationFrame||globalThis.window.oRequestAnimationFrame||globalThis.window.msRequestAnimationFrame||function(e){return globalThis.window.setTimeout(e,1e3/60)};const w2=Fn({name:"vue3-seamless-scroll",inheritAttrs:!1,props:x2,emits:["stop","count","move"],setup(e,{slots:t,emit:n,attrs:r}){const i=e,a=At(null),s=At(null),o=At(null),l=At(null),u=At(null),c=At(0),d=At(0),h=At(0),p=At(0),f=At(!1),m=At(0),g=Ki((()=>!!i.list&&i.list.length>=i.limitScrollNum)),v=Ki((()=>({width:c.value?`${c.value}px`:"auto",transform:`translate(${h.value}px,${p.value}px)`,transition:`all ${"string"==typeof i.ease?i.ease:"cubic-bezier("+i.ease.x1+","+i.ease.y1+","+i.ease.x2+","+i.ease.y2+")"} ${i.delay}ms`,overflow:"hidden",display:i.singleLine?"flex":"block"}))),y=Ki((()=>"left"==i.direction||"right"==i.direction)),_=Ki((()=>y.value?{float:"left",overflow:"hidden",display:i.singleLine?"flex":"block",flexShrink:i.singleLine?0:1}:{overflow:"hidden"})),b=Ki((()=>i.isRemUnit?parseInt(globalThis.window.getComputedStyle(globalThis.document.documentElement,null).fontSize):1)),x=Ki((()=>i.singleWidth*b.value)),w=Ki((()=>i.singleHeight*b.value)),S=Ki((()=>{let e,t=i.step;return e=y.value?x.value:w.value,e>0&&e%t>0&&console.error("如果设置了单步滚动，step 需是单步大小的约数，否则无法保证单步滚动结束的位置是否准确。~~~~~"),t})),C=()=>{cancelAnimationFrame(l.value),l.value=null},T=(e,t,r)=>{l.value=requestAnimationFrame((function(){const a=d.value/2,s=c.value/2;if("up"===e?(Math.abs(p.value)>=a&&(p.value=0,m.value+=1,n("count",m.value)),p.value-=t):"down"===e?(p.value>=0&&(p.value=-1*a,m.value+=1,n("count",m.value)),p.value+=t):"left"===e?(Math.abs(h.value)>=s&&(h.value=0,m.value+=1,n("count",m.value)),h.value-=t):"right"===e&&(h.value>=0&&(h.value=-1*s,m.value+=1,n("count",m.value)),h.value+=t),r)return;let{singleWaitTime:o}=i;u.value&&clearTimeout(u.value),w.value?Math.abs(p.value)%w.value<t?u.value=setTimeout((()=>{M()}),o):M():x.value&&Math.abs(h.value)%x.value<t?u.value=setTimeout((()=>{M()}),o):M()}))},M=()=>{if(C(),f.value||!g.value||m.value===i.count)return n("stop",m.value),void(m.value=0);T(i.direction,S.value,!1)},E=()=>{var e;if((e=i.list)&&"boolean"!=typeof e&&e.length>100&&console.warn(`数据达到了${e.length}条有点多哦~,可能会造成部分老旧浏览器卡顿。`),y.value){let e=s.value.offsetWidth;e=2*e+1,c.value=e}g.value?(d.value=o.value.offsetHeight,i.modelValue&&M()):(C(),p.value=h.value=0)},A=()=>{f.value=!1,M()},P=()=>{f.value=!0,u.value&&clearTimeout(u.value),C()},R=Ki((()=>i.hover&&i.modelValue&&g.value)),L=function(e,t,n,r){var i,a=!1,s=0;function o(){i&&clearTimeout(i)}function l(){for(var l=arguments.length,u=new Array(l),c=0;c<l;c++)u[c]=arguments[c];var d=this,h=Date.now()-s;function p(){s=Date.now(),n.apply(d,u)}a||(r&&!i&&p(),o(),void 0===r&&h>e?p():!0!==t&&(i=setTimeout(r?function(){i=void 0}:p,void 0===r?e-h:e)))}return"boolean"!=typeof t&&(r=n,n=t,t=void 0),l.cancel=function(){o(),a=!0},l}(30,(e=>{C();const t=w.value?w.value:15;e.deltaY<0&&T("down",t,!0),e.deltaY>0&&T("up",t,!0)})),k=()=>{C(),f.value=!1,E()};!function(e){const t=Fi();t&&Object.assign(t.proxy,e)}({Reset:()=>{k()}}),Mn((()=>i.list),(()=>{i.isWatch&&en((()=>{k()}))}),{deep:!0}),Mn((()=>i.modelValue),(e=>{e?A():P()})),Mn((()=>i.count),(e=>{0!==e&&A()})),qn((()=>{C(),clearTimeout(u.value)})),Kn((()=>{g.value&&E()}));const{default:D,html:I}=t,O=new Array(i.copyNum).fill(null),N=()=>Mi(li,null,[Mi("div",{ref:s,style:_.value},[D&&D()]),g.value?O.map((()=>Mi("div",{style:_.value},I&&"function"==typeof I?[I()]:[D&&D()]))):null]);return()=>Mi("div",{ref:a,class:r.class},[i.wheel&&i.hover?Mi("div",{ref:o,style:v.value,onMouseenter:()=>{R.value&&P()},onMouseleave:()=>{R.value&&A()},onWheel:e=>{R.value&&(e=>{L(e)})(e)}},[N()]):Mi("div",{ref:o,style:v.value,onMouseenter:()=>{R.value&&P()},onMouseleave:()=>{R.value&&A()}},[N()])])}});
/*! @license is-dom-node v1.0.4

	Copyright 2018 Fisssion LLC.

	Permission is hereby granted, free of charge, to any person obtaining a copy
	of this software and associated documentation files (the "Software"), to deal
	in the Software without restriction, including without limitation the rights
	to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
	copies of the Software, and to permit persons to whom the Software is
	furnished to do so, subject to the following conditions:

	The above copyright notice and this permission notice shall be included in all
	copies or substantial portions of the Software.

	THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
	IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
	FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
	AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
	LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
	OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
	SOFTWARE.

*/function S2(e){return"object"==typeof window.Node?e instanceof window.Node:null!==e&&"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName}
/*! @license is-dom-node-list v1.2.1

	Copyright 2018 Fisssion LLC.

	Permission is hereby granted, free of charge, to any person obtaining a copy
	of this software and associated documentation files (the "Software"), to deal
	in the Software without restriction, including without limitation the rights
	to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
	copies of the Software, and to permit persons to whom the Software is
	furnished to do so, subject to the following conditions:

	The above copyright notice and this permission notice shall be included in all
	copies or substantial portions of the Software.

	THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
	IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
	FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
	AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
	LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
	OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
	SOFTWARE.

*/
/*! @license Tealight v0.3.6

	Copyright 2018 Fisssion LLC.

	Permission is hereby granted, free of charge, to any person obtaining a copy
	of this software and associated documentation files (the "Software"), to deal
	in the Software without restriction, including without limitation the rights
	to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
	copies of the Software, and to permit persons to whom the Software is
	furnished to do so, subject to the following conditions:

	The above copyright notice and this permission notice shall be included in all
	copies or substantial portions of the Software.

	THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
	IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
	FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
	AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
	LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
	OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
	SOFTWARE.

*/
function C2(e,t){if(void 0===t&&(t=document),e instanceof Array)return e.filter(S2);if(S2(e))return[e];if(n=e,r=Object.prototype.toString.call(n),"object"==typeof window.NodeList?n instanceof window.NodeList:null!==n&&"object"==typeof n&&"number"==typeof n.length&&/^\[object (HTMLCollection|NodeList|Object)\]$/.test(r)&&(0===n.length||S2(n[0])))return Array.prototype.slice.call(e);var n,r;if("string"==typeof e)try{var i=t.querySelectorAll(e);return Array.prototype.slice.call(i)}catch(a){return[]}return[]}
/*! @license Rematrix v0.3.0

	Copyright 2018 Julian Lloyd.

	Permission is hereby granted, free of charge, to any person obtaining a copy
	of this software and associated documentation files (the "Software"), to deal
	in the Software without restriction, including without limitation the rights
	to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
	copies of the Software, and to permit persons to whom the Software is
	furnished to do so, subject to the following conditions:

	The above copyright notice and this permission notice shall be included in
	all copies or substantial portions of the Software.

	THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
	IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
	FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
	AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
	LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
	OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
	THE SOFTWARE.
*/function T2(e){if(e.constructor!==Array)throw new TypeError("Expected array.");if(16===e.length)return e;if(6===e.length){var t=M2();return t[0]=e[0],t[1]=e[1],t[4]=e[2],t[5]=e[3],t[12]=e[4],t[13]=e[5],t}throw new RangeError("Expected array with either 6 or 16 values.")}function M2(){for(var e=[],t=0;t<16;t++)t%5==0?e.push(1):e.push(0);return e}function E2(e,t){for(var n=T2(e),r=T2(t),i=[],a=0;a<4;a++)for(var s=[n[a],n[a+4],n[a+8],n[a+12]],o=0;o<4;o++){var l=4*o,u=[r[l],r[l+1],r[l+2],r[l+3]],c=s[0]*u[0]+s[1]*u[1]+s[2]*u[2]+s[3]*u[3];i[a+l]=c}return i}function A2(e){if("string"==typeof e){var t=e.match(/matrix(3d)?\(([^)]+)\)/);if(t)return T2(t[2].split(", ").map(parseFloat))}return M2()}function P2(e,t){var n=M2();return n[0]=e,n[5]="number"==typeof t?t:e,n}
/*! @license miniraf v1.0.0

	Copyright 2018 Fisssion LLC.

	Permission is hereby granted, free of charge, to any person obtaining a copy
	of this software and associated documentation files (the "Software"), to deal
	in the Software without restriction, including without limitation the rights
	to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
	copies of the Software, and to permit persons to whom the Software is
	furnished to do so, subject to the following conditions:

	The above copyright notice and this permission notice shall be included in all
	copies or substantial portions of the Software.

	THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
	IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
	FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
	AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
	LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
	OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
	SOFTWARE.

*/
var R2,L2=(R2=Date.now(),function(e){var t=Date.now();t-R2>16?(R2=t,e(t)):setTimeout((function(){return L2(e)}),0)}),k2=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||L2,D2={delay:0,distance:"0",duration:600,easing:"cubic-bezier(0.5, 0, 0, 1)",interval:0,opacity:0,origin:"bottom",rotate:{x:0,y:0,z:0},scale:1,cleanup:!1,container:document.documentElement,desktop:!0,mobile:!0,reset:!1,useDelay:"always",viewFactor:0,viewOffset:{top:0,right:0,bottom:0,left:0},afterReset:function(){},afterReveal:function(){},beforeReset:function(){},beforeReveal:function(){}};var I2={success:function(){document.documentElement.classList.add("sr"),document.body?document.body.style.height="100%":document.addEventListener("DOMContentLoaded",(function(){document.body.style.height="100%"}))},failure:function(){return document.documentElement.classList.remove("sr"),{clean:function(){},destroy:function(){},reveal:function(){},sync:function(){},get noop(){return!0}}}};function O2(e){return null!==e&&e instanceof Object&&(e.constructor===Object||"[object Object]"===Object.prototype.toString.call(e))}function N2(e,t){if(O2(e))return Object.keys(e).forEach((function(n){return t(e[n],n,e)}));if(e instanceof Array)return e.forEach((function(n,r){return t(n,r,e)}));throw new TypeError("Expected either an array or object literal.")}function B2(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];if(this.constructor.debug&&console){var r="%cScrollReveal: "+e;t.forEach((function(e){return r+="\n — "+e})),console.log(r,"color: #ea654b;")}}function U2(){var e=this,t={active:[],stale:[]},n={active:[],stale:[]},r={active:[],stale:[]};try{N2(C2("[data-sr-id]"),(function(e){var n=parseInt(e.getAttribute("data-sr-id"));t.active.push(n)}))}catch(zA){throw zA}N2(this.store.elements,(function(e){-1===t.active.indexOf(e.id)&&t.stale.push(e.id)})),N2(t.stale,(function(t){return delete e.store.elements[t]})),N2(this.store.elements,(function(e){-1===r.active.indexOf(e.containerId)&&r.active.push(e.containerId),e.hasOwnProperty("sequence")&&-1===n.active.indexOf(e.sequence.id)&&n.active.push(e.sequence.id)})),N2(this.store.containers,(function(e){-1===r.active.indexOf(e.id)&&r.stale.push(e.id)})),N2(r.stale,(function(t){var n=e.store.containers[t].node;n.removeEventListener("scroll",e.delegate),n.removeEventListener("resize",e.delegate),delete e.store.containers[t]})),N2(this.store.sequences,(function(e){-1===n.active.indexOf(e.id)&&n.stale.push(e.id)})),N2(n.stale,(function(t){return delete e.store.sequences[t]}))}var z2=function(){var e={},t=document.documentElement.style;function n(n,r){if(void 0===r&&(r=t),n&&"string"==typeof n){if(e[n])return e[n];if("string"==typeof r[n])return e[n]=n;if("string"==typeof r["-webkit-"+n])return e[n]="-webkit-"+n;throw new RangeError('Unable to find "'+n+'" style property.')}throw new TypeError("Expected a string.")}return n.clearCache=function(){return e={}},n}();function F2(e){var t=window.getComputedStyle(e.node),n=t.position,r=e.config,i={},a=(e.node.getAttribute("style")||"").match(/[\w-]+\s*:\s*[^;]+\s*/gi)||[];i.computed=a?a.map((function(e){return e.trim()})).join("; ")+";":"",i.generated=a.some((function(e){return e.match(/visibility\s?:\s?visible/i)}))?i.computed:a.concat(["visibility: visible"]).map((function(e){return e.trim()})).join("; ")+";";var s,o,l,u=parseFloat(t.opacity),c=isNaN(parseFloat(r.opacity))?parseFloat(t.opacity):parseFloat(r.opacity),d={computed:u!==c?"opacity: "+u+";":"",generated:u!==c?"opacity: "+c+";":""},h=[];if(parseFloat(r.distance)){var p="top"===r.origin||"bottom"===r.origin?"Y":"X",f=r.distance;"top"!==r.origin&&"left"!==r.origin||(f=/^-/.test(f)?f.substr(1):"-"+f);var m=f.match(/(^-?\d+\.?\d?)|(em$|px$|%$)/g),g=m[0];switch(m[1]){case"em":f=parseInt(t.fontSize)*g;break;case"px":f=g;break;case"%":f="Y"===p?e.node.getBoundingClientRect().height*g/100:e.node.getBoundingClientRect().width*g/100;break;default:throw new RangeError("Unrecognized or missing distance unit.")}"Y"===p?h.push(function(e){var t=M2();return t[13]=e,t}(f)):h.push(function(e){var t=M2();return t[12]=e,t}(f))}r.rotate.x&&h.push((s=r.rotate.x,o=Math.PI/180*s,(l=M2())[5]=l[10]=Math.cos(o),l[6]=l[9]=Math.sin(o),l[9]*=-1,l)),r.rotate.y&&h.push(function(e){var t=Math.PI/180*e,n=M2();return n[0]=n[10]=Math.cos(t),n[2]=n[8]=Math.sin(t),n[2]*=-1,n}(r.rotate.y)),r.rotate.z&&h.push(function(e){var t=Math.PI/180*e,n=M2();return n[0]=n[5]=Math.cos(t),n[1]=n[4]=Math.sin(t),n[4]*=-1,n}(r.rotate.z)),1!==r.scale&&(0===r.scale?h.push(P2(2e-4)):h.push(P2(r.scale)));var v={};if(h.length){v.property=z2("transform"),v.computed={raw:t[v.property],matrix:A2(t[v.property])},h.unshift(v.computed.matrix);var y=h.reduce(E2);v.generated={initial:v.property+": matrix3d("+y.join(", ")+");",final:v.property+": matrix3d("+v.computed.matrix.join(", ")+");"}}else v.generated={initial:"",final:""};var _={};if(d.generated||v.generated.initial){_.property=z2("transition"),_.computed=t[_.property],_.fragments=[];var b=r.delay,x=r.duration,w=r.easing;d.generated&&_.fragments.push({delayed:"opacity "+x/1e3+"s "+w+" "+b/1e3+"s",instant:"opacity "+x/1e3+"s "+w+" 0s"}),v.generated.initial&&_.fragments.push({delayed:v.property+" "+x/1e3+"s "+w+" "+b/1e3+"s",instant:v.property+" "+x/1e3+"s "+w+" 0s"}),_.computed&&!_.computed.match(/all 0s|none 0s/)&&_.fragments.unshift({delayed:_.computed,instant:_.computed});var S=_.fragments.reduce((function(e,t,n){return e.delayed+=0===n?t.delayed:", "+t.delayed,e.instant+=0===n?t.instant:", "+t.instant,e}),{delayed:"",instant:""});_.generated={delayed:_.property+": "+S.delayed+";",instant:_.property+": "+S.instant+";"}}else _.generated={delayed:"",instant:""};return{inline:i,opacity:d,position:n,transform:v,transition:_}}function V2(e,t){t.split(";").forEach((function(t){var n=t.split(":"),r=n[0],i=n.slice(1);r&&i&&(e.style[r.trim()]=i.join(":"))}))}function G2(e){var t,n=this;try{N2(C2(e),(function(e){var r=e.getAttribute("data-sr-id");if(null!==r){t=!0;var i=n.store.elements[r];i.callbackTimer&&window.clearTimeout(i.callbackTimer.clock),V2(i.node,i.styles.inline.generated),e.removeAttribute("data-sr-id"),delete n.store.elements[r]}}))}catch(zA){return B2.call(this,"Clean failed.",zA.message)}if(t)try{U2.call(this)}catch(zA){return B2.call(this,"Clean failed.",zA.message)}}function H2(){var e=this;N2(this.store.elements,(function(e){V2(e.node,e.styles.inline.generated),e.node.removeAttribute("data-sr-id")})),N2(this.store.containers,(function(t){var n=t.node===document.documentElement?window:t.node;n.removeEventListener("scroll",e.delegate),n.removeEventListener("resize",e.delegate)})),this.store={containers:{},elements:{},history:[],sequences:{}}}function j2(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];if(O2(e))return N2(t,(function(t){N2(t,(function(t,n){O2(t)?(e[n]&&O2(e[n])||(e[n]={}),j2(e[n],t)):e[n]=t}))})),e;throw new TypeError("Target must be an object literal.")}function W2(e){return void 0===e&&(e=navigator.userAgent),/Android|iPhone|iPad|iPod/i.test(e)}var Y2=function(){var e=0;return function(){return e++}}();function $2(){var e=this;U2.call(this),N2(this.store.elements,(function(e){var t=[e.styles.inline.generated];e.visible?(t.push(e.styles.opacity.computed),t.push(e.styles.transform.generated.final),e.revealed=!0):(t.push(e.styles.opacity.generated),t.push(e.styles.transform.generated.initial),e.revealed=!1),V2(e.node,t.filter((function(e){return""!==e})).join(" "))})),N2(this.store.containers,(function(t){var n=t.node===document.documentElement?window:t.node;n.addEventListener("scroll",e.delegate),n.addEventListener("resize",e.delegate)})),this.delegate(),this.initTimeout=null}function X2(e,t){void 0===t&&(t={});var n=t.pristine||this.pristine,r="always"===e.config.useDelay||"onload"===e.config.useDelay&&n||"once"===e.config.useDelay&&!e.seen,i=e.visible&&!e.revealed,a=!e.visible&&e.revealed&&e.config.reset;return t.reveal||i?q2.call(this,e,r):t.reset||a?K2.call(this,e):void 0}function q2(e,t){var n=[e.styles.inline.generated,e.styles.opacity.computed,e.styles.transform.generated.final];t?n.push(e.styles.transition.generated.delayed):n.push(e.styles.transition.generated.instant),e.revealed=e.seen=!0,V2(e.node,n.filter((function(e){return""!==e})).join(" ")),Z2.call(this,e,t)}function K2(e){var t=[e.styles.inline.generated,e.styles.opacity.generated,e.styles.transform.generated.initial,e.styles.transition.generated.instant];e.revealed=!1,V2(e.node,t.filter((function(e){return""!==e})).join(" ")),Z2.call(this,e)}function Z2(e,t){var n=this,r=t?e.config.duration+e.config.delay:e.config.duration,i=e.revealed?e.config.beforeReveal:e.config.beforeReset,a=e.revealed?e.config.afterReveal:e.config.afterReset,s=0;e.callbackTimer&&(s=Date.now()-e.callbackTimer.start,window.clearTimeout(e.callbackTimer.clock)),i(e.node),e.callbackTimer={start:Date.now(),clock:window.setTimeout((function(){a(e.node),e.callbackTimer=null,e.revealed&&!e.config.reset&&e.config.cleanup&&G2.call(n,e.node)}),r-s)}}function J2(e,t){if(void 0===t&&(t=this.pristine),!e.visible&&e.revealed&&e.config.reset)return X2.call(this,e,{reset:!0});var n=this.store.sequences[e.sequence.id],r=e.sequence.index;if(n){var i=new e3(n,"visible",this.store),a=new e3(n,"revealed",this.store);if(n.models={visible:i,revealed:a},!a.body.length){var s=n.members[i.body[0]],o=this.store.elements[s];if(o)return t3.call(this,n,i.body[0],-1,t),t3.call(this,n,i.body[0],1,t),X2.call(this,o,{reveal:!0,pristine:t})}if(!n.blocked.head&&r===[].concat(a.head).pop()&&r>=[].concat(i.body).shift())return t3.call(this,n,r,-1,t),X2.call(this,e,{reveal:!0,pristine:t});if(!n.blocked.foot&&r===[].concat(a.foot).shift()&&r<=[].concat(i.body).pop())return t3.call(this,n,r,1,t),X2.call(this,e,{reveal:!0,pristine:t})}}function Q2(e){var t=Math.abs(e);if(isNaN(t))throw new RangeError("Invalid sequence interval.");this.id=Y2(),this.interval=Math.max(t,16),this.members=[],this.models={},this.blocked={head:!1,foot:!1}}function e3(e,t,n){var r=this;this.head=[],this.body=[],this.foot=[],N2(e.members,(function(e,i){var a=n.elements[e];a&&a[t]&&r.body.push(i)})),this.body.length&&N2(e.members,(function(e,i){var a=n.elements[e];a&&!a[t]&&(i<r.body[0]?r.head.push(i):r.foot.push(i))}))}function t3(e,t,n,r){var i=this,a=["head",null,"foot"][1+n],s=e.members[t+n],o=this.store.elements[s];e.blocked[a]=!0,setTimeout((function(){e.blocked[a]=!1,o&&J2.call(i,o,r)}),e.interval)}function n3(e,t,n){var r=this;void 0===t&&(t={}),void 0===n&&(n=!1);var i,a=[],s=t.interval||D2.interval;try{s&&(i=new Q2(s));var o=C2(e);if(!o.length)throw new Error("Invalid reveal target.");var l=o.reduce((function(e,n){var s={},o=n.getAttribute("data-sr-id");o?(j2(s,r.store.elements[o]),V2(s.node,s.styles.inline.computed)):(s.id=Y2(),s.node=n,s.seen=!1,s.revealed=!1,s.visible=!1);var l=j2({},s.config||r.defaults,t);if(!l.mobile&&W2()||!l.desktop&&!W2())return o&&G2.call(r,s),e;var u,c=C2(l.container)[0];if(!c)throw new Error("Invalid container.");return c.contains(n)?(u=function(e){var t=[],n=arguments.length-1;for(;n-- >0;)t[n]=arguments[n+1];var r=null;return N2(t,(function(t){N2(t,(function(t){null===r&&t.node===e&&(r=t.id)}))})),r}(c,a,r.store.containers),null===u&&(u=Y2(),a.push({id:u,node:c})),s.config=l,s.containerId=u,s.styles=F2(s),i&&(s.sequence={id:i.id,index:i.members.length},i.members.push(s.id)),e.push(s),e):e}),[]);N2(l,(function(e){r.store.elements[e.id]=e,e.node.setAttribute("data-sr-id",e.id)}))}catch(zA){return B2.call(this,"Reveal failed.",zA.message)}N2(a,(function(e){r.store.containers[e.id]={id:e.id,node:e.node}})),i&&(this.store.sequences[i.id]=i),!0!==n&&(this.store.history.push({target:e,options:t}),this.initTimeout&&window.clearTimeout(this.initTimeout),this.initTimeout=window.setTimeout($2.bind(this),0))}function r3(){var e=this;N2(this.store.history,(function(t){n3.call(e,t.target,t.options,!0)})),$2.call(this)}var i3=Math.sign||function(e){return(e>0)-(e<0)||+e};function a3(e,t){var n=t?e.node.clientHeight:e.node.offsetHeight,r=t?e.node.clientWidth:e.node.offsetWidth,i=0,a=0,s=e.node;do{isNaN(s.offsetTop)||(i+=s.offsetTop),isNaN(s.offsetLeft)||(a+=s.offsetLeft),s=s.offsetParent}while(s);return{bounds:{top:i,right:a+r,bottom:i+n,left:a},height:n,width:r}}function s3(e){var t,n;return e.node===document.documentElement?(t=window.pageYOffset,n=window.pageXOffset):(t=e.node.scrollTop,n=e.node.scrollLeft),{top:t,left:n}}function o3(e){void 0===e&&(e={});var t=this.store.containers[e.containerId];if(t){var n=Math.max(0,Math.min(1,e.config.viewFactor)),r=e.config.viewOffset,i=e.geometry.bounds.top+e.geometry.height*n,a=e.geometry.bounds.right-e.geometry.width*n,s=e.geometry.bounds.bottom-e.geometry.height*n,o=e.geometry.bounds.left+e.geometry.width*n,l=t.geometry.bounds.top+t.scroll.top+r.top,u=t.geometry.bounds.right+t.scroll.left-r.right,c=t.geometry.bounds.bottom+t.scroll.top-r.bottom,d=t.geometry.bounds.left+t.scroll.left+r.left;return i<c&&a>d&&s>l&&o<u||"fixed"===e.styles.position}}function l3(e,t){var n=this;void 0===e&&(e={type:"init"}),void 0===t&&(t=this.store.elements),k2((function(){var r="init"===e.type||"resize"===e.type;N2(n.store.containers,(function(e){r&&(e.geometry=a3.call(n,e,!0));var t=s3.call(n,e);e.scroll&&(e.direction={x:i3(t.left-e.scroll.left),y:i3(t.top-e.scroll.top)}),e.scroll=t})),N2(t,(function(e){(r||void 0===e.geometry)&&(e.geometry=a3.call(n,e)),e.visible=o3.call(n,e)})),N2(t,(function(e){e.sequence?J2.call(n,e):X2.call(n,e)})),n.pristine=!1}))}var u3,c3,d3,h3,p3,f3,m3,g3;function v3(e){var t;if(void 0===e&&(e={}),void 0===this||Object.getPrototypeOf(this)!==v3.prototype)return new v3(e);if(!v3.isSupported())return B2.call(this,"Instantiation failed.","This browser is not supported."),I2.failure();try{t=j2({},f3||D2,e)}catch(zA){return B2.call(this,"Invalid configuration.",zA.message),I2.failure()}try{if(!C2(t.container)[0])throw new Error("Invalid container.")}catch(zA){return B2.call(this,zA.message),I2.failure()}return!(f3=t).mobile&&W2()||!f3.desktop&&!W2()?(B2.call(this,"This device is disabled.","desktop: "+f3.desktop,"mobile: "+f3.mobile),I2.failure()):(I2.success(),this.store={containers:{},elements:{},history:[],sequences:{}},this.pristine=!0,u3=u3||l3.bind(this),c3=c3||H2.bind(this),d3=d3||n3.bind(this),h3=h3||G2.bind(this),p3=p3||r3.bind(this),Object.defineProperty(this,"delegate",{get:function(){return u3}}),Object.defineProperty(this,"destroy",{get:function(){return c3}}),Object.defineProperty(this,"reveal",{get:function(){return d3}}),Object.defineProperty(this,"clean",{get:function(){return h3}}),Object.defineProperty(this,"sync",{get:function(){return p3}}),Object.defineProperty(this,"defaults",{get:function(){return f3}}),Object.defineProperty(this,"version",{get:function(){return"4.0.9"}}),Object.defineProperty(this,"noop",{get:function(){return!1}}),g3||(g3=this))}v3.isSupported=function(){return("transform"in(e=document.documentElement.style)||"WebkitTransform"in e)&&function(){var e=document.documentElement.style;return"transition"in e||"WebkitTransition"in e}();var e},Object.defineProperty(v3,"debug",{get:function(){return m3||!1},set:function(e){return m3="boolean"==typeof e?e:m3}}),v3();const y3=Fn({name:"App",components:{Vue3SeamlessScroll:w2},data(){let e=At(!1);const t=Sn(bW);Sn(xW);let n=At([{imgUrl:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/ui0.png"},{imgUrl:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/ui1.png"},{imgUrl:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/ui2.png"}]),r=At([{imgUrl:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/ui3.png",URL:"/#/createAndSaveGeojson"},{imgUrl:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/ui4.png",URL:"/#/linkedView"},{imgUrl:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/ui5.png",URL:"/#/leafletRoutingMachine"}]),i=At([{imgUrl:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/ui6.png",URL:"/#/leafletRoutingMachine"},{imgUrl:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/ui7.png",URL:"/#/leafletRoutingMachine"},{imgUrl:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/ui8.png",URL:"/#/leafletRoutingMachine"}]);return{imgList:n,logoList:At(["https://fastly.jsdelivr.net/gh/cjhayes16/oss/opengl.jpg","https://fastly.jsdelivr.net/gh/cjhayes16/oss/python.jpg","https://fastly.jsdelivr.net/gh/cjhayes16/oss/react.jpeg","https://fastly.jsdelivr.net/gh/cjhayes16/oss/sass.jpeg","https://fastly.jsdelivr.net/gh/cjhayes16/oss/tensorflow.jpg","https://fastly.jsdelivr.net/gh/cjhayes16/oss/typescript.jpeg","https://fastly.jsdelivr.net/gh/cjhayes16/oss/vue.jpeg","https://fastly.jsdelivr.net/gh/cjhayes16/oss/webgl.png","https://fastly.jsdelivr.net/gh/cjhayes16/oss/arcgis0.png","https://fastly.jsdelivr.net/gh/cjhayes16/oss/css3.jpeg","https://fastly.jsdelivr.net/gh/cjhayes16/oss/docker.png","https://fastly.jsdelivr.net/gh/cjhayes16/oss/electron.jpeg","https://fastly.jsdelivr.net/gh/cjhayes16/oss/flask.jpg","https://fastly.jsdelivr.net/gh/cjhayes16/oss/git.png","https://fastly.jsdelivr.net/gh/cjhayes16/oss/golang.png","https://fastly.jsdelivr.net/gh/cjhayes16/oss/h5.png","https://fastly.jsdelivr.net/gh/cjhayes16/oss/javascript.jpeg","https://fastly.jsdelivr.net/gh/cjhayes16/oss/k8s.jpeg","https://fastly.jsdelivr.net/gh/cjhayes16/oss/koa2.png","https://fastly.jsdelivr.net/gh/cjhayes16/oss/nginx.jpg","https://fastly.jsdelivr.net/gh/cjhayes16/oss/nodejs.jpg"]),noLoaded:function(e){PH.error(e)},naviTo:function(e,n){n?window.open(e,"_blank"):t.push({path:e})},imgList0:r,imgList1:i,isMask:e}},setup(){const e=pt({scrollReveal:v3()}),t=t=>{e.scrollReveal.reveal(t,{duration:600,delay:300*Math.random(),origin:"bottom",reset:!0,mobile:!0,distance:"10px",opacity:.001,easing:"cubic-bezier(0.5, 0, 0, 1)",scale:.9,beforeReveal:function(e){console.log(1)}})};Kn((()=>{!function(){let e;const t=new n1;console.log(t);const n=document.getElementById("threeDContainer");console.log(n);const r=new BJ({antialias:!0,alpha:!0});r.setPixelRatio(window.devicePixelRatio),r.setSize(n.offsetWidth,n.offsetHeight),n.append(r.domElement);const i=new UJ;i.background=null,r.setClearAlpha(0);const a=new Yq(60,n.offsetWidth/n.offsetHeight,1,1e4);a.position.set(7,7,7);var s=new J0("#fff");i.add(s);var o=new Z0(16777215,1.5);o.position.set(0,50,0),i.add(o);const l=new _2;l.setDecoderPath("jsm/libs/draco/gltf/");const u=new S1;function c(){requestAnimationFrame(c);const n=t.getDelta();e.update(n),r.render(i,a)}u.setDRACOLoader(l),u.load("/model/glb/earth.glb",(function(t){const n=t.scene;n.position.set(0,0,0),n.scale.set(1,1,1),i.add(n),a.lookAt(new I$(0,0,0)),e=new f1(n),e.clipAction(t.animations[0]).play(),c()}),void 0,(function(e){console.error(e)})),window.onresize=function(){a.aspect=n.offsetWidth/n.offsetHeight,a.updateProjectionMatrix(),r.setSize(n.offsetWidth,n.offsetHeight)}}(),console.log("ooooooooooooooooo"),t("#reveal1"),t("#reveal2"),t("#reveal3"),t("#reveal4"),t("#reveal5"),t("#reveal6");const e=Fi();setInterval((()=>{window.innerWidth<=1100?e.data.isMask=!0:e.data.isMask=!1}))}))}}),_3=""+new URL("bg-dcb2ec38.mp4",import.meta.url).href,b3={id:"jhayesGL",class:"w-full h-[calc(100%-58.6px)] bg-slate-600 bg-no-repeat bg-bgmain"},x3=[Ti("video",{src:_3,autoplay:"",muted:"",loop:""},null,-1),Ti("div",{class:"font-[youshe] text-[50px] text-white top-[35%] w-[50%] absolute left-[5vw]"}," 跨平台二维、三维可视化 ",-1),Ti("div",{class:"font-[youshe] text-white text-[30px] top-[55%] w-[40%] absolute left-[5vw]"}," 提升开发效率，为优化使用而设计，提供多种时空数据服务和数据加载，提供矢量数据标绘、图层标绘，多种场景环境特效，具有空间分析功能 ",-1),Ti("div",{id:"threeDContainer",class:"w-[40%] h-3/4 absolute top-[20vh] right-[5vw]"},null,-1)],w3={class:"bg-[#ebedf0] p-[5vw] w-full flex flex-wrap justify-center relative"},S3={id:"reveal1",class:"m-[1vw] mb-1 w-[58vw] h-[14vw] rounded-lg relative text-center"},C3=["src"],T3=[Ti("img",{src:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/ue50.png",class:"w-full h-full",alt:"",srcset:""},null,-1)],M3=[Ti("img",{src:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/project10.png",class:"w-full h-full",alt:"",srcset:""},null,-1)],E3={id:"reveal4",class:"m-[1vw] mb-1 w-[54vw] h-[14vw] rounded-lg relative text-center"},A3=["src"],P3={id:"reveal5",class:"m-[1vw] mb-1 w-[56vw] h-[14vw] rounded-lg relative text-center"},R3=["src"],L3=[Ti("img",{src:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/project1.png",class:"w-full h-full",alt:"",srcset:""},null,-1)],k3={class:"text-center bg-[#ebedf0] font-extrabold text-[2vw] text-[#1fb5ee]"},D3={class:"w-full pt-[3vh] pb-[10vh] bg-[#ebedf0]"},I3={class:"box1-wrapper"},O3={class:"box1"},N3={class:"img-list"},B3=["src"],U3={class:"img-list"},z3=["src"],F3={class:"box1-wrapper"},V3={class:"box1"},G3={class:"img-list"},H3=["src"],j3={class:"img-list"},W3=["src"],Y3={class:"box1-wrapper"},$3={class:"box1"},X3={class:"img-list"},q3=["src"],K3={class:"img-list"},Z3=["src"],J3={class:"p-10 footer bg-[#092e3d] text-neutral-content"},Q3=Ti("span",{class:"footer-title"},"资源项目",-1),e4=Ti("span",{class:"footer-title"},"联系方式",-1),t4={class:"fixed w-[100vw] h-[100%] bg-white z-[9999999999999] top-0 text-[#1fb5ee] font-extrabold text-[2rem] text-center"},n4=[Ti("p",null,"推荐电脑端用edge、chrome浏览器浏览",-1),Ti("p",null,"放大屏幕已达到最佳浏览效果",-1)];const r4=gs(y3,[["render",function(e,t,n,r,i,a){const s=ur("el-carousel-item"),o=ur("el-carousel");return fi(),yi(li,null,[ar(Ti("div",b3,x3,512),[[is,!e.isMask]]),ar(Ti("div",w3,[Ti("div",S3,[Mi(o,{interval:4e3,type:"card",height:"200px"},{default:vn((()=>[(fi(!0),yi(li,null,mr(e.imgList,(n=>(fi(),_i(s,{key:n,onClick:t[0]||(t[0]=t=>e.noLoaded("项目并上线,想浏览详情，请联系作者."))},{default:vn((()=>[Ti("img",{src:n.imgUrl,alt:"",srcset:""},null,8,C3)])),_:2},1024)))),128))])),_:1})]),Ti("div",{id:"reveal2",class:"m-[1vw] mb-1 w-[26vw] h-[14vw] rounded-lg relative text-center",onClick:t[1]||(t[1]=t=>e.naviTo("/JHAYESGPU",!1))},T3),Ti("div",{id:"reveal3",class:"m-[1vw] mb-1 w-[30vw] h-[14vw] rounded-lg relative text-center",onClick:t[2]||(t[2]=t=>e.naviTo("/#/test3d1","blank"))},M3),Ti("div",E3,[Mi(o,{interval:4e3,type:"card",height:"200px"},{default:vn((()=>[(fi(!0),yi(li,null,mr(e.imgList0,(t=>(fi(),_i(s,{key:t,onClick:n=>e.naviTo(t.URL,"blank")},{default:vn((()=>[Ti("img",{src:t.imgUrl,alt:"",srcset:""},null,8,A3)])),_:2},1032,["onClick"])))),128))])),_:1})]),Ti("div",P3,[Mi(o,{interval:4e3,type:"card",height:"200px"},{default:vn((()=>[(fi(!0),yi(li,null,mr(e.imgList1,(n=>(fi(),_i(s,{key:n,onClick:t[3]||(t[3]=t=>e.naviTo("/JHAYESLAB",!1))},{default:vn((()=>[Ti("img",{src:n.imgUrl,alt:"",srcset:""},null,8,R3)])),_:2},1024)))),128))])),_:1})]),Ti("div",{id:"reveal6",class:"m-[1vw] mb-1 w-[28vw] h-[14vw] rounded-lg relative text-center",onClick:t[4]||(t[4]=t=>e.naviTo("/#/test3d0","blank"))},L3)],512),[[is,!e.isMask]]),ar(Ti("div",k3," 涉及到的技术栈 ",512),[[is,!e.isMask]]),ar(Ti("div",D3,[Ti("div",I3,[Ti("div",O3,[Ti("div",N3,[(fi(!0),yi(li,null,mr(e.logoList.slice(0,7),(e=>(fi(),yi("li",{class:"img-item",key:e},[Ti("img",{class:"w-full h-full",src:e,alt:"",srcset:""},null,8,B3)])))),128))]),Ti("div",U3,[(fi(!0),yi(li,null,mr(e.logoList.slice(0,7),(e=>(fi(),yi("li",{class:"img-item",key:e},[Ti("img",{class:"w-full h-full",src:e,alt:"",srcset:""},null,8,z3)])))),128))])])]),Ti("div",F3,[Ti("div",V3,[Ti("div",G3,[(fi(!0),yi(li,null,mr(e.logoList.slice(7,14),(e=>(fi(),yi("li",{class:"img-item",key:e},[Ti("img",{class:"w-full h-full",src:e,alt:"",srcset:""},null,8,H3)])))),128))]),Ti("div",j3,[(fi(!0),yi(li,null,mr(e.logoList.slice(7,14),(e=>(fi(),yi("li",{class:"img-item",key:e},[Ti("img",{class:"w-full h-full",src:e,alt:"",srcset:""},null,8,W3)])))),128))])])]),Ti("div",Y3,[Ti("div",$3,[Ti("div",X3,[(fi(!0),yi(li,null,mr(e.logoList.slice(14,21),(e=>(fi(),yi("li",{class:"img-item",key:e},[Ti("img",{class:"w-full h-full",src:e,alt:"",srcset:""},null,8,q3)])))),128))]),Ti("div",K3,[(fi(!0),yi(li,null,mr(e.logoList.slice(14,21),(e=>(fi(),yi("li",{class:"img-item",key:e},[Ti("img",{class:"w-full h-full",src:e,alt:"",srcset:""},null,8,Z3)])))),128))])])])],512),[[is,!e.isMask]]),ar(Ti("footer",J3,[Ti("div",null,[Q3,Ti("a",{class:"link link-hover",onClick:t[5]||(t[5]=t=>e.naviTo("/JHAYESGL",!1))},"Jhayesgl"),Ti("a",{class:"link link-hover",onClick:t[6]||(t[6]=t=>e.naviTo("/JHAYES3D",!1))},"jhayes3d"),Ti("a",{class:"link link-hover",onClick:t[7]||(t[7]=t=>e.naviTo("/JHAYES2D",!1))},"Jhayes2d"),Ti("a",{class:"link link-hover",onClick:t[8]||(t[8]=t=>e.naviTo("/JHAYESGPU",!1))},"Jhayesgpu"),Ti("a",{class:"link link-hover",onClick:t[9]||(t[9]=t=>e.naviTo("/JHAYESLAB",!1))},"实验室")]),Ti("div",null,[e4,Ti("a",{class:"link link-hover",onClick:t[10]||(t[10]=t=>e.naviTo("https://www.jhayes.cn/about",!0))},"关于作者"),Ti("a",{class:"link link-hover",onClick:t[11]||(t[11]=t=>e.naviTo("https://www.jhayes.cn/",!0))},"博客"),Ti("a",{class:"link link-hover",onClick:t[12]||(t[12]=t=>e.naviTo("https://github.com/cjhayes16",!0))},"github")])],512),[[is,!e.isMask]]),ar(Ti("div",t4,n4,512),[[is,e.isMask]])],64)}]]);function i4(){return i4=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i4.apply(this,arguments)}var a4=function(e,t){return e.querySelector(t)},s4=function(e){void 0===e&&(e={});var t={};return Object.keys(e).forEach((function(n){void 0!==e[n]&&(t[n]=e[n])})),t};function o4(e){void 0===e&&(e={});var t,n,r,i,a,s,o,l,u,c,d,h=e,p=h.el,f=h.eventsEl,m={__atropos__:!0,params:i4({alwaysActive:!1,activeOffset:50,shadowOffset:50,shadowScale:1,duration:300,rotate:!0,rotateTouch:!0,rotateXMax:15,rotateYMax:15,rotateXInvert:!1,rotateYInvert:!1,stretchX:0,stretchY:0,stretchZ:0,commonOrigin:!0,shadow:!0,highlight:!0,onEnter:null,onLeave:null,onRotate:null},s4(e||{})),destroyed:!1,isActive:!1},g=m.params,v=[];!function e(){d=requestAnimationFrame((function(){v.forEach((function(e){if("function"==typeof e)e();else{var t=e.element,n=e.prop,r=e.value;t.style[n]=r}})),v.splice(0,v.length),e()}))}();var y,_=function(e,t){v.push({element:e,prop:"transitionDuration",value:t})},b=function(e,t){v.push({element:e,prop:"transitionTimingFunction",value:t})},x=function(e,t){v.push({element:e,prop:"transform",value:t})},w=function(e,t){v.push({element:e,prop:"opacity",value:t})},S=function(e,t,n,r){return e.addEventListener(t,n,r)},C=function(e,t,n,r){return e.removeEventListener(t,n,r)},T=function(e){var t=e.rotateXPercentage,n=void 0===t?0:t,r=e.rotateYPercentage,i=void 0===r?0:r,a=e.duration,s=e.opacityOnly,o=e.easeOut;(function(e,t){return e.querySelectorAll(t)})(p,"[data-atropos-offset], [data-atropos-opacity]").forEach((function(e){_(e,a),b(e,o?"ease-out":"");var t=function(e){if(e.dataset.atroposOpacity&&"string"==typeof e.dataset.atroposOpacity)return e.dataset.atroposOpacity.split(";").map((function(e){return parseFloat(e)}))}(e);if(0===n&&0===i)s||x(e,"translate3d(0, 0, 0)"),t&&w(e,t[0]);else{var r=parseFloat(e.dataset.atroposOffset)/100;if(Number.isNaN(r)||s||x(e,"translate3d("+-i*-r+"%, "+n*-r+"%, 0)"),t){var l=t[0],u=t[1],c=Math.max(Math.abs(n),Math.abs(i));w(e,l+(u-l)*c/100)}}}))},M=function(e,n){var r=p!==f;if(i||(i=p.getBoundingClientRect()),r&&!a&&(a=f.getBoundingClientRect()),void 0===e&&void 0===n){var s=r?a:i;e=s.left+s.width/2,n=s.top+s.height/2}var l,u=0,c=0,d=i,h=d.top,m=d.left,y=d.width,S=d.height;if(r){var C=a,M=C.top,E=C.left,A=C.width,P=C.height,R=y/2+(m-E),L=S/2+(h-M),k=e-E,D=n-M;c=g.rotateYMax*(k-R)/(A-y/2)*-1,u=g.rotateXMax*(D-L)/(P-S/2),l=e-m+"px "+(n-h)+"px"}else{var I=y/2,O=S/2,N=e-m,B=n-h;c=g.rotateYMax*(N-I)/(y/2)*-1,u=g.rotateXMax*(B-O)/(S/2)}u=Math.min(Math.max(-u,-g.rotateXMax),g.rotateXMax),g.rotateXInvert&&(u=-u),c=Math.min(Math.max(-c,-g.rotateYMax),g.rotateYMax),g.rotateYInvert&&(c=-c);var U,z,F=u/g.rotateXMax*100,V=c/g.rotateYMax*100,G=(r?V/100*g.stretchX:0)*(g.rotateYInvert?-1:1),H=(r?F/100*g.stretchY:0)*(g.rotateXInvert?-1:1),j=r?Math.max(Math.abs(F),Math.abs(V))/100*g.stretchZ:0;x(t,"translate3d("+G+"%, "+-H+"%, "+-j+"px) rotateX("+u+"deg) rotateY("+c+"deg)"),l&&g.commonOrigin&&(U=t,z=l,v.push({element:U,prop:"transformOrigin",value:z})),o&&(_(o,g.duration+"ms"),b(o,"ease-out"),x(o,"translate3d("+.25*-V+"%, "+.25*F+"%, 0)"),w(o,Math.max(Math.abs(F),Math.abs(V))/100)),T({rotateXPercentage:F,rotateYPercentage:V,duration:g.duration+"ms",easeOut:!0}),"function"==typeof g.onRotate&&g.onRotate(u,c)},E=function(){v.push((function(){return p.classList.add("atropos-active")})),_(t,g.duration+"ms"),b(t,"ease-out"),x(n,"translate3d(0,0, "+g.activeOffset+"px)"),_(n,g.duration+"ms"),b(n,"ease-out"),s&&(_(s,g.duration+"ms"),b(s,"ease-out")),m.isActive=!0},A=function(e){if(l=void 0,!("pointerdown"===e.type&&"mouse"===e.pointerType||"pointerenter"===e.type&&"mouse"!==e.pointerType)){if("pointerdown"===e.type&&e.preventDefault(),u=e.clientX,c=e.clientY,g.alwaysActive)return i=void 0,void(a=void 0);E(),"function"==typeof g.onEnter&&g.onEnter()}},P=function(e){!1===l&&e.cancelable&&e.preventDefault()},R=function(e){if(g.rotate&&m.isActive){if("mouse"!==e.pointerType){if(!g.rotateTouch)return;e.preventDefault()}var t=e.clientX,n=e.clientY,r=t-u,i=n-c;if("string"==typeof g.rotateTouch&&(0!==r||0!==i)&&void 0===l){if(r*r+i*i>=25){var a=180*Math.atan2(Math.abs(i),Math.abs(r))/Math.PI;l="scroll-y"===g.rotateTouch?a>45:90-a>45}!1===l&&(p.classList.add("atropos-rotate-touch"),e.cancelable&&e.preventDefault())}"mouse"!==e.pointerType&&l||M(t,n)}},L=function(e){if(i=void 0,a=void 0,m.isActive&&!(e&&"pointerup"===e.type&&"mouse"===e.pointerType||e&&"pointerleave"===e.type&&"mouse"!==e.pointerType)){if("string"==typeof g.rotateTouch&&l&&p.classList.remove("atropos-rotate-touch"),g.alwaysActive)return M(),"function"==typeof g.onRotate&&g.onRotate(0,0),void("function"==typeof g.onLeave&&g.onLeave());v.push((function(){return p.classList.remove("atropos-active")})),_(n,g.duration+"ms"),b(n,""),x(n,"translate3d(0,0, 0px)"),s&&(_(s,g.duration+"ms"),b(s,"")),o&&(_(o,g.duration+"ms"),b(o,""),x(o,"translate3d(0, 0, 0)"),w(o,0)),_(t,g.duration+"ms"),b(t,""),x(t,"translate3d(0,0,0) rotateX(0deg) rotateY(0deg)"),T({duration:g.duration+"ms"}),m.isActive=!1,"function"==typeof g.onRotate&&g.onRotate(0,0),"function"==typeof g.onLeave&&g.onLeave()}},k=function(e){var t=e.target;!f.contains(t)&&t!==f&&m.isActive&&L()};return m.destroy=function(){m.destroyed=!0,cancelAnimationFrame(d),C(document,"click",k),C(f,"pointerdown",A),C(f,"pointerenter",A),C(f,"pointermove",R),C(f,"touchmove",P),C(f,"pointerleave",L),C(f,"pointerup",L),C(f,"lostpointercapture",L),delete p.__atropos__},"string"==typeof p&&(p=a4(document,p)),p&&(p.__atropos__||(void 0!==f?"string"==typeof f&&(f=a4(document,f)):f=p,Object.assign(m,{el:p}),t=a4(p,".atropos-rotate"),n=a4(p,".atropos-scale"),r=a4(p,".atropos-inner"),p.__atropos__=m)),p&&f&&(g.shadow&&((s=a4(p,".atropos-shadow"))||((s=document.createElement("span")).classList.add("atropos-shadow"),y=!0),x(s,"translate3d(0,0,-"+g.shadowOffset+"px) scale("+g.shadowScale+")"),y&&t.appendChild(s)),g.highlight&&function(){var e;(o=a4(p,".atropos-highlight"))||((o=document.createElement("span")).classList.add("atropos-highlight"),e=!0),x(o,"translate3d(0,0,0)"),e&&r.appendChild(o)}(),g.rotateTouch&&("string"==typeof g.rotateTouch?p.classList.add("atropos-rotate-touch-"+g.rotateTouch):p.classList.add("atropos-rotate-touch")),a4(p,"[data-atropos-opacity]")&&T({opacityOnly:!0}),S(document,"click",k),S(f,"pointerdown",A),S(f,"pointerenter",A),S(f,"pointermove",R),S(f,"touchmove",P),S(f,"pointerleave",L),S(f,"pointerup",L),S(f,"lostpointercapture",L),g.alwaysActive&&(E(),M())),m}function l4(){return l4=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l4.apply(this,arguments)}var u4={props:{component:{type:String,default:"div"},innerClass:String,scaleClass:String,rotateClass:String,eventsEl:{type:[String,Object],default:void 0},alwaysActive:{type:Boolean,default:!1},activeOffset:{type:Number,default:void 0},shadowOffset:{type:Number,default:void 0},shadowScale:{type:Number,default:void 0},duration:{type:Number,default:void 0},rotate:{type:Boolean,default:void 0},rotateTouch:{type:Boolean,default:void 0},rotateXMax:{type:Number,default:void 0},rotateYMax:{type:Number,default:void 0},rotateXInvert:{type:Boolean,default:void 0},rotateYInvert:{type:Boolean,default:void 0},stretchX:{type:Number,default:void 0},stretchY:{type:Number,default:void 0},stretchZ:{type:Number,default:void 0},commonOrigin:{type:Boolean,default:!0},shadow:{type:Boolean,default:!0},highlight:{type:Boolean,default:!0}},emits:["enter","leave","rotate"],setup:function(e,t){var n=At(null),r=At(null),i=t.slots,a=t.emit;Kn((function(){r.value=o4(l4({el:n.value},e,{onEnter:function(){a("enter")},onLeave:function(){a("leave")},onRotate:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];a.apply(void 0,["rotate"].concat(t))}}))})),Qn((function(){r.value&&(r.value.destroy(),r.value=null)}));var s=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((function(e){return!!e})).join(" ")};return function(){return ea(e.component,{class:"atropos",ref:n},[ea("span",{class:s("atropos-scale",e.scaleClass)},[ea("span",{class:s("atropos-rotate",e.rotateClass)},[ea("span",{class:s("atropos-inner",e.innerClass)},[i.default&&i.default(),e.highlight&&ea("span",{class:"atropos-highlight"})]),i.rotate&&i.rotate(),e.shadow&&ea("span",{class:"atropos-shadow"})]),i.scale&&i.scale()]),i.root&&i.root()])}}};const c4={},d4=function(e,t,n){if(!t||0===t.length)return e();const r=document.getElementsByTagName("link");return Promise.all(t.map((e=>{if(e=function(e,t){return new URL(e,t).href}(e,n),e in c4)return;c4[e]=!0;const t=e.endsWith(".css"),i=t?'[rel="stylesheet"]':"";if(!!n)for(let n=r.length-1;n>=0;n--){const i=r[n];if(i.href===e&&(!t||"stylesheet"===i.rel))return}else if(document.querySelector(`link[href="${e}"]${i}`))return;const a=document.createElement("link");return a.rel=t?"stylesheet":"modulepreload",t||(a.as="script",a.crossOrigin=""),a.href=e,document.head.appendChild(a),t?new Promise(((t,n)=>{a.addEventListener("load",t),a.addEventListener("error",(()=>n(new Error(`Unable to preload CSS for ${e}`))))})):void 0}))).then((()=>e()))},h4=[{path:"/example2d0",name:"leaflet",component:"",meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/JHAYESGL.png"},children:[{path:"/singleMap",name:"singleMap",component:()=>d4((()=>import("./singleMap-c1a2b199.js")),["./singleMap-c1a2b199.js","./singleMap-357e3609.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/singleMap.png"}},{path:"/changingLocateZoomControl",name:"changingLocateZoomControl",component:()=>d4((()=>import("./changingLocateZoomControl-ff790b48.js")),["./changingLocateZoomControl-ff790b48.js","./changingLocateZoomControl-2e1bd987.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/singleMap.png"}},{path:"/addingOneMarker",name:"addingOneMarker",component:()=>d4((()=>import("./addingOneMarker-884bc7ef.js")),["./addingOneMarker-884bc7ef.js","./addingOneMarker-cd46e21a.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/addingOneMarker.png"}},{path:"/manyMarkers",name:"manyMarkers",component:()=>d4((()=>import("./manyMarkers-79880335.js")),["./manyMarkers-79880335.js","./manyMarkers-0f52a882.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/manyMarkers.png"}},{path:"/coordinatesAfterClickingOnTheMap",name:"coordinatesAfterClickingOnTheMap",component:()=>d4((()=>import("./coordinatesAfterClickingOnTheMap-f1e5224e.js")),["./coordinatesAfterClickingOnTheMap-f1e5224e.js","./coordinatesAfterClickingOnTheMap-3938bc2c.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/coordinatesAfterClickingOnTheMap.png"}},{path:"/coordinatesOfTheVisibleMap",name:"coordinatesOfTheVisibleMap",component:()=>d4((()=>import("./coordinatesOfTheVisibleMap-13854000.js")),["./coordinatesOfTheVisibleMap-13854000.js","./coordinatesOfTheVisibleMap-87cf760f.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/coordinatesOfTheVisibleMap.png"}},{path:"/imageInsteadOfMap",name:"imageInsteadOfMap",component:()=>d4((()=>import("./imageInsteadOfMap-e299a911.js")),["./imageInsteadOfMap-e299a911.js","./imageInsteadOfMap-1fec68de.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/imageInsteadOfMap.png"}},{path:"/controllingDifferentGroupsOfMarkers",name:"controllingDifferentGroupsOfMarkers",component:()=>d4((()=>import("./controllingDifferentGroupsOfMarkers-364d9f8e.js")),["./controllingDifferentGroupsOfMarkers-364d9f8e.js","./controllingDifferentGroupsOfMarkers-01ef6e8d.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/controllingDifferentGroupsOfMarkers.png"}},{path:"/markerGroupingMarkerclusterPlugin",name:"markerGroupingMarkerclusterPlugin",component:()=>d4((()=>import("./markerGroupingMarkerclusterPlugin-6b66375c.js")),["./markerGroupingMarkerclusterPlugin-6b66375c.js","./leaflet.markercluster-src-95f2329c.js","./leaflet-0069d45a.css","./markerGroupingMarkerclusterPlugin-8dfeb7ef.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/markerGroupingMarkerclusterPlugin.png"}},{path:"/matchingAllMarkersToTheMapView",name:"matchingAllMarkersToTheMapView",component:()=>d4((()=>import("./matchingAllMarkersToTheMapView-3006b865.js")),["./matchingAllMarkersToTheMapView-3006b865.js","./matchingAllMarkersToTheMapView-b1d9ac2c.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/matchingAllMarkersToTheMapView.png"}},{path:"/controllingTheMapFromOutsideTheMap",name:"controllingTheMapFromOutsideTheMap",component:()=>d4((()=>import("./controllingTheMapFromOutsideTheMap-a7fa484f.js")),["./controllingTheMapFromOutsideTheMap-a7fa484f.js","./controllingTheMapFromOutsideTheMap-40f1adf6.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/controllingTheMapFromOutsideTheMap.png"}},{path:"/controlingPolygons",name:"controlingPolygons",component:()=>d4((()=>import("./controlingPolygons-2e7c4c7c.js")),["./controlingPolygons-2e7c4c7c.js","./controlingPolygons-da0324d5.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/controlingPolygons.png"}},{path:"/svgMarkersWidthLegends",name:"svgMarkersWidthLegends",component:()=>d4((()=>import("./svgMarkersWidthLegends-afc27e30.js")),["./svgMarkersWidthLegends-afc27e30.js","./svgMarkersWidthLegends-ca4fd0a9.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/svgMarkersWidthLegends.png"}},{path:"/svgMarkersWidthLegends",name:"svgMarkersWidthLegends",component:()=>d4((()=>import("./svgMarkersWidthLegends-afc27e30.js")),["./svgMarkersWidthLegends-afc27e30.js","./svgMarkersWidthLegends-ca4fd0a9.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/svgMarkersWidthLegends.png"}},{path:"/dragableMarkers",name:"dragableMarkers",component:()=>d4((()=>import("./dragableMarkers-e0873c77.js")),["./dragableMarkers-e0873c77.js","./dragableMarkers-3c0cb36e.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/dragableMarkers.png"}},{path:"/geoJsonSimple",name:"geoJsonSimple",component:()=>d4((()=>import("./geoJsonSimple-bb17e6d0.js")),["./geoJsonSimple-bb17e6d0.js","./geoJsonSimple-04c76eb3.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/geoJsonSimple.png"}},{path:"/geoJsonExtendedAction",name:"geoJsonExtendedAction",component:()=>d4((()=>import("./geoJsonExtendedAction-6a3f9229.js")),["./geoJsonExtendedAction-6a3f9229.js","./geoJsonExtendedAction-2268151e.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/geoJsonExtendedAction.png"}},{path:"/tileLayer",name:"tileLayer",component:()=>d4((()=>import("./tileLayer-409c1a5a.js")),["./tileLayer-409c1a5a.js","./tileLayer-604e0bcc.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/tileLayer.png"}},{path:"/addDoveAndDeleteMarker",name:"addDoveAndDeleteMarker",component:()=>d4((()=>import("./addDoveAndDeleteMarker-e7e3f8db.js")),["./addDoveAndDeleteMarker-e7e3f8db.js","./addDoveAndDeleteMarker-29eb3873.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/addDoveAndDeleteMarker.png"}},{path:"/customButton",name:"customButton",component:()=>d4((()=>import("./customButton-b00a512f.js")),["./customButton-b00a512f.js","./customButton-1e6800b7.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/customButton.png"}},{path:"/maxBoundMapRestrictsTheView",name:"maxBoundMapRestrictsTheView",component:()=>d4((()=>import("./maxBoundMapRestrictsTheView-b0b8549b.js")),["./maxBoundMapRestrictsTheView-b0b8549b.js","./maxBoundMapRestrictsTheView-a8790f0e.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/maxBoundMapRestrictsTheView.png"}},{path:"/centerMapWhenClickMarker",name:"centerMapWhenClickMarker",component:()=>d4((()=>import("./centerMapWhenClickMarker-fe510b63.js")),["./centerMapWhenClickMarker-fe510b63.js","./centerMapWhenClickMarker-5300d58b.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/centerMapWhenClickMarker.png"}},{path:"/customMarkerAndPopup",name:"customMarkerAndPopup",component:()=>d4((()=>import("./customMarkerAndPopup-acb784fd.js")),["./customMarkerAndPopup-acb784fd.js","./customMarkerAndPopup-9ec8f4b5.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/customMarkerAndPopup.png"}},{path:"/polyline",name:"polyline",component:()=>d4((()=>import("./polyline-148c5317.js")),["./polyline-148c5317.js","./polyline-8737ce3f.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/polyline.png"}},{path:"/fitBoundsWithPadding",name:"fitBoundsWithPadding",component:()=>d4((()=>import("./fitBoundsWithPadding-3585d569.js")),["./fitBoundsWithPadding-3585d569.js","./fitBoundsWithPadding-cd47687b.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/fitBoundsWithPadding.png"}},{path:"/markers60K",name:"markers60K",component:()=>d4((()=>import("./markers60K-e1801821.js")),["./markers60K-e1801821.js","./leaflet.markercluster-src-95f2329c.js","./leaflet-0069d45a.css","./markers60K-47f4d5c6.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/markers60K.png"}},{path:"/fullscreen",name:"fullscreen",component:()=>d4((()=>import("./fullscreen-503cc98f.js")),["./fullscreen-503cc98f.js","./fullscreen-785452bc.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/fullscreen.png"}},{path:"/addingMapDescription",name:"addingMapDescription",component:()=>d4((()=>import("./addingMapDescription-8cbe91b4.js")),["./addingMapDescription-8cbe91b4.js","./addingMapDescription-67a844ce.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/addingMapDescription.png"}},{path:"/linkedView",name:"linkedView",component:()=>d4((()=>import("./linkedView-37114ebd.js")),["./linkedView-37114ebd.js","./linkedView-e47db159.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/linkedView.png"}},{path:"/miniMapPlugin",name:"miniMapPlugin",component:()=>d4((()=>import("./miniMapPlugin-599e7dfe.js")),["./miniMapPlugin-599e7dfe.js","./miniMapPlugin-405ac3ee.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/miniMapPlugin.png"}},{path:"/imageIconsPrevNext",name:"imageIconsPrevNext",component:()=>d4((()=>import("./imageIconsPrevNext-2f944632.js")),["./imageIconsPrevNext-2f944632.js","./imageIconsPrevNext-05ef41f3.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/imageIconsPrevNext.png"}},{path:"/multipleTileLayers",name:"multipleTileLayers",component:()=>d4((()=>import("./multipleTileLayers-06f35b22.js")),["./multipleTileLayers-06f35b22.js","./multipleTileLayers-3571180c.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/multipleTileLayers.png"}},{path:"/markerDraggableOnaClick",name:"markerDraggableOnaClick",component:()=>d4((()=>import("./markerDraggableOnaClick-53f2237e.js")),["./markerDraggableOnaClick-53f2237e.js","./markerDraggableOnaClick-fc1fe946.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/markerDraggableOnaClick.png"}},{path:"/enlargeAPolygon",name:"enlargeAPolygon",component:()=>d4((()=>import("./enlargeAPolygon-d7f415bd.js")),["./enlargeAPolygon-d7f415bd.js","./enlargeAPolygon-cceed299.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/enlargeAPolygon.png"}},{path:"/partOfTheCommon",name:"partOfTheCommon",component:()=>d4((()=>import("./partOfTheCommon-da56d04c.js")),["./partOfTheCommon-da56d04c.js","./partOfTheCommon-33c930cd.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/partOfTheCommon.png"}},{path:"/centerOfTheVisibleMap",name:"centerOfTheVisibleMap",component:()=>d4((()=>import("./centerOfTheVisibleMap-a577fa7c.js")),["./centerOfTheVisibleMap-a577fa7c.js","./centerOfTheVisibleMap-dc97cb71.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/centerOfTheVisibleMap.png"}},{path:"/backToHomeButton",name:"backToHomeButton",component:()=>d4((()=>import("./backToHomeButton-11466b4b.js")),["./backToHomeButton-11466b4b.js","./backToHomeButton-951e2d0e.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/backToHomeButton.png"}},{path:"/scale",name:"scale",component:()=>d4((()=>import("./scale-0bda619f.js")),["./scale-0bda619f.js","./scale-8d4091c9.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/scale.png"}},{path:"/imageOnMap",name:"imageOnMap",component:()=>d4((()=>import("./imageOnMap-059de900.js")),["./imageOnMap-059de900.js","./imageOnMap-d5e491b6.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/imageOnMap.png"}},{path:"/markerIsInViewport",name:"markerIsInViewport",component:()=>d4((()=>import("./markerIsInViewport-84874d80.js")),["./markerIsInViewport-84874d80.js","./markerIsInViewport-5b78850f.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/markerIsInViewport.png"}},{path:"/markerInMapBounds",name:"markerInMapBounds",component:()=>d4((()=>import("./markerInMapBounds-3068e37a.js")),["./markerInMapBounds-3068e37a.js","./markerInMapBounds-a046e6ad.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/markerInMapBounds.png"}},{path:"/tilesGray",name:"tilesGray",component:()=>d4((()=>import("./tilesGray-4e9e8164.js")),["./tilesGray-4e9e8164.js","./tilesGray-a1d5577e.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/tilesGray.png"}},{path:"/tabsInPopup",name:"tabsInPopup",component:()=>d4((()=>import("./tabsInPopup-1a0bc794.js")),["./tabsInPopup-1a0bc794.js","./tabsInPopup-14df8aa6.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/tabsInPopup.png"}},{path:"/createAndSaveGeojson",name:"createAndSaveGeojson",component:()=>d4((()=>import("./createAndSaveGeojson-f9d97e23.js")),["./createAndSaveGeojson-f9d97e23.js","./createAndSaveGeojson-f8a5727e.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/createAndSaveGeojson.png"}},{path:"/contextMenu",name:"contextMenu",component:()=>d4((()=>import("./contextMenu-1dce5124.js")),["./contextMenu-1dce5124.js","./contextMenu-dc9d2276.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/contextMenu.png"}},{path:"/followMouse",name:"followMouse",component:()=>d4((()=>import("./followMouse-1de4c994.js")),["./followMouse-1de4c994.js","./followMouse-4b0b40f8.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/followMouse.png"}},{path:"/controlLayersOutsideTheMap",name:"controlLayersOutsideTheMap",component:()=>d4((()=>import("./controlLayersOutsideTheMap-19f1cf8c.js")),["./controlLayersOutsideTheMap-19f1cf8c.js","./controlLayersOutsideTheMap-268f98b9.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/controlLayersOutsideTheMap.png"}},{path:"/sidebarReplacingPopup",name:"sidebarReplacingPopup",component:()=>d4((()=>import("./sidebarReplacingPopup-49101009.js")),["./sidebarReplacingPopup-49101009.js","./sidebarReplacingPopup-a22029a7.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/sidebarReplacingPopup.png"}},{path:"/greatCircle",name:"greatCircle",component:()=>d4((()=>import("./greatCircle-9bbd68d6.js")),["./greatCircle-9bbd68d6.js","./greatCircle-00cbbbbf.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/greatCircle.png"}},{path:"/bindMorePopupsToTheSameMarker",name:"bindMorePopupsToTheSameMarker",component:()=>d4((()=>import("./bindMorePopupsToTheSameMarker-99a0fc39.js")),["./bindMorePopupsToTheSameMarker-99a0fc39.js","./bindMorePopupsToTheSameMarker-edc0b054.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/bindMorePopupsToTheSameMarker.png"}},{path:"/countMarkers",name:"countMarkers",component:()=>d4((()=>import("./countMarkers-1356f5a4.js")),["./countMarkers-1356f5a4.js","./countMarkers-af0f708f.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/countMarkers.png"}},{path:"/leafletRoutingMachine",name:"leafletRoutingMachine",component:()=>d4((()=>import("./leafletRoutingMachine-9a24d15a.js")),["./leafletRoutingMachine-9a24d15a.js","./leafletRoutingMachine-9d2e1214.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/leafletRoutingMachine.png"}},{path:"/markerSlideTo",name:"markerSlideTo",component:()=>d4((()=>import("./markerSlideTo-330fd679.js")),["./markerSlideTo-330fd679.js","./markerSlideTo-b6d73bc0.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/markerSlideTo.png"}},{path:"/addDataAttributeToTheMarker",name:"addDataAttributeToTheMarker",component:()=>d4((()=>import("./addDataAttributeToTheMarker-9ca055a6.js")),["./addDataAttributeToTheMarker-9ca055a6.js","./addDataAttributeToTheMarker-4652d960.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/addDataAttributeToTheMarker.png"}},{path:"/popupInaFixedPosition",name:"popupInaFixedPosition",component:()=>d4((()=>import("./popupInaFixedPosition-de89405c.js")),["./popupInaFixedPosition-de89405c.js","./popupInaFixedPosition-c72ef6fe.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/popupInaFixedPosition.png"}},{path:"/simpleAnimationOfJumpingMarker",name:"simpleAnimationOfJumpingMarker",component:()=>d4((()=>import("./simpleAnimationOfJumpingMarker-3df6c568.js")),["./simpleAnimationOfJumpingMarker-3df6c568.js","./simpleAnimationOfJumpingMarker-b4122cf0.css"],import.meta.url),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/simpleAnimationOfJumpingMarker.png"}}]}],p4={components:{Atropos:u4},data:()=>({route3d:h4}),mounted(){console.log(h4)}},f4={class:"p-[2vw]"},m4=Ti("div",{style:{height:"100%",width:"100%","background-color":"var(--el-bg-color-overlay)","box-shadow":"var(--el-box-shadow-lighter)","text-align":"center","line-height":"40px",color:"#1989fa"}}," UP ",-1),g4=["id"],v4=["href"],y4=["src"],_4={class:"absolute w-full h-[40px] bottom-0 z-100 bg-[#00000050] text-center leading-[40px] text-[20px] text-[#ffffff] justify-center"};const b4=gs(p4,[["render",function(e,t,n,r,i,a){const s=ur("el-backtop"),o=ur("atropos");return fi(),yi("div",f4,[Mi(s,{bottom:100},{default:vn((()=>[m4])),_:1}),(fi(!0),yi(li,null,mr(i.route3d,((e,t)=>(fi(),yi("div",{key:t,class:"flex flex-wrap w-full"},[Ti("div",{id:e.name,class:"w-full text-[1.5vw] font-bold"},f(e.name),9,g4),(fi(!0),yi(li,null,mr(e.children,((e,t)=>(fi(),yi("div",{key:t,class:"m-3"},[Ti("a",{href:"/#"+e.path,target:"_blank"},[Mi(o,{class:"my-atropos"},{default:vn((()=>[Ti("img",{class:"absolute w-full h-full z-1",src:e.meta.img,alt:""},null,8,y4),Ti("div",_4,f(e.name),1)])),_:2},1024)],8,v4)])))),128))])))),128))])}]]),x4={id:"myiframe",src:"https://paveldogreat.github.io/WebGL-Fluid-Simulation/",frameborder:"0"},w4=gs(Fn({__name:"index",setup:e=>(At(!0),Kn((()=>{})),(e,t)=>(fi(),yi("iframe",x4)))}),[["__scopeId","data-v-e761d78d"]]),S4={type:"change"},C4={type:"start"},T4={type:"end"};class M4 extends $Y{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new I$,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:OW,MIDDLE:NW,RIGHT:BW},this.touches={ONE:UW,TWO:FW},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return s.phi},this.getAzimuthalAngle=function(){return s.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(e){e.addEventListener("keydown",G),this._domElementKeyEvents=e},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",G),this._domElementKeyEvents=null},this.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(S4),n.update(),i=r.NONE},this.update=function(){const t=new I$,d=(new D$).setFromUnitVectors(e.up,new I$(0,1,0)),h=d.clone().invert(),p=new I$,f=new D$,m=new I$,g=2*Math.PI;return function(){const e=n.object.position;t.copy(e).sub(n.target),t.applyQuaternion(d),s.setFromVector3(t),n.autoRotate&&i===r.NONE&&S(2*Math.PI/60/60*n.autoRotateSpeed),n.enableDamping?(s.theta+=o.theta*n.dampingFactor,s.phi+=o.phi*n.dampingFactor):(s.theta+=o.theta,s.phi+=o.phi);let v=n.minAzimuthAngle,y=n.maxAzimuthAngle;return isFinite(v)&&isFinite(y)&&(v<-Math.PI?v+=g:v>Math.PI&&(v-=g),y<-Math.PI?y+=g:y>Math.PI&&(y-=g),s.theta=v<=y?Math.max(v,Math.min(y,s.theta)):s.theta>(v+y)/2?Math.max(v,s.theta):Math.min(y,s.theta)),s.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,s.phi)),s.makeSafe(),s.radius*=l,s.radius=Math.max(n.minDistance,Math.min(n.maxDistance,s.radius)),!0===n.enableDamping?n.target.addScaledVector(u,n.dampingFactor):n.target.add(u),t.setFromSpherical(s),t.applyQuaternion(h),e.copy(n.target).add(t),n.object.lookAt(n.target),!0===n.enableDamping?(o.theta*=1-n.dampingFactor,o.phi*=1-n.dampingFactor,u.multiplyScalar(1-n.dampingFactor)):(o.set(0,0,0),u.set(0,0,0)),l=1,!!(c||p.distanceToSquared(n.object.position)>a||8*(1-f.dot(n.object.quaternion))>a||m.distanceToSquared(n.target)>0)&&(n.dispatchEvent(S4),p.copy(n.object.position),f.copy(n.object.quaternion),m.copy(n.target),c=!1,!0)}}(),this.dispose=function(){n.domElement.removeEventListener("contextmenu",H),n.domElement.removeEventListener("pointerdown",U),n.domElement.removeEventListener("pointercancel",F),n.domElement.removeEventListener("wheel",V),n.domElement.removeEventListener("pointermove",z),n.domElement.removeEventListener("pointerup",F),null!==n._domElementKeyEvents&&(n._domElementKeyEvents.removeEventListener("keydown",G),n._domElementKeyEvents=null)};const n=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let i=r.NONE;const a=1e-6,s=new _1,o=new _1;let l=1;const u=new I$;let c=!1;const d=new l$,h=new l$,p=new l$,f=new l$,m=new l$,g=new l$,v=new l$,y=new l$,_=new l$,b=[],x={};function w(){return Math.pow(.95,n.zoomSpeed)}function S(e){o.theta-=e}function C(e){o.phi-=e}const T=function(){const e=new I$;return function(t,n){e.setFromMatrixColumn(n,0),e.multiplyScalar(-t),u.add(e)}}(),M=function(){const e=new I$;return function(t,r){!0===n.screenSpacePanning?e.setFromMatrixColumn(r,1):(e.setFromMatrixColumn(r,0),e.crossVectors(n.object.up,e)),e.multiplyScalar(t),u.add(e)}}(),E=function(){const e=new I$;return function(t,r){const i=n.domElement;if(n.object.isPerspectiveCamera){const a=n.object.position;e.copy(a).sub(n.target);let s=e.length();s*=Math.tan(n.object.fov/2*Math.PI/180),T(2*t*s/i.clientHeight,n.object.matrix),M(2*r*s/i.clientHeight,n.object.matrix)}else n.object.isOrthographicCamera?(T(t*(n.object.right-n.object.left)/n.object.zoom/i.clientWidth,n.object.matrix),M(r*(n.object.top-n.object.bottom)/n.object.zoom/i.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}}();function A(e){n.object.isPerspectiveCamera?l/=e:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*e)),n.object.updateProjectionMatrix(),c=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function P(e){n.object.isPerspectiveCamera?l*=e:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/e)),n.object.updateProjectionMatrix(),c=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function R(e){d.set(e.clientX,e.clientY)}function L(e){f.set(e.clientX,e.clientY)}function k(){if(1===b.length)d.set(b[0].pageX,b[0].pageY);else{const e=.5*(b[0].pageX+b[1].pageX),t=.5*(b[0].pageY+b[1].pageY);d.set(e,t)}}function D(){if(1===b.length)f.set(b[0].pageX,b[0].pageY);else{const e=.5*(b[0].pageX+b[1].pageX),t=.5*(b[0].pageY+b[1].pageY);f.set(e,t)}}function I(){const e=b[0].pageX-b[1].pageX,t=b[0].pageY-b[1].pageY,n=Math.sqrt(e*e+t*t);v.set(0,n)}function O(e){if(1==b.length)h.set(e.pageX,e.pageY);else{const t=W(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);h.set(n,r)}p.subVectors(h,d).multiplyScalar(n.rotateSpeed);const t=n.domElement;S(2*Math.PI*p.x/t.clientHeight),C(2*Math.PI*p.y/t.clientHeight),d.copy(h)}function N(e){if(1===b.length)m.set(e.pageX,e.pageY);else{const t=W(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);m.set(n,r)}g.subVectors(m,f).multiplyScalar(n.panSpeed),E(g.x,g.y),f.copy(m)}function B(e){const t=W(e),r=e.pageX-t.x,i=e.pageY-t.y,a=Math.sqrt(r*r+i*i);y.set(0,a),_.set(0,Math.pow(y.y/v.y,n.zoomSpeed)),A(_.y),v.copy(y)}function U(e){!1!==n.enabled&&(0===b.length&&(n.domElement.setPointerCapture(e.pointerId),n.domElement.addEventListener("pointermove",z),n.domElement.addEventListener("pointerup",F)),function(e){b.push(e)}(e),"touch"===e.pointerType?function(e){switch(j(e),b.length){case 1:switch(n.touches.ONE){case UW:if(!1===n.enableRotate)return;k(),i=r.TOUCH_ROTATE;break;case zW:if(!1===n.enablePan)return;D(),i=r.TOUCH_PAN;break;default:i=r.NONE}break;case 2:switch(n.touches.TWO){case FW:if(!1===n.enableZoom&&!1===n.enablePan)return;n.enableZoom&&I(),n.enablePan&&D(),i=r.TOUCH_DOLLY_PAN;break;case VW:if(!1===n.enableZoom&&!1===n.enableRotate)return;n.enableZoom&&I(),n.enableRotate&&k(),i=r.TOUCH_DOLLY_ROTATE;break;default:i=r.NONE}break;default:i=r.NONE}i!==r.NONE&&n.dispatchEvent(C4)}(e):function(e){let t;switch(e.button){case 0:t=n.mouseButtons.LEFT;break;case 1:t=n.mouseButtons.MIDDLE;break;case 2:t=n.mouseButtons.RIGHT;break;default:t=-1}switch(t){case NW:if(!1===n.enableZoom)return;!function(e){v.set(e.clientX,e.clientY)}(e),i=r.DOLLY;break;case OW:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===n.enablePan)return;L(e),i=r.PAN}else{if(!1===n.enableRotate)return;R(e),i=r.ROTATE}break;case BW:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===n.enableRotate)return;R(e),i=r.ROTATE}else{if(!1===n.enablePan)return;L(e),i=r.PAN}break;default:i=r.NONE}i!==r.NONE&&n.dispatchEvent(C4)}(e))}function z(e){!1!==n.enabled&&("touch"===e.pointerType?function(e){switch(j(e),i){case r.TOUCH_ROTATE:if(!1===n.enableRotate)return;O(e),n.update();break;case r.TOUCH_PAN:if(!1===n.enablePan)return;N(e),n.update();break;case r.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;!function(e){n.enableZoom&&B(e),n.enablePan&&N(e)}(e),n.update();break;case r.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;!function(e){n.enableZoom&&B(e),n.enableRotate&&O(e)}(e),n.update();break;default:i=r.NONE}}(e):function(e){switch(i){case r.ROTATE:if(!1===n.enableRotate)return;!function(e){h.set(e.clientX,e.clientY),p.subVectors(h,d).multiplyScalar(n.rotateSpeed);const t=n.domElement;S(2*Math.PI*p.x/t.clientHeight),C(2*Math.PI*p.y/t.clientHeight),d.copy(h),n.update()}(e);break;case r.DOLLY:if(!1===n.enableZoom)return;!function(e){y.set(e.clientX,e.clientY),_.subVectors(y,v),_.y>0?A(w()):_.y<0&&P(w()),v.copy(y),n.update()}(e);break;case r.PAN:if(!1===n.enablePan)return;!function(e){m.set(e.clientX,e.clientY),g.subVectors(m,f).multiplyScalar(n.panSpeed),E(g.x,g.y),f.copy(m),n.update()}(e)}}(e))}function F(e){!function(e){delete x[e.pointerId];for(let t=0;t<b.length;t++)if(b[t].pointerId==e.pointerId)return void b.splice(t,1)}(e),0===b.length&&(n.domElement.releasePointerCapture(e.pointerId),n.domElement.removeEventListener("pointermove",z),n.domElement.removeEventListener("pointerup",F)),n.dispatchEvent(T4),i=r.NONE}function V(e){!1!==n.enabled&&!1!==n.enableZoom&&i===r.NONE&&(e.preventDefault(),n.dispatchEvent(C4),function(e){e.deltaY<0?P(w()):e.deltaY>0&&A(w()),n.update()}(e),n.dispatchEvent(T4))}function G(e){!1!==n.enabled&&!1!==n.enablePan&&function(e){let t=!1;switch(e.code){case n.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?C(2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):E(0,n.keyPanSpeed),t=!0;break;case n.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?C(-2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):E(0,-n.keyPanSpeed),t=!0;break;case n.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?S(2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):E(n.keyPanSpeed,0),t=!0;break;case n.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?S(-2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):E(-n.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),n.update())}(e)}function H(e){!1!==n.enabled&&e.preventDefault()}function j(e){let t=x[e.pointerId];void 0===t&&(t=new l$,x[e.pointerId]=t),t.set(e.pageX,e.pageY)}function W(e){const t=e.pointerId===b[0].pointerId?b[1]:b[0];return x[t.pointerId]}n.domElement.addEventListener("contextmenu",H),n.domElement.addEventListener("pointerdown",U),n.domElement.addEventListener("pointercancel",F),n.domElement.addEventListener("wheel",V,{passive:!1}),this.update()}}class E4 extends OX{constructor(e=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new l$(.5,.5),this.addEventListener("removed",(function(){this.traverse((function(e){e.element instanceof Element&&null!==e.element.parentNode&&e.element.parentNode.removeChild(e.element)}))}))}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this.center=e.center,this}}const A4=new I$,P4=new cX,R4=new cX,L4=new I$,k4=new I$;class D4{constructor(e={}){const t=this;let n,r,i,a;const s={objects:new WeakMap},o=void 0!==e.element?e.element:document.createElement("div");function l(e,n,r){if(e.isCSS2DObject){A4.setFromMatrixPosition(e.matrixWorld),A4.applyMatrix4(R4);const l=!0===e.visible&&A4.z>=-1&&A4.z<=1&&!0===e.layers.test(r.layers);if(e.element.style.display=!0===l?"":"none",!0===l){e.onBeforeRender(t,n,r);const s=e.element;s.style.transform="translate("+-100*e.center.x+"%,"+-100*e.center.y+"%)translate("+(A4.x*i+i)+"px,"+(-A4.y*a+a)+"px)",s.parentNode!==o&&o.appendChild(s),e.onAfterRender(t,n,r)}const c={distanceToCameraSquared:u(r,e)};s.objects.set(e,c)}for(let t=0,i=e.children.length;t<i;t++)l(e.children[t],n,r)}function u(e,t){return L4.setFromMatrixPosition(e.matrixWorld),k4.setFromMatrixPosition(t.matrixWorld),L4.distanceToSquared(k4)}o.style.overflow="hidden",this.domElement=o,this.getSize=function(){return{width:n,height:r}},this.render=function(e,t){!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),P4.copy(t.matrixWorldInverse),R4.multiplyMatrices(t.projectionMatrix,P4),l(e,e,t),function(e){const t=function(e){const t=[];return e.traverse((function(e){e.isCSS2DObject&&t.push(e)})),t}(e).sort((function(e,t){if(e.renderOrder!==t.renderOrder)return t.renderOrder-e.renderOrder;return s.objects.get(e).distanceToCameraSquared-s.objects.get(t).distanceToCameraSquared})),n=t.length;for(let r=0,i=t.length;r<i;r++)t[r].element.style.zIndex=n-r}(e)},this.setSize=function(e,t){n=e,r=t,i=n/2,a=r/2,o.style.width=e+"px",o.style.height=t+"px"}}}class I4{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const O4=new vK(-1,1,1,-1,0,1),N4=new _q;N4.setAttribute("position",new dq([-1,3,0,-1,-1,0,3,-1,0],3)),N4.setAttribute("uv",new dq([0,2,0,0,2,0],2));class B4{constructor(e){this._mesh=new Bq(N4,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,O4)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class U4 extends I4{constructor(e,t,n,r,i){super(),this.scene=e,this.camera=t,this.overrideMaterial=n,this.clearColor=r,this.clearAlpha=void 0!==i?i:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new eq}render(e,t,n){const r=e.autoClear;let i,a;e.autoClear=!1,void 0!==this.overrideMaterial&&(a=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(e.getClearColor(this._oldClearColor),i=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:n),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(this._oldClearColor,i),void 0!==this.overrideMaterial&&(this.scene.overrideMaterial=a),e.autoClear=r}}const z4={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tgl_FragColor = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor.a *= opacity;\n\n\n\t\t}"},F4={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new eq(0)},defaultOpacity:{value:0}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform vec3 defaultColor;\n\t\tuniform float defaultOpacity;\n\t\tuniform float luminosityThreshold;\n\t\tuniform float smoothWidth;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\n\t\t\tvec3 luma = vec3( 0.299, 0.587, 0.114 );\n\n\t\t\tfloat v = dot( texel.xyz, luma );\n\n\t\t\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );\n\n\t\t\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );\n\n\t\t\tgl_FragColor = mix( outputColor, texel, alpha );\n\n\t\t}"};class V4 extends I4{constructor(e,t,n,r){super(),this.strength=void 0!==t?t:1,this.radius=n,this.threshold=r,this.resolution=void 0!==e?new l$(e.x,e.y):new l$(256,256),this.clearColor=new eq(0,0,0),this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let i=Math.round(this.resolution.x/2),a=Math.round(this.resolution.y/2);this.renderTargetBright=new R$(i,a,{type:_Y}),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let u=0;u<this.nMips;u++){const e=new R$(i,a,{type:_Y});e.texture.name="UnrealBloomPass.h"+u,e.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(e);const t=new R$(i,a,{type:_Y});t.texture.name="UnrealBloomPass.v"+u,t.texture.generateMipmaps=!1,this.renderTargetsVertical.push(t),i=Math.round(i/2),a=Math.round(a/2)}const s=F4;this.highPassUniforms=Hq.clone(s.uniforms),this.highPassUniforms.luminosityThreshold.value=r,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new jq({uniforms:this.highPassUniforms,vertexShader:s.vertexShader,fragmentShader:s.fragmentShader,defines:{}}),this.separableBlurMaterials=[];const o=[3,5,7,9,11];i=Math.round(this.resolution.x/2),a=Math.round(this.resolution.y/2);for(let u=0;u<this.nMips;u++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(o[u])),this.separableBlurMaterials[u].uniforms.texSize.value=new l$(i,a),i=Math.round(i/2),a=Math.round(a/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=t,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0;this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.bloomTintColors=[new I$(1,1,1),new I$(1,1,1),new I$(1,1,1),new I$(1,1,1),new I$(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors;const l=z4;this.copyUniforms=Hq.clone(l.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new jq({uniforms:this.copyUniforms,vertexShader:l.vertexShader,fragmentShader:l.fragmentShader,blending:2,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new eq,this.oldClearAlpha=1,this.basic=new nq,this.fsQuad=new B4(null)}dispose(){for(let e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(let e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose();for(let e=0;e<this.separableBlurMaterials.length;e++)this.separableBlurMaterials[e].dispose();this.compositeMaterial.dispose(),this.materialCopy.dispose(),this.basic.dispose(),this.fsQuad.dispose()}setSize(e,t){let n=Math.round(e/2),r=Math.round(t/2);this.renderTargetBright.setSize(n,r);for(let i=0;i<this.nMips;i++)this.renderTargetsHorizontal[i].setSize(n,r),this.renderTargetsVertical[i].setSize(n,r),this.separableBlurMaterials[i].uniforms.texSize.value=new l$(n,r),n=Math.round(n/2),r=Math.round(r/2)}render(e,t,n,r,i){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const a=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),i&&e.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=n.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=n.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this.fsQuad.render(e);let s=this.renderTargetBright;for(let o=0;o<this.nMips;o++)this.fsQuad.material=this.separableBlurMaterials[o],this.separableBlurMaterials[o].uniforms.colorTexture.value=s.texture,this.separableBlurMaterials[o].uniforms.direction.value=V4.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[o]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[o].uniforms.colorTexture.value=this.renderTargetsHorizontal[o].texture,this.separableBlurMaterials[o].uniforms.direction.value=V4.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[o]),e.clear(),this.fsQuad.render(e),s=this.renderTargetsVertical[o];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,i&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(n),this.fsQuad.render(e)),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=a}getSeperableBlurMaterial(e){return new jq({defines:{KERNEL_RADIUS:e,SIGMA:e},uniforms:{colorTexture:{value:null},texSize:{value:new l$(.5,.5)},direction:{value:new l$(.5,.5)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\n\t\t\t\tuniform vec2 direction;\n\n\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\n\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\n\t\t\t\t}\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\t\tfloat fSigma = float(SIGMA);\n\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\n\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\n\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\n\t\t\t\t\t\tfloat x = float(i);\n\t\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\n\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\n\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\n\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\n\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\n\t\t\t\t\t\tweightSum += 2.0 * w;\n\t\t\t\t\t}\n\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t\t}"})}getCompositeMaterial(e){return new jq({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\t\t\t\tuniform sampler2D blurTexture1;\n\t\t\t\tuniform sampler2D blurTexture2;\n\t\t\t\tuniform sampler2D blurTexture3;\n\t\t\t\tuniform sampler2D blurTexture4;\n\t\t\t\tuniform sampler2D blurTexture5;\n\t\t\t\tuniform float bloomStrength;\n\t\t\t\tuniform float bloomRadius;\n\t\t\t\tuniform float bloomFactors[NUM_MIPS];\n\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\n\n\t\t\t\tfloat lerpBloomFactor(const in float factor) {\n\t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\n\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\n\t\t\t\t}"})}}V4.BlurDirectionX=new l$(1,0),V4.BlurDirectionY=new l$(0,1);class G4 extends I4{constructor(e,t){super(),this.textureID=void 0!==t?t:"tDiffuse",e instanceof jq?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=Hq.clone(e.uniforms),this.material=new jq({name:void 0!==e.name?e.name:"unspecified",defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new B4(this.material)}render(e,t,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class H4 extends I4{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,n){const r=e.getContext(),i=e.state;let a,s;i.buffers.color.setMask(!1),i.buffers.depth.setMask(!1),i.buffers.color.setLocked(!0),i.buffers.depth.setLocked(!0),this.inverse?(a=0,s=1):(a=1,s=0),i.buffers.stencil.setTest(!0),i.buffers.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),i.buffers.stencil.setFunc(r.ALWAYS,a,4294967295),i.buffers.stencil.setClear(s),i.buffers.stencil.setLocked(!0),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),i.buffers.color.setLocked(!1),i.buffers.depth.setLocked(!1),i.buffers.stencil.setLocked(!1),i.buffers.stencil.setFunc(r.EQUAL,1,4294967295),i.buffers.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),i.buffers.stencil.setLocked(!0)}}class j4 extends I4{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class W4{constructor(e,t){if(this.renderer=e,this._pixelRatio=e.getPixelRatio(),void 0===t){const n=e.getSize(new l$);this._width=n.width,this._height=n.height,(t=new R$(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:_Y})).texture.name="EffectComposer.rt1"}else this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new G4(z4),this.clock=new n1}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);-1!==t&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){void 0===e&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let n=!1;for(let r=0,i=this.passes.length;r<i;r++){const t=this.passes[r];if(!1!==t.enabled){if(t.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(r),t.render(this.renderer,this.writeBuffer,this.readBuffer,e,n),t.needsSwap){if(n){const t=this.renderer.getContext(),n=this.renderer.state.buffers.stencil;n.setFunc(t.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),n.setFunc(t.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==H4&&(t instanceof H4?n=!0:t instanceof j4&&(n=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(void 0===e){const t=this.renderer.getSize(new l$);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const n=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(n,r),this.renderTarget2.setSize(n,r);for(let i=0;i<this.passes.length;i++)this.passes[i].setSize(n,r)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class Y4 extends I4{constructor(e,t,n,r){super(),this.renderScene=t,this.renderCamera=n,this.selectedObjects=void 0!==r?r:[],this.visibleEdgeColor=new eq(1,1,1),this.hiddenEdgeColor=new eq(.1,.04,.02),this.edgeGlow=0,this.usePatternTexture=!1,this.edgeThickness=1,this.edgeStrength=3,this.downSampleRatio=2,this.pulsePeriod=0,this._visibilityCache=new Map,this.resolution=void 0!==e?new l$(e.x,e.y):new l$(256,256);const i=Math.round(this.resolution.x/this.downSampleRatio),a=Math.round(this.resolution.y/this.downSampleRatio);this.renderTargetMaskBuffer=new R$(this.resolution.x,this.resolution.y),this.renderTargetMaskBuffer.texture.name="OutlinePass.mask",this.renderTargetMaskBuffer.texture.generateMipmaps=!1,this.depthMaterial=new wJ,this.depthMaterial.side=2,this.depthMaterial.depthPacking=3201,this.depthMaterial.blending=0,this.prepareMaskMaterial=this.getPrepareMaskMaterial(),this.prepareMaskMaterial.side=2,this.prepareMaskMaterial.fragmentShader=function(e,t){const n=t.isPerspectiveCamera?"perspective":"orthographic";return e.replace(/DEPTH_TO_VIEW_Z/g,n+"DepthToViewZ")}(this.prepareMaskMaterial.fragmentShader,this.renderCamera),this.renderTargetDepthBuffer=new R$(this.resolution.x,this.resolution.y,{type:_Y}),this.renderTargetDepthBuffer.texture.name="OutlinePass.depth",this.renderTargetDepthBuffer.texture.generateMipmaps=!1,this.renderTargetMaskDownSampleBuffer=new R$(i,a,{type:_Y}),this.renderTargetMaskDownSampleBuffer.texture.name="OutlinePass.depthDownSample",this.renderTargetMaskDownSampleBuffer.texture.generateMipmaps=!1,this.renderTargetBlurBuffer1=new R$(i,a,{type:_Y}),this.renderTargetBlurBuffer1.texture.name="OutlinePass.blur1",this.renderTargetBlurBuffer1.texture.generateMipmaps=!1,this.renderTargetBlurBuffer2=new R$(Math.round(i/2),Math.round(a/2),{type:_Y}),this.renderTargetBlurBuffer2.texture.name="OutlinePass.blur2",this.renderTargetBlurBuffer2.texture.generateMipmaps=!1,this.edgeDetectionMaterial=this.getEdgeDetectionMaterial(),this.renderTargetEdgeBuffer1=new R$(i,a,{type:_Y}),this.renderTargetEdgeBuffer1.texture.name="OutlinePass.edge1",this.renderTargetEdgeBuffer1.texture.generateMipmaps=!1,this.renderTargetEdgeBuffer2=new R$(Math.round(i/2),Math.round(a/2),{type:_Y}),this.renderTargetEdgeBuffer2.texture.name="OutlinePass.edge2",this.renderTargetEdgeBuffer2.texture.generateMipmaps=!1;this.separableBlurMaterial1=this.getSeperableBlurMaterial(4),this.separableBlurMaterial1.uniforms.texSize.value.set(i,a),this.separableBlurMaterial1.uniforms.kernelRadius.value=1,this.separableBlurMaterial2=this.getSeperableBlurMaterial(4),this.separableBlurMaterial2.uniforms.texSize.value.set(Math.round(i/2),Math.round(a/2)),this.separableBlurMaterial2.uniforms.kernelRadius.value=4,this.overlayMaterial=this.getOverlayMaterial();const s=z4;this.copyUniforms=Hq.clone(s.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new jq({uniforms:this.copyUniforms,vertexShader:s.vertexShader,fragmentShader:s.fragmentShader,blending:0,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new eq,this.oldClearAlpha=1,this.fsQuad=new B4(null),this.tempPulseColor1=new eq,this.tempPulseColor2=new eq,this.textureMatrix=new cX}dispose(){this.renderTargetMaskBuffer.dispose(),this.renderTargetDepthBuffer.dispose(),this.renderTargetMaskDownSampleBuffer.dispose(),this.renderTargetBlurBuffer1.dispose(),this.renderTargetBlurBuffer2.dispose(),this.renderTargetEdgeBuffer1.dispose(),this.renderTargetEdgeBuffer2.dispose(),this.depthMaterial.dispose(),this.prepareMaskMaterial.dispose(),this.edgeDetectionMaterial.dispose(),this.separableBlurMaterial1.dispose(),this.separableBlurMaterial2.dispose(),this.overlayMaterial.dispose(),this.materialCopy.dispose(),this.fsQuad.dispose()}setSize(e,t){this.renderTargetMaskBuffer.setSize(e,t),this.renderTargetDepthBuffer.setSize(e,t);let n=Math.round(e/this.downSampleRatio),r=Math.round(t/this.downSampleRatio);this.renderTargetMaskDownSampleBuffer.setSize(n,r),this.renderTargetBlurBuffer1.setSize(n,r),this.renderTargetEdgeBuffer1.setSize(n,r),this.separableBlurMaterial1.uniforms.texSize.value.set(n,r),n=Math.round(n/2),r=Math.round(r/2),this.renderTargetBlurBuffer2.setSize(n,r),this.renderTargetEdgeBuffer2.setSize(n,r),this.separableBlurMaterial2.uniforms.texSize.value.set(n,r)}changeVisibilityOfSelectedObjects(e){const t=this._visibilityCache;function n(n){n.isMesh&&(!0===e?n.visible=t.get(n):(t.set(n,n.visible),n.visible=e))}for(let r=0;r<this.selectedObjects.length;r++){this.selectedObjects[r].traverse(n)}}changeVisibilityOfNonSelectedObjects(e){const t=this._visibilityCache,n=[];function r(e){e.isMesh&&n.push(e)}for(let i=0;i<this.selectedObjects.length;i++){this.selectedObjects[i].traverse(r)}this.renderScene.traverse((function(r){if(r.isMesh||r.isSprite){let i=!1;for(let e=0;e<n.length;e++){if(n[e].id===r.id){i=!0;break}}if(!1===i){const n=r.visible;!1!==e&&!0!==t.get(r)||(r.visible=e),t.set(r,n)}}else(r.isPoints||r.isLine)&&(!0===e?r.visible=t.get(r):(t.set(r,r.visible),r.visible=e))}))}updateTextureMatrix(){this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.renderCamera.projectionMatrix),this.textureMatrix.multiply(this.renderCamera.matrixWorldInverse)}render(e,t,n,r,i){if(this.selectedObjects.length>0){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const t=e.autoClear;e.autoClear=!1,i&&e.state.buffers.stencil.setTest(!1),e.setClearColor(16777215,1),this.changeVisibilityOfSelectedObjects(!1);const r=this.renderScene.background;if(this.renderScene.background=null,this.renderScene.overrideMaterial=this.depthMaterial,e.setRenderTarget(this.renderTargetDepthBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.changeVisibilityOfSelectedObjects(!0),this._visibilityCache.clear(),this.updateTextureMatrix(),this.changeVisibilityOfNonSelectedObjects(!1),this.renderScene.overrideMaterial=this.prepareMaskMaterial,this.prepareMaskMaterial.uniforms.cameraNearFar.value.set(this.renderCamera.near,this.renderCamera.far),this.prepareMaskMaterial.uniforms.depthTexture.value=this.renderTargetDepthBuffer.texture,this.prepareMaskMaterial.uniforms.textureMatrix.value=this.textureMatrix,e.setRenderTarget(this.renderTargetMaskBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.renderScene.overrideMaterial=null,this.changeVisibilityOfNonSelectedObjects(!0),this._visibilityCache.clear(),this.renderScene.background=r,this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetMaskBuffer.texture,e.setRenderTarget(this.renderTargetMaskDownSampleBuffer),e.clear(),this.fsQuad.render(e),this.tempPulseColor1.copy(this.visibleEdgeColor),this.tempPulseColor2.copy(this.hiddenEdgeColor),this.pulsePeriod>0){const e=.625+.75*Math.cos(.01*performance.now()/this.pulsePeriod)/2;this.tempPulseColor1.multiplyScalar(e),this.tempPulseColor2.multiplyScalar(e)}this.fsQuad.material=this.edgeDetectionMaterial,this.edgeDetectionMaterial.uniforms.maskTexture.value=this.renderTargetMaskDownSampleBuffer.texture,this.edgeDetectionMaterial.uniforms.texSize.value.set(this.renderTargetMaskDownSampleBuffer.width,this.renderTargetMaskDownSampleBuffer.height),this.edgeDetectionMaterial.uniforms.visibleEdgeColor.value=this.tempPulseColor1,this.edgeDetectionMaterial.uniforms.hiddenEdgeColor.value=this.tempPulseColor2,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial1,this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=Y4.BlurDirectionX,this.separableBlurMaterial1.uniforms.kernelRadius.value=this.edgeThickness,e.setRenderTarget(this.renderTargetBlurBuffer1),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetBlurBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=Y4.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial2,this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial2.uniforms.direction.value=Y4.BlurDirectionX,e.setRenderTarget(this.renderTargetBlurBuffer2),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetBlurBuffer2.texture,this.separableBlurMaterial2.uniforms.direction.value=Y4.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer2),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.overlayMaterial,this.overlayMaterial.uniforms.maskTexture.value=this.renderTargetMaskBuffer.texture,this.overlayMaterial.uniforms.edgeTexture1.value=this.renderTargetEdgeBuffer1.texture,this.overlayMaterial.uniforms.edgeTexture2.value=this.renderTargetEdgeBuffer2.texture,this.overlayMaterial.uniforms.patternTexture.value=this.patternTexture,this.overlayMaterial.uniforms.edgeStrength.value=this.edgeStrength,this.overlayMaterial.uniforms.edgeGlow.value=this.edgeGlow,this.overlayMaterial.uniforms.usePatternTexture.value=this.usePatternTexture,i&&e.state.buffers.stencil.setTest(!0),e.setRenderTarget(n),this.fsQuad.render(e),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=t}this.renderToScreen&&(this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=n.texture,e.setRenderTarget(null),this.fsQuad.render(e))}getPrepareMaskMaterial(){return new jq({uniforms:{depthTexture:{value:null},cameraNearFar:{value:new l$(.5,.5)},textureMatrix:{value:null}},vertexShader:"#include <morphtarget_pars_vertex>\n\t\t\t\t#include <skinning_pars_vertex>\n\n\t\t\t\tvarying vec4 projTexCoord;\n\t\t\t\tvarying vec4 vPosition;\n\t\t\t\tuniform mat4 textureMatrix;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\t#include <skinbase_vertex>\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <morphtarget_vertex>\n\t\t\t\t\t#include <skinning_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t\tvPosition = mvPosition;\n\n\t\t\t\t\tvec4 worldPosition = vec4( transformed, 1.0 );\n\n\t\t\t\t\t#ifdef USE_INSTANCING\n\n\t\t\t\t\t\tworldPosition = instanceMatrix * worldPosition;\n\n\t\t\t\t\t#endif\n\t\t\t\t\t\n\t\t\t\t\tworldPosition = modelMatrix * worldPosition;\n\n\t\t\t\t\tprojTexCoord = textureMatrix * worldPosition;\n\n\t\t\t\t}",fragmentShader:"#include <packing>\n\t\t\t\tvarying vec4 vPosition;\n\t\t\t\tvarying vec4 projTexCoord;\n\t\t\t\tuniform sampler2D depthTexture;\n\t\t\t\tuniform vec2 cameraNearFar;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tfloat depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));\n\t\t\t\t\tfloat viewZ = - DEPTH_TO_VIEW_Z( depth, cameraNearFar.x, cameraNearFar.y );\n\t\t\t\t\tfloat depthTest = (-vPosition.z > viewZ) ? 1.0 : 0.0;\n\t\t\t\t\tgl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);\n\n\t\t\t\t}"})}getEdgeDetectionMaterial(){return new jq({uniforms:{maskTexture:{value:null},texSize:{value:new l$(.5,.5)},visibleEdgeColor:{value:new I$(1,1,1)},hiddenEdgeColor:{value:new I$(1,1,1)}},vertexShader:"varying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\n\t\t\t\tuniform sampler2D maskTexture;\n\t\t\t\tuniform vec2 texSize;\n\t\t\t\tuniform vec3 visibleEdgeColor;\n\t\t\t\tuniform vec3 hiddenEdgeColor;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\t\tvec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);\n\t\t\t\t\tvec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);\n\t\t\t\t\tvec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);\n\t\t\t\t\tvec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);\n\t\t\t\t\tvec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);\n\t\t\t\t\tfloat diff1 = (c1.r - c2.r)*0.5;\n\t\t\t\t\tfloat diff2 = (c3.r - c4.r)*0.5;\n\t\t\t\t\tfloat d = length( vec2(diff1, diff2) );\n\t\t\t\t\tfloat a1 = min(c1.g, c2.g);\n\t\t\t\t\tfloat a2 = min(c3.g, c4.g);\n\t\t\t\t\tfloat visibilityFactor = min(a1, a2);\n\t\t\t\t\tvec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;\n\t\t\t\t\tgl_FragColor = vec4(edgeColor, 1.0) * vec4(d);\n\t\t\t\t}"})}getSeperableBlurMaterial(e){return new jq({defines:{MAX_RADIUS:e},uniforms:{colorTexture:{value:null},texSize:{value:new l$(.5,.5)},direction:{value:new l$(.5,.5)},kernelRadius:{value:1}},vertexShader:"varying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\n\t\t\t\tuniform vec2 direction;\n\t\t\t\tuniform float kernelRadius;\n\n\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\n\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\t\tfloat sigma = kernelRadius/2.0;\n\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, sigma);\n\t\t\t\t\tvec4 diffuseSum = texture2D( colorTexture, vUv) * weightSum;\n\t\t\t\t\tvec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);\n\t\t\t\t\tvec2 uvOffset = delta;\n\t\t\t\t\tfor( int i = 1; i <= MAX_RADIUS; i ++ ) {\n\t\t\t\t\t\tfloat x = kernelRadius * float(i) / float(MAX_RADIUS);\n\t\t\t\t\t\tfloat w = gaussianPdf(x, sigma);\n\t\t\t\t\t\tvec4 sample1 = texture2D( colorTexture, vUv + uvOffset);\n\t\t\t\t\t\tvec4 sample2 = texture2D( colorTexture, vUv - uvOffset);\n\t\t\t\t\t\tdiffuseSum += ((sample1 + sample2) * w);\n\t\t\t\t\t\tweightSum += (2.0 * w);\n\t\t\t\t\t\tuvOffset += delta;\n\t\t\t\t\t}\n\t\t\t\t\tgl_FragColor = diffuseSum/weightSum;\n\t\t\t\t}"})}getOverlayMaterial(){return new jq({uniforms:{maskTexture:{value:null},edgeTexture1:{value:null},edgeTexture2:{value:null},patternTexture:{value:null},edgeStrength:{value:1},edgeGlow:{value:1},usePatternTexture:{value:0}},vertexShader:"varying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\n\t\t\t\tuniform sampler2D maskTexture;\n\t\t\t\tuniform sampler2D edgeTexture1;\n\t\t\t\tuniform sampler2D edgeTexture2;\n\t\t\t\tuniform sampler2D patternTexture;\n\t\t\t\tuniform float edgeStrength;\n\t\t\t\tuniform float edgeGlow;\n\t\t\t\tuniform bool usePatternTexture;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec4 edgeValue1 = texture2D(edgeTexture1, vUv);\n\t\t\t\t\tvec4 edgeValue2 = texture2D(edgeTexture2, vUv);\n\t\t\t\t\tvec4 maskColor = texture2D(maskTexture, vUv);\n\t\t\t\t\tvec4 patternColor = texture2D(patternTexture, 6.0 * vUv);\n\t\t\t\t\tfloat visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;\n\t\t\t\t\tvec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;\n\t\t\t\t\tvec4 finalColor = edgeStrength * maskColor.r * edgeValue;\n\t\t\t\t\tif(usePatternTexture)\n\t\t\t\t\t\tfinalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);\n\t\t\t\t\tgl_FragColor = finalColor;\n\t\t\t\t}",blending:2,depthTest:!1,depthWrite:!1,transparent:!0})}}Y4.BlurDirectionX=new l$(1,0),Y4.BlurDirectionY=new l$(0,1);const $4={uniforms:{tDiffuse:{value:null},toneMappingExposure:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\t#include <tonemapping_pars_fragment>\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tgl_FragColor = texture2D( tDiffuse, vUv );\n\n\t\t\t// tone mapping\n\n\t\t\t#ifdef LINEAR_TONE_MAPPING\n\n\t\t\t\tgl_FragColor.rgb = LinearToneMapping( gl_FragColor.rgb );\n\n\t\t\t#elif defined( REINHARD_TONE_MAPPING )\n\n\t\t\t\tgl_FragColor.rgb = ReinhardToneMapping( gl_FragColor.rgb );\n\n\t\t\t#elif defined( CINEON_TONE_MAPPING )\n\n\t\t\t\tgl_FragColor.rgb = OptimizedCineonToneMapping( gl_FragColor.rgb );\n\n\t\t\t#elif defined( ACES_FILMIC_TONE_MAPPING )\n\n\t\t\t\tgl_FragColor.rgb = ACESFilmicToneMapping( gl_FragColor.rgb );\n\n\t\t\t#endif\n\n\t\t\t// color space\n\n\t\t\tgl_FragColor = LinearTosRGB( gl_FragColor );\n\n\t\t}"};class X4 extends I4{constructor(e=ZW,t=1){super(),this.toneMapping=e,this.toneMappingExposure=t;const n=$4;this.uniforms=Hq.clone(n.uniforms),this.material=new jq({uniforms:this.uniforms,vertexShader:n.vertexShader,fragmentShader:n.fragmentShader}),e===JW?this.material.defines.LINEAR_TONE_MAPPING="":e===QW?this.material.defines.REINHARD_TONE_MAPPING="":e===eY?this.material.defines.CINEON_TONE_MAPPING="":e===tY&&(this.material.defines.ACES_FILMIC_TONE_MAPPING=""),this.fsQuad=new B4(this.material)}render(e,t,n){this.uniforms.tDiffuse.value=n.texture,this.uniforms.toneMappingExposure.value=this.toneMappingExposure,!0===this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class q4 extends N0{constructor(e){super(e),this.type=_Y}parse(e){const t=function(e,t){switch(e){case 1:console.error("THREE.RGBELoader Read Error: "+(t||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(t||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(t||""));break;default:console.error("THREE.RGBELoader: Error: "+(t||""))}return-1},n=function(e,t,n){t=t||1024;let r=e.pos,i=-1,a=0,s="",o=String.fromCharCode.apply(null,new Uint16Array(e.subarray(r,r+128)));for(;0>(i=o.indexOf("\n"))&&a<t&&r<e.byteLength;)s+=o,a+=o.length,r+=128,o+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(r,r+128)));return-1<i&&(!1!==n&&(e.pos+=a+i+1),s+o.slice(0,i))},r=function(e,t,n,r){const i=e[t+3],a=Math.pow(2,i-128)/255;n[r+0]=e[t+0]*a,n[r+1]=e[t+1]*a,n[r+2]=e[t+2]*a,n[r+3]=1},i=function(e,t,n,r){const i=e[t+3],a=Math.pow(2,i-128)/255;n[r+0]=aq.toHalfFloat(Math.min(e[t+0]*a,65504)),n[r+1]=aq.toHalfFloat(Math.min(e[t+1]*a,65504)),n[r+2]=aq.toHalfFloat(Math.min(e[t+2]*a,65504)),n[r+3]=aq.toHalfFloat(1)},a=new Uint8Array(e);a.pos=0;const s=function(e){const r=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,i=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,a=/^\s*FORMAT=(\S+)\s*$/,s=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,o={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let l,u;if(e.pos>=e.byteLength||!(l=n(e)))return t(1,"no header found");if(!(u=l.match(/^#\?(\S+)/)))return t(3,"bad initial token");for(o.valid|=1,o.programtype=u[1],o.string+=l+"\n";l=n(e),!1!==l;)if(o.string+=l+"\n","#"!==l.charAt(0)){if((u=l.match(r))&&(o.gamma=parseFloat(u[1])),(u=l.match(i))&&(o.exposure=parseFloat(u[1])),(u=l.match(a))&&(o.valid|=2,o.format=u[1]),(u=l.match(s))&&(o.valid|=4,o.height=parseInt(u[1],10),o.width=parseInt(u[2],10)),2&o.valid&&4&o.valid)break}else o.comments+=l+"\n";return 2&o.valid?4&o.valid?o:t(3,"missing image size specifier"):t(3,"missing format specifier")}(a);if(-1!==s){const e=s.width,n=s.height,o=function(e,n,r){const i=n;if(i<8||i>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);if(i!==(e[2]<<8|e[3]))return t(3,"wrong scanline width");const a=new Uint8Array(4*n*r);if(!a.length)return t(4,"unable to allocate buffer space");let s=0,o=0;const l=4*i,u=new Uint8Array(4),c=new Uint8Array(l);let d=r;for(;d>0&&o<e.byteLength;){if(o+4>e.byteLength)return t(1);if(u[0]=e[o++],u[1]=e[o++],u[2]=e[o++],u[3]=e[o++],2!=u[0]||2!=u[1]||(u[2]<<8|u[3])!=i)return t(3,"bad rgbe scanline format");let n,r=0;for(;r<l&&o<e.byteLength;){n=e[o++];const i=n>128;if(i&&(n-=128),0===n||r+n>l)return t(3,"bad scanline data");if(i){const t=e[o++];for(let e=0;e<n;e++)c[r++]=t}else c.set(e.subarray(o,o+n),r),r+=n,o+=n}const h=i;for(let e=0;e<h;e++){let t=0;a[s]=c[e+t],t+=i,a[s+1]=c[e+t],t+=i,a[s+2]=c[e+t],t+=i,a[s+3]=c[e+t],s+=4}d--}return a}(a.subarray(a.pos),e,n);if(-1!==o){let t,a,l;switch(this.type){case yY:l=o.length/4;const e=new Float32Array(4*l);for(let t=0;t<l;t++)r(o,4*t,e,4*t);t=e,a=yY;break;case _Y:l=o.length/4;const n=new Uint16Array(4*l);for(let t=0;t<l;t++)i(o,4*t,n,4*t);t=n,a=_Y;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type)}return{width:e,height:n,data:t,header:s.string,gamma:s.gamma,exposure:s.exposure,type:a}}}return null}setDataType(e){return this.type=e,this}load(e,t,n,r){return super.load(e,(function(e,n){switch(e.type){case yY:case _Y:e.colorSpace=zY,e.minFilter=hY,e.magFilter=hY,e.generateMipmaps=!1,e.flipY=!0}t&&t(e,n)}),n,r)}}const K4=new B$,Z4=new I$;class J4 extends e1{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";this.setIndex([0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5]),this.setAttribute("position",new dq([-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],3)),this.setAttribute("uv",new dq([-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],2))}applyMatrix4(e){const t=this.attributes.instanceStart,n=this.attributes.instanceEnd;return void 0!==t&&(t.applyMatrix4(e),n.applyMatrix4(e),t.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}setPositions(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const n=new m1(t,6,1);return this.setAttribute("instanceStart",new VJ(n,3,0)),this.setAttribute("instanceEnd",new VJ(n,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const n=new m1(t,6,1);return this.setAttribute("instanceColorStart",new VJ(n,3,0)),this.setAttribute("instanceColorEnd",new VJ(n,3,3)),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new t0(e.geometry)),this}fromLineSegments(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new B$);const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;void 0!==e&&void 0!==t&&(this.boundingBox.setFromBufferAttribute(e),K4.setFromBufferAttribute(t),this.boundingBox.union(K4))}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new tX),null===this.boundingBox&&this.computeBoundingBox();const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(void 0!==e&&void 0!==t){const n=this.boundingSphere.center;this.boundingBox.getCenter(n);let r=0;for(let i=0,a=e.count;i<a;i++)Z4.fromBufferAttribute(e,i),r=Math.max(r,n.distanceToSquared(Z4)),Z4.fromBufferAttribute(t,i),r=Math.max(r,n.distanceToSquared(Z4));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(e){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(e)}}lK.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new l$(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}},uK.line={uniforms:Hq.merge([lK.common,lK.fog,lK.line]),vertexShader:"\n\t\t#include <common>\n\t\t#include <color_pars_vertex>\n\t\t#include <fog_pars_vertex>\n\t\t#include <logdepthbuf_pars_vertex>\n\t\t#include <clipping_planes_pars_vertex>\n\n\t\tuniform float linewidth;\n\t\tuniform vec2 resolution;\n\n\t\tattribute vec3 instanceStart;\n\t\tattribute vec3 instanceEnd;\n\n\t\tattribute vec3 instanceColorStart;\n\t\tattribute vec3 instanceColorEnd;\n\n\t\t#ifdef WORLD_UNITS\n\n\t\t\tvarying vec4 worldPos;\n\t\t\tvarying vec3 worldStart;\n\t\t\tvarying vec3 worldEnd;\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvarying vec2 vUv;\n\n\t\t\t#endif\n\n\t\t#else\n\n\t\t\tvarying vec2 vUv;\n\n\t\t#endif\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashScale;\n\t\t\tattribute float instanceDistanceStart;\n\t\t\tattribute float instanceDistanceEnd;\n\t\t\tvarying float vLineDistance;\n\n\t\t#endif\n\n\t\tvoid trimSegment( const in vec4 start, inout vec4 end ) {\n\n\t\t\t// trim end segment so it terminates between the camera plane and the near plane\n\n\t\t\t// conservative estimate of the near plane\n\t\t\tfloat a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n\t\t\tfloat b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n\t\t\tfloat nearEstimate = - 0.5 * b / a;\n\n\t\t\tfloat alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n\t\t\tend.xyz = mix( start.xyz, end.xyz, alpha );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#ifdef USE_COLOR\n\n\t\t\t\tvColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n\t\t\t#endif\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n\t\t\t\tvUv = uv;\n\n\t\t\t#endif\n\n\t\t\tfloat aspect = resolution.x / resolution.y;\n\n\t\t\t// camera space\n\t\t\tvec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n\t\t\tvec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\tworldStart = start.xyz;\n\t\t\t\tworldEnd = end.xyz;\n\n\t\t\t#else\n\n\t\t\t\tvUv = uv;\n\n\t\t\t#endif\n\n\t\t\t// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n\t\t\t// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n\t\t\t// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n\t\t\t// perhaps there is a more elegant solution -- WestLangley\n\n\t\t\tbool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n\t\t\tif ( perspective ) {\n\n\t\t\t\tif ( start.z < 0.0 && end.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( start, end );\n\n\t\t\t\t} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( end, start );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// clip space\n\t\t\tvec4 clipStart = projectionMatrix * start;\n\t\t\tvec4 clipEnd = projectionMatrix * end;\n\n\t\t\t// ndc space\n\t\t\tvec3 ndcStart = clipStart.xyz / clipStart.w;\n\t\t\tvec3 ndcEnd = clipEnd.xyz / clipEnd.w;\n\n\t\t\t// direction\n\t\t\tvec2 dir = ndcEnd.xy - ndcStart.xy;\n\n\t\t\t// account for clip-space aspect ratio\n\t\t\tdir.x *= aspect;\n\t\t\tdir = normalize( dir );\n\n\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\t// get the offset direction as perpendicular to the view vector\n\t\t\t\tvec3 worldDir = normalize( end.xyz - start.xyz );\n\t\t\t\tvec3 offset;\n\t\t\t\tif ( position.y < 0.5 ) {\n\n\t\t\t\t\toffset = normalize( cross( start.xyz, worldDir ) );\n\n\t\t\t\t} else {\n\n\t\t\t\t\toffset = normalize( cross( end.xyz, worldDir ) );\n\n\t\t\t\t}\n\n\t\t\t\t// sign flip\n\t\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t\tfloat forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );\n\n\t\t\t\t// don't extend the line if we're rendering dashes because we\n\t\t\t\t// won't be rendering the endcaps\n\t\t\t\t#ifndef USE_DASH\n\n\t\t\t\t\t// extend the line bounds to encompass  endcaps\n\t\t\t\t\tstart.xyz += - worldDir * linewidth * 0.5;\n\t\t\t\t\tend.xyz += worldDir * linewidth * 0.5;\n\n\t\t\t\t\t// shift the position of the quad so it hugs the forward edge of the line\n\t\t\t\t\toffset.xy -= dir * forwardOffset;\n\t\t\t\t\toffset.z += 0.5;\n\n\t\t\t\t#endif\n\n\t\t\t\t// endcaps\n\t\t\t\tif ( position.y > 1.0 || position.y < 0.0 ) {\n\n\t\t\t\t\toffset.xy += dir * 2.0 * forwardOffset;\n\n\t\t\t\t}\n\n\t\t\t\t// adjust for linewidth\n\t\t\t\toffset *= linewidth * 0.5;\n\n\t\t\t\t// set the world position\n\t\t\t\tworldPos = ( position.y < 0.5 ) ? start : end;\n\t\t\t\tworldPos.xyz += offset;\n\n\t\t\t\t// project the worldpos\n\t\t\t\tvec4 clip = projectionMatrix * worldPos;\n\n\t\t\t\t// shift the depth of the projected points so the line\n\t\t\t\t// segments overlap neatly\n\t\t\t\tvec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;\n\t\t\t\tclip.z = clipPose.z * clip.w;\n\n\t\t\t#else\n\n\t\t\t\tvec2 offset = vec2( dir.y, - dir.x );\n\t\t\t\t// undo aspect ratio adjustment\n\t\t\t\tdir.x /= aspect;\n\t\t\t\toffset.x /= aspect;\n\n\t\t\t\t// sign flip\n\t\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t\t// endcaps\n\t\t\t\tif ( position.y < 0.0 ) {\n\n\t\t\t\t\toffset += - dir;\n\n\t\t\t\t} else if ( position.y > 1.0 ) {\n\n\t\t\t\t\toffset += dir;\n\n\t\t\t\t}\n\n\t\t\t\t// adjust for linewidth\n\t\t\t\toffset *= linewidth;\n\n\t\t\t\t// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n\t\t\t\toffset /= resolution.y;\n\n\t\t\t\t// select end\n\t\t\t\tvec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n\t\t\t\t// back to clip space\n\t\t\t\toffset *= clip.w;\n\n\t\t\t\tclip.xy += offset;\n\n\t\t\t#endif\n\n\t\t\tgl_Position = clip;\n\n\t\t\tvec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\n\t\t\t#include <logdepthbuf_vertex>\n\t\t\t#include <clipping_planes_vertex>\n\t\t\t#include <fog_vertex>\n\n\t\t}\n\t\t",fragmentShader:"\n\t\tuniform vec3 diffuse;\n\t\tuniform float opacity;\n\t\tuniform float linewidth;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashOffset;\n\t\t\tuniform float dashSize;\n\t\t\tuniform float gapSize;\n\n\t\t#endif\n\n\t\tvarying float vLineDistance;\n\n\t\t#ifdef WORLD_UNITS\n\n\t\t\tvarying vec4 worldPos;\n\t\t\tvarying vec3 worldStart;\n\t\t\tvarying vec3 worldEnd;\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvarying vec2 vUv;\n\n\t\t\t#endif\n\n\t\t#else\n\n\t\t\tvarying vec2 vUv;\n\n\t\t#endif\n\n\t\t#include <common>\n\t\t#include <color_pars_fragment>\n\t\t#include <fog_pars_fragment>\n\t\t#include <logdepthbuf_pars_fragment>\n\t\t#include <clipping_planes_pars_fragment>\n\n\t\tvec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {\n\n\t\t\tfloat mua;\n\t\t\tfloat mub;\n\n\t\t\tvec3 p13 = p1 - p3;\n\t\t\tvec3 p43 = p4 - p3;\n\n\t\t\tvec3 p21 = p2 - p1;\n\n\t\t\tfloat d1343 = dot( p13, p43 );\n\t\t\tfloat d4321 = dot( p43, p21 );\n\t\t\tfloat d1321 = dot( p13, p21 );\n\t\t\tfloat d4343 = dot( p43, p43 );\n\t\t\tfloat d2121 = dot( p21, p21 );\n\n\t\t\tfloat denom = d2121 * d4343 - d4321 * d4321;\n\n\t\t\tfloat numer = d1343 * d4321 - d1321 * d4343;\n\n\t\t\tmua = numer / denom;\n\t\t\tmua = clamp( mua, 0.0, 1.0 );\n\t\t\tmub = ( d1343 + d4321 * ( mua ) ) / d4343;\n\t\t\tmub = clamp( mub, 0.0, 1.0 );\n\n\t\t\treturn vec2( mua, mub );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#include <clipping_planes_fragment>\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tif ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n\t\t\t\tif ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n\t\t\t#endif\n\n\t\t\tfloat alpha = opacity;\n\n\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\t// Find the closest points on the view ray and the line segment\n\t\t\t\tvec3 rayEnd = normalize( worldPos.xyz ) * 1e5;\n\t\t\t\tvec3 lineDir = worldEnd - worldStart;\n\t\t\t\tvec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );\n\n\t\t\t\tvec3 p1 = worldStart + lineDir * params.x;\n\t\t\t\tvec3 p2 = rayEnd * params.y;\n\t\t\t\tvec3 delta = p1 - p2;\n\t\t\t\tfloat len = length( delta );\n\t\t\t\tfloat norm = len / linewidth;\n\n\t\t\t\t#ifndef USE_DASH\n\n\t\t\t\t\t#ifdef USE_ALPHA_TO_COVERAGE\n\n\t\t\t\t\t\tfloat dnorm = fwidth( norm );\n\t\t\t\t\t\talpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );\n\n\t\t\t\t\t#else\n\n\t\t\t\t\t\tif ( norm > 0.5 ) {\n\n\t\t\t\t\t\t\tdiscard;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t#endif\n\n\t\t\t\t#endif\n\n\t\t\t#else\n\n\t\t\t\t#ifdef USE_ALPHA_TO_COVERAGE\n\n\t\t\t\t\t// artifacts appear on some hardware if a derivative is taken within a conditional\n\t\t\t\t\tfloat a = vUv.x;\n\t\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\t\tfloat len2 = a * a + b * b;\n\t\t\t\t\tfloat dlen = fwidth( len2 );\n\n\t\t\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\t\t\talpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );\n\n\t\t\t\t\t}\n\n\t\t\t\t#else\n\n\t\t\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\t\t\tfloat a = vUv.x;\n\t\t\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\t\t\tfloat len2 = a * a + b * b;\n\n\t\t\t\t\t\tif ( len2 > 1.0 ) discard;\n\n\t\t\t\t\t}\n\n\t\t\t\t#endif\n\n\t\t\t#endif\n\n\t\t\tvec4 diffuseColor = vec4( diffuse, alpha );\n\n\t\t\t#include <logdepthbuf_fragment>\n\t\t\t#include <color_fragment>\n\n\t\t\tgl_FragColor = vec4( diffuseColor.rgb, alpha );\n\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <encodings_fragment>\n\t\t\t#include <fog_fragment>\n\t\t\t#include <premultiplied_alpha_fragment>\n\n\t\t}\n\t\t"};class Q4 extends jq{constructor(e){super({type:"LineMaterial",uniforms:Hq.clone(uK.line.uniforms),vertexShader:uK.line.vertexShader,fragmentShader:uK.line.fragmentShader,clipping:!0}),this.isLineMaterial=!0,Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(e){this.uniforms.diffuse.value=e}},worldUnits:{enumerable:!0,get:function(){return"WORLD_UNITS"in this.defines},set:function(e){!0===e?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(e){this.uniforms.linewidth.value=e}},dashed:{enumerable:!0,get:function(){return Boolean("USE_DASH"in this.defines)},set(e){Boolean(e)!==Boolean("USE_DASH"in this.defines)&&(this.needsUpdate=!0),!0===e?this.defines.USE_DASH="":delete this.defines.USE_DASH}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(e){this.uniforms.dashScale.value=e}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(e){this.uniforms.dashSize.value=e}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(e){this.uniforms.dashOffset.value=e}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(e){this.uniforms.gapSize.value=e}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(e){this.uniforms.opacity.value=e}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(e){this.uniforms.resolution.value.copy(e)}},alphaToCoverage:{enumerable:!0,get:function(){return Boolean("USE_ALPHA_TO_COVERAGE"in this.defines)},set:function(e){Boolean(e)!==Boolean("USE_ALPHA_TO_COVERAGE"in this.defines)&&(this.needsUpdate=!0),!0===e?(this.defines.USE_ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.USE_ALPHA_TO_COVERAGE,this.extensions.derivatives=!1)}}}),this.setValues(e)}}const e5=new I$,t5=new I$,n5=new P$,r5=new P$,i5=new P$,a5=new I$,s5=new cX,o5=new class{constructor(e=new I$,t=new I$){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){b1.subVectors(e,this.start),x1.subVectors(this.end,this.start);const n=x1.dot(x1);let r=x1.dot(b1)/n;return t&&(r=QY(r,0,1)),r}closestPointToPoint(e,t,n){const r=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}},l5=new I$,u5=new B$,c5=new tX,d5=new P$;let h5,p5;function f5(e,t,n){return d5.set(0,0,-t,1).applyMatrix4(e.projectionMatrix),d5.multiplyScalar(1/d5.w),d5.x=p5/n.width,d5.y=p5/n.height,d5.applyMatrix4(e.projectionMatrixInverse),d5.multiplyScalar(1/d5.w),Math.abs(Math.max(d5.x,d5.y))}class m5 extends Bq{constructor(e=new J4,t=new Q4({color:16777215*Math.random()})){super(e,t),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const e=this.geometry,t=e.attributes.instanceStart,n=e.attributes.instanceEnd,r=new Float32Array(2*t.count);for(let a=0,s=0,o=t.count;a<o;a++,s+=2)e5.fromBufferAttribute(t,a),t5.fromBufferAttribute(n,a),r[s]=0===s?0:r[s-1],r[s+1]=r[s]+e5.distanceTo(t5);const i=new m1(r,2,1);return e.setAttribute("instanceDistanceStart",new VJ(i,1,0)),e.setAttribute("instanceDistanceEnd",new VJ(i,1,1)),this}raycast(e,t){const n=this.material.worldUnits,r=e.camera;null!==r||n||console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const i=void 0!==e.params.Line2&&e.params.Line2.threshold||0;h5=e.ray;const a=this.matrixWorld,s=this.geometry,o=this.material;let l,u;if(p5=o.linewidth+i,null===s.boundingSphere&&s.computeBoundingSphere(),c5.copy(s.boundingSphere).applyMatrix4(a),n)l=.5*p5;else{l=f5(r,Math.max(r.near,c5.distanceToPoint(h5.origin)),o.resolution)}if(c5.radius+=l,!1!==h5.intersectsSphere(c5)){if(null===s.boundingBox&&s.computeBoundingBox(),u5.copy(s.boundingBox).applyMatrix4(a),n)u=.5*p5;else{u=f5(r,Math.max(r.near,u5.distanceToPoint(h5.origin)),o.resolution)}u5.expandByScalar(u),!1!==h5.intersectsBox(u5)&&(n?function(e,t){const n=e.matrixWorld,r=e.geometry,i=r.attributes.instanceStart,a=r.attributes.instanceEnd;for(let s=0,o=Math.min(r.instanceCount,i.count);s<o;s++){o5.start.fromBufferAttribute(i,s),o5.end.fromBufferAttribute(a,s),o5.applyMatrix4(n);const r=new I$,o=new I$;h5.distanceSqToSegment(o5.start,o5.end,o,r),o.distanceTo(r)<.5*p5&&t.push({point:o,pointOnLine:r,distance:h5.origin.distanceTo(o),object:e,face:null,faceIndex:s,uv:null,uv1:null})}}(this,t):function(e,t,n){const r=t.projectionMatrix,i=e.material.resolution,a=e.matrixWorld,s=e.geometry,o=s.attributes.instanceStart,l=s.attributes.instanceEnd,u=Math.min(s.instanceCount,o.count),c=-t.near;h5.at(1,i5),i5.w=1,i5.applyMatrix4(t.matrixWorldInverse),i5.applyMatrix4(r),i5.multiplyScalar(1/i5.w),i5.x*=i.x/2,i5.y*=i.y/2,i5.z=0,a5.copy(i5),s5.multiplyMatrices(t.matrixWorldInverse,a);for(let d=0,h=u;d<h;d++){if(n5.fromBufferAttribute(o,d),r5.fromBufferAttribute(l,d),n5.w=1,r5.w=1,n5.applyMatrix4(s5),r5.applyMatrix4(s5),n5.z>c&&r5.z>c)continue;if(n5.z>c){const e=n5.z-r5.z,t=(n5.z-c)/e;n5.lerp(r5,t)}else if(r5.z>c){const e=r5.z-n5.z,t=(r5.z-c)/e;r5.lerp(n5,t)}n5.applyMatrix4(r),r5.applyMatrix4(r),n5.multiplyScalar(1/n5.w),r5.multiplyScalar(1/r5.w),n5.x*=i.x/2,n5.y*=i.y/2,r5.x*=i.x/2,r5.y*=i.y/2,o5.start.copy(n5),o5.start.z=0,o5.end.copy(r5),o5.end.z=0;const t=o5.closestPointToPointParameter(a5,!0);o5.at(t,l5);const s=o$.lerp(n5.z,r5.z,t),u=s>=-1&&s<=1,h=a5.distanceTo(l5)<.5*p5;if(u&&h){o5.start.fromBufferAttribute(o,d),o5.end.fromBufferAttribute(l,d),o5.start.applyMatrix4(a),o5.end.applyMatrix4(a);const t=new I$,r=new I$;h5.distanceSqToSegment(o5.start,o5.end,r,t),n.push({point:r,pointOnLine:t,distance:h5.origin.distanceTo(r),object:e,face:null,faceIndex:d,uv:null,uv1:null})}}}(this,r,t))}}}class g5 extends J4{constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}setPositions(e){const t=e.length-3,n=new Float32Array(2*t);for(let r=0;r<t;r+=3)n[2*r]=e[r],n[2*r+1]=e[r+1],n[2*r+2]=e[r+2],n[2*r+3]=e[r+3],n[2*r+4]=e[r+4],n[2*r+5]=e[r+5];return super.setPositions(n),this}setColors(e){const t=e.length-3,n=new Float32Array(2*t);for(let r=0;r<t;r+=3)n[2*r]=e[r],n[2*r+1]=e[r+1],n[2*r+2]=e[r+2],n[2*r+3]=e[r+3],n[2*r+4]=e[r+4],n[2*r+5]=e[r+5];return super.setColors(n),this}fromLine(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}}class v5 extends m5{constructor(e=new g5,t=new Q4({color:16777215*Math.random()})){super(e,t),this.isLine2=!0,this.type="Line2"}}function y5(e,t="hh:mm"){let n=Math.floor(e),r=Math.floor(60*e-60*n);var i={"h+":n,"m+":r,"s+":Math.floor(60*e*60-60*n*60-60*r)};for(var a in i)new RegExp("("+a+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[a]:("00"+i[a]).substr((""+i[a]).length)));return t}function _5(e,t){let n=e.getFullYear(),r=new Date(n+"/01/01"),i=(Date.parse(e)-Number(r))/864e5+1;return t?i:Math.round(i)}function b5(e){let t=_5(e,null),n=2*Math.PI*(t-1)/365;return.006918-.399912*Math.cos(n)+.070257*Math.sin(n)-.006758*Math.cos(2*n)+907e-6*Math.sin(2*n)-.002697*Math.cos(3*n)+.00148*Math.sin(3*n)}function x5(e,t){let n=b5(e);return 24-24*Math.acos(Math.tan(n)*Math.tan(t))/Math.PI}function w5(e){return Math.PI*e/180}function S5(e){return 180*e/Math.PI}function C5(e){let t=Math.abs(e);var n=Math.floor(t),r=`${n}°${Math.floor(60*(t-n))}′${Math.round(3600*(t-n)%60)}″`;return e<0&&(r="-"+r),r}At();const T5={debounce:function(e,t){let n=null;return function(){let r=this,i=arguments;n&&clearTimeout(n),n=setTimeout((()=>{e.apply(r,i)}),t)}},throttle:function(e,t){let n,r=null;return function(){let i=this,a=new Date,s=arguments;Number(a)-r-t>0?(n&&(clearTimeout(n),n=null),e.apply(i,s),r=a):(clearTimeout(n),n=setTimeout((()=>{e.apply(i,s)}),t))}},dateFormat:function(e,t){var n={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};for(var r in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+r+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?n[r]:("00"+n[r]).substr((""+n[r]).length)));return t},timeFormat:y5,getDays:_5,getDeclination:b5,getSunLightHeightRad:function(e,t){const n=b5(t);return Math.PI/2-e+n},getDayLength:x5,getSunTime:function(e,t,n,r=8,i="hh:mm:ss"){let a=x5(n,t),s=12+S5(w5(15*r)-e)/15,o=y5(s);return{riseTime:y5(s-a/2,i),setTime:y5(s+a/2,i),noonTime:o,noonTimeNum:s,dayLength:a}},deg2rad:w5,rad2deg:S5,deg2str:C5,rad2str:function(e){return C5(S5(e))}};var M5=(e=>(e[e["aristea_wreck_puresky_4k.hdr"]=0]="aristea_wreck_puresky_4k.hdr",e))(M5||{});
//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var E5,A5;function P5(){return E5.apply(null,arguments)}function R5(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function L5(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function k5(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function D5(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(k5(e,t))return!1;return!0}function I5(e){return void 0===e}function O5(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function N5(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function B5(e,t){var n,r=[],i=e.length;for(n=0;n<i;++n)r.push(t(e[n],n));return r}function U5(e,t){for(var n in t)k5(t,n)&&(e[n]=t[n]);return k5(t,"toString")&&(e.toString=t.toString),k5(t,"valueOf")&&(e.valueOf=t.valueOf),e}function z5(e,t,n,r){return a9(e,t,n,r,!0).utc()}function F5(e){return null==e._pf&&(e._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}),e._pf}function V5(e){if(null==e._isValid){var t=F5(e),n=A5.call(t.parsedDateParts,(function(e){return null!=e})),r=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&n);if(e._strict&&(r=r&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return r;e._isValid=r}return e._isValid}function G5(e){var t=z5(NaN);return null!=e?U5(F5(t),e):F5(t).userInvalidated=!0,t}A5=Array.prototype.some?Array.prototype.some:function(e){var t,n=Object(this),r=n.length>>>0;for(t=0;t<r;t++)if(t in n&&e.call(this,n[t],t,n))return!0;return!1};var H5=P5.momentProperties=[],j5=!1;function W5(e,t){var n,r,i,a=H5.length;if(I5(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),I5(t._i)||(e._i=t._i),I5(t._f)||(e._f=t._f),I5(t._l)||(e._l=t._l),I5(t._strict)||(e._strict=t._strict),I5(t._tzm)||(e._tzm=t._tzm),I5(t._isUTC)||(e._isUTC=t._isUTC),I5(t._offset)||(e._offset=t._offset),I5(t._pf)||(e._pf=F5(t)),I5(t._locale)||(e._locale=t._locale),a>0)for(n=0;n<a;n++)I5(i=t[r=H5[n]])||(e[r]=i);return e}function Y5(e){W5(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===j5&&(j5=!0,P5.updateOffset(this),j5=!1)}function $5(e){return e instanceof Y5||null!=e&&null!=e._isAMomentObject}function X5(e){!1===P5.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function q5(e,t){var n=!0;return U5((function(){if(null!=P5.deprecationHandler&&P5.deprecationHandler(null,e),n){var r,i,a,s=[],o=arguments.length;for(i=0;i<o;i++){if(r="","object"==typeof arguments[i]){for(a in r+="\n["+i+"] ",arguments[0])k5(arguments[0],a)&&(r+=a+": "+arguments[0][a]+", ");r=r.slice(0,-2)}else r=arguments[i];s.push(r)}X5(e+"\nArguments: "+Array.prototype.slice.call(s).join("")+"\n"+(new Error).stack),n=!1}return t.apply(this,arguments)}),t)}var K5,Z5={};function J5(e,t){null!=P5.deprecationHandler&&P5.deprecationHandler(e,t),Z5[e]||(X5(t),Z5[e]=!0)}function Q5(e){return"undefined"!=typeof Function&&e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function e6(e,t){var n,r=U5({},e);for(n in t)k5(t,n)&&(L5(e[n])&&L5(t[n])?(r[n]={},U5(r[n],e[n]),U5(r[n],t[n])):null!=t[n]?r[n]=t[n]:delete r[n]);for(n in e)k5(e,n)&&!k5(t,n)&&L5(e[n])&&(r[n]=U5({},r[n]));return r}function t6(e){null!=e&&this.set(e)}P5.suppressDeprecationWarnings=!1,P5.deprecationHandler=null,K5=Object.keys?Object.keys:function(e){var t,n=[];for(t in e)k5(e,t)&&n.push(t);return n};function n6(e,t,n){var r=""+Math.abs(e),i=t-r.length;return(e>=0?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var r6=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,i6=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,a6={},s6={};function o6(e,t,n,r){var i=r;"string"==typeof r&&(i=function(){return this[r]()}),e&&(s6[e]=i),t&&(s6[t[0]]=function(){return n6(i.apply(this,arguments),t[1],t[2])}),n&&(s6[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function l6(e,t){return e.isValid()?(t=u6(t,e.localeData()),a6[t]=a6[t]||function(e){var t,n,r,i=e.match(r6);for(t=0,n=i.length;t<n;t++)s6[i[t]]?i[t]=s6[i[t]]:i[t]=(r=i[t]).match(/\[[\s\S]/)?r.replace(/^\[|\]$/g,""):r.replace(/\\/g,"");return function(t){var r,a="";for(r=0;r<n;r++)a+=Q5(i[r])?i[r].call(t,e):i[r];return a}}(t),a6[t](e)):e.localeData().invalidDate()}function u6(e,t){var n=5;function r(e){return t.longDateFormat(e)||e}for(i6.lastIndex=0;n>=0&&i6.test(e);)e=e.replace(i6,r),i6.lastIndex=0,n-=1;return e}var c6={};function d6(e,t){var n=e.toLowerCase();c6[n]=c6[n+"s"]=c6[t]=e}function h6(e){return"string"==typeof e?c6[e]||c6[e.toLowerCase()]:void 0}function p6(e){var t,n,r={};for(n in e)k5(e,n)&&(t=h6(n))&&(r[t]=e[n]);return r}var f6={};function m6(e,t){f6[e]=t}function g6(e){return e%4==0&&e%100!=0||e%400==0}function v6(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function y6(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=v6(t)),n}function _6(e,t){return function(n){return null!=n?(x6(this,e,n),P5.updateOffset(this,t),this):b6(this,e)}}function b6(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function x6(e,t,n){e.isValid()&&!isNaN(n)&&("FullYear"===t&&g6(e.year())&&1===e.month()&&29===e.date()?(n=y6(n),e._d["set"+(e._isUTC?"UTC":"")+t](n,e.month(),n8(n,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+t](n))}var w6,S6=/\d/,C6=/\d\d/,T6=/\d{3}/,M6=/\d{4}/,E6=/[+-]?\d{6}/,A6=/\d\d?/,P6=/\d\d\d\d?/,R6=/\d\d\d\d\d\d?/,L6=/\d{1,3}/,k6=/\d{1,4}/,D6=/[+-]?\d{1,6}/,I6=/\d+/,O6=/[+-]?\d+/,N6=/Z|[+-]\d\d:?\d\d/gi,B6=/Z|[+-]\d\d(?::?\d\d)?/gi,U6=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i;function z6(e,t,n){w6[e]=Q5(t)?t:function(e,r){return e&&n?n:t}}function F6(e,t){return k5(w6,e)?w6[e](t._strict,t._locale):new RegExp(V6(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,(function(e,t,n,r,i){return t||n||r||i}))))}function V6(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}w6={};var G6={};function H6(e,t){var n,r,i=t;for("string"==typeof e&&(e=[e]),O5(t)&&(i=function(e,n){n[t]=y6(e)}),r=e.length,n=0;n<r;n++)G6[e[n]]=i}function j6(e,t){H6(e,(function(e,n,r,i){r._w=r._w||{},t(e,r._w,r,i)}))}function W6(e,t,n){null!=t&&k5(G6,e)&&G6[e](t,n._a,n,e)}var Y6,$6=0,X6=1,q6=2,K6=3,Z6=4,J6=5,Q6=6,e8=7,t8=8;function n8(e,t){if(isNaN(e)||isNaN(t))return NaN;var n,r=(t%(n=12)+n)%n;return e+=(t-r)/12,1===r?g6(e)?29:28:31-r%7%2}Y6=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},o6("M",["MM",2],"Mo",(function(){return this.month()+1})),o6("MMM",0,0,(function(e){return this.localeData().monthsShort(this,e)})),o6("MMMM",0,0,(function(e){return this.localeData().months(this,e)})),d6("month","M"),m6("month",8),z6("M",A6),z6("MM",A6,C6),z6("MMM",(function(e,t){return t.monthsShortRegex(e)})),z6("MMMM",(function(e,t){return t.monthsRegex(e)})),H6(["M","MM"],(function(e,t){t[X6]=y6(e)-1})),H6(["MMM","MMMM"],(function(e,t,n,r){var i=n._locale.monthsParse(e,r,n._strict);null!=i?t[X6]=i:F5(n).invalidMonth=e}));var r8="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),i8="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),a8=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,s8=U6,o8=U6;function l8(e,t,n){var r,i,a,s=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)a=z5([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(a,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(a,"").toLocaleLowerCase();return n?"MMM"===t?-1!==(i=Y6.call(this._shortMonthsParse,s))?i:null:-1!==(i=Y6.call(this._longMonthsParse,s))?i:null:"MMM"===t?-1!==(i=Y6.call(this._shortMonthsParse,s))||-1!==(i=Y6.call(this._longMonthsParse,s))?i:null:-1!==(i=Y6.call(this._longMonthsParse,s))||-1!==(i=Y6.call(this._shortMonthsParse,s))?i:null}function u8(e,t){var n;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=y6(t);else if(!O5(t=e.localeData().monthsParse(t)))return e;return n=Math.min(e.date(),n8(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function c8(e){return null!=e?(u8(this,e),P5.updateOffset(this,!0),this):b6(this,"Month")}function d8(){function e(e,t){return t.length-e.length}var t,n,r=[],i=[],a=[];for(t=0;t<12;t++)n=z5([2e3,t]),r.push(this.monthsShort(n,"")),i.push(this.months(n,"")),a.push(this.months(n,"")),a.push(this.monthsShort(n,""));for(r.sort(e),i.sort(e),a.sort(e),t=0;t<12;t++)r[t]=V6(r[t]),i[t]=V6(i[t]);for(t=0;t<24;t++)a[t]=V6(a[t]);this._monthsRegex=new RegExp("^("+a.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+r.join("|")+")","i")}function h8(e){return g6(e)?366:365}o6("Y",0,0,(function(){var e=this.year();return e<=9999?n6(e,4):"+"+e})),o6(0,["YY",2],0,(function(){return this.year()%100})),o6(0,["YYYY",4],0,"year"),o6(0,["YYYYY",5],0,"year"),o6(0,["YYYYYY",6,!0],0,"year"),d6("year","y"),m6("year",1),z6("Y",O6),z6("YY",A6,C6),z6("YYYY",k6,M6),z6("YYYYY",D6,E6),z6("YYYYYY",D6,E6),H6(["YYYYY","YYYYYY"],$6),H6("YYYY",(function(e,t){t[$6]=2===e.length?P5.parseTwoDigitYear(e):y6(e)})),H6("YY",(function(e,t){t[$6]=P5.parseTwoDigitYear(e)})),H6("Y",(function(e,t){t[$6]=parseInt(e,10)})),P5.parseTwoDigitYear=function(e){return y6(e)+(y6(e)>68?1900:2e3)};var p8=_6("FullYear",!0);function f8(e,t,n,r,i,a,s){var o;return e<100&&e>=0?(o=new Date(e+400,t,n,r,i,a,s),isFinite(o.getFullYear())&&o.setFullYear(e)):o=new Date(e,t,n,r,i,a,s),o}function m8(e){var t,n;return e<100&&e>=0?((n=Array.prototype.slice.call(arguments))[0]=e+400,t=new Date(Date.UTC.apply(null,n)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function g8(e,t,n){var r=7+t-n;return-((7+m8(e,0,r).getUTCDay()-t)%7)+r-1}function v8(e,t,n,r,i){var a,s,o=1+7*(t-1)+(7+n-r)%7+g8(e,r,i);return o<=0?s=h8(a=e-1)+o:o>h8(e)?(a=e+1,s=o-h8(e)):(a=e,s=o),{year:a,dayOfYear:s}}function y8(e,t,n){var r,i,a=g8(e.year(),t,n),s=Math.floor((e.dayOfYear()-a-1)/7)+1;return s<1?r=s+_8(i=e.year()-1,t,n):s>_8(e.year(),t,n)?(r=s-_8(e.year(),t,n),i=e.year()+1):(i=e.year(),r=s),{week:r,year:i}}function _8(e,t,n){var r=g8(e,t,n),i=g8(e+1,t,n);return(h8(e)-r+i)/7}o6("w",["ww",2],"wo","week"),o6("W",["WW",2],"Wo","isoWeek"),d6("week","w"),d6("isoWeek","W"),m6("week",5),m6("isoWeek",5),z6("w",A6),z6("ww",A6,C6),z6("W",A6),z6("WW",A6,C6),j6(["w","ww","W","WW"],(function(e,t,n,r){t[r.substr(0,1)]=y6(e)}));function b8(e,t){return e.slice(t,7).concat(e.slice(0,t))}o6("d",0,"do","day"),o6("dd",0,0,(function(e){return this.localeData().weekdaysMin(this,e)})),o6("ddd",0,0,(function(e){return this.localeData().weekdaysShort(this,e)})),o6("dddd",0,0,(function(e){return this.localeData().weekdays(this,e)})),o6("e",0,0,"weekday"),o6("E",0,0,"isoWeekday"),d6("day","d"),d6("weekday","e"),d6("isoWeekday","E"),m6("day",11),m6("weekday",11),m6("isoWeekday",11),z6("d",A6),z6("e",A6),z6("E",A6),z6("dd",(function(e,t){return t.weekdaysMinRegex(e)})),z6("ddd",(function(e,t){return t.weekdaysShortRegex(e)})),z6("dddd",(function(e,t){return t.weekdaysRegex(e)})),j6(["dd","ddd","dddd"],(function(e,t,n,r){var i=n._locale.weekdaysParse(e,r,n._strict);null!=i?t.d=i:F5(n).invalidWeekday=e})),j6(["d","e","E"],(function(e,t,n,r){t[r]=y6(e)}));var x8="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),w8="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),S8="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),C8=U6,T8=U6,M8=U6;function E8(e,t,n){var r,i,a,s=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)a=z5([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(a,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(a,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(a,"").toLocaleLowerCase();return n?"dddd"===t?-1!==(i=Y6.call(this._weekdaysParse,s))?i:null:"ddd"===t?-1!==(i=Y6.call(this._shortWeekdaysParse,s))?i:null:-1!==(i=Y6.call(this._minWeekdaysParse,s))?i:null:"dddd"===t?-1!==(i=Y6.call(this._weekdaysParse,s))||-1!==(i=Y6.call(this._shortWeekdaysParse,s))||-1!==(i=Y6.call(this._minWeekdaysParse,s))?i:null:"ddd"===t?-1!==(i=Y6.call(this._shortWeekdaysParse,s))||-1!==(i=Y6.call(this._weekdaysParse,s))||-1!==(i=Y6.call(this._minWeekdaysParse,s))?i:null:-1!==(i=Y6.call(this._minWeekdaysParse,s))||-1!==(i=Y6.call(this._weekdaysParse,s))||-1!==(i=Y6.call(this._shortWeekdaysParse,s))?i:null}function A8(){function e(e,t){return t.length-e.length}var t,n,r,i,a,s=[],o=[],l=[],u=[];for(t=0;t<7;t++)n=z5([2e3,1]).day(t),r=V6(this.weekdaysMin(n,"")),i=V6(this.weekdaysShort(n,"")),a=V6(this.weekdays(n,"")),s.push(r),o.push(i),l.push(a),u.push(r),u.push(i),u.push(a);s.sort(e),o.sort(e),l.sort(e),u.sort(e),this._weekdaysRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+s.join("|")+")","i")}function P8(){return this.hours()%12||12}function R8(e,t){o6(e,0,0,(function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)}))}function L8(e,t){return t._meridiemParse}o6("H",["HH",2],0,"hour"),o6("h",["hh",2],0,P8),o6("k",["kk",2],0,(function(){return this.hours()||24})),o6("hmm",0,0,(function(){return""+P8.apply(this)+n6(this.minutes(),2)})),o6("hmmss",0,0,(function(){return""+P8.apply(this)+n6(this.minutes(),2)+n6(this.seconds(),2)})),o6("Hmm",0,0,(function(){return""+this.hours()+n6(this.minutes(),2)})),o6("Hmmss",0,0,(function(){return""+this.hours()+n6(this.minutes(),2)+n6(this.seconds(),2)})),R8("a",!0),R8("A",!1),d6("hour","h"),m6("hour",13),z6("a",L8),z6("A",L8),z6("H",A6),z6("h",A6),z6("k",A6),z6("HH",A6,C6),z6("hh",A6,C6),z6("kk",A6,C6),z6("hmm",P6),z6("hmmss",R6),z6("Hmm",P6),z6("Hmmss",R6),H6(["H","HH"],K6),H6(["k","kk"],(function(e,t,n){var r=y6(e);t[K6]=24===r?0:r})),H6(["a","A"],(function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e})),H6(["h","hh"],(function(e,t,n){t[K6]=y6(e),F5(n).bigHour=!0})),H6("hmm",(function(e,t,n){var r=e.length-2;t[K6]=y6(e.substr(0,r)),t[Z6]=y6(e.substr(r)),F5(n).bigHour=!0})),H6("hmmss",(function(e,t,n){var r=e.length-4,i=e.length-2;t[K6]=y6(e.substr(0,r)),t[Z6]=y6(e.substr(r,2)),t[J6]=y6(e.substr(i)),F5(n).bigHour=!0})),H6("Hmm",(function(e,t,n){var r=e.length-2;t[K6]=y6(e.substr(0,r)),t[Z6]=y6(e.substr(r))})),H6("Hmmss",(function(e,t,n){var r=e.length-4,i=e.length-2;t[K6]=y6(e.substr(0,r)),t[Z6]=y6(e.substr(r,2)),t[J6]=y6(e.substr(i))}));var k8=_6("Hours",!0);var D8,I8={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:r8,monthsShort:i8,week:{dow:0,doy:6},weekdays:x8,weekdaysMin:S8,weekdaysShort:w8,meridiemParse:/[ap]\.?m?\.?/i},O8={},N8={};function B8(e,t){var n,r=Math.min(e.length,t.length);for(n=0;n<r;n+=1)if(e[n]!==t[n])return n;return r}function U8(e){return e?e.toLowerCase().replace("_","-"):e}function z8(e){var t=null;if(void 0===O8[e]&&"undefined"!=typeof module&&module&&module.exports&&function(e){return null!=e.match("^[^/\\\\]*$")}(e))try{t=D8._abbr,require("./locale/"+e),F8(t)}catch(zA){O8[e]=null}return O8[e]}function F8(e,t){var n;return e&&((n=I5(t)?G8(e):V8(e,t))?D8=n:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),D8._abbr}function V8(e,t){if(null!==t){var n,r=I8;if(t.abbr=e,null!=O8[e])J5("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=O8[e]._config;else if(null!=t.parentLocale)if(null!=O8[t.parentLocale])r=O8[t.parentLocale]._config;else{if(null==(n=z8(t.parentLocale)))return N8[t.parentLocale]||(N8[t.parentLocale]=[]),N8[t.parentLocale].push({name:e,config:t}),null;r=n._config}return O8[e]=new t6(e6(r,t)),N8[e]&&N8[e].forEach((function(e){V8(e.name,e.config)})),F8(e),O8[e]}return delete O8[e],null}function G8(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return D8;if(!R5(e)){if(t=z8(e))return t;e=[e]}return function(e){for(var t,n,r,i,a=0;a<e.length;){for(t=(i=U8(e[a]).split("-")).length,n=(n=U8(e[a+1]))?n.split("-"):null;t>0;){if(r=z8(i.slice(0,t).join("-")))return r;if(n&&n.length>=t&&B8(i,n)>=t-1)break;t--}a++}return D8}(e)}function H8(e){var t,n=e._a;return n&&-2===F5(e).overflow&&(t=n[X6]<0||n[X6]>11?X6:n[q6]<1||n[q6]>n8(n[$6],n[X6])?q6:n[K6]<0||n[K6]>24||24===n[K6]&&(0!==n[Z6]||0!==n[J6]||0!==n[Q6])?K6:n[Z6]<0||n[Z6]>59?Z6:n[J6]<0||n[J6]>59?J6:n[Q6]<0||n[Q6]>999?Q6:-1,F5(e)._overflowDayOfYear&&(t<$6||t>q6)&&(t=q6),F5(e)._overflowWeeks&&-1===t&&(t=e8),F5(e)._overflowWeekday&&-1===t&&(t=t8),F5(e).overflow=t),e}var j8=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,W8=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Y8=/Z|[+-]\d\d(?::?\d\d)?/,$8=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],X8=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],q8=/^\/?Date\((-?\d+)/i,K8=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Z8={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function J8(e){var t,n,r,i,a,s,o=e._i,l=j8.exec(o)||W8.exec(o),u=$8.length,c=X8.length;if(l){for(F5(e).iso=!0,t=0,n=u;t<n;t++)if($8[t][1].exec(l[1])){i=$8[t][0],r=!1!==$8[t][2];break}if(null==i)return void(e._isValid=!1);if(l[3]){for(t=0,n=c;t<n;t++)if(X8[t][1].exec(l[3])){a=(l[2]||" ")+X8[t][0];break}if(null==a)return void(e._isValid=!1)}if(!r&&null!=a)return void(e._isValid=!1);if(l[4]){if(!Y8.exec(l[4]))return void(e._isValid=!1);s="Z"}e._f=i+(a||"")+(s||""),r9(e)}else e._isValid=!1}function Q8(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function e9(e){var t,n,r,i,a,s,o,l,u=K8.exec(e._i.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""));if(u){if(n=u[4],r=u[3],i=u[2],a=u[5],s=u[6],o=u[7],l=[Q8(n),i8.indexOf(r),parseInt(i,10),parseInt(a,10),parseInt(s,10)],o&&l.push(parseInt(o,10)),t=l,!function(e,t,n){return!e||w8.indexOf(e)===new Date(t[0],t[1],t[2]).getDay()||(F5(n).weekdayMismatch=!0,n._isValid=!1,!1)}(u[1],t,e))return;e._a=t,e._tzm=function(e,t,n){if(e)return Z8[e];if(t)return 0;var r=parseInt(n,10),i=r%100;return(r-i)/100*60+i}(u[8],u[9],u[10]),e._d=m8.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),F5(e).rfc2822=!0}else e._isValid=!1}function t9(e,t,n){return null!=e?e:null!=t?t:n}function n9(e){var t,n,r,i,a,s=[];if(!e._d){for(r=function(e){var t=new Date(P5.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}(e),e._w&&null==e._a[q6]&&null==e._a[X6]&&function(e){var t,n,r,i,a,s,o,l,u;t=e._w,null!=t.GG||null!=t.W||null!=t.E?(a=1,s=4,n=t9(t.GG,e._a[$6],y8(s9(),1,4).year),r=t9(t.W,1),((i=t9(t.E,1))<1||i>7)&&(l=!0)):(a=e._locale._week.dow,s=e._locale._week.doy,u=y8(s9(),a,s),n=t9(t.gg,e._a[$6],u.year),r=t9(t.w,u.week),null!=t.d?((i=t.d)<0||i>6)&&(l=!0):null!=t.e?(i=t.e+a,(t.e<0||t.e>6)&&(l=!0)):i=a);r<1||r>_8(n,a,s)?F5(e)._overflowWeeks=!0:null!=l?F5(e)._overflowWeekday=!0:(o=v8(n,r,i,a,s),e._a[$6]=o.year,e._dayOfYear=o.dayOfYear)}(e),null!=e._dayOfYear&&(a=t9(e._a[$6],r[$6]),(e._dayOfYear>h8(a)||0===e._dayOfYear)&&(F5(e)._overflowDayOfYear=!0),n=m8(a,0,e._dayOfYear),e._a[X6]=n.getUTCMonth(),e._a[q6]=n.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=s[t]=r[t];for(;t<7;t++)e._a[t]=s[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[K6]&&0===e._a[Z6]&&0===e._a[J6]&&0===e._a[Q6]&&(e._nextDay=!0,e._a[K6]=0),e._d=(e._useUTC?m8:f8).apply(null,s),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[K6]=24),e._w&&void 0!==e._w.d&&e._w.d!==i&&(F5(e).weekdayMismatch=!0)}}function r9(e){if(e._f!==P5.ISO_8601)if(e._f!==P5.RFC_2822){e._a=[],F5(e).empty=!0;var t,n,r,i,a,s,o,l=""+e._i,u=l.length,c=0;for(o=(r=u6(e._f,e._locale).match(r6)||[]).length,t=0;t<o;t++)i=r[t],(n=(l.match(F6(i,e))||[])[0])&&((a=l.substr(0,l.indexOf(n))).length>0&&F5(e).unusedInput.push(a),l=l.slice(l.indexOf(n)+n.length),c+=n.length),s6[i]?(n?F5(e).empty=!1:F5(e).unusedTokens.push(i),W6(i,n,e)):e._strict&&!n&&F5(e).unusedTokens.push(i);F5(e).charsLeftOver=u-c,l.length>0&&F5(e).unusedInput.push(l),e._a[K6]<=12&&!0===F5(e).bigHour&&e._a[K6]>0&&(F5(e).bigHour=void 0),F5(e).parsedDateParts=e._a.slice(0),F5(e).meridiem=e._meridiem,e._a[K6]=function(e,t,n){var r;if(null==n)return t;return null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?((r=e.isPM(n))&&t<12&&(t+=12),r||12!==t||(t=0),t):t}(e._locale,e._a[K6],e._meridiem),null!==(s=F5(e).era)&&(e._a[$6]=e._locale.erasConvertYear(s,e._a[$6])),n9(e),H8(e)}else e9(e);else J8(e)}function i9(e){var t=e._i,n=e._f;return e._locale=e._locale||G8(e._l),null===t||void 0===n&&""===t?G5({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),$5(t)?new Y5(H8(t)):(N5(t)?e._d=t:R5(n)?function(e){var t,n,r,i,a,s,o=!1,l=e._f.length;if(0===l)return F5(e).invalidFormat=!0,void(e._d=new Date(NaN));for(i=0;i<l;i++)a=0,s=!1,t=W5({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[i],r9(t),V5(t)&&(s=!0),a+=F5(t).charsLeftOver,a+=10*F5(t).unusedTokens.length,F5(t).score=a,o?a<r&&(r=a,n=t):(null==r||a<r||s)&&(r=a,n=t,s&&(o=!0));U5(e,n||t)}(e):n?r9(e):function(e){var t=e._i;I5(t)?e._d=new Date(P5.now()):N5(t)?e._d=new Date(t.valueOf()):"string"==typeof t?function(e){var t=q8.exec(e._i);null===t?(J8(e),!1===e._isValid&&(delete e._isValid,e9(e),!1===e._isValid&&(delete e._isValid,e._strict?e._isValid=!1:P5.createFromInputFallback(e)))):e._d=new Date(+t[1])}(e):R5(t)?(e._a=B5(t.slice(0),(function(e){return parseInt(e,10)})),n9(e)):L5(t)?function(e){if(!e._d){var t=p6(e._i),n=void 0===t.day?t.date:t.day;e._a=B5([t.year,t.month,n,t.hour,t.minute,t.second,t.millisecond],(function(e){return e&&parseInt(e,10)})),n9(e)}}(e):O5(t)?e._d=new Date(t):P5.createFromInputFallback(e)}(e),V5(e)||(e._d=null),e))}function a9(e,t,n,r,i){var a,s={};return!0!==t&&!1!==t||(r=t,t=void 0),!0!==n&&!1!==n||(r=n,n=void 0),(L5(e)&&D5(e)||R5(e)&&0===e.length)&&(e=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=i,s._l=n,s._i=e,s._f=t,s._strict=r,(a=new Y5(H8(i9(s))))._nextDay&&(a.add(1,"d"),a._nextDay=void 0),a}function s9(e,t,n,r){return a9(e,t,n,r,!1)}P5.createFromInputFallback=q5("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",(function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))})),P5.ISO_8601=function(){},P5.RFC_2822=function(){};var o9=q5("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=s9.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:G5()})),l9=q5("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=s9.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:G5()}));function u9(e,t){var n,r;if(1===t.length&&R5(t[0])&&(t=t[0]),!t.length)return s9();for(n=t[0],r=1;r<t.length;++r)t[r].isValid()&&!t[r][e](n)||(n=t[r]);return n}var c9=["year","quarter","month","week","day","hour","minute","second","millisecond"];function d9(e){var t=p6(e),n=t.year||0,r=t.quarter||0,i=t.month||0,a=t.week||t.isoWeek||0,s=t.day||0,o=t.hour||0,l=t.minute||0,u=t.second||0,c=t.millisecond||0;this._isValid=function(e){var t,n,r=!1,i=c9.length;for(t in e)if(k5(e,t)&&(-1===Y6.call(c9,t)||null!=e[t]&&isNaN(e[t])))return!1;for(n=0;n<i;++n)if(e[c9[n]]){if(r)return!1;parseFloat(e[c9[n]])!==y6(e[c9[n]])&&(r=!0)}return!0}(t),this._milliseconds=+c+1e3*u+6e4*l+1e3*o*60*60,this._days=+s+7*a,this._months=+i+3*r+12*n,this._data={},this._locale=G8(),this._bubble()}function h9(e){return e instanceof d9}function p9(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function f9(e,t){o6(e,0,0,(function(){var e=this.utcOffset(),n="+";return e<0&&(e=-e,n="-"),n+n6(~~(e/60),2)+t+n6(~~e%60,2)}))}f9("Z",":"),f9("ZZ",""),z6("Z",B6),z6("ZZ",B6),H6(["Z","ZZ"],(function(e,t,n){n._useUTC=!0,n._tzm=g9(B6,e)}));var m9=/([\+\-]|\d\d)/gi;function g9(e,t){var n,r,i=(t||"").match(e);return null===i?null:0===(r=60*(n=((i[i.length-1]||[])+"").match(m9)||["-",0,0])[1]+y6(n[2]))?0:"+"===n[0]?r:-r}function v9(e,t){var n,r;return t._isUTC?(n=t.clone(),r=($5(e)||N5(e)?e.valueOf():s9(e).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),P5.updateOffset(n,!1),n):s9(e).local()}function y9(e){return-Math.round(e._d.getTimezoneOffset())}function _9(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}P5.updateOffset=function(){};var b9=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,x9=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function w9(e,t){var n,r,i,a=e,s=null;return h9(e)?a={ms:e._milliseconds,d:e._days,M:e._months}:O5(e)||!isNaN(+e)?(a={},t?a[t]=+e:a.milliseconds=+e):(s=b9.exec(e))?(n="-"===s[1]?-1:1,a={y:0,d:y6(s[q6])*n,h:y6(s[K6])*n,m:y6(s[Z6])*n,s:y6(s[J6])*n,ms:y6(p9(1e3*s[Q6]))*n}):(s=x9.exec(e))?(n="-"===s[1]?-1:1,a={y:S9(s[2],n),M:S9(s[3],n),w:S9(s[4],n),d:S9(s[5],n),h:S9(s[6],n),m:S9(s[7],n),s:S9(s[8],n)}):null==a?a={}:"object"==typeof a&&("from"in a||"to"in a)&&(i=function(e,t){var n;if(!e.isValid()||!t.isValid())return{milliseconds:0,months:0};t=v9(t,e),e.isBefore(t)?n=C9(e,t):((n=C9(t,e)).milliseconds=-n.milliseconds,n.months=-n.months);return n}(s9(a.from),s9(a.to)),(a={}).ms=i.milliseconds,a.M=i.months),r=new d9(a),h9(e)&&k5(e,"_locale")&&(r._locale=e._locale),h9(e)&&k5(e,"_isValid")&&(r._isValid=e._isValid),r}function S9(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function C9(e,t){var n={};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function T9(e,t){return function(n,r){var i;return null===r||isNaN(+r)||(J5(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=n,n=r,r=i),M9(this,w9(n,r),e),this}}function M9(e,t,n,r){var i=t._milliseconds,a=p9(t._days),s=p9(t._months);e.isValid()&&(r=null==r||r,s&&u8(e,b6(e,"Month")+s*n),a&&x6(e,"Date",b6(e,"Date")+a*n),i&&e._d.setTime(e._d.valueOf()+i*n),r&&P5.updateOffset(e,a||s))}w9.fn=d9.prototype,w9.invalid=function(){return w9(NaN)};var E9=T9(1,"add"),A9=T9(-1,"subtract");function P9(e){return"string"==typeof e||e instanceof String}function R9(e){return $5(e)||N5(e)||P9(e)||O5(e)||function(e){var t=R5(e),n=!1;t&&(n=0===e.filter((function(t){return!O5(t)&&P9(e)})).length);return t&&n}(e)||function(e){var t,n,r=L5(e)&&!D5(e),i=!1,a=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],s=a.length;for(t=0;t<s;t+=1)n=a[t],i=i||k5(e,n);return r&&i}(e)||null==e}function L9(e,t){if(e.date()<t.date())return-L9(t,e);var n=12*(t.year()-e.year())+(t.month()-e.month()),r=e.clone().add(n,"months");return-(n+(t-r<0?(t-r)/(r-e.clone().add(n-1,"months")):(t-r)/(e.clone().add(n+1,"months")-r)))||0}function k9(e){var t;return void 0===e?this._locale._abbr:(null!=(t=G8(e))&&(this._locale=t),this)}P5.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",P5.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var D9=q5("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",(function(e){return void 0===e?this.localeData():this.locale(e)}));function I9(){return this._locale}var O9=1e3,N9=6e4,B9=36e5,U9=126227808e5;function z9(e,t){return(e%t+t)%t}function F9(e,t,n){return e<100&&e>=0?new Date(e+400,t,n)-U9:new Date(e,t,n).valueOf()}function V9(e,t,n){return e<100&&e>=0?Date.UTC(e+400,t,n)-U9:Date.UTC(e,t,n)}function G9(e,t){return t.erasAbbrRegex(e)}function H9(){var e,t,n=[],r=[],i=[],a=[],s=this.eras();for(e=0,t=s.length;e<t;++e)r.push(V6(s[e].name)),n.push(V6(s[e].abbr)),i.push(V6(s[e].narrow)),a.push(V6(s[e].name)),a.push(V6(s[e].abbr)),a.push(V6(s[e].narrow));this._erasRegex=new RegExp("^("+a.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+r.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+i.join("|")+")","i")}function j9(e,t){o6(0,[e,e.length],0,t)}function W9(e,t,n,r,i){var a;return null==e?y8(this,r,i).year:(t>(a=_8(e,r,i))&&(t=a),Y9.call(this,e,t,n,r,i))}function Y9(e,t,n,r,i){var a=v8(e,t,n,r,i),s=m8(a.year,0,a.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}o6("N",0,0,"eraAbbr"),o6("NN",0,0,"eraAbbr"),o6("NNN",0,0,"eraAbbr"),o6("NNNN",0,0,"eraName"),o6("NNNNN",0,0,"eraNarrow"),o6("y",["y",1],"yo","eraYear"),o6("y",["yy",2],0,"eraYear"),o6("y",["yyy",3],0,"eraYear"),o6("y",["yyyy",4],0,"eraYear"),z6("N",G9),z6("NN",G9),z6("NNN",G9),z6("NNNN",(function(e,t){return t.erasNameRegex(e)})),z6("NNNNN",(function(e,t){return t.erasNarrowRegex(e)})),H6(["N","NN","NNN","NNNN","NNNNN"],(function(e,t,n,r){var i=n._locale.erasParse(e,r,n._strict);i?F5(n).era=i:F5(n).invalidEra=e})),z6("y",I6),z6("yy",I6),z6("yyy",I6),z6("yyyy",I6),z6("yo",(function(e,t){return t._eraYearOrdinalRegex||I6})),H6(["y","yy","yyy","yyyy"],$6),H6(["yo"],(function(e,t,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=e.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?t[$6]=n._locale.eraYearOrdinalParse(e,i):t[$6]=parseInt(e,10)})),o6(0,["gg",2],0,(function(){return this.weekYear()%100})),o6(0,["GG",2],0,(function(){return this.isoWeekYear()%100})),j9("gggg","weekYear"),j9("ggggg","weekYear"),j9("GGGG","isoWeekYear"),j9("GGGGG","isoWeekYear"),d6("weekYear","gg"),d6("isoWeekYear","GG"),m6("weekYear",1),m6("isoWeekYear",1),z6("G",O6),z6("g",O6),z6("GG",A6,C6),z6("gg",A6,C6),z6("GGGG",k6,M6),z6("gggg",k6,M6),z6("GGGGG",D6,E6),z6("ggggg",D6,E6),j6(["gggg","ggggg","GGGG","GGGGG"],(function(e,t,n,r){t[r.substr(0,2)]=y6(e)})),j6(["gg","GG"],(function(e,t,n,r){t[r]=P5.parseTwoDigitYear(e)})),o6("Q",0,"Qo","quarter"),d6("quarter","Q"),m6("quarter",7),z6("Q",S6),H6("Q",(function(e,t){t[X6]=3*(y6(e)-1)})),o6("D",["DD",2],"Do","date"),d6("date","D"),m6("date",9),z6("D",A6),z6("DD",A6,C6),z6("Do",(function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient})),H6(["D","DD"],q6),H6("Do",(function(e,t){t[q6]=y6(e.match(A6)[0])}));var $9=_6("Date",!0);o6("DDD",["DDDD",3],"DDDo","dayOfYear"),d6("dayOfYear","DDD"),m6("dayOfYear",4),z6("DDD",L6),z6("DDDD",T6),H6(["DDD","DDDD"],(function(e,t,n){n._dayOfYear=y6(e)})),o6("m",["mm",2],0,"minute"),d6("minute","m"),m6("minute",14),z6("m",A6),z6("mm",A6,C6),H6(["m","mm"],Z6);var X9=_6("Minutes",!1);o6("s",["ss",2],0,"second"),d6("second","s"),m6("second",15),z6("s",A6),z6("ss",A6,C6),H6(["s","ss"],J6);var q9,K9,Z9=_6("Seconds",!1);for(o6("S",0,0,(function(){return~~(this.millisecond()/100)})),o6(0,["SS",2],0,(function(){return~~(this.millisecond()/10)})),o6(0,["SSS",3],0,"millisecond"),o6(0,["SSSS",4],0,(function(){return 10*this.millisecond()})),o6(0,["SSSSS",5],0,(function(){return 100*this.millisecond()})),o6(0,["SSSSSS",6],0,(function(){return 1e3*this.millisecond()})),o6(0,["SSSSSSS",7],0,(function(){return 1e4*this.millisecond()})),o6(0,["SSSSSSSS",8],0,(function(){return 1e5*this.millisecond()})),o6(0,["SSSSSSSSS",9],0,(function(){return 1e6*this.millisecond()})),d6("millisecond","ms"),m6("millisecond",16),z6("S",L6,S6),z6("SS",L6,C6),z6("SSS",L6,T6),q9="SSSS";q9.length<=9;q9+="S")z6(q9,I6);function J9(e,t){t[Q6]=y6(1e3*("0."+e))}for(q9="S";q9.length<=9;q9+="S")H6(q9,J9);K9=_6("Milliseconds",!1),o6("z",0,0,"zoneAbbr"),o6("zz",0,0,"zoneName");var Q9=Y5.prototype;function e7(e){return e}Q9.add=E9,Q9.calendar=function(e,t){1===arguments.length&&(arguments[0]?R9(arguments[0])?(e=arguments[0],t=void 0):function(e){var t,n=L5(e)&&!D5(e),r=!1,i=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"];for(t=0;t<i.length;t+=1)r=r||k5(e,i[t]);return n&&r}(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var n=e||s9(),r=v9(n,this).startOf("day"),i=P5.calendarFormat(this,r)||"sameElse",a=t&&(Q5(t[i])?t[i].call(this,n):t[i]);return this.format(a||this.localeData().calendar(i,this,s9(n)))},Q9.clone=function(){return new Y5(this)},Q9.diff=function(e,t,n){var r,i,a;if(!this.isValid())return NaN;if(!(r=v9(e,this)).isValid())return NaN;switch(i=6e4*(r.utcOffset()-this.utcOffset()),t=h6(t)){case"year":a=L9(this,r)/12;break;case"month":a=L9(this,r);break;case"quarter":a=L9(this,r)/3;break;case"second":a=(this-r)/1e3;break;case"minute":a=(this-r)/6e4;break;case"hour":a=(this-r)/36e5;break;case"day":a=(this-r-i)/864e5;break;case"week":a=(this-r-i)/6048e5;break;default:a=this-r}return n?a:v6(a)},Q9.endOf=function(e){var t,n;if(void 0===(e=h6(e))||"millisecond"===e||!this.isValid())return this;switch(n=this._isUTC?V9:F9,e){case"year":t=n(this.year()+1,0,1)-1;break;case"quarter":t=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=n(this.year(),this.month()+1,1)-1;break;case"week":t=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=B9-z9(t+(this._isUTC?0:this.utcOffset()*N9),B9)-1;break;case"minute":t=this._d.valueOf(),t+=N9-z9(t,N9)-1;break;case"second":t=this._d.valueOf(),t+=O9-z9(t,O9)-1}return this._d.setTime(t),P5.updateOffset(this,!0),this},Q9.format=function(e){e||(e=this.isUtc()?P5.defaultFormatUtc:P5.defaultFormat);var t=l6(this,e);return this.localeData().postformat(t)},Q9.from=function(e,t){return this.isValid()&&($5(e)&&e.isValid()||s9(e).isValid())?w9({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},Q9.fromNow=function(e){return this.from(s9(),e)},Q9.to=function(e,t){return this.isValid()&&($5(e)&&e.isValid()||s9(e).isValid())?w9({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},Q9.toNow=function(e){return this.to(s9(),e)},Q9.get=function(e){return Q5(this[e=h6(e)])?this[e]():this},Q9.invalidAt=function(){return F5(this).overflow},Q9.isAfter=function(e,t){var n=$5(e)?e:s9(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=h6(t)||"millisecond")?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(t).valueOf())},Q9.isBefore=function(e,t){var n=$5(e)?e:s9(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=h6(t)||"millisecond")?this.valueOf()<n.valueOf():this.clone().endOf(t).valueOf()<n.valueOf())},Q9.isBetween=function(e,t,n,r){var i=$5(e)?e:s9(e),a=$5(t)?t:s9(t);return!!(this.isValid()&&i.isValid()&&a.isValid())&&(("("===(r=r||"()")[0]?this.isAfter(i,n):!this.isBefore(i,n))&&(")"===r[1]?this.isBefore(a,n):!this.isAfter(a,n)))},Q9.isSame=function(e,t){var n,r=$5(e)?e:s9(e);return!(!this.isValid()||!r.isValid())&&("millisecond"===(t=h6(t)||"millisecond")?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()))},Q9.isSameOrAfter=function(e,t){return this.isSame(e,t)||this.isAfter(e,t)},Q9.isSameOrBefore=function(e,t){return this.isSame(e,t)||this.isBefore(e,t)},Q9.isValid=function(){return V5(this)},Q9.lang=D9,Q9.locale=k9,Q9.localeData=I9,Q9.max=l9,Q9.min=o9,Q9.parsingFlags=function(){return U5({},F5(this))},Q9.set=function(e,t){if("object"==typeof e){var n,r=function(e){var t,n=[];for(t in e)k5(e,t)&&n.push({unit:t,priority:f6[t]});return n.sort((function(e,t){return e.priority-t.priority})),n}(e=p6(e)),i=r.length;for(n=0;n<i;n++)this[r[n].unit](e[r[n].unit])}else if(Q5(this[e=h6(e)]))return this[e](t);return this},Q9.startOf=function(e){var t,n;if(void 0===(e=h6(e))||"millisecond"===e||!this.isValid())return this;switch(n=this._isUTC?V9:F9,e){case"year":t=n(this.year(),0,1);break;case"quarter":t=n(this.year(),this.month()-this.month()%3,1);break;case"month":t=n(this.year(),this.month(),1);break;case"week":t=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=n(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=z9(t+(this._isUTC?0:this.utcOffset()*N9),B9);break;case"minute":t=this._d.valueOf(),t-=z9(t,N9);break;case"second":t=this._d.valueOf(),t-=z9(t,O9)}return this._d.setTime(t),P5.updateOffset(this,!0),this},Q9.subtract=A9,Q9.toArray=function(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]},Q9.toObject=function(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}},Q9.toDate=function(){return new Date(this.valueOf())},Q9.toISOString=function(e){if(!this.isValid())return null;var t=!0!==e,n=t?this.clone().utc():this;return n.year()<0||n.year()>9999?l6(n,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Q5(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",l6(n,"Z")):l6(n,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},Q9.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e,t,n,r="moment",i="";return this.isLocal()||(r=0===this.utcOffset()?"moment.utc":"moment.parseZone",i="Z"),e="["+r+'("]',t=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY","-MM-DD[T]HH:mm:ss.SSS",n=i+'[")]',this.format(e+t+"-MM-DD[T]HH:mm:ss.SSS"+n)},"undefined"!=typeof Symbol&&null!=Symbol.for&&(Q9[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),Q9.toJSON=function(){return this.isValid()?this.toISOString():null},Q9.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},Q9.unix=function(){return Math.floor(this.valueOf()/1e3)},Q9.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},Q9.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},Q9.eraName=function(){var e,t,n,r=this.localeData().eras();for(e=0,t=r.length;e<t;++e){if(n=this.clone().startOf("day").valueOf(),r[e].since<=n&&n<=r[e].until)return r[e].name;if(r[e].until<=n&&n<=r[e].since)return r[e].name}return""},Q9.eraNarrow=function(){var e,t,n,r=this.localeData().eras();for(e=0,t=r.length;e<t;++e){if(n=this.clone().startOf("day").valueOf(),r[e].since<=n&&n<=r[e].until)return r[e].narrow;if(r[e].until<=n&&n<=r[e].since)return r[e].narrow}return""},Q9.eraAbbr=function(){var e,t,n,r=this.localeData().eras();for(e=0,t=r.length;e<t;++e){if(n=this.clone().startOf("day").valueOf(),r[e].since<=n&&n<=r[e].until)return r[e].abbr;if(r[e].until<=n&&n<=r[e].since)return r[e].abbr}return""},Q9.eraYear=function(){var e,t,n,r,i=this.localeData().eras();for(e=0,t=i.length;e<t;++e)if(n=i[e].since<=i[e].until?1:-1,r=this.clone().startOf("day").valueOf(),i[e].since<=r&&r<=i[e].until||i[e].until<=r&&r<=i[e].since)return(this.year()-P5(i[e].since).year())*n+i[e].offset;return this.year()},Q9.year=p8,Q9.isLeapYear=function(){return g6(this.year())},Q9.weekYear=function(e){return W9.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},Q9.isoWeekYear=function(e){return W9.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)},Q9.quarter=Q9.quarters=function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},Q9.month=c8,Q9.daysInMonth=function(){return n8(this.year(),this.month())},Q9.week=Q9.weeks=function(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")},Q9.isoWeek=Q9.isoWeeks=function(e){var t=y8(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")},Q9.weeksInYear=function(){var e=this.localeData()._week;return _8(this.year(),e.dow,e.doy)},Q9.weeksInWeekYear=function(){var e=this.localeData()._week;return _8(this.weekYear(),e.dow,e.doy)},Q9.isoWeeksInYear=function(){return _8(this.year(),1,4)},Q9.isoWeeksInISOWeekYear=function(){return _8(this.isoWeekYear(),1,4)},Q9.date=$9,Q9.day=Q9.days=function(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=function(e,t){return"string"!=typeof e?e:isNaN(e)?"number"==typeof(e=t.weekdaysParse(e))?e:null:parseInt(e,10)}(e,this.localeData()),this.add(e-t,"d")):t},Q9.weekday=function(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")},Q9.isoWeekday=function(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=function(e,t){return"string"==typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7},Q9.dayOfYear=function(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")},Q9.hour=Q9.hours=k8,Q9.minute=Q9.minutes=X9,Q9.second=Q9.seconds=Z9,Q9.millisecond=Q9.milliseconds=K9,Q9.utcOffset=function(e,t,n){var r,i=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"==typeof e){if(null===(e=g9(B6,e)))return this}else Math.abs(e)<16&&!n&&(e*=60);return!this._isUTC&&t&&(r=y9(this)),this._offset=e,this._isUTC=!0,null!=r&&this.add(r,"m"),i!==e&&(!t||this._changeInProgress?M9(this,w9(e-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,P5.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?i:y9(this)},Q9.utc=function(e){return this.utcOffset(0,e)},Q9.local=function(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(y9(this),"m")),this},Q9.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=g9(N6,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this},Q9.hasAlignedHourOffset=function(e){return!!this.isValid()&&(e=e?s9(e).utcOffset():0,(this.utcOffset()-e)%60==0)},Q9.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},Q9.isLocal=function(){return!!this.isValid()&&!this._isUTC},Q9.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},Q9.isUtc=_9,Q9.isUTC=_9,Q9.zoneAbbr=function(){return this._isUTC?"UTC":""},Q9.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},Q9.dates=q5("dates accessor is deprecated. Use date instead.",$9),Q9.months=q5("months accessor is deprecated. Use month instead",c8),Q9.years=q5("years accessor is deprecated. Use year instead",p8),Q9.zone=q5("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",(function(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()})),Q9.isDSTShifted=q5("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",(function(){if(!I5(this._isDSTShifted))return this._isDSTShifted;var e,t={};return W5(t,this),(t=i9(t))._a?(e=t._isUTC?z5(t._a):s9(t._a),this._isDSTShifted=this.isValid()&&function(e,t,n){var r,i=Math.min(e.length,t.length),a=Math.abs(e.length-t.length),s=0;for(r=0;r<i;r++)(n&&e[r]!==t[r]||!n&&y6(e[r])!==y6(t[r]))&&s++;return s+a}(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}));var t7=t6.prototype;function n7(e,t,n,r){var i=G8(),a=z5().set(r,t);return i[n](a,e)}function r7(e,t,n){if(O5(e)&&(t=e,e=void 0),e=e||"",null!=t)return n7(e,t,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=n7(e,r,n,"month");return i}function i7(e,t,n,r){"boolean"==typeof e?(O5(t)&&(n=t,t=void 0),t=t||""):(n=t=e,e=!1,O5(t)&&(n=t,t=void 0),t=t||"");var i,a=G8(),s=e?a._week.dow:0,o=[];if(null!=n)return n7(t,(n+s)%7,r,"day");for(i=0;i<7;i++)o[i]=n7(t,(i+s)%7,r,"day");return o}t7.calendar=function(e,t,n){var r=this._calendar[e]||this._calendar.sameElse;return Q5(r)?r.call(t,n):r},t7.longDateFormat=function(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.match(r6).map((function(e){return"MMMM"===e||"MM"===e||"DD"===e||"dddd"===e?e.slice(1):e})).join(""),this._longDateFormat[e])},t7.invalidDate=function(){return this._invalidDate},t7.ordinal=function(e){return this._ordinal.replace("%d",e)},t7.preparse=e7,t7.postformat=e7,t7.relativeTime=function(e,t,n,r){var i=this._relativeTime[n];return Q5(i)?i(e,t,n,r):i.replace(/%d/i,e)},t7.pastFuture=function(e,t){var n=this._relativeTime[e>0?"future":"past"];return Q5(n)?n(t):n.replace(/%s/i,t)},t7.set=function(e){var t,n;for(n in e)k5(e,n)&&(Q5(t=e[n])?this[n]=t:this["_"+n]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},t7.eras=function(e,t){var n,r,i,a=this._eras||G8("en")._eras;for(n=0,r=a.length;n<r;++n){if("string"==typeof a[n].since)i=P5(a[n].since).startOf("day"),a[n].since=i.valueOf();switch(typeof a[n].until){case"undefined":a[n].until=1/0;break;case"string":i=P5(a[n].until).startOf("day").valueOf(),a[n].until=i.valueOf()}}return a},t7.erasParse=function(e,t,n){var r,i,a,s,o,l=this.eras();for(e=e.toUpperCase(),r=0,i=l.length;r<i;++r)if(a=l[r].name.toUpperCase(),s=l[r].abbr.toUpperCase(),o=l[r].narrow.toUpperCase(),n)switch(t){case"N":case"NN":case"NNN":if(s===e)return l[r];break;case"NNNN":if(a===e)return l[r];break;case"NNNNN":if(o===e)return l[r]}else if([a,s,o].indexOf(e)>=0)return l[r]},t7.erasConvertYear=function(e,t){var n=e.since<=e.until?1:-1;return void 0===t?P5(e.since).year():P5(e.since).year()+(t-e.offset)*n},t7.erasAbbrRegex=function(e){return k5(this,"_erasAbbrRegex")||H9.call(this),e?this._erasAbbrRegex:this._erasRegex},t7.erasNameRegex=function(e){return k5(this,"_erasNameRegex")||H9.call(this),e?this._erasNameRegex:this._erasRegex},t7.erasNarrowRegex=function(e){return k5(this,"_erasNarrowRegex")||H9.call(this),e?this._erasNarrowRegex:this._erasRegex},t7.months=function(e,t){return e?R5(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||a8).test(t)?"format":"standalone"][e.month()]:R5(this._months)?this._months:this._months.standalone},t7.monthsShort=function(e,t){return e?R5(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[a8.test(t)?"format":"standalone"][e.month()]:R5(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},t7.monthsParse=function(e,t,n){var r,i,a;if(this._monthsParseExact)return l8.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=z5([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),n||this._monthsParse[r]||(a="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(a.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[r].test(e))return r;if(n&&"MMM"===t&&this._shortMonthsParse[r].test(e))return r;if(!n&&this._monthsParse[r].test(e))return r}},t7.monthsRegex=function(e){return this._monthsParseExact?(k5(this,"_monthsRegex")||d8.call(this),e?this._monthsStrictRegex:this._monthsRegex):(k5(this,"_monthsRegex")||(this._monthsRegex=o8),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)},t7.monthsShortRegex=function(e){return this._monthsParseExact?(k5(this,"_monthsRegex")||d8.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(k5(this,"_monthsShortRegex")||(this._monthsShortRegex=s8),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)},t7.week=function(e){return y8(e,this._week.dow,this._week.doy).week},t7.firstDayOfYear=function(){return this._week.doy},t7.firstDayOfWeek=function(){return this._week.dow},t7.weekdays=function(e,t){var n=R5(this._weekdays)?this._weekdays:this._weekdays[e&&!0!==e&&this._weekdays.isFormat.test(t)?"format":"standalone"];return!0===e?b8(n,this._week.dow):e?n[e.day()]:n},t7.weekdaysMin=function(e){return!0===e?b8(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin},t7.weekdaysShort=function(e){return!0===e?b8(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort},t7.weekdaysParse=function(e,t,n){var r,i,a;if(this._weekdaysParseExact)return E8.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=z5([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(a="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(a.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[r].test(e))return r;if(n&&"ddd"===t&&this._shortWeekdaysParse[r].test(e))return r;if(n&&"dd"===t&&this._minWeekdaysParse[r].test(e))return r;if(!n&&this._weekdaysParse[r].test(e))return r}},t7.weekdaysRegex=function(e){return this._weekdaysParseExact?(k5(this,"_weekdaysRegex")||A8.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(k5(this,"_weekdaysRegex")||(this._weekdaysRegex=C8),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)},t7.weekdaysShortRegex=function(e){return this._weekdaysParseExact?(k5(this,"_weekdaysRegex")||A8.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(k5(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=T8),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},t7.weekdaysMinRegex=function(e){return this._weekdaysParseExact?(k5(this,"_weekdaysRegex")||A8.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(k5(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=M8),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},t7.isPM=function(e){return"p"===(e+"").toLowerCase().charAt(0)},t7.meridiem=function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},F8("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===y6(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),P5.lang=q5("moment.lang is deprecated. Use moment.locale instead.",F8),P5.langData=q5("moment.langData is deprecated. Use moment.localeData instead.",G8);var a7=Math.abs;function s7(e,t,n,r){var i=w9(t,n);return e._milliseconds+=r*i._milliseconds,e._days+=r*i._days,e._months+=r*i._months,e._bubble()}function o7(e){return e<0?Math.floor(e):Math.ceil(e)}function l7(e){return 4800*e/146097}function u7(e){return 146097*e/4800}function c7(e){return function(){return this.as(e)}}var d7=c7("ms"),h7=c7("s"),p7=c7("m"),f7=c7("h"),m7=c7("d"),g7=c7("w"),v7=c7("M"),y7=c7("Q"),_7=c7("y");function b7(e){return function(){return this.isValid()?this._data[e]:NaN}}var x7=b7("milliseconds"),w7=b7("seconds"),S7=b7("minutes"),C7=b7("hours"),T7=b7("days"),M7=b7("months"),E7=b7("years");var A7=Math.round,P7={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function R7(e,t,n,r,i){return i.relativeTime(t||1,!!n,e,r)}var L7=Math.abs;function k7(e){return(e>0)-(e<0)||+e}function D7(){if(!this.isValid())return this.localeData().invalidDate();var e,t,n,r,i,a,s,o,l=L7(this._milliseconds)/1e3,u=L7(this._days),c=L7(this._months),d=this.asSeconds();return d?(e=v6(l/60),t=v6(e/60),l%=60,e%=60,n=v6(c/12),c%=12,r=l?l.toFixed(3).replace(/\.?0+$/,""):"",i=d<0?"-":"",a=k7(this._months)!==k7(d)?"-":"",s=k7(this._days)!==k7(d)?"-":"",o=k7(this._milliseconds)!==k7(d)?"-":"",i+"P"+(n?a+n+"Y":"")+(c?a+c+"M":"")+(u?s+u+"D":"")+(t||e||l?"T":"")+(t?o+t+"H":"")+(e?o+e+"M":"")+(l?o+r+"S":"")):"P0D"}var I7=d9.prototype;I7.isValid=function(){return this._isValid},I7.abs=function(){var e=this._data;return this._milliseconds=a7(this._milliseconds),this._days=a7(this._days),this._months=a7(this._months),e.milliseconds=a7(e.milliseconds),e.seconds=a7(e.seconds),e.minutes=a7(e.minutes),e.hours=a7(e.hours),e.months=a7(e.months),e.years=a7(e.years),this},I7.add=function(e,t){return s7(this,e,t,1)},I7.subtract=function(e,t){return s7(this,e,t,-1)},I7.as=function(e){if(!this.isValid())return NaN;var t,n,r=this._milliseconds;if("month"===(e=h6(e))||"quarter"===e||"year"===e)switch(t=this._days+r/864e5,n=this._months+l7(t),e){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(t=this._days+Math.round(u7(this._months)),e){case"week":return t/7+r/6048e5;case"day":return t+r/864e5;case"hour":return 24*t+r/36e5;case"minute":return 1440*t+r/6e4;case"second":return 86400*t+r/1e3;case"millisecond":return Math.floor(864e5*t)+r;default:throw new Error("Unknown unit "+e)}},I7.asMilliseconds=d7,I7.asSeconds=h7,I7.asMinutes=p7,I7.asHours=f7,I7.asDays=m7,I7.asWeeks=g7,I7.asMonths=v7,I7.asQuarters=y7,I7.asYears=_7,I7.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*y6(this._months/12):NaN},I7._bubble=function(){var e,t,n,r,i,a=this._milliseconds,s=this._days,o=this._months,l=this._data;return a>=0&&s>=0&&o>=0||a<=0&&s<=0&&o<=0||(a+=864e5*o7(u7(o)+s),s=0,o=0),l.milliseconds=a%1e3,e=v6(a/1e3),l.seconds=e%60,t=v6(e/60),l.minutes=t%60,n=v6(t/60),l.hours=n%24,s+=v6(n/24),o+=i=v6(l7(s)),s-=o7(u7(i)),r=v6(o/12),o%=12,l.days=s,l.months=o,l.years=r,this},I7.clone=function(){return w9(this)},I7.get=function(e){return e=h6(e),this.isValid()?this[e+"s"]():NaN},I7.milliseconds=x7,I7.seconds=w7,I7.minutes=S7,I7.hours=C7,I7.days=T7,I7.weeks=function(){return v6(this.days()/7)},I7.months=M7,I7.years=E7,I7.humanize=function(e,t){if(!this.isValid())return this.localeData().invalidDate();var n,r,i=!1,a=P7;return"object"==typeof e&&(t=e,e=!1),"boolean"==typeof e&&(i=e),"object"==typeof t&&(a=Object.assign({},P7,t),null!=t.s&&null==t.ss&&(a.ss=t.s-1)),r=function(e,t,n,r){var i=w9(e).abs(),a=A7(i.as("s")),s=A7(i.as("m")),o=A7(i.as("h")),l=A7(i.as("d")),u=A7(i.as("M")),c=A7(i.as("w")),d=A7(i.as("y")),h=a<=n.ss&&["s",a]||a<n.s&&["ss",a]||s<=1&&["m"]||s<n.m&&["mm",s]||o<=1&&["h"]||o<n.h&&["hh",o]||l<=1&&["d"]||l<n.d&&["dd",l];return null!=n.w&&(h=h||c<=1&&["w"]||c<n.w&&["ww",c]),(h=h||u<=1&&["M"]||u<n.M&&["MM",u]||d<=1&&["y"]||["yy",d])[2]=t,h[3]=+e>0,h[4]=r,R7.apply(null,h)}(this,!i,a,n=this.localeData()),i&&(r=n.pastFuture(+this,r)),n.postformat(r)},I7.toISOString=D7,I7.toString=D7,I7.toJSON=D7,I7.locale=k9,I7.localeData=I9,I7.toIsoString=q5("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",D7),I7.lang=D9,o6("X",0,0,"unix"),o6("x",0,0,"valueOf"),z6("x",O6),z6("X",/[+-]?\d+(\.\d{1,3})?/),H6("X",(function(e,t,n){n._d=new Date(1e3*parseFloat(e))})),H6("x",(function(e,t,n){n._d=new Date(y6(e))})),
//! moment.js
P5.version="2.29.4",E5=s9,P5.fn=Q9,P5.min=function(){return u9("isBefore",[].slice.call(arguments,0))},P5.max=function(){return u9("isAfter",[].slice.call(arguments,0))},P5.now=function(){return Date.now?Date.now():+new Date},P5.utc=z5,P5.unix=function(e){return s9(1e3*e)},P5.months=function(e,t){return r7(e,t,"months")},P5.isDate=N5,P5.locale=F8,P5.invalid=G5,P5.duration=w9,P5.isMoment=$5,P5.weekdays=function(e,t,n){return i7(e,t,n,"weekdays")},P5.parseZone=function(){return s9.apply(null,arguments).parseZone()},P5.localeData=G8,P5.isDuration=h9,P5.monthsShort=function(e,t){return r7(e,t,"monthsShort")},P5.weekdaysMin=function(e,t,n){return i7(e,t,n,"weekdaysMin")},P5.defineLocale=V8,P5.updateLocale=function(e,t){if(null!=t){var n,r,i=I8;null!=O8[e]&&null!=O8[e].parentLocale?O8[e].set(e6(O8[e]._config,t)):(null!=(r=z8(e))&&(i=r._config),t=e6(i,t),null==r&&(t.abbr=e),(n=new t6(t)).parentLocale=O8[e],O8[e]=n),F8(e)}else null!=O8[e]&&(null!=O8[e].parentLocale?(O8[e]=O8[e].parentLocale,e===F8()&&F8(e)):null!=O8[e]&&delete O8[e]);return O8[e]},P5.locales=function(){return K5(O8)},P5.weekdaysShort=function(e,t,n){return i7(e,t,n,"weekdaysShort")},P5.normalizeUnits=h6,P5.relativeTimeRounding=function(e){return void 0===e?A7:"function"==typeof e&&(A7=e,!0)},P5.relativeTimeThreshold=function(e,t){return void 0!==P7[e]&&(void 0===t?P7[e]:(P7[e]=t,"s"===e&&(P7.ss=t-1),!0))},P5.calendarFormat=function(e,t){var n=e.diff(t,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"},P5.prototype=Q9,P5.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},
//! moment.js locale configuration
P5.defineLocale("zh-cn",{months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日Ah点mm分",LLLL:"YYYY年M月D日ddddAh点mm分",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},meridiemParse:/凌晨|早上|上午|中午|下午|晚上/,meridiemHour:function(e,t){return 12===e&&(e=0),"凌晨"===t||"早上"===t||"上午"===t?e:"下午"===t||"晚上"===t?e+12:e>=11?e:e+12},meridiem:function(e,t,n){var r=100*e+t;return r<600?"凌晨":r<900?"早上":r<1130?"上午":r<1230?"中午":r<1800?"下午":"晚上"},calendar:{sameDay:"[今天]LT",nextDay:"[明天]LT",nextWeek:function(e){return e.week()!==this.week()?"[下]dddLT":"[本]dddLT"},lastDay:"[昨天]LT",lastWeek:function(e){return this.week()!==e.week()?"[上]dddLT":"[本]dddLT"},sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(日|月|周)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"日";case"M":return e+"月";case"w":case"W":return e+"周";default:return e}},relativeTime:{future:"%s后",past:"%s前",s:"几秒",ss:"%d 秒",m:"1 分钟",mm:"%d 分钟",h:"1 小时",hh:"%d 小时",d:"1 天",dd:"%d 天",w:"1 周",ww:"%d 周",M:"1 个月",MM:"%d 个月",y:"1 年",yy:"%d 年"},week:{dow:1,doy:4}});var O7,N7,B7={};O7="undefined"!=typeof window?window:YS,N7=function(e,t){var n=[],r=Object.getPrototypeOf,i=n.slice,a=n.flat?function(e){return n.flat.call(e)}:function(e){return n.concat.apply([],e)},s=n.push,o=n.indexOf,l={},u=l.toString,c=l.hasOwnProperty,d=c.toString,h=d.call(Object),p={},f=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item},m=function(e){return null!=e&&e===e.window},g=e.document,v={type:!0,src:!0,nonce:!0,noModule:!0};function y(e,t,n){var r,i,a=(n=n||g).createElement("script");if(a.text=e,t)for(r in v)(i=t[r]||t.getAttribute&&t.getAttribute(r))&&a.setAttribute(r,i);n.head.appendChild(a).parentNode.removeChild(a)}function _(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[u.call(e)]||"object":typeof e}var b="3.7.0",x=/HTML$/i,w=function(e,t){return new w.fn.init(e,t)};function S(e){var t=!!e&&"length"in e&&e.length,n=_(e);return!f(e)&&!m(e)&&("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e)}function C(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}w.fn=w.prototype={jquery:b,constructor:w,length:0,toArray:function(){return i.call(this)},get:function(e){return null==e?i.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=w.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return w.each(this,e)},map:function(e){return this.pushStack(w.map(this,(function(t,n){return e.call(t,n,t)})))},slice:function(){return this.pushStack(i.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(w.grep(this,(function(e,t){return(t+1)%2})))},odd:function(){return this.pushStack(w.grep(this,(function(e,t){return t%2})))},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:s,sort:n.sort,splice:n.splice},w.extend=w.fn.extend=function(){var e,t,n,r,i,a,s=arguments[0]||{},o=1,l=arguments.length,u=!1;for("boolean"==typeof s&&(u=s,s=arguments[o]||{},o++),"object"==typeof s||f(s)||(s={}),o===l&&(s=this,o--);o<l;o++)if(null!=(e=arguments[o]))for(t in e)r=e[t],"__proto__"!==t&&s!==r&&(u&&r&&(w.isPlainObject(r)||(i=Array.isArray(r)))?(n=s[t],a=i&&!Array.isArray(n)?[]:i||w.isPlainObject(n)?n:{},i=!1,s[t]=w.extend(u,a,r)):void 0!==r&&(s[t]=r));return s},w.extend({expando:"jQuery"+(b+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==u.call(e)||(t=r(e))&&("function"!=typeof(n=c.call(t,"constructor")&&t.constructor)||d.call(n)!==h))},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){y(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,r=0;if(S(e))for(n=e.length;r<n&&!1!==t.call(e[r],r,e[r]);r++);else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},text:function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i)return e.textContent;if(3===i||4===i)return e.nodeValue}else for(;t=e[r++];)n+=w.text(t);return n},makeArray:function(e,t){var n=t||[];return null!=e&&(S(Object(e))?w.merge(n,"string"==typeof e?[e]:e):s.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:o.call(t,e,n)},isXMLDoc:function(e){var t=e&&e.namespaceURI,n=e&&(e.ownerDocument||e).documentElement;return!x.test(t||n&&n.nodeName||"HTML")},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,a=e.length,s=!n;i<a;i++)!t(e[i],i)!==s&&r.push(e[i]);return r},map:function(e,t,n){var r,i,s=0,o=[];if(S(e))for(r=e.length;s<r;s++)null!=(i=t(e[s],s,n))&&o.push(i);else for(s in e)null!=(i=t(e[s],s,n))&&o.push(i);return a(o)},guid:1,support:p}),"function"==typeof Symbol&&(w.fn[Symbol.iterator]=n[Symbol.iterator]),w.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(e,t){l["[object "+t+"]"]=t.toLowerCase()}));var T=n.pop,M=n.sort,E=n.splice,A="[\\x20\\t\\r\\n\\f]",P=new RegExp("^"+A+"+|((?:^|[^\\\\])(?:\\\\.)*)"+A+"+$","g");w.contains=function(e,t){var n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(e.contains?e.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))};var R=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function L(e,t){return t?"\0"===e?"�":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e}w.escapeSelector=function(e){return(e+"").replace(R,L)};var k=g,D=s;!function(){var t,r,a,s,l,u,d,h,f,m,g=D,v=w.expando,y=0,_=0,b=ee(),x=ee(),S=ee(),R=ee(),L=function(e,t){return e===t&&(l=!0),0},I="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",O="(?:\\\\[\\da-fA-F]{1,6}"+A+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",N="\\["+A+"*("+O+")(?:"+A+"*([*^$|!~]?=)"+A+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+O+"))|)"+A+"*\\]",B=":("+O+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+N+")*)|.*)\\)|)",U=new RegExp(A+"+","g"),z=new RegExp("^"+A+"*,"+A+"*"),F=new RegExp("^"+A+"*([>+~]|"+A+")"+A+"*"),V=new RegExp(A+"|>"),G=new RegExp(B),H=new RegExp("^"+O+"$"),j={ID:new RegExp("^#("+O+")"),CLASS:new RegExp("^\\.("+O+")"),TAG:new RegExp("^("+O+"|[*])"),ATTR:new RegExp("^"+N),PSEUDO:new RegExp("^"+B),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+A+"*(even|odd|(([+-]|)(\\d*)n|)"+A+"*(?:([+-]|)"+A+"*(\\d+)|))"+A+"*\\)|)","i"),bool:new RegExp("^(?:"+I+")$","i"),needsContext:new RegExp("^"+A+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+A+"*((?:-\\d)?\\d*)"+A+"*\\)|)(?=[^-]|$)","i")},W=/^(?:input|select|textarea|button)$/i,Y=/^h\d$/i,$=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,X=/[+~]/,q=new RegExp("\\\\[\\da-fA-F]{1,6}"+A+"?|\\\\([^\\r\\n\\f])","g"),K=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},Z=function(){le()},J=he((function(e){return!0===e.disabled&&C(e,"fieldset")}),{dir:"parentNode",next:"legend"});try{g.apply(n=i.call(k.childNodes),k.childNodes),n[k.childNodes.length].nodeType}catch(zA){g={apply:function(e,t){D.apply(e,i.call(t))},call:function(e){D.apply(e,i.call(arguments,1))}}}function Q(e,t,n,r){var i,a,s,o,l,c,d,m=t&&t.ownerDocument,y=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==y&&9!==y&&11!==y)return n;if(!r&&(le(t),t=t||u,h)){if(11!==y&&(l=$.exec(e)))if(i=l[1]){if(9===y){if(!(s=t.getElementById(i)))return n;if(s.id===i)return g.call(n,s),n}else if(m&&(s=m.getElementById(i))&&Q.contains(t,s)&&s.id===i)return g.call(n,s),n}else{if(l[2])return g.apply(n,t.getElementsByTagName(e)),n;if((i=l[3])&&t.getElementsByClassName)return g.apply(n,t.getElementsByClassName(i)),n}if(!(R[e+" "]||f&&f.test(e))){if(d=e,m=t,1===y&&(V.test(e)||F.test(e))){for((m=X.test(e)&&oe(t.parentNode)||t)==t&&p.scope||((o=t.getAttribute("id"))?o=w.escapeSelector(o):t.setAttribute("id",o=v)),a=(c=ce(e)).length;a--;)c[a]=(o?"#"+o:":scope")+" "+de(c[a]);d=c.join(",")}try{return g.apply(n,m.querySelectorAll(d)),n}catch(_){R(e,!0)}finally{o===v&&t.removeAttribute("id")}}}return ye(e.replace(P,"$1"),t,n,r)}function ee(){var e=[];return function t(n,i){return e.push(n+" ")>r.cacheLength&&delete t[e.shift()],t[n+" "]=i}}function te(e){return e[v]=!0,e}function ne(e){var t=u.createElement("fieldset");try{return!!e(t)}catch(zA){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function re(e){return function(t){return C(t,"input")&&t.type===e}}function ie(e){return function(t){return(C(t,"input")||C(t,"button"))&&t.type===e}}function ae(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&J(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function se(e){return te((function(t){return t=+t,te((function(n,r){for(var i,a=e([],n.length,t),s=a.length;s--;)n[i=a[s]]&&(n[i]=!(r[i]=n[i]))}))}))}function oe(e){return e&&void 0!==e.getElementsByTagName&&e}function le(e){var t,n=e?e.ownerDocument||e:k;return n!=u&&9===n.nodeType&&n.documentElement?(d=(u=n).documentElement,h=!w.isXMLDoc(u),m=d.matches||d.webkitMatchesSelector||d.msMatchesSelector,k!=u&&(t=u.defaultView)&&t.top!==t&&t.addEventListener("unload",Z),p.getById=ne((function(e){return d.appendChild(e).id=w.expando,!u.getElementsByName||!u.getElementsByName(w.expando).length})),p.disconnectedMatch=ne((function(e){return m.call(e,"*")})),p.scope=ne((function(){return u.querySelectorAll(":scope")})),p.cssHas=ne((function(){try{return u.querySelector(":has(*,:jqfake)"),!1}catch(zA){return!0}})),p.getById?(r.filter.ID=function(e){var t=e.replace(q,K);return function(e){return e.getAttribute("id")===t}},r.find.ID=function(e,t){if(void 0!==t.getElementById&&h){var n=t.getElementById(e);return n?[n]:[]}}):(r.filter.ID=function(e){var t=e.replace(q,K);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},r.find.ID=function(e,t){if(void 0!==t.getElementById&&h){var n,r,i,a=t.getElementById(e);if(a){if((n=a.getAttributeNode("id"))&&n.value===e)return[a];for(i=t.getElementsByName(e),r=0;a=i[r++];)if((n=a.getAttributeNode("id"))&&n.value===e)return[a]}return[]}}),r.find.TAG=function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):t.querySelectorAll(e)},r.find.CLASS=function(e,t){if(void 0!==t.getElementsByClassName&&h)return t.getElementsByClassName(e)},f=[],ne((function(e){var t;d.appendChild(e).innerHTML="<a id='"+v+"' href='' disabled='disabled'></a><select id='"+v+"-\r\\' disabled='disabled'><option selected=''></option></select>",e.querySelectorAll("[selected]").length||f.push("\\["+A+"*(?:value|"+I+")"),e.querySelectorAll("[id~="+v+"-]").length||f.push("~="),e.querySelectorAll("a#"+v+"+*").length||f.push(".#.+[+~]"),e.querySelectorAll(":checked").length||f.push(":checked"),(t=u.createElement("input")).setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),d.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&f.push(":enabled",":disabled"),(t=u.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||f.push("\\["+A+"*name"+A+"*="+A+"*(?:''|\"\")")})),p.cssHas||f.push(":has"),f=f.length&&new RegExp(f.join("|")),L=function(e,t){if(e===t)return l=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!p.sortDetached&&t.compareDocumentPosition(e)===n?e===u||e.ownerDocument==k&&Q.contains(k,e)?-1:t===u||t.ownerDocument==k&&Q.contains(k,t)?1:s?o.call(s,e)-o.call(s,t):0:4&n?-1:1)},u):u}for(t in Q.matches=function(e,t){return Q(e,null,null,t)},Q.matchesSelector=function(e,t){if(le(e),h&&!R[t+" "]&&(!f||!f.test(t)))try{var n=m.call(e,t);if(n||p.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(zA){R(t,!0)}return Q(t,u,null,[e]).length>0},Q.contains=function(e,t){return(e.ownerDocument||e)!=u&&le(e),w.contains(e,t)},Q.attr=function(e,t){(e.ownerDocument||e)!=u&&le(e);var n=r.attrHandle[t.toLowerCase()],i=n&&c.call(r.attrHandle,t.toLowerCase())?n(e,t,!h):void 0;return void 0!==i?i:e.getAttribute(t)},Q.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},w.uniqueSort=function(e){var t,n=[],r=0,a=0;if(l=!p.sortStable,s=!p.sortStable&&i.call(e,0),M.call(e,L),l){for(;t=e[a++];)t===e[a]&&(r=n.push(a));for(;r--;)E.call(e,n[r],1)}return s=null,e},w.fn.uniqueSort=function(){return this.pushStack(w.uniqueSort(i.apply(this)))},r=w.expr={cacheLength:50,createPseudo:te,match:j,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(q,K),e[3]=(e[3]||e[4]||e[5]||"").replace(q,K),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||Q.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&Q.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return j.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&G.test(n)&&(t=ce(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(q,K).toLowerCase();return"*"===e?function(){return!0}:function(e){return C(e,t)}},CLASS:function(e){var t=b[e+" "];return t||(t=new RegExp("(^|"+A+")"+e+"("+A+"|$)"))&&b(e,(function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")}))},ATTR:function(e,t,n){return function(r){var i=Q.attr(r,e);return null==i?"!="===t:!t||(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i.replace(U," ")+" ").indexOf(n)>-1:"|="===t&&(i===n||i.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,r,i){var a="nth"!==e.slice(0,3),s="last"!==e.slice(-4),o="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,l){var u,c,d,h,p,f=a!==s?"nextSibling":"previousSibling",m=t.parentNode,g=o&&t.nodeName.toLowerCase(),_=!l&&!o,b=!1;if(m){if(a){for(;f;){for(d=t;d=d[f];)if(o?C(d,g):1===d.nodeType)return!1;p=f="only"===e&&!p&&"nextSibling"}return!0}if(p=[s?m.firstChild:m.lastChild],s&&_){for(b=(h=(u=(c=m[v]||(m[v]={}))[e]||[])[0]===y&&u[1])&&u[2],d=h&&m.childNodes[h];d=++h&&d&&d[f]||(b=h=0)||p.pop();)if(1===d.nodeType&&++b&&d===t){c[e]=[y,h,b];break}}else if(_&&(b=h=(u=(c=t[v]||(t[v]={}))[e]||[])[0]===y&&u[1]),!1===b)for(;(d=++h&&d&&d[f]||(b=h=0)||p.pop())&&(!(o?C(d,g):1===d.nodeType)||!++b||(_&&((c=d[v]||(d[v]={}))[e]=[y,b]),d!==t)););return(b-=i)===r||b%r==0&&b/r>=0}}},PSEUDO:function(e,t){var n,i=r.pseudos[e]||r.setFilters[e.toLowerCase()]||Q.error("unsupported pseudo: "+e);return i[v]?i(t):i.length>1?(n=[e,e,"",t],r.setFilters.hasOwnProperty(e.toLowerCase())?te((function(e,n){for(var r,a=i(e,t),s=a.length;s--;)e[r=o.call(e,a[s])]=!(n[r]=a[s])})):function(e){return i(e,0,n)}):i}},pseudos:{not:te((function(e){var t=[],n=[],r=ve(e.replace(P,"$1"));return r[v]?te((function(e,t,n,i){for(var a,s=r(e,null,i,[]),o=e.length;o--;)(a=s[o])&&(e[o]=!(t[o]=a))})):function(e,i,a){return t[0]=e,r(t,null,a,n),t[0]=null,!n.pop()}})),has:te((function(e){return function(t){return Q(e,t).length>0}})),contains:te((function(e){return e=e.replace(q,K),function(t){return(t.textContent||w.text(t)).indexOf(e)>-1}})),lang:te((function(e){return H.test(e||"")||Q.error("unsupported lang: "+e),e=e.replace(q,K).toLowerCase(),function(t){var n;do{if(n=h?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}})),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===d},focus:function(e){return e===function(){try{return u.activeElement}catch(e){}}()&&u.hasFocus()&&!!(e.type||e.href||~e.tabIndex)},enabled:ae(!1),disabled:ae(!0),checked:function(e){return C(e,"input")&&!!e.checked||C(e,"option")&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!r.pseudos.empty(e)},header:function(e){return Y.test(e.nodeName)},input:function(e){return W.test(e.nodeName)},button:function(e){return C(e,"input")&&"button"===e.type||C(e,"button")},text:function(e){var t;return C(e,"input")&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:se((function(){return[0]})),last:se((function(e,t){return[t-1]})),eq:se((function(e,t,n){return[n<0?n+t:n]})),even:se((function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e})),odd:se((function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e})),lt:se((function(e,t,n){var r;for(r=n<0?n+t:n>t?t:n;--r>=0;)e.push(r);return e})),gt:se((function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e}))}},r.pseudos.nth=r.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})r.pseudos[t]=re(t);for(t in{submit:!0,reset:!0})r.pseudos[t]=ie(t);function ue(){}function ce(e,t){var n,i,a,s,o,l,u,c=x[e+" "];if(c)return t?0:c.slice(0);for(o=e,l=[],u=r.preFilter;o;){for(s in n&&!(i=z.exec(o))||(i&&(o=o.slice(i[0].length)||o),l.push(a=[])),n=!1,(i=F.exec(o))&&(n=i.shift(),a.push({value:n,type:i[0].replace(P," ")}),o=o.slice(n.length)),r.filter)!(i=j[s].exec(o))||u[s]&&!(i=u[s](i))||(n=i.shift(),a.push({value:n,type:s,matches:i}),o=o.slice(n.length));if(!n)break}return t?o.length:o?Q.error(e):x(e,l).slice(0)}function de(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function he(e,t,n){var r=t.dir,i=t.next,a=i||r,s=n&&"parentNode"===a,o=_++;return t.first?function(t,n,i){for(;t=t[r];)if(1===t.nodeType||s)return e(t,n,i);return!1}:function(t,n,l){var u,c,d=[y,o];if(l){for(;t=t[r];)if((1===t.nodeType||s)&&e(t,n,l))return!0}else for(;t=t[r];)if(1===t.nodeType||s)if(c=t[v]||(t[v]={}),i&&C(t,i))t=t[r]||t;else{if((u=c[a])&&u[0]===y&&u[1]===o)return d[2]=u[2];if(c[a]=d,d[2]=e(t,n,l))return!0}return!1}}function pe(e){return e.length>1?function(t,n,r){for(var i=e.length;i--;)if(!e[i](t,n,r))return!1;return!0}:e[0]}function fe(e,t,n,r,i){for(var a,s=[],o=0,l=e.length,u=null!=t;o<l;o++)(a=e[o])&&(n&&!n(a,r,i)||(s.push(a),u&&t.push(o)));return s}function me(e,t,n,r,i,a){return r&&!r[v]&&(r=me(r)),i&&!i[v]&&(i=me(i,a)),te((function(a,s,l,u){var c,d,h,p,f=[],m=[],v=s.length,y=a||function(e,t,n){for(var r=0,i=t.length;r<i;r++)Q(e,t[r],n);return n}(t||"*",l.nodeType?[l]:l,[]),_=!e||!a&&t?y:fe(y,f,e,l,u);if(n?n(_,p=i||(a?e:v||r)?[]:s,l,u):p=_,r)for(c=fe(p,m),r(c,[],l,u),d=c.length;d--;)(h=c[d])&&(p[m[d]]=!(_[m[d]]=h));if(a){if(i||e){if(i){for(c=[],d=p.length;d--;)(h=p[d])&&c.push(_[d]=h);i(null,p=[],c,u)}for(d=p.length;d--;)(h=p[d])&&(c=i?o.call(a,h):f[d])>-1&&(a[c]=!(s[c]=h))}}else p=fe(p===s?p.splice(v,p.length):p),i?i(null,s,p,u):g.apply(s,p)}))}function ge(e){for(var t,n,i,s=e.length,l=r.relative[e[0].type],u=l||r.relative[" "],c=l?1:0,d=he((function(e){return e===t}),u,!0),h=he((function(e){return o.call(t,e)>-1}),u,!0),p=[function(e,n,r){var i=!l&&(r||n!=a)||((t=n).nodeType?d(e,n,r):h(e,n,r));return t=null,i}];c<s;c++)if(n=r.relative[e[c].type])p=[he(pe(p),n)];else{if((n=r.filter[e[c].type].apply(null,e[c].matches))[v]){for(i=++c;i<s&&!r.relative[e[i].type];i++);return me(c>1&&pe(p),c>1&&de(e.slice(0,c-1).concat({value:" "===e[c-2].type?"*":""})).replace(P,"$1"),n,c<i&&ge(e.slice(c,i)),i<s&&ge(e=e.slice(i)),i<s&&de(e))}p.push(n)}return pe(p)}function ve(e,t){var n,i=[],s=[],o=S[e+" "];if(!o){for(t||(t=ce(e)),n=t.length;n--;)(o=ge(t[n]))[v]?i.push(o):s.push(o);o=S(e,function(e,t){var n=t.length>0,i=e.length>0,s=function(s,o,l,c,d){var p,f,m,v=0,_="0",b=s&&[],x=[],S=a,C=s||i&&r.find.TAG("*",d),M=y+=null==S?1:Math.random()||.1,E=C.length;for(d&&(a=o==u||o||d);_!==E&&null!=(p=C[_]);_++){if(i&&p){for(f=0,o||p.ownerDocument==u||(le(p),l=!h);m=e[f++];)if(m(p,o||u,l)){g.call(c,p);break}d&&(y=M)}n&&((p=!m&&p)&&v--,s&&b.push(p))}if(v+=_,n&&_!==v){for(f=0;m=t[f++];)m(b,x,o,l);if(s){if(v>0)for(;_--;)b[_]||x[_]||(x[_]=T.call(c));x=fe(x)}g.apply(c,x),d&&!s&&x.length>0&&v+t.length>1&&w.uniqueSort(c)}return d&&(y=M,a=S),b};return n?te(s):s}(s,i)),o.selector=e}return o}function ye(e,t,n,i){var a,s,o,l,u,c="function"==typeof e&&e,d=!i&&ce(e=c.selector||e);if(n=n||[],1===d.length){if((s=d[0]=d[0].slice(0)).length>2&&"ID"===(o=s[0]).type&&9===t.nodeType&&h&&r.relative[s[1].type]){if(!(t=(r.find.ID(o.matches[0].replace(q,K),t)||[])[0]))return n;c&&(t=t.parentNode),e=e.slice(s.shift().value.length)}for(a=j.needsContext.test(e)?0:s.length;a--&&(o=s[a],!r.relative[l=o.type]);)if((u=r.find[l])&&(i=u(o.matches[0].replace(q,K),X.test(s[0].type)&&oe(t.parentNode)||t))){if(s.splice(a,1),!(e=i.length&&de(s)))return g.apply(n,i),n;break}}return(c||ve(e,d))(i,t,!h,n,!t||X.test(e)&&oe(t.parentNode)||t),n}ue.prototype=r.filters=r.pseudos,r.setFilters=new ue,p.sortStable=v.split("").sort(L).join("")===v,le(),p.sortDetached=ne((function(e){return 1&e.compareDocumentPosition(u.createElement("fieldset"))})),w.find=Q,w.expr[":"]=w.expr.pseudos,w.unique=w.uniqueSort,Q.compile=ve,Q.select=ye,Q.setDocument=le,Q.escape=w.escapeSelector,Q.getText=w.text,Q.isXML=w.isXMLDoc,Q.selectors=w.expr,Q.support=w.support,Q.uniqueSort=w.uniqueSort}();var I=function(e,t,n){for(var r=[],i=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(i&&w(e).is(n))break;r.push(e)}return r},O=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},N=w.expr.match.needsContext,B=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function U(e,t,n){return f(t)?w.grep(e,(function(e,r){return!!t.call(e,r,e)!==n})):t.nodeType?w.grep(e,(function(e){return e===t!==n})):"string"!=typeof t?w.grep(e,(function(e){return o.call(t,e)>-1!==n})):w.filter(t,e,n)}w.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?w.find.matchesSelector(r,e)?[r]:[]:w.find.matches(e,w.grep(t,(function(e){return 1===e.nodeType})))},w.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(w(e).filter((function(){for(t=0;t<r;t++)if(w.contains(i[t],this))return!0})));for(n=this.pushStack([]),t=0;t<r;t++)w.find(e,i[t],n);return r>1?w.uniqueSort(n):n},filter:function(e){return this.pushStack(U(this,e||[],!1))},not:function(e){return this.pushStack(U(this,e||[],!0))},is:function(e){return!!U(this,"string"==typeof e&&N.test(e)?w(e):e||[],!1).length}});var z,F=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(w.fn.init=function(e,t,n){var r,i;if(!e)return this;if(n=n||z,"string"==typeof e){if(!(r="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:F.exec(e))||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof w?t[0]:t,w.merge(this,w.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:g,!0)),B.test(r[1])&&w.isPlainObject(t))for(r in t)f(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return(i=g.getElementById(r[2]))&&(this[0]=i,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):f(e)?void 0!==n.ready?n.ready(e):e(w):w.makeArray(e,this)}).prototype=w.fn,z=w(g);var V=/^(?:parents|prev(?:Until|All))/,G={children:!0,contents:!0,next:!0,prev:!0};function H(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}w.fn.extend({has:function(e){var t=w(e,this),n=t.length;return this.filter((function(){for(var e=0;e<n;e++)if(w.contains(this,t[e]))return!0}))},closest:function(e,t){var n,r=0,i=this.length,a=[],s="string"!=typeof e&&w(e);if(!N.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(s?s.index(n)>-1:1===n.nodeType&&w.find.matchesSelector(n,e))){a.push(n);break}return this.pushStack(a.length>1?w.uniqueSort(a):a)},index:function(e){return e?"string"==typeof e?o.call(w(e),this[0]):o.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(w.uniqueSort(w.merge(this.get(),w(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),w.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return I(e,"parentNode")},parentsUntil:function(e,t,n){return I(e,"parentNode",n)},next:function(e){return H(e,"nextSibling")},prev:function(e){return H(e,"previousSibling")},nextAll:function(e){return I(e,"nextSibling")},prevAll:function(e){return I(e,"previousSibling")},nextUntil:function(e,t,n){return I(e,"nextSibling",n)},prevUntil:function(e,t,n){return I(e,"previousSibling",n)},siblings:function(e){return O((e.parentNode||{}).firstChild,e)},children:function(e){return O(e.firstChild)},contents:function(e){return null!=e.contentDocument&&r(e.contentDocument)?e.contentDocument:(C(e,"template")&&(e=e.content||e),w.merge([],e.childNodes))}},(function(e,t){w.fn[e]=function(n,r){var i=w.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=w.filter(r,i)),this.length>1&&(G[e]||w.uniqueSort(i),V.test(e)&&i.reverse()),this.pushStack(i)}}));var j=/[^\x20\t\r\n\f]+/g;function W(e){return e}function Y(e){throw e}function $(e,t,n,r){var i;try{e&&f(i=e.promise)?i.call(e).done(t).fail(n):e&&f(i=e.then)?i.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(a){n.apply(void 0,[a])}}w.Callbacks=function(e){e="string"==typeof e?function(e){var t={};return w.each(e.match(j)||[],(function(e,n){t[n]=!0})),t}(e):w.extend({},e);var t,n,r,i,a=[],s=[],o=-1,l=function(){for(i=i||e.once,r=t=!0;s.length;o=-1)for(n=s.shift();++o<a.length;)!1===a[o].apply(n[0],n[1])&&e.stopOnFalse&&(o=a.length,n=!1);e.memory||(n=!1),t=!1,i&&(a=n?[]:"")},u={add:function(){return a&&(n&&!t&&(o=a.length-1,s.push(n)),function t(n){w.each(n,(function(n,r){f(r)?e.unique&&u.has(r)||a.push(r):r&&r.length&&"string"!==_(r)&&t(r)}))}(arguments),n&&!t&&l()),this},remove:function(){return w.each(arguments,(function(e,t){for(var n;(n=w.inArray(t,a,n))>-1;)a.splice(n,1),n<=o&&o--})),this},has:function(e){return e?w.inArray(e,a)>-1:a.length>0},empty:function(){return a&&(a=[]),this},disable:function(){return i=s=[],a=n="",this},disabled:function(){return!a},lock:function(){return i=s=[],n||t||(a=n=""),this},locked:function(){return!!i},fireWith:function(e,n){return i||(n=[e,(n=n||[]).slice?n.slice():n],s.push(n),t||l()),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!r}};return u},w.extend({Deferred:function(t){var n=[["notify","progress",w.Callbacks("memory"),w.Callbacks("memory"),2],["resolve","done",w.Callbacks("once memory"),w.Callbacks("once memory"),0,"resolved"],["reject","fail",w.Callbacks("once memory"),w.Callbacks("once memory"),1,"rejected"]],r="pending",i={state:function(){return r},always:function(){return a.done(arguments).fail(arguments),this},catch:function(e){return i.then(null,e)},pipe:function(){var e=arguments;return w.Deferred((function(t){w.each(n,(function(n,r){var i=f(e[r[4]])&&e[r[4]];a[r[1]]((function(){var e=i&&i.apply(this,arguments);e&&f(e.promise)?e.promise().progress(t.notify).done(t.resolve).fail(t.reject):t[r[0]+"With"](this,i?[e]:arguments)}))})),e=null})).promise()},then:function(t,r,i){var a=0;function s(t,n,r,i){return function(){var o=this,l=arguments,u=function(){var e,u;if(!(t<a)){if((e=r.apply(o,l))===n.promise())throw new TypeError("Thenable self-resolution");u=e&&("object"==typeof e||"function"==typeof e)&&e.then,f(u)?i?u.call(e,s(a,n,W,i),s(a,n,Y,i)):(a++,u.call(e,s(a,n,W,i),s(a,n,Y,i),s(a,n,W,n.notifyWith))):(r!==W&&(o=void 0,l=[e]),(i||n.resolveWith)(o,l))}},c=i?u:function(){try{u()}catch(zA){w.Deferred.exceptionHook&&w.Deferred.exceptionHook(zA,c.error),t+1>=a&&(r!==Y&&(o=void 0,l=[zA]),n.rejectWith(o,l))}};t?c():(w.Deferred.getErrorHook?c.error=w.Deferred.getErrorHook():w.Deferred.getStackHook&&(c.error=w.Deferred.getStackHook()),e.setTimeout(c))}}return w.Deferred((function(e){n[0][3].add(s(0,e,f(i)?i:W,e.notifyWith)),n[1][3].add(s(0,e,f(t)?t:W)),n[2][3].add(s(0,e,f(r)?r:Y))})).promise()},promise:function(e){return null!=e?w.extend(e,i):i}},a={};return w.each(n,(function(e,t){var s=t[2],o=t[5];i[t[1]]=s.add,o&&s.add((function(){r=o}),n[3-e][2].disable,n[3-e][3].disable,n[0][2].lock,n[0][3].lock),s.add(t[3].fire),a[t[0]]=function(){return a[t[0]+"With"](this===a?void 0:this,arguments),this},a[t[0]+"With"]=s.fireWith})),i.promise(a),t&&t.call(a,a),a},when:function(e){var t=arguments.length,n=t,r=Array(n),a=i.call(arguments),s=w.Deferred(),o=function(e){return function(n){r[e]=this,a[e]=arguments.length>1?i.call(arguments):n,--t||s.resolveWith(r,a)}};if(t<=1&&($(e,s.done(o(n)).resolve,s.reject,!t),"pending"===s.state()||f(a[n]&&a[n].then)))return s.then();for(;n--;)$(a[n],o(n),s.reject);return s.promise()}});var X=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;w.Deferred.exceptionHook=function(t,n){e.console&&e.console.warn&&t&&X.test(t.name)&&e.console.warn("jQuery.Deferred exception: "+t.message,t.stack,n)},w.readyException=function(t){e.setTimeout((function(){throw t}))};var q=w.Deferred();function K(){g.removeEventListener("DOMContentLoaded",K),e.removeEventListener("load",K),w.ready()}w.fn.ready=function(e){return q.then(e).catch((function(e){w.readyException(e)})),this},w.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--w.readyWait:w.isReady)||(w.isReady=!0,!0!==e&&--w.readyWait>0||q.resolveWith(g,[w]))}}),w.ready.then=q.then,"complete"===g.readyState||"loading"!==g.readyState&&!g.documentElement.doScroll?e.setTimeout(w.ready):(g.addEventListener("DOMContentLoaded",K),e.addEventListener("load",K));var Z=function(e,t,n,r,i,a,s){var o=0,l=e.length,u=null==n;if("object"===_(n))for(o in i=!0,n)Z(e,t,o,n[o],!0,a,s);else if(void 0!==r&&(i=!0,f(r)||(s=!0),u&&(s?(t.call(e,r),t=null):(u=t,t=function(e,t,n){return u.call(w(e),n)})),t))for(;o<l;o++)t(e[o],n,s?r:r.call(e[o],o,t(e[o],n)));return i?e:u?t.call(e):l?t(e[0],n):a},J=/^-ms-/,Q=/-([a-z])/g;function ee(e,t){return t.toUpperCase()}function te(e){return e.replace(J,"ms-").replace(Q,ee)}var ne=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function re(){this.expando=w.expando+re.uid++}re.uid=1,re.prototype={cache:function(e){var t=e[this.expando];return t||(t={},ne(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[te(t)]=n;else for(r in t)i[te(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][te(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(te):(t=te(t))in r?[t]:t.match(j)||[]).length;for(;n--;)delete r[t[n]]}(void 0===t||w.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!w.isEmptyObject(t)}};var ie=new re,ae=new re,se=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,oe=/[A-Z]/g;function le(e,t,n){var r;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(oe,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n=function(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:se.test(e)?JSON.parse(e):e)}(n)}catch(zA){}ae.set(e,t,n)}else n=void 0;return n}w.extend({hasData:function(e){return ae.hasData(e)||ie.hasData(e)},data:function(e,t,n){return ae.access(e,t,n)},removeData:function(e,t){ae.remove(e,t)},_data:function(e,t,n){return ie.access(e,t,n)},_removeData:function(e,t){ie.remove(e,t)}}),w.fn.extend({data:function(e,t){var n,r,i,a=this[0],s=a&&a.attributes;if(void 0===e){if(this.length&&(i=ae.get(a),1===a.nodeType&&!ie.get(a,"hasDataAttrs"))){for(n=s.length;n--;)s[n]&&0===(r=s[n].name).indexOf("data-")&&(r=te(r.slice(5)),le(a,r,i[r]));ie.set(a,"hasDataAttrs",!0)}return i}return"object"==typeof e?this.each((function(){ae.set(this,e)})):Z(this,(function(t){var n;if(a&&void 0===t)return void 0!==(n=ae.get(a,e))||void 0!==(n=le(a,e))?n:void 0;this.each((function(){ae.set(this,e,t)}))}),null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each((function(){ae.remove(this,e)}))}}),w.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=ie.get(e,t),n&&(!r||Array.isArray(n)?r=ie.access(e,t,w.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=w.queue(e,t),r=n.length,i=n.shift(),a=w._queueHooks(e,t);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete a.stop,i.call(e,(function(){w.dequeue(e,t)}),a)),!r&&a&&a.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return ie.get(e,n)||ie.access(e,n,{empty:w.Callbacks("once memory").add((function(){ie.remove(e,[t+"queue",n])}))})}}),w.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?w.queue(this[0],e):void 0===t?this:this.each((function(){var n=w.queue(this,e,t);w._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&w.dequeue(this,e)}))},dequeue:function(e){return this.each((function(){w.dequeue(this,e)}))},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=w.Deferred(),a=this,s=this.length,o=function(){--r||i.resolveWith(a,[a])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";s--;)(n=ie.get(a[s],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(o));return o(),i.promise(t)}});var ue=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ce=new RegExp("^(?:([+-])=|)("+ue+")([a-z%]*)$","i"),de=["Top","Right","Bottom","Left"],he=g.documentElement,pe=function(e){return w.contains(e.ownerDocument,e)},fe={composed:!0};he.getRootNode&&(pe=function(e){return w.contains(e.ownerDocument,e)||e.getRootNode(fe)===e.ownerDocument});var me=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&pe(e)&&"none"===w.css(e,"display")};function ge(e,t,n,r){var i,a,s=20,o=r?function(){return r.cur()}:function(){return w.css(e,t,"")},l=o(),u=n&&n[3]||(w.cssNumber[t]?"":"px"),c=e.nodeType&&(w.cssNumber[t]||"px"!==u&&+l)&&ce.exec(w.css(e,t));if(c&&c[3]!==u){for(l/=2,u=u||c[3],c=+l||1;s--;)w.style(e,t,c+u),(1-a)*(1-(a=o()/l||.5))<=0&&(s=0),c/=a;c*=2,w.style(e,t,c+u),n=n||[]}return n&&(c=+c||+l||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=u,r.start=c,r.end=i)),i}var ve={};function ye(e){var t,n=e.ownerDocument,r=e.nodeName,i=ve[r];return i||(t=n.body.appendChild(n.createElement(r)),i=w.css(t,"display"),t.parentNode.removeChild(t),"none"===i&&(i="block"),ve[r]=i,i)}function _e(e,t){for(var n,r,i=[],a=0,s=e.length;a<s;a++)(r=e[a]).style&&(n=r.style.display,t?("none"===n&&(i[a]=ie.get(r,"display")||null,i[a]||(r.style.display="")),""===r.style.display&&me(r)&&(i[a]=ye(r))):"none"!==n&&(i[a]="none",ie.set(r,"display",n)));for(a=0;a<s;a++)null!=i[a]&&(e[a].style.display=i[a]);return e}w.fn.extend({show:function(){return _e(this,!0)},hide:function(){return _e(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each((function(){me(this)?w(this).show():w(this).hide()}))}});var be,xe,we=/^(?:checkbox|radio)$/i,Se=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Ce=/^$|^module$|\/(?:java|ecma)script/i;be=g.createDocumentFragment().appendChild(g.createElement("div")),(xe=g.createElement("input")).setAttribute("type","radio"),xe.setAttribute("checked","checked"),xe.setAttribute("name","t"),be.appendChild(xe),p.checkClone=be.cloneNode(!0).cloneNode(!0).lastChild.checked,be.innerHTML="<textarea>x</textarea>",p.noCloneChecked=!!be.cloneNode(!0).lastChild.defaultValue,be.innerHTML="<option></option>",p.option=!!be.lastChild;var Te={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function Me(e,t){var n;return n=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&C(e,t)?w.merge([e],n):n}function Ee(e,t){for(var n=0,r=e.length;n<r;n++)ie.set(e[n],"globalEval",!t||ie.get(t[n],"globalEval"))}Te.tbody=Te.tfoot=Te.colgroup=Te.caption=Te.thead,Te.th=Te.td,p.option||(Te.optgroup=Te.option=[1,"<select multiple='multiple'>","</select>"]);var Ae=/<|&#?\w+;/;function Pe(e,t,n,r,i){for(var a,s,o,l,u,c,d=t.createDocumentFragment(),h=[],p=0,f=e.length;p<f;p++)if((a=e[p])||0===a)if("object"===_(a))w.merge(h,a.nodeType?[a]:a);else if(Ae.test(a)){for(s=s||d.appendChild(t.createElement("div")),o=(Se.exec(a)||["",""])[1].toLowerCase(),l=Te[o]||Te._default,s.innerHTML=l[1]+w.htmlPrefilter(a)+l[2],c=l[0];c--;)s=s.lastChild;w.merge(h,s.childNodes),(s=d.firstChild).textContent=""}else h.push(t.createTextNode(a));for(d.textContent="",p=0;a=h[p++];)if(r&&w.inArray(a,r)>-1)i&&i.push(a);else if(u=pe(a),s=Me(d.appendChild(a),"script"),u&&Ee(s),n)for(c=0;a=s[c++];)Ce.test(a.type||"")&&n.push(a);return d}var Re=/^([^.]*)(?:\.(.+)|)/;function Le(){return!0}function ke(){return!1}function De(e,t,n,r,i,a){var s,o;if("object"==typeof t){for(o in"string"!=typeof n&&(r=r||n,n=void 0),t)De(e,o,n,r,t[o],a);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=ke;else if(!i)return e;return 1===a&&(s=i,i=function(e){return w().off(e),s.apply(this,arguments)},i.guid=s.guid||(s.guid=w.guid++)),e.each((function(){w.event.add(this,t,i,r,n)}))}function Ie(e,t,n){n?(ie.set(e,t,!1),w.event.add(e,t,{namespace:!1,handler:function(e){var n,r=ie.get(this,t);if(1&e.isTrigger&&this[t]){if(r)(w.event.special[t]||{}).delegateType&&e.stopPropagation();else if(r=i.call(arguments),ie.set(this,t,r),this[t](),n=ie.get(this,t),ie.set(this,t,!1),r!==n)return e.stopImmediatePropagation(),e.preventDefault(),n}else r&&(ie.set(this,t,w.event.trigger(r[0],r.slice(1),this)),e.stopPropagation(),e.isImmediatePropagationStopped=Le)}})):void 0===ie.get(e,t)&&w.event.add(e,t,Le)}w.event={global:{},add:function(e,t,n,r,i){var a,s,o,l,u,c,d,h,p,f,m,g=ie.get(e);if(ne(e))for(n.handler&&(n=(a=n).handler,i=a.selector),i&&w.find.matchesSelector(he,i),n.guid||(n.guid=w.guid++),(l=g.events)||(l=g.events=Object.create(null)),(s=g.handle)||(s=g.handle=function(t){return void 0!==w&&w.event.triggered!==t.type?w.event.dispatch.apply(e,arguments):void 0}),u=(t=(t||"").match(j)||[""]).length;u--;)p=m=(o=Re.exec(t[u])||[])[1],f=(o[2]||"").split(".").sort(),p&&(d=w.event.special[p]||{},p=(i?d.delegateType:d.bindType)||p,d=w.event.special[p]||{},c=w.extend({type:p,origType:m,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&w.expr.match.needsContext.test(i),namespace:f.join(".")},a),(h=l[p])||((h=l[p]=[]).delegateCount=0,d.setup&&!1!==d.setup.call(e,r,f,s)||e.addEventListener&&e.addEventListener(p,s)),d.add&&(d.add.call(e,c),c.handler.guid||(c.handler.guid=n.guid)),i?h.splice(h.delegateCount++,0,c):h.push(c),w.event.global[p]=!0)},remove:function(e,t,n,r,i){var a,s,o,l,u,c,d,h,p,f,m,g=ie.hasData(e)&&ie.get(e);if(g&&(l=g.events)){for(u=(t=(t||"").match(j)||[""]).length;u--;)if(p=m=(o=Re.exec(t[u])||[])[1],f=(o[2]||"").split(".").sort(),p){for(d=w.event.special[p]||{},h=l[p=(r?d.delegateType:d.bindType)||p]||[],o=o[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=a=h.length;a--;)c=h[a],!i&&m!==c.origType||n&&n.guid!==c.guid||o&&!o.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(h.splice(a,1),c.selector&&h.delegateCount--,d.remove&&d.remove.call(e,c));s&&!h.length&&(d.teardown&&!1!==d.teardown.call(e,f,g.handle)||w.removeEvent(e,p,g.handle),delete l[p])}else for(p in l)w.event.remove(e,p+t[u],n,r,!0);w.isEmptyObject(l)&&ie.remove(e,"handle events")}},dispatch:function(e){var t,n,r,i,a,s,o=new Array(arguments.length),l=w.event.fix(e),u=(ie.get(this,"events")||Object.create(null))[l.type]||[],c=w.event.special[l.type]||{};for(o[0]=l,t=1;t<arguments.length;t++)o[t]=arguments[t];if(l.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,l)){for(s=w.event.handlers.call(this,l,u),t=0;(i=s[t++])&&!l.isPropagationStopped();)for(l.currentTarget=i.elem,n=0;(a=i.handlers[n++])&&!l.isImmediatePropagationStopped();)l.rnamespace&&!1!==a.namespace&&!l.rnamespace.test(a.namespace)||(l.handleObj=a,l.data=a.data,void 0!==(r=((w.event.special[a.origType]||{}).handle||a.handler).apply(i.elem,o))&&!1===(l.result=r)&&(l.preventDefault(),l.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,l),l.result}},handlers:function(e,t){var n,r,i,a,s,o=[],l=t.delegateCount,u=e.target;if(l&&u.nodeType&&!("click"===e.type&&e.button>=1))for(;u!==this;u=u.parentNode||this)if(1===u.nodeType&&("click"!==e.type||!0!==u.disabled)){for(a=[],s={},n=0;n<l;n++)void 0===s[i=(r=t[n]).selector+" "]&&(s[i]=r.needsContext?w(i,this).index(u)>-1:w.find(i,this,null,[u]).length),s[i]&&a.push(r);a.length&&o.push({elem:u,handlers:a})}return u=this,l<t.length&&o.push({elem:u,handlers:t.slice(l)}),o},addProp:function(e,t){Object.defineProperty(w.Event.prototype,e,{enumerable:!0,configurable:!0,get:f(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[w.expando]?e:new w.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return we.test(t.type)&&t.click&&C(t,"input")&&Ie(t,"click",!0),!1},trigger:function(e){var t=this||e;return we.test(t.type)&&t.click&&C(t,"input")&&Ie(t,"click"),!0},_default:function(e){var t=e.target;return we.test(t.type)&&t.click&&C(t,"input")&&ie.get(t,"click")||C(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},w.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},w.Event=function(e,t){if(!(this instanceof w.Event))return new w.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?Le:ke,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&w.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[w.expando]=!0},w.Event.prototype={constructor:w.Event,isDefaultPrevented:ke,isPropagationStopped:ke,isImmediatePropagationStopped:ke,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Le,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Le,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Le,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},w.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},w.event.addProp),w.each({focus:"focusin",blur:"focusout"},(function(e,t){function n(e){if(g.documentMode){var n=ie.get(this,"handle"),r=w.event.fix(e);r.type="focusin"===e.type?"focus":"blur",r.isSimulated=!0,n(e),r.target===r.currentTarget&&n(r)}else w.event.simulate(t,e.target,w.event.fix(e))}w.event.special[e]={setup:function(){var r;if(Ie(this,e,!0),!g.documentMode)return!1;(r=ie.get(this,t))||this.addEventListener(t,n),ie.set(this,t,(r||0)+1)},trigger:function(){return Ie(this,e),!0},teardown:function(){var e;if(!g.documentMode)return!1;(e=ie.get(this,t)-1)?ie.set(this,t,e):(this.removeEventListener(t,n),ie.remove(this,t))},_default:function(t){return ie.get(t.target,e)},delegateType:t},w.event.special[t]={setup:function(){var r=this.ownerDocument||this.document||this,i=g.documentMode?this:r,a=ie.get(i,t);a||(g.documentMode?this.addEventListener(t,n):r.addEventListener(e,n,!0)),ie.set(i,t,(a||0)+1)},teardown:function(){var r=this.ownerDocument||this.document||this,i=g.documentMode?this:r,a=ie.get(i,t)-1;a?ie.set(i,t,a):(g.documentMode?this.removeEventListener(t,n):r.removeEventListener(e,n,!0),ie.remove(i,t))}}})),w.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(e,t){w.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=e.relatedTarget,i=e.handleObj;return r&&(r===this||w.contains(this,r))||(e.type=i.origType,n=i.handler.apply(this,arguments),e.type=t),n}}})),w.fn.extend({on:function(e,t,n,r){return De(this,e,t,n,r)},one:function(e,t,n,r){return De(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,w(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=ke),this.each((function(){w.event.remove(this,e,n,t)}))}});var Oe=/<script|<style|<link/i,Ne=/checked\s*(?:[^=]|=\s*.checked.)/i,Be=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function Ue(e,t){return C(e,"table")&&C(11!==t.nodeType?t:t.firstChild,"tr")&&w(e).children("tbody")[0]||e}function ze(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function Fe(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Ve(e,t){var n,r,i,a,s,o;if(1===t.nodeType){if(ie.hasData(e)&&(o=ie.get(e).events))for(i in ie.remove(t,"handle events"),o)for(n=0,r=o[i].length;n<r;n++)w.event.add(t,i,o[i][n]);ae.hasData(e)&&(a=ae.access(e),s=w.extend({},a),ae.set(t,s))}}function Ge(e,t,n,r){t=a(t);var i,s,o,l,u,c,d=0,h=e.length,m=h-1,g=t[0],v=f(g);if(v||h>1&&"string"==typeof g&&!p.checkClone&&Ne.test(g))return e.each((function(i){var a=e.eq(i);v&&(t[0]=g.call(this,i,a.html())),Ge(a,t,n,r)}));if(h&&(s=(i=Pe(t,e[0].ownerDocument,!1,e,r)).firstChild,1===i.childNodes.length&&(i=s),s||r)){for(l=(o=w.map(Me(i,"script"),ze)).length;d<h;d++)u=i,d!==m&&(u=w.clone(u,!0,!0),l&&w.merge(o,Me(u,"script"))),n.call(e[d],u,d);if(l)for(c=o[o.length-1].ownerDocument,w.map(o,Fe),d=0;d<l;d++)u=o[d],Ce.test(u.type||"")&&!ie.access(u,"globalEval")&&w.contains(c,u)&&(u.src&&"module"!==(u.type||"").toLowerCase()?w._evalUrl&&!u.noModule&&w._evalUrl(u.src,{nonce:u.nonce||u.getAttribute("nonce")},c):y(u.textContent.replace(Be,""),u,c))}return e}function He(e,t,n){for(var r,i=t?w.filter(t,e):e,a=0;null!=(r=i[a]);a++)n||1!==r.nodeType||w.cleanData(Me(r)),r.parentNode&&(n&&pe(r)&&Ee(Me(r,"script")),r.parentNode.removeChild(r));return e}w.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var r,i,a,s,o,l,u,c=e.cloneNode(!0),d=pe(e);if(!(p.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||w.isXMLDoc(e)))for(s=Me(c),r=0,i=(a=Me(e)).length;r<i;r++)o=a[r],l=s[r],u=void 0,"input"===(u=l.nodeName.toLowerCase())&&we.test(o.type)?l.checked=o.checked:"input"!==u&&"textarea"!==u||(l.defaultValue=o.defaultValue);if(t)if(n)for(a=a||Me(e),s=s||Me(c),r=0,i=a.length;r<i;r++)Ve(a[r],s[r]);else Ve(e,c);return(s=Me(c,"script")).length>0&&Ee(s,!d&&Me(e,"script")),c},cleanData:function(e){for(var t,n,r,i=w.event.special,a=0;void 0!==(n=e[a]);a++)if(ne(n)){if(t=n[ie.expando]){if(t.events)for(r in t.events)i[r]?w.event.remove(n,r):w.removeEvent(n,r,t.handle);n[ie.expando]=void 0}n[ae.expando]&&(n[ae.expando]=void 0)}}}),w.fn.extend({detach:function(e){return He(this,e,!0)},remove:function(e){return He(this,e)},text:function(e){return Z(this,(function(e){return void 0===e?w.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)}))}),null,e,arguments.length)},append:function(){return Ge(this,arguments,(function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Ue(this,e).appendChild(e)}))},prepend:function(){return Ge(this,arguments,(function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Ue(this,e);t.insertBefore(e,t.firstChild)}}))},before:function(){return Ge(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this)}))},after:function(){return Ge(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)}))},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(w.cleanData(Me(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map((function(){return w.clone(this,e,t)}))},html:function(e){return Z(this,(function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Oe.test(e)&&!Te[(Se.exec(e)||["",""])[1].toLowerCase()]){e=w.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(w.cleanData(Me(t,!1)),t.innerHTML=e);t=0}catch(zA){}}t&&this.empty().append(e)}),null,e,arguments.length)},replaceWith:function(){var e=[];return Ge(this,arguments,(function(t){var n=this.parentNode;w.inArray(this,e)<0&&(w.cleanData(Me(this)),n&&n.replaceChild(t,this))}),e)}}),w.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(e,t){w.fn[e]=function(e){for(var n,r=[],i=w(e),a=i.length-1,o=0;o<=a;o++)n=o===a?this:this.clone(!0),w(i[o])[t](n),s.apply(r,n.get());return this.pushStack(r)}}));var je=new RegExp("^("+ue+")(?!px)[a-z%]+$","i"),We=/^--/,Ye=function(t){var n=t.ownerDocument.defaultView;return n&&n.opener||(n=e),n.getComputedStyle(t)},$e=function(e,t,n){var r,i,a={};for(i in t)a[i]=e.style[i],e.style[i]=t[i];for(i in r=n.call(e),t)e.style[i]=a[i];return r},Xe=new RegExp(de.join("|"),"i");function qe(e,t,n){var r,i,a,s,o=We.test(t),l=e.style;return(n=n||Ye(e))&&(s=n.getPropertyValue(t)||n[t],o&&s&&(s=s.replace(P,"$1")||void 0),""!==s||pe(e)||(s=w.style(e,t)),!p.pixelBoxStyles()&&je.test(s)&&Xe.test(t)&&(r=l.width,i=l.minWidth,a=l.maxWidth,l.minWidth=l.maxWidth=l.width=s,s=n.width,l.width=r,l.minWidth=i,l.maxWidth=a)),void 0!==s?s+"":s}function Ke(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function t(){if(c){u.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",c.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",he.appendChild(u).appendChild(c);var t=e.getComputedStyle(c);r="1%"!==t.top,l=12===n(t.marginLeft),c.style.right="60%",s=36===n(t.right),i=36===n(t.width),c.style.position="absolute",a=12===n(c.offsetWidth/3),he.removeChild(u),c=null}}function n(e){return Math.round(parseFloat(e))}var r,i,a,s,o,l,u=g.createElement("div"),c=g.createElement("div");c.style&&(c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",p.clearCloneStyle="content-box"===c.style.backgroundClip,w.extend(p,{boxSizingReliable:function(){return t(),i},pixelBoxStyles:function(){return t(),s},pixelPosition:function(){return t(),r},reliableMarginLeft:function(){return t(),l},scrollboxSize:function(){return t(),a},reliableTrDimensions:function(){var t,n,r,i;return null==o&&(t=g.createElement("table"),n=g.createElement("tr"),r=g.createElement("div"),t.style.cssText="position:absolute;left:-11111px;border-collapse:separate",n.style.cssText="border:1px solid",n.style.height="1px",r.style.height="9px",r.style.display="block",he.appendChild(t).appendChild(n).appendChild(r),i=e.getComputedStyle(n),o=parseInt(i.height,10)+parseInt(i.borderTopWidth,10)+parseInt(i.borderBottomWidth,10)===n.offsetHeight,he.removeChild(t)),o}}))}();var Ze=["Webkit","Moz","ms"],Je=g.createElement("div").style,Qe={};function et(e){var t=w.cssProps[e]||Qe[e];return t||(e in Je?e:Qe[e]=function(e){for(var t=e[0].toUpperCase()+e.slice(1),n=Ze.length;n--;)if((e=Ze[n]+t)in Je)return e}(e)||e)}var tt=/^(none|table(?!-c[ea]).+)/,nt={position:"absolute",visibility:"hidden",display:"block"},rt={letterSpacing:"0",fontWeight:"400"};function it(e,t,n){var r=ce.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function at(e,t,n,r,i,a){var s="width"===t?1:0,o=0,l=0,u=0;if(n===(r?"border":"content"))return 0;for(;s<4;s+=2)"margin"===n&&(u+=w.css(e,n+de[s],!0,i)),r?("content"===n&&(l-=w.css(e,"padding"+de[s],!0,i)),"margin"!==n&&(l-=w.css(e,"border"+de[s]+"Width",!0,i))):(l+=w.css(e,"padding"+de[s],!0,i),"padding"!==n?l+=w.css(e,"border"+de[s]+"Width",!0,i):o+=w.css(e,"border"+de[s]+"Width",!0,i));return!r&&a>=0&&(l+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-a-l-o-.5))||0),l+u}function st(e,t,n){var r=Ye(e),i=(!p.boxSizingReliable()||n)&&"border-box"===w.css(e,"boxSizing",!1,r),a=i,s=qe(e,t,r),o="offset"+t[0].toUpperCase()+t.slice(1);if(je.test(s)){if(!n)return s;s="auto"}return(!p.boxSizingReliable()&&i||!p.reliableTrDimensions()&&C(e,"tr")||"auto"===s||!parseFloat(s)&&"inline"===w.css(e,"display",!1,r))&&e.getClientRects().length&&(i="border-box"===w.css(e,"boxSizing",!1,r),(a=o in e)&&(s=e[o])),(s=parseFloat(s)||0)+at(e,t,n||(i?"border":"content"),a,r,s)+"px"}function ot(e,t,n,r,i){return new ot.prototype.init(e,t,n,r,i)}w.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=qe(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,a,s,o=te(t),l=We.test(t),u=e.style;if(l||(t=et(o)),s=w.cssHooks[t]||w.cssHooks[o],void 0===n)return s&&"get"in s&&void 0!==(i=s.get(e,!1,r))?i:u[t];"string"==(a=typeof n)&&(i=ce.exec(n))&&i[1]&&(n=ge(e,t,i),a="number"),null!=n&&n==n&&("number"!==a||l||(n+=i&&i[3]||(w.cssNumber[o]?"":"px")),p.clearCloneStyle||""!==n||0!==t.indexOf("background")||(u[t]="inherit"),s&&"set"in s&&void 0===(n=s.set(e,n,r))||(l?u.setProperty(t,n):u[t]=n))}},css:function(e,t,n,r){var i,a,s,o=te(t);return We.test(t)||(t=et(o)),(s=w.cssHooks[t]||w.cssHooks[o])&&"get"in s&&(i=s.get(e,!0,n)),void 0===i&&(i=qe(e,t,r)),"normal"===i&&t in rt&&(i=rt[t]),""===n||n?(a=parseFloat(i),!0===n||isFinite(a)?a||0:i):i}}),w.each(["height","width"],(function(e,t){w.cssHooks[t]={get:function(e,n,r){if(n)return!tt.test(w.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?st(e,t,r):$e(e,nt,(function(){return st(e,t,r)}))},set:function(e,n,r){var i,a=Ye(e),s=!p.scrollboxSize()&&"absolute"===a.position,o=(s||r)&&"border-box"===w.css(e,"boxSizing",!1,a),l=r?at(e,t,r,o,a):0;return o&&s&&(l-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(a[t])-at(e,t,"border",!1,a)-.5)),l&&(i=ce.exec(n))&&"px"!==(i[3]||"px")&&(e.style[t]=n,n=w.css(e,t)),it(0,n,l)}}})),w.cssHooks.marginLeft=Ke(p.reliableMarginLeft,(function(e,t){if(t)return(parseFloat(qe(e,"marginLeft"))||e.getBoundingClientRect().left-$e(e,{marginLeft:0},(function(){return e.getBoundingClientRect().left})))+"px"})),w.each({margin:"",padding:"",border:"Width"},(function(e,t){w.cssHooks[e+t]={expand:function(n){for(var r=0,i={},a="string"==typeof n?n.split(" "):[n];r<4;r++)i[e+de[r]+t]=a[r]||a[r-2]||a[0];return i}},"margin"!==e&&(w.cssHooks[e+t].set=it)})),w.fn.extend({css:function(e,t){return Z(this,(function(e,t,n){var r,i,a={},s=0;if(Array.isArray(t)){for(r=Ye(e),i=t.length;s<i;s++)a[t[s]]=w.css(e,t[s],!1,r);return a}return void 0!==n?w.style(e,t,n):w.css(e,t)}),e,t,arguments.length>1)}}),w.Tween=ot,ot.prototype={constructor:ot,init:function(e,t,n,r,i,a){this.elem=e,this.prop=n,this.easing=i||w.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=a||(w.cssNumber[n]?"":"px")},cur:function(){var e=ot.propHooks[this.prop];return e&&e.get?e.get(this):ot.propHooks._default.get(this)},run:function(e){var t,n=ot.propHooks[this.prop];return this.options.duration?this.pos=t=w.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):ot.propHooks._default.set(this),this}},ot.prototype.init.prototype=ot.prototype,ot.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=w.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){w.fx.step[e.prop]?w.fx.step[e.prop](e):1!==e.elem.nodeType||!w.cssHooks[e.prop]&&null==e.elem.style[et(e.prop)]?e.elem[e.prop]=e.now:w.style(e.elem,e.prop,e.now+e.unit)}}},ot.propHooks.scrollTop=ot.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},w.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},w.fx=ot.prototype.init,w.fx.step={};var lt,ut,ct=/^(?:toggle|show|hide)$/,dt=/queueHooks$/;function ht(){ut&&(!1===g.hidden&&e.requestAnimationFrame?e.requestAnimationFrame(ht):e.setTimeout(ht,w.fx.interval),w.fx.tick())}function pt(){return e.setTimeout((function(){lt=void 0})),lt=Date.now()}function ft(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=de[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function mt(e,t,n){for(var r,i=(gt.tweeners[t]||[]).concat(gt.tweeners["*"]),a=0,s=i.length;a<s;a++)if(r=i[a].call(n,t,e))return r}function gt(e,t,n){var r,i,a=0,s=gt.prefilters.length,o=w.Deferred().always((function(){delete l.elem})),l=function(){if(i)return!1;for(var t=lt||pt(),n=Math.max(0,u.startTime+u.duration-t),r=1-(n/u.duration||0),a=0,s=u.tweens.length;a<s;a++)u.tweens[a].run(r);return o.notifyWith(e,[u,r,n]),r<1&&s?n:(s||o.notifyWith(e,[u,1,0]),o.resolveWith(e,[u]),!1)},u=o.promise({elem:e,props:w.extend({},t),opts:w.extend(!0,{specialEasing:{},easing:w.easing._default},n),originalProperties:t,originalOptions:n,startTime:lt||pt(),duration:n.duration,tweens:[],createTween:function(t,n){var r=w.Tween(e,u.opts,t,n,u.opts.specialEasing[t]||u.opts.easing);return u.tweens.push(r),r},stop:function(t){var n=0,r=t?u.tweens.length:0;if(i)return this;for(i=!0;n<r;n++)u.tweens[n].run(1);return t?(o.notifyWith(e,[u,1,0]),o.resolveWith(e,[u,t])):o.rejectWith(e,[u,t]),this}}),c=u.props;for(function(e,t){var n,r,i,a,s;for(n in e)if(i=t[r=te(n)],a=e[n],Array.isArray(a)&&(i=a[1],a=e[n]=a[0]),n!==r&&(e[r]=a,delete e[n]),(s=w.cssHooks[r])&&"expand"in s)for(n in a=s.expand(a),delete e[r],a)n in e||(e[n]=a[n],t[n]=i);else t[r]=i}(c,u.opts.specialEasing);a<s;a++)if(r=gt.prefilters[a].call(u,e,c,u.opts))return f(r.stop)&&(w._queueHooks(u.elem,u.opts.queue).stop=r.stop.bind(r)),r;return w.map(c,mt,u),f(u.opts.start)&&u.opts.start.call(e,u),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always),w.fx.timer(w.extend(l,{elem:e,anim:u,queue:u.opts.queue})),u}w.Animation=w.extend(gt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return ge(n.elem,e,ce.exec(t),n),n}]},tweener:function(e,t){f(e)?(t=e,e=["*"]):e=e.match(j);for(var n,r=0,i=e.length;r<i;r++)n=e[r],gt.tweeners[n]=gt.tweeners[n]||[],gt.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var r,i,a,s,o,l,u,c,d="width"in t||"height"in t,h=this,p={},f=e.style,m=e.nodeType&&me(e),g=ie.get(e,"fxshow");for(r in n.queue||(null==(s=w._queueHooks(e,"fx")).unqueued&&(s.unqueued=0,o=s.empty.fire,s.empty.fire=function(){s.unqueued||o()}),s.unqueued++,h.always((function(){h.always((function(){s.unqueued--,w.queue(e,"fx").length||s.empty.fire()}))}))),t)if(i=t[r],ct.test(i)){if(delete t[r],a=a||"toggle"===i,i===(m?"hide":"show")){if("show"!==i||!g||void 0===g[r])continue;m=!0}p[r]=g&&g[r]||w.style(e,r)}if((l=!w.isEmptyObject(t))||!w.isEmptyObject(p))for(r in d&&1===e.nodeType&&(n.overflow=[f.overflow,f.overflowX,f.overflowY],null==(u=g&&g.display)&&(u=ie.get(e,"display")),"none"===(c=w.css(e,"display"))&&(u?c=u:(_e([e],!0),u=e.style.display||u,c=w.css(e,"display"),_e([e]))),("inline"===c||"inline-block"===c&&null!=u)&&"none"===w.css(e,"float")&&(l||(h.done((function(){f.display=u})),null==u&&(c=f.display,u="none"===c?"":c)),f.display="inline-block")),n.overflow&&(f.overflow="hidden",h.always((function(){f.overflow=n.overflow[0],f.overflowX=n.overflow[1],f.overflowY=n.overflow[2]}))),l=!1,p)l||(g?"hidden"in g&&(m=g.hidden):g=ie.access(e,"fxshow",{display:u}),a&&(g.hidden=!m),m&&_e([e],!0),h.done((function(){for(r in m||_e([e]),ie.remove(e,"fxshow"),p)w.style(e,r,p[r])}))),l=mt(m?g[r]:0,r,h),r in g||(g[r]=l.start,m&&(l.end=l.start,l.start=0))}],prefilter:function(e,t){t?gt.prefilters.unshift(e):gt.prefilters.push(e)}}),w.speed=function(e,t,n){var r=e&&"object"==typeof e?w.extend({},e):{complete:n||!n&&t||f(e)&&e,duration:e,easing:n&&t||t&&!f(t)&&t};return w.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in w.fx.speeds?r.duration=w.fx.speeds[r.duration]:r.duration=w.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){f(r.old)&&r.old.call(this),r.queue&&w.dequeue(this,r.queue)},r},w.fn.extend({fadeTo:function(e,t,n,r){return this.filter(me).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=w.isEmptyObject(e),a=w.speed(t,n,r),s=function(){var t=gt(this,w.extend({},e),a);(i||ie.get(this,"finish"))&&t.stop(!0)};return s.finish=s,i||!1===a.queue?this.each(s):this.queue(a.queue,s)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&this.queue(e||"fx",[]),this.each((function(){var t=!0,i=null!=e&&e+"queueHooks",a=w.timers,s=ie.get(this);if(i)s[i]&&s[i].stop&&r(s[i]);else for(i in s)s[i]&&s[i].stop&&dt.test(i)&&r(s[i]);for(i=a.length;i--;)a[i].elem!==this||null!=e&&a[i].queue!==e||(a[i].anim.stop(n),t=!1,a.splice(i,1));!t&&n||w.dequeue(this,e)}))},finish:function(e){return!1!==e&&(e=e||"fx"),this.each((function(){var t,n=ie.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],a=w.timers,s=r?r.length:0;for(n.finish=!0,w.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=a.length;t--;)a[t].elem===this&&a[t].queue===e&&(a[t].anim.stop(!0),a.splice(t,1));for(t=0;t<s;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish}))}}),w.each(["toggle","show","hide"],(function(e,t){var n=w.fn[t];w.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(ft(t,!0),e,r,i)}})),w.each({slideDown:ft("show"),slideUp:ft("hide"),slideToggle:ft("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(e,t){w.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}})),w.timers=[],w.fx.tick=function(){var e,t=0,n=w.timers;for(lt=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||w.fx.stop(),lt=void 0},w.fx.timer=function(e){w.timers.push(e),w.fx.start()},w.fx.interval=13,w.fx.start=function(){ut||(ut=!0,ht())},w.fx.stop=function(){ut=null},w.fx.speeds={slow:600,fast:200,_default:400},w.fn.delay=function(t,n){return t=w.fx&&w.fx.speeds[t]||t,n=n||"fx",this.queue(n,(function(n,r){var i=e.setTimeout(n,t);r.stop=function(){e.clearTimeout(i)}}))},function(){var e=g.createElement("input"),t=g.createElement("select").appendChild(g.createElement("option"));e.type="checkbox",p.checkOn=""!==e.value,p.optSelected=t.selected,(e=g.createElement("input")).value="t",e.type="radio",p.radioValue="t"===e.value}();var vt,yt=w.expr.attrHandle;w.fn.extend({attr:function(e,t){return Z(this,w.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each((function(){w.removeAttr(this,e)}))}}),w.extend({attr:function(e,t,n){var r,i,a=e.nodeType;if(3!==a&&8!==a&&2!==a)return void 0===e.getAttribute?w.prop(e,t,n):(1===a&&w.isXMLDoc(e)||(i=w.attrHooks[t.toLowerCase()]||(w.expr.match.bool.test(t)?vt:void 0)),void 0!==n?null===n?void w.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:null==(r=w.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!p.radioValue&&"radio"===t&&C(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(j);if(i&&1===e.nodeType)for(;n=i[r++];)e.removeAttribute(n)}}),vt={set:function(e,t,n){return!1===t?w.removeAttr(e,n):e.setAttribute(n,n),n}},w.each(w.expr.match.bool.source.match(/\w+/g),(function(e,t){var n=yt[t]||w.find.attr;yt[t]=function(e,t,r){var i,a,s=t.toLowerCase();return r||(a=yt[s],yt[s]=i,i=null!=n(e,t,r)?s:null,yt[s]=a),i}}));var _t=/^(?:input|select|textarea|button)$/i,bt=/^(?:a|area)$/i;function xt(e){return(e.match(j)||[]).join(" ")}function wt(e){return e.getAttribute&&e.getAttribute("class")||""}function St(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(j)||[]}w.fn.extend({prop:function(e,t){return Z(this,w.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each((function(){delete this[w.propFix[e]||e]}))}}),w.extend({prop:function(e,t,n){var r,i,a=e.nodeType;if(3!==a&&8!==a&&2!==a)return 1===a&&w.isXMLDoc(e)||(t=w.propFix[t]||t,i=w.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=w.find.attr(e,"tabindex");return t?parseInt(t,10):_t.test(e.nodeName)||bt.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),p.optSelected||(w.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),w.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){w.propFix[this.toLowerCase()]=this})),w.fn.extend({addClass:function(e){var t,n,r,i,a,s;return f(e)?this.each((function(t){w(this).addClass(e.call(this,t,wt(this)))})):(t=St(e)).length?this.each((function(){if(r=wt(this),n=1===this.nodeType&&" "+xt(r)+" "){for(a=0;a<t.length;a++)i=t[a],n.indexOf(" "+i+" ")<0&&(n+=i+" ");s=xt(n),r!==s&&this.setAttribute("class",s)}})):this},removeClass:function(e){var t,n,r,i,a,s;return f(e)?this.each((function(t){w(this).removeClass(e.call(this,t,wt(this)))})):arguments.length?(t=St(e)).length?this.each((function(){if(r=wt(this),n=1===this.nodeType&&" "+xt(r)+" "){for(a=0;a<t.length;a++)for(i=t[a];n.indexOf(" "+i+" ")>-1;)n=n.replace(" "+i+" "," ");s=xt(n),r!==s&&this.setAttribute("class",s)}})):this:this.attr("class","")},toggleClass:function(e,t){var n,r,i,a,s=typeof e,o="string"===s||Array.isArray(e);return f(e)?this.each((function(n){w(this).toggleClass(e.call(this,n,wt(this),t),t)})):"boolean"==typeof t&&o?t?this.addClass(e):this.removeClass(e):(n=St(e),this.each((function(){if(o)for(a=w(this),i=0;i<n.length;i++)r=n[i],a.hasClass(r)?a.removeClass(r):a.addClass(r);else void 0!==e&&"boolean"!==s||((r=wt(this))&&ie.set(this,"__className__",r),this.setAttribute&&this.setAttribute("class",r||!1===e?"":ie.get(this,"__className__")||""))})))},hasClass:function(e){var t,n,r=0;for(t=" "+e+" ";n=this[r++];)if(1===n.nodeType&&(" "+xt(wt(n))+" ").indexOf(t)>-1)return!0;return!1}});var Ct=/\r/g;w.fn.extend({val:function(e){var t,n,r,i=this[0];return arguments.length?(r=f(e),this.each((function(n){var i;1===this.nodeType&&(null==(i=r?e.call(this,n,w(this).val()):e)?i="":"number"==typeof i?i+="":Array.isArray(i)&&(i=w.map(i,(function(e){return null==e?"":e+""}))),(t=w.valHooks[this.type]||w.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,i,"value")||(this.value=i))}))):i?(t=w.valHooks[i.type]||w.valHooks[i.nodeName.toLowerCase()])&&"get"in t&&void 0!==(n=t.get(i,"value"))?n:"string"==typeof(n=i.value)?n.replace(Ct,""):null==n?"":n:void 0}}),w.extend({valHooks:{option:{get:function(e){var t=w.find.attr(e,"value");return null!=t?t:xt(w.text(e))}},select:{get:function(e){var t,n,r,i=e.options,a=e.selectedIndex,s="select-one"===e.type,o=s?null:[],l=s?a+1:i.length;for(r=a<0?l:s?a:0;r<l;r++)if(((n=i[r]).selected||r===a)&&!n.disabled&&(!n.parentNode.disabled||!C(n.parentNode,"optgroup"))){if(t=w(n).val(),s)return t;o.push(t)}return o},set:function(e,t){for(var n,r,i=e.options,a=w.makeArray(t),s=i.length;s--;)((r=i[s]).selected=w.inArray(w.valHooks.option.get(r),a)>-1)&&(n=!0);return n||(e.selectedIndex=-1),a}}}}),w.each(["radio","checkbox"],(function(){w.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=w.inArray(w(e).val(),t)>-1}},p.checkOn||(w.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}));var Tt=e.location,Mt={guid:Date.now()},Et=/\?/;w.parseXML=function(t){var n,r;if(!t||"string"!=typeof t)return null;try{n=(new e.DOMParser).parseFromString(t,"text/xml")}catch(zA){}return r=n&&n.getElementsByTagName("parsererror")[0],n&&!r||w.error("Invalid XML: "+(r?w.map(r.childNodes,(function(e){return e.textContent})).join("\n"):t)),n};var At=/^(?:focusinfocus|focusoutblur)$/,Pt=function(e){e.stopPropagation()};w.extend(w.event,{trigger:function(t,n,r,i){var a,s,o,l,u,d,h,p,v=[r||g],y=c.call(t,"type")?t.type:t,_=c.call(t,"namespace")?t.namespace.split("."):[];if(s=p=o=r=r||g,3!==r.nodeType&&8!==r.nodeType&&!At.test(y+w.event.triggered)&&(y.indexOf(".")>-1&&(_=y.split("."),y=_.shift(),_.sort()),u=y.indexOf(":")<0&&"on"+y,(t=t[w.expando]?t:new w.Event(y,"object"==typeof t&&t)).isTrigger=i?2:3,t.namespace=_.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+_.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=r),n=null==n?[t]:w.makeArray(n,[t]),h=w.event.special[y]||{},i||!h.trigger||!1!==h.trigger.apply(r,n))){if(!i&&!h.noBubble&&!m(r)){for(l=h.delegateType||y,At.test(l+y)||(s=s.parentNode);s;s=s.parentNode)v.push(s),o=s;o===(r.ownerDocument||g)&&v.push(o.defaultView||o.parentWindow||e)}for(a=0;(s=v[a++])&&!t.isPropagationStopped();)p=s,t.type=a>1?l:h.bindType||y,(d=(ie.get(s,"events")||Object.create(null))[t.type]&&ie.get(s,"handle"))&&d.apply(s,n),(d=u&&s[u])&&d.apply&&ne(s)&&(t.result=d.apply(s,n),!1===t.result&&t.preventDefault());return t.type=y,i||t.isDefaultPrevented()||h._default&&!1!==h._default.apply(v.pop(),n)||!ne(r)||u&&f(r[y])&&!m(r)&&((o=r[u])&&(r[u]=null),w.event.triggered=y,t.isPropagationStopped()&&p.addEventListener(y,Pt),r[y](),t.isPropagationStopped()&&p.removeEventListener(y,Pt),w.event.triggered=void 0,o&&(r[u]=o)),t.result}},simulate:function(e,t,n){var r=w.extend(new w.Event,n,{type:e,isSimulated:!0});w.event.trigger(r,null,t)}}),w.fn.extend({trigger:function(e,t){return this.each((function(){w.event.trigger(e,t,this)}))},triggerHandler:function(e,t){var n=this[0];if(n)return w.event.trigger(e,t,n,!0)}});var Rt=/\[\]$/,Lt=/\r?\n/g,kt=/^(?:submit|button|image|reset|file)$/i,Dt=/^(?:input|select|textarea|keygen)/i;function It(e,t,n,r){var i;if(Array.isArray(t))w.each(t,(function(t,i){n||Rt.test(e)?r(e,i):It(e+"["+("object"==typeof i&&null!=i?t:"")+"]",i,n,r)}));else if(n||"object"!==_(t))r(e,t);else for(i in t)It(e+"["+i+"]",t[i],n,r)}w.param=function(e,t){var n,r=[],i=function(e,t){var n=f(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!w.isPlainObject(e))w.each(e,(function(){i(this.name,this.value)}));else for(n in e)It(n,e[n],t,i);return r.join("&")},w.fn.extend({serialize:function(){return w.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var e=w.prop(this,"elements");return e?w.makeArray(e):this})).filter((function(){var e=this.type;return this.name&&!w(this).is(":disabled")&&Dt.test(this.nodeName)&&!kt.test(e)&&(this.checked||!we.test(e))})).map((function(e,t){var n=w(this).val();return null==n?null:Array.isArray(n)?w.map(n,(function(e){return{name:t.name,value:e.replace(Lt,"\r\n")}})):{name:t.name,value:n.replace(Lt,"\r\n")}})).get()}});var Ot=/%20/g,Nt=/#.*$/,Bt=/([?&])_=[^&]*/,Ut=/^(.*?):[ \t]*([^\r\n]*)$/gm,zt=/^(?:GET|HEAD)$/,Ft=/^\/\//,Vt={},Gt={},Ht="*/".concat("*"),jt=g.createElement("a");function Wt(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,a=t.toLowerCase().match(j)||[];if(f(n))for(;r=a[i++];)"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function Yt(e,t,n,r){var i={},a=e===Gt;function s(o){var l;return i[o]=!0,w.each(e[o]||[],(function(e,o){var u=o(t,n,r);return"string"!=typeof u||a||i[u]?a?!(l=u):void 0:(t.dataTypes.unshift(u),s(u),!1)})),l}return s(t.dataTypes[0])||!i["*"]&&s("*")}function $t(e,t){var n,r,i=w.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&w.extend(!0,e,r),e}jt.href=Tt.href,w.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Tt.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Tt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ht,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":w.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?$t($t(e,w.ajaxSettings),t):$t(w.ajaxSettings,e)},ajaxPrefilter:Wt(Vt),ajaxTransport:Wt(Gt),ajax:function(t,n){"object"==typeof t&&(n=t,t=void 0),n=n||{};var r,i,a,s,o,l,u,c,d,h,p=w.ajaxSetup({},n),f=p.context||p,m=p.context&&(f.nodeType||f.jquery)?w(f):w.event,v=w.Deferred(),y=w.Callbacks("once memory"),_=p.statusCode||{},b={},x={},S="canceled",C={readyState:0,getResponseHeader:function(e){var t;if(u){if(!s)for(s={};t=Ut.exec(a);)s[t[1].toLowerCase()+" "]=(s[t[1].toLowerCase()+" "]||[]).concat(t[2]);t=s[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return u?a:null},setRequestHeader:function(e,t){return null==u&&(e=x[e.toLowerCase()]=x[e.toLowerCase()]||e,b[e]=t),this},overrideMimeType:function(e){return null==u&&(p.mimeType=e),this},statusCode:function(e){var t;if(e)if(u)C.always(e[C.status]);else for(t in e)_[t]=[_[t],e[t]];return this},abort:function(e){var t=e||S;return r&&r.abort(t),T(0,t),this}};if(v.promise(C),p.url=((t||p.url||Tt.href)+"").replace(Ft,Tt.protocol+"//"),p.type=n.method||n.type||p.method||p.type,p.dataTypes=(p.dataType||"*").toLowerCase().match(j)||[""],null==p.crossDomain){l=g.createElement("a");try{l.href=p.url,l.href=l.href,p.crossDomain=jt.protocol+"//"+jt.host!=l.protocol+"//"+l.host}catch(zA){p.crossDomain=!0}}if(p.data&&p.processData&&"string"!=typeof p.data&&(p.data=w.param(p.data,p.traditional)),Yt(Vt,p,n,C),u)return C;for(d in(c=w.event&&p.global)&&0==w.active++&&w.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!zt.test(p.type),i=p.url.replace(Nt,""),p.hasContent?p.data&&p.processData&&0===(p.contentType||"").indexOf("application/x-www-form-urlencoded")&&(p.data=p.data.replace(Ot,"+")):(h=p.url.slice(i.length),p.data&&(p.processData||"string"==typeof p.data)&&(i+=(Et.test(i)?"&":"?")+p.data,delete p.data),!1===p.cache&&(i=i.replace(Bt,"$1"),h=(Et.test(i)?"&":"?")+"_="+Mt.guid+++h),p.url=i+h),p.ifModified&&(w.lastModified[i]&&C.setRequestHeader("If-Modified-Since",w.lastModified[i]),w.etag[i]&&C.setRequestHeader("If-None-Match",w.etag[i])),(p.data&&p.hasContent&&!1!==p.contentType||n.contentType)&&C.setRequestHeader("Content-Type",p.contentType),C.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Ht+"; q=0.01":""):p.accepts["*"]),p.headers)C.setRequestHeader(d,p.headers[d]);if(p.beforeSend&&(!1===p.beforeSend.call(f,C,p)||u))return C.abort();if(S="abort",y.add(p.complete),C.done(p.success),C.fail(p.error),r=Yt(Gt,p,n,C)){if(C.readyState=1,c&&m.trigger("ajaxSend",[C,p]),u)return C;p.async&&p.timeout>0&&(o=e.setTimeout((function(){C.abort("timeout")}),p.timeout));try{u=!1,r.send(b,T)}catch(zA){if(u)throw zA;T(-1,zA)}}else T(-1,"No Transport");function T(t,n,s,l){var d,h,g,b,x,S=n;u||(u=!0,o&&e.clearTimeout(o),r=void 0,a=l||"",C.readyState=t>0?4:0,d=t>=200&&t<300||304===t,s&&(b=function(e,t,n){for(var r,i,a,s,o=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in o)if(o[i]&&o[i].test(r)){l.unshift(i);break}if(l[0]in n)a=l[0];else{for(i in n){if(!l[0]||e.converters[i+" "+l[0]]){a=i;break}s||(s=i)}a=a||s}if(a)return a!==l[0]&&l.unshift(a),n[a]}(p,C,s)),!d&&w.inArray("script",p.dataTypes)>-1&&w.inArray("json",p.dataTypes)<0&&(p.converters["text script"]=function(){}),b=function(e,t,n,r){var i,a,s,o,l,u={},c=e.dataTypes.slice();if(c[1])for(s in e.converters)u[s.toLowerCase()]=e.converters[s];for(a=c.shift();a;)if(e.responseFields[a]&&(n[e.responseFields[a]]=t),!l&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=a,a=c.shift())if("*"===a)a=l;else if("*"!==l&&l!==a){if(!(s=u[l+" "+a]||u["* "+a]))for(i in u)if((o=i.split(" "))[1]===a&&(s=u[l+" "+o[0]]||u["* "+o[0]])){!0===s?s=u[i]:!0!==u[i]&&(a=o[0],c.unshift(o[1]));break}if(!0!==s)if(s&&e.throws)t=s(t);else try{t=s(t)}catch(zA){return{state:"parsererror",error:s?zA:"No conversion from "+l+" to "+a}}}return{state:"success",data:t}}(p,b,C,d),d?(p.ifModified&&((x=C.getResponseHeader("Last-Modified"))&&(w.lastModified[i]=x),(x=C.getResponseHeader("etag"))&&(w.etag[i]=x)),204===t||"HEAD"===p.type?S="nocontent":304===t?S="notmodified":(S=b.state,h=b.data,d=!(g=b.error))):(g=S,!t&&S||(S="error",t<0&&(t=0))),C.status=t,C.statusText=(n||S)+"",d?v.resolveWith(f,[h,S,C]):v.rejectWith(f,[C,S,g]),C.statusCode(_),_=void 0,c&&m.trigger(d?"ajaxSuccess":"ajaxError",[C,p,d?h:g]),y.fireWith(f,[C,S]),c&&(m.trigger("ajaxComplete",[C,p]),--w.active||w.event.trigger("ajaxStop")))}return C},getJSON:function(e,t,n){return w.get(e,t,n,"json")},getScript:function(e,t){return w.get(e,void 0,t,"script")}}),w.each(["get","post"],(function(e,t){w[t]=function(e,n,r,i){return f(n)&&(i=i||r,r=n,n=void 0),w.ajax(w.extend({url:e,type:t,dataType:i,data:n,success:r},w.isPlainObject(e)&&e))}})),w.ajaxPrefilter((function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")})),w._evalUrl=function(e,t,n){return w.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){w.globalEval(e,t,n)}})},w.fn.extend({wrapAll:function(e){var t;return this[0]&&(f(e)&&(e=e.call(this[0])),t=w(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map((function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e})).append(this)),this},wrapInner:function(e){return f(e)?this.each((function(t){w(this).wrapInner(e.call(this,t))})):this.each((function(){var t=w(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)}))},wrap:function(e){var t=f(e);return this.each((function(n){w(this).wrapAll(t?e.call(this,n):e)}))},unwrap:function(e){return this.parent(e).not("body").each((function(){w(this).replaceWith(this.childNodes)})),this}}),w.expr.pseudos.hidden=function(e){return!w.expr.pseudos.visible(e)},w.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},w.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch(zA){}};var Xt={0:200,1223:204},qt=w.ajaxSettings.xhr();p.cors=!!qt&&"withCredentials"in qt,p.ajax=qt=!!qt,w.ajaxTransport((function(t){var n,r;if(p.cors||qt&&!t.crossDomain)return{send:function(i,a){var s,o=t.xhr();if(o.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(s in t.xhrFields)o[s]=t.xhrFields[s];for(s in t.mimeType&&o.overrideMimeType&&o.overrideMimeType(t.mimeType),t.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest"),i)o.setRequestHeader(s,i[s]);n=function(e){return function(){n&&(n=r=o.onload=o.onerror=o.onabort=o.ontimeout=o.onreadystatechange=null,"abort"===e?o.abort():"error"===e?"number"!=typeof o.status?a(0,"error"):a(o.status,o.statusText):a(Xt[o.status]||o.status,o.statusText,"text"!==(o.responseType||"text")||"string"!=typeof o.responseText?{binary:o.response}:{text:o.responseText},o.getAllResponseHeaders()))}},o.onload=n(),r=o.onerror=o.ontimeout=n("error"),void 0!==o.onabort?o.onabort=r:o.onreadystatechange=function(){4===o.readyState&&e.setTimeout((function(){n&&r()}))},n=n("abort");try{o.send(t.hasContent&&t.data||null)}catch(zA){if(n)throw zA}},abort:function(){n&&n()}}})),w.ajaxPrefilter((function(e){e.crossDomain&&(e.contents.script=!1)})),w.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return w.globalEval(e),e}}}),w.ajaxPrefilter("script",(function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")})),w.ajaxTransport("script",(function(e){var t,n;if(e.crossDomain||e.scriptAttrs)return{send:function(r,i){t=w("<script>").attr(e.scriptAttrs||{}).prop({charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i("error"===e.type?404:200,e.type)}),g.head.appendChild(t[0])},abort:function(){n&&n()}}}));var Kt,Zt=[],Jt=/(=)\?(?=&|$)|\?\?/;w.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Zt.pop()||w.expando+"_"+Mt.guid++;return this[e]=!0,e}}),w.ajaxPrefilter("json jsonp",(function(t,n,r){var i,a,s,o=!1!==t.jsonp&&(Jt.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Jt.test(t.data)&&"data");if(o||"jsonp"===t.dataTypes[0])return i=t.jsonpCallback=f(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,o?t[o]=t[o].replace(Jt,"$1"+i):!1!==t.jsonp&&(t.url+=(Et.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return s||w.error(i+" was not called"),s[0]},t.dataTypes[0]="json",a=e[i],e[i]=function(){s=arguments},r.always((function(){void 0===a?w(e).removeProp(i):e[i]=a,t[i]&&(t.jsonpCallback=n.jsonpCallback,Zt.push(i)),s&&f(a)&&a(s[0]),s=a=void 0})),"script"})),p.createHTMLDocument=((Kt=g.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Kt.childNodes.length),w.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(p.createHTMLDocument?((r=(t=g.implementation.createHTMLDocument("")).createElement("base")).href=g.location.href,t.head.appendChild(r)):t=g),a=!n&&[],(i=B.exec(e))?[t.createElement(i[1])]:(i=Pe([e],t,a),a&&a.length&&w(a).remove(),w.merge([],i.childNodes)));var r,i,a},w.fn.load=function(e,t,n){var r,i,a,s=this,o=e.indexOf(" ");return o>-1&&(r=xt(e.slice(o)),e=e.slice(0,o)),f(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),s.length>0&&w.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done((function(e){a=arguments,s.html(r?w("<div>").append(w.parseHTML(e)).find(r):e)})).always(n&&function(e,t){s.each((function(){n.apply(this,a||[e.responseText,t,e])}))}),this},w.expr.pseudos.animated=function(e){return w.grep(w.timers,(function(t){return e===t.elem})).length},w.offset={setOffset:function(e,t,n){var r,i,a,s,o,l,u=w.css(e,"position"),c=w(e),d={};"static"===u&&(e.style.position="relative"),o=c.offset(),a=w.css(e,"top"),l=w.css(e,"left"),("absolute"===u||"fixed"===u)&&(a+l).indexOf("auto")>-1?(s=(r=c.position()).top,i=r.left):(s=parseFloat(a)||0,i=parseFloat(l)||0),f(t)&&(t=t.call(e,n,w.extend({},o))),null!=t.top&&(d.top=t.top-o.top+s),null!=t.left&&(d.left=t.left-o.left+i),"using"in t?t.using.call(e,d):c.css(d)}},w.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each((function(t){w.offset.setOffset(this,e,t)}));var t,n,r=this[0];return r?r.getClientRects().length?(t=r.getBoundingClientRect(),n=r.ownerDocument.defaultView,{top:t.top+n.pageYOffset,left:t.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,r=this[0],i={top:0,left:0};if("fixed"===w.css(r,"position"))t=r.getBoundingClientRect();else{for(t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;e&&(e===n.body||e===n.documentElement)&&"static"===w.css(e,"position");)e=e.parentNode;e&&e!==r&&1===e.nodeType&&((i=w(e).offset()).top+=w.css(e,"borderTopWidth",!0),i.left+=w.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-w.css(r,"marginTop",!0),left:t.left-i.left-w.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var e=this.offsetParent;e&&"static"===w.css(e,"position");)e=e.offsetParent;return e||he}))}}),w.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(e,t){var n="pageYOffset"===t;w.fn[e]=function(r){return Z(this,(function(e,r,i){var a;if(m(e)?a=e:9===e.nodeType&&(a=e.defaultView),void 0===i)return a?a[t]:e[r];a?a.scrollTo(n?a.pageXOffset:i,n?i:a.pageYOffset):e[r]=i}),e,r,arguments.length)}})),w.each(["top","left"],(function(e,t){w.cssHooks[t]=Ke(p.pixelPosition,(function(e,n){if(n)return n=qe(e,t),je.test(n)?w(e).position()[t]+"px":n}))})),w.each({Height:"height",Width:"width"},(function(e,t){w.each({padding:"inner"+e,content:t,"":"outer"+e},(function(n,r){w.fn[r]=function(i,a){var s=arguments.length&&(n||"boolean"!=typeof i),o=n||(!0===i||!0===a?"margin":"border");return Z(this,(function(t,n,i){var a;return m(t)?0===r.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(a=t.documentElement,Math.max(t.body["scroll"+e],a["scroll"+e],t.body["offset"+e],a["offset"+e],a["client"+e])):void 0===i?w.css(t,n,o):w.style(t,n,i,o)}),t,s?i:void 0,s)}}))})),w.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(e,t){w.fn[t]=function(e){return this.on(t,e)}})),w.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),w.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(e,t){w.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}));var Qt=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;w.proxy=function(e,t){var n,r,a;if("string"==typeof t&&(n=e[t],t=e,e=n),f(e))return r=i.call(arguments,2),a=function(){return e.apply(t||this,r.concat(i.call(arguments)))},a.guid=e.guid=e.guid||w.guid++,a},w.holdReady=function(e){e?w.readyWait++:w.ready(!0)},w.isArray=Array.isArray,w.parseJSON=JSON.parse,w.nodeName=C,w.isFunction=f,w.isWindow=m,w.camelCase=te,w.type=_,w.now=Date.now,w.isNumeric=function(e){var t=w.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},w.trim=function(e){return null==e?"":(e+"").replace(Qt,"$1")};var en=e.jQuery,tn=e.$;return w.noConflict=function(t){return e.$===w&&(e.$=tn),t&&e.jQuery===w&&(e.jQuery=en),w},void 0===t&&(e.jQuery=e.$=w),w},{get exports(){return B7},set exports(e){B7=e}}.exports=O7.document?N7(O7,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return N7(e)};const U7=B7,z7=Ri('<div class="mask bg-[url(/ui/3.png)] bg-no-repeat bg-full absolute w-full h-full z-[500]"></div><div class="bg-[url(/ui/1.png)] bg-no-repeat bg-full absolute w-[73%] h-[28%] z-[500] left-[24%] top-[69%]"></div><div class="bg-[url(/ui/2.png)] bg-no-repeat bg-full absolute w-full h-[12%] z-[500]"></div><div class="bg-[url(/ui/4.png)] bg-no-repeat bg-full absolute top-[12%] right-[2%] w-[20%] h-[56%] z-[500]"></div><div class="bg-[url(/ui/5.png)] bg-no-repeat bg-full absolute w-[20%] h-[85%] left-[2%] top-[12%] z-[500]"></div>',5),F7={class:"absolute z-[99999999] top-[3.8%] text-[18px] leading-[18px] right-[1.6%] font-extrabold text-white"},V7=Ti("div",{id:"threeContainer",class:"w-[100%] overflow-hidden h-[100%] absolute bg-black"},null,-1),G7=Fn({__name:"example0",setup(e){let n=At(null);return Kn((()=>{let e=new class{constructor(e,n){t(this,"mixer"),t(this,"clock"),t(this,"container"),t(this,"scene"),t(this,"renderer"),t(this,"camera"),t(this,"ambientLight"),t(this,"light"),t(this,"delta"),t(this,"dracoLoader"),t(this,"loader"),t(this,"controls"),t(this,"css2DRenderer"),t(this,"cameraTarget"),t(this,"defaultControls"),t(this,"_R",2e3),t(this,"directionalLight"),t(this,"_sunLightHeightRad"),t(this,"_noonTimeNum"),t(this,"_currentRotateRad"),t(this,"cameraDefaults"),t(this,"css3DRenderer"),t(this,"composer"),t(this,"clickStatus"),t(this,"sceneBackground"),
//!######################### three基础 #########################
t(this,"Vector2",(function(e){const t=e||{};return new l$(t.x||0,t.y||0)})),t(this,"Vector3",(function(e){const t=e||{};return new I$(t.x||0,t.y||0,t.z||0)})),t(this,"color",(function(e,t,n){return new eq(e||0,t||0,n||0)})),t(this,"sunLight",(e=>{this._sunLightHeightRad=T5.getSunLightHeightRad(e.lat,new Date);let t=new J0(14474460,.8),n=new Z0(16777215,1);n.position.set(0,this._R*Math.sin(this._sunLightHeightRad),this._R*Math.cos(this._sunLightHeightRad)),n.shadow.camera.near=.5,n.shadow.camera.far=1e4,n.shadow.camera.left=-500,n.shadow.camera.right=500,n.shadow.camera.top=500,n.shadow.camera.bottom=-500,n.shadow.mapSize.set(4096,4096),n.castShadow=!0,this.scene.add(t),this.scene.add(n),this.ambientLight=t,this.directionalLight=n,this._currentRotateRad=0,this._sunLightHeightRad=T5.getSunLightHeightRad(e.lat,new Date),this._noonTimeNum=T5.getSunTime(e.lon,e.lat,new Date).noonTimeNum,setInterval((()=>{const t=Math.PI*((new Date).getHours()-this._noonTimeNum)/12,n=t-this._currentRotateRad,r=new I$(0,Math.tan(e.lat),-1);!function(e,t,n){const r=new cX;r.makeRotationAxis(t.normalize(),n);const i=new P$(e.position.x,e.position.y,e.position.z,1).applyMatrix4(r);e.position.x=i.x,e.position.y=i.y,e.position.z=i.z}(this.directionalLight,r,-n),this._currentRotateRad=t,this.ambientLight.intensity=.6}),1e3);const r=new j0(16383933);let i=100*Math.random(),a=100*Math.random();r.position.set(i,50,a),r.angle=Math.PI/3,r.distance=100,r.castShadow=!0,r.shadow.bias=.2,r.decay=2,r.penumbra=.95;var s=new zq(0,0,0),o=new s0({color:16711680}),l=new Bq(s,o);l.position.set(i,0,a),this.scene.add(l),r.target=l})),t(this,"plane",(function(){const e=(new B0).load("https://fastly.jsdelivr.net/gh/cjhayes16/oss/grass2.jpg");e.wrapS=e.wrapT=sY,e.repeat.set(100,100),e.anisotropy=4;const t=new r0;t.map=e;let n=new QQ(0),r=new Bq(n,t);r.position.y=-10,r.rotation.x=-Math.PI/2,r.receiveShadow=!0,r.castShadow=!0,this.scene.add(r)})),t(this,"resize",(function(){let e=this;window.onresize=function(){e.camera.aspect=e.container.offsetWidth/e.container.offsetHeight,e.camera.updateProjectionMatrix(),e.renderer.setSize(e.container.offsetWidth,e.container.offsetHeight),e.composer.setSize(e.container.offsetWidth,e.container.offsetHeight)}})),
//! ######################### 鼠标拾取 #########################
t(this,"getIntersection",(function(e){try{let t=function(e){o.set(e.offsetX/c.container.offsetWidth*2-1,-e.offsetY/c.container.offsetHeight*2+1),l.setFromCamera(o,c.camera),u=l.intersectObjects(c.scene.children,a);for(var t=0;t<u.length;t++);i(e,u)};const n=e||{},r=n.dom?n.dom:null,i=n.callBack?n.callBack:{},a=n.trueOfalse?n.trueOfalse:{},s=n.eventType?n.eventType:{};let o=new l$,l=new g1,u=null;const c=this;c.mouse=o,console.log(c.clickStatus,c),s.click&&(c.clickStatus.click=!0),s.mousemove&&(c.clickStatus.mousemove=!0),s.dblclick&&(c.clickStatus.dblclick=!0),s.mouseover&&(c.clickStatus.mouseover=!0),c.clickStatus.click&&r.bind("click",t),c.clickStatus.mousemove&&r.bind("mousemove",t),c.clickStatus.dblclick&&r.bind("dblclick",t),c.clickStatus.mouseover&&r.mouseover(t)}catch(t){console.error(t)}})),t(this,"animate",(function(){this.delta=this.clock.getDelta(),this.mixer&&this.mixer.update(this.delta),this.composer.render(),requestAnimationFrame((()=>{this.animate()}))}));
//!############################ 初始化 #########################
var r=n||{};this.mixer=null,this.clock=new n1,this.sceneBackground=r.sceneBackground,this.container=document.getElementById(e),this.renderer=new BJ({antialias:!0,alpha:!0,logarithmicDepthBuffer:!0,precision:"highp",preserveDrawingBuffer:!0}),this.renderer.autoClear=!1,this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.container.offsetWidth,this.container.offsetHeight),this.container.append(this.renderer.domElement),this.renderer.setClearAlpha(0),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=GW,this.css2DRenderer=new D4,this.css2DRenderer.setSize(this.container.offsetWidth,this.container.offsetHeight),this.css2DRenderer.domElement.style.position="absolute",this.css2DRenderer.domElement.style.top=0,this.css2DRenderer.domElement.style.zIndex=99990,this.css2DRenderer.domElement.style.pointerEvents="auto",this.container.appendChild(this.css2DRenderer.domElement),this.css3DRenderer=new D4,this.css3DRenderer.setSize(this.container.offsetWidth,this.container.offsetHeight),this.css3DRenderer.domElement.style.position="absolute",this.css3DRenderer.domElement.style.top="0px",this.css3DRenderer.domElement.style.pointerEvents="none",this.container.appendChild(this.css3DRenderer.domElement),this.css3DRenderer.domElement.className="css3DContainer",this.renderer.sortObjects=n.sortObjects,
//!######################### 场景初始化 #########################
//! 背景设置    hdr    color     skybox
this.scene=new UJ,this.scene.background=null;const i=new MK(this.renderer);i.compileEquirectangularShader();const a=this.scene;let s=this;(new q4).load("/hdr/"+M5[0],(function(e){const t=i.fromEquirectangular(e).texture;i.dispose(),a.environment=t,s.sceneBackground||(a.background=t)})),
//!######################### 摄像机初始化 #######################
this.cameraDefaults={posCamera:new I$(n.posCamera.x||213.49452644234486,n.posCamera.y||247.82035694766302,n.posCamera.z||262.00785041743273),posCameraTarget:new I$(n.posCameraTarget.x||125.58831866036381,n.posCameraTarget.y||-45.62614299714993,n.posCameraTarget.z||-117.83143004368516),near:n.near||1,far:n.far||1e6,fov:n.fov||45},this.camera=new Yq(this.cameraDefaults.fov,this.container.offsetWidth/this.container.offsetHeight,this.cameraDefaults.near,this.cameraDefaults.far),this.cameraTarget=this.cameraDefaults.posCameraTarget,this.camera.position.copy(this.cameraDefaults.posCamera),this.camera.aspect=this.container.offsetWidth/this.container.offsetHeight,this.camera.lookAt(this.cameraTarget),this.camera.updateProjectionMatrix(),
//!######################### 灯光初始化 #########################
this.ambientLight=new J0(n.lightColor||14671839,n.lightDegree?n.lightDegree:0),this.scene.add(this.ambientLight),
//!######################### 控制初始化 #########################
this.controls=new M4(this.camera,this.css2DRenderer.domElement),this.controls.autoRotate=!1,this.controls.maxPolarAngle=3*Math.PI/8,this.controls.minPolarAngle=0,this.controls.maxDistance=1e7,this.controls.minDistance=50,this.controls.autoRotateSpeed=-.4,this.defaultControls=this.controls,
//!######################### 初始化后处理编译器 #########################
this.composer=new W4(this.renderer);const o=new U4(this.scene,this.camera);this.composer.addPass(o),this.clickStatus={click:!1,dblclick:!1,mousemove:!1,mouseover:!1},this.resize(),this.animate()}addModel(){this.dracoLoader=new _2,this.dracoLoader.setDecoderPath("jsm/libs/draco/gltf/"),this.loader=new S1,this.loader.setDRACOLoader(this.dracoLoader);let e=this;this.loader.load("/model/glb/modern_city_block2.glb",(function(t){const n=t.scene;n.traverse((function(e){e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0)})),n.position.set(0,0,0),n.scale.set(.01,.01,.01),e.scene.add(n),e.camera.lookAt(new I$(0,0,0)),e.mixer=new f1(n),e.animate()}),void 0,(function(e){console.error(e)}))}addGlobe({modelUrl:e}){this.dracoLoader=new _2,this.dracoLoader.setDecoderPath("jsm/libs/draco/gltf/"),this.loader=new S1,this.loader.setDRACOLoader(this.dracoLoader);let t=this;this.loader.load(e,(function(e){const n=e.scene;n.traverse((function(e){e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0)})),n.position.set(0,50,0),n.scale.set(600,600,600),t.scene.add(n),t.camera.lookAt(new I$(0,0,0)),t.mixer=new f1(n),t.animate()}),void 0,(function(e){console.error(e)}))}
//! ######################### 点线面墙 #########################
addPoint(e){const t=e||{},n=t.content?t.content:"",r=t.css?t.css:"",i=document.createElement("div");i.className="labelTxtdiv",i.id=n,i.innerHTML=n,i.style.fontSize=r.fontSize||"1rem",i.style.width=r.width||"auto",i.style.height=r.height||"32px",i.style.color=r.color||"#0f0",i.style.fontWeight=r.fontWeight||600,i.style.textAlign=r.textAlign||"center",i.style.padding=r.padding||"10px",i.style.zIndex=r.zIndex||1100,i.style.backgroundImage=r.backgroundImage||"url('/shanxin.png')",i.style.backgroundRepeat=r.backgroundRepeat||"no-repeat",i.style.backgroundSize=r.backgroundSize||"100% 100%",i.style.backgroundPosition=r.backgroundPosition||"100% 100%";const a=new E4(i),s=t.position?t.position:{};a.position.set(s.x,s.y,s.z),Object.assign(a,{attribute:t.data?t.data:{}});let o=e.groupName?e.groupName:"未命名标签";if(this.searchObjByName(o).length>0)return this.searchObjByName(o)[0].add(a),this.searchObjByName(o)[0];{let e=new PJ;return e.name=o,e.add(a),this.scene.add(e),e}}addLine(e){let t,n,r,i;const a=[],s=[],o=[new I$(0,10,0),new I$(0,0,10),new I$(10,0,0),new I$(20,0,0)],l=new JQ(o),u=Math.round(2*o.length),c=new I$,d=new eq;for(let f=0,m=u;f<m;f++){const e=f/m;l.getPoint(e,c),a.push(c.x,c.y,c.z),d.setHSL(e,1,.5,UY),s.push(d.r,d.g,d.b)}const h=new g5;h.setPositions(a),r=new Q4({color:16777215,linewidth:10,vertexColors:!0,resolution:new l$(window.innerWidth,window.innerHeight),dashed:!1,alphaToCoverage:!0}),t=new v5(h,r),t.computeLineDistances(),t.scale.set(1,1,1),this.scene.add(t);const p=new _q;p.setAttribute("position",new dq(a,3)),p.setAttribute("color",new dq(s,3)),i=new AQ({vertexColors:!0}),new o0({vertexColors:!0,scale:2,dashSize:1,gapSize:1}),n=new IQ(p,i),n.computeLineDistances(),n.visible=!1,this.scene.add(n)}
//! ######################### 查找模型 #########################
searchObjByName(e){let t=[];if(null!=this.scene.getObjectByName(e)){t.push(this.scene.getObjectByName(e));for(let n=0;n<this.scene.getObjectByName(e).parent.children.length;n++)this.scene.getObjectByName(e).parent.children[n].name==e&&t.push(this.scene.getObjectByName(e).parent.children[n]);for(let n=0;n<this.scene.getObjectByName(e).children.length;n++)this.scene.getObjectByName(e).children[n].name==e&&t.push(this.scene.getObjectByName(e).children[n])}return t.length,t}
//! ######################### 后处理特效 #########################
outLinePostProcess(){const e={edgeStrength:20,edgeGlow:1,edgeThickness:4,pulsePeriod:0,rotate:!1,usePatternTexture:!1,color:this.color(1,1,1)},t=new Y4(this.Vector2({x:this.container.offsetWidth,y:this.container.offsetHeight}),this.scene,this.camera);t.edgeStrength=e.edgeStrength,t.edgeGlow=e.edgeGlow,t.edgeThickness=e.edgeThickness,t.pulsePeriod=e.pulsePeriod,t.usePatternTexture=!1,t.visibleEdgeColor.set(e.color),t.hiddenEdgeColor.set("#ffffff"),this.composer.addPass(t)}bloomPassPostProcess(){const e=2.25,t=.47,n=.82,r=new V4(new l$(256,256),1,1.1,.18);r.threshold=t,r.strength=e,r.radius=n,this.composer.addPass(r);const i=new G4(new jq({uniforms:{baseTexture:{value:null},bloomTexture:{value:this.composer.renderTarget2.texture}},vertexShader:document.getElementById("vertexshader").textContent,fragmentShader:document.getElementById("fragmentshader").textContent,defines:{}}),"baseTexture");i.needsSwap=!0;const a=new X4(QW),s=new W4(this.renderer),o=new U4(this.scene,this.camera);s.addPass(o),s.addPass(i),s.addPass(a)}}("threeContainer",{posCamera:{x:319.60983211709095,y:268.99600259328616,z:342.0291953769038},posCameraTarget:{},lightColor:"#ffffff",lightDegree:0});P5.locales(),setInterval((()=>{n.value=P5().format("YYYY-MM-DD HH:mm:ss ")}),1e3),e.plane(),e.addModel(),e.getIntersection({dom:U7("#threeContainer"),callBack:(e,t)=>{console.log(e,t)},eventType:{click:!0,mousemove:!1,dblclick:!1,mouseover:!1},trueOfalse:!0})})),(e,t)=>(fi(),yi(li,null,[Ti("div",{class:"absolute z-50 bg-[#fff] w-10 h-5 top-5 right-5",onClick:t[0]||(t[0]=e=>Dt(undefined)())}),z7,Ti("div",F7,f(Dt(n)),1),V7],64))}}),H7=["varying vec3 vNormal;","void main() {","vNormal = normalize( normalMatrix * normal );","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),j7=["uniform float c;","uniform float p;","varying vec3 vNormal;","void main() {","float intensity = pow( c - dot( vNormal, vec3( 0.0, 0.0, 1.0 ) ), p );","gl_FragColor = vec4( 0.2, 0.58, 0.9, 0.3 ) * intensity;","}"].join("\n"),W7=[{name:"namibia",coord:[-19.2,14.11666667],position:[4.6,-1.29,-2.42],cameraFarPosition:[-20.03,13.47,-14.61],cameraNearPosition:[-3.54,2.38,-2.58],imageName:"iNambia",coordSpriteIndex:4,videoSprite:[10.8,19.1],soundSprite:[0,10.057142857142857]},{name:"mariana",coord:[18.25,142.81666667],position:[-4.39,2.66,-2.41],cameraFarPosition:[26.46,-6.94,-9.96],cameraNearPosition:[4.52,-1.3,-1.63],imageName:"iMariana",coordSpriteIndex:3,videoSprite:[2.8,8.4],soundSprite:[24,34.10938775510204]},{name:"greenland",coord:[72.16666667,-43],position:[1.88,5.09,.89],cameraFarPosition:[7.24,26.52,7.06],cameraNearPosition:[1.3,4.66,1.24],imageName:"iGreenland",coordSpriteIndex:2,videoSprite:[40.2,47.8],soundSprite:[48,58.10938775510204]},{name:"galapagos",coord:[1.33333333,-91.15],position:[.55,.024,5.39],cameraFarPosition:[-.6,.14,28.21],cameraNearPosition:[-.1,.024,4.99],imageName:"iGalapagos",coordSpriteIndex:1,videoSprite:[22,37.43],soundSprite:[12,22.057142857142857]},{name:"antarctica",coord:[-77.96666667,-155.63333333],position:[-1.32,-5.05,.98],cameraFarPosition:[-7.88,-27,1.87],cameraNearPosition:[-1.39,-4.75,.33],imageName:"iAntarcica",coordSpriteIndex:0,videoSprite:[50.9,69],soundSprite:[36,46.05714285714286]}];class Y7{constructor(e,n){t(this,"container"),t(this,"width"),t(this,"height"),t(this,"hasGlow"),t(this,"autoRotate"),t(this,"rotationSpeed"),t(this,"cloudSpeed"),t(this,"renderer"),t(this,"scene"),t(this,"camera"),t(this,"earthGroup"),t(this,"locationGroup"),t(this,"cloud"),t(this,"blurScene"),t(this,"glowGroup"),t(this,"blurComposer"),t(this,"sceneComposer"),t(this,"controller"),t(this,"isStart"),this.container="string"==typeof e?document.getElementById(e):e,this.width=this.container.offsetWidth,this.height=this.container.offsetHeight,this.hasGlow=!1,this.autoRotate=!0,this.camera=null,this.renderer=null,this.controller=null,this.scene=null,this.earthGroup=null,this.locationGroup=null,this.cloud=null,this.rotationSpeed=.001,this.cloudSpeed=-3e-4,this.init()}init(){let e=new BJ({alpha:!0,antialias:!0,preserveDrawingBuffer:!0}),t=this.container;e.setClearColor(0,0),e.setSize(this.width,this.height),e.domElement.style.position="relative",t.appendChild(e.domElement),this.renderer=e,this.scene=new UJ,this.earthGroup=new PJ,this.locationGroup=new PJ,this.scene.add(this.earthGroup),this.earthGroup.add(this.locationGroup);let n=new Yq(40,this.width/this.height,.1,1e3);n.position.set(0,0,-25),this.scene.add(n),this.camera=n,this.scene.add(new J0(3750201,.5));let r=new j0(16777215,2);r.position.set(36,0,10),r.angle=.2,r.castShadow=!1,r.penumbra=.4,r.distance=124,r.decay=1,r.shadow.camera.near=50,r.shadow.camera.far=200,r.shadow.camera.fov=35,r.shadow.mapSize.height=1024,r.shadow.mapSize.width=1024,this.camera.add(r);let i=new B0;i.crossOrigin="";let a=new Bq(new e0(5,32,32),new a0({map:i.load("https://fastly.jsdelivr.net/gh/cjhayes16/oss/earth4.jpg"),bumpMap:i.load("https://fastly.jsdelivr.net/gh/cjhayes16/oss/earth_bump.jpg"),bumpScale:.15,specularMap:i.load("https://fastly.jsdelivr.net/gh/cjhayes16/oss/earth_spec.jpg"),specular:new eq("#909090"),shininess:5,transparent:!0}));this.earthGroup.add(a);let s=new Bq(new e0(5.2,40,40),new a0({map:i.load("https://fastly.jsdelivr.net/gh/cjhayes16/oss/earth_cloud.png"),transparent:!0,opacity:1,blending:2}));this.earthGroup.add(s),this.earthGroup.position.set(0,1,0),this.cloud=s,W7.forEach((e=>{let t=function(e){let t=new B0;t.crossOrigin="";let n=new GJ({map:t.load("https://fastly.jsdelivr.net/gh/cjhayes16/oss/i_"+e.name+".png"),color:16777215,fog:!0}),r=new nQ(n);return r.position.set(e.position[0],e.position[1],e.position[2]),r.scale.set(1.4,1.4,1.4),r}(e);this.locationGroup.add(t)})),this.blurScene=new UJ,this.glowGroup=new PJ;let o=new e0(5,40,40),l=new jq({uniforms:{c:{type:"f",value:.34},p:{type:"f",value:9.17}},vertexShader:H7,fragmentShader:j7}),u=new Bq(o,l);u.material.side=YW,u.material.transparent=!1,u.scale.x=u.scale.y=u.scale.z=1.3,this.glowGroup.add(u);let c=new e0(5,40,40),d=new nq({color:0}),h=new Bq(c,d);h.material.transparent=!1,this.glowGroup.add(h),this.blurScene.add(this.glowGroup);let p=new R$(this.width,this.height,{minFilter:hY,magFilter:hY,format:xY,stencilBuffer:!0}),f=new U4(this.blurScene,this.camera),m=new U4(this.scene,this.camera);this.blurComposer=new W4(this.renderer,p),this.blurComposer.addPass(f),this.sceneComposer=new W4(this.renderer,p),this.sceneComposer.addPass(m);let g=new G4({uniforms:{tSampler1:{type:"t",value:null},tSampler2:{type:"t",value:null}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tSampler1;","uniform sampler2D tSampler2;","varying vec2 vUv;","void main() {","vec4 texture1 = texture2D( tSampler1, vUv );","vec4 texture2 = texture2D( tSampler2, vUv );","gl_FragColor = texture1 + texture2;","}"].join("\n")},"tSampler1");g.uniforms.tSampler2.value=this.blurComposer.renderTarget2.texture,g.renderToScreen=!0,this.sceneComposer.addPass(g),this.hasGlow=!0;let v=new M4(this.camera,this.renderer.domElement);v.rotateSpeed=.3,v.autoRotate=!1,v.enableZoom=!1,v.enablePan=!1,v.enabled=!0,this.controller=v,this.loop(),this.resize()}loop(){requestAnimationFrame((()=>{this.loop()})),this._animate(),this._render()}_animate(){let e=this.rotationSpeed,t=this.cloudSpeed;this.autoRotate&&(this.camera.position.x=this.camera.position.x*Math.cos(e)-this.camera.position.z*Math.sin(e),this.camera.position.z=this.camera.position.z*Math.cos(e)+this.camera.position.x*Math.sin(e)),this.cloud.rotation.y+=t,this.controller.update()}_render(){this.isStart&&this.hasGlow?(this.blurComposer.render(),this.sceneComposer.render()):(this.renderer.render(this.scene,this.camera),this.isStart=!0)}resize(){let e=this;window.onresize=function(){e.camera.aspect=e.container.offsetWidth/e.container.offsetHeight,e.camera.updateProjectionMatrix(),e.renderer.setSize(e.container.offsetWidth,e.container.offsetHeight),e.blurComposer.setSize(e.container.offsetWidth,e.container.offsetHeight),e.sceneComposer.setSize(e.container.offsetWidth,e.container.offsetHeight)}}}const $7=Ri('<div class="absolute z-[99999999] top-[4%] flex items-center justify-center text-[18px] leading-[18px] w-1/2 right-1/4 text-center tracking-[0.2rem] text-white"><div class="ml-[50px] h-[50px] flex flex-col cursor-pointer mr-[50px]"> 数据统计 <img class="mt-[10px]" src="https://fastly.jsdelivr.net/gh/cjhayes16/oss/e10.png" alt="" srcset=""></div><div class="ml-[50px] h-[50px] flex flex-col cursor-pointer opacity-30 mr-[50px]"> 应急资源 </div><div class="ml-[50px] h-[50px] flex flex-col cursor-pointer opacity-30 mr-[50px]"> 数据监测 </div></div>',1),X7={class:"absolute z-[99999999] top-[5%] text-[1vw] leading-[18px] right-[2%] h-[7vh] text-right font-extrabold items-center justify-end flex content-start font-[DigitalNumbers] text-white"},q7=Ti("img",{class:"ml-[-4%] mr-[-6%]",src:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/cloud.png",alt:"",srcset:""},null,-1),K7={class:"h-[7vh] leading-[7vh] text-[2rem] tracking-[-0.4rem] mr-[0.8rem] font-extrabold"},Z7=Ti("div",{class:"h-[2.3vh] leading-[2vh] text-left text-[#979797] text-[0.1vw]"},"Date",-1),J7={class:"h-[2.3vh] leading-[2vh] text-[1vw]"},Q7=Ri('<div class="bg-[url(/ui/e2.png)] bg-no-repeat bg-full absolute w-[10vw] h-[6.7vh] z-[500] left-[2.5vw] top-[5.4vh]"></div><div class="bg-[url(/ui/e3.png)] bg-no-repeat bg-full absolute w-[21.3vw] h-[16.12vh] z-[500] left-[2.5vw] top-[15.09vh]"></div><div class="bg-[url(/ui/e4.png)] bg-no-repeat bg-full absolute w-[21.3vw] h-[30.55vh] z-[500] left-[2.5vw] top-[32.25vh]"></div><div class="bg-[url(/ui/e5.png)] bg-no-repeat bg-full absolute w-[21.3vw] h-[29.13vh] z-[500] left-[2.5vw] top-[64.34vh]"></div><div class="bg-[url(/ui/e6.png)] bg-no-repeat bg-full absolute w-[24.79vw] h-[20.37vh] z-[500] left-[24.83vw] top-[73.10vh]"></div><div class="bg-[url(/ui/e7.png)] bg-no-repeat bg-full absolute w-[24.79vw] h-[20.41vh] z-[500] left-[50.47vw] top-[73.06vh]"></div><div class="bg-[url(/ui/e9.png)] bg-no-repeat bg-full absolute w-[21.35vw] h-[41.51vh] z-[500] left-[76.09vw] top-[13.55vh]"></div><div class="bg-[url(/ui/e8.png)] bg-no-repeat bg-full absolute w-[21.35vw] h-[35.98vh] z-[500] left-[76.09vw] top-[57.48vh]"></div><div class="bg-[url(/ui/e0.png)] bg-no-repeat bg-full absolute w-[98%] h-[98%] z-[500] left-[1%] top-[1%]"></div><div class="bg-[url(/ui/e1.png)] bg-no-repeat bg-full absolute w-[100%] h-[100%] z-[0] left-[0vw] top-[0vw]"></div><div id="threeContainer" class="w-[100%] overflow-hidden h-[100%] absolute"></div>',11),eee=[{path:"/jhayes3dBase",name:"",component:"",meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/JHAYESGL.png"},children:[]},{path:"/example3d0",name:"",component:"",meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/JHAYESGL.png"},children:[{path:"/test3d0",name:"案例1",component:G7,meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/project1.png"}},{path:"/test3d1",name:"案例2",component:Fn({__name:"example1",setup(e){let t=At(" ");return Kn((()=>{new Y7("threeContainer",{}),P5.locales(),setInterval((()=>{t.value=P5().format("YYYY-MM-DD HH:mm:ss ")}),1e3)})),(e,n)=>(fi(),yi(li,null,[$7,Ti("div",X7,[q7,Ti("div",K7,f(Dt(t).split(" ")[1]),1),Ti("div",null,[Z7,Ti("div",J7,f(Dt(t).split(" ")[0].replaceAll("-","/")),1)])]),Q7],64))}}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/project10.png"}}]}],tee={components:{Atropos:u4},data:()=>({route3d:eee}),mounted(){console.log(eee)}},nee={class:"p-[2vw]"},ree=(e=>(mn("data-v-982a15e6"),e=e(),gn(),e))((()=>Ti("div",{style:{height:"100%",width:"100%","background-color":"var(--el-bg-color-overlay)","box-shadow":"var(--el-box-shadow-lighter)","text-align":"center","line-height":"40px",color:"#1989fa"}}," UP ",-1))),iee=["id"],aee=["href"],see=["src"],oee={class:"absolute w-full h-[40px] bottom-0 z-100 bg-[#00000050] text-center leading-[40px] text-[20px] text-[#ffffff] justify-center"};const lee=gs(tee,[["render",function(e,t,n,r,i,a){const s=ur("el-backtop"),o=ur("atropos");return fi(),yi("div",nee,[Mi(s,{bottom:100},{default:vn((()=>[ree])),_:1}),(fi(!0),yi(li,null,mr(i.route3d,((e,t)=>(fi(),yi("div",{key:t,class:"flex flex-wrap w-full"},[Ti("div",{id:e.name,class:"w-full text-[1.5vw] font-bold"},f(e.name),9,iee),(fi(!0),yi(li,null,mr(e.children,((e,t)=>(fi(),yi("div",{key:t,class:"m-3"},[Ti("a",{href:"/#"+e.path,target:"_blank"},[Mi(o,{class:"my-atropos"},{default:vn((()=>[Ti("img",{class:"absolute w-full h-full z-1",src:e.meta.img,alt:""},null,8,see),Ti("div",oee,f(e.name),1)])),_:2},1024)],8,aee)])))),128))])))),128))])}],["__scopeId","data-v-982a15e6"]]);var uee=Cesium.knockout,cee=function(e,t,n){t=Cesium.getElement(t);var r,i=function(e){var t=document.createElement("div");t.innerHTML=e;for(var n=document.createDocumentFragment();t.firstChild;)n.appendChild(t.firstChild);return n}(e),a=[];for(r=0;r<i.childNodes.length;++r)a.push(i.childNodes[r]);for(t.appendChild(i),r=0;r<a.length;++r){var s=a[r];1!==s.nodeType&&8!==s.nodeType||uee.applyBindings(n,s)}return a},dee=Cesium.knockout,hee=function(e){if(!Cesium.defined(e)||!Cesium.defined(e.terria))throw new Cesium.DeveloperError("options.terria is required.");this.terria=e.terria,this._removeSubscription=void 0,this._lastLegendUpdate=void 0,this.eventHelper=new Cesium.EventHelper,this.distanceLabel=void 0,this.barWidth=void 0,this.enableDistanceLegend=!Cesium.defined(e.enableDistanceLegend)||e.enableDistanceLegend,dee.track(this,["distanceLabel","barWidth"]),this.eventHelper.add(this.terria.afterWidgetChanged,(function(){Cesium.defined(this._removeSubscription)&&(this._removeSubscription(),this._removeSubscription=void 0)}),this);var t=this;function n(){if(Cesium.defined(t.terria)){var e=t.terria.scene;t._removeSubscription=e.postRender.addEventListener((function(){!function(e,t){if(!e.enableDistanceLegend)return e.barWidth=void 0,void(e.distanceLabel=void 0);var n=Cesium.getTimestamp();if(n<e._lastLegendUpdate+250)return;e._lastLegendUpdate=n;var r=t.canvas.clientWidth,i=t.canvas.clientHeight,a=t.camera.getPickRay(new Cesium.Cartesian2(r/2|0,i-1)),s=t.camera.getPickRay(new Cesium.Cartesian2(1+r/2|0,i-1)),o=t.globe,l=o.pick(a,t),u=o.pick(s,t);if(!Cesium.defined(l)||!Cesium.defined(u))return e.barWidth=void 0,void(e.distanceLabel=void 0);var c=o.ellipsoid.cartesianToCartographic(l),d=o.ellipsoid.cartesianToCartographic(u);pee.setEndPoints(c,d);for(var h,p=pee.surfaceDistance,f=100,m=fee.length-1;!Cesium.defined(h)&&m>=0;--m)fee[m]/p<f&&(h=fee[m]);if(Cesium.defined(h)){var g;g=h>=1e3?(h/1e3).toString()+" km":h.toString()+" m",e.barWidth=h/p|0,e.distanceLabel=g}else e.barWidth=void 0,e.distanceLabel=void 0}(this,e)}),t)}}n(),this.eventHelper.add(this.terria.afterWidgetChanged,(function(){n()}),this)};hee.prototype.destroy=function(){this.eventHelper.removeAll()},hee.prototype.show=function(e){var t;t=this.enableDistanceLegend?'<div class="distance-legend" data-bind="visible: distanceLabel && barWidth"><div class="distance-legend-label" data-bind="text: distanceLabel"></div><div class="distance-legend-scale-bar" data-bind="style: { width: barWidth + \'px\', left: (5 + (125 - barWidth) / 2) + \'px\' }"></div></div>':'<div class="distance-legend"  style="display: none;" data-bind="visible: distanceLabel && barWidth"><div class="distance-legend-label"  data-bind="text: distanceLabel"></div><div class="distance-legend-scale-bar"  data-bind="style: { width: barWidth + \'px\', left: (5 + (125 - barWidth) / 2) + \'px\' }"></div></div>',cee(t,e,this)},hee.create=function(e){var t=new hee(e);return t.show(e.container),t};var pee=new Cesium.EllipsoidGeodesic,fee=[1,2,3,5,10,20,30,50,100,200,300,500,1e3,2e3,3e3,5e3,1e4,2e4,3e4,5e4,1e5,2e5,3e5,5e5,1e6,2e6,3e6,5e6,1e7,2e7,3e7,5e7];var mee=Cesium.knockout,gee=function(e){if(!Cesium.defined(e))throw new Cesium.DeveloperError("terria is required");this._terria=e,this.name="Unnamed Control",this.text=void 0,this.svgIcon=void 0,this.svgHeight=void 0,this.svgWidth=void 0,this.cssClass=void 0,this.isActive=!1,mee.track(this,["name","svgIcon","svgHeight","svgWidth","cssClass","isActive"])};Object.defineProperties(gee.prototype,{terria:{get:function(){return this._terria}},hasText:{get:function(){return Cesium.defined(this.text)&&"string"==typeof this.text}}}),gee.prototype.activate=function(){throw new Cesium.DeveloperError("activate must be implemented in the derived class.")};var vee=function(e){gee.apply(this,arguments)};vee.prototype=Object.create(gee.prototype);var yee=function(e){vee.apply(this,arguments),this.name=e.options.resetTooltip?e.options.resetTooltip:"重置视图",this.navigationLocked=!1,this.svgIcon=e.options.resetSvg?"":"M 7.5,0 C 3.375,0 0,3.375 0,7.5 0,11.625 3.375,15 7.5,15 c 3.46875,0 6.375,-2.4375 7.21875,-5.625 l -1.96875,0 C 12,11.53125 9.9375,13.125 7.5,13.125 4.40625,13.125 1.875,10.59375 1.875,7.5 1.875,4.40625 4.40625,1.875 7.5,1.875 c 1.59375,0 2.90625,0.65625 3.9375,1.6875 l -3,3 6.5625,0 L 15,0 12.75,2.25 C 11.4375,0.84375 9.5625,0 7.5,0 z",this.resetSvg=e.options.resetSvg,this.svgHeight=15,this.svgWidth=15,this.cssClass="navigation-control-icon-reset"};(yee.prototype=Object.create(vee.prototype)).setNavigationLocked=function(e){this.navigationLocked=e},yee.prototype.resetView=function(){if(!this.navigationLocked){var e=this.terria.scene;if(e.screenSpaceCameraController.enableInputs){this.isActive=!0;var t=e.camera;if(Cesium.defined(this.terria.trackedEntity)){var n=this.terria.trackedEntity;this.terria.trackedEntity=void 0,this.terria.trackedEntity=n}else{const n=this.terria.options.duration?this.terria.options.duration:3;if(this.terria.options.defaultResetView){const r=this.terria.options.orientation?this.terria.options.orientation:{heading:Cesium.Math.toRadians(5.729578)};if(this.terria.options.defaultResetView&&this.terria.options.defaultResetView instanceof Cesium.Cartographic)t.flyTo({destination:e.globe.ellipsoid.cartographicToCartesian(this.terria.options.defaultResetView),orientation:r,duration:n});else if(this.terria.options.defaultResetView&&this.terria.options.defaultResetView instanceof Cesium.Rectangle)try{Cesium.Rectangle.validate(this.terria.options.defaultResetView),t.flyTo({destination:this.terria.options.defaultResetView,orientation:r,duration:n})}catch(zA){console.log("Cesium-navigation/ResetViewNavigationControl:   options.defaultResetView Cesium rectangle is  invalid!")}}else"function"==typeof t.flyHome?t.flyHome(1):t.flyTo({destination:Cesium.Camera.DEFAULT_VIEW_RECTANGLE,duration:n})}this.isActive=!1}}},yee.prototype.activate=function(){this.resetView()};var _ee={},bee=new Cesium.Cartographic,xee=new Cesium.Ray;_ee.getCameraFocus=function(e,t,n){var r=e.scene,i=r.camera;if(r.mode!==Cesium.SceneMode.MORPHING&&(Cesium.defined(n)||(n=new Cesium.Cartesian3),Cesium.defined(e.trackedEntity)?n=e.trackedEntity.position.getValue(e.clock.currentTime,n):(xee.origin=i.positionWC,xee.direction=i.directionWC,n=r.globe.pick(xee,r,n)),Cesium.defined(n)))return r.mode===Cesium.SceneMode.SCENE2D||r.mode===Cesium.SceneMode.COLUMBUS_VIEW?(n=i.worldToCameraCoordinatesPoint(n,n),t&&(n=r.globe.ellipsoid.cartographicToCartesian(r.mapProjection.unproject(n,bee),n))):t||(n=i.worldToCameraCoordinatesPoint(n,n)),n};var wee=function(e,t){vee.apply(this,arguments),this.name=t?e.options.zoomInTooltip?e.options.zoomInTooltip:"放大":e.options.zoomOutTooltip?e.options.zoomOutTooltip:"缩小",t?e.options.zoomInSvg?this.zoomInSvg=e.options.zoomInSvg:this.text="+":e.options.zoomOutSvg?this.zoomOutSvg=e.options.zoomOutSvg:this.text="-",this.cssClass="navigation-control-icon-zoom-"+(t?"in":"out"),this.relativeAmount=2,t&&(this.relativeAmount=1/this.relativeAmount)};wee.prototype.relativeAmount=1,(wee.prototype=Object.create(vee.prototype)).activate=function(){this.zoom(this.relativeAmount)};var See=new Cesium.Cartesian3;wee.prototype.zoom=function(e){if(this.isActive=!0,Cesium.defined(this.terria)){var t=this.terria.scene,n=t.screenSpaceCameraController;if(!n.enableInputs||!n.enableZoom)return;var r,i=t.camera;switch(t.mode){case Cesium.SceneMode.MORPHING:break;case Cesium.SceneMode.SCENE2D:i.zoomIn(i.positionCartographic.height*(1-this.relativeAmount));break;default:var a;if(a=Cesium.defined(this.terria.trackedEntity)?new Cesium.Cartesian3:_ee.getCameraFocus(this.terria,!1),Cesium.defined(a))r={direction:i.direction,up:i.up};else{var s=new Cesium.Ray(i.worldToCameraCoordinatesPoint(t.globe.ellipsoid.cartographicToCartesian(i.positionCartographic)),i.directionWC);a=Cesium.IntersectionTests.grazingAltitudeLocation(s,t.globe.ellipsoid),r={heading:i.heading,pitch:i.pitch,roll:i.roll}}if(i.position.z>=406944828719368.56)return;var o=Cesium.Cartesian3.subtract(i.position,a,See),l=Cesium.Cartesian3.multiplyByScalar(o,e,o),u=Cesium.Cartesian3.add(a,l,a);Cesium.defined(this.terria.trackedEntity)||t.mode===Cesium.SceneMode.COLUMBUS_VIEW?i.position=u:i.flyTo({destination:u,orientation:r,duration:.5,convert:!1})}}this.isActive=!1};var Cee=Cesium.knockout,Tee=function(e){this.terria=e.terria,this.eventHelper=new Cesium.EventHelper,this.enableZoomControls=!Cesium.defined(e.enableZoomControls)||e.enableZoomControls,this.enableCompass=!Cesium.defined(e.enableCompass)||e.enableCompass,this.navigationLocked=!1,this.controls=e.controls,Cesium.defined(this.controls)||(this.controls=[new wee(this.terria,!0),new yee(this.terria),new wee(this.terria,!1)]),this.svgCompassOuterRing="m 66.5625,0 0,15.15625 3.71875,0 0,-10.40625 5.5,10.40625 4.375,0 0,-15.15625 -3.71875,0 0,10.40625 L 70.9375,0 66.5625,0 z M 72.5,20.21875 c -28.867432,0 -52.28125,23.407738 -52.28125,52.28125 0,28.87351 23.413818,52.3125 52.28125,52.3125 28.86743,0 52.28125,-23.43899 52.28125,-52.3125 0,-28.873512 -23.41382,-52.28125 -52.28125,-52.28125 z m 0,1.75 c 13.842515,0 26.368948,5.558092 35.5,14.5625 l -11.03125,11 0.625,0.625 11.03125,-11 c 8.9199,9.108762 14.4375,21.579143 14.4375,35.34375 0,13.764606 -5.5176,26.22729 -14.4375,35.34375 l -11.03125,-11 -0.625,0.625 11.03125,11 c -9.130866,9.01087 -21.658601,14.59375 -35.5,14.59375 -13.801622,0 -26.321058,-5.53481 -35.4375,-14.5 l 11.125,-11.09375 c 6.277989,6.12179 14.857796,9.90625 24.3125,9.90625 19.241896,0 34.875,-15.629154 34.875,-34.875 0,-19.245847 -15.633104,-34.84375 -34.875,-34.84375 -9.454704,0 -18.034511,3.760884 -24.3125,9.875 L 37.0625,36.4375 C 46.179178,27.478444 58.696991,21.96875 72.5,21.96875 z m -0.875,0.84375 0,13.9375 1.75,0 0,-13.9375 -1.75,0 z M 36.46875,37.0625 47.5625,48.15625 C 41.429794,54.436565 37.65625,63.027539 37.65625,72.5 c 0,9.472461 3.773544,18.055746 9.90625,24.34375 L 36.46875,107.9375 c -8.96721,-9.1247 -14.5,-21.624886 -14.5,-35.4375 0,-13.812615 5.53279,-26.320526 14.5,-35.4375 z M 72.5,39.40625 c 18.297686,0 33.125,14.791695 33.125,33.09375 0,18.302054 -14.827314,33.125 -33.125,33.125 -18.297687,0 -33.09375,-14.822946 -33.09375,-33.125 0,-18.302056 14.796063,-33.09375 33.09375,-33.09375 z M 22.84375,71.625 l 0,1.75 13.96875,0 0,-1.75 -13.96875,0 z m 85.5625,0 0,1.75 14,0 0,-1.75 -14,0 z M 71.75,108.25 l 0,13.9375 1.71875,0 0,-13.9375 -1.71875,0 z",this.svgCompassGyro="m 72.71875,54.375 c -0.476702,0 -0.908208,0.245402 -1.21875,0.5625 -0.310542,0.317098 -0.551189,0.701933 -0.78125,1.1875 -0.172018,0.363062 -0.319101,0.791709 -0.46875,1.25 -6.91615,1.075544 -12.313231,6.656514 -13,13.625 -0.327516,0.117495 -0.661877,0.244642 -0.9375,0.375 -0.485434,0.22959 -0.901634,0.471239 -1.21875,0.78125 -0.317116,0.310011 -0.5625,0.742111 -0.5625,1.21875 l 0.03125,0 c 0,0.476639 0.245384,0.877489 0.5625,1.1875 0.317116,0.310011 0.702066,0.58291 1.1875,0.8125 0.35554,0.168155 0.771616,0.32165 1.21875,0.46875 1.370803,6.10004 6.420817,10.834127 12.71875,11.8125 0.146999,0.447079 0.30025,0.863113 0.46875,1.21875 0.230061,0.485567 0.470708,0.870402 0.78125,1.1875 0.310542,0.317098 0.742048,0.5625 1.21875,0.5625 0.476702,0 0.876958,-0.245402 1.1875,-0.5625 0.310542,-0.317098 0.582439,-0.701933 0.8125,-1.1875 0.172018,-0.363062 0.319101,-0.791709 0.46875,-1.25 6.249045,-1.017063 11.256351,-5.7184 12.625,-11.78125 0.447134,-0.1471 0.86321,-0.300595 1.21875,-0.46875 0.485434,-0.22959 0.901633,-0.502489 1.21875,-0.8125 0.317117,-0.310011 0.5625,-0.710861 0.5625,-1.1875 l -0.03125,0 c 0,-0.476639 -0.245383,-0.908739 -0.5625,-1.21875 C 89.901633,71.846239 89.516684,71.60459 89.03125,71.375 88.755626,71.244642 88.456123,71.117495 88.125,71 87.439949,64.078341 82.072807,58.503735 75.21875,57.375 c -0.15044,-0.461669 -0.326927,-0.884711 -0.5,-1.25 -0.230061,-0.485567 -0.501958,-0.870402 -0.8125,-1.1875 -0.310542,-0.317098 -0.710798,-0.5625 -1.1875,-0.5625 z m -0.0625,1.40625 c 0.03595,-0.01283 0.05968,0 0.0625,0 0.0056,0 0.04321,-0.02233 0.1875,0.125 0.144288,0.147334 0.34336,0.447188 0.53125,0.84375 0.06385,0.134761 0.123901,0.309578 0.1875,0.46875 -0.320353,-0.01957 -0.643524,-0.0625 -0.96875,-0.0625 -0.289073,0 -0.558569,0.04702 -0.84375,0.0625 C 71.8761,57.059578 71.936151,56.884761 72,56.75 c 0.18789,-0.396562 0.355712,-0.696416 0.5,-0.84375 0.07214,-0.07367 0.120304,-0.112167 0.15625,-0.125 z m 0,2.40625 c 0.448007,0 0.906196,0.05436 1.34375,0.09375 0.177011,0.592256 0.347655,1.271044 0.5,2.03125 0.475097,2.370753 0.807525,5.463852 0.9375,8.9375 -0.906869,-0.02852 -1.834463,-0.0625 -2.78125,-0.0625 -0.92298,0 -1.802327,0.03537 -2.6875,0.0625 0.138529,-3.473648 0.493653,-6.566747 0.96875,-8.9375 0.154684,-0.771878 0.320019,-1.463985 0.5,-2.0625 0.405568,-0.03377 0.804291,-0.0625 1.21875,-0.0625 z m -2.71875,0.28125 c -0.129732,0.498888 -0.259782,0.987558 -0.375,1.5625 -0.498513,2.487595 -0.838088,5.693299 -0.96875,9.25 -3.21363,0.15162 -6.119596,0.480068 -8.40625,0.9375 -0.682394,0.136509 -1.275579,0.279657 -1.84375,0.4375 0.799068,-6.135482 5.504716,-11.036454 11.59375,-12.1875 z M 75.5,58.5 c 6.043169,1.18408 10.705093,6.052712 11.5,12.15625 -0.569435,-0.155806 -1.200273,-0.302525 -1.875,-0.4375 -2.262525,-0.452605 -5.108535,-0.783809 -8.28125,-0.9375 -0.130662,-3.556701 -0.470237,-6.762405 -0.96875,-9.25 C 75.761959,59.467174 75.626981,58.990925 75.5,58.5 z m -2.84375,12.09375 c 0.959338,0 1.895843,0.03282 2.8125,0.0625 C 75.48165,71.267751 75.5,71.871028 75.5,72.5 c 0,1.228616 -0.01449,2.438313 -0.0625,3.59375 -0.897358,0.0284 -1.811972,0.0625 -2.75,0.0625 -0.927373,0 -1.831062,-0.03473 -2.71875,-0.0625 -0.05109,-1.155437 -0.0625,-2.365134 -0.0625,-3.59375 0,-0.628972 0.01741,-1.232249 0.03125,-1.84375 0.895269,-0.02827 1.783025,-0.0625 2.71875,-0.0625 z M 68.5625,70.6875 c -0.01243,0.60601 -0.03125,1.189946 -0.03125,1.8125 0,1.22431 0.01541,2.407837 0.0625,3.5625 -3.125243,-0.150329 -5.92077,-0.471558 -8.09375,-0.90625 -0.784983,-0.157031 -1.511491,-0.316471 -2.125,-0.5 -0.107878,-0.704096 -0.1875,-1.422089 -0.1875,-2.15625 0,-0.115714 0.02849,-0.228688 0.03125,-0.34375 0.643106,-0.20284 1.389577,-0.390377 2.25,-0.5625 2.166953,-0.433487 4.97905,-0.75541 8.09375,-0.90625 z m 8.3125,0.03125 c 3.075121,0.15271 5.824455,0.446046 7.96875,0.875 0.857478,0.171534 1.630962,0.360416 2.28125,0.5625 0.0027,0.114659 0,0.228443 0,0.34375 0,0.735827 -0.07914,1.450633 -0.1875,2.15625 -0.598568,0.180148 -1.29077,0.34562 -2.0625,0.5 -2.158064,0.431708 -4.932088,0.754666 -8.03125,0.90625 0.04709,-1.154663 0.0625,-2.33819 0.0625,-3.5625 0,-0.611824 -0.01924,-1.185379 -0.03125,-1.78125 z M 57.15625,72.5625 c 0.0023,0.572772 0.06082,1.131112 0.125,1.6875 -0.125327,-0.05123 -0.266577,-0.10497 -0.375,-0.15625 -0.396499,-0.187528 -0.665288,-0.387337 -0.8125,-0.53125 -0.147212,-0.143913 -0.15625,-0.182756 -0.15625,-0.1875 0,-0.0047 -0.02221,-0.07484 0.125,-0.21875 0.147212,-0.143913 0.447251,-0.312472 0.84375,-0.5 0.07123,-0.03369 0.171867,-0.06006 0.25,-0.09375 z m 31.03125,0 c 0.08201,0.03503 0.175941,0.05872 0.25,0.09375 0.396499,0.187528 0.665288,0.356087 0.8125,0.5 0.14725,0.14391 0.15625,0.21405 0.15625,0.21875 0,0.0047 -0.009,0.04359 -0.15625,0.1875 -0.147212,0.143913 -0.416001,0.343722 -0.8125,0.53125 -0.09755,0.04613 -0.233314,0.07889 -0.34375,0.125 0.06214,-0.546289 0.09144,-1.094215 0.09375,-1.65625 z m -29.5,3.625 c 0.479308,0.123125 0.983064,0.234089 1.53125,0.34375 2.301781,0.460458 5.229421,0.787224 8.46875,0.9375 0.167006,2.84339 0.46081,5.433176 0.875,7.5 0.115218,0.574942 0.245268,1.063612 0.375,1.5625 -5.463677,-1.028179 -9.833074,-5.091831 -11.25,-10.34375 z m 27.96875,0 C 85.247546,81.408945 80.919274,85.442932 75.5,86.5 c 0.126981,-0.490925 0.261959,-0.967174 0.375,-1.53125 0.41419,-2.066824 0.707994,-4.65661 0.875,-7.5 3.204493,-0.15162 6.088346,-0.480068 8.375,-0.9375 0.548186,-0.109661 1.051942,-0.220625 1.53125,-0.34375 z M 70.0625,77.53125 c 0.865391,0.02589 1.723666,0.03125 2.625,0.03125 0.912062,0 1.782843,-0.0048 2.65625,-0.03125 -0.165173,2.736408 -0.453252,5.207651 -0.84375,7.15625 -0.152345,0.760206 -0.322989,1.438994 -0.5,2.03125 -0.437447,0.03919 -0.895856,0.0625 -1.34375,0.0625 -0.414943,0 -0.812719,-0.02881 -1.21875,-0.0625 -0.177011,-0.592256 -0.347655,-1.271044 -0.5,-2.03125 -0.390498,-1.948599 -0.700644,-4.419842 -0.875,-7.15625 z m 1.75,10.28125 c 0.284911,0.01545 0.554954,0.03125 0.84375,0.03125 0.325029,0 0.648588,-0.01171 0.96875,-0.03125 -0.05999,0.148763 -0.127309,0.31046 -0.1875,0.4375 -0.18789,0.396562 -0.386962,0.696416 -0.53125,0.84375 -0.144288,0.147334 -0.181857,0.125 -0.1875,0.125 -0.0056,0 -0.07446,0.02233 -0.21875,-0.125 C 72.355712,88.946416 72.18789,88.646562 72,88.25 71.939809,88.12296 71.872486,87.961263 71.8125,87.8125 z",this.svgCompassRotationMarker="M 72.46875,22.03125 C 59.505873,22.050338 46.521615,27.004287 36.6875,36.875 L 47.84375,47.96875 C 61.521556,34.240041 83.442603,34.227389 97.125,47.90625 l 11.125,-11.125 C 98.401629,26.935424 85.431627,22.012162 72.46875,22.03125 z",this.showCompass=Cesium.defined(this.terria)&&this.enableCompass,this.heading=this.showCompass?this.terria.scene.camera.heading:0,this.isOrbiting=!1,this.orbitCursorAngle=0,this.orbitCursorOpacity=0,this.orbitLastTimestamp=0,this.orbitFrame=void 0,this.orbitIsLook=!1,this.orbitMouseMoveFunction=void 0,this.orbitMouseUpFunction=void 0,this.isRotating=!1,this.rotateInitialCursorAngle=void 0,this.rotateFrame=void 0,this.rotateIsLook=!1,this.rotateMouseMoveFunction=void 0,this.rotateMouseUpFunction=void 0,this._unsubcribeFromPostRender=void 0,Cee.track(this,["controls","showCompass","heading","isOrbiting","orbitCursorAngle","isRotating"]);var t=this;function n(){Cesium.defined(t.terria)?(t._unsubcribeFromPostRender&&(t._unsubcribeFromPostRender(),t._unsubcribeFromPostRender=void 0),t.showCompass=t.enableCompass,t._unsubcribeFromPostRender=t.terria.scene.postRender.addEventListener((function(){t.heading=t.terria.scene.camera.heading}))):(t._unsubcribeFromPostRender&&(t._unsubcribeFromPostRender(),t._unsubcribeFromPostRender=void 0),t.showCompass=!1)}Tee.prototype.setNavigationLocked=function(e){this.navigationLocked=e,this.controls&&this.controls.length>1&&this.controls[1].setNavigationLocked(this.navigationLocked)},this.eventHelper.add(this.terria.afterWidgetChanged,n,this),n()};Tee.prototype.destroy=function(){this.eventHelper.removeAll()},Tee.prototype.show=function(e){const t="</div>",n=">",r=' style="display: none;"',i='<div class="compass"',a=void 0===this.terria.options.enableCompassOuterRing||this.terria.options.enableCompassOuterRing?'title="" data-bind="visible: showCompass, event: { mousedown: handleMouseDown,touchstart:handleMouseDown, dblclick: handleDoubleClick }">':'title="" data-bind="visible: showCompass">',s=" <div class=\"compass-rotation-marker\" data-bind=\"visible: isOrbiting, style: { transform: 'rotate(-' + orbitCursorAngle + 'rad)', '-webkit-transform': 'rotate(-' + orbitCursorAngle + 'rad)', opacity: orbitCursorOpacity }",o=s+', cesiumSvgPath: { path: svgCompassRotationMarker, width: 145, height: 145 }"'+n,l=s+'"'+n+this.terria.options.compassRotationMarkerSvg,u=(this.terria.options.compassRotationMarkerSvg?l:o)+t,c=" <div class=\"compass-outer-ring\" title=\"\" data-bind=\"style: { transform: 'rotate(-' + heading + 'rad)', '-webkit-transform': 'rotate(-' + heading + 'rad)' }",d=c+', cesiumSvgPath: { path: svgCompassOuterRing, width: 145, height: 145 }"'+n,h=c+'"'+n+this.terria.options.compassOuterRingSvg,p=(this.terria.options.compassOuterRingSvg?h:d)+t,f=' <div class="compass-gyro" data-bind="css: { \'compass-gyro-active\': isOrbiting }',m=f+',cesiumSvgPath: { path: svgCompassGyro, width: 145, height: 145 } "'+n,g=f+'"'+n+this.terria.options.compassGyroSvg,v=a+'<div class="compass-outer-ring-background"></div>'+u+p+' <div class="compass-gyro-background"></div>'+((this.terria.options.compassGyroSvg?g:m)+t)+t,y=i+v,_=i+r+v,b='<div class="navigation-controls"',x=">\x3c!-- ko foreach: controls --\x3e<div data-bind=\"click: activate, attr: { title: $data.name }, css: $root.isLastControl($data) ? 'navigation-control-last' : 'navigation-control' \">   \x3c!-- ko if: $data.hasText --\x3e   <div data-bind=\"text: $data.text, css: $data.isActive ?  'navigation-control-icon-active ' + $data.cssClass : $data.cssClass\"></div>   \x3c!-- /ko --\x3e  \x3c!-- ko ifnot: $data.hasText --\x3e  \x3c!-- ko if: $data.svgIcon --\x3e  <div data-bind=\"cesiumSvgPath: { path: $data.svgIcon, width: $data.svgWidth, height: $data.svgHeight }, css: $data.isActive ?  'navigation-control-icon-active ' + $data.cssClass : $data.cssClass\"></div>  \x3c!-- /ko --\x3e  \x3c!-- ko ifnot: $data.svgIcon --\x3e  \x3c!-- ko if: $data.resetSvg --\x3e  <div class=\"navigation-control-icon-svg\">"+this.terria.options.resetSvg+'</div>  \x3c!-- /ko --\x3e  \x3c!-- ko ifnot: $data.resetSvg --\x3e  \x3c!-- ko if: $data.zoomInSvg --\x3e  <div class="navigation-control-icon-svg">'+this.terria.options.zoomInSvg+'</div>  \x3c!-- /ko --\x3e  \x3c!-- ko ifnot: $data.zoomInSvg --\x3e  \x3c!-- ko if: $data.zoomOutSvg --\x3e  <div class="navigation-control-icon-svg">'+this.terria.options.zoomOutSvg+"</div>  \x3c!-- /ko --\x3e  \x3c!-- /ko --\x3e  \x3c!-- /ko --\x3e  \x3c!-- /ko --\x3e  \x3c!-- /ko --\x3e </div> \x3c!-- /ko --\x3e"+t,w=b+x,S=b+r+n+x,C=(this.enableCompass?y:_)+(this.enableZoomControls?w:S);cee(C,e,this)},Tee.prototype.add=function(e){this.controls.push(e)},Tee.prototype.remove=function(e){this.controls.remove(e)},Tee.prototype.isLastControl=function(e){return e===this.controls[this.controls.length-1]};var Mee=new Cesium.Cartesian2;const Eee=e=>{let t;t=e.touches?e.touches[0]:e;const{clientX:n,clientY:r}=t;return{clientX:n,clientY:r}};Tee.prototype.handleMouseDown=function(e,t){const{clientX:n,clientY:r}=Eee(t);if(this.terria.scene.mode===Cesium.SceneMode.MORPHING)return!0;if(e.navigationLocked)return!0;var i=t.currentTarget,a=t.currentTarget.getBoundingClientRect(),s=a.width/2,o=new Cesium.Cartesian2((a.right-a.left)/2,(a.bottom-a.top)/2),l=new Cesium.Cartesian2(n-a.left,r-a.top),u=Cesium.Cartesian2.subtract(l,o,Mee),c=Cesium.Cartesian2.magnitude(u)/s;if(c<50/145)!function(e,t,n){var r=e.terria.scene,i=r.screenSpaceCameraController;if(r.mode===Cesium.SceneMode.MORPHING||!i.enableInputs)return;if(e.navigationLocked)return!0;switch(r.mode){case Cesium.SceneMode.COLUMBUS_VIEW:if(i.enableLook)break;if(!i.enableTranslate||!i.enableTilt)return;break;case Cesium.SceneMode.SCENE3D:if(i.enableLook)break;if(!i.enableTilt||!i.enableRotate)return;break;case Cesium.SceneMode.SCENE2D:if(!i.enableTranslate)return}Dee(e),Cesium.defined(e.orbitTickFunction)&&e.terria.clock.onTick.removeEventListener(e.orbitTickFunction);e.orbitMouseMoveFunction=void 0,e.orbitMouseUpFunction=void 0,e.orbitTickFunction=void 0,e.isOrbiting=!0,e.orbitLastTimestamp=Cesium.getTimestamp();var a=r.camera;if(Cesium.defined(e.terria.trackedEntity))e.orbitFrame=void 0,e.orbitIsLook=!1;else{var s=_ee.getCameraFocus(e.terria,!0,Ree);Cesium.defined(s)?(e.orbitFrame=Cesium.Transforms.eastNorthUpToFixedFrame(s,r.globe.ellipsoid,Pee),e.orbitIsLook=!1):(e.orbitFrame=Cesium.Transforms.eastNorthUpToFixedFrame(a.positionWC,r.globe.ellipsoid,Pee),e.orbitIsLook=!0)}function o(t,n){var r=Math.atan2(-t.y,t.x);e.orbitCursorAngle=Cesium.Math.zeroToTwoPi(r-Cesium.Math.PI_OVER_TWO);var i=Cesium.Cartesian2.magnitude(t),a=n/2,s=Math.min(i/a,1),o=.5*s*s+.5;e.orbitCursorOpacity=o}e.orbitTickFunction=function(t){var n,i=Cesium.getTimestamp(),s=(i-e.orbitLastTimestamp)*(2.5*(e.orbitCursorOpacity-.5)/1e3),o=e.orbitCursorAngle+Cesium.Math.PI_OVER_TWO,l=Math.cos(o)*s,u=Math.sin(o)*s;if(e.navigationLocked)return!0;Cesium.defined(e.orbitFrame)&&(n=Cesium.Matrix4.clone(a.transform,Aee),a.lookAtTransform(e.orbitFrame)),r.mode===Cesium.SceneMode.SCENE2D?a.move(new Cesium.Cartesian3(l,u,0),Math.max(r.canvas.clientWidth,r.canvas.clientHeight)/100*a.positionCartographic.height*s):e.orbitIsLook?(a.look(Cesium.Cartesian3.UNIT_Z,-l),a.look(a.right,-u)):(a.rotateLeft(l),a.rotateUp(u)),Cesium.defined(e.orbitFrame)&&a.lookAtTransform(n),e.orbitLastTimestamp=i},e.orbitMouseMoveFunction=function(e){const{clientX:n,clientY:r}=Eee(e);var i=t.getBoundingClientRect(),a=new Cesium.Cartesian2((i.right-i.left)/2,(i.bottom-i.top)/2),s=new Cesium.Cartesian2(n-i.left,r-i.top);o(Cesium.Cartesian2.subtract(s,a,Mee),i.width)},e.orbitMouseUpFunction=function(t){e.isOrbiting=!1,Dee(e),Cesium.defined(e.orbitTickFunction)&&e.terria.clock.onTick.removeEventListener(e.orbitTickFunction),e.orbitMouseMoveFunction=void 0,e.orbitMouseUpFunction=void 0,e.orbitTickFunction=void 0},Lee(e),e.terria.clock.onTick.addEventListener(e.orbitTickFunction),o(n,t.getBoundingClientRect().width)}(this,i,u);else{if(!(c<1))return!0;!function(e,t,n){var r,i=e.terria.scene,a=i.camera,s=i.screenSpaceCameraController;if(i.mode===Cesium.SceneMode.MORPHING||i.mode===Cesium.SceneMode.SCENE2D||!s.enableInputs)return;if(e.navigationLocked)return!0;if(!s.enableLook&&(i.mode===Cesium.SceneMode.COLUMBUS_VIEW||i.mode===Cesium.SceneMode.SCENE3D&&!s.enableRotate))return;if(Iee(e),e.rotateMouseMoveFunction=void 0,e.rotateMouseUpFunction=void 0,e.isRotating=!0,e.rotateInitialCursorAngle=Math.atan2(-n.y,n.x),Cesium.defined(e.terria.trackedEntity))e.rotateFrame=void 0,e.rotateIsLook=!1;else{var o=_ee.getCameraFocus(e.terria,!0,Ree);Cesium.defined(o)&&(i.mode!==Cesium.SceneMode.COLUMBUS_VIEW||s.enableLook||s.enableTranslate)?(e.rotateFrame=Cesium.Transforms.eastNorthUpToFixedFrame(o,i.globe.ellipsoid,Pee),e.rotateIsLook=!1):(e.rotateFrame=Cesium.Transforms.eastNorthUpToFixedFrame(a.positionWC,i.globe.ellipsoid,Pee),e.rotateIsLook=!0)}Cesium.defined(e.rotateFrame)&&(r=Cesium.Matrix4.clone(a.transform,Aee),a.lookAtTransform(e.rotateFrame));e.rotateInitialCameraAngle=-a.heading,Cesium.defined(e.rotateFrame)&&a.lookAtTransform(r);e.rotateMouseMoveFunction=function(n){const{clientX:r,clientY:i}=Eee(n);var a,s=t.getBoundingClientRect(),o=new Cesium.Cartesian2((s.right-s.left)/2,(s.bottom-s.top)/2),l=new Cesium.Cartesian2(r-s.left,i-s.top),u=Cesium.Cartesian2.subtract(l,o,Mee),c=Math.atan2(-u.y,u.x)-e.rotateInitialCursorAngle,d=Cesium.Math.zeroToTwoPi(e.rotateInitialCameraAngle-c),h=e.terria.scene.camera;Cesium.defined(e.rotateFrame)&&(a=Cesium.Matrix4.clone(h.transform,Aee),h.lookAtTransform(e.rotateFrame));var p=-h.heading;h.rotateRight(d-p),Cesium.defined(e.rotateFrame)&&h.lookAtTransform(a)},e.rotateMouseUpFunction=function(t){e.isRotating=!1,Iee(e),e.rotateMouseMoveFunction=void 0,e.rotateMouseUpFunction=void 0},kee(e)}(this,i,u)}};var Aee=new Cesium.Matrix4,Pee=new Cesium.Matrix4,Ree=new Cesium.Cartesian3;Tee.prototype.handleDoubleClick=function(e,t){var n=e.terria.scene,r=n.camera,i=n.screenSpaceCameraController;if(n.mode===Cesium.SceneMode.MORPHING||!i.enableInputs)return!0;if(e.navigationLocked)return!0;if(n.mode!==Cesium.SceneMode.COLUMBUS_VIEW||i.enableTranslate){if(n.mode===Cesium.SceneMode.SCENE3D||n.mode===Cesium.SceneMode.COLUMBUS_VIEW){if(!i.enableLook)return;if(n.mode===Cesium.SceneMode.SCENE3D&&!i.enableRotate)return}var a=_ee.getCameraFocus(e.terria,!0,Ree);if(Cesium.defined(a)){var s=n.globe.ellipsoid.cartographicToCartesian(r.positionCartographic,new Cesium.Cartesian3),o=n.globe.ellipsoid.geodeticSurfaceNormal(a),l=new Cesium.BoundingSphere(a,0);r.flyToBoundingSphere(l,{offset:new Cesium.HeadingPitchRange(0,Cesium.Math.PI_OVER_TWO-Cesium.Cartesian3.angleBetween(o,r.directionWC),Cesium.Cartesian3.distance(s,a)),duration:1.5})}else this.controls[1].resetView()}},Tee.create=function(e){var t=new Tee(e);return t.show(e.container),t};const Lee=e=>{document.addEventListener("mousemove",e.orbitMouseMoveFunction,!1),document.addEventListener("touchmove",e.orbitMouseMoveFunction,!1),document.addEventListener("mouseup",e.orbitMouseUpFunction,!1),document.addEventListener("touchend",e.orbitMouseUpFunction,!1)},kee=e=>{document.addEventListener("mousemove",e.rotateMouseMoveFunction,!1),document.addEventListener("touchmove",e.rotateMouseMoveFunction,!1),document.addEventListener("mouseup",e.rotateMouseUpFunction,!1),document.addEventListener("touchend",e.rotateMouseUpFunction,!1)},Dee=e=>{document.removeEventListener("mousemove",e.orbitMouseMoveFunction,!1),document.removeEventListener("touchmove",e.orbitMouseMoveFunction,!1),document.removeEventListener("mouseup",e.orbitMouseUpFunction,!1),document.removeEventListener("touchend",e.orbitMouseUpFunction,!1)},Iee=e=>{document.removeEventListener("mousemove",e.rotateMouseMoveFunction,!1),document.removeEventListener("touchmove",e.rotateMouseMoveFunction,!1),document.removeEventListener("mouseup",e.rotateMouseUpFunction,!1),document.removeEventListener("touchend",e.rotateMouseUpFunction,!1)};var Oee=Cesium.Event,Nee=function(e){Bee.apply(this,arguments),this._onDestroyListeners=[]};function Bee(e,t){if(!Cesium.defined(e))throw new Cesium.DeveloperError("CesiumWidget or Viewer is required.");var n=Cesium.defined(e.cesiumWidget)?e.cesiumWidget:e,r=document.createElement("div");r.className="cesium-widget-cesiumNavigationContainer",n.container.appendChild(r),this.terria=e,this.terria.options=Cesium.defined(t)?t:{},this.terria.afterWidgetChanged=new Oee,this.terria.beforeWidgetChanged=new Oee,this.container=r,Cesium.defined(this.terria.options.enableDistanceLegend)&&!this.terria.options.enableDistanceLegend||(this.distanceLegendDiv=document.createElement("div"),r.appendChild(this.distanceLegendDiv),this.distanceLegendDiv.setAttribute("id","distanceLegendDiv"),this.distanceLegendViewModel=hee.create({container:this.distanceLegendDiv,terria:this.terria,mapElement:r,enableDistanceLegend:!0})),Cesium.defined(this.terria.options.enableZoomControls)&&!this.terria.options.enableZoomControls||Cesium.defined(this.terria.options.enableCompass)&&!this.terria.options.enableCompass?!Cesium.defined(this.terria.options.enableZoomControls)||this.terria.options.enableZoomControls||Cesium.defined(this.terria.options.enableCompass)&&!this.terria.options.enableCompass?Cesium.defined(this.terria.options.enableZoomControls)&&!this.terria.options.enableZoomControls||!Cesium.defined(this.terria.options.enableCompass)||this.terria.options.enableCompass?Cesium.defined(this.terria.options.enableZoomControls)&&!this.terria.options.enableZoomControls&&Cesium.defined(this.terria.options.enableCompass)&&this.terria.options.enableCompass:(this.navigationDiv=document.createElement("div"),this.navigationDiv.setAttribute("id","navigationDiv"),r.appendChild(this.navigationDiv),this.navigationViewModel=Tee.create({container:this.navigationDiv,terria:this.terria,enableZoomControls:!0,enableCompass:!1})):(this.navigationDiv=document.createElement("div"),this.navigationDiv.setAttribute("id","navigationDiv"),r.appendChild(this.navigationDiv),this.navigationViewModel=Tee.create({container:this.navigationDiv,terria:this.terria,enableZoomControls:!1,enableCompass:!0})):(this.navigationDiv=document.createElement("div"),this.navigationDiv.setAttribute("id","navigationDiv"),r.appendChild(this.navigationDiv),this.navigationViewModel=Tee.create({container:this.navigationDiv,terria:this.terria,enableZoomControls:!0,enableCompass:!0}))}Nee.prototype.distanceLegendViewModel=void 0,Nee.prototype.navigationViewModel=void 0,Nee.prototype.navigationDiv=void 0,Nee.prototype.distanceLegendDiv=void 0,Nee.prototype.terria=void 0,Nee.prototype.container=void 0,Nee.prototype._onDestroyListeners=void 0,Nee.prototype._navigationLocked=!1,Nee.prototype.setNavigationLocked=function(e){this._navigationLocked=e,this.navigationViewModel.setNavigationLocked(this._navigationLocked)},Nee.prototype.getNavigationLocked=function(){return this._navigationLocked},Nee.prototype.destroy=function(){Cesium.defined(this.navigationViewModel)&&this.navigationViewModel.destroy(),Cesium.defined(this.distanceLegendViewModel)&&this.distanceLegendViewModel.destroy(),Cesium.defined(this.navigationDiv)&&this.navigationDiv.parentNode.removeChild(this.navigationDiv),delete this.navigationDiv,Cesium.defined(this.distanceLegendDiv)&&this.distanceLegendDiv.parentNode.removeChild(this.distanceLegendDiv),delete this.distanceLegendDiv,Cesium.defined(this.container)&&this.container.parentNode.removeChild(this.container),delete this.container;for(var e=0;e<this._onDestroyListeners.length;e++)this._onDestroyListeners[e]()},Nee.prototype.addOnDestroyListener=function(e){"function"==typeof e&&this._onDestroyListeners.push(e)};const Uee={type:"FeatureCollection",features:[{type:"Feature",properties:{adcode:340800,name:"安庆市",center:[117.043551,30.50883],centroid:[116.451502,30.574825],childrenNum:10,level:"city",acroutes:[1e5,34e4],parent:{adcode:34e4}},geometry:{type:"MultiPolygon",coordinates:[[[[116.903324,30.357274],[116.89553,30.354906],[116.890925,30.354802],[116.886975,30.35711],[116.877929,30.357125],[116.877438,30.36518],[116.876663,30.368098],[116.867363,30.380783],[116.863787,30.387586],[116.857513,30.401979],[116.853355,30.406162],[116.852923,30.408409],[116.85021,30.412606],[116.849748,30.414912],[116.852952,30.414823],[116.854204,30.415924],[116.853638,30.421058],[116.853951,30.429287],[116.850732,30.430492],[116.844339,30.425894],[116.838541,30.423603],[116.835203,30.418424],[116.831776,30.417829],[116.826351,30.420225],[116.822089,30.424436],[116.815561,30.426252],[116.806471,30.426817],[116.800942,30.424912],[116.797127,30.422145],[116.794012,30.416103],[116.786143,30.415106],[116.780361,30.412963],[116.776963,30.408007],[116.770734,30.410879],[116.756651,30.420999],[116.750168,30.431028],[116.750138,30.436191],[116.758886,30.444329],[116.762493,30.448926],[116.767306,30.45321],[116.77519,30.456468],[116.797514,30.458982],[116.809705,30.461198],[116.814503,30.463281],[116.825144,30.470822],[116.829704,30.47274],[116.830628,30.474287],[116.834637,30.476131],[116.86331,30.487344],[116.873488,30.489501],[116.87395,30.491508],[116.867468,30.498616],[116.868869,30.502467],[116.87398,30.505143],[116.885306,30.506868],[116.886126,30.509767],[116.885083,30.513587],[116.879181,30.518924],[116.880448,30.521006],[116.88404,30.524127],[116.890865,30.531768],[116.892266,30.535246],[116.891103,30.539883],[116.891565,30.541964],[116.895619,30.546482],[116.896662,30.54984],[116.896543,30.554462],[116.903845,30.55308],[116.905932,30.55516],[116.911028,30.564537],[116.911952,30.567791],[116.919374,30.56687],[116.921922,30.56837],[116.923889,30.575205],[116.924128,30.580642],[116.927377,30.581237],[116.927719,30.579721],[116.934321,30.580538],[116.937347,30.580078],[116.9414,30.576735],[116.949135,30.571907],[116.954544,30.573303],[116.955319,30.575309],[116.958285,30.571312],[116.964112,30.566394],[116.964499,30.56687],[116.972651,30.57308],[116.973247,30.575339],[116.973486,30.58654],[116.96979,30.592764],[116.968955,30.596448],[116.968896,30.602434],[116.967271,30.611761],[116.962979,30.613499],[116.961161,30.617123],[116.961161,30.625186],[116.960714,30.628557],[116.957152,30.627948],[116.945662,30.628988],[116.934649,30.632121],[116.93149,30.634125],[116.928405,30.638817],[116.920626,30.646181],[116.920223,30.651541],[116.922101,30.654287],[116.928882,30.658592],[116.934441,30.661338],[116.940014,30.661353],[116.943189,30.660344],[116.951445,30.656143],[116.956944,30.658028],[116.953457,30.664351],[116.955781,30.670066],[116.960431,30.671313],[116.961981,30.67256],[116.962592,30.67673],[116.965692,30.677665],[116.966318,30.682756],[116.970654,30.684151],[116.970192,30.690027],[116.971429,30.691571],[116.980416,30.692684],[116.98134,30.697773],[116.988016,30.705207],[116.989864,30.706142],[116.995602,30.706928],[116.997971,30.711379],[116.998165,30.716512],[116.990758,30.716082],[116.985781,30.718619],[116.984842,30.722773],[116.987137,30.727134],[116.986913,30.728261],[116.989432,30.73326],[116.994514,30.737443],[117.001071,30.739237],[117.006555,30.744251],[117.008448,30.751147],[117.006257,30.75911],[117.007062,30.759451],[117.013336,30.755729],[117.017866,30.751785],[117.028626,30.752823],[117.03797,30.752882],[117.043648,30.754721],[117.046778,30.758235],[117.051547,30.768734],[117.053692,30.772085],[117.055511,30.773019],[117.059549,30.773167],[117.077135,30.770305],[117.101009,30.767384],[117.102484,30.772203],[117.105032,30.790706],[117.105301,30.807855],[117.10624,30.827566],[117.103557,30.842042],[117.101277,30.859465],[117.096463,30.88574],[117.091903,30.905967],[117.086404,30.928618],[117.082917,30.948585],[117.080368,30.961726],[117.0801,30.96695],[117.082649,30.974866],[117.087075,30.979955],[117.094183,30.985991],[117.095122,30.988551],[117.093915,31.010117],[117.099548,31.013341],[117.10773,31.013741],[117.111336,31.013474],[117.1246,31.00676],[117.13068,31.006198],[117.134778,31.007292],[117.139458,31.011167],[117.141201,31.014524],[117.140605,31.01902],[117.137595,31.028943],[117.137997,31.033423],[117.13913,31.035834],[117.143944,31.039308],[117.144152,31.054196],[117.14603,31.056399],[117.149905,31.058276],[117.156268,31.072407],[117.151514,31.073752],[117.141574,31.071713],[117.135971,31.073132],[117.127983,31.077802],[117.119518,31.082162],[117.117297,31.085044],[117.119473,31.096098],[117.122811,31.101801],[117.121902,31.109174],[117.120218,31.114079],[117.118058,31.116502],[117.116835,31.121717],[117.117178,31.12442],[117.121962,31.12928],[117.119399,31.134421],[117.119742,31.138409],[117.123661,31.142928],[117.122111,31.148541],[117.117923,31.15368],[117.117238,31.15591],[117.109414,31.169569],[117.108326,31.17605],[117.105018,31.179299],[117.103065,31.185307],[117.102782,31.188954],[117.100159,31.190518],[117.089608,31.205781],[117.079191,31.221646],[117.078446,31.224686],[117.078982,31.228346],[117.0756,31.234484],[117.071337,31.236845],[117.069102,31.236919],[117.055078,31.235399],[117.052918,31.236004],[117.048715,31.240047],[117.046345,31.243691],[117.042217,31.252469],[117.038417,31.25567],[117.032247,31.256629],[117.016257,31.266822],[117.011056,31.268459],[117.006719,31.267707],[117.003798,31.264993],[116.99818,31.256482],[116.987614,31.249209],[116.981414,31.244591],[116.977256,31.237819],[116.973978,31.233717],[116.965185,31.218651],[116.962398,31.211788],[116.95596,31.193235],[116.954008,31.189175],[116.951162,31.185853],[116.946884,31.182738],[116.945394,31.179904],[116.94371,31.170647],[116.944515,31.167472],[116.943904,31.161787],[116.941206,31.159616],[116.939165,31.15941],[116.925439,31.160207],[116.922727,31.160074],[116.921445,31.15777],[116.919344,31.151287],[116.915604,31.149441],[116.913666,31.147093],[116.905887,31.141141],[116.894963,31.133402],[116.883741,31.128512],[116.875977,31.127449],[116.865307,31.129886],[116.862281,31.129901],[116.856067,31.126533],[116.84717,31.124642],[116.845143,31.122559],[116.844473,31.11925],[116.842789,31.116753],[116.842178,31.11337],[116.843459,31.106485],[116.843325,31.104446],[116.84103,31.102895],[116.83486,31.102333],[116.829361,31.10124],[116.826604,31.099112],[116.821642,31.093305],[116.819317,31.089463],[116.815651,31.085369],[116.808229,31.08395],[116.805949,31.082162],[116.804861,31.078615],[116.799213,31.075304],[116.794042,31.068328],[116.790838,31.066214],[116.786352,31.065239],[116.783953,31.067766],[116.777619,31.069998],[116.772895,31.070353],[116.767187,31.068417],[116.7613,31.068358],[116.752716,31.060848],[116.745548,31.059636],[116.742836,31.060109],[116.736726,31.063908],[116.731957,31.060848],[116.727829,31.060701],[116.722896,31.059622],[116.720392,31.057922],[116.715922,31.052718],[116.711928,31.045001],[116.709662,31.043241],[116.704044,31.043374],[116.697368,31.045015],[116.688649,31.048682],[116.683553,31.055763],[116.681019,31.057582],[116.676951,31.058602],[116.671303,31.05872],[116.667473,31.059799],[116.665476,31.059148],[116.659187,31.054108],[116.653941,31.0522],[116.651288,31.052156],[116.64947,31.053915],[116.648725,31.056916],[116.647026,31.058912],[116.639992,31.062859],[116.63181,31.06852],[116.628293,31.069156],[116.625879,31.070575],[116.622496,31.074092],[116.618994,31.074994],[116.614016,31.073885],[116.612124,31.070427],[116.611558,31.067323],[116.608875,31.064854],[116.605835,31.063598],[116.603137,31.059518],[116.5974,31.056842],[116.594568,31.054137],[116.591722,31.047617],[116.589829,31.047662],[116.588384,31.049613],[116.582408,31.051713],[116.571082,31.051801],[116.568548,31.050559],[116.563779,31.045592],[116.562602,31.043226],[116.560352,31.034621],[116.558936,31.032314],[116.554227,31.028248],[116.550605,31.026858],[116.546969,31.02254],[116.543601,31.020322],[116.53609,31.01973],[116.530606,31.021002],[116.530472,31.023058],[116.53229,31.030791],[116.530934,31.035331],[116.534778,31.044173],[116.534451,31.052422],[116.533363,31.056207],[116.538251,31.063258],[116.537878,31.067618],[116.538698,31.072141],[116.541962,31.079635],[116.545196,31.08361],[116.547953,31.090704],[116.549398,31.093231],[116.559517,31.104298],[116.561305,31.107091],[116.562676,31.11111],[116.562513,31.113488],[116.560098,31.117846],[116.556358,31.120387],[116.555881,31.123298],[116.558608,31.127242],[116.559249,31.130684],[116.556999,31.134879],[116.556656,31.142722],[116.558355,31.147566],[116.556089,31.152395],[116.553645,31.155437],[116.552617,31.16161],[116.552811,31.165907],[116.556566,31.172167],[116.556715,31.174323],[116.555031,31.177852],[116.552826,31.179712],[116.545196,31.182],[116.543482,31.181971],[116.539115,31.178324],[116.538489,31.174471],[116.536761,31.17292],[116.52998,31.169495],[116.525226,31.163101],[116.519533,31.160163],[116.517506,31.156486],[116.513468,31.151834],[116.508296,31.1425],[116.50691,31.141333],[116.501918,31.141451],[116.498699,31.144376],[116.496732,31.148733],[116.49387,31.148437],[116.490607,31.142707],[116.486434,31.139265],[116.481829,31.136976],[116.47627,31.135809],[116.470071,31.135661],[116.463499,31.131526],[116.460309,31.125912],[116.456494,31.124612],[116.451547,31.124612],[116.447195,31.126252],[116.441905,31.126799],[116.437687,31.128424],[116.434453,31.132176],[116.433648,31.138039],[116.431875,31.144125],[116.430325,31.146827],[116.425482,31.152425],[116.415318,31.162201],[116.412203,31.163795],[116.408254,31.163958],[116.40119,31.16319],[116.395557,31.162097],[116.392919,31.162688],[116.388389,31.165316],[116.378985,31.16536],[116.367003,31.172197],[116.363084,31.173777],[116.359522,31.173983],[116.353725,31.168491],[116.351326,31.167073],[116.346482,31.16573],[116.344932,31.163603],[116.345156,31.156176],[116.342727,31.15241],[116.334769,31.147344],[116.329553,31.145498],[116.322697,31.14603],[116.317973,31.144656],[116.309792,31.140447],[116.307154,31.137833],[116.30626,31.135676],[116.307258,31.130521],[116.303518,31.123135],[116.300597,31.121909],[116.300105,31.120269],[116.295902,31.119442],[116.296215,31.117433],[116.292281,31.117802],[116.293041,31.114774],[116.29094,31.113385],[116.287527,31.113872],[116.287795,31.111774],[116.281774,31.107992],[116.279107,31.108879],[116.279435,31.105746],[116.278317,31.104594],[116.273637,31.103294],[116.273831,31.100471],[116.268481,31.100117],[116.268422,31.096836],[116.266156,31.094324],[116.265754,31.089847],[116.263444,31.085073],[116.261387,31.082428],[116.252714,31.078674],[116.243415,31.075585],[116.23422,31.069776],[116.226724,31.064071],[116.222447,31.061809],[116.213102,31.059104],[116.200256,31.057848],[116.193863,31.058675],[116.188736,31.060775],[116.183759,31.064913],[116.180853,31.070589],[116.180316,31.074994],[116.182209,31.079103],[116.18133,31.083374],[116.179169,31.08763],[116.17668,31.090275],[116.166233,31.09759],[116.161047,31.099348],[116.157679,31.099289],[116.148857,31.09626],[116.141107,31.094516],[116.127516,31.089906],[116.121749,31.087349],[116.118887,31.086876],[116.111093,31.090733],[116.108888,31.091029],[116.104581,31.094443],[116.101227,31.094723],[116.093359,31.090113],[116.094044,31.084719],[116.092688,31.08265],[116.088456,31.079576],[116.084611,31.07764],[116.06947,31.071949],[116.066355,31.070087],[116.060945,31.063199],[116.050975,31.049554],[116.050633,31.047263],[116.051586,31.042236],[116.050975,31.03888],[116.048829,31.034636],[116.047071,31.026045],[116.046117,31.014524],[116.052242,31.0134],[116.058933,31.012735],[116.058203,31.007943],[116.059917,31.00105],[116.060319,30.994941],[116.062704,30.989719],[116.064909,30.978165],[116.066534,30.975827],[116.069693,30.96914],[116.071273,30.962466],[116.071735,30.956695],[116.063866,30.957716],[116.053256,30.957198],[116.044984,30.958722],[116.03953,30.957834],[116.036669,30.952359],[116.034523,30.951145],[116.024732,30.953602],[116.017996,30.951367],[116.009888,30.949695],[116.006491,30.946691],[116.000082,30.943716],[115.998041,30.942132],[115.993421,30.936745],[115.98813,30.934391],[115.983928,30.934539],[115.976298,30.93146],[115.972125,30.92696],[115.972155,30.922519],[115.970575,30.920032],[115.962036,30.916583],[115.954271,30.912808],[115.951544,30.90958],[115.944689,30.905005],[115.941053,30.903317],[115.93612,30.902873],[115.935315,30.898594],[115.932379,30.889413],[115.929026,30.887724],[115.92071,30.885844],[115.915539,30.887576],[115.912782,30.887576],[115.905674,30.883622],[115.899161,30.882275],[115.89086,30.879801],[115.885689,30.877846],[115.876911,30.869004],[115.872962,30.866989],[115.868208,30.865982],[115.86566,30.864249],[115.86405,30.858013],[115.863886,30.855272],[115.859684,30.851909],[115.851666,30.844191],[115.84946,30.841242],[115.84718,30.835745],[115.84879,30.828544],[115.855481,30.821698],[115.86104,30.818185],[115.863782,30.81577],[115.862843,30.808389],[115.866256,30.802268],[115.865853,30.798236],[115.858223,30.78952],[115.8587,30.78482],[115.864393,30.782167],[115.869475,30.782448],[115.87174,30.780773],[115.871814,30.779231],[115.868327,30.774264],[115.860235,30.769238],[115.854334,30.767444],[115.851129,30.763559],[115.851532,30.756708],[115.844125,30.754884],[115.837031,30.756723],[115.834662,30.756397],[115.827792,30.752111],[115.822471,30.750361],[115.817628,30.752066],[115.810475,30.759437],[115.8028,30.759867],[115.792755,30.759259],[115.787495,30.757524],[115.784991,30.755092],[115.782905,30.75171],[115.776362,30.728869],[115.771906,30.718812],[115.767257,30.712447],[115.765558,30.707522],[115.765901,30.698812],[115.767376,30.694345],[115.762324,30.689078],[115.762518,30.685635],[115.76745,30.682385],[115.772368,30.677858],[115.774678,30.673391],[115.775349,30.668864],[115.780162,30.668018],[115.783128,30.666801],[115.788597,30.662867],[115.791429,30.662258],[115.797018,30.658607],[115.798105,30.65589],[115.798776,30.650086],[115.803098,30.645691],[115.809893,30.642574],[115.812516,30.639055],[115.813798,30.635996],[115.813664,30.632091],[115.814946,30.624785],[115.809223,30.618504],[115.807807,30.615549],[115.810773,30.608568],[115.819148,30.597889],[115.821309,30.596122],[115.824141,30.596122],[115.825079,30.602197],[115.82809,30.606147],[115.833529,30.604127],[115.839833,30.603415],[115.848492,30.601914],[115.851696,30.599879],[115.855705,30.591056],[115.857284,30.589511],[115.866226,30.587907],[115.8763,30.582351],[115.879057,30.578295],[115.878893,30.575992],[115.875555,30.569381],[115.883141,30.559425],[115.883215,30.554878],[115.886106,30.546824],[115.886404,30.543717],[115.88779,30.542499],[115.896389,30.539928],[115.899474,30.537862],[115.903215,30.53205],[115.905137,30.524588],[115.910696,30.519147],[115.913646,30.517824],[115.91998,30.51827],[115.921411,30.517364],[115.919891,30.515],[115.909727,30.506749],[115.907387,30.501619],[115.903587,30.495002],[115.898103,30.482258],[115.897984,30.477321],[115.900815,30.469721],[115.899489,30.464991],[115.896285,30.462968],[115.894049,30.459562],[115.894794,30.452734],[115.897104,30.450949],[115.903066,30.449387],[115.909951,30.444969],[115.915569,30.443987],[115.917998,30.441086],[115.9208,30.429867],[115.922916,30.428588],[115.926001,30.428826],[115.936671,30.427219],[115.946149,30.42521],[115.944018,30.420969],[115.938191,30.417799],[115.930963,30.420493],[115.924332,30.41893],[115.9215,30.416356],[115.91624,30.405685],[115.911292,30.400342],[115.90928,30.398854],[115.904481,30.397633],[115.900905,30.397842],[115.897462,30.393049],[115.88855,30.386633],[115.885525,30.382778],[115.884914,30.379547],[115.888416,30.373801],[115.893692,30.366163],[115.896479,30.356678],[115.900875,30.351273],[115.906553,30.347043],[115.913095,30.340759],[115.916091,30.336395],[115.916702,30.334414],[115.916374,30.327995],[115.914347,30.324271],[115.910964,30.322141],[115.903736,30.315795],[115.902738,30.313709],[115.904422,30.310074],[115.918102,30.304175],[115.921903,30.301284],[115.92615,30.303028],[115.938698,30.306931],[115.953839,30.306365],[115.95837,30.305322],[115.969413,30.300078],[115.974763,30.298603],[115.980962,30.295757],[115.985329,30.291048],[115.985776,30.285103],[115.987654,30.274358],[115.988801,30.271646],[115.98892,30.267055],[115.99123,30.260006],[115.994822,30.255042],[115.997549,30.252582],[116.001588,30.250615],[116.012243,30.249497],[116.021423,30.243981],[116.02658,30.239747],[116.029202,30.231324],[116.031706,30.227015],[116.034642,30.226627],[116.04187,30.22451],[116.046117,30.223913],[116.052332,30.219932],[116.055595,30.216562],[116.058024,30.215474],[116.064343,30.206899],[116.06555,30.201649],[116.063911,30.19358],[116.058054,30.18475],[116.056027,30.181036],[116.056743,30.169907],[116.060856,30.15912],[116.063181,30.151615],[116.067085,30.144124],[116.070677,30.138707],[116.075043,30.133528],[116.081243,30.129752],[116.085043,30.12617],[116.087696,30.115677],[116.088366,30.110183],[116.087755,30.103301],[116.083732,30.095643],[116.082823,30.089894],[116.082912,30.08646],[116.084343,30.082354],[116.08479,30.075948],[116.081228,30.070602],[116.079216,30.066196],[116.078799,30.062074],[116.079991,30.05728],[116.084387,30.050723],[116.088501,30.045524],[116.090736,30.040759],[116.091645,30.036203],[116.090498,30.029749],[116.088992,30.02697],[116.084611,30.022757],[116.081288,30.018558],[116.079022,30.01415],[116.078337,30.010235],[116.079291,30.003839],[116.08014,30.001792],[116.080691,29.99148],[116.081601,29.987146],[116.081466,29.98175],[116.079216,29.977236],[116.075371,29.972796],[116.073851,29.970015],[116.07403,29.963363],[116.077934,29.956112],[116.080587,29.955484],[116.085729,29.950774],[116.09555,29.938827],[116.104044,29.926848],[116.125802,29.901361],[116.128201,29.897696],[116.132046,29.890126],[116.13458,29.877453],[116.132181,29.86614],[116.131704,29.851548],[116.131972,29.844259],[116.135191,29.819424],[116.167336,29.827374],[116.17288,29.828347],[116.187321,29.829051],[116.198215,29.828542],[116.20808,29.827494],[116.217037,29.824051],[116.227379,29.816909],[116.233788,29.808719],[116.24103,29.798417],[116.243817,29.793939],[116.250583,29.785733],[116.253608,29.783127],[116.261462,29.782063],[116.270746,29.784984],[116.280806,29.788863],[116.294829,29.796635],[116.31228,29.808959],[116.322787,29.820008],[116.343084,29.835697],[116.350118,29.838781],[116.359686,29.843616],[116.392532,29.855724],[116.418313,29.868026],[116.44177,29.879847],[116.45338,29.887507],[116.467716,29.89614],[116.473185,29.897441],[116.479862,29.897875],[116.48785,29.897621],[116.514526,29.897217],[116.525569,29.897516],[116.53454,29.899251],[116.541515,29.901615],[116.547669,29.905684],[116.551946,29.909842],[116.558727,29.924321],[116.564539,29.949324],[116.571201,29.989208],[116.569785,29.998474],[116.57132,30.014449],[116.577236,30.029704],[116.585567,30.045405],[116.59658,30.059729],[116.603942,30.06651],[116.611036,30.070706],[116.620276,30.072991],[116.6426,30.076366],[116.652048,30.077113],[116.661243,30.077217],[116.666862,30.076739],[116.674358,30.074962],[116.685684,30.070602],[116.700184,30.063478],[116.714714,30.055846],[116.720333,30.053919],[116.726473,30.053366],[116.735042,30.053814],[116.747351,30.057235],[116.771777,30.073678],[116.79656,30.097031],[116.816932,30.115095],[116.841909,30.146765],[116.860046,30.177336],[116.860255,30.180797],[116.867512,30.213595],[116.88237,30.231145],[116.892728,30.240493],[116.909881,30.251703],[116.920521,30.257993],[116.924173,30.265759],[116.927153,30.273434],[116.928584,30.28397],[116.928792,30.291004],[116.927153,30.297574],[116.920492,30.314261],[116.918882,30.316495],[116.910343,30.33288],[116.903324,30.357274]]],[[[117.035347,30.494482],[117.040355,30.494839],[117.059743,30.494586],[117.076449,30.495225],[117.111575,30.495315],[117.123661,30.494631],[117.135121,30.492073],[117.144704,30.485679],[117.151171,30.481708],[117.164003,30.474808],[117.173123,30.47158],[117.177475,30.470569],[117.184807,30.467639],[117.192184,30.465869],[117.198503,30.467579],[117.204032,30.469706],[117.208607,30.472681],[117.222973,30.4855],[117.226296,30.489025],[117.23637,30.504756],[117.23953,30.514717],[117.243211,30.532318],[117.243822,30.538144],[117.245744,30.543836],[117.250111,30.553674],[117.252242,30.563972],[117.252585,30.571312],[117.251467,30.579424],[117.24792,30.589303],[117.245387,30.592735],[117.236221,30.60239],[117.226132,30.610781],[117.221453,30.615296],[117.217846,30.620642],[117.217086,30.630606],[117.211855,30.635105],[117.208174,30.642767],[117.206356,30.648542],[117.205492,30.654391],[117.205656,30.662451],[117.20731,30.669561],[117.2088,30.672856],[117.214285,30.679773],[117.223986,30.68651],[117.23111,30.689211],[117.237041,30.690235],[117.241363,30.690354],[117.240677,30.69258],[117.236341,30.694301],[117.233032,30.694583],[117.227265,30.692402],[117.220663,30.692965],[117.218964,30.695251],[117.216073,30.692728],[117.207355,30.691882],[117.204046,30.692387],[117.203406,30.69393],[117.20655,30.698945],[117.203733,30.701601],[117.200351,30.701868],[117.190545,30.698471],[117.185865,30.700296],[117.189948,30.704243],[117.187266,30.706631],[117.178056,30.70215],[117.172587,30.702996],[117.169815,30.70405],[117.167371,30.706409],[117.162989,30.708605],[117.162483,30.713634],[117.161305,30.71534],[117.153481,30.717343],[117.146537,30.721512],[117.143795,30.726155],[117.140501,30.727564],[117.126418,30.738659],[117.124674,30.740335],[117.122528,30.749471],[117.11998,30.753712],[117.117238,30.755996],[117.109324,30.759748],[117.101009,30.767384],[117.077135,30.770305],[117.059549,30.773167],[117.055511,30.773019],[117.053692,30.772085],[117.051547,30.768734],[117.046778,30.758235],[117.043648,30.754721],[117.03797,30.752882],[117.028626,30.752823],[117.017866,30.751785],[117.013336,30.755729],[117.007062,30.759451],[117.006257,30.75911],[117.008448,30.751147],[117.006555,30.744251],[117.001071,30.739237],[116.994514,30.737443],[116.989432,30.73326],[116.986913,30.728261],[116.987137,30.727134],[116.984842,30.722773],[116.985781,30.718619],[116.990758,30.716082],[116.998165,30.716512],[116.997971,30.711379],[116.995602,30.706928],[116.989864,30.706142],[116.988016,30.705207],[116.98134,30.697773],[116.980416,30.692684],[116.971429,30.691571],[116.970192,30.690027],[116.970654,30.684151],[116.966318,30.682756],[116.965692,30.677665],[116.962592,30.67673],[116.961981,30.67256],[116.960431,30.671313],[116.955781,30.670066],[116.953457,30.664351],[116.956944,30.658028],[116.963263,30.659186],[116.967361,30.657048],[116.971936,30.647814],[116.973814,30.645543],[116.977048,30.643539],[116.976228,30.642588],[116.969507,30.638832],[116.966824,30.633992],[116.96359,30.630502],[116.960714,30.628557],[116.961161,30.625186],[116.961161,30.617123],[116.962979,30.613499],[116.967271,30.611761],[116.968896,30.602434],[116.968955,30.596448],[116.96979,30.592764],[116.973486,30.58654],[116.973247,30.575339],[116.972651,30.57308],[116.964499,30.56687],[116.964112,30.566394],[116.958285,30.571312],[116.955319,30.575309],[116.954544,30.573303],[116.949135,30.571907],[116.9414,30.576735],[116.937347,30.580078],[116.934321,30.580538],[116.927719,30.579721],[116.927377,30.581237],[116.924128,30.580642],[116.923889,30.575205],[116.921922,30.56837],[116.919374,30.56687],[116.911952,30.567791],[116.911028,30.564537],[116.905932,30.55516],[116.903845,30.55308],[116.896543,30.554462],[116.896662,30.54984],[116.895619,30.546482],[116.891565,30.541964],[116.891103,30.539883],[116.892266,30.535246],[116.890865,30.531768],[116.88404,30.524127],[116.880448,30.521006],[116.879181,30.518924],[116.885083,30.513587],[116.886126,30.509767],[116.885306,30.506868],[116.87398,30.505143],[116.868869,30.502467],[116.867468,30.498616],[116.87395,30.491508],[116.873488,30.489501],[116.86331,30.487344],[116.834637,30.476131],[116.830628,30.474287],[116.829704,30.47274],[116.825144,30.470822],[116.814503,30.463281],[116.809705,30.461198],[116.797514,30.458982],[116.77519,30.456468],[116.767306,30.45321],[116.762493,30.448926],[116.758886,30.444329],[116.750138,30.436191],[116.750168,30.431028],[116.756651,30.420999],[116.770734,30.410879],[116.776963,30.408007],[116.780361,30.412963],[116.786143,30.415106],[116.794012,30.416103],[116.797127,30.422145],[116.800942,30.424912],[116.806471,30.426817],[116.815561,30.426252],[116.822089,30.424436],[116.826351,30.420225],[116.831776,30.417829],[116.835203,30.418424],[116.838541,30.423603],[116.844339,30.425894],[116.850732,30.430492],[116.853951,30.429287],[116.853638,30.421058],[116.854204,30.415924],[116.852952,30.414823],[116.849748,30.414912],[116.85021,30.412606],[116.852923,30.408409],[116.853355,30.406162],[116.857513,30.401979],[116.863787,30.387586],[116.867363,30.380783],[116.876663,30.368098],[116.877438,30.36518],[116.877929,30.357125],[116.886975,30.35711],[116.890925,30.354802],[116.89553,30.354906],[116.903324,30.357274],[116.902057,30.361696],[116.893846,30.381602],[116.889494,30.396651],[116.888257,30.406995],[116.891968,30.414719],[116.891044,30.419808],[116.890895,30.426296],[116.89243,30.431087],[116.896454,30.434316],[116.901073,30.436488],[116.906334,30.434629],[116.914426,30.425478],[116.928167,30.435923],[116.935588,30.440327],[116.950446,30.442826],[116.965587,30.450533],[116.975542,30.45806],[116.986377,30.470807],[117.010489,30.489278],[117.025437,30.494274],[117.035347,30.494482]]]]}}]};var zee=6371008.8,Fee={centimeters:100*zee,centimetres:100*zee,degrees:zee/111325,feet:3.28084*zee,inches:39.37*zee,kilometers:zee/1e3,kilometres:zee/1e3,meters:zee,metres:zee,miles:zee/1609.344,millimeters:1e3*zee,millimetres:1e3*zee,nauticalmiles:zee/1852,radians:1,yards:1.0936*zee};function Vee(e,t,n){void 0===n&&(n={});var r={type:"Feature"};return(0===n.id||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=t||{},r.geometry=e,r}function Gee(e,t,n){if(void 0===n&&(n={}),!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!qee(e[0])||!qee(e[1]))throw new Error("coordinates must contain numbers");return Vee({type:"Point",coordinates:e},t,n)}function Hee(e,t,n){void 0===n&&(n={});for(var r=0,i=e;r<i.length;r++){var a=i[r];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<a[a.length-1].length;s++)if(a[a.length-1][s]!==a[0][s])throw new Error("First and last Position are not equivalent.")}return Vee({type:"Polygon",coordinates:e},t,n)}function jee(e,t,n){return void 0===n&&(n={}),Vee({type:"MultiPolygon",coordinates:e},t,n)}function Wee(e,t){void 0===t&&(t="kilometers");var n=Fee[t];if(!n)throw new Error(t+" units is invalid");return e/n}function Yee(e){return 180*(e%(2*Math.PI))/Math.PI}function $ee(e){return e%360*Math.PI/180}function Xee(e,t,n){if(void 0===t&&(t="kilometers"),void 0===n&&(n="kilometers"),!(e>=0))throw new Error("length must be a positive number");return function(e,t){void 0===t&&(t="kilometers");var n=Fee[t];if(!n)throw new Error(t+" units is invalid");return e*n}(Wee(e,t),n)}function qee(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}function Kee(e,t,n){if(null!==e)for(var r,i,a,s,o,l,u,c,d=0,h=0,p=e.type,f="FeatureCollection"===p,m="Feature"===p,g=f?e.features.length:1,v=0;v<g;v++){o=(c=!!(u=f?e.features[v].geometry:m?e.geometry:e)&&"GeometryCollection"===u.type)?u.geometries.length:1;for(var y=0;y<o;y++){var _=0,b=0;if(null!==(s=c?u.geometries[y]:u)){l=s.coordinates;var x=s.type;switch(d=!n||"Polygon"!==x&&"MultiPolygon"!==x?0:1,x){case null:break;case"Point":if(!1===t(l,h,v,_,b))return!1;h++,_++;break;case"LineString":case"MultiPoint":for(r=0;r<l.length;r++){if(!1===t(l[r],h,v,_,b))return!1;h++,"MultiPoint"===x&&_++}"LineString"===x&&_++;break;case"Polygon":case"MultiLineString":for(r=0;r<l.length;r++){for(i=0;i<l[r].length-d;i++){if(!1===t(l[r][i],h,v,_,b))return!1;h++}"MultiLineString"===x&&_++,"Polygon"===x&&b++}"Polygon"===x&&_++;break;case"MultiPolygon":for(r=0;r<l.length;r++){for(b=0,i=0;i<l[r].length;i++){for(a=0;a<l[r][i].length-d;a++){if(!1===t(l[r][i][a],h,v,_,b))return!1;h++}b++}_++}break;case"GeometryCollection":for(r=0;r<s.geometries.length;r++)if(!1===Kee(s.geometries[r],t,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Zee(e){var t=[1/0,1/0,-1/0,-1/0];return Kee(e,(function(e){t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1])})),t}function Jee(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if("Feature"===e.type&&null!==e.geometry&&"Point"===e.geometry.type)return e.geometry.coordinates;if("Point"===e.type)return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Qee(e){return"Feature"===e.type?e.geometry:e}function ete(e){if(!e)throw new Error("geojson is required");switch(e.type){case"Feature":return tte(e);case"FeatureCollection":return function(e){var t={type:"FeatureCollection"};return Object.keys(e).forEach((function(n){switch(n){case"type":case"features":return;default:t[n]=e[n]}})),t.features=e.features.map((function(e){return tte(e)})),t}(e);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return rte(e);default:throw new Error("unknown GeoJSON type")}}function tte(e){var t={type:"Feature"};return Object.keys(e).forEach((function(n){switch(n){case"type":case"properties":case"geometry":return;default:t[n]=e[n]}})),t.properties=nte(e.properties),t.geometry=rte(e.geometry),t}function nte(e){var t={};return e?(Object.keys(e).forEach((function(n){var r=e[n];"object"==typeof r?null===r?t[n]=null:Array.isArray(r)?t[n]=r.map((function(e){return e})):t[n]=nte(r):t[n]=r})),t):t}function rte(e){var t={type:e.type};return e.bbox&&(t.bbox=e.bbox),"GeometryCollection"===e.type?(t.geometries=e.geometries.map((function(e){return rte(e)})),t):(t.coordinates=ite(e.coordinates),t)}function ite(e){var t=e;return"object"!=typeof t[0]?t.slice():t.map((function(e){return ite(e)}))}function ate(e,t,n){void 0===n&&(n={});var r=Jee(e),i=Jee(t);i[0]+=i[0]-r[0]>180?-360:r[0]-i[0]>180?360:0;var a=function(e,t,n){var r=n=void 0===n?zee:Number(n),i=e[1]*Math.PI/180,a=t[1]*Math.PI/180,s=a-i,o=Math.abs(t[0]-e[0])*Math.PI/180;o>Math.PI&&(o-=2*Math.PI);var l=Math.log(Math.tan(a/2+Math.PI/4)/Math.tan(i/2+Math.PI/4)),u=Math.abs(l)>1e-11?s/l:Math.cos(i);return Math.sqrt(s*s+u*u*o*o)*r}(r,i);return Xee(a,"meters",n.units)}function ste(e,t){var n=$ee(e[1]),r=$ee(t[1]),i=$ee(t[0]-e[0]);i>Math.PI&&(i-=2*Math.PI),i<-Math.PI&&(i+=2*Math.PI);var a=Math.log(Math.tan(r/2+Math.PI/4)/Math.tan(n/2+Math.PI/4));return(Yee(Math.atan2(i,a))+360)%360}function ote(e,t,n,r){void 0===r&&(r={});var i=t<0,a=Xee(Math.abs(t),r.units,"meters");i&&(a=-Math.abs(a));var s=Jee(e),o=function(e,t,n,r){r=void 0===r?zee:Number(r);var i=t/r,a=e[0]*Math.PI/180,s=$ee(e[1]),o=$ee(n),l=i*Math.cos(o),u=s+l;Math.abs(u)>Math.PI/2&&(u=u>0?Math.PI-u:-Math.PI-u);var c=Math.log(Math.tan(u/2+Math.PI/4)/Math.tan(s/2+Math.PI/4)),d=Math.abs(c)>1e-11?l/c:Math.cos(s),h=i*Math.sin(o)/d;return[(180*(a+h)/Math.PI+540)%360-180,180*u/Math.PI]}(s,a,n);return o[0]+=o[0]-s[0]>180?-360:s[0]-o[0]>180?360:0,Gee(o,r.properties)}function lte(e,t,n){if(!(r=n=n||{})||r.constructor!==Object)throw new Error("options is invalid");var r,i=n.origin,a=n.mutate;if(!e)throw new Error("geojson required");if("number"!=typeof t||0===t)throw new Error("invalid factor");var s=Array.isArray(i)||"object"==typeof i;return!0!==a&&(e=ete(e)),"FeatureCollection"!==e.type||s?ute(e,t,i):(function(e,t){if("Feature"===e.type)t(e,0);else if("FeatureCollection"===e.type)for(var n=0;n<e.features.length&&!1!==t(e.features[n],n);n++);}(e,(function(n,r){e.features[r]=ute(n,t,i)})),e)}function ute(e,t,n){var r,i="Point"===("FeatureCollection"===(r=e).type?"FeatureCollection":"GeometryCollection"===r.type?"GeometryCollection":"Feature"===r.type&&null!==r.geometry?r.geometry.type:r.type);return n=function(e,t){null==t&&(t="centroid");if(Array.isArray(t)||"object"==typeof t)return Jee(t);var n=e.bbox?e.bbox:Zee(e),r=n[0],i=n[1],a=n[2],s=n[3];switch(t){case"sw":case"southwest":case"westsouth":case"bottomleft":return Gee([r,i]);case"se":case"southeast":case"eastsouth":case"bottomright":return Gee([a,i]);case"nw":case"northwest":case"westnorth":case"topleft":return Gee([r,s]);case"ne":case"northeast":case"eastnorth":case"topright":return Gee([a,s]);case"center":return function(e,t){void 0===t&&(t={});var n=Zee(e);return Gee([(n[0]+n[2])/2,(n[1]+n[3])/2],t.properties,t)}(e);case void 0:case null:case"centroid":return function(e,t){void 0===t&&(t={});var n=0,r=0,i=0;return Kee(e,(function(e){n+=e[0],r+=e[1],i++}),!0),Gee([n/i,r/i],t.properties)}(e);default:throw new Error("invalid origin")}}(e,n),1===t||i||Kee(e,(function(e){var r,i,a,s,o=ate(n,e),l=(r=n,i=e,void 0===a&&(a={}),(s=a.final?ste(Jee(i),Jee(r)):ste(Jee(r),Jee(i)))>180?-(360-s):s),u=function(e){if(Array.isArray(e))return e;if("Feature"===e.type){if(null!==e.geometry)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}(ote(n,o*t,l));e[0]=u[0],e[1]=u[1],3===e.length&&(e[2]*=t)})),e}Zee.default=Zee;class cte{constructor(e){this._definitionChanged=new Cesium.Event,this._color=void 0,this._speed=void 0,this._percent=void 0,this._gradient=void 0,this.color=e.color,this.speed=e.speed,this.percent=e.percent,this.gradient=e.gradient}get isConstant(){return!1}get definitionChanged(){return this._definitionChanged}getType(e){return Cesium.Material.LineFlowMaterialType}getValue(e,t){return Cesium.defined(t)||(t={}),t.color=Cesium.Property.getValueOrDefault(this._color,e,Cesium.Color.RED,t.color),t.speed=Cesium.Property.getValueOrDefault(this._speed,e,5,t.speed),t.percent=Cesium.Property.getValueOrDefault(this._percent,e,.1,t.percent),t.gradient=Cesium.Property.getValueOrDefault(this._gradient,e,.01,t.gradient),t}equals(e){return this===e||e instanceof cte&&Cesium.Property.equals(this._color,e._color)&&Cesium.Property.equals(this._speed,e._speed)&&Cesium.Property.equals(this._percent,e._percent)&&Cesium.Property.equals(this._gradient,e._gradient)}}Object.defineProperties(cte.prototype,{color:Cesium.createPropertyDescriptor("color"),speed:Cesium.createPropertyDescriptor("speed"),percent:Cesium.createPropertyDescriptor("percent"),gradient:Cesium.createPropertyDescriptor("gradient")}),Cesium.Material.LineFlowMaterialProperty="LineFlowMaterialProperty",Cesium.Material.LineFlowMaterialType="LineFlowMaterialType",Cesium.Material.LineFlowMaterialSource="\n  uniform vec4 color;\n  uniform float speed;\n  uniform float percent;\n  uniform float gradient;\n  czm_material czm_getMaterial(czm_materialInput materialInput){\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    vec2 st = materialInput.st;\n    float t =fract(czm_frameNumber * speed / 1000.0);\n    t *= (1.0 + percent);\n    float alpha = smoothstep(t- percent, t, st.s) * step(-t, -st.s);\n    alpha += gradient;\n    material.diffuse = color.rgb;\n    material.alpha = alpha;\n    return material;\n  }\n  ",Cesium.Material._materialCache.addMaterial(Cesium.Material.LineFlowMaterialType,{fabric:{type:Cesium.Material.LineFlowMaterialType,uniforms:{color:new Cesium.Color(1,0,0,1),speed:10,percent:.1,gradient:.1},source:Cesium.Material.LineFlowMaterialSource},translucent:function(e){return!0}});class dte{constructor(e,n){t(this,"viewer"),t(this,"id"),t(this,"duration"),t(this,"maxRadius"),t(this,"pointDraged"),t(this,"leftDownFlag"),t(this,"update_position"),this.viewer=e,this.id=n,this.duration=1e3,this.maxRadius=1e3,this.pointDraged=null,this.leftDownFlag=!1}change_duration(e){this.duration=e}change_color(e){this.viewer.entities.getById(this.id)._ellipse._material.color=new Cesium.Color.fromCssColorString(e)}change_position(e){const t=Cesium.Cartesian3.fromDegrees(parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2]));this.viewer.entities.getById(this.id).position=t}del(){this.viewer.entities.removeById(this.id)}add(e,t,n,r,i=!1){const a=this;this.duration=r,this.maxRadius=n,i&&(this.viewer.screenSpaceEventHandler.setInputAction((function(e){a.pointDraged=a.viewer.scene.pick(e.position),a.pointDraged&&a.pointDraged.id&&a.pointDraged.id.id===a.id&&(a.leftDownFlag=!0,a.viewer.scene.screenSpaceCameraController.enableRotate=!1)}),Cesium.ScreenSpaceEventType.LEFT_DOWN),this.viewer.screenSpaceEventHandler.setInputAction((function(e){a.leftDownFlag=!1,a.pointDraged=null,a.viewer.scene.screenSpaceCameraController.enableRotate=!0}),Cesium.ScreenSpaceEventType.LEFT_UP),this.viewer.screenSpaceEventHandler.setInputAction((function(e){if(!0===a.leftDownFlag&&null!==a.pointDraged&&void 0!==a.pointDraged){const t=a.viewer.camera.getPickRay(e.endPosition),n=a.viewer.scene.globe.pick(t,a.viewer.scene);a.pointDraged.id.position=n;const r=a.viewer.scene.globe.ellipsoid.cartesianToCartographic(n),i=Cesium.Math.toDegrees(r.latitude),s=Cesium.Math.toDegrees(r.longitude);let o=r.height;o=o<0?0:o,a.update_position&&a.update_position([s.toFixed(8),i.toFixed(8),o])}}),Cesium.ScreenSpaceEventType.MOUSE_MOVE))}}function hte(e){this._definitionChanged=new Cesium.Event,this._color=void 0,this._colorSubscription=void 0,this.color=e,this._time=(new Date).getTime()}Object.defineProperties(hte.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:Cesium.createPropertyDescriptor("color")}),hte.prototype.getType=function(e){return Cesium.Material.HexagonSpreadMaterialType},hte.prototype.getValue=function(e,t){return Cesium.defined(t)||(t={}),t.color=Cesium.Property.getValueOrClonedDefault(this._color,e,Cesium.Color.WHITE,t.color),t.image="https://fastly.jsdelivr.net/gh/cjhayes16/oss/six.png",t},hte.prototype.equals=function(e){return this===e||e instanceof hte&&Cesium.Property.equals(this._color,e._color)},Cesium.Material.HexagonSpreadMaterialType="HexagonSpreadMaterial",Cesium.Material.HexagonSpreadMaterialImage="./six.png",Cesium.Material.HexagonSpreadSource="\n    czm_material czm_getMaterial(czm_materialInput materialInput)\n    {\n         czm_material material = czm_getDefaultMaterial(materialInput);\n         vec2 st = materialInput.st;\n         vec4 colorImage = texture(image,  vec2(st));\n         material.alpha = colorImage.a * color.a * 0.5;\n         material.diffuse =  1.8 * color.rgb  ;\n         return material;\n     }\n     ",Cesium.Material._materialCache.addMaterial(Cesium.Material.HexagonSpreadMaterialType,{fabric:{type:Cesium.Material.HexagonSpreadMaterialType,uniforms:{color:new Cesium.Color(1,0,0,.5),image:Cesium.Material.HexagonSpreadMaterialImage},source:Cesium.Material.HexagonSpreadSource},translucent:function(e){return!0}});class pte extends dte{constructor(e,t){super(e,t)}add(e,t,n,r,i=!1){super.add(e,t,n,r,i);const a=this;let s=1,o=this.viewer.entities.add({id:a.id,position:Cesium.Cartesian3.fromDegrees(e[0],e[1],e[2]),ellipse:{semiMajorAxis:new Cesium.CallbackProperty((function(e){return s+=1e3/a.duration*50,s>a.maxRadius&&(s=1),s}),!1),semiMinorAxis:new Cesium.CallbackProperty((function(e){return s}),!1),material:new hte(new Cesium.Color.fromCssColorString(t))}});this.viewer.zoomTo(o)}}class fte{constructor(e,n){t(this,"viewer"),n||(n={}),n.defaultAccessToken=n.defaultAccessToken||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJjZDRkMGYwNS0zYmQ5LTQ2M2EtOWExYy04Y2QwY2M4NGU5ZjAiLCJpZCI6MzQyNzQsImlhdCI6MTY4MTY2NTYyNH0.uYeRX1Y0fUAmzIu46srt1lpHN1S4FeBE0Hs7HooxX0E",Cesium.Ion.defaultAccessToken=n.defaultAccessToken;["geocoder","homeButton","sceneModePicker","baseLayerPicker","navigationHelpButton","animation","timeline","fullscreenButton","vrButton","infoBox","selectionIndicator"].forEach((e=>{n[e]=n[e]||!1})),n.terrainProvider&&(n.terrainProvider=Cesium.createWorldTerrain({requestWaterMask:!0}));Object.assign({url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"},{contextOptions:{id:e,webgl:{preserveDrawingBuffer:!0},requestWebgl1:!0}}),Cesium.Camera.DEFAULT_VIEW_RECTANGLE=Cesium.Rectangle.fromDegrees(80,26,150,35.5),this.viewer=new Cesium.Viewer(e,n),this.viewer.cesiumWidget.screenSpaceEventHandler.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),this.viewer.scene.globe.enableLighting=n.globeLight,this.viewer.scene.globe.showGroundAtmosphere=n.showGroundAtmosphere}tianTrerrain(){this.viewer.scene.globe.terrainExaggeration=8}lookAt(e,t,n){this.viewer.camera.flyTo({destination:Cesium.Cartesian3.fromDegrees(e,t,n||2e4),orientation:{heading:10,pitch:Cesium.Math.toRadians(-40),roll:0},duration:1,complete:function(){},cancle:function(){},maximunHeight:5e6,flyOverLongitude:100})}handler(){new Cesium.ScreenSpaceEventHandler(this.viewer.scene.canvas).setInputAction((e=>{var t=e,n=this.viewer.scene.pickPosition(t.position),r=Cesium.Cartographic.fromCartesian(n);Cesium.Math.toDegrees(r.longitude),Cesium.Math.toDegrees(r.latitude),r.height,this.viewer.scene.camera.heading,this.viewer.scene.camera.pitch,this.viewer.scene.camera.roll}),Cesium.ScreenSpaceEventType.LEFT_CLICK)}add3dTiles(){let e=this.viewer.scene.primitives.add(new Cesium.Cesium3DTileset({url:"../../public/model/model/tileset.json",scale:100}));this.viewer.zoomTo(e)}setCamera(e){let t=e||{};this.viewer.camera.setView({destination:{x:t.position.x,y:t.position.y,z:t.position.z},orientation:{heading:t.heading,pitch:t.pitch,roll:t.roll}})}addMap(e){let t=e||{};switch(t.mapType){case"mapbox":var n=new Cesium.MapboxStyleImageryProvider({username:"jhayes16",styleId:"clh7w461b00w901qy2cnx5t8g",accessToken:"pk.eyJ1IjoiamhheWVzMTYiLCJhIjoiY2xndTVkYW51MGN4MzNtbnVqemJqbGYybyJ9.Jz8QwZscb4jTKHRaS9S7GQ"});this.viewer.imageryLayers.addImageryProvider(n);break;case"osm":this.viewer.imageryLayers.addImageryProvider(new Cesium.UrlTemplateImageryProvider({url:"https://tile-{s}.openstreetmap.fr/hot/{z}/{x}/{y}.png",subdomains:["a","b","c","d"]}));break;case"arcgis":this.viewer.imageryLayers.addImageryProvider(new Cesium.ArcGisMapServerImageryProvider({url:"https://services.arcgisonline.com/arcgis/rest/services/Canvas/World_Dark_Gray_Base/MapServer"}));break;case"gaode":this.viewer.imageryLayers.addImageryProvider(new Cesium.UrlTemplateImageryProvider({url:"http://webst02.is.autonavi.com/appmaptile?x={x}&y={y}&z={z}&lang=zh_cn&size=1&scale=1&style=8",minimumLevel:3,maximumLevel:18}));break;case"tencent":let e;switch(t.tencentType){case"0":e="https://rt3.map.gtimg.com/tile?z={z}&x={x}&y={reverseY}&styleid=1&version=297";break;case"1":e="https://rt3.map.gtimg.com/tile?z={z}&x={x}&y={reverseY}&styleid=4&scene=0";break;case"2":e="https://rt3.map.gtimg.com/tile?z={z}&x={x}&y={reverseY}&styleid=3&scene=0";break;case"3":e="https://rt3.map.gtimg.com/tile?z={z}&x={x}&y={reverseY}&styleid=2&version=297";break;case"4":e="https://p2.map.gtimg.com/sateTiles/{z}/{sx}/{sy}/{x}_{reverseY}.jpg?version=400"}this.viewer.imageryLayers.addImageryProvider(new Cesium.UrlTemplateImageryProvider({url:e,customTags:{sx:function(e,t,n,r){return t>>4},sy:function(e,t,n,r){return(1<<r)-n>>4}}}));break;case"Tianditu":this.viewer.imageryLayers.addImageryProvider(new Cesium.WebMapTileServiceImageryProvider({url:"http://t0.tianditu.gov.cn/cia_w/wmts?tk=2d91cec1a82a7ed250729c4b1ba4131a",layer:"cia",style:"default",tileMatrixSetID:"w",format:"tiles",maximumLevel:18}));break;case"google":this.viewer.imageryLayers.addImageryProvider(new Cesium.UrlTemplateImageryProvider({url:"http://mt1.google.cn/vt/lyrs=s&hl=zh-CN&x={x}&y={y}&z={z}&s=Gali"}))}}addTerrain(e){let t=e||{};this.viewer.terrainProvider=Cesium.createWorldTerrain(),this.viewer.scene.globe.terrainExaggeration=t.terrainExaggeration||10}addcompass(){var e={defaultResetView:Cesium.Rectangle.fromDegrees(80,22,130,50),enableCompass:!0,enableZoomControls:!0,enableDistanceLegend:!0,enableCompassOuterRing:!0};new Nee(this.viewer,e)}setBackground(e){let t=e||{};this.viewer.imageryLayers.addImageryProvider(new Cesium.SingleTileImageryProvider({url:t.img||"https://fastly.jsdelivr.net/gh/cjhayes16/oss/globe.jpg"}))}addGeojson(e){let t=this,n=e||"../../public/安庆市.json";$.get(n,(function(e){let n=e.features,r=[];for(let t=0;t<n[0].geometry.coordinates[1][0].length;t++){let e=n[0].geometry.coordinates[1][0][t];r.push(Number(e[0])),r.push(Number(e[1]))}let i=new Cesium.Entity({polygon:{hierarchy:{positions:Cesium.Cartesian3.fromDegreesArray([0,0,0,90,179,90,179,0]),holes:[{positions:Cesium.Cartesian3.fromDegreesArray(r)}]},material:new Cesium.Color(15/255,38/255,84/255,.7)}}),a=new Cesium.Entity({polyline:{positions:Cesium.Cartesian3.fromDegreesArray(r),width:5,material:Cesium.Color.YELLOW}});t.viewer.entities.add(i),t.viewer.entities.add(a)}))}addGeojsonByPrimitive(e){let t=e||"../../public/安庆市.json";$.get(t,(function(e){!function(e){const t=[];for(let n=0;n<e.length;n++)for(let r=0;r<e[n].geometry.coordinates.length;r++){const i=e[n].geometry.coordinates[r][0].flat(),a=new Cesium.WallGeometry({positions:Cesium.Cartesian3.fromDegreesArray(i),maximumHeights:new Array(Cesium.Cartesian3.fromDegreesArray(i).length).fill(5e4),minimunHeights:new Array(Cesium.Cartesian3.fromDegreesArray(i).length).fill(0)});t.push(new Cesium.GeometryInstance({geometry:a,attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(Cesium.Color.GREEN)}}))}const r=new Cesium.Primitive({geometryInstances:t,appearance:new Cesium.PerInstanceColorAppearance});n.viewer.scene.primitives.add(r)}(e.features)}));let n=this}addModel(){let e;for(let t=1;t<9;t++)e=this.viewer.entities.add({name:"glb模型",position:new Cesium.Cartesian3.fromDegrees(120.14046454,30.27415039),model:{uri:"/model/glb/"+t+".glb",minimumPixelSize:4,maxumunScale:10}});this.viewer.zoomTo(e)}addMovingModel(){let e=new Cesium.Cartesian3.fromDegrees(120.14046454,30.27415039),t=new Cesium.Cartesian3.fromDegrees(120.16701991,30.27648221),n=0;const r=this.viewer.entities.add({position:new Cesium.CallbackProperty((function(){return n>5e3&&(n=0),n++,Cesium.Cartesian3.lerp(e,t,n/5e3,new Cesium.Cartesian3)}),!1),model:{uri:"./model/glb/car1.glb",scale:1e3}});this.viewer.trackedEntity=r}addMoveModel(){this.viewer.camera.setView({destination:{x:-2769293.799109788,y:4796599.883886506,z:3171113.878101777},orientation:{heading:6.283185307179586,pitch:-.7854060155492881,roll:6.283185307179586}});let e=new Cesium.HeadingPitchRoll,t=new Cesium.Cartesian3.fromDegrees(120,30,5e3),n=Cesium.Transforms.localFrameToFixedFrameGenerator("north","west"),r=Cesium.Math.toRadians(5),i=this.viewer.scene.primitives.add(Cesium.Model.fromGltf({url:"./model/glb/car.glb",scale:100,modelMatrix:Cesium.Transforms.headingPitchRollToFixedFrame(t,e,Cesium.Ellipsoid.WGS84,n),minimumPixelSize:256}));document.addEventListener("keydown",(function(t){switch(t.keyCode){case 38:e.pitch+=r,e.pitch>Cesium.Math.TWO_PI&&(e.pitch-=Cesium.Math.TWO_PI);break;case 40:e.pitch-=r,e.pitch<-Cesium.Math.TWO_PI&&(e.pitch+=Cesium.Math.TWO_PI);break;case 37:e.heading-=r,e.heading<-Cesium.Math.TWO_PI&&(e.heading+=Cesium.Math.TWO_PI);break;case 39:e.heading+=r,e.heading>Cesium.Math.TWO_PI&&(e.heading-=Cesium.Math.TWO_PI);break;case 96:e.roll+=r,e.roll>Cesium.Math.TWO_PI&&(e.roll-=Cesium.Math.TWO_PI);break;case 110:e.roll-=r,e.roll<-Cesium.Math.TWO_PI&&(e.roll+=Cesium.Math.TWO_PI);break;case 107:a+=10,a=Math.min(a,1e4);break;case 109:a-=10,a=Math.max(a,100)}}));let a=100,s=new Cesium.Cartesian3;const o=new Cesium.SampledPositionProperty;this.viewer.entities.add({position:o,name:"飞行路径",path:{show:!0,leadTime:0,trailTime:60,width:20,resolution:1,material:new Cesium.PolylineGlowMaterialProperty({glowPower:.3,taperPower:.3,color:Cesium.Color.PALEGOLDENROD})}}),this.viewer.scene.preUpdate.addEventListener((()=>{s=Cesium.Cartesian3.multiplyByScalar(Cesium.Cartesian3.UNIT_X,a/10,s),t=Cesium.Matrix4.multiplyByPoint(i.modelMatrix,s,t),o.addSample(Cesium.JulianDate.now(),t),Cesium.Transforms.headingPitchRollToFixedFrame(t,e,Cesium.Ellipsoid.WGS84,n,i.modelMatrix)}))}add3Dtiles(){let e=this.viewer.scene.primitives.add(new Cesium.Cesium3DTileset({url:"/model/model/tileset.json",modelMatrix:Cesium.Matrix4.fromArray([.999999999999995,9381384558082573e-30,9.955916671633425e-8,0,9797718192317006e-30,.9999999999999796,-2.0059579858289212e-7,0,-9.95591666608231e-8,2.0059579902698133e-7,.9999999999999747,0,147.46004487527534,-297.10840827506036,-275.5577001874335,1])}));this.viewer.zoomTo(e);const t={feautre:void 0,originalColor:new Cesium.Color};let n=this;this.viewer.screenSpaceEventHandler.setInputAction((function(e){Cesium.defined(t.feature)&&(t.feature.color=t.originalColor,t.feature=void 0);const r=n.viewer.scene.pick(e.position);Cesium.defined(r)&&(t.feature=r,Cesium.Color.clone(r.color,t.originalColor),r.color=Cesium.Color.YELLOW)}),Cesium.ScreenSpaceEventType.LEFT_CLICK)}add3DtilesView(){let e=new Cesium.Cesium3DTileset({url:"/model/model/tileset.json"}),t=this;e.readyPromise.then((e=>{t.viewer.scene.primitives.add(e),t.viewer.zoomTo(e);let n=Cesium.Cartographic.fromCartesian(e.boundingSphere.center),r=Cesium.Cartesian3.fromRadians(n.longitude,n.latitude,0),i=Cesium.Cartesian3.fromRadians(n.longitude,n.latitude,1e3),a=Cesium.Cartesian3.subtract(i,r,new Cesium.Cartesian3);e.modelMatrix=Cesium.Matrix4.fromTranslation(a)}))}add3dtilesetFeature(){let e=this.viewer.scene.primitives.add(new Cesium.Cesium3DTileset({url:"/model/model/tileset.json",modelMatrix:Cesium.Matrix4.fromArray([.999999999999995,9381384558082573e-30,9.955916671633425e-8,0,9797718192317006e-30,.9999999999999796,-2.0059579858289212e-7,0,-9.95591666608231e-8,2.0059579902698133e-7,.9999999999999747,0,147.46004487527534,-297.10840827506036,-275.5577001874335,1])}));this.viewer.zoomTo(e),e.tileLoad.addEventListener((function(e){let t=e.content;t.featuresLength,t.getFeature(0)}))}add3dtilesetMaterial(){this.viewer.scene.fxaa=!0,this.viewer.scene.postProcessStages.fxaa.enabled=!0;let e={u_texture:{value:new Cesium.TextureUniform({url:"/blue.png"}),type:Cesium.UniformType.SAMPLER_2D},T_time:{value:0,type:Cesium.UniformType.FLOAT}};var t=this.viewer.scene.primitives.add(new Cesium.Cesium3DTileset({url:"./model/model/tileset.json",modelMatrix:Cesium.Matrix4.fromArray([.999999999999995,9381384558082573e-30,9.955916671633425e-8,0,9797718192317006e-30,.9999999999999796,-2.0059579858289212e-7,0,-9.95591666608231e-8,2.0059579902698133e-7,.9999999999999747,0,147.46004487527534,-297.10840827506036,-275.5577001874335,1]),customShader:(n(),new Cesium.CustomShader({lightingModel:Cesium.LightingModel.UNLIT,varyings:{v_normalMC:Cesium.VaryingType.VEC3},uniforms:e,vertexShaderText:"\n          void vertexMain(VertexInput vsInput, inout czm_modelVertexOutput vsOutput) {\n            v_normalMC = vsInput.attributes.normalMC;\n          }",fragmentShaderText:"\n          void fragmentMain(FragmentInput fsInput, inout czm_modelMaterial material) {\n            vec3 positionMC = fsInput.attributes.positionMC;\n            float width = 300.0;\n            float height = 300.0;\n            vec4 vFragColor;\n            if (v_normalMC.z > 0.95) {\n              material.diffuse = vec3(0.079, 0.107, 0.111);\n              return;\n            } else {\n              float textureX =mod(200.0, width) / width;\n              float textureY = mod(positionMC.y, height) / height;\n              vec3 rgb = texture(u_texture, vec2(textureX, textureY-T_time)).rgb;\n              vFragColor = vec4(0,  0.5, 1.0, 1.0);\n              vFragColor *= vec4(vec3((positionMC.y + 40.0) / 30.0,0.3,0.8), 1.0);\n              rgb = mix(vFragColor.rgb,rgb,0.9);\n              material.diffuse = rgb;\n              return;\n            }\n          }"})),enableModelExperimental:!0,style:new Cesium.Cesium3DTileStyle({color:"vec4(1.0, 1.0, 1.0, 1.0)",show:{conditions:[["${height} === undefined || ${height} === null || isNaN(${height}) ","false"]]}})}));function n(){requestAnimationFrame(n),e.T_time.value+=.005}this.viewer.zoomTo(t),t.tileVisible.addEventListener((function(e){let t,n=e.content,r=n.featuresLength;for(var i=0;i<r;i+=2)t=n.getFeature(i),t.content._model}))}addPoint(){let e=this;!function(t,n,r,i,a){e.viewer.entities.add({name:r,position:Cesium.Cartesian3.fromDegrees(t,n,30),billboard:{image:a,width:50,height:50},label:{text:r,font:"20px sans-serif",style:Cesium.LabelStyle.FILL,horizontalOrigin:Cesium.HorizontalOrigin.LEFT,verticalOrigin:Cesium.VerticalOrigin.CENTER,pixelOffset:new Cesium.Cartesian2(20,-2),showBackground:!0,backgroundColor:new Cesium.Color.fromBytes(0,70,24)}});let s=[];s.push(new Cesium.Cartesian3.fromDegrees(t,n,5)),s.push(new Cesium.Cartesian3.fromDegrees(t,n,30)),e.viewer.entities.add({polyline:{positions:s,width:1.5,material:i}}),e.viewer.zoomTo(e.viewer.entities.add({position:Cesium.Cartesian3.fromDegrees(t,n,5),point:{color:i,pixelSize:15}}))}(22.528061,113.9236839,"sss",new Cesium.Color.fromBytes(0,70,24),"./six.png")}addCluster(){function e(e,t,n){let r=document.createElement("canvas");r.width=n,r.height=n;let i=r.getContext("2d"),a=new Cesium.Resource.fetchImage(e).then((e=>{try{i.drawImage(e,0,0)}catch(zA){console.log(zA)}return i.fillStyle=Cesium.Color.WHITE.toCssColorString(),i.font="bold 20px Microsoft YaHei",i.textAlign="center",i.textBaseline="middle",i.fillText(t,n/2,n/2),r}));return a}var t;t=this.viewer,(new Cesium.GeoJsonDataSource).load("./point.geojson").then((n=>{t.dataSources.add(n),n.clustering.enabled=!0,n.clustering.pixelRange=60,n.clustering.minimumClusterSize=2,n.entities.values.forEach((e=>{e.billboard={image:"./six.png",width:32,height:32},e.label={text:"POI",font:"bold 15px Microsoft YaHei",verticalOrigin:Cesium.VerticalOrigin.CENTER,horizontalOrigin:Cesium.HorizontalOrigin.LEFT,pixelOffset:new Cesium.Cartesian2(15,0)}})),n.clustering.clusterEvent.addEventListener((function(t,n){n.label.show=!1,n.billboard.show=!0,n.billboard.verticalOrigin=Cesium.VerticalOrigin.BOTTOM,t.length>=20?(n.billboard.image=e("./six.png",t.length,64),n.billboard.width=72,n.billboard.height=72):t.length>=12?(n.billboard.image=e("./six.png",t.length,64),n.billboard.width=56,n.billboard.height=56):t.length>=8?(n.billboard.image=e("./six.png",t.length,64),n.billboard.width=48,n.billboard.height=48):(n.billboard.image=e("./six.png",t.length,64),n.billboard.width=40,n.billboard.height=40)}))}))}addPointLabel(){var e=this.viewer.entities.add({name:"Blank blue pin",position:new Cesium.Cartesian3.fromDegrees(120,30,0),billboard:{image:function(e,t,n){let r=document.createElement("canvas");r.width=n,r.height=n;let i=r.getContext("2d"),a=new Cesium.Resource.fetchImage(e).then((e=>{try{i.drawImage(e,0,-0)}catch(zA){console.log(zA)}return i.fillStyle=Cesium.Color.WHITE.toCssColorString(),i.font="bold 20px Microsoft YaHei",i.textAlign="center",i.textBaseline="middle",i.fillText(t,n/2,n/2),r}));return a}("/wenhao.jpg","sdasdasd",260),verticalOrigin:Cesium.VerticalOrigin.BOTTOM}});this.viewer.zoomTo(e)}addMatrixGraph(){let e=[];for(let t=-180;t<180;t+=5)for(let n=-90;n<90;n+=5)e.push(new Cesium.GeometryInstance({geometry:new Cesium.RectangleGeometry({rectangle:Cesium.Rectangle.fromDegrees(t,n,t+5,n+5)}),attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(Cesium.Color.fromRandom({alpha:.5}))}}));this.viewer.scene.primitives.add(new Cesium.Primitive({geometryInstances:e,appearance:new Cesium.PerInstanceColorAppearance}))}addglobeRotate(){new mte(this.viewer).start()}addDayAndNight(){!function(e){e.imageryLayers.addImageryProvider(new Cesium.UrlTemplateImageryProvider({url:"https://tile-{s}.openstreetmap.fr/hot/{z}/{x}/{y}.png",subdomains:["a","b","c","d"]}));const t=e.imageryLayers.addImageryProvider(new Cesium.UrlTemplateImageryProvider({url:"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",subdomains:["a","b","c","d"]}));e.scene.globe.enableLighting=!0,e.clock.shouldAnimate=!0,e.clock.multiplier=5e3,t.dayAlpha=0}(this.viewer)}addDivide(){let e=document.createElement("div");e.id="slider",document.body.append(e);this.viewer.imageryLayers.addImageryProvider(new Cesium.UrlTemplateImageryProvider({url:"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png",subdomains:["a","b","c","d"]})).splitDirection=Cesium.SplitDirection.RIGHT;const t=document.getElementById("slider");this.viewer.scene.splitPosition=t.offsetLeft/t.parentElement.offsetWidth;const n=new Cesium.ScreenSpaceEventHandler(t);let r=!1,i=this;function a(e){if(!r)return;const n=e.endPosition.x,a=(t.offsetLeft+n)/t.parentElement.offsetWidth;t.style.left=100*a+"%",i.viewer.scene.splitPosition=a}n.setInputAction((function(){r=!0}),Cesium.ScreenSpaceEventType.LEFT_DOWN),n.setInputAction((function(){r=!0}),Cesium.ScreenSpaceEventType.PINCH_START),n.setInputAction(a,Cesium.ScreenSpaceEventType.MOUSE_MOVE),n.setInputAction(a,Cesium.ScreenSpaceEventType.PINCH_MOVE),n.setInputAction((function(){r=!1}),Cesium.ScreenSpaceEventType.LEFT_UP),n.setInputAction((function(){r=!1}),Cesium.ScreenSpaceEventType.PINCH_END)}addSkyBox(){let e=new Cesium.SkyBox({sources:{negativeX:"./images/JHAYES.png",positiveX:"./images/JHAYES.png",negativeY:"./images/JHAYES.png",positiveY:"./images/JHAYES.png",negativeZ:"./images/JHAYES.png",positiveZ:"./images/JHAYES.png"}}),t=this.viewer.scene.skyBox;this.viewer.scene.preUpdate.addEventListener((()=>{let n=this.viewer.scene.camera.position;Cesium.Cartographic.fromCartesian(n).height<24e7?(this.viewer.scene.skyBox=e,this.viewer.scene.skyAtmosphere.show=!1):(this.viewer.scene.skyBox=t,this.viewer.scene.skyAtmosphere.show=!0)}))}addRoadShuttle(){function e(e,t){this._definitionChanged=new Cesium.Event,this.duration=e,this.image=t,this._time=performance.now()}setInterval((()=>{console.log(this.viewer.scene)}),1e3),Object.defineProperties(e.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:Cesium.createPropertyDescriptor("color"),duration:Cesium.createPropertyDescriptor("duration")}),e.prototype.getType=function(e){return"Spriteline1"},e.prototype.getValue=function(e,t){return Cesium.defined(t)||(t={}),t.image=this.image,t.time=(performance.now()-this._time)%this.duration/this.duration,t},e.prototype.equals=function(t){return this===t||t instanceof e&&this.duration===t.duration},console.log(Object.isExtensible(Cesium)),Cesium.Material.Spriteline1Type="Spriteline1",Cesium.Material.Spriteline1Source="\n    czm_material czm_getMaterial(czm_materialInput materialInput)\n    {\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    vec2 st = materialInput.st;\n    vec4 colorImage = texture(image, vec2(fract(st.s - time), st.t));\n    material.alpha = colorImage.a;\n    material.diffuse = colorImage.rgb * 1.5 ;\n    return material;\n    }\n    ",Cesium.Material._materialCache.addMaterial(Cesium.Material.Spriteline1Type,{fabric:{type:Cesium.Material.Spriteline1Type,uniforms:{color:new Cesium.Color(1,0,0,.5),image:"",transparent:!0,time:20},source:Cesium.Material.Spriteline1Source},translucent:function(e){return!0}});let t=this;Cesium.GeoJsonDataSource.load("/road1.geojson").then((function(n){t.viewer.dataSources.add(n);const r=n.entities.values;for(let t=0;t<r.length;t++){let n=r[t];n.polyline.width=1.7,n.polyline.material=new e(1e3,"https://fastly.jsdelivr.net/gh/cjhayes16/oss/spriteline1.png")}}))}addScintillationLine(){class e{constructor(e){this._definitionChanged=new Cesium.Event,this._color=void 0,this._speed=void 0,this.color=e.color,this.speed=e.speed}get isConstant(){return!1}get definitionChanged(){return this._definitionChanged}getType(e){return Cesium.Material.LineFlickerMaterialType}getValue(e,t){return Cesium.defined(t)||(t={}),t.color=Cesium.Property.getValueOrDefault(this._color,e,Cesium.Color.RED,t.color),t.speed=Cesium.Property.getValueOrDefault(this._speed,e,5,t.speed),t}equals(t){return this===t||t instanceof e&&Cesium.Property.equals(this._color,t._color)&&Cesium.Property.equals(this._speed,t._speed)}}Object.defineProperties(e.prototype,{color:Cesium.createPropertyDescriptor("color"),speed:Cesium.createPropertyDescriptor("speed")}),Cesium.Material.LineFlickerMaterialProperty="LineFlickerMaterialProperty",Cesium.Material.LineFlickerMaterialType="LineFlickerMaterialType",Cesium.Material.LineFlickerMaterialSource="\n    uniform vec4 color;\n    uniform float speed;\n    czm_material czm_getMaterial(czm_materialInput materialInput){\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    float time = fract( czm_frameNumber  *  speed / 1000.0);\n    vec2 st = materialInput.st;\n    float scalar = smoothstep(0.0,1.0,time);\n    material.diffuse = color.rgb * scalar;\n    material.alpha = color.a * scalar ;\n    return material;\n    }\n    ",Cesium.Material._materialCache.addMaterial(Cesium.Material.LineFlickerMaterialType,{fabric:{type:Cesium.Material.LineFlickerMaterialType,uniforms:{color:new Cesium.Color(1,0,0,1),speed:5},source:Cesium.Material.LineFlickerMaterialSource},translucent:function(e){return!0}});let t=this;Cesium.GeoJsonDataSource.load("/road1.geojson").then((function(n){t.viewer.dataSources.add(n);const r=n.entities.values;t.viewer.zoomTo(r);for(let t=0;t<r.length;t++){let n=r[t];n.polyline.width=3,n.polyline.material=new e({color:Cesium.Color.YELLOW,speed:20*Math.random()})}}))}addFlyLine(){var e;e=this.viewer,function(e,t){let n=[];for(let r=0;r<t;r++){let t=e[0]+.04*Math.random()*(r%2==0?1:-1),i=e[1]+.04*Math.random()*(r%2==0?1:-1);n.push([t,i])}return n}([117.061644,30.526779],120).forEach((t=>{let n=t[0],r=t[1],i=new Cesium.Cartesian3.fromDegrees(n,r,0),a=5e3*Math.random(),s=new Cesium.Cartesian3.fromDegrees(n,r,a),o=[];o.push(i),o.push(s);let l=e.entities.add({polyline:{positions:o,material:new cte({color:new Cesium.Color(1,1,0,.8),speed:15*Math.random(),percent:.2,gradient:.01})}});e.zoomTo(l)}))}addParabola(){!function(e,t){let n=[117.061644,30.526779];[[116.961644,30.526779],[117.161644,30.526779],[117.061644,30.426779],[117.061644,30.626779],[116.961644,30.426779],[117.161644,30.626779],[116.961644,30.626779],[117.161644,30.426779]].forEach((r=>{let i=function(e,t,n=0,r=50){let i=[];n=Math.max(+n,100),r=Math.max(+r,50);let a=Math.abs(e[0]-t[0]),s=Math.abs(e[1]-t[1]),o=Math.max(a,s),l=o/r;if(a>s){let a=(t[1]-e[1])/r;e[0]-t[0]>0&&(l=-l);for(let t=0;t<r;t++){let r=n-4*Math.pow(-.5*o+Math.abs(l)*t,2)*n/Math.pow(o,2),s=e[0]+l*t,u=e[1]+a*t,c=new Cesium.Cartesian3.fromDegrees(s,u,r);i.push(c)}}else{let a=(t[0]-e[0])/r;e[1]-t[1]>0&&(l=-l);for(let t=0;t<r;t++){let r=n-4*Math.pow(-.5*o+Math.abs(l)*t,2)*n/Math.pow(o,2),s=e[0]+a*t,u=e[1]+l*t,c=new Cesium.Cartesian3.fromDegrees(s,u,r);i.push(c)}}return i}(n,r,5e3);for(let n=0;n<t;n++)e.entities.add({polyline:{positions:i,material:new cte({color:new Cesium.Color(1,1,0,.8),speed:15*Math.random(),percent:.1,gradient:.01})}});let a=e.entities.add({polyline:{positions:i,material:new Cesium.Color(1,1,0,.2)}});e.zoomTo(a)}))}(this.viewer,10)}addGeojsonBorder(){let e=this;Cesium.GeoJsonDataSource.load("./安庆市.geojson").then((function(t){e.viewer.dataSources.add(t);let n=t.entities.values;for(let e=0;e<n.length;e++){let t=n[e];console.log(n),t.polygon.material=new Cesium.Color(.8,247/255,217/255,.6),t.polygon.outline=!0,t.polygon.extrudedHeight=3500}}))}addHexagon(){new pte(this.viewer,"hexagonSpred1").add([117.061644,30.526779,10],"#0099BF",1e3,7500)}addFlowWater(){this.viewer.scene.primitives.add(new Cesium.Primitive({geometryInstances:new Cesium.GeometryInstance({geometry:new Cesium.RectangleGeometry({rectangle:Cesium.Rectangle.fromDegrees(113.95,22.48,113.99,22.52),vertexFormat:Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT})}),appearance:new Cesium.EllipsoidSurfaceAppearance({material:new Cesium.Material({fabric:{type:"Water",uniforms:{baseWaterColor:new Cesium.Color(64/255,157/255,253/255,.5),normalMap:"/water.jpg",frequency:1e3,animationSpeed:.1,amplitude:10,specularIntensity:10}}})})}))}addFlowWall(){let e=this;function t(e){this._definitionChanged=new Cesium.Event,this._color=void 0,this._colorSubscription=void 0,this.color=e.color,this.duration=e.duration,this.trailImage=e.trailImage,this._time=(new Date).getTime()}Object.defineProperties(t.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:Cesium.createPropertyDescriptor("color")}),t.prototype.getType=function(e){return"DynamicWall"},t.prototype.getValue=function(t,n){return Cesium.defined(n)||(n={}),n.color=Cesium.Property.getValueOrClonedDefault(this._color,t,Cesium.Color.WHITE,n.color),this.trailImage?n.image=this.trailImage:n.image=Cesium.Material.DynamicWallImage,this.duration&&(n.time=((new Date).getTime()-this._time)%this.duration/this.duration),e.viewer.scene.requestRender(),n},t.prototype.equals=function(e){return this===e||e instanceof t&&Cesium.Property.equals(this._color,e._color)},Cesium.Material.DynamicWallSource="czm_material czm_getMaterial(czm_materialInput materialInput)\n                                          {\n                                          czm_material material = czm_getDefaultMaterial(materialInput);\n                                          vec2 st = materialInput.st;\n                                          vec4 colorImage = texture(image, vec2(fract(st.t - time), st.t));\n                                          vec4 fragColor;\n                                          fragColor.rgb = color.rgb / 1.0;\n                                          fragColor = czm_gammaCorrect(fragColor);\n                                          material.alpha = colorImage.a * color.a;\n                                          material.diffuse = color.rgb;\n                                          material.emission = fragColor.rgb;\n                                          return material;\n                                          }",Cesium.Material._materialCache.addMaterial("DynamicWall",{fabric:{type:"DynamicWall",uniforms:{color:new Cesium.Color(1,1,1,1),image:"./colors.png",time:0},source:Cesium.Material.DynamicWallSource},translucent:function(e){return!0}}),function(e,n){let r=e.entities.add({name:"立体墙效果",wall:{positions:n,maximumHeights:new Array(n.length).fill(1e4),minimumHeights:new Array(n.length).fill(0),material:new t({color:Cesium.Color.fromBytes(255,255,0).withAlpha(1),duration:3e3})}});e.zoomTo(r)}(this.viewer,Cesium.Cartesian3.fromDegreesArrayHeights([19,47,1e6,19,48,1e6,20,48,1e6,20,47,1e6,19,47,1e6]))}addstreamWall(){let e=this;function t(e){this._definitionChanged=new Cesium.Event,this._color=void 0,this._colorSubscription=void 0,this.color=e.color,this.duration=e.duration,this._time=(new Date).getTime()}Object.defineProperties(t.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:Cesium.createPropertyDescriptor("color")}),t.prototype.getType=function(e){return"TrailLine"},t.prototype.getValue=function(t,n){return Cesium.defined(n)||(n={}),n.color=Cesium.Property.getValueOrClonedDefault(this._color,t,Cesium.Color.WHITE,n.color),this.duration&&(n.time=((new Date).getTime()-this._time)%this.duration/this.duration),e.viewer.scene.requestRender(),n},t.prototype.equals=function(e){return this===e||e instanceof t&&Cesium.Property.equals(this._color,e._color)},Cesium.Material.TrailLineSource="czm_material czm_getMaterial(czm_materialInput materialInput)\n    {\n       czm_material material = czm_getDefaultMaterial(materialInput);\n       vec2 st = materialInput.st;\n       vec4 colorImage = texture(image, vec2(fract(st.s - time), st.t));\n       material.alpha = colorImage.a * color.a;\n       material.diffuse = (colorImage.rgb+color.rgb)/2.0;\n       return material;\n    }",Cesium.Material._materialCache.addMaterial("TrailLine",{fabric:{type:"TrailLine",uniforms:{color:new Cesium.Color(1,1,1,1),image:"./yellow.png",time:0},source:Cesium.Material.TrailLineSource},translucent:function(e){return!0}}),console.log(Uee.features[0].geometry.coordinates[0][0],Uee.features[0].geometry.coordinates[0][0].length);let n=this.viewer.entities.add({name:"流动墙效果",wall:{positions:Cesium.Cartesian3.fromDegreesArray(Uee.features[0].geometry.coordinates[0][0].flat()),maximumHeights:new Array(Uee.features[0].geometry.coordinates[0][0].length).fill(3e3),minimunHeights:new Array(Uee.features[0].geometry.coordinates[0][0].length).fill(50),material:new t({color:Cesium.Color.RED,duration:18e3})}});this.viewer.zoomTo(n)}addDiffusionWall(){let e=this;!function(t,n,r,i){let a=1,s=e.viewer.entities.add({name:"扩散墙",wall:{positions:new Cesium.CallbackProperty((()=>{n>=1?(a+=n/200,a>=n&&(a=1)):(a-=n/200,a<=n&&(a=1));let e=lte(Hee(t),a),i=[];for(let t=0;t<e.geometry.coordinates[0].length;t++)e.geometry.coordinates[0][t].forEach((e=>{i.push(e)})),i.push(r);return Cesium.Cartesian3.fromDegreesArrayHeights(i)}),!1),material:i}});e.viewer.zoomTo(s)}([[[117.061644,30.526779],[117.161644,30.626779],[117.261644,30.526779],[117.161644,30.426779],[117.061644,30.526779]]],3,5e3,new Cesium.Color(1,1,0,.7))}addWallRegularDiffuse(){class e{constructor(e){this._definitionChanged=new Cesium.Event,this._color=void 0,this.color=e.color}get isConstant(){return!1}get definitionChanged(){return this._definitionChanged}getType(e){return Cesium.Material.WallDiffuseMaterialType}getValue(e,t){return Cesium.defined(t)||(t={}),t.color=Cesium.Property.getValueOrDefault(this._color,e,Cesium.Color.RED,t.color),t}equals(t){return this===t||t instanceof e&&Cesium.Property.equals(this._color,t._color)}}Object.defineProperties(e.prototype,{color:Cesium.createPropertyDescriptor("color")}),Cesium.Material.WallDiffuseMaterialProperty="WallDiffuseMaterialProperty",Cesium.Material.WallDiffuseMaterialType="WallDiffuseMaterialType",Cesium.Material.WallDiffuseMaterialSource="\n      uniform vec4 color;\n      czm_material czm_getMaterial(czm_materialInput materialInput){\n      czm_material material = czm_getDefaultMaterial(materialInput);\n      vec2 st = materialInput.st;\n      material.diffuse = color.rgb * 2.0;\n      material.alpha = color.a * (1.0-fract(st.t)) * 0.8;\n      return material;\n      }\n      ",Cesium.Material._materialCache.addMaterial(Cesium.Material.WallDiffuseMaterialType,{fabric:{type:Cesium.Material.WallDiffuseMaterialType,uniforms:{color:new Cesium.Color(1,0,0,1)},source:Cesium.Material.WallDiffuseMaterialSource},translucent:function(e){return!0}}),function(t){let n=t.viewer,r=t.center,i=t.radius||1e3,a=t.edge||64,s=t.speed||5,o=t.height||100,l=o,u=t.minRadius||10,c=u;if(a<3)return!1;let d=n.entities.add({wall:{positions:new Cesium.CallbackProperty((()=>{let e=[];return c+=i*s/1e3,l-=o*s/1e3,(c>i||l<0)&&(c=u,l=o),e=function(e,t,n,r){let i=[],a=Cesium.Transforms.eastNorthUpToFixedFrame(Cesium.Cartesian3.fromDegrees(e[0],e[1],0));for(let s=0;s<t;s++){let e=s/t*Cesium.Math.TWO_PI,o=Math.cos(e),l=Math.sin(e),u=new Cesium.Cartesian3(o*n,l*n,r);i.push(Cesium.Matrix4.multiplyByPoint(a,u,new Cesium.Cartesian3))}return i.push(i[0]),i}(r,a,c,l),e}),!1),material:new e({color:new Cesium.Color(1,1,0,1)})}});n.zoomTo(d)}({viewer:this.viewer,center:[117.061644,30.526779],radius:1e3,edge:5,height:200,speed:15,minRadius:50})}addThreeDimensionalWall(){class e{constructor(e){this._definitionChanged=new Cesium.Event,this._color=void 0,this.color=e.color}get isConstant(){return!1}get definitionChanged(){return this._definitionChanged}getType(e){return Cesium.Material.WallDiffuseMaterialType}getValue(e,t){return Cesium.defined(t)||(t={}),t.color=Cesium.Property.getValueOrDefault(this._color,e,Cesium.Color.RED,t.color),t}equals(t){return this===t||t instanceof e&&Cesium.Property.equals(this._color,t._color)}}Object.defineProperties(e.prototype,{color:Cesium.createPropertyDescriptor("color")}),Cesium.Material.WallDiffuseMaterialProperty="WallDiffuseMaterialProperty",Cesium.Material.WallDiffuseMaterialType="WallDiffuseMaterialType",Cesium.Material.WallDiffuseMaterialSource="\n    uniform vec4 color;\n    czm_material czm_getMaterial(czm_materialInput materialInput){\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    vec2 st = materialInput.st;\n    material.diffuse = color.rgb * 2.0;\n    material.alpha = color.a * (1.0 - fract(st.t)) * 0.8;\n    return material;\n    }\n\n    ",Cesium.Material._materialCache.addMaterial(Cesium.Material.WallDiffuseMaterialType,{fabric:{type:Cesium.Material.WallDiffuseMaterialType,uniforms:{color:new Cesium.Color(1,0,0,1)},source:Cesium.Material.WallDiffuseMaterialSource},translucent:function(e){return!0}});let t=this.viewer.entities.add({name:"立体墙效果",wall:{positions:Cesium.Cartesian3.fromDegreesArray(Uee.features[0].geometry.coordinates[0][0].flat()),maximumHeights:new Array(Uee.features[0].geometry.coordinates[0][0].length).fill(3e3),minimunHeights:new Array(Uee.features[0].geometry.coordinates[0][0].length).fill(50),material:new e({color:new Cesium.Color(1,1,0,1)})}});this.viewer.zoomTo(t)}addrotateMaterial(){let e=this.viewer.entities.add({position:Cesium.Cartesian3.fromDegrees(117.061644,30.526779),id:"circleRotateTest",ellipse:{semiMinorAxis:1e3,semiMajorAxis:1e3,material:new Cesium.ImageMaterialProperty({image:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/taiji.png"})}});var t,n,r;this.viewer.zoomTo(e),t=e.ellipse,n=0,r=1,t.stRotation=new Cesium.CallbackProperty((function(){return((n+=r)>=360||n<=-360)&&(n=0),Cesium.Math.toRadians(n)}),!1)}addCircleScan(){class e{constructor(e){this._definitionChanged=new Cesium.Event,this._color=void 0,this._speed=void 0,this.color=e.color,this.speed=e.speed}get isConstant(){return!1}get definitionChanged(){return this._definitionChanged}getType(e){return Cesium.Material.CircleScanMaterialType}getValue(e,t){return Cesium.defined(t)||(t={}),t.color=Cesium.Property.getValueOrDefault(this._color,e,Cesium.Color.RED,t.color),t.speed=Cesium.Property.getValueOrDefault(this._speed,e,10,t.speed),t}equals(t){return this===t||t instanceof e&&Cesium.Property.equals(this._color,t._color)&&Cesium.Property.equals(this._speed,t._speed)}}Object.defineProperties(e.prototype,{color:Cesium.createPropertyDescriptor("color"),speed:Cesium.createPropertyDescriptor("speed")}),Cesium.Material.CircleScanMaterialProperty="CircleScanMaterialProperty",Cesium.Material.CircleScanMaterialType="CircleScanMaterialType",Cesium.Material.CircleScanMaterialSource="\n      uniform vec4 color;\n      uniform float speed;\n\n      float circle(vec2 uv, float r, float blur) {\n      float d = length(uv) * 2.0;\n      float c = smoothstep(r+blur, r, d);\n      return c;\n      }\n\n      czm_material czm_getMaterial(czm_materialInput materialInput)\n      {\n      czm_material material = czm_getDefaultMaterial(materialInput);\n      vec2 st = materialInput.st - .5;\n      material.diffuse = color.rgb;\n      material.emission = vec3(0);\n      float t =fract(czm_frameNumber * speed / 1000.0);\n      float s = 0.3;\n      float radius1 = smoothstep(.0, s, t) * 0.5;\n      float alpha1 = circle(st, radius1, 0.01) * circle(st, radius1, -0.01);\n      float alpha2 = circle(st, radius1, 0.01 - radius1) * circle(st, radius1, 0.01);\n      float radius2 = 0.5 + smoothstep(s, 1.0, t) * 0.5;\n      float alpha3 = circle(st, radius1, radius2 + 0.01 - radius1) * circle(st, radius1, -0.01);\n      material.alpha = smoothstep(1.0, s, t) * (alpha1 + alpha2*0.1 + alpha3*0.1);\n      material.alpha *= color.a;\n      return material;\n      }\n\n      ",Cesium.Material._materialCache.addMaterial(Cesium.Material.CircleScanMaterialType,{fabric:{type:Cesium.Material.CircleScanMaterialType,uniforms:{color:new Cesium.Color(1,0,0,1),speed:10},source:Cesium.Material.CircleScanMaterialSource},translucent:function(e){return!0}});let t=this.viewer.entities.add({position:Cesium.Cartesian3.fromDegrees(117.061644,30.526779),name:"扫描圆",ellipse:{semiMajorAxis:1e3,semiMinorAxis:1e3,material:new e({color:new Cesium.Color(1,1,0,.7),speed:20})}});this.viewer.zoomTo(t)}addCorrugatedCircle(){class e{constructor(e){this._definitionChanged=new Cesium.Event,this._color=void 0,this._speed=void 0,this.color=e.color,this.speed=e.speed,this.count=e.count,this.gradient=e.gradient}get isConstant(){return!1}get definitionChanged(){return this._definitionChanged}getType(e){return Cesium.Material.CircleRippleMaterialType}getValue(e,t){return Cesium.defined(t)||(t={}),t.color=Cesium.Property.getValueOrDefault(this._color,e,Cesium.Color.RED,t.color),t.speed=Cesium.Property.getValueOrDefault(this._speed,e,10,t.speed),t.count=this.count,t.gradient=this.gradient,t}equals(t){return this===t||t instanceof e&&Cesium.Property.equals(this._color,t._color)&&Cesium.Property.equals(this._speed,t._speed)&&Cesium.Property.equals(this.count,t.count)&&Cesium.Property.equals(this.gradient,t.gradient)}}Object.defineProperties(e.prototype,{color:Cesium.createPropertyDescriptor("color"),speed:Cesium.createPropertyDescriptor("speed"),count:Cesium.createPropertyDescriptor("count"),gradient:Cesium.createPropertyDescriptor("gradient")}),Cesium.Material.CircleRippleMaterialProperty="CircleRippleMaterialProperty",Cesium.Material.CircleRippleMaterialType="CircleRippleMaterialType",Cesium.Material.CircleRippleMaterialSource="\n                                              uniform vec4 color;\n                                              uniform float speed;\n                                              uniform float count;\n                                              uniform float gradient;\n\n                                              czm_material czm_getMaterial(czm_materialInput materialInput)\n                                              {\n                                              czm_material material = czm_getDefaultMaterial(materialInput);\n                                              material.diffuse = 1.5 * color.rgb;\n                                              vec2 st = materialInput.st;\n                                              float dis = distance(st, vec2(0.5, 0.5));\n                                              float per = fract(czm_frameNumber * speed / 1000.0);\n                                              if(count == 1.0){\n                                                  if(dis > per * 0.5){\n                                                  discard;\n                                                  }else {\n                                                  material.alpha = color.a  * dis / per / 2.0;\n                                                  }\n                                              } else {\n                                                  vec3 str = materialInput.str;\n                                                  if(abs(str.z)  > 0.001){\n                                                  discard;\n                                                  }\n                                                  if(dis > 0.5){\n                                                  discard;\n                                                  } else {\n                                                  float perDis = 0.5 / count;\n                                                  float disNum;\n                                                  float bl = 0.0;\n                                                  for(int i = 0; i <= 999; i++){\n                                                      if(float(i) <= count){\n                                                      disNum = perDis * float(i) - dis + per / count;\n                                                      if(disNum > 0.0){\n                                                          if(disNum < perDis){\n                                                          bl = 1.0 - disNum / perDis;\n                                                          }\n                                                          else if(disNum - perDis < perDis){\n                                                          bl = 1.0 - abs(1.0 - disNum / perDis);\n                                                          }\n                                                          material.alpha = pow(bl,(1.0 + 10.0 * (1.0 - gradient)));\n                                                      }\n                                                      }\n                                                  }\n                                                  }\n                                              }\n                                              return material;\n                                              }\n                                              ",Cesium.Material._materialCache.addMaterial("CircleRippleMaterialType",{fabric:{type:"CircleRippleMaterialType",uniforms:{color:new Cesium.Color(1,0,0,1),speed:3,count:4,gradient:.2},source:Cesium.Material.CircleRippleMaterialSource},translucent:function(e){return!0}});let t=this.viewer.entities.add({position:Cesium.Cartesian3.fromDegrees(113.9236839,22.528061),name:"波纹圆",ellipse:{semiMinorAxis:1e3,semiMajorAxis:1e3,material:new e({color:new Cesium.Color(1,1,0,.7),speed:12,count:4,gradient:.2})}});this.viewer.zoomTo(t)}addCircleDiffuse(){class e{constructor(e){this._definitionChanged=new Cesium.Event,this._color=void 0,this._speed=void 0,this.color=e.color,this.speed=e.speed}get isConstant(){return!1}get definitionChanged(){return this._definitionChanged}getType(e){return Cesium.Material.CircleDiffuseMaterialType}getValue(e,t){return Cesium.defined(t)||(t={}),t.color=Cesium.Property.getValueOrDefault(this._color,e,Cesium.Color.RED,t.color),t.speed=Cesium.Property.getValueOrDefault(this._speed,e,10,t.speed),t}equals(t){return this===t||t instanceof e&&Cesium.Property.equals(this._color,t._color)&&Cesium.Property.equals(this._speed,t._speed)}}Object.defineProperties(e.prototype,{color:Cesium.createPropertyDescriptor("color"),speed:Cesium.createPropertyDescriptor("speed")}),Cesium.Material.CircleDiffuseMaterialProperty="CircleDiffuseMaterialProperty",Cesium.Material.CircleDiffuseMaterialType="CircleDiffuseMaterialType",Cesium.Material.CircleDiffuseMaterialSource="\n                                              uniform vec4 color;\n                                              uniform float speed;\n\n                                              vec3 circlePing(float r, float innerTail,  float frontierBorder, float timeResetSeconds,  float radarPingSpeed,  float fadeDistance){\n                                              float t = fract(czm_frameNumber * speed / 1000.0);\n                                              float time = mod(t, timeResetSeconds) * radarPingSpeed;\n                                              float circle;\n                                              circle += smoothstep(time - innerTail, time, r) * smoothstep(time + frontierBorder,time, r);\n                                              circle *= smoothstep(fadeDistance, 0.0, r);\n                                              return vec3(circle);\n                                              }\n\n                                              czm_material czm_getMaterial(czm_materialInput materialInput){\n                                              czm_material material = czm_getDefaultMaterial(materialInput);\n                                              vec2 st = materialInput.st * 2.0  - 1.0 ;\n                                              vec2 center = vec2(0.);\n                                              float time = fract(czm_frameNumber * speed / 1000.0);\n                                              vec3 flagColor;\n                                              float r = length(st - center) / 4.;\n                                              flagColor += circlePing(r, 0.25, 0.025, 4.0, 0.3, 1.0) * color.rgb;\n                                              material.alpha = length(flagColor);\n                                              material.diffuse = flagColor.rgb;\n                                              return material;\n                                              }\n\n                                              ",Cesium.Material._materialCache.addMaterial("CircleDiffuseMaterialType",{fabric:{type:"CircleDiffuseMaterialType",uniforms:{color:new Cesium.Color(1,0,0,1),speed:10},source:Cesium.Material.CircleDiffuseMaterialSource},translucent:function(e){return!0}});let t=this.viewer.entities.add({position:Cesium.Cartesian3.fromDegrees(113.9236839,22.528061),name:"扩散圆",ellipse:{semiMinorAxis:1e3,semiMajorAxis:1e3,material:new e({color:new Cesium.Color(1,1,0,.7),speed:12})}});this.viewer.zoomTo(t)}addShadowCircle(){class e{constructor(e){this._definitionChanged=new Cesium.Event,this._color=void 0,this._speed=void 0,this.color=e.color,this.speed=e.speed}get isConstant(){return!1}get definitionChanged(){return this._definitionChanged}getType(e){return Cesium.Material.CircleFadeMaterialType}getValue(e,t){return Cesium.defined(t)||(t={}),t.color=Cesium.Property.getValueOrDefault(this._color,e,Cesium.Color.RED,t.color),t.speed=Cesium.Property.getValueOrDefault(this._speed,e,10,t.speed),t}equals(t){return this===t||t instanceof e&&Cesium.Property.equals(this._color,t._color)&&Cesium.Property.equals(this._speed,t._speed)}}Object.defineProperties(e.prototype,{color:Cesium.createPropertyDescriptor("color"),speed:Cesium.createPropertyDescriptor("speed")}),Cesium.Material.CircleFadeMaterialProperty="CircleFadeMaterialProperty",Cesium.Material.CircleFadeMaterialType="CircleFadeMaterialType",Cesium.Material.CircleFadeMaterialSource="\n                                              uniform vec4 color;\n                                              uniform float speed;\n\n                                              czm_material czm_getMaterial(czm_materialInput materialInput){\n                                              czm_material material = czm_getDefaultMaterial(materialInput);\n                                              material.diffuse = 1.5 * color.rgb;\n                                              vec2 st = materialInput.st;\n                                              float dis = distance(st, vec2(0.5, 0.5));\n                                              float per = fract(czm_frameNumber * speed / 1000.0);\n                                              if(dis > per * 0.5){\n                                                  material.alpha = color.a;\n                                              }else {\n                                                  discard;\n                                              }\n                                              return material;\n                                              }\n                                              ",Cesium.Material._materialCache.addMaterial("CircleFadeMaterialType",{fabric:{type:"CircleFadeMaterialType",uniforms:{color:new Cesium.Color(1,0,0,1),speed:10},source:Cesium.Material.CircleFadeMaterialSource},translucent:function(e){return!0}});let t=this.viewer.entities.add({position:Cesium.Cartesian3.fromDegrees(113.9236839,22.528061),name:"消隐圆",ellipse:{semiMinorAxis:1e3,semiMajorAxis:1e3,material:new e({color:new Cesium.Color(1,1,0,.7),speed:12})}});this.viewer.zoomTo(t)}addCircleBlur(){class e{constructor(e){this._definitionChanged=new Cesium.Event,this._color=void 0,this._speed=void 0,this.color=e.color,this.speed=e.speed}get isConstant(){return!1}get definitionChanged(){return this._definitionChanged}getType(e){return Cesium.Material.CircleBlurMaterialType}getValue(e,t){return Cesium.defined(t)||(t={}),t.color=Cesium.Property.getValueOrDefault(this._color,e,Cesium.Color.RED,t.color),t.speed=Cesium.Property.getValueOrDefault(this._speed,e,10,t.speed),t}equals(t){return this===t||t instanceof e&&Cesium.Property.equals(this._color,t._color)&&Cesium.Property.equals(this._speed,t._speed)}}Object.defineProperties(e.prototype,{color:Cesium.createPropertyDescriptor("color"),speed:Cesium.createPropertyDescriptor("speed")}),Cesium.Material.CircleBlurMaterialProperty="CircleBlurMaterialProperty",Cesium.Material.CircleBlurMaterialType="CircleBlurMaterialType",Cesium.Material.CircleBlurMaterialSource="\n                                              uniform vec4 color;\n                                              uniform float speed;\n                                              czm_material czm_getMaterial(czm_materialInput materialInput){\n                                              czm_material material = czm_getDefaultMaterial(materialInput);\n                                              vec2 st = materialInput.st ;\n                                              vec2 center = vec2(0.5);\n                                              float time = fract(czm_frameNumber * speed / 1000.0);\n                                              float r = 0.5 + sin(time) / 3.0;\n                                              float dis = distance(st, center);\n                                              float a = 0.0;\n                                              if(dis < r) {\n                                                  a = 1.0 - smoothstep(0.0, r, dis);\n                                              }\n                                              material.alpha = pow(a,10.0) ;\n                                              material.diffuse = color.rgb * a * 3.0;\n                                              return material;\n                                              }\n                                              ",Cesium.Material._materialCache.addMaterial("CircleBlurMaterialType",{fabric:{type:"CircleBlurMaterialType",uniforms:{color:new Cesium.Color(1,0,0,1),speed:10},source:Cesium.Material.CircleBlurMaterialSource},translucent:function(e){return!0}});let t=this.viewer.entities.add({position:Cesium.Cartesian3.fromDegrees(113.9236839,22.528061),name:"模糊圆",ellipse:{semiMinorAxis:1e3,semiMajorAxis:1e3,material:new e({color:new Cesium.Color(1,1,0,.7),speed:12})}});this.viewer.zoomTo(t)}addCircleSpiral(){class e{constructor(e){this._definitionChanged=new Cesium.Event,this._color=void 0,this._speed=void 0,this.color=e.color,this.speed=e.speed}get isConstant(){return!1}get definitionChanged(){return this._definitionChanged}getType(e){return Cesium.Material.CircleSpiralMaterialType}getValue(e,t){return Cesium.defined(t)||(t={}),t.color=Cesium.Property.getValueOrDefault(this._color,e,Cesium.Color.RED,t.color),t.speed=Cesium.Property.getValueOrDefault(this._speed,e,10,t.speed),t}equals(t){return this===t||t instanceof e&&Cesium.Property.equals(this._color,t._color)&&Cesium.Property.equals(this._speed,t._speed)}}Object.defineProperties(e.prototype,{color:Cesium.createPropertyDescriptor("color"),speed:Cesium.createPropertyDescriptor("speed")}),Cesium.Material.CircleSpiralMaterialProperty="CircleSpiralMaterialProperty",Cesium.Material.CircleSpiralMaterialType="CircleSpiralMaterialType",Cesium.Material.CircleSpiralMaterialSource="\n                                              uniform vec4 color;\n                                              uniform float speed;\n                                              #define PI 3.14159265359\n\n                                              vec2 rotate2D (vec2 _st, float _angle) {\n                                              _st =  mat2(cos(_angle),-sin(_angle),  sin(_angle),cos(_angle)) * _st;\n                                              return _st;\n                                              }\n                                              czm_material czm_getMaterial(czm_materialInput materialInput){\n                                              czm_material material = czm_getDefaultMaterial(materialInput);\n                                              vec2 st = materialInput.st * 2.0 - 1.0;\n                                              st *= 1.6;\n                                              float time = czm_frameNumber * speed / 1000.0;\n                                              float r = length(st);\n                                              float w = .3;\n                                              st = rotate2D(st,(r*PI*6.-time*2.));\n                                              float a = smoothstep(-w,.2,st.x) * smoothstep(w,.2,st.x);\n                                              float b = abs(1./(sin(pow(r,2.)*2.-time*1.3)*6.))*.4;\n                                              material.alpha = a * b ;\n                                              material.diffuse = color.rgb * a * b  * 3.0;\n                                              return material;\n                                              }\n                                              ",Cesium.Material._materialCache.addMaterial("CircleSpiralMaterialType",{fabric:{type:"CircleSpiralMaterialType",uniforms:{color:new Cesium.Color(1,0,0,1),speed:10},source:Cesium.Material.CircleSpiralMaterialSource},translucent:function(e){return!0}});let t=this.viewer.entities.add({position:Cesium.Cartesian3.fromDegrees(113.9236839,22.528061),name:"螺旋圆",ellipse:{semiMinorAxis:1e3,semiMajorAxis:1e3,material:new e({color:new Cesium.Color(1,1,0,.7),speed:12})}});this.viewer.zoomTo(t)}addCircleColorful(){class e{constructor(e){this._definitionChanged=new Cesium.Event,this._color=void 0,this._speed=void 0,this.color=e.color,this.speed=e.speed}get isConstant(){return!1}get definitionChanged(){return this._definitionChanged}getType(e){return Cesium.Material.CircleColorfulMaterialType}getValue(e,t){return Cesium.defined(t)||(t={}),t.color=Cesium.Property.getValueOrDefault(this._color,e,Cesium.Color.RED,t.color),t.speed=Cesium.Property.getValueOrDefault(this._speed,e,10,t.speed),t}equals(t){return this===t||t instanceof e&&Cesium.Property.equals(this._color,t._color)&&Cesium.Property.equals(this._speed,t._speed)}}Object.defineProperties(e.prototype,{color:Cesium.createPropertyDescriptor("color"),speed:Cesium.createPropertyDescriptor("speed")}),Cesium.Material.CircleColorfulMaterialProperty="CircleColorfulMaterialProperty",Cesium.Material.CircleColorfulMaterialType="CircleColorfulMaterialType",Cesium.Material.CircleColorfulMaterialSource="\n                                                  uniform vec4 color;\n                                                  uniform float speed;\n\n                                                  czm_material czm_getMaterial(czm_materialInput materialInput){\n                                                  czm_material material = czm_getDefaultMaterial(materialInput);\n                                                  vec2 st = materialInput.st  * 2.0 - 1.0;\n                                                  float time =czm_frameNumber * speed / 1000.0;\n                                                  float radius = length(st);\n                                                  float angle = atan(st.y/st.x);\n                                                  float radius1 = sin(time * 2.0) + sin(40.0*angle+time)*0.01;\n                                                  float radius2 = cos(time * 3.0);\n                                                  vec3 fragColor = 0.2 + 0.5 * cos( time + color.rgb + vec3(0,2,4));\n                                                  float inten1 = 1.0 - sqrt(abs(radius1 - radius));\n                                                  float inten2 = 1.0 - sqrt(abs(radius2 - radius));\n                                                  material.alpha = pow(inten1 + inten2 , 5.0) ;\n                                                  material.diffuse = fragColor * (inten1 + inten2);\n                                                  return material;\n                                                  }",Cesium.Material._materialCache.addMaterial("CircleColorfulMaterialType",{fabric:{type:"CircleColorfulMaterialType",uniforms:{color:new Cesium.Color(1,0,0,1),speed:10},source:Cesium.Material.CircleColorfulMaterialSource},translucent:function(e){return!0}});let t=this.viewer.entities.add({position:Cesium.Cartesian3.fromDegrees(113.9236839,22.528061),name:"多彩圆",ellipse:{semiMinorAxis:1e3,semiMajorAxis:1e3,material:new e({color:new Cesium.Color(1,1,0,.7),speed:12})}});this.viewer.zoomTo(t)}addCircleWave(){function e(e){this._definitionChanged=new Cesium.Event,this._color=void 0,this._colorSubscription=void 0,this.color=e.color,this.duration=Cesium.defaultValue(e.duration,1e3),this.count=Cesium.defaultValue(e.count,2),this.count<=0&&(this.count=1),this.gradient=Cesium.defaultValue(e.gradient,.1),0===this.gradient&&(this.gradient=0),this.gradient>1&&(this.gradient=1),this._time=(new Date).getTime()}Object.defineProperties(e.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:Cesium.createPropertyDescriptor("color"),duration:Cesium.createPropertyDescriptor("duration"),count:Cesium.createPropertyDescriptor("count")}),e.prototype.getType=function(e){return Cesium.Material.CircleWaveMaterialType},e.prototype.getValue=function(e,t){return Cesium.defined(t)||(t={}),t.color=Cesium.Property.getValueOrClonedDefault(this._color,e,Cesium.Color.WHITE,t.color),t.time=((new Date).getTime()-this._time)%this.duration/this.duration,t.count=this.count,t.gradient=1+10*(1-this.gradient),t},e.prototype.equals=function(t){return this===t||t instanceof e&&Cesium.Property.equals(this._color,t._color)},Cesium.Material.CircleWaveMaterialType="CircleWaveMaterial",Cesium.Material.CircleWaveSource="\n                                      czm_material czm_getMaterial(czm_materialInput materialInput) {\n                                        czm_material material = czm_getDefaultMaterial(materialInput);\n                                        material.diffuse = 1.5 * color.rgb;\n                                        vec2 st = materialInput.st;\n                                        vec3 str = materialInput.str;\n                                        float dis = distance(st, vec2(0.5, 0.5));\n                                        float per = fract(time);\n                                        if (abs(str.z) > 0.001) {\n                                          discard;\n                                        }\n                                        if (dis > 0.5) {\n                                          discard;\n                                        } else {\n                                          float perDis = 0.5 / count;\n                                          float disNum;\n                                          float bl = .0;\n                                          for (int i = 0; i <= 9; i++) {\n                                            if (float(i) <= count) {\n                                              disNum = perDis *float(i) - dis + per / count;\n                                              if (disNum > 0.0) {\n                                                if (disNum < perDis) {\n                                                  bl = 1.0 - disNum / perDis;\n                                                } else if(disNum - perDis < perDis) {\n                                                  bl = 1.0 - abs(1.0 - disNum / perDis);\n                                                }\n                                                material.alpha = pow(bl, gradient);\n                                              }\n                                            }\n                                          }\n                                        }\n                                        return material;\n                                      }\n                                      ",Cesium.Material._materialCache.addMaterial("CircleWaveMaterial",{fabric:{type:"CircleWaveMaterial",uniforms:{color:new Cesium.Color(1,0,0,1),time:1,count:1,gradient:.1},source:Cesium.Material.CircleWaveSource},translucent:function(e){return!0}});let n=new class extends dte{constructor(e,n){super(e,n),t(this,"count")}change_duration(e){super.change_duration(e);this.viewer.entities.getById(this.id)._ellipse._material.duration=e}change_waveCount(e){this.viewer.entities.getById(this.id)._ellipse._material.count=e}add(t,n,r,i,a=!1,s=3){super.add(t,n,r,i,a);const o=this;this.count=s,this.viewer.zoomTo(this.viewer.entities.add({id:o.id,position:Cesium.Cartesian3.fromDegrees(t[0],t[1],t[2]),ellipse:{semiMinorAxis:new Cesium.CallbackProperty((function(e){return o.maxRadius}),!1),semiMajorAxis:new Cesium.CallbackProperty((function(e){return o.maxRadius}),!1),material:new e({duration:i,gradient:0,color:new Cesium.Color.fromCssColorString(n),count:s})}}))}}(this.viewer,"cirCleWave1");n.add([113.94,22.512,0],"#1FA8E3",500,3e3)}addCircleDiffusion(){new class{constructor(e){t(this,"viewer"),t(this,"lastStageList"),this.viewer=e,this.lastStageList=[]}add(e,t,n,r){this.lastStageList.push(this.showCircleScan(e,t,n,r))}clear(){this.lastStageList.forEach((e=>{this.clearScanEffects(e)})),this.lastStageList=[]}showCircleScan(e,t,n,r){const i=new Cesium.Cartographic(Cesium.Math.toRadians(e[0]),Cesium.Math.toRadians(e[1]),e[2]);t=new Cesium.Color.fromCssColorString(t);return this._addCircleScanPostStage(i,n,t,r)}_addCircleScanPostStage(e,t,n,r){const i=Cesium.Cartographic.toCartesian(e),a=new Cesium.Cartesian4(i.x,i.y,i.z,1),s=new Cesium.Cartographic(e.longitude,e.latitude,e.height+500),o=Cesium.Cartographic.toCartesian(s),l=new Cesium.Cartesian4(o.x,o.y,o.z,1),u=(new Date).getTime(),c=new Cesium.Cartesian4,d=new Cesium.Cartesian4,h=new Cesium.Cartesian3,p=this,f=new Cesium.PostProcessStage({fragmentShader:p._getScanSegmentShader(),uniforms:{u_scanCenterEC:function(){return Cesium.Matrix4.multiplyByVector(p.viewer.camera._viewMatrix,a,c)},u_scanPlaneNormalEC:function(){const e=Cesium.Matrix4.multiplyByVector(p.viewer.camera._viewMatrix,a,c),t=Cesium.Matrix4.multiplyByVector(p.viewer.camera._viewMatrix,l,d);return h.x=t.x-e.x,h.y=t.y-e.y,h.z=t.z-e.z,Cesium.Cartesian3.normalize(h,h),h},u_radius:function(){return t*(((new Date).getTime()-u)%r)/r},u_scanColor:n}});return this.viewer.scene.postProcessStages.add(f),f}_getScanSegmentShader(){return" uniform sampler2D colorTexture;\n            uniform sampler2D depthTexture;\n            in vec2 v_textureCoordinates;\n            out vec4 vFragColor;\n            uniform vec4 u_scanCenterEC;\n            uniform vec3 u_scanPlaneNormalEC;\n            uniform float u_radius;\n            uniform vec4 u_scanColor;\n            vec4 toEye(in vec2 uv, in float depth){\n              vec2 xy = vec2((uv.x * 2.0 - 1.0),(uv.y * 2.0 - 1.0));\n              vec4 posInCamera = czm_inverseProjection * vec4(xy, depth, 1.0);\n              posInCamera =posInCamera / posInCamera.w;\n              return posInCamera;\n            }\n            vec3 pointProjectOnPlane(in vec3 planeNormal, in vec3 planeOrigin, in vec3 point){\n                vec3 v01 = point - planeOrigin;\n                float d = dot(planeNormal, v01) ;\n                return (point - planeNormal * d);\n            }\n            float getDepth(in vec4 depth){\n                float z_window = czm_unpackDepth(depth);\n                z_window = czm_reverseLogDepth(z_window);\n                float n_range = czm_depthRange.near;\n                float f_range = czm_depthRange.far;\n                return (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n            }\n            void main(){\n              vFragColor = texture(colorTexture, v_textureCoordinates);\n                float depth = getDepth(texture(depthTexture, v_textureCoordinates));\n                vec4 viewPos = toEye(v_textureCoordinates, depth);\n                vec3 prjOnPlane = pointProjectOnPlane(u_scanPlaneNormalEC.xyz, u_scanCenterEC.xyz, viewPos.xyz);\n                float dis = length(prjOnPlane.xyz - u_scanCenterEC.xyz);\n                if(dis < u_radius){\n                  float f = 1.0 - abs(u_radius - dis) / u_radius;\n                  f = pow(f, float(18));\n                  vFragColor = mix(vFragColor,u_scanColor,f);\n                }\n                vFragColor.a = vFragColor.a / 2.0;\n            }\n          "}clearScanEffects(e){this.viewer.scene.postProcessStages.remove(e)}}(this.viewer).add([113.944,22.523,2e4],"#F7EB08",8e3,95e3)}addscanline(){function e(e,t){this._definitionChanged=new Cesium.Event,this.color=e||Cesium.Color.YELLOW,this.speed=t||10}Object.defineProperties(e.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:Cesium.createPropertyDescriptor("color"),speed:Cesium.createPropertyDescriptor("speed")}),e.prototype.getType=function(e){return Cesium.Material.ScanlineType},e.prototype.getValue=function(e,t){return Cesium.defined(t)||(t={}),t.color=Cesium.Property.getValueOrClonedDefault(this._color,e,Cesium.Color.WHITE,t.color),t.speed=this.speed,t},e.prototype.equals=function(t){return this===t||t instanceof e&&Cesium.Property.equals(this.color,t.color)&&Cesium.Property.equals(this.speed,t.speed)},Cesium.Material.ScanlineType="Scanline",Cesium.Material.ScanlineSource="\n    uniform vec4 color;\n    uniform float speed;\n    float circle(vec2 uv, float r, float blur) {\n      float d = length(uv) * 1.0; /* 2.0 */\n      float c = smoothstep(r+blur, r, d);\n      return c;\n    }\n    czm_material czm_getMaterial(czm_materialInput materialInput)\n    {\n      czm_material material = czm_getDefaultMaterial(materialInput);\n      vec2 st = materialInput.st - 0.5;\n      material.diffuse = 2.8 * color.rgb;\n      material.emission = vec3(0);\n      float t = fract(czm_frameNumber * (11000.0 - speed) / 500000.0);\n      float s = 0.3;\n      float radius1 = smoothstep(.0, s, t) * 0.5;\n      float alpha1 = circle(st, radius1, 0.01) * circle(st, radius1, -0.01);\n      float alpha2 = circle(st, radius1, 0.01 - radius1) * circle(st, radius1, 0.01);\n      float radius2 = 0.5 + smoothstep(s, 1.0, t) * 0.5;\n      float alpha3 = circle(st, radius1, radius2 + 0.01 - radius1) * circle(st, radius1, -0.01);\n      material.alpha = smoothstep(1.0, s, t) * (alpha1 + alpha2*0.1 + alpha3*0.1);\n      material.alpha *= color.a ;\n      return material;\n    }\n    ",Cesium.Material._materialCache.addMaterial("Scanline",{fabric:{type:"Scanline",uniforms:{color:new Cesium.Color(1,0,0,.5),time:0,speed:10},source:Cesium.Material.ScanlineSource},translucent:function(e){return!0}}),new class extends dte{constructor(e,t){super(e,t)}change_duration(e){super.change_duration(e);this.viewer.entities.getById(this.id)._ellipse._material.speed=e}add(t,n,r,i,a=!1){super.add(t,n,r,i,a);const s=this;s.viewer.zoomTo(s.viewer.entities.add({id:s.id,position:Cesium.Cartesian3.fromDegrees(t[0],t[1],t[2]),ellipse:{semiMinorAxis:new Cesium.CallbackProperty((function(e){return s.maxRadius}),!1),semiMajorAxis:new Cesium.CallbackProperty((function(e){return s.maxRadius}),!1),material:new e(new Cesium.Color.fromCssColorString(n),i),classificationType:Cesium.ClassificationType.BOTH}}))}}(this.viewer,"scanLine1").add([113.923,22.536,0],"#CE1374",1200,15)}addCircleRadarScan(){new class{constructor(e){t(this,"viewer"),t(this,"lastStageList"),this.viewer=e,this.lastStageList=[]}add(e,t,n,r){this.lastStageList.push(this.showRadarScan(e,t,n,r))}clear(){this.lastStageList.forEach((e=>{this.clearScanEffects(e)})),this.lastStageList=[]}showRadarScan(e,t,n,r){const i=new Cesium.Cartographic(Cesium.Math.toRadians(e[0]),Cesium.Math.toRadians(e[1]),e[2]);t=new Cesium.Color.fromCssColorString(t);return this._addRadarScanPostStage(i,n,t,r)}_addRadarScanPostStage(e,t,n,r){const i=Cesium.Cartographic.toCartesian(e),a=new Cesium.Cartesian4(i.x,i.y,i.z,1),s=new Cesium.Cartographic(e.longitude,e.latitude,e.height+500),o=Cesium.Cartographic.toCartesian(s),l=new Cesium.Cartesian4(o.x,o.y,o.z,1),u=new Cesium.Cartographic(e.longitude+Cesium.Math.toRadians(.001),e.latitude,e.height),c=Cesium.Cartographic.toCartesian(u),d=new Cesium.Cartesian4(c.x,c.y,c.z,1),h=new Cesium.Quaternion,p=new Cesium.Matrix3,f=(new Date).getTime(),m=new Cesium.Cartesian4,g=new Cesium.Cartesian4,v=new Cesium.Cartesian4,y=new Cesium.Cartesian3,_=new Cesium.Cartesian3,b=this,x=new Cesium.PostProcessStage({fragmentShader:this._getRadarScanShader(),uniforms:{u_scanCenterEC:function(){return Cesium.Matrix4.multiplyByVector(b.viewer.camera._viewMatrix,a,m)},u_scanPlaneNormalEC:function(){const e=Cesium.Matrix4.multiplyByVector(b.viewer.camera._viewMatrix,a,m),t=Cesium.Matrix4.multiplyByVector(b.viewer.camera._viewMatrix,l,g);return y.x=t.x-e.x,y.y=t.y-e.y,y.z=t.z-e.z,Cesium.Cartesian3.normalize(y,y),y},u_radius:t,u_scanLineNormalEC:function(){const e=Cesium.Matrix4.multiplyByVector(b.viewer.camera._viewMatrix,a,m),t=Cesium.Matrix4.multiplyByVector(b.viewer.camera._viewMatrix,l,g),n=Cesium.Matrix4.multiplyByVector(b.viewer.camera._viewMatrix,d,v);y.x=t.x-e.x,y.y=t.y-e.y,y.z=t.z-e.z,Cesium.Cartesian3.normalize(y,y),_.x=n.x-e.x,_.y=n.y-e.y,_.z=n.z-e.z;const i=((new Date).getTime()-f)%r/r;return Cesium.Quaternion.fromAxisAngle(y,i*Cesium.Math.PI*2,h),Cesium.Matrix3.fromQuaternion(h,p),Cesium.Matrix3.multiplyByVector(p,_,_),Cesium.Cartesian3.normalize(_,_),_},u_scanColor:n}});return this.viewer.scene.postProcessStages.add(x),x}_getRadarScanShader(){return"uniform sampler2D colorTexture;\nuniform sampler2D depthTexture;\nin vec2 v_textureCoordinates;\nout vec4 vFragColor;\nuniform vec4 u_scanCenterEC;\nuniform vec3 u_scanPlaneNormalEC;\nuniform vec3 u_scanLineNormalEC;\nuniform float u_radius;\nuniform vec4 u_scanColor;\nvec4 toEye(in vec2 uv, in float depth)\n {\n vec2 xy = vec2((uv.x * 2.0 - 1.0),(uv.y * 2.0 - 1.0));\n vec4 posInCamera =czm_inverseProjection * vec4(xy, depth, 1.0);\n posInCamera =posInCamera / posInCamera.w;\n return posInCamera;\n }\nbool isPointOnLineRight(in vec3 ptOnLine, in vec3 lineNormal, in vec3 testPt)\n{\nvec3 v01 = testPt - ptOnLine;\nnormalize(v01);\nvec3 temp = cross(v01, lineNormal);\nfloat d = dot(temp, u_scanPlaneNormalEC);\nreturn d > 0.5;\n}\nvec3 pointProjectOnPlane(in vec3 planeNormal, in vec3 planeOrigin, in vec3 point)\n{\nvec3 v01 = point -planeOrigin;\nfloat d = dot(planeNormal, v01) ;\nreturn (point - planeNormal * d);\n}\nfloat distancePointToLine(in vec3 ptOnLine, in vec3 lineNormal, in vec3 testPt)\n{\nvec3 tempPt = pointProjectOnPlane(lineNormal, ptOnLine, testPt);\nreturn length(tempPt - ptOnLine);\n}\nfloat getDepth(in vec4 depth)\n{\nfloat z_window = czm_unpackDepth(depth);\nz_window = czm_reverseLogDepth(z_window);\nfloat n_range = czm_depthRange.near;\nfloat f_range = czm_depthRange.far;\nreturn (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n}\nvoid main()\n{\nvFragColor = texture(colorTexture, v_textureCoordinates);\nfloat depth = getDepth( texture(depthTexture, v_textureCoordinates));\nvec4 viewPos = toEye(v_textureCoordinates, depth);\nvec3 prjOnPlane = pointProjectOnPlane(u_scanPlaneNormalEC.xyz, u_scanCenterEC.xyz, viewPos.xyz);\nfloat dis = length(prjOnPlane.xyz - u_scanCenterEC.xyz);\nfloat twou_radius = u_radius * 2.0;\nif(dis < u_radius)\n{\nfloat f0 = 1.0 -abs(u_radius - dis) / u_radius;\nf0 = pow(f0, 64.0);\nvec3 lineEndPt = vec3(u_scanCenterEC.xyz) + u_scanLineNormalEC * u_radius;\nfloat f = 0.0;\nif(isPointOnLineRight(u_scanCenterEC.xyz, u_scanLineNormalEC.xyz, prjOnPlane.xyz))\n{\nfloat dis1= length(prjOnPlane.xyz - lineEndPt);\nf = abs(twou_radius -dis1) / twou_radius;\nf = pow(f, 3.0);\n}\nvFragColor = mix(vFragColor, u_scanColor, f + f0);\n}\n}\n"}clearScanEffects(e){this.viewer.scene.postProcessStages.remove(e)}}(this.viewer).add([113.929,22.506,0],"#BB00FF",400,3e3)}addRadarLine(){class e{constructor(e){this._definitionChanged=new Cesium.Event,this._color=void 0,this._speed=void 0,this.color=e.color,this.speed=e.speed}get isConstant(){return!1}get definitionChanged(){return this._definitionChanged}getType(e){return Cesium.Material.RadarLineMaterialType}getValue(e,t){return Cesium.defined(t)||(t={}),t.color=Cesium.Property.getValueOrDefault(this._color,e,Cesium.Color.RED,t.color),t.speed=Cesium.Property.getValueOrDefault(this._speed,e,10,t.speed),t}equals(t){return this===t||t instanceof e&&Cesium.Property.equals(this._color,t._color)&&Cesium.Property.equals(this._speed,t._speed)}}Object.defineProperties(e.prototype,{color:Cesium.createPropertyDescriptor("color"),speed:Cesium.createPropertyDescriptor("speed")}),Cesium.Material.RadarLineMaterialProperty="RadarLineMaterialProperty",Cesium.Material.RadarLineMaterialType="RadarLineMaterialType",Cesium.Material.RadarLineMaterialSource="\n      uniform vec4 color;\n      uniform float speed;\n\n      czm_material czm_getMaterial(czm_materialInput materialInput){\n      czm_material material = czm_getDefaultMaterial(materialInput);\n      vec2 st = materialInput.st * 2.0 - 1.0;\n      float t = czm_frameNumber * speed / 1000.0 ;\n      vec3 col = vec3(0.0);\n      vec2 p = vec2(sin(t), cos(t));\n      float d = length(st - dot(p, st) * p);\n      if (dot(st, p) < 0.) {\n          d = length(st);\n      }\n\n      col = .006 / d * color.rgb;\n\n      if(distance(st,vec2(0)) >  0.99 ){\n          col =color.rgb;\n      }\n\n      material.alpha  = pow(length(col),2.0);\n      material.diffuse = col * 3.0 ;\n      return material;\n      }\n       ",Cesium.Material._materialCache.addMaterial("RadarLineMaterialType",{fabric:{type:"RadarLineMaterialType",uniforms:{color:new Cesium.Color(1,0,0,1),speed:10},source:Cesium.Material.RadarLineMaterialSource},translucent:function(e){return!0}}),this.viewer.zoomTo(this.viewer.entities.add({position:Cesium.Cartesian3.fromDegrees(113.9236839,22.528061),name:"雷达线",ellipse:{semiMajorAxis:1e3,semiMinorAxis:1e3,material:new e({color:new Cesium.Color(1,1,0,.7),speed:20})}}))}addRadarWave(){class e{constructor(e){this._definitionChanged=new Cesium.Event,this._color=void 0,this._speed=void 0,this.color=e.color,this.speed=e.speed}get isConstant(){return!1}get definitionChanged(){return this._definitionChanged}getType(e){return Cesium.Material.RadarWaveMaterialType}getValue(e,t){return Cesium.defined(t)||(t={}),t.color=Cesium.Property.getValueOrDefault(this._color,e,Cesium.Color.RED,t.color),t.speed=Cesium.Property.getValueOrDefault(this._speed,e,10,t.speed),t}equals(t){return this===t||t instanceof e&&Cesium.Property.equals(this._color,t._color)&&Cesium.Property.equals(this._speed,t._speed)}}Object.defineProperties(e.prototype,{color:Cesium.createPropertyDescriptor("color"),speed:Cesium.createPropertyDescriptor("speed")}),Cesium.Material.RadarWaveMaterialProperty="RadarWaveMaterialProperty",Cesium.Material.RadarWaveMaterialType="RadarWaveMaterialType",Cesium.Material.RadarWaveMaterialSource="\n      uniform vec4 color;\n      uniform float speed;\n\n      #define PI 3.14159265359\n\n      float rand(vec2 co){\n      return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n      }\n\n      czm_material czm_getMaterial(czm_materialInput materialInput){\n      czm_material material = czm_getDefaultMaterial(materialInput);\n      vec2 st = materialInput.st;\n      vec2 pos = st - vec2(0.5);\n      float time = czm_frameNumber * speed / 1000.0 ;\n      float r = length(pos);\n      float t = atan(pos.y, pos.x) - time * 2.5;\n      float a = (atan(sin(t), cos(t)) + PI)/(2.0*PI);\n      float ta = 0.5;\n      float v = smoothstep(ta-0.05,ta+0.05,a) * smoothstep(ta+0.05,ta-0.05,a);\n      vec3 flagColor = color.rgb * v;\n      float blink = pow(sin(time*1.5)*0.5+0.5, 0.8);\n      flagColor = color.rgb *  pow(a, 8.0*(.2+blink))*(sin(r*500.0)*.5+.5) ;\n      flagColor = flagColor * pow(r, 0.4);\n      material.alpha = length(flagColor) * 1.3;\n      material.diffuse = flagColor * 3.0;\n      return material;\n      }\n       ",Cesium.Material._materialCache.addMaterial("RadarWaveMaterialType",{fabric:{type:"RadarWaveMaterialType",uniforms:{color:new Cesium.Color(1,0,0,1),speed:10},source:Cesium.Material.RadarWaveMaterialSource},translucent:function(e){return!0}}),this.viewer.zoomTo(this.viewer.entities.add({position:Cesium.Cartesian3.fromDegrees(113.9236839,22.528061),name:"波纹雷达",ellipse:{semiMajorAxis:1e3,semiMinorAxis:1e3,material:new e({color:new Cesium.Color(1,1,0,.7),speed:20})}}))}addimgrader(){let e=this.viewer.entities.add({position:Cesium.Cartesian3.fromDegrees(113.9236839,22.528061),name:"图片雷达",ellipse:{semiMajorAxis:1e3,semiMinorAxis:1e3,material:new Cesium.ImageMaterialProperty({image:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/shanxin.png",color:new Cesium.Color(1,1,0,.7)}),height:20,heightReference:Cesium.HeightReference.RELATIVE_TO_GROUND,outline:!0,outlineColor:new Cesium.Color(1,1,0,1)}});var t,n,r;t=e.ellipse,n=0,r=-3,t.stRotation=new Cesium.CallbackProperty((function(){return((n+=r)>=360||n<=-360)&&(n=0),Cesium.Math.toRadians(n)}),!1),this.viewer.zoomTo(e)}addRadarScan(){class e{constructor(e){this._definitionChanged=new Cesium.Event,this._color=void 0,this._speed=void 0,this.color=e.color,this.speed=e.speed}get isConstant(){return!1}get definitionChanged(){return this._definitionChanged}getType(e){return Cesium.Material.RadarScanMaterialType}getValue(e,t){return Cesium.defined(t)||(t={}),t.color=Cesium.Property.getValueOrDefault(this._color,e,Cesium.Color.RED,t.color),t.speed=Cesium.Property.getValueOrDefault(this._speed,e,10,t.speed),t}equals(t){return this===t||t instanceof e&&Cesium.Property.equals(this._color,t._color)&&Cesium.Property.equals(this._speed,t._speed)}}Object.defineProperties(e.prototype,{color:Cesium.createPropertyDescriptor("color"),speed:Cesium.createPropertyDescriptor("speed")}),Cesium.Material.RadarScanMaterialProperty="RadarScanMaterialProperty",Cesium.Material.RadarScanMaterialType="RadarScanMaterialType",Cesium.Material.RadarScanMaterialSource="\n      uniform vec4 color;\n      uniform float speed;\n\n      #define PI 3.14159265359\n\n      czm_material czm_getMaterial(czm_materialInput materialInput){\n      czm_material material = czm_getDefaultMaterial(materialInput);\n      vec2 st = materialInput.st;\n      vec2 scrPt = st * 2.0 - 1.0;\n      float time = czm_frameNumber * speed / 1000.0 ;\n      vec3 col = vec3(0.0);\n      mat2 rot;\n      float theta = -time * 1.0 * PI - 2.2;\n      float cosTheta, sinTheta;\n      cosTheta = cos(theta);\n      sinTheta = sin(theta);\n      rot[0][0] = cosTheta;\n      rot[0][1] = -sinTheta;\n      rot[1][0] = sinTheta;\n      rot[1][1] = cosTheta;\n      vec2 scrPtRot = rot * scrPt;\n      float angle = 1.0 - (atan(scrPtRot.y, scrPtRot.x) / 6.2831 + 0.5);\n      float falloff = length(scrPtRot);\n      material.alpha = pow(length(col + vec3(.5)),5.0);\n      material.diffuse =  (0.5 +  pow(angle, 2.0) * falloff ) *   color.rgb    ;\n      return material;\n      }\n\n       ",Cesium.Material._materialCache.addMaterial("RadarScanMaterialType",{fabric:{type:"RadarScanMaterialType",uniforms:{color:new Cesium.Color(1,0,0,1),speed:10},source:Cesium.Material.RadarScanMaterialSource},translucent:function(e){return!0}});let t=this.viewer.entities.add({position:Cesium.Cartesian3.fromDegrees(113.9236839,22.528061),name:"雷达扫描",ellipse:{semiMajorAxis:1e3,semiMinorAxis:1e3,material:new e({color:new Cesium.Color(1,1,0,.7),speed:20}),height:20,heightReference:Cesium.HeightReference.RELATIVE_TO_GROUND,outline:!0,outlineColor:new Cesium.Color(1,1,0,1)}});this.viewer.zoomTo(t)}addTrackMatte(){new class{constructor(e){this.viewer=e.viewer,this.id=e.id,this.shortwaveRange=e.shortwaveRange,this.longitude=e.position[0],this.latitude=e.position[1],this.position=Cesium.Cartesian3.fromDegrees(e.position[0],e.position[1]),this.heading=0,this.positionArr=this.calcPoints(e.position[0],e.position[1],e.shortwaveRange,0),this.addEntities()}addEntities(){let e=this.viewer.entities.add({id:this.id,position:this.position,wall:{positions:new Cesium.CallbackProperty((()=>Cesium.Cartesian3.fromDegreesArrayHeights(this.positionArr)),!1),material:new Cesium.Color.fromCssColorString("#00dcff82"),distanceDisplayCondition:new Cesium.DistanceDisplayCondition(0,105e5)},ellipsoid:{radii:new Cesium.Cartesian3(this.shortwaveRange,this.shortwaveRange,this.shortwaveRange),maximumCone:Cesium.Math.toRadians(90),material:new Cesium.Color.fromCssColorString("#00dcff82"),outline:!0,outlineColor:new Cesium.Color.fromCssColorString("#00dcff82"),outlineWidth:1,distanceDisplayCondition:new Cesium.DistanceDisplayCondition(0,105e5)}});this.viewer.zoomTo(e),this.addPostRender()}addPostRender(){this.viewer.clock.onTick.addEventListener((()=>{this.heading+=10,this.positionArr=this.calcPoints(this.longitude,this.latitude,this.shortwaveRange,this.heading)}))}calcPoints(e,t,n,r){var i=Cesium.Transforms.eastNorthUpToFixedFrame(Cesium.Cartesian3.fromDegrees(e,t)),a=n*Math.cos(r*Math.PI/180),s=n*Math.sin(r*Math.PI/180),o=Cesium.Cartesian3.fromElements(a,s,0),l=Cesium.Matrix4.multiplyByPoint(i,o,new Cesium.Cartesian3),u=Cesium.Cartographic.fromCartesian(l),c=Cesium.Math.toDegrees(u.longitude),d=Cesium.Math.toDegrees(u.latitude);return this.computeCirclularFlight(e,t,c,d,0,90)}computeCirclularFlight(e,t,n,r,i,a){let s=[];s.push(e),s.push(t),s.push(0);var o=Cesium.Cartesian3.distance(Cesium.Cartesian3.fromDegrees(e,t),Cesium.Cartesian3.fromDegrees(n,r));for(let l=i;l<=i+a;l++){let i=o*Math.sin(l*Math.PI/180),a=Math.cos(l*Math.PI/180),u=(n-e)*a+e,c=(r-t)*a+t;s.push(u),s.push(c),s.push(i)}return s}}({viewer:this.viewer,id:1,shortwaveRange:1e5,position:[-80,35]})}addEllipsoidTrail(){class e{constructor(e){this._definitionChanged=new Cesium.Event,this._color=void 0,this._speed=void 0,this.color=e.color,this.speed=e.speed}get isConstant(){return!1}get definitionChanged(){return this._definitionChanged}getType(e){return Cesium.Material.EllipsoidTrailMaterialType}getValue(e,t){return Cesium.defined(t)||(t={}),t.color=Cesium.Property.getValueOrDefault(this._color,e,Cesium.Color.RED,t.color),t.speed=Cesium.Property.getValueOrDefault(this._speed,e,10,t.speed),t}equals(t){return this===t||t instanceof e&&Cesium.Property.equals(this._color,t._color)&&Cesium.Property.equals(this._speed,t._speed)}}Object.defineProperties(e.prototype,{color:Cesium.createPropertyDescriptor("color"),speed:Cesium.createPropertyDescriptor("speed")}),Cesium.Material.EllipsoidTrailMaterialProperty="EllipsoidTrailMaterialProperty",Cesium.Material.EllipsoidTrailMaterialType="EllipsoidTrailMaterialType",Cesium.Material.EllipsoidTrailMaterialSource="\n      uniform vec4 color;\n      uniform float speed;\n      czm_material czm_getMaterial(czm_materialInput materialInput){\n      czm_material material = czm_getDefaultMaterial(materialInput);\n      vec2 st = materialInput.st;\n      float time = fract(czm_frameNumber * speed / 1000.0);\n      float alpha = abs(smoothstep(0.5,1.,fract( -st.t - time)));\n      alpha += .1;\n      material.alpha = alpha;\n      material.diffuse = color.rgb;\n      return material;\n    }\n    ",Cesium.Material._materialCache.addMaterial("EllipsoidTrailMaterialType",{fabric:{type:"EllipsoidTrailMaterialType",uniforms:{color:new Cesium.Color(1,0,0,1),speed:10},source:Cesium.Material.EllipsoidTrailMaterialSource},translucent:function(e){return!0}}),this.viewer.zoomTo(this.viewer.entities.add({position:Cesium.Cartesian3.fromDegrees(113.9236839,22.528061),name:"轨迹球体",ellipsoid:{radii:new Cesium.Cartesian3(1e3,1e3,1e3),material:new e({color:new Cesium.Color(1,1,0,1),speed:10})}}))}addEllipsoidElectric(){class e{constructor(e){this._definitionChanged=new Cesium.Event,this._color=void 0,this._speed=void 0,this.color=e.color,this.speed=e.speed}get isConstant(){return!1}get definitionChanged(){return this._definitionChanged}getType(e){return Cesium.Material.EllipsoidElectricMaterialType}getValue(e,t){return Cesium.defined(t)||(t={}),t.color=Cesium.Property.getValueOrDefault(this._color,e,Cesium.Color.RED,t.color),t.speed=Cesium.Property.getValueOrDefault(this._speed,e,10,t.speed),t}equals(t){return this===t||t instanceof e&&Cesium.Property.equals(this._color,t._color)&&Cesium.Property.equals(this._speed,t._speed)}}Object.defineProperties(e.prototype,{color:Cesium.createPropertyDescriptor("color"),speed:Cesium.createPropertyDescriptor("speed")}),Cesium.Material.EllipsoidElectricMaterialProperty="EllipsoidElectricMaterialProperty",Cesium.Material.EllipsoidElectricMaterialType="EllipsoidElectricMaterialType",Cesium.Material.EllipsoidElectricMaterialSource="\n    uniform vec4 color;\n    uniform float speed;\n\n    #define pi 3.1415926535\n    #define PI2RAD 0.01745329252\n    #define TWO_PI (2. * PI)\n\n    float rands(float p){\n    return fract(sin(p) * 10000.0);\n    }\n\n    float noise(vec2 p){\n    float time = fract( czm_frameNumber * speed / 1000.0);\n    float t = time / 20000.0;\n    if(t > 1.0) t -= floor(t);\n    return rands(p.x * 14. + p.y * sin(t) * 0.5);\n    }\n\n    vec2 sw(vec2 p){\n    return vec2(floor(p.x), floor(p.y));\n    }\n\n    vec2 se(vec2 p){\n    return vec2(ceil(p.x), floor(p.y));\n    }\n\n    vec2 nw(vec2 p){\n    return vec2(floor(p.x), ceil(p.y));\n    }\n\n    vec2 ne(vec2 p){\n    return vec2(ceil(p.x), ceil(p.y));\n    }\n\n    float smoothNoise(vec2 p){\n    vec2 inter = smoothstep(0.0, 1.0, fract(p));\n    float s = mix(noise(sw(p)), noise(se(p)), inter.x);\n    float n = mix(noise(nw(p)), noise(ne(p)), inter.x);\n    return mix(s, n, inter.y);\n    }\n\n    float fbm(vec2 p){\n    float z = 2.0;\n    float rz = 0.0;\n    vec2 bp = p;\n    for(float i = 1.0; i < 6.0; i++){\n        rz += abs((smoothNoise(p) - 0.5)* 2.0) / z;\n        z *= 2.0;\n        p *= 2.0;\n    }\n    return rz;\n    }\n\n    czm_material czm_getMaterial(czm_materialInput materialInput)\n    {\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    vec2 st = materialInput.st;\n    vec2 st2 = materialInput.st;\n    float time = fract( czm_frameNumber * speed / 1000.0);\n    if (st.t < 0.5) {\n        discard;\n    }\n    st *= 4.;\n    float rz = fbm(st);\n    st /= exp(mod( time * 2.0, pi));\n    rz *= pow(15., 0.9);\n    vec4 temp = vec4(0);\n    temp = mix( color / rz, vec4(color.rgb, 0.1), 0.2);\n    if (st2.s < 0.05) {\n        temp = mix(vec4(color.rgb, 0.1), temp, st2.s / 0.05);\n    }\n    if (st2.s > 0.95){\n        temp = mix(temp, vec4(color.rgb, 0.1), (st2.s - 0.95) / 0.05);\n    }\n    material.diffuse = temp.rgb;\n    material.alpha = temp.a * 2.0;\n    return material;\n    }\n    ",Cesium.Material._materialCache.addMaterial("EllipsoidElectricMaterialType",{fabric:{type:"EllipsoidElectricMaterialType",uniforms:{color:new Cesium.Color(1,0,0,1),speed:10},source:Cesium.Material.EllipsoidElectricMaterialSource},translucent:function(e){return!0}}),this.viewer.zoomTo(this.viewer.entities.add({position:Cesium.Cartesian3.fromDegrees(113.9236839,22.528061),name:"电弧球体",ellipsoid:{radii:new Cesium.Cartesian3(1e3,1e3,1e3),material:new e({color:new Cesium.Color(1,1,0,1),speed:10})}}))}addinduationAnalysis(){var e,t,n,r;e=this.viewer,t=100,n=[120,30],r=70,e.zoomTo(e.entities.add({polygon:{hierarchy:new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromDegreesArray(n)),perPositionHeight:!0,extrudedHeight:new Cesium.CallbackProperty((function(){return(r+=.2)>t&&(r=t),r}),!1),material:new Cesium.Color.fromBytes(64,157,253,150)}}))}addLightShadow(){var e,t;e=this.viewer,t=1e4,e.scene.globe.enableLighting=!0,e.shadows=!0,e.clock.multiplier=t}addcontourLine(){let e=this;!function(){let t=e.viewer.scene.globe,n={},r=Cesium.Material.fromType("ElevationContour");n=r.uniforms,n.width=2,n.spacing=150,n.color=Cesium.Color.RED,t.material=r}()}saveToFile(e){this.viewer.scene.render();let t=this.viewer.scene.canvas.toDataURL("image/png").replace("image/png","image/octet-stream"),n=document.createElement("a"),r=this.dataURLtoBlob(t),i=URL.createObjectURL(r);n.download=e+".png",n.href=i,n.click()}dataURLtoBlob(e){let t=e.split(","),n=t[0].match(/:(.*?);/)[1],r=atob(t[1]),i=r.length,a=new Uint8Array(i);for(;i--;)a[i]=r.charCodeAt(i);return new Blob([a],{type:n})}}class mte{constructor(e){t(this,"_viewer"),this._viewer=e}_icrf(){if(this._viewer.scene.mode!==Cesium.SceneMode.SCENE3D)return!0;let e=Cesium.Transforms.computeIcrfToFixedMatrix(this._viewer.clock.currentTime);if(e){let t=this._viewer.camera,n=Cesium.Cartesian3.clone(t.position),r=Cesium.Matrix4.fromRotationTranslation(e);t.lookAtTransform(r,n)}}_bindEvent(){this._viewer.clock.multiplier=15e3,this._viewer.camera.lookAtTransform(Cesium.Matrix4.IDENTITY),this._viewer.scene.postUpdate.addEventListener(this._icrf,this)}_unbindEvent(){this._viewer.clock.multiplier=1,this._viewer.camera.lookAtTransform(Cesium.Matrix4.IDENTITY),this._viewer.scene.postUpdate.removeEventListener(this._icrf,this)}start(){return this._viewer.clock.shouldAnimate=!0,this._unbindEvent(),this._bindEvent(),this}stop(){return this._unbindEvent(),this}}const gte=Ti("div",{id:"jhayesGL",class:"w-full h-full bg-black"},null,-1),vte=Fn({__name:"mapbox",setup(e){let t;return Kn((()=>{let e=new fte("jhayesGL",{});e.setCamera({position:{x:-2510492.091619563,y:4913373.38166541,z:3236588.439540879},heading:6.283185307179586,pitch:-1.5695556351494262,roll:0}),e.addMap({mapType:"mapbox"}),t=()=>{e.saveToFile("mapbox")}})),(e,n)=>(fi(),yi(li,null,[Ti("div",{class:"absolute z-50 bg-[#fff] w-10 h-5 top-5 right-5",onClick:n[0]||(n[0]=e=>Dt(t)())}),gte],64))}}),yte=Ti("div",{id:"jhayesGL",class:"w-full h-full bg-black"},null,-1),_te=Fn({__name:"osm",setup(e){let t;return Kn((()=>{let e=new fte("jhayesGL",{});e.setCamera({position:{x:-2510492.091619563,y:4913373.38166541,z:3236588.439540879},heading:6.283185307179586,pitch:-1.5695556351494262,roll:0}),e.addMap({mapType:"osm"}),t=()=>{e.saveToFile("osm")}})),(e,n)=>(fi(),yi(li,null,[Ti("div",{class:"absolute z-50 bg-[#fff] w-10 h-5 top-5 right-5",onClick:n[0]||(n[0]=e=>Dt(t)())}),yte],64))}}),bte=Ti("div",{id:"jhayesGL",class:"w-full h-full bg-black"},null,-1),xte=Fn({__name:"arcgis",setup(e){let t;return Kn((()=>{let e=new fte("jhayesGL",{});e.setCamera({position:{x:-2510492.091619563,y:4913373.38166541,z:3236588.439540879},heading:6.283185307179586,pitch:-1.5695556351494262,roll:0}),e.addMap({mapType:"arcgis"}),t=()=>{e.saveToFile("arcgis")}})),(e,n)=>(fi(),yi(li,null,[Ti("div",{class:"absolute z-50 bg-[#fff] w-10 h-5 top-5 right-5",onClick:n[0]||(n[0]=e=>Dt(t)())}),bte],64))}}),wte=Ti("div",{id:"jhayesGL",class:"w-full h-full bg-black"},null,-1),Ste=Fn({__name:"gaode",setup(e){let t;return Kn((()=>{let e=new fte("jhayesGL",{});e.setCamera({position:{x:-2510492.091619563,y:4913373.38166541,z:3236588.439540879},heading:6.283185307179586,pitch:-1.5695556351494262,roll:0}),e.addMap({mapType:"gaode"}),t=()=>{e.saveToFile("gaode")}})),(e,n)=>(fi(),yi(li,null,[Ti("div",{class:"absolute z-50 bg-[#fff] w-10 h-5 top-5 right-5",onClick:n[0]||(n[0]=e=>Dt(t)())}),wte],64))}}),Cte=Ti("div",{id:"jhayesGL",class:"w-full h-full bg-black"},null,-1),Tte={class:"absolute bottom-10 right-10"},Mte=Fn({__name:"tencent",setup(e){let t,n;return Kn((()=>{let e=new fte("jhayesGL",{});e.setCamera({position:{x:-2510492.091619563,y:4913373.38166541,z:3236588.439540879},heading:6.283185307179586,pitch:-1.5695556351494262,roll:0}),e.addMap({mapType:"tencent",tencentType:"0"}),n=t=>{e.addMap({mapType:"tencent",tencentType:t})},t=()=>{e.saveToFile("tencent")}})),(e,r)=>(fi(),yi(li,null,[Ti("div",{class:"absolute z-50 bg-[#fff] w-10 h-5 top-5 right-5",onClick:r[0]||(r[0]=e=>Dt(t)())}),Cte,Ti("div",Tte,[Ti("button",{onClick:r[1]||(r[1]=e=>Dt(n)("0")),class:"btn btn-active"},"矢量图"),Ti("button",{onClick:r[2]||(r[2]=e=>Dt(n)("1")),class:"btn btn-active"},"黑色风格"),Ti("button",{onClick:r[3]||(r[3]=e=>Dt(n)("2")),class:"btn btn-active"},"注记图1"),Ti("button",{onClick:r[4]||(r[4]=e=>Dt(n)("3")),class:"btn btn-active"},"注记图2"),Ti("button",{onClick:r[5]||(r[5]=e=>Dt(n)("4")),class:"btn btn-active"},"影像图")])],64))}}),Ete=Ti("div",{id:"jhayesGL",class:"w-full h-full bg-black"},null,-1),Ate=Fn({__name:"Tianditu",setup(e){let t;return Kn((()=>{let e=new fte("jhayesGL",{});e.setCamera({position:{x:-2510492.091619563,y:4913373.38166541,z:3236588.439540879},heading:6.283185307179586,pitch:-1.5695556351494262,roll:0}),e.addMap({mapType:"Tianditu"}),t=()=>{e.saveToFile("Tianditu")}})),(e,n)=>(fi(),yi(li,null,[Ti("div",{class:"absolute z-50 bg-[#fff] w-10 h-5 top-5 right-5",onClick:n[0]||(n[0]=e=>Dt(t)())}),Ete],64))}}),Pte=Ti("div",{id:"jhayesGL",class:"w-full h-full bg-black"},null,-1),Rte=Fn({__name:"google",setup(e){let t;return Kn((()=>{let e=new fte("jhayesGL",{});e.setCamera({position:{x:-2510492.091619563,y:4913373.38166541,z:3236588.439540879},heading:6.283185307179586,pitch:-1.5695556351494262,roll:0}),e.addMap({mapType:"google"}),t=()=>{e.saveToFile("google")}})),(e,n)=>(fi(),yi(li,null,[Ti("div",{class:"absolute z-50 bg-[#fff] w-10 h-5 top-5 right-5",onClick:n[0]||(n[0]=e=>Dt(t)())}),Pte],64))}}),Lte=Ti("div",{id:"jhayesGL",class:"w-full h-full bg-black"},null,-1),kte=Fn({__name:"extraterrain",setup(e){let t;return Kn((()=>{let e=new fte("jhayesGL",{});e.setCamera({position:{x:-2510492.091619563,y:4913373.38166541,z:3236588.439540879},heading:6.283185307179586,pitch:-1.5695556351494262,roll:0}),e.addTerrain({terrainExaggeration:13}),t=()=>{e.saveToFile("extraterrain")}})),(e,n)=>(fi(),yi(li,null,[Ti("div",{class:"absolute z-50 bg-[#fff] w-10 h-5 top-5 right-5",onClick:n[0]||(n[0]=e=>Dt(t)())}),Lte],64))}}),Dte={id:"jhayesGL",class:"w-full h-full bg-black"},Ite=Fn({__name:"compass",setup:e=>(Kn((()=>{let e=new fte("jhayesGL",{});e.setCamera({position:{x:-2510492.091619563,y:4913373.38166541,z:3236588.439540879},heading:6.283185307179586,pitch:-1.5695556351494262,roll:0}),e.addcompass()})),(e,t)=>(fi(),yi("div",Dte)))}),Ote=Ti("div",{id:"jhayesGL",class:"w-full h-full bg-black"},null,-1),Nte=Fn({__name:"background",setup(e){let t;return Kn((()=>{let e=new fte("jhayesGL",{});e.setCamera({position:{x:-2510492.091619563,y:4913373.38166541,z:3236588.439540879},heading:6.283185307179586,pitch:-1.5695556351494262,roll:0}),e.setBackground({img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/Earth.jpg"}),t=()=>{e.saveToFile("background")}})),(e,n)=>(fi(),yi(li,null,[Ti("div",{class:"absolute z-50 bg-[#fff] w-10 h-5 top-5 right-5",onClick:n[0]||(n[0]=e=>Dt(t)())}),Ote],64))}}),Bte=Ti("div",{id:"jhayesGL",class:"w-full h-full bg-black"},null,-1),Ute=Fn({__name:"Geojson",setup(e){let t;return Kn((()=>{let e=new fte("jhayesGL",{});e.setCamera({position:{x:-2510492.091619563,y:4913373.38166541,z:3236588.439540879},heading:6.283185307179586,pitch:-1.5695556351494262,roll:0}),e.addGeojson(),t=()=>{e.saveToFile("Geojson")}})),(e,n)=>(fi(),yi(li,null,[Ti("div",{class:"absolute z-50 bg-[#fff] w-10 h-5 top-5 right-5",onClick:n[0]||(n[0]=e=>Dt(t)())}),Bte],64))}}),zte=Ti("div",{id:"jhayesGL",class:"w-full h-full bg-black"},null,-1),Fte=Fn({__name:"GeojsonPrimitive",setup(e){let t;return Kn((()=>{let e=new fte("jhayesGL",{});e.setCamera({position:{x:-2510492.091619563,y:4913373.38166541,z:3236588.439540879},heading:6.283185307179586,pitch:-1.5695556351494262,roll:0}),e.addGeojsonByPrimitive(),t=()=>{e.saveToFile("GeojsonPrimitive")}})),(e,n)=>(fi(),yi(li,null,[Ti("div",{class:"absolute z-50 bg-[#fff] w-10 h-5 top-5 right-5",onClick:n[0]||(n[0]=e=>Dt(t)())}),zte],64))}}),Vte={id:"jhayesGL",class:"w-full h-full bg-black"},Gte=Fn({__name:"model",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addModel()})),(e,t)=>(fi(),yi("div",Vte)))}),Hte={id:"jhayesGL",class:"w-full h-full bg-black"},jte=Fn({__name:"movingModel",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addMovingModel()})),(e,t)=>(fi(),yi("div",Hte)))}),Wte={id:"jhayesGL",class:"w-full h-full bg-black"},Yte=Fn({__name:"moveModel",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addMoveModel()})),(e,t)=>(fi(),yi("div",Wte)))}),$te={id:"jhayesGL",class:"w-full h-full bg-black"},Xte=Fn({__name:"threeDtiles",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).add3Dtiles()})),(e,t)=>(fi(),yi("div",$te)))}),qte={id:"jhayesGL",class:"w-full h-full bg-black"},Kte=Fn({__name:"threeDtilesView",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).add3DtilesView()})),(e,t)=>(fi(),yi("div",qte)))}),Zte={id:"jhayesGL",class:"w-full h-full bg-black"},Jte=Fn({__name:"threedtilesetFeature",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).add3dtilesetFeature()})),(e,t)=>(fi(),yi("div",Zte)))}),Qte={id:"jhayesGL",class:"w-full h-full bg-black"},ene=Fn({__name:"threedtilesetMaterial",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).add3dtilesetMaterial()})),(e,t)=>(fi(),yi("div",Qte)))}),tne={id:"jhayesGL",class:"w-full h-full bg-black"},nne=Fn({__name:"point",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addPoint()})),(e,t)=>(fi(),yi("div",tne)))}),rne=Ti("div",{id:"jhayesGL",class:"w-full h-full bg-black"},null,-1),ine=Fn({__name:"Cluster",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addCluster()})),(e,t)=>(fi(),yi(li,null,[Ti("div",{class:"absolute z-50 bg-[#fff] w-10 h-5 top-5 right-5",onClick:t[0]||(t[0]=e=>Dt(undefined)())}),rne],64)))}),ane={id:"jhayesGL",class:"w-full h-full bg-black"},sne=Fn({__name:"PointLabel",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addPointLabel()})),(e,t)=>(fi(),yi("div",ane)))}),one={id:"jhayesGL",class:"w-full h-full bg-black"},lne=Fn({__name:"MatrixGraph",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addMatrixGraph()})),(e,t)=>(fi(),yi("div",one)))}),une={id:"jhayesGL",class:"w-full h-full bg-black"},cne=Fn({__name:"globeRotate",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addglobeRotate()})),(e,t)=>(fi(),yi("div",une)))}),dne={id:"jhayesGL",class:"w-full h-full bg-black"},hne=Fn({__name:"DayAndNight",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addDayAndNight()})),(e,t)=>(fi(),yi("div",dne)))}),pne={id:"jhayesGL",class:"w-full h-full bg-black"},fne=Fn({__name:"Divide",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addDivide()})),(e,t)=>(fi(),yi("div",pne)))}),mne={id:"jhayesGL",class:"w-full h-full bg-black"},gne=Fn({__name:"SkyBox",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addSkyBox()})),(e,t)=>(fi(),yi("div",mne)))}),vne={id:"jhayesGL",class:"w-full h-full bg-black"},yne=Fn({__name:"RoadShuttle",setup:e=>(Kn((()=>{let e=new fte("jhayesGL",{});e.setCamera({position:{x:-2393647.554490467,y:5394776.367330106,z:2430352.1307880664},heading:6.283185307179581,pitch:-1.5702582197373482,roll:0}),e.addRoadShuttle()})),(e,t)=>(fi(),yi("div",vne)))}),_ne=Ti("div",{id:"jhayesGL",class:"w-full h-full bg-black"},null,-1),bne={id:"jhayesGL",class:"w-full h-full bg-black"},xne={id:"jhayesGL",class:"w-full h-full bg-black"},wne={id:"jhayesGL",class:"w-full h-full bg-black"},Sne={id:"jhayesGL",class:"w-full h-full bg-black"},Cne={id:"jhayesGL",class:"w-full h-full bg-black"},Tne={id:"jhayesGL",class:"w-full h-full bg-black"},Mne={id:"jhayesGL",class:"w-full h-full bg-black"},Ene={id:"jhayesGL",class:"w-full h-full bg-black"},Ane={id:"jhayesGL",class:"w-full h-full bg-black"},Pne={id:"jhayesGL",class:"w-full h-full bg-black"},Rne={id:"jhayesGL",class:"w-full h-full bg-black"},Lne={id:"jhayesGL",class:"w-full h-full bg-black"},kne={id:"jhayesGL",class:"w-full h-full bg-black"},Dne={id:"jhayesGL",class:"w-full h-full bg-black"},Ine={id:"jhayesGL",class:"w-full h-full bg-black"},One={id:"jhayesGL",class:"w-full h-full bg-black"},Nne={id:"jhayesGL",class:"w-full h-full bg-black"},Bne={id:"jhayesGL",class:"w-full h-full bg-black"},Une={id:"jhayesGL",class:"w-full h-full bg-black"},zne={id:"jhayesGL",class:"w-full h-full bg-black"},Fne={id:"jhayesGL",class:"w-full h-full bg-black"},Vne={id:"jhayesGL",class:"w-full h-full bg-black"},Gne={id:"jhayesGL",class:"w-full h-full bg-black"},Hne={id:"jhayesGL",class:"w-full h-full bg-black"},jne={id:"jhayesGL",class:"w-full h-full bg-black"},Wne={id:"jhayesGL",class:"w-full h-full bg-black"},Yne={id:"jhayesGL",class:"w-full h-full bg-black"},$ne={id:"jhayesGL",class:"w-full h-full bg-black"},Xne={id:"jhayesGL",class:"w-full h-full bg-black"},qne={id:"jhayesGL",class:"w-full h-full bg-black"},Kne={id:"jhayesGL",class:"w-full h-full bg-black"},Zne={id:"jhayesGL",class:"w-full h-full bg-black"},Jne=[{path:"/tucengditu",name:"图层底图",component:"",meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/JHAYESGL.png"},children:[{path:"/mapbox",name:"mapbox",component:vte,meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/mapbox.png"}},{path:"/osm",name:"osm",component:_te,meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/osm.png"}},{path:"/arcgis",name:"arcgis",component:xte,meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/arcgis.png"}},{path:"/gaode",name:"高德地图",component:Ste,meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/gaode.png"}},{path:"/tencent",name:"腾讯地图",component:Mte,meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/tencent.png"}},{path:"/Tianditu",name:"天地图",component:Ate,meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/Tianditu.png"}},{path:"/google",name:"google",component:Rte,meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/google.png"}},{path:"/extraterrain",name:"夸张地形",component:kte,meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/extraterrain.png"}},{path:"/compass",name:"罗盘",component:Ite,meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/compass.png"}},{path:"/background",name:"本地图片",component:Nte,meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/background.png"}},{path:"/Geojson",name:"Geojson",component:Ute,meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/Geojson.png"}},{path:"/GeojsonPrimitive",name:"GeojsonPrimitive",component:Fte,meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/GeojsonPrimitive.png"}}]},{path:"/shitimoxing",name:"实体模型",component:"",meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/JHAYESGL.png"},children:[{path:"/model",name:"model",component:Gte,meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/model.png"}},{path:"/movingModel",name:"movingModel",component:jte,meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/movingModel.png"}},{path:"/moveModel",name:"moveModel",component:Yte,meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/moveModel.png"}},{path:"/3Dtiles",name:"3Dtiles",component:Xte,meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/3Dtiles.png"}},{path:"/3Dtilesview",name:"3Dtilesview",component:Kte,meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/threeDtilesview.png"}},{path:"/threeDtilesFeature",name:"threeDtilesFeature",component:Jte,meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/threeDtilesFeature.png"}},{path:"/threeDtilesMaterial",name:"threeDtilesMaterial",component:ene,meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/threeDtilesMaterial.png"}}]},{path:"/biaozhuhuizhi",name:"标注绘制",component:"",meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/JHAYESGL.png"},children:[{path:"/point",name:"point",component:nne,meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/point.png"}},{path:"/Cluster",name:"Cluster",component:ine,meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/Cluster.png"}},{path:"/PointLabel",name:"PointLabel",component:sne,meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/PointLabel.png"}},{path:"/MatrixGraph",name:"MatrixGraph",component:lne,meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/MatrixGraph.png"}},{path:"/globeRotate",name:"globeRotate",component:cne,meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/globeRotate.png"}},{path:"/DayAndNight",name:"DayAndNight",component:hne,meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/DayAndNight.png"}},{path:"/Divide",name:"Divide",component:fne,meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/Divide.png"}},{path:"/SkyBox",name:"SkyBox",component:gne,meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/SkyBox.png"}},{path:"/RoadShuttle",name:"RoadShuttle",component:yne,meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/RoadShuttle.png"}},{path:"/ScintillationLine",name:"ScintillationLine",component:Fn({__name:"ScintillationLine",setup(e){let t;return Kn((()=>{let e=new fte("jhayesGL",{});e.addScintillationLine(),t=()=>{e.saveToFile("ScintillationLine")}})),(e,n)=>(fi(),yi(li,null,[Ti("div",{class:"absolute z-50 bg-[#fff] w-10 h-5 top-5 right-5",onClick:n[0]||(n[0]=e=>Dt(t)())}),_ne],64))}}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/ScintillationLine.png"}},{path:"/FlyLine",name:"FlyLine",component:Fn({__name:"FlyLine",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addFlyLine()})),(e,t)=>(fi(),yi("div",bne)))}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/FlyLine.png"}},{path:"/Parabola",name:"Parabola",component:Fn({__name:"Parabola",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addParabola()})),(e,t)=>(fi(),yi("div",xne)))}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/Parabola.png"}},{path:"/GeojsonBorder",name:"GeojsonBorder",component:Fn({__name:"GeojsonBorder",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addGeojsonBorder()})),(e,t)=>(fi(),yi("div",wne)))}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/GeojsonBorder.png"}},{path:"/Hexagon",name:"Hexagon",component:Fn({__name:"Hexagon",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addHexagon()})),(e,t)=>(fi(),yi("div",Sne)))}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/Hexagon.png"}},{path:"/FlowWater",name:"FlowWater",component:Fn({__name:"FlowWater",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addFlowWater()})),(e,t)=>(fi(),yi("div",Cne)))}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/FlowWater.png"}},{path:"/FlowWall",name:"FlowWall",component:Fn({__name:"FlowWall",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addFlowWall()})),(e,t)=>(fi(),yi("div",Tne)))}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/FlowWall.png"}},{path:"/streamWall",name:"streamWall",component:Fn({__name:"streamWall",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addstreamWall()})),(e,t)=>(fi(),yi("div",Mne)))}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/streamWall.png"}},{path:"/DiffusionWall",name:"DiffusionWall",component:Fn({__name:"DiffusionWall",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addDiffusionWall()})),(e,t)=>(fi(),yi("div",Ene)))}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/DiffusionWall.png"}},{path:"/WallRegularDiffuse",name:"WallRegularDiffuse",component:Fn({__name:"WallRegularDiffuse",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addWallRegularDiffuse()})),(e,t)=>(fi(),yi("div",Ane)))}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/WallRegularDiffuse.png"}},{path:"/ThreeDimensionalWall",name:"ThreeDimensionalWall",component:Fn({__name:"ThreeDimensionalWall",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addThreeDimensionalWall()})),(e,t)=>(fi(),yi("div",Pne)))}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/ThreeDimensionalWall.png"}},{path:"/rotateMaterial",name:"rotateMaterial",component:Fn({__name:"rotateMaterial",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addrotateMaterial()})),(e,t)=>(fi(),yi("div",Rne)))}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/rotateMaterial.png"}},{path:"/CircleScan",name:"CircleScan",component:Fn({__name:"CircleScan",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addCircleScan()})),(e,t)=>(fi(),yi("div",Lne)))}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/CircleScan.png"}},{path:"/CorrugatedCircle",name:"CorrugatedCircle",component:Fn({__name:"CorrugatedCircle",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addCorrugatedCircle()})),(e,t)=>(fi(),yi("div",kne)))}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/CorrugatedCircle.png"}},{path:"/CircleDiffuse",name:"CircleDiffuse",component:Fn({__name:"CircleDiffuse",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addCircleDiffuse()})),(e,t)=>(fi(),yi("div",Dne)))}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/CircleDiffuse.png"}},{path:"/ShadowCircle",name:"ShadowCircle",component:Fn({__name:"ShadowCircle",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addShadowCircle()})),(e,t)=>(fi(),yi("div",Ine)))}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/ShadowCircle.png"}},{path:"/CircleBlur",name:"CircleBlur",component:Fn({__name:"CircleBlur",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addCircleBlur()})),(e,t)=>(fi(),yi("div",One)))}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/CircleBlur.png"}},{path:"/CircleSpiral",name:"CircleSpiral",component:Fn({__name:"CircleSpiral",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addCircleSpiral()})),(e,t)=>(fi(),yi("div",Nne)))}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/CircleSpiral.png"}},{path:"/CircleColorful",name:"CircleColorful",component:Fn({__name:"CircleColorful",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addCircleColorful()})),(e,t)=>(fi(),yi("div",Bne)))}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/CircleColorful.png"}},{path:"/CircleWave",name:"CircleWave",component:Fn({__name:"CircleWave",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addCircleWave()})),(e,t)=>(fi(),yi("div",Une)))}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/CircleWave.png"}},{path:"/CircleDiffusion",name:"CircleDiffusion",component:Fn({__name:"CircleDiffusion",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addCircleDiffusion()})),(e,t)=>(fi(),yi("div",zne)))}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/CircleDiffusion.png"}},{path:"/scanline",name:"scanline",component:Fn({__name:"scanline",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addscanline()})),(e,t)=>(fi(),yi("div",Fne)))}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/scanline.png"}},{path:"/CircleRadarScan",name:"CircleRadarScan",component:Fn({__name:"CircleRadarScan",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addCircleRadarScan()})),(e,t)=>(fi(),yi("div",Vne)))}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/CircleRadarScan.png"}},{path:"/RadarLine",name:"RadarLine",component:Fn({__name:"RadarLine",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addRadarLine()})),(e,t)=>(fi(),yi("div",Gne)))}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/RadarLine.png"}},{path:"/RadarWave",name:"RadarWave",component:Fn({__name:"RadarWave",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addRadarWave()})),(e,t)=>(fi(),yi("div",Hne)))}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/RadarWave.png"}},{path:"/imgrader",name:"imgrader",component:Fn({__name:"imgrader",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addimgrader()})),(e,t)=>(fi(),yi("div",jne)))}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/imgrader.png"}},{path:"/RadarScan",name:"RadarScan",component:Fn({__name:"RadarScan",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addRadarScan()})),(e,t)=>(fi(),yi("div",Wne)))}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/RadarScan.png"}},{path:"/TrackMatte",name:"TrackMatte",component:Fn({__name:"TrackMatte",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addTrackMatte()})),(e,t)=>(fi(),yi("div",Yne)))}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/TrackMatte.png"}},{path:"/EllipsoidTrail",name:"EllipsoidTrail",component:Fn({__name:"EllipsoidTrail",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addEllipsoidTrail()})),(e,t)=>(fi(),yi("div",$ne)))}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/EllipsoidTrail.png"}},{path:"/EllipsoidElectric",name:"EllipsoidElectric",component:Fn({__name:"EllipsoidElectric",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addEllipsoidElectric()})),(e,t)=>(fi(),yi("div",Xne)))}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/EllipsoidElectric.png"}},{path:"/induationAnalysis",name:"induationAnalysis",component:Fn({__name:"induationAnalysis",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addinduationAnalysis()})),(e,t)=>(fi(),yi("div",qne)))}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/induationAnalysis.png"}},{path:"/LightShadow",name:"LightShadow",component:Fn({__name:"LightShadow",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addLightShadow()})),(e,t)=>(fi(),yi("div",Kne)))}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/LightShadow.png"}},{path:"/contourLine",name:"contourLine",component:Fn({__name:"contourLine",setup:e=>(Kn((()=>{new fte("jhayesGL",{}).addcontourLine()})),(e,t)=>(fi(),yi("div",Zne)))}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/contourLine.png"}}]}],Qne={components:{Atropos:u4},data:()=>({route3d:Jne}),mounted(){console.log(Jne)}},ere={class:"p-[2vw]"},tre=Ti("div",{style:{height:"100%",width:"100%","background-color":"var(--el-bg-color-overlay)","box-shadow":"var(--el-box-shadow-lighter)","text-align":"center","line-height":"40px",color:"#1989fa"}}," UP ",-1),nre=["id"],rre=["href"],ire=["src"],are={class:"absolute w-full h-[40px] bottom-0 z-100 bg-[#00000050] text-center leading-[40px] text-[20px] text-[#ffffff] justify-center"};const sre=gs(Qne,[["render",function(e,t,n,r,i,a){const s=ur("el-backtop"),o=ur("atropos");return fi(),yi("div",ere,[Mi(s,{bottom:100},{default:vn((()=>[tre])),_:1}),(fi(!0),yi(li,null,mr(i.route3d,((e,t)=>(fi(),yi("div",{key:t,class:"flex flex-wrap w-full"},[Ti("div",{id:e.name,class:"w-full text-[1.5vw] font-bold"},f(e.name),9,nre),(fi(!0),yi(li,null,mr(e.children,((e,t)=>(fi(),yi("div",{key:t,class:"m-3"},[Ti("a",{href:"/#"+e.path,target:"_blank"},[Mi(o,{class:"my-atropos"},{default:vn((()=>[Ti("img",{class:"absolute w-full h-full z-1",src:e.meta.img,alt:""},null,8,ire),Ti("div",are,f(e.name),1)])),_:2},1024)],8,rre)])))),128))])))),128))])}]]);var ore={};!function(e){var t="1.9.4";function n(e){var t,n,r,i;for(n=1,r=arguments.length;n<r;n++)for(t in i=arguments[n])e[t]=i[t];return e}var r=Object.create||function(){function e(){}return function(t){return e.prototype=t,new e}}();function i(e,t){var n=Array.prototype.slice;if(e.bind)return e.bind.apply(e,n.call(arguments,1));var r=n.call(arguments,2);return function(){return e.apply(t,r.length?r.concat(n.call(arguments)):arguments)}}var a=0;function s(e){return"_leaflet_id"in e||(e._leaflet_id=++a),e._leaflet_id}function o(e,t,n){var r,i,a,s;return s=function(){r=!1,i&&(a.apply(n,i),i=!1)},a=function(){r?i=arguments:(e.apply(n,arguments),setTimeout(s,t),r=!0)},a}function l(e,t,n){var r=t[1],i=t[0],a=r-i;return e===r&&n?e:((e-i)%a+a)%a+i}function u(){return!1}function c(e,t){if(!1===t)return e;var n=Math.pow(10,void 0===t?6:t);return Math.round(e*n)/n}function d(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function h(e){return d(e).split(/\s+/)}function p(e,t){for(var n in Object.prototype.hasOwnProperty.call(e,"options")||(e.options=e.options?r(e.options):{}),t)e.options[n]=t[n];return e.options}function f(e,t,n){var r=[];for(var i in e)r.push(encodeURIComponent(n?i.toUpperCase():i)+"="+encodeURIComponent(e[i]));return(t&&-1!==t.indexOf("?")?"&":"?")+r.join("&")}var m=/\{ *([\w_ -]+) *\}/g;function g(e,t){return e.replace(m,(function(e,n){var r=t[n];if(void 0===r)throw new Error("No value provided for variable "+e);return"function"==typeof r&&(r=r(t)),r}))}var v=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function y(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1}var _="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function b(e){return window["webkit"+e]||window["moz"+e]||window["ms"+e]}var x=0;function w(e){var t=+new Date,n=Math.max(0,16-(t-x));return x=t+n,window.setTimeout(e,n)}var S=window.requestAnimationFrame||b("RequestAnimationFrame")||w,C=window.cancelAnimationFrame||b("CancelAnimationFrame")||b("CancelRequestAnimationFrame")||function(e){window.clearTimeout(e)};function T(e,t,n){if(!n||S!==w)return S.call(window,i(e,t));e.call(t)}function M(e){e&&C.call(window,e)}var E={__proto__:null,extend:n,create:r,bind:i,get lastId(){return a},stamp:s,throttle:o,wrapNum:l,falseFn:u,formatNum:c,trim:d,splitWords:h,setOptions:p,getParamString:f,template:g,isArray:v,indexOf:y,emptyImageUrl:_,requestFn:S,cancelFn:C,requestAnimFrame:T,cancelAnimFrame:M};function A(){}function P(e){if("undefined"!=typeof L&&L&&L.Mixin){e=v(e)?e:[e];for(var t=0;t<e.length;t++)e[t]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}}A.extend=function(e){var t=function(){p(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},i=t.__super__=this.prototype,a=r(i);for(var s in a.constructor=t,t.prototype=a,this)Object.prototype.hasOwnProperty.call(this,s)&&"prototype"!==s&&"__super__"!==s&&(t[s]=this[s]);return e.statics&&n(t,e.statics),e.includes&&(P(e.includes),n.apply(null,[a].concat(e.includes))),n(a,e),delete a.statics,delete a.includes,a.options&&(a.options=i.options?r(i.options):{},n(a.options,e.options)),a._initHooks=[],a.callInitHooks=function(){if(!this._initHooksCalled){i.callInitHooks&&i.callInitHooks.call(this),this._initHooksCalled=!0;for(var e=0,t=a._initHooks.length;e<t;e++)a._initHooks[e].call(this)}},t},A.include=function(e){var t=this.prototype.options;return n(this.prototype,e),e.options&&(this.prototype.options=t,this.mergeOptions(e.options)),this},A.mergeOptions=function(e){return n(this.prototype.options,e),this},A.addInitHook=function(e){var t=Array.prototype.slice.call(arguments,1),n="function"==typeof e?e:function(){this[e].apply(this,t)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(n),this};var R={on:function(e,t,n){if("object"==typeof e)for(var r in e)this._on(r,e[r],t);else for(var i=0,a=(e=h(e)).length;i<a;i++)this._on(e[i],t,n);return this},off:function(e,t,n){if(arguments.length)if("object"==typeof e)for(var r in e)this._off(r,e[r],t);else{e=h(e);for(var i=1===arguments.length,a=0,s=e.length;a<s;a++)i?this._off(e[a]):this._off(e[a],t,n)}else delete this._events;return this},_on:function(e,t,n,r){if("function"==typeof t){if(!1===this._listens(e,t,n)){n===this&&(n=void 0);var i={fn:t,ctx:n};r&&(i.once=!0),this._events=this._events||{},this._events[e]=this._events[e]||[],this._events[e].push(i)}}else console.warn("wrong listener type: "+typeof t)},_off:function(e,t,n){var r,i,a;if(this._events&&(r=this._events[e]))if(1!==arguments.length)if("function"==typeof t){var s=this._listens(e,t,n);if(!1!==s){var o=r[s];this._firingCount&&(o.fn=u,this._events[e]=r=r.slice()),r.splice(s,1)}}else console.warn("wrong listener type: "+typeof t);else{if(this._firingCount)for(i=0,a=r.length;i<a;i++)r[i].fn=u;delete this._events[e]}},fire:function(e,t,r){if(!this.listens(e,r))return this;var i=n({},t,{type:e,target:this,sourceTarget:t&&t.sourceTarget||this});if(this._events){var a=this._events[e];if(a){this._firingCount=this._firingCount+1||1;for(var s=0,o=a.length;s<o;s++){var l=a[s],u=l.fn;l.once&&this.off(e,u,l.ctx),u.call(l.ctx||this,i)}this._firingCount--}}return r&&this._propagateEvent(i),this},listens:function(e,t,n,r){"string"!=typeof e&&console.warn('"string" type argument expected');var i=t;"function"!=typeof t&&(r=!!t,i=void 0,n=void 0);var a=this._events&&this._events[e];if(a&&a.length&&!1!==this._listens(e,i,n))return!0;if(r)for(var s in this._eventParents)if(this._eventParents[s].listens(e,t,n,r))return!0;return!1},_listens:function(e,t,n){if(!this._events)return!1;var r=this._events[e]||[];if(!t)return!!r.length;n===this&&(n=void 0);for(var i=0,a=r.length;i<a;i++)if(r[i].fn===t&&r[i].ctx===n)return i;return!1},once:function(e,t,n){if("object"==typeof e)for(var r in e)this._on(r,e[r],t,!0);else for(var i=0,a=(e=h(e)).length;i<a;i++)this._on(e[i],t,n,!0);return this},addEventParent:function(e){return this._eventParents=this._eventParents||{},this._eventParents[s(e)]=e,this},removeEventParent:function(e){return this._eventParents&&delete this._eventParents[s(e)],this},_propagateEvent:function(e){for(var t in this._eventParents)this._eventParents[t].fire(e.type,n({layer:e.target,propagatedFrom:e.target},e),!0)}};R.addEventListener=R.on,R.removeEventListener=R.clearAllEventListeners=R.off,R.addOneTimeEventListener=R.once,R.fireEvent=R.fire,R.hasEventListeners=R.listens;var k=A.extend(R);function D(e,t,n){this.x=n?Math.round(e):e,this.y=n?Math.round(t):t}var I=Math.trunc||function(e){return e>0?Math.floor(e):Math.ceil(e)};function O(e,t,n){return e instanceof D?e:v(e)?new D(e[0],e[1]):null==e?e:"object"==typeof e&&"x"in e&&"y"in e?new D(e.x,e.y):new D(e,t,n)}function N(e,t){if(e)for(var n=t?[e,t]:e,r=0,i=n.length;r<i;r++)this.extend(n[r])}function B(e,t){return!e||e instanceof N?e:new N(e,t)}function U(e,t){if(e)for(var n=t?[e,t]:e,r=0,i=n.length;r<i;r++)this.extend(n[r])}function z(e,t){return e instanceof U?e:new U(e,t)}function F(e,t,n){if(isNaN(e)||isNaN(t))throw new Error("Invalid LatLng object: ("+e+", "+t+")");this.lat=+e,this.lng=+t,void 0!==n&&(this.alt=+n)}function V(e,t,n){return e instanceof F?e:v(e)&&"object"!=typeof e[0]?3===e.length?new F(e[0],e[1],e[2]):2===e.length?new F(e[0],e[1]):null:null==e?e:"object"==typeof e&&"lat"in e?new F(e.lat,"lng"in e?e.lng:e.lon,e.alt):void 0===t?null:new F(e,t,n)}D.prototype={clone:function(){return new D(this.x,this.y)},add:function(e){return this.clone()._add(O(e))},_add:function(e){return this.x+=e.x,this.y+=e.y,this},subtract:function(e){return this.clone()._subtract(O(e))},_subtract:function(e){return this.x-=e.x,this.y-=e.y,this},divideBy:function(e){return this.clone()._divideBy(e)},_divideBy:function(e){return this.x/=e,this.y/=e,this},multiplyBy:function(e){return this.clone()._multiplyBy(e)},_multiplyBy:function(e){return this.x*=e,this.y*=e,this},scaleBy:function(e){return new D(this.x*e.x,this.y*e.y)},unscaleBy:function(e){return new D(this.x/e.x,this.y/e.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=I(this.x),this.y=I(this.y),this},distanceTo:function(e){var t=(e=O(e)).x-this.x,n=e.y-this.y;return Math.sqrt(t*t+n*n)},equals:function(e){return(e=O(e)).x===this.x&&e.y===this.y},contains:function(e){return e=O(e),Math.abs(e.x)<=Math.abs(this.x)&&Math.abs(e.y)<=Math.abs(this.y)},toString:function(){return"Point("+c(this.x)+", "+c(this.y)+")"}},N.prototype={extend:function(e){var t,n;if(!e)return this;if(e instanceof D||"number"==typeof e[0]||"x"in e)t=n=O(e);else if(t=(e=B(e)).min,n=e.max,!t||!n)return this;return this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(n.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(n.y,this.max.y)):(this.min=t.clone(),this.max=n.clone()),this},getCenter:function(e){return O((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,e)},getBottomLeft:function(){return O(this.min.x,this.max.y)},getTopRight:function(){return O(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(e){var t,n;return(e="number"==typeof e[0]||e instanceof D?O(e):B(e))instanceof N?(t=e.min,n=e.max):t=n=e,t.x>=this.min.x&&n.x<=this.max.x&&t.y>=this.min.y&&n.y<=this.max.y},intersects:function(e){e=B(e);var t=this.min,n=this.max,r=e.min,i=e.max,a=i.x>=t.x&&r.x<=n.x,s=i.y>=t.y&&r.y<=n.y;return a&&s},overlaps:function(e){e=B(e);var t=this.min,n=this.max,r=e.min,i=e.max,a=i.x>t.x&&r.x<n.x,s=i.y>t.y&&r.y<n.y;return a&&s},isValid:function(){return!(!this.min||!this.max)},pad:function(e){var t=this.min,n=this.max,r=Math.abs(t.x-n.x)*e,i=Math.abs(t.y-n.y)*e;return B(O(t.x-r,t.y-i),O(n.x+r,n.y+i))},equals:function(e){return!!e&&(e=B(e),this.min.equals(e.getTopLeft())&&this.max.equals(e.getBottomRight()))}},U.prototype={extend:function(e){var t,n,r=this._southWest,i=this._northEast;if(e instanceof F)t=e,n=e;else{if(!(e instanceof U))return e?this.extend(V(e)||z(e)):this;if(t=e._southWest,n=e._northEast,!t||!n)return this}return r||i?(r.lat=Math.min(t.lat,r.lat),r.lng=Math.min(t.lng,r.lng),i.lat=Math.max(n.lat,i.lat),i.lng=Math.max(n.lng,i.lng)):(this._southWest=new F(t.lat,t.lng),this._northEast=new F(n.lat,n.lng)),this},pad:function(e){var t=this._southWest,n=this._northEast,r=Math.abs(t.lat-n.lat)*e,i=Math.abs(t.lng-n.lng)*e;return new U(new F(t.lat-r,t.lng-i),new F(n.lat+r,n.lng+i))},getCenter:function(){return new F((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new F(this.getNorth(),this.getWest())},getSouthEast:function(){return new F(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(e){e="number"==typeof e[0]||e instanceof F||"lat"in e?V(e):z(e);var t,n,r=this._southWest,i=this._northEast;return e instanceof U?(t=e.getSouthWest(),n=e.getNorthEast()):t=n=e,t.lat>=r.lat&&n.lat<=i.lat&&t.lng>=r.lng&&n.lng<=i.lng},intersects:function(e){e=z(e);var t=this._southWest,n=this._northEast,r=e.getSouthWest(),i=e.getNorthEast(),a=i.lat>=t.lat&&r.lat<=n.lat,s=i.lng>=t.lng&&r.lng<=n.lng;return a&&s},overlaps:function(e){e=z(e);var t=this._southWest,n=this._northEast,r=e.getSouthWest(),i=e.getNorthEast(),a=i.lat>t.lat&&r.lat<n.lat,s=i.lng>t.lng&&r.lng<n.lng;return a&&s},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(e,t){return!!e&&(e=z(e),this._southWest.equals(e.getSouthWest(),t)&&this._northEast.equals(e.getNorthEast(),t))},isValid:function(){return!(!this._southWest||!this._northEast)}},F.prototype={equals:function(e,t){return!!e&&(e=V(e),Math.max(Math.abs(this.lat-e.lat),Math.abs(this.lng-e.lng))<=(void 0===t?1e-9:t))},toString:function(e){return"LatLng("+c(this.lat,e)+", "+c(this.lng,e)+")"},distanceTo:function(e){return j.distance(this,V(e))},wrap:function(){return j.wrapLatLng(this)},toBounds:function(e){var t=180*e/40075017,n=t/Math.cos(Math.PI/180*this.lat);return z([this.lat-t,this.lng-n],[this.lat+t,this.lng+n])},clone:function(){return new F(this.lat,this.lng,this.alt)}};var G,H={latLngToPoint:function(e,t){var n=this.projection.project(e),r=this.scale(t);return this.transformation._transform(n,r)},pointToLatLng:function(e,t){var n=this.scale(t),r=this.transformation.untransform(e,n);return this.projection.unproject(r)},project:function(e){return this.projection.project(e)},unproject:function(e){return this.projection.unproject(e)},scale:function(e){return 256*Math.pow(2,e)},zoom:function(e){return Math.log(e/256)/Math.LN2},getProjectedBounds:function(e){if(this.infinite)return null;var t=this.projection.bounds,n=this.scale(e);return new N(this.transformation.transform(t.min,n),this.transformation.transform(t.max,n))},infinite:!1,wrapLatLng:function(e){var t=this.wrapLng?l(e.lng,this.wrapLng,!0):e.lng;return new F(this.wrapLat?l(e.lat,this.wrapLat,!0):e.lat,t,e.alt)},wrapLatLngBounds:function(e){var t=e.getCenter(),n=this.wrapLatLng(t),r=t.lat-n.lat,i=t.lng-n.lng;if(0===r&&0===i)return e;var a=e.getSouthWest(),s=e.getNorthEast();return new U(new F(a.lat-r,a.lng-i),new F(s.lat-r,s.lng-i))}},j=n({},H,{wrapLng:[-180,180],R:6371e3,distance:function(e,t){var n=Math.PI/180,r=e.lat*n,i=t.lat*n,a=Math.sin((t.lat-e.lat)*n/2),s=Math.sin((t.lng-e.lng)*n/2),o=a*a+Math.cos(r)*Math.cos(i)*s*s,l=2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o));return this.R*l}}),W=6378137,Y={R:W,MAX_LATITUDE:85.0511287798,project:function(e){var t=Math.PI/180,n=this.MAX_LATITUDE,r=Math.max(Math.min(n,e.lat),-n),i=Math.sin(r*t);return new D(this.R*e.lng*t,this.R*Math.log((1+i)/(1-i))/2)},unproject:function(e){var t=180/Math.PI;return new F((2*Math.atan(Math.exp(e.y/this.R))-Math.PI/2)*t,e.x*t/this.R)},bounds:(G=W*Math.PI,new N([-G,-G],[G,G]))};function $(e,t,n,r){if(v(e))return this._a=e[0],this._b=e[1],this._c=e[2],void(this._d=e[3]);this._a=e,this._b=t,this._c=n,this._d=r}function X(e,t,n,r){return new $(e,t,n,r)}$.prototype={transform:function(e,t){return this._transform(e.clone(),t)},_transform:function(e,t){return t=t||1,e.x=t*(this._a*e.x+this._b),e.y=t*(this._c*e.y+this._d),e},untransform:function(e,t){return t=t||1,new D((e.x/t-this._b)/this._a,(e.y/t-this._d)/this._c)}};var q,K=n({},j,{code:"EPSG:3857",projection:Y,transformation:(q=.5/(Math.PI*Y.R),X(q,.5,-q,.5))}),Z=n({},K,{code:"EPSG:900913"});function J(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function Q(e,t){var n,r,i,a,s,o,l="";for(n=0,i=e.length;n<i;n++){for(r=0,a=(s=e[n]).length;r<a;r++)l+=(r?"L":"M")+(o=s[r]).x+" "+o.y;l+=t?ze.svg?"z":"x":""}return l||"M0 0"}var ee,te=document.documentElement.style,ne="ActiveXObject"in window,re=ne&&!document.addEventListener,ie="msLaunchUri"in navigator&&!("documentMode"in document),ae=Ue("webkit"),se=Ue("android"),oe=Ue("android 2")||Ue("android 3"),le=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),ue=se&&Ue("Google")&&le<537&&!("AudioNode"in window),ce=!!window.opera,de=!ie&&Ue("chrome"),he=Ue("gecko")&&!ae&&!ce&&!ne,pe=!de&&Ue("safari"),fe=Ue("phantom"),me="OTransition"in te,ge=0===navigator.platform.indexOf("Win"),ve=ne&&"transition"in te,ye="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!oe,_e="MozPerspective"in te,be=!window.L_DISABLE_3D&&(ve||ye||_e)&&!me&&!fe,xe="undefined"!=typeof orientation||Ue("mobile"),we=xe&&ae,Se=xe&&ye,Ce=!window.PointerEvent&&window.MSPointerEvent,Te=!(!window.PointerEvent&&!Ce),Me="ontouchstart"in window||!!window.TouchEvent,Ee=!window.L_NO_TOUCH&&(Me||Te),Ae=xe&&ce,Pe=xe&&he,Re=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Le=function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("testPassiveEventSupport",u,t),window.removeEventListener("testPassiveEventSupport",u,t)}catch(zA){}return e}(),ke=!!document.createElement("canvas").getContext,De=!(!document.createElementNS||!J("svg").createSVGRect),Ie=!!De&&((ee=document.createElement("div")).innerHTML="<svg/>","http://www.w3.org/2000/svg"===(ee.firstChild&&ee.firstChild.namespaceURI)),Oe=!De&&function(){try{var e=document.createElement("div");e.innerHTML='<v:shape adj="1"/>';var t=e.firstChild;return t.style.behavior="url(#default#VML)",t&&"object"==typeof t.adj}catch(zA){return!1}}(),Ne=0===navigator.platform.indexOf("Mac"),Be=0===navigator.platform.indexOf("Linux");function Ue(e){return navigator.userAgent.toLowerCase().indexOf(e)>=0}var ze={ie:ne,ielt9:re,edge:ie,webkit:ae,android:se,android23:oe,androidStock:ue,opera:ce,chrome:de,gecko:he,safari:pe,phantom:fe,opera12:me,win:ge,ie3d:ve,webkit3d:ye,gecko3d:_e,any3d:be,mobile:xe,mobileWebkit:we,mobileWebkit3d:Se,msPointer:Ce,pointer:Te,touch:Ee,touchNative:Me,mobileOpera:Ae,mobileGecko:Pe,retina:Re,passiveEvents:Le,canvas:ke,svg:De,vml:Oe,inlineSvg:Ie,mac:Ne,linux:Be},Fe=ze.msPointer?"MSPointerDown":"pointerdown",Ve=ze.msPointer?"MSPointerMove":"pointermove",Ge=ze.msPointer?"MSPointerUp":"pointerup",He=ze.msPointer?"MSPointerCancel":"pointercancel",je={touchstart:Fe,touchmove:Ve,touchend:Ge,touchcancel:He},We={touchstart:tt,touchmove:et,touchend:et,touchcancel:et},Ye={},$e=!1;function Xe(e,t,n){return"touchstart"===t&&Qe(),We[t]?(n=We[t].bind(this,n),e.addEventListener(je[t],n,!1),n):(console.warn("wrong event specified:",t),u)}function qe(e,t,n){je[t]?e.removeEventListener(je[t],n,!1):console.warn("wrong event specified:",t)}function Ke(e){Ye[e.pointerId]=e}function Ze(e){Ye[e.pointerId]&&(Ye[e.pointerId]=e)}function Je(e){delete Ye[e.pointerId]}function Qe(){$e||(document.addEventListener(Fe,Ke,!0),document.addEventListener(Ve,Ze,!0),document.addEventListener(Ge,Je,!0),document.addEventListener(He,Je,!0),$e=!0)}function et(e,t){if(t.pointerType!==(t.MSPOINTER_TYPE_MOUSE||"mouse")){for(var n in t.touches=[],Ye)t.touches.push(Ye[n]);t.changedTouches=[t],e(t)}}function tt(e,t){t.MSPOINTER_TYPE_TOUCH&&t.pointerType===t.MSPOINTER_TYPE_TOUCH&&Kt(t),et(e,t)}function nt(e){var t,n,r={};for(n in e)t=e[n],r[n]=t&&t.bind?t.bind(e):t;return e=r,r.type="dblclick",r.detail=2,r.isTrusted=!1,r._simulated=!0,r}var rt=200;function it(e,t){e.addEventListener("dblclick",t);var n,r=0;function i(e){if(1===e.detail){if("mouse"!==e.pointerType&&(!e.sourceCapabilities||e.sourceCapabilities.firesTouchEvents)){var i=Jt(e);if(!i.some((function(e){return e instanceof HTMLLabelElement&&e.attributes.for}))||i.some((function(e){return e instanceof HTMLInputElement||e instanceof HTMLSelectElement}))){var a=Date.now();a-r<=rt?2==++n&&t(nt(e)):n=1,r=a}}}else n=e.detail}return e.addEventListener("click",i),{dblclick:t,simDblclick:i}}function at(e,t){e.removeEventListener("dblclick",t.dblclick),e.removeEventListener("click",t.simDblclick)}var st,ot,lt,ut,ct,dt=At(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),ht=At(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),pt="webkitTransition"===ht||"OTransition"===ht?ht+"End":"transitionend";function ft(e){return"string"==typeof e?document.getElementById(e):e}function mt(e,t){var n=e.style[t]||e.currentStyle&&e.currentStyle[t];if((!n||"auto"===n)&&document.defaultView){var r=document.defaultView.getComputedStyle(e,null);n=r?r[t]:null}return"auto"===n?null:n}function gt(e,t,n){var r=document.createElement(e);return r.className=t||"",n&&n.appendChild(r),r}function vt(e){var t=e.parentNode;t&&t.removeChild(e)}function yt(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function _t(e){var t=e.parentNode;t&&t.lastChild!==e&&t.appendChild(e)}function bt(e){var t=e.parentNode;t&&t.firstChild!==e&&t.insertBefore(e,t.firstChild)}function xt(e,t){if(void 0!==e.classList)return e.classList.contains(t);var n=Tt(e);return n.length>0&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(n)}function wt(e,t){if(void 0!==e.classList)for(var n=h(t),r=0,i=n.length;r<i;r++)e.classList.add(n[r]);else if(!xt(e,t)){var a=Tt(e);Ct(e,(a?a+" ":"")+t)}}function St(e,t){void 0!==e.classList?e.classList.remove(t):Ct(e,d((" "+Tt(e)+" ").replace(" "+t+" "," ")))}function Ct(e,t){void 0===e.className.baseVal?e.className=t:e.className.baseVal=t}function Tt(e){return e.correspondingElement&&(e=e.correspondingElement),void 0===e.className.baseVal?e.className:e.className.baseVal}function Mt(e,t){"opacity"in e.style?e.style.opacity=t:"filter"in e.style&&Et(e,t)}function Et(e,t){var n=!1,r="DXImageTransform.Microsoft.Alpha";try{n=e.filters.item(r)}catch(zA){if(1===t)return}t=Math.round(100*t),n?(n.Enabled=100!==t,n.Opacity=t):e.style.filter+=" progid:"+r+"(opacity="+t+")"}function At(e){for(var t=document.documentElement.style,n=0;n<e.length;n++)if(e[n]in t)return e[n];return!1}function Pt(e,t,n){var r=t||new D(0,0);e.style[dt]=(ze.ie3d?"translate("+r.x+"px,"+r.y+"px)":"translate3d("+r.x+"px,"+r.y+"px,0)")+(n?" scale("+n+")":"")}function Rt(e,t){e._leaflet_pos=t,ze.any3d?Pt(e,t):(e.style.left=t.x+"px",e.style.top=t.y+"px")}function Lt(e){return e._leaflet_pos||new D(0,0)}if("onselectstart"in document)st=function(){Ft(window,"selectstart",Kt)},ot=function(){Gt(window,"selectstart",Kt)};else{var kt=At(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);st=function(){if(kt){var e=document.documentElement.style;lt=e[kt],e[kt]="none"}},ot=function(){kt&&(document.documentElement.style[kt]=lt,lt=void 0)}}function Dt(){Ft(window,"dragstart",Kt)}function It(){Gt(window,"dragstart",Kt)}function Ot(e){for(;-1===e.tabIndex;)e=e.parentNode;e.style&&(Nt(),ut=e,ct=e.style.outlineStyle,e.style.outlineStyle="none",Ft(window,"keydown",Nt))}function Nt(){ut&&(ut.style.outlineStyle=ct,ut=void 0,ct=void 0,Gt(window,"keydown",Nt))}function Bt(e){do{e=e.parentNode}while(!(e.offsetWidth&&e.offsetHeight||e===document.body));return e}function Ut(e){var t=e.getBoundingClientRect();return{x:t.width/e.offsetWidth||1,y:t.height/e.offsetHeight||1,boundingClientRect:t}}var zt={__proto__:null,TRANSFORM:dt,TRANSITION:ht,TRANSITION_END:pt,get:ft,getStyle:mt,create:gt,remove:vt,empty:yt,toFront:_t,toBack:bt,hasClass:xt,addClass:wt,removeClass:St,setClass:Ct,getClass:Tt,setOpacity:Mt,testProp:At,setTransform:Pt,setPosition:Rt,getPosition:Lt,get disableTextSelection(){return st},get enableTextSelection(){return ot},disableImageDrag:Dt,enableImageDrag:It,preventOutline:Ot,restoreOutline:Nt,getSizedParentNode:Bt,getScale:Ut};function Ft(e,t,n,r){if(t&&"object"==typeof t)for(var i in t)Wt(e,i,t[i],n);else for(var a=0,s=(t=h(t)).length;a<s;a++)Wt(e,t[a],n,r);return this}var Vt="_leaflet_events";function Gt(e,t,n,r){if(1===arguments.length)Ht(e),delete e[Vt];else if(t&&"object"==typeof t)for(var i in t)Yt(e,i,t[i],n);else if(t=h(t),2===arguments.length)Ht(e,(function(e){return-1!==y(t,e)}));else for(var a=0,s=t.length;a<s;a++)Yt(e,t[a],n,r);return this}function Ht(e,t){for(var n in e[Vt]){var r=n.split(/\d/)[0];t&&!t(r)||Yt(e,r,null,null,n)}}var jt={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Wt(e,t,n,r){var i=t+s(n)+(r?"_"+s(r):"");if(e[Vt]&&e[Vt][i])return this;var a=function(t){return n.call(r||e,t||window.event)},o=a;!ze.touchNative&&ze.pointer&&0===t.indexOf("touch")?a=Xe(e,t,a):ze.touch&&"dblclick"===t?a=it(e,a):"addEventListener"in e?"touchstart"===t||"touchmove"===t||"wheel"===t||"mousewheel"===t?e.addEventListener(jt[t]||t,a,!!ze.passiveEvents&&{passive:!1}):"mouseenter"===t||"mouseleave"===t?(a=function(t){t=t||window.event,nn(e,t)&&o(t)},e.addEventListener(jt[t],a,!1)):e.addEventListener(t,o,!1):e.attachEvent("on"+t,a),e[Vt]=e[Vt]||{},e[Vt][i]=a}function Yt(e,t,n,r,i){i=i||t+s(n)+(r?"_"+s(r):"");var a=e[Vt]&&e[Vt][i];if(!a)return this;!ze.touchNative&&ze.pointer&&0===t.indexOf("touch")?qe(e,t,a):ze.touch&&"dblclick"===t?at(e,a):"removeEventListener"in e?e.removeEventListener(jt[t]||t,a,!1):e.detachEvent("on"+t,a),e[Vt][i]=null}function $t(e){return e.stopPropagation?e.stopPropagation():e.originalEvent?e.originalEvent._stopped=!0:e.cancelBubble=!0,this}function Xt(e){return Wt(e,"wheel",$t),this}function qt(e){return Ft(e,"mousedown touchstart dblclick contextmenu",$t),e._leaflet_disable_click=!0,this}function Kt(e){return e.preventDefault?e.preventDefault():e.returnValue=!1,this}function Zt(e){return Kt(e),$t(e),this}function Jt(e){if(e.composedPath)return e.composedPath();for(var t=[],n=e.target;n;)t.push(n),n=n.parentNode;return t}function Qt(e,t){if(!t)return new D(e.clientX,e.clientY);var n=Ut(t),r=n.boundingClientRect;return new D((e.clientX-r.left)/n.x-t.clientLeft,(e.clientY-r.top)/n.y-t.clientTop)}var en=ze.linux&&ze.chrome?window.devicePixelRatio:ze.mac?3*window.devicePixelRatio:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function tn(e){return ze.edge?e.wheelDeltaY/2:e.deltaY&&0===e.deltaMode?-e.deltaY/en:e.deltaY&&1===e.deltaMode?20*-e.deltaY:e.deltaY&&2===e.deltaMode?60*-e.deltaY:e.deltaX||e.deltaZ?0:e.wheelDelta?(e.wheelDeltaY||e.wheelDelta)/2:e.detail&&Math.abs(e.detail)<32765?20*-e.detail:e.detail?e.detail/-32765*60:0}function nn(e,t){var n=t.relatedTarget;if(!n)return!0;try{for(;n&&n!==e;)n=n.parentNode}catch(r){return!1}return n!==e}var rn={__proto__:null,on:Ft,off:Gt,stopPropagation:$t,disableScrollPropagation:Xt,disableClickPropagation:qt,preventDefault:Kt,stop:Zt,getPropagationPath:Jt,getMousePosition:Qt,getWheelDelta:tn,isExternalTarget:nn,addListener:Ft,removeListener:Gt},an=k.extend({run:function(e,t,n,r){this.stop(),this._el=e,this._inProgress=!0,this._duration=n||.25,this._easeOutPower=1/Math.max(r||.5,.2),this._startPos=Lt(e),this._offset=t.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=T(this._animate,this),this._step()},_step:function(e){var t=+new Date-this._startTime,n=1e3*this._duration;t<n?this._runFrame(this._easeOut(t/n),e):(this._runFrame(1),this._complete())},_runFrame:function(e,t){var n=this._startPos.add(this._offset.multiplyBy(e));t&&n._round(),Rt(this._el,n),this.fire("step")},_complete:function(){M(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(e){return 1-Math.pow(1-e,this._easeOutPower)}}),sn=k.extend({options:{crs:K,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(e,t){t=p(this,t),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(e),this._initLayout(),this._onResize=i(this._onResize,this),this._initEvents(),t.maxBounds&&this.setMaxBounds(t.maxBounds),void 0!==t.zoom&&(this._zoom=this._limitZoom(t.zoom)),t.center&&void 0!==t.zoom&&this.setView(V(t.center),t.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=ht&&ze.any3d&&!ze.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Ft(this._proxy,pt,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(e,t,r){return t=void 0===t?this._zoom:this._limitZoom(t),e=this._limitCenter(V(e),t,this.options.maxBounds),r=r||{},this._stop(),this._loaded&&!r.reset&&!0!==r&&(void 0!==r.animate&&(r.zoom=n({animate:r.animate},r.zoom),r.pan=n({animate:r.animate,duration:r.duration},r.pan)),this._zoom!==t?this._tryAnimatedZoom&&this._tryAnimatedZoom(e,t,r.zoom):this._tryAnimatedPan(e,r.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(e,t,r.pan&&r.pan.noMoveStart),this)},setZoom:function(e,t){return this._loaded?this.setView(this.getCenter(),e,{zoom:t}):(this._zoom=e,this)},zoomIn:function(e,t){return e=e||(ze.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+e,t)},zoomOut:function(e,t){return e=e||(ze.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-e,t)},setZoomAround:function(e,t,n){var r=this.getZoomScale(t),i=this.getSize().divideBy(2),a=(e instanceof D?e:this.latLngToContainerPoint(e)).subtract(i).multiplyBy(1-1/r),s=this.containerPointToLatLng(i.add(a));return this.setView(s,t,{zoom:n})},_getBoundsCenterZoom:function(e,t){t=t||{},e=e.getBounds?e.getBounds():z(e);var n=O(t.paddingTopLeft||t.padding||[0,0]),r=O(t.paddingBottomRight||t.padding||[0,0]),i=this.getBoundsZoom(e,!1,n.add(r));if((i="number"==typeof t.maxZoom?Math.min(t.maxZoom,i):i)===1/0)return{center:e.getCenter(),zoom:i};var a=r.subtract(n).divideBy(2),s=this.project(e.getSouthWest(),i),o=this.project(e.getNorthEast(),i);return{center:this.unproject(s.add(o).divideBy(2).add(a),i),zoom:i}},fitBounds:function(e,t){if(!(e=z(e)).isValid())throw new Error("Bounds are not valid.");var n=this._getBoundsCenterZoom(e,t);return this.setView(n.center,n.zoom,t)},fitWorld:function(e){return this.fitBounds([[-90,-180],[90,180]],e)},panTo:function(e,t){return this.setView(e,this._zoom,{pan:t})},panBy:function(e,t){if(t=t||{},!(e=O(e).round()).x&&!e.y)return this.fire("moveend");if(!0!==t.animate&&!this.getSize().contains(e))return this._resetView(this.unproject(this.project(this.getCenter()).add(e)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new an,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),t.noMoveStart||this.fire("movestart"),!1!==t.animate){wt(this._mapPane,"leaflet-pan-anim");var n=this._getMapPanePos().subtract(e).round();this._panAnim.run(this._mapPane,n,t.duration||.25,t.easeLinearity)}else this._rawPanBy(e),this.fire("move").fire("moveend");return this},flyTo:function(e,t,n){if(!1===(n=n||{}).animate||!ze.any3d)return this.setView(e,t,n);this._stop();var r=this.project(this.getCenter()),i=this.project(e),a=this.getSize(),s=this._zoom;e=V(e),t=void 0===t?s:t;var o=Math.max(a.x,a.y),l=o*this.getZoomScale(s,t),u=i.distanceTo(r)||1,c=1.42,d=c*c;function h(e){var t=(l*l-o*o+(e?-1:1)*d*d*u*u)/(2*(e?l:o)*d*u),n=Math.sqrt(t*t+1)-t;return n<1e-9?-18:Math.log(n)}function p(e){return(Math.exp(e)-Math.exp(-e))/2}function f(e){return(Math.exp(e)+Math.exp(-e))/2}function m(e){return p(e)/f(e)}var g=h(0);function v(e){return o*(f(g)/f(g+c*e))}function y(e){return o*(f(g)*m(g+c*e)-p(g))/d}function _(e){return 1-Math.pow(1-e,1.5)}var b=Date.now(),x=(h(1)-g)/c,w=n.duration?1e3*n.duration:1e3*x*.8;function S(){var n=(Date.now()-b)/w,a=_(n)*x;n<=1?(this._flyToFrame=T(S,this),this._move(this.unproject(r.add(i.subtract(r).multiplyBy(y(a)/u)),s),this.getScaleZoom(o/v(a),s),{flyTo:!0})):this._move(e,t)._moveEnd(!0)}return this._moveStart(!0,n.noMoveStart),S.call(this),this},flyToBounds:function(e,t){var n=this._getBoundsCenterZoom(e,t);return this.flyTo(n.center,n.zoom,t)},setMaxBounds:function(e){return e=z(e),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),e.isValid()?(this.options.maxBounds=e,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(e){var t=this.options.minZoom;return this.options.minZoom=e,this._loaded&&t!==e&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(e):this},setMaxZoom:function(e){var t=this.options.maxZoom;return this.options.maxZoom=e,this._loaded&&t!==e&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(e):this},panInsideBounds:function(e,t){this._enforcingBounds=!0;var n=this.getCenter(),r=this._limitCenter(n,this._zoom,z(e));return n.equals(r)||this.panTo(r,t),this._enforcingBounds=!1,this},panInside:function(e,t){var n=O((t=t||{}).paddingTopLeft||t.padding||[0,0]),r=O(t.paddingBottomRight||t.padding||[0,0]),i=this.project(this.getCenter()),a=this.project(e),s=this.getPixelBounds(),o=B([s.min.add(n),s.max.subtract(r)]),l=o.getSize();if(!o.contains(a)){this._enforcingBounds=!0;var u=a.subtract(o.getCenter()),c=o.extend(a).getSize().subtract(l);i.x+=u.x<0?-c.x:c.x,i.y+=u.y<0?-c.y:c.y,this.panTo(this.unproject(i),t),this._enforcingBounds=!1}return this},invalidateSize:function(e){if(!this._loaded)return this;e=n({animate:!1,pan:!0},!0===e?{animate:!0}:e);var t=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var r=this.getSize(),a=t.divideBy(2).round(),s=r.divideBy(2).round(),o=a.subtract(s);return o.x||o.y?(e.animate&&e.pan?this.panBy(o):(e.pan&&this._rawPanBy(o),this.fire("move"),e.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(i(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:t,newSize:r})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(e){if(e=this._locateOptions=n({timeout:1e4,watch:!1},e),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var t=i(this._handleGeolocationResponse,this),r=i(this._handleGeolocationError,this);return e.watch?this._locationWatchId=navigator.geolocation.watchPosition(t,r,e):navigator.geolocation.getCurrentPosition(t,r,e),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(e){if(this._container._leaflet_id){var t=e.code,n=e.message||(1===t?"permission denied":2===t?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:t,message:"Geolocation error: "+n+"."})}},_handleGeolocationResponse:function(e){if(this._container._leaflet_id){var t=new F(e.coords.latitude,e.coords.longitude),n=t.toBounds(2*e.coords.accuracy),r=this._locateOptions;if(r.setView){var i=this.getBoundsZoom(n);this.setView(t,r.maxZoom?Math.min(i,r.maxZoom):i)}var a={latlng:t,bounds:n,timestamp:e.timestamp};for(var s in e.coords)"number"==typeof e.coords[s]&&(a[s]=e.coords[s]);this.fire("locationfound",a)}},addHandler:function(e,t){if(!t)return this;var n=this[e]=new t(this);return this._handlers.push(n),this.options[e]&&n.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(zA){this._container._leaflet_id=void 0,this._containerId=void 0}var e;for(e in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),vt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(M(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[e].remove();for(e in this._panes)vt(this._panes[e]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(e,t){var n=gt("div","leaflet-pane"+(e?" leaflet-"+e.replace("Pane","")+"-pane":""),t||this._mapPane);return e&&(this._panes[e]=n),n},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var e=this.getPixelBounds();return new U(this.unproject(e.getBottomLeft()),this.unproject(e.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(e,t,n){e=z(e),n=O(n||[0,0]);var r=this.getZoom()||0,i=this.getMinZoom(),a=this.getMaxZoom(),s=e.getNorthWest(),o=e.getSouthEast(),l=this.getSize().subtract(n),u=B(this.project(o,r),this.project(s,r)).getSize(),c=ze.any3d?this.options.zoomSnap:1,d=l.x/u.x,h=l.y/u.y,p=t?Math.max(d,h):Math.min(d,h);return r=this.getScaleZoom(p,r),c&&(r=Math.round(r/(c/100))*(c/100),r=t?Math.ceil(r/c)*c:Math.floor(r/c)*c),Math.max(i,Math.min(a,r))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new D(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(e,t){var n=this._getTopLeftPoint(e,t);return new N(n,n.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(e){return this.options.crs.getProjectedBounds(void 0===e?this.getZoom():e)},getPane:function(e){return"string"==typeof e?this._panes[e]:e},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(e,t){var n=this.options.crs;return t=void 0===t?this._zoom:t,n.scale(e)/n.scale(t)},getScaleZoom:function(e,t){var n=this.options.crs;t=void 0===t?this._zoom:t;var r=n.zoom(e*n.scale(t));return isNaN(r)?1/0:r},project:function(e,t){return t=void 0===t?this._zoom:t,this.options.crs.latLngToPoint(V(e),t)},unproject:function(e,t){return t=void 0===t?this._zoom:t,this.options.crs.pointToLatLng(O(e),t)},layerPointToLatLng:function(e){var t=O(e).add(this.getPixelOrigin());return this.unproject(t)},latLngToLayerPoint:function(e){return this.project(V(e))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(e){return this.options.crs.wrapLatLng(V(e))},wrapLatLngBounds:function(e){return this.options.crs.wrapLatLngBounds(z(e))},distance:function(e,t){return this.options.crs.distance(V(e),V(t))},containerPointToLayerPoint:function(e){return O(e).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(e){return O(e).add(this._getMapPanePos())},containerPointToLatLng:function(e){var t=this.containerPointToLayerPoint(O(e));return this.layerPointToLatLng(t)},latLngToContainerPoint:function(e){return this.layerPointToContainerPoint(this.latLngToLayerPoint(V(e)))},mouseEventToContainerPoint:function(e){return Qt(e,this._container)},mouseEventToLayerPoint:function(e){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(e))},mouseEventToLatLng:function(e){return this.layerPointToLatLng(this.mouseEventToLayerPoint(e))},_initContainer:function(e){var t=this._container=ft(e);if(!t)throw new Error("Map container not found.");if(t._leaflet_id)throw new Error("Map container is already initialized.");Ft(t,"scroll",this._onScroll,this),this._containerId=s(t)},_initLayout:function(){var e=this._container;this._fadeAnimated=this.options.fadeAnimation&&ze.any3d,wt(e,"leaflet-container"+(ze.touch?" leaflet-touch":"")+(ze.retina?" leaflet-retina":"")+(ze.ielt9?" leaflet-oldie":"")+(ze.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var t=mt(e,"position");"absolute"!==t&&"relative"!==t&&"fixed"!==t&&"sticky"!==t&&(e.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var e=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Rt(this._mapPane,new D(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(wt(e.markerPane,"leaflet-zoom-hide"),wt(e.shadowPane,"leaflet-zoom-hide"))},_resetView:function(e,t,n){Rt(this._mapPane,new D(0,0));var r=!this._loaded;this._loaded=!0,t=this._limitZoom(t),this.fire("viewprereset");var i=this._zoom!==t;this._moveStart(i,n)._move(e,t)._moveEnd(i),this.fire("viewreset"),r&&this.fire("load")},_moveStart:function(e,t){return e&&this.fire("zoomstart"),t||this.fire("movestart"),this},_move:function(e,t,n,r){void 0===t&&(t=this._zoom);var i=this._zoom!==t;return this._zoom=t,this._lastCenter=e,this._pixelOrigin=this._getNewPixelOrigin(e),r?n&&n.pinch&&this.fire("zoom",n):((i||n&&n.pinch)&&this.fire("zoom",n),this.fire("move",n)),this},_moveEnd:function(e){return e&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return M(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(e){Rt(this._mapPane,this._getMapPanePos().subtract(e))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(e){this._targets={},this._targets[s(this._container)]=this;var t=e?Gt:Ft;t(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&t(window,"resize",this._onResize,this),ze.any3d&&this.options.transform3DLimit&&(e?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){M(this._resizeRequest),this._resizeRequest=T((function(){this.invalidateSize({debounceMoveend:!0})}),this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var e=this._getMapPanePos();Math.max(Math.abs(e.x),Math.abs(e.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(e,t){for(var n,r=[],i="mouseout"===t||"mouseover"===t,a=e.target||e.srcElement,o=!1;a;){if((n=this._targets[s(a)])&&("click"===t||"preclick"===t)&&this._draggableMoved(n)){o=!0;break}if(n&&n.listens(t,!0)){if(i&&!nn(a,e))break;if(r.push(n),i)break}if(a===this._container)break;a=a.parentNode}return r.length||o||i||!this.listens(t,!0)||(r=[this]),r},_isClickDisabled:function(e){for(;e&&e!==this._container;){if(e._leaflet_disable_click)return!0;e=e.parentNode}},_handleDOMEvent:function(e){var t=e.target||e.srcElement;if(!(!this._loaded||t._leaflet_disable_events||"click"===e.type&&this._isClickDisabled(t))){var n=e.type;"mousedown"===n&&Ot(t),this._fireDOMEvent(e,n)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(e,t,r){if("click"===e.type){var i=n({},e);i.type="preclick",this._fireDOMEvent(i,i.type,r)}var a=this._findEventTargets(e,t);if(r){for(var s=[],o=0;o<r.length;o++)r[o].listens(t,!0)&&s.push(r[o]);a=s.concat(a)}if(a.length){"contextmenu"===t&&Kt(e);var l=a[0],u={originalEvent:e};if("keypress"!==e.type&&"keydown"!==e.type&&"keyup"!==e.type){var c=l.getLatLng&&(!l._radius||l._radius<=10);u.containerPoint=c?this.latLngToContainerPoint(l.getLatLng()):this.mouseEventToContainerPoint(e),u.layerPoint=this.containerPointToLayerPoint(u.containerPoint),u.latlng=c?l.getLatLng():this.layerPointToLatLng(u.layerPoint)}for(o=0;o<a.length;o++)if(a[o].fire(t,u,!0),u.originalEvent._stopped||!1===a[o].options.bubblingMouseEvents&&-1!==y(this._mouseEvents,t))return}},_draggableMoved:function(e){return(e=e.dragging&&e.dragging.enabled()?e:this).dragging&&e.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var e=0,t=this._handlers.length;e<t;e++)this._handlers[e].disable()},whenReady:function(e,t){return this._loaded?e.call(t||this,{target:this}):this.on("load",e,t),this},_getMapPanePos:function(){return Lt(this._mapPane)||new D(0,0)},_moved:function(){var e=this._getMapPanePos();return e&&!e.equals([0,0])},_getTopLeftPoint:function(e,t){return(e&&void 0!==t?this._getNewPixelOrigin(e,t):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(e,t){var n=this.getSize()._divideBy(2);return this.project(e,t)._subtract(n)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(e,t,n){var r=this._getNewPixelOrigin(n,t);return this.project(e,t)._subtract(r)},_latLngBoundsToNewLayerBounds:function(e,t,n){var r=this._getNewPixelOrigin(n,t);return B([this.project(e.getSouthWest(),t)._subtract(r),this.project(e.getNorthWest(),t)._subtract(r),this.project(e.getSouthEast(),t)._subtract(r),this.project(e.getNorthEast(),t)._subtract(r)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(e){return this.latLngToLayerPoint(e).subtract(this._getCenterLayerPoint())},_limitCenter:function(e,t,n){if(!n)return e;var r=this.project(e,t),i=this.getSize().divideBy(2),a=new N(r.subtract(i),r.add(i)),s=this._getBoundsOffset(a,n,t);return Math.abs(s.x)<=1&&Math.abs(s.y)<=1?e:this.unproject(r.add(s),t)},_limitOffset:function(e,t){if(!t)return e;var n=this.getPixelBounds(),r=new N(n.min.add(e),n.max.add(e));return e.add(this._getBoundsOffset(r,t))},_getBoundsOffset:function(e,t,n){var r=B(this.project(t.getNorthEast(),n),this.project(t.getSouthWest(),n)),i=r.min.subtract(e.min),a=r.max.subtract(e.max);return new D(this._rebound(i.x,-a.x),this._rebound(i.y,-a.y))},_rebound:function(e,t){return e+t>0?Math.round(e-t)/2:Math.max(0,Math.ceil(e))-Math.max(0,Math.floor(t))},_limitZoom:function(e){var t=this.getMinZoom(),n=this.getMaxZoom(),r=ze.any3d?this.options.zoomSnap:1;return r&&(e=Math.round(e/r)*r),Math.max(t,Math.min(n,e))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){St(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(e,t){var n=this._getCenterOffset(e)._trunc();return!(!0!==(t&&t.animate)&&!this.getSize().contains(n)||(this.panBy(n,t),0))},_createAnimProxy:function(){var e=this._proxy=gt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(e),this.on("zoomanim",(function(e){var t=dt,n=this._proxy.style[t];Pt(this._proxy,this.project(e.center,e.zoom),this.getZoomScale(e.zoom,1)),n===this._proxy.style[t]&&this._animatingZoom&&this._onZoomTransitionEnd()}),this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){vt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var e=this.getCenter(),t=this.getZoom();Pt(this._proxy,this.project(e,t),this.getZoomScale(t,1))},_catchTransitionEnd:function(e){this._animatingZoom&&e.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(e,t,n){if(this._animatingZoom)return!0;if(n=n||{},!this._zoomAnimated||!1===n.animate||this._nothingToAnimate()||Math.abs(t-this._zoom)>this.options.zoomAnimationThreshold)return!1;var r=this.getZoomScale(t),i=this._getCenterOffset(e)._divideBy(1-1/r);return!(!0!==n.animate&&!this.getSize().contains(i)||(T((function(){this._moveStart(!0,n.noMoveStart||!1)._animateZoom(e,t,!0)}),this),0))},_animateZoom:function(e,t,n,r){this._mapPane&&(n&&(this._animatingZoom=!0,this._animateToCenter=e,this._animateToZoom=t,wt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:e,zoom:t,noUpdate:r}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(i(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&St(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function on(e,t){return new sn(e,t)}var ln=A.extend({options:{position:"topright"},initialize:function(e){p(this,e)},getPosition:function(){return this.options.position},setPosition:function(e){var t=this._map;return t&&t.removeControl(this),this.options.position=e,t&&t.addControl(this),this},getContainer:function(){return this._container},addTo:function(e){this.remove(),this._map=e;var t=this._container=this.onAdd(e),n=this.getPosition(),r=e._controlCorners[n];return wt(t,"leaflet-control"),-1!==n.indexOf("bottom")?r.insertBefore(t,r.firstChild):r.appendChild(t),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(vt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(e){this._map&&e&&e.screenX>0&&e.screenY>0&&this._map.getContainer().focus()}}),un=function(e){return new ln(e)};sn.include({addControl:function(e){return e.addTo(this),this},removeControl:function(e){return e.remove(),this},_initControlPos:function(){var e=this._controlCorners={},t="leaflet-",n=this._controlContainer=gt("div",t+"control-container",this._container);function r(r,i){var a=t+r+" "+t+i;e[r+i]=gt("div",a,n)}r("top","left"),r("top","right"),r("bottom","left"),r("bottom","right")},_clearControlPos:function(){for(var e in this._controlCorners)vt(this._controlCorners[e]);vt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var cn=ln.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(e,t,n,r){return n<r?-1:r<n?1:0}},initialize:function(e,t,n){for(var r in p(this,n),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1,e)this._addLayer(e[r],r);for(r in t)this._addLayer(t[r],r,!0)},onAdd:function(e){this._initLayout(),this._update(),this._map=e,e.on("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(e){return ln.prototype.addTo.call(this,e),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(e,t){return this._addLayer(e,t),this._map?this._update():this},addOverlay:function(e,t){return this._addLayer(e,t,!0),this._map?this._update():this},removeLayer:function(e){e.off("add remove",this._onLayerChange,this);var t=this._getLayer(s(e));return t&&this._layers.splice(this._layers.indexOf(t),1),this._map?this._update():this},expand:function(){wt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var e=this._map.getSize().y-(this._container.offsetTop+50);return e<this._section.clientHeight?(wt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=e+"px"):St(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return St(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var e="leaflet-control-layers",t=this._container=gt("div",e),n=this.options.collapsed;t.setAttribute("aria-haspopup",!0),qt(t),Xt(t);var r=this._section=gt("section",e+"-list");n&&(this._map.on("click",this.collapse,this),Ft(t,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var i=this._layersLink=gt("a",e+"-toggle",t);i.href="#",i.title="Layers",i.setAttribute("role","button"),Ft(i,{keydown:function(e){13===e.keyCode&&this._expandSafely()},click:function(e){Kt(e),this._expandSafely()}},this),n||this.expand(),this._baseLayersList=gt("div",e+"-base",r),this._separator=gt("div",e+"-separator",r),this._overlaysList=gt("div",e+"-overlays",r),t.appendChild(r)},_getLayer:function(e){for(var t=0;t<this._layers.length;t++)if(this._layers[t]&&s(this._layers[t].layer)===e)return this._layers[t]},_addLayer:function(e,t,n){this._map&&e.on("add remove",this._onLayerChange,this),this._layers.push({layer:e,name:t,overlay:n}),this.options.sortLayers&&this._layers.sort(i((function(e,t){return this.options.sortFunction(e.layer,t.layer,e.name,t.name)}),this)),this.options.autoZIndex&&e.setZIndex&&(this._lastZIndex++,e.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;yt(this._baseLayersList),yt(this._overlaysList),this._layerControlInputs=[];var e,t,n,r,i=0;for(n=0;n<this._layers.length;n++)r=this._layers[n],this._addItem(r),t=t||r.overlay,e=e||!r.overlay,i+=r.overlay?0:1;return this.options.hideSingleBase&&(e=e&&i>1,this._baseLayersList.style.display=e?"":"none"),this._separator.style.display=t&&e?"":"none",this},_onLayerChange:function(e){this._handlingClick||this._update();var t=this._getLayer(s(e.target)),n=t.overlay?"add"===e.type?"overlayadd":"overlayremove":"add"===e.type?"baselayerchange":null;n&&this._map.fire(n,t)},_createRadioElement:function(e,t){var n='<input type="radio" class="leaflet-control-layers-selector" name="'+e+'"'+(t?' checked="checked"':"")+"/>",r=document.createElement("div");return r.innerHTML=n,r.firstChild},_addItem:function(e){var t,n=document.createElement("label"),r=this._map.hasLayer(e.layer);e.overlay?((t=document.createElement("input")).type="checkbox",t.className="leaflet-control-layers-selector",t.defaultChecked=r):t=this._createRadioElement("leaflet-base-layers_"+s(this),r),this._layerControlInputs.push(t),t.layerId=s(e.layer),Ft(t,"click",this._onInputClick,this);var i=document.createElement("span");i.innerHTML=" "+e.name;var a=document.createElement("span");return n.appendChild(a),a.appendChild(t),a.appendChild(i),(e.overlay?this._overlaysList:this._baseLayersList).appendChild(n),this._checkDisabledLayers(),n},_onInputClick:function(){if(!this._preventClick){var e,t,n=this._layerControlInputs,r=[],i=[];this._handlingClick=!0;for(var a=n.length-1;a>=0;a--)e=n[a],t=this._getLayer(e.layerId).layer,e.checked?r.push(t):e.checked||i.push(t);for(a=0;a<i.length;a++)this._map.hasLayer(i[a])&&this._map.removeLayer(i[a]);for(a=0;a<r.length;a++)this._map.hasLayer(r[a])||this._map.addLayer(r[a]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var e,t,n=this._layerControlInputs,r=this._map.getZoom(),i=n.length-1;i>=0;i--)e=n[i],t=this._getLayer(e.layerId).layer,e.disabled=void 0!==t.options.minZoom&&r<t.options.minZoom||void 0!==t.options.maxZoom&&r>t.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var e=this._section;this._preventClick=!0,Ft(e,"click",Kt),this.expand();var t=this;setTimeout((function(){Gt(e,"click",Kt),t._preventClick=!1}))}}),dn=function(e,t,n){return new cn(e,t,n)},hn=ln.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(e){var t="leaflet-control-zoom",n=gt("div",t+" leaflet-bar"),r=this.options;return this._zoomInButton=this._createButton(r.zoomInText,r.zoomInTitle,t+"-in",n,this._zoomIn),this._zoomOutButton=this._createButton(r.zoomOutText,r.zoomOutTitle,t+"-out",n,this._zoomOut),this._updateDisabled(),e.on("zoomend zoomlevelschange",this._updateDisabled,this),n},onRemove:function(e){e.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(e){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(e.shiftKey?3:1))},_zoomOut:function(e){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(e.shiftKey?3:1))},_createButton:function(e,t,n,r,i){var a=gt("a",n,r);return a.innerHTML=e,a.href="#",a.title=t,a.setAttribute("role","button"),a.setAttribute("aria-label",t),qt(a),Ft(a,"click",Zt),Ft(a,"click",i,this),Ft(a,"click",this._refocusOnMap,this),a},_updateDisabled:function(){var e=this._map,t="leaflet-disabled";St(this._zoomInButton,t),St(this._zoomOutButton,t),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||e._zoom===e.getMinZoom())&&(wt(this._zoomOutButton,t),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||e._zoom===e.getMaxZoom())&&(wt(this._zoomInButton,t),this._zoomInButton.setAttribute("aria-disabled","true"))}});sn.mergeOptions({zoomControl:!0}),sn.addInitHook((function(){this.options.zoomControl&&(this.zoomControl=new hn,this.addControl(this.zoomControl))}));var pn=function(e){return new hn(e)},fn=ln.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(e){var t="leaflet-control-scale",n=gt("div",t),r=this.options;return this._addScales(r,t+"-line",n),e.on(r.updateWhenIdle?"moveend":"move",this._update,this),e.whenReady(this._update,this),n},onRemove:function(e){e.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(e,t,n){e.metric&&(this._mScale=gt("div",t,n)),e.imperial&&(this._iScale=gt("div",t,n))},_update:function(){var e=this._map,t=e.getSize().y/2,n=e.distance(e.containerPointToLatLng([0,t]),e.containerPointToLatLng([this.options.maxWidth,t]));this._updateScales(n)},_updateScales:function(e){this.options.metric&&e&&this._updateMetric(e),this.options.imperial&&e&&this._updateImperial(e)},_updateMetric:function(e){var t=this._getRoundNum(e),n=t<1e3?t+" m":t/1e3+" km";this._updateScale(this._mScale,n,t/e)},_updateImperial:function(e){var t,n,r,i=3.2808399*e;i>5280?(t=i/5280,n=this._getRoundNum(t),this._updateScale(this._iScale,n+" mi",n/t)):(r=this._getRoundNum(i),this._updateScale(this._iScale,r+" ft",r/i))},_updateScale:function(e,t,n){e.style.width=Math.round(this.options.maxWidth*n)+"px",e.innerHTML=t},_getRoundNum:function(e){var t=Math.pow(10,(Math.floor(e)+"").length-1),n=e/t;return t*(n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:1)}}),mn=function(e){return new fn(e)},gn='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',vn=ln.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(ze.inlineSvg?gn+" ":"")+"Leaflet</a>"},initialize:function(e){p(this,e),this._attributions={}},onAdd:function(e){for(var t in e.attributionControl=this,this._container=gt("div","leaflet-control-attribution"),qt(this._container),e._layers)e._layers[t].getAttribution&&this.addAttribution(e._layers[t].getAttribution());return this._update(),e.on("layeradd",this._addAttribution,this),this._container},onRemove:function(e){e.off("layeradd",this._addAttribution,this)},_addAttribution:function(e){e.layer.getAttribution&&(this.addAttribution(e.layer.getAttribution()),e.layer.once("remove",(function(){this.removeAttribution(e.layer.getAttribution())}),this))},setPrefix:function(e){return this.options.prefix=e,this._update(),this},addAttribution:function(e){return e?(this._attributions[e]||(this._attributions[e]=0),this._attributions[e]++,this._update(),this):this},removeAttribution:function(e){return e?(this._attributions[e]&&(this._attributions[e]--,this._update()),this):this},_update:function(){if(this._map){var e=[];for(var t in this._attributions)this._attributions[t]&&e.push(t);var n=[];this.options.prefix&&n.push(this.options.prefix),e.length&&n.push(e.join(", ")),this._container.innerHTML=n.join(' <span aria-hidden="true">|</span> ')}}});sn.mergeOptions({attributionControl:!0}),sn.addInitHook((function(){this.options.attributionControl&&(new vn).addTo(this)}));var yn=function(e){return new vn(e)};ln.Layers=cn,ln.Zoom=hn,ln.Scale=fn,ln.Attribution=vn,un.layers=dn,un.zoom=pn,un.scale=mn,un.attribution=yn;var _n=A.extend({initialize:function(e){this._map=e},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});_n.addTo=function(e,t){return e.addHandler(t,this),this};var bn={Events:R},xn=ze.touch?"touchstart mousedown":"mousedown",wn=k.extend({options:{clickTolerance:3},initialize:function(e,t,n,r){p(this,r),this._element=e,this._dragStartTarget=t||e,this._preventOutline=n},enable:function(){this._enabled||(Ft(this._dragStartTarget,xn,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(wn._dragging===this&&this.finishDrag(!0),Gt(this._dragStartTarget,xn,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(e){if(this._enabled&&(this._moved=!1,!xt(this._element,"leaflet-zoom-anim")))if(e.touches&&1!==e.touches.length)wn._dragging===this&&this.finishDrag();else if(!(wn._dragging||e.shiftKey||1!==e.which&&1!==e.button&&!e.touches||(wn._dragging=this,this._preventOutline&&Ot(this._element),Dt(),st(),this._moving))){this.fire("down");var t=e.touches?e.touches[0]:e,n=Bt(this._element);this._startPoint=new D(t.clientX,t.clientY),this._startPos=Lt(this._element),this._parentScale=Ut(n);var r="mousedown"===e.type;Ft(document,r?"mousemove":"touchmove",this._onMove,this),Ft(document,r?"mouseup":"touchend touchcancel",this._onUp,this)}},_onMove:function(e){if(this._enabled)if(e.touches&&e.touches.length>1)this._moved=!0;else{var t=e.touches&&1===e.touches.length?e.touches[0]:e,n=new D(t.clientX,t.clientY)._subtract(this._startPoint);(n.x||n.y)&&(Math.abs(n.x)+Math.abs(n.y)<this.options.clickTolerance||(n.x/=this._parentScale.x,n.y/=this._parentScale.y,Kt(e),this._moved||(this.fire("dragstart"),this._moved=!0,wt(document.body,"leaflet-dragging"),this._lastTarget=e.target||e.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),wt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(n),this._moving=!0,this._lastEvent=e,this._updatePosition()))}},_updatePosition:function(){var e={originalEvent:this._lastEvent};this.fire("predrag",e),Rt(this._element,this._newPos),this.fire("drag",e)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(e){St(document.body,"leaflet-dragging"),this._lastTarget&&(St(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Gt(document,"mousemove touchmove",this._onMove,this),Gt(document,"mouseup touchend touchcancel",this._onUp,this),It(),ot();var t=this._moved&&this._moving;this._moving=!1,wn._dragging=!1,t&&this.fire("dragend",{noInertia:e,distance:this._newPos.distanceTo(this._startPos)})}});function Sn(e,t,n){var r,i,a,s,o,l,u,c,d,h=[1,4,2,8];for(i=0,u=e.length;i<u;i++)e[i]._code=Nn(e[i],t);for(s=0;s<4;s++){for(c=h[s],r=[],i=0,a=(u=e.length)-1;i<u;a=i++)o=e[i],l=e[a],o._code&c?l._code&c||((d=On(l,o,c,t,n))._code=Nn(d,t),r.push(d)):(l._code&c&&((d=On(l,o,c,t,n))._code=Nn(d,t),r.push(d)),r.push(o));e=r}return e}function Cn(e,t){var n,r,i,a,s,o,l,u,c;if(!e||0===e.length)throw new Error("latlngs not passed");zn(e)||(console.warn("latlngs are not flat! Only the first ring will be used"),e=e[0]);var d=V([0,0]),h=z(e);h.getNorthWest().distanceTo(h.getSouthWest())*h.getNorthEast().distanceTo(h.getNorthWest())<1700&&(d=Tn(e));var p=e.length,f=[];for(n=0;n<p;n++){var m=V(e[n]);f.push(t.project(V([m.lat-d.lat,m.lng-d.lng])))}for(o=l=u=0,n=0,r=p-1;n<p;r=n++)i=f[n],a=f[r],s=i.y*a.x-a.y*i.x,l+=(i.x+a.x)*s,u+=(i.y+a.y)*s,o+=3*s;c=0===o?f[0]:[l/o,u/o];var g=t.unproject(O(c));return V([g.lat+d.lat,g.lng+d.lng])}function Tn(e){for(var t=0,n=0,r=0,i=0;i<e.length;i++){var a=V(e[i]);t+=a.lat,n+=a.lng,r++}return V([t/r,n/r])}var Mn,En={__proto__:null,clipPolygon:Sn,polygonCenter:Cn,centroid:Tn};function An(e,t){if(!t||!e.length)return e.slice();var n=t*t;return e=Ln(e=Dn(e,n),n)}function Pn(e,t,n){return Math.sqrt(Un(e,t,n,!0))}function Rn(e,t,n){return Un(e,t,n)}function Ln(e,t){var n=e.length,r=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(n);r[0]=r[n-1]=1,kn(e,r,t,0,n-1);var i,a=[];for(i=0;i<n;i++)r[i]&&a.push(e[i]);return a}function kn(e,t,n,r,i){var a,s,o,l=0;for(s=r+1;s<=i-1;s++)(o=Un(e[s],e[r],e[i],!0))>l&&(a=s,l=o);l>n&&(t[a]=1,kn(e,t,n,r,a),kn(e,t,n,a,i))}function Dn(e,t){for(var n=[e[0]],r=1,i=0,a=e.length;r<a;r++)Bn(e[r],e[i])>t&&(n.push(e[r]),i=r);return i<a-1&&n.push(e[a-1]),n}function In(e,t,n,r,i){var a,s,o,l=r?Mn:Nn(e,n),u=Nn(t,n);for(Mn=u;;){if(!(l|u))return[e,t];if(l&u)return!1;o=Nn(s=On(e,t,a=l||u,n,i),n),a===l?(e=s,l=o):(t=s,u=o)}}function On(e,t,n,r,i){var a,s,o=t.x-e.x,l=t.y-e.y,u=r.min,c=r.max;return 8&n?(a=e.x+o*(c.y-e.y)/l,s=c.y):4&n?(a=e.x+o*(u.y-e.y)/l,s=u.y):2&n?(a=c.x,s=e.y+l*(c.x-e.x)/o):1&n&&(a=u.x,s=e.y+l*(u.x-e.x)/o),new D(a,s,i)}function Nn(e,t){var n=0;return e.x<t.min.x?n|=1:e.x>t.max.x&&(n|=2),e.y<t.min.y?n|=4:e.y>t.max.y&&(n|=8),n}function Bn(e,t){var n=t.x-e.x,r=t.y-e.y;return n*n+r*r}function Un(e,t,n,r){var i,a=t.x,s=t.y,o=n.x-a,l=n.y-s,u=o*o+l*l;return u>0&&((i=((e.x-a)*o+(e.y-s)*l)/u)>1?(a=n.x,s=n.y):i>0&&(a+=o*i,s+=l*i)),o=e.x-a,l=e.y-s,r?o*o+l*l:new D(a,s)}function zn(e){return!v(e[0])||"object"!=typeof e[0][0]&&void 0!==e[0][0]}function Fn(e){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),zn(e)}function Vn(e,t){var n,r,i,a,s,o,l,u;if(!e||0===e.length)throw new Error("latlngs not passed");zn(e)||(console.warn("latlngs are not flat! Only the first ring will be used"),e=e[0]);var c=V([0,0]),d=z(e);d.getNorthWest().distanceTo(d.getSouthWest())*d.getNorthEast().distanceTo(d.getNorthWest())<1700&&(c=Tn(e));var h=e.length,p=[];for(n=0;n<h;n++){var f=V(e[n]);p.push(t.project(V([f.lat-c.lat,f.lng-c.lng])))}for(n=0,r=0;n<h-1;n++)r+=p[n].distanceTo(p[n+1])/2;if(0===r)u=p[0];else for(n=0,a=0;n<h-1;n++)if(s=p[n],o=p[n+1],(a+=i=s.distanceTo(o))>r){l=(a-r)/i,u=[o.x-l*(o.x-s.x),o.y-l*(o.y-s.y)];break}var m=t.unproject(O(u));return V([m.lat+c.lat,m.lng+c.lng])}var Gn={__proto__:null,simplify:An,pointToSegmentDistance:Pn,closestPointOnSegment:Rn,clipSegment:In,_getEdgeIntersection:On,_getBitCode:Nn,_sqClosestPointOnSegment:Un,isFlat:zn,_flat:Fn,polylineCenter:Vn},Hn={project:function(e){return new D(e.lng,e.lat)},unproject:function(e){return new F(e.y,e.x)},bounds:new N([-180,-90],[180,90])},jn={R:6378137,R_MINOR:6356752.314245179,bounds:new N([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(e){var t=Math.PI/180,n=this.R,r=e.lat*t,i=this.R_MINOR/n,a=Math.sqrt(1-i*i),s=a*Math.sin(r),o=Math.tan(Math.PI/4-r/2)/Math.pow((1-s)/(1+s),a/2);return r=-n*Math.log(Math.max(o,1e-10)),new D(e.lng*t*n,r)},unproject:function(e){for(var t,n=180/Math.PI,r=this.R,i=this.R_MINOR/r,a=Math.sqrt(1-i*i),s=Math.exp(-e.y/r),o=Math.PI/2-2*Math.atan(s),l=0,u=.1;l<15&&Math.abs(u)>1e-7;l++)t=a*Math.sin(o),t=Math.pow((1-t)/(1+t),a/2),o+=u=Math.PI/2-2*Math.atan(s*t)-o;return new F(o*n,e.x*n/r)}},Wn={__proto__:null,LonLat:Hn,Mercator:jn,SphericalMercator:Y},Yn=n({},j,{code:"EPSG:3395",projection:jn,transformation:function(){var e=.5/(Math.PI*jn.R);return X(e,.5,-e,.5)}()}),$n=n({},j,{code:"EPSG:4326",projection:Hn,transformation:X(1/180,1,-1/180,.5)}),Xn=n({},H,{projection:Hn,transformation:X(1,0,-1,0),scale:function(e){return Math.pow(2,e)},zoom:function(e){return Math.log(e)/Math.LN2},distance:function(e,t){var n=t.lng-e.lng,r=t.lat-e.lat;return Math.sqrt(n*n+r*r)},infinite:!0});H.Earth=j,H.EPSG3395=Yn,H.EPSG3857=K,H.EPSG900913=Z,H.EPSG4326=$n,H.Simple=Xn;var qn=k.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(e){return e.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(e){return e&&e.removeLayer(this),this},getPane:function(e){return this._map.getPane(e?this.options[e]||e:this.options.pane)},addInteractiveTarget:function(e){return this._map._targets[s(e)]=this,this},removeInteractiveTarget:function(e){return delete this._map._targets[s(e)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(e){var t=e.target;if(t.hasLayer(this)){if(this._map=t,this._zoomAnimated=t._zoomAnimated,this.getEvents){var n=this.getEvents();t.on(n,this),this.once("remove",(function(){t.off(n,this)}),this)}this.onAdd(t),this.fire("add"),t.fire("layeradd",{layer:this})}}});sn.include({addLayer:function(e){if(!e._layerAdd)throw new Error("The provided object is not a Layer.");var t=s(e);return this._layers[t]||(this._layers[t]=e,e._mapToAdd=this,e.beforeAdd&&e.beforeAdd(this),this.whenReady(e._layerAdd,e)),this},removeLayer:function(e){var t=s(e);return this._layers[t]?(this._loaded&&e.onRemove(this),delete this._layers[t],this._loaded&&(this.fire("layerremove",{layer:e}),e.fire("remove")),e._map=e._mapToAdd=null,this):this},hasLayer:function(e){return s(e)in this._layers},eachLayer:function(e,t){for(var n in this._layers)e.call(t,this._layers[n]);return this},_addLayers:function(e){for(var t=0,n=(e=e?v(e)?e:[e]:[]).length;t<n;t++)this.addLayer(e[t])},_addZoomLimit:function(e){isNaN(e.options.maxZoom)&&isNaN(e.options.minZoom)||(this._zoomBoundLayers[s(e)]=e,this._updateZoomLevels())},_removeZoomLimit:function(e){var t=s(e);this._zoomBoundLayers[t]&&(delete this._zoomBoundLayers[t],this._updateZoomLevels())},_updateZoomLevels:function(){var e=1/0,t=-1/0,n=this._getZoomSpan();for(var r in this._zoomBoundLayers){var i=this._zoomBoundLayers[r].options;e=void 0===i.minZoom?e:Math.min(e,i.minZoom),t=void 0===i.maxZoom?t:Math.max(t,i.maxZoom)}this._layersMaxZoom=t===-1/0?void 0:t,this._layersMinZoom=e===1/0?void 0:e,n!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Kn=qn.extend({initialize:function(e,t){var n,r;if(p(this,t),this._layers={},e)for(n=0,r=e.length;n<r;n++)this.addLayer(e[n])},addLayer:function(e){var t=this.getLayerId(e);return this._layers[t]=e,this._map&&this._map.addLayer(e),this},removeLayer:function(e){var t=e in this._layers?e:this.getLayerId(e);return this._map&&this._layers[t]&&this._map.removeLayer(this._layers[t]),delete this._layers[t],this},hasLayer:function(e){return("number"==typeof e?e:this.getLayerId(e))in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(e){var t,n,r=Array.prototype.slice.call(arguments,1);for(t in this._layers)(n=this._layers[t])[e]&&n[e].apply(n,r);return this},onAdd:function(e){this.eachLayer(e.addLayer,e)},onRemove:function(e){this.eachLayer(e.removeLayer,e)},eachLayer:function(e,t){for(var n in this._layers)e.call(t,this._layers[n]);return this},getLayer:function(e){return this._layers[e]},getLayers:function(){var e=[];return this.eachLayer(e.push,e),e},setZIndex:function(e){return this.invoke("setZIndex",e)},getLayerId:function(e){return s(e)}}),Zn=function(e,t){return new Kn(e,t)},Jn=Kn.extend({addLayer:function(e){return this.hasLayer(e)?this:(e.addEventParent(this),Kn.prototype.addLayer.call(this,e),this.fire("layeradd",{layer:e}))},removeLayer:function(e){return this.hasLayer(e)?(e in this._layers&&(e=this._layers[e]),e.removeEventParent(this),Kn.prototype.removeLayer.call(this,e),this.fire("layerremove",{layer:e})):this},setStyle:function(e){return this.invoke("setStyle",e)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var e=new U;for(var t in this._layers){var n=this._layers[t];e.extend(n.getBounds?n.getBounds():n.getLatLng())}return e}}),Qn=function(e,t){return new Jn(e,t)},er=A.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(e){p(this,e)},createIcon:function(e){return this._createIcon("icon",e)},createShadow:function(e){return this._createIcon("shadow",e)},_createIcon:function(e,t){var n=this._getIconUrl(e);if(!n){if("icon"===e)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var r=this._createImg(n,t&&"IMG"===t.tagName?t:null);return this._setIconStyles(r,e),(this.options.crossOrigin||""===this.options.crossOrigin)&&(r.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),r},_setIconStyles:function(e,t){var n=this.options,r=n[t+"Size"];"number"==typeof r&&(r=[r,r]);var i=O(r),a=O("shadow"===t&&n.shadowAnchor||n.iconAnchor||i&&i.divideBy(2,!0));e.className="leaflet-marker-"+t+" "+(n.className||""),a&&(e.style.marginLeft=-a.x+"px",e.style.marginTop=-a.y+"px"),i&&(e.style.width=i.x+"px",e.style.height=i.y+"px")},_createImg:function(e,t){return(t=t||document.createElement("img")).src=e,t},_getIconUrl:function(e){return ze.retina&&this.options[e+"RetinaUrl"]||this.options[e+"Url"]}});function tr(e){return new er(e)}var nr=er.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(e){return"string"!=typeof nr.imagePath&&(nr.imagePath=this._detectIconPath()),(this.options.imagePath||nr.imagePath)+er.prototype._getIconUrl.call(this,e)},_stripUrl:function(e){var t=function(e,t,n){var r=t.exec(e);return r&&r[n]};return(e=t(e,/^url\((['"])?(.+)\1\)$/,2))&&t(e,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var e=gt("div","leaflet-default-icon-path",document.body),t=mt(e,"background-image")||mt(e,"backgroundImage");if(document.body.removeChild(e),t=this._stripUrl(t))return t;var n=document.querySelector('link[href$="leaflet.css"]');return n?n.href.substring(0,n.href.length-11-1):""}}),rr=_n.extend({initialize:function(e){this._marker=e},addHooks:function(){var e=this._marker._icon;this._draggable||(this._draggable=new wn(e,e,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),wt(e,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&St(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(e){var t=this._marker,n=t._map,r=this._marker.options.autoPanSpeed,i=this._marker.options.autoPanPadding,a=Lt(t._icon),s=n.getPixelBounds(),o=n.getPixelOrigin(),l=B(s.min._subtract(o).add(i),s.max._subtract(o).subtract(i));if(!l.contains(a)){var u=O((Math.max(l.max.x,a.x)-l.max.x)/(s.max.x-l.max.x)-(Math.min(l.min.x,a.x)-l.min.x)/(s.min.x-l.min.x),(Math.max(l.max.y,a.y)-l.max.y)/(s.max.y-l.max.y)-(Math.min(l.min.y,a.y)-l.min.y)/(s.min.y-l.min.y)).multiplyBy(r);n.panBy(u,{animate:!1}),this._draggable._newPos._add(u),this._draggable._startPos._add(u),Rt(t._icon,this._draggable._newPos),this._onDrag(e),this._panRequest=T(this._adjustPan.bind(this,e))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(e){this._marker.options.autoPan&&(M(this._panRequest),this._panRequest=T(this._adjustPan.bind(this,e)))},_onDrag:function(e){var t=this._marker,n=t._shadow,r=Lt(t._icon),i=t._map.layerPointToLatLng(r);n&&Rt(n,r),t._latlng=i,e.latlng=i,e.oldLatLng=this._oldLatLng,t.fire("move",e).fire("drag",e)},_onDragEnd:function(e){M(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",e)}}),ir=qn.extend({options:{icon:new nr,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(e,t){p(this,t),this._latlng=V(e)},onAdd:function(e){this._zoomAnimated=this._zoomAnimated&&e.options.markerZoomAnimation,this._zoomAnimated&&e.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(e){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&e.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(e){var t=this._latlng;return this._latlng=V(e),this.update(),this.fire("move",{oldLatLng:t,latlng:this._latlng})},setZIndexOffset:function(e){return this.options.zIndexOffset=e,this.update()},getIcon:function(){return this.options.icon},setIcon:function(e){return this.options.icon=e,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var e=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(e)}return this},_initIcon:function(){var e=this.options,t="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),n=e.icon.createIcon(this._icon),r=!1;n!==this._icon&&(this._icon&&this._removeIcon(),r=!0,e.title&&(n.title=e.title),"IMG"===n.tagName&&(n.alt=e.alt||"")),wt(n,t),e.keyboard&&(n.tabIndex="0",n.setAttribute("role","button")),this._icon=n,e.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ft(n,"focus",this._panOnFocus,this);var i=e.icon.createShadow(this._shadow),a=!1;i!==this._shadow&&(this._removeShadow(),a=!0),i&&(wt(i,t),i.alt=""),this._shadow=i,e.opacity<1&&this._updateOpacity(),r&&this.getPane().appendChild(this._icon),this._initInteraction(),i&&a&&this.getPane(e.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Gt(this._icon,"focus",this._panOnFocus,this),vt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&vt(this._shadow),this._shadow=null},_setPos:function(e){this._icon&&Rt(this._icon,e),this._shadow&&Rt(this._shadow,e),this._zIndex=e.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(e){this._icon&&(this._icon.style.zIndex=this._zIndex+e)},_animateZoom:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center).round();this._setPos(t)},_initInteraction:function(){if(this.options.interactive&&(wt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),rr)){var e=this.options.draggable;this.dragging&&(e=this.dragging.enabled(),this.dragging.disable()),this.dragging=new rr(this),e&&this.dragging.enable()}},setOpacity:function(e){return this.options.opacity=e,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var e=this.options.opacity;this._icon&&Mt(this._icon,e),this._shadow&&Mt(this._shadow,e)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var e=this._map;if(e){var t=this.options.icon.options,n=t.iconSize?O(t.iconSize):O(0,0),r=t.iconAnchor?O(t.iconAnchor):O(0,0);e.panInside(this._latlng,{paddingTopLeft:r,paddingBottomRight:n.subtract(r)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function ar(e,t){return new ir(e,t)}var sr=qn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(e){this._renderer=e.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(e){return p(this,e),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&e&&Object.prototype.hasOwnProperty.call(e,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),or=sr.extend({options:{fill:!0,radius:10},initialize:function(e,t){p(this,t),this._latlng=V(e),this._radius=this.options.radius},setLatLng:function(e){var t=this._latlng;return this._latlng=V(e),this.redraw(),this.fire("move",{oldLatLng:t,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(e){return this.options.radius=this._radius=e,this.redraw()},getRadius:function(){return this._radius},setStyle:function(e){var t=e&&e.radius||this._radius;return sr.prototype.setStyle.call(this,e),this.setRadius(t),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var e=this._radius,t=this._radiusY||e,n=this._clickTolerance(),r=[e+n,t+n];this._pxBounds=new N(this._point.subtract(r),this._point.add(r))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(e){return e.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function lr(e,t){return new or(e,t)}var ur=or.extend({initialize:function(e,t,r){if("number"==typeof t&&(t=n({},r,{radius:t})),p(this,t),this._latlng=V(e),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(e){return this._mRadius=e,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var e=[this._radius,this._radiusY||this._radius];return new U(this._map.layerPointToLatLng(this._point.subtract(e)),this._map.layerPointToLatLng(this._point.add(e)))},setStyle:sr.prototype.setStyle,_project:function(){var e=this._latlng.lng,t=this._latlng.lat,n=this._map,r=n.options.crs;if(r.distance===j.distance){var i=Math.PI/180,a=this._mRadius/j.R/i,s=n.project([t+a,e]),o=n.project([t-a,e]),l=s.add(o).divideBy(2),u=n.unproject(l).lat,c=Math.acos((Math.cos(a*i)-Math.sin(t*i)*Math.sin(u*i))/(Math.cos(t*i)*Math.cos(u*i)))/i;(isNaN(c)||0===c)&&(c=a/Math.cos(Math.PI/180*t)),this._point=l.subtract(n.getPixelOrigin()),this._radius=isNaN(c)?0:l.x-n.project([u,e-c]).x,this._radiusY=l.y-s.y}else{var d=r.unproject(r.project(this._latlng).subtract([this._mRadius,0]));this._point=n.latLngToLayerPoint(this._latlng),this._radius=this._point.x-n.latLngToLayerPoint(d).x}this._updateBounds()}});function cr(e,t,n){return new ur(e,t,n)}var dr=sr.extend({options:{smoothFactor:1,noClip:!1},initialize:function(e,t){p(this,t),this._setLatLngs(e)},getLatLngs:function(){return this._latlngs},setLatLngs:function(e){return this._setLatLngs(e),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(e){for(var t,n,r=1/0,i=null,a=Un,s=0,o=this._parts.length;s<o;s++)for(var l=this._parts[s],u=1,c=l.length;u<c;u++){var d=a(e,t=l[u-1],n=l[u],!0);d<r&&(r=d,i=a(e,t,n))}return i&&(i.distance=Math.sqrt(r)),i},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Vn(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(e,t){return t=t||this._defaultShape(),e=V(e),t.push(e),this._bounds.extend(e),this.redraw()},_setLatLngs:function(e){this._bounds=new U,this._latlngs=this._convertLatLngs(e)},_defaultShape:function(){return zn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(e){for(var t=[],n=zn(e),r=0,i=e.length;r<i;r++)n?(t[r]=V(e[r]),this._bounds.extend(t[r])):t[r]=this._convertLatLngs(e[r]);return t},_project:function(){var e=new N;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,e),this._bounds.isValid()&&e.isValid()&&(this._rawPxBounds=e,this._updateBounds())},_updateBounds:function(){var e=this._clickTolerance(),t=new D(e,e);this._rawPxBounds&&(this._pxBounds=new N([this._rawPxBounds.min.subtract(t),this._rawPxBounds.max.add(t)]))},_projectLatlngs:function(e,t,n){var r,i,a=e[0]instanceof F,s=e.length;if(a){for(i=[],r=0;r<s;r++)i[r]=this._map.latLngToLayerPoint(e[r]),n.extend(i[r]);t.push(i)}else for(r=0;r<s;r++)this._projectLatlngs(e[r],t,n)},_clipPoints:function(){var e=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(e))if(this.options.noClip)this._parts=this._rings;else{var t,n,r,i,a,s,o,l=this._parts;for(t=0,r=0,i=this._rings.length;t<i;t++)for(n=0,a=(o=this._rings[t]).length;n<a-1;n++)(s=In(o[n],o[n+1],e,n,!0))&&(l[r]=l[r]||[],l[r].push(s[0]),s[1]===o[n+1]&&n!==a-2||(l[r].push(s[1]),r++))}},_simplifyPoints:function(){for(var e=this._parts,t=this.options.smoothFactor,n=0,r=e.length;n<r;n++)e[n]=An(e[n],t)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(e,t){var n,r,i,a,s,o,l=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(e))return!1;for(n=0,a=this._parts.length;n<a;n++)for(r=0,i=(s=(o=this._parts[n]).length)-1;r<s;i=r++)if((t||0!==r)&&Pn(e,o[i],o[r])<=l)return!0;return!1}});function hr(e,t){return new dr(e,t)}dr._flat=Fn;var pr=dr.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Cn(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(e){var t=dr.prototype._convertLatLngs.call(this,e),n=t.length;return n>=2&&t[0]instanceof F&&t[0].equals(t[n-1])&&t.pop(),t},_setLatLngs:function(e){dr.prototype._setLatLngs.call(this,e),zn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return zn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var e=this._renderer._bounds,t=this.options.weight,n=new D(t,t);if(e=new N(e.min.subtract(n),e.max.add(n)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(e))if(this.options.noClip)this._parts=this._rings;else for(var r,i=0,a=this._rings.length;i<a;i++)(r=Sn(this._rings[i],e,!0)).length&&this._parts.push(r)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(e){var t,n,r,i,a,s,o,l,u=!1;if(!this._pxBounds||!this._pxBounds.contains(e))return!1;for(i=0,o=this._parts.length;i<o;i++)for(a=0,s=(l=(t=this._parts[i]).length)-1;a<l;s=a++)n=t[a],r=t[s],n.y>e.y!=r.y>e.y&&e.x<(r.x-n.x)*(e.y-n.y)/(r.y-n.y)+n.x&&(u=!u);return u||dr.prototype._containsPoint.call(this,e,!0)}});function fr(e,t){return new pr(e,t)}var mr=Jn.extend({initialize:function(e,t){p(this,t),this._layers={},e&&this.addData(e)},addData:function(e){var t,n,r,i=v(e)?e:e.features;if(i){for(t=0,n=i.length;t<n;t++)((r=i[t]).geometries||r.geometry||r.features||r.coordinates)&&this.addData(r);return this}var a=this.options;if(a.filter&&!a.filter(e))return this;var s=gr(e,a);return s?(s.feature=Sr(e),s.defaultOptions=s.options,this.resetStyle(s),a.onEachFeature&&a.onEachFeature(e,s),this.addLayer(s)):this},resetStyle:function(e){return void 0===e?this.eachLayer(this.resetStyle,this):(e.options=n({},e.defaultOptions),this._setLayerStyle(e,this.options.style),this)},setStyle:function(e){return this.eachLayer((function(t){this._setLayerStyle(t,e)}),this)},_setLayerStyle:function(e,t){e.setStyle&&("function"==typeof t&&(t=t(e.feature)),e.setStyle(t))}});function gr(e,t){var n,r,i,a,s="Feature"===e.type?e.geometry:e,o=s?s.coordinates:null,l=[],u=t&&t.pointToLayer,c=t&&t.coordsToLatLng||yr;if(!o&&!s)return null;switch(s.type){case"Point":return vr(u,e,n=c(o),t);case"MultiPoint":for(i=0,a=o.length;i<a;i++)n=c(o[i]),l.push(vr(u,e,n,t));return new Jn(l);case"LineString":case"MultiLineString":return r=_r(o,"LineString"===s.type?0:1,c),new dr(r,t);case"Polygon":case"MultiPolygon":return r=_r(o,"Polygon"===s.type?1:2,c),new pr(r,t);case"GeometryCollection":for(i=0,a=s.geometries.length;i<a;i++){var d=gr({geometry:s.geometries[i],type:"Feature",properties:e.properties},t);d&&l.push(d)}return new Jn(l);case"FeatureCollection":for(i=0,a=s.features.length;i<a;i++){var h=gr(s.features[i],t);h&&l.push(h)}return new Jn(l);default:throw new Error("Invalid GeoJSON object.")}}function vr(e,t,n,r){return e?e(t,n):new ir(n,r&&r.markersInheritOptions&&r)}function yr(e){return new F(e[1],e[0],e[2])}function _r(e,t,n){for(var r,i=[],a=0,s=e.length;a<s;a++)r=t?_r(e[a],t-1,n):(n||yr)(e[a]),i.push(r);return i}function br(e,t){return void 0!==(e=V(e)).alt?[c(e.lng,t),c(e.lat,t),c(e.alt,t)]:[c(e.lng,t),c(e.lat,t)]}function xr(e,t,n,r){for(var i=[],a=0,s=e.length;a<s;a++)i.push(t?xr(e[a],zn(e[a])?0:t-1,n,r):br(e[a],r));return!t&&n&&i.length>0&&i.push(i[0].slice()),i}function wr(e,t){return e.feature?n({},e.feature,{geometry:t}):Sr(t)}function Sr(e){return"Feature"===e.type||"FeatureCollection"===e.type?e:{type:"Feature",properties:{},geometry:e}}var Cr={toGeoJSON:function(e){return wr(this,{type:"Point",coordinates:br(this.getLatLng(),e)})}};function Tr(e,t){return new mr(e,t)}ir.include(Cr),ur.include(Cr),or.include(Cr),dr.include({toGeoJSON:function(e){var t=!zn(this._latlngs);return wr(this,{type:(t?"Multi":"")+"LineString",coordinates:xr(this._latlngs,t?1:0,!1,e)})}}),pr.include({toGeoJSON:function(e){var t=!zn(this._latlngs),n=t&&!zn(this._latlngs[0]),r=xr(this._latlngs,n?2:t?1:0,!0,e);return t||(r=[r]),wr(this,{type:(n?"Multi":"")+"Polygon",coordinates:r})}}),Kn.include({toMultiPoint:function(e){var t=[];return this.eachLayer((function(n){t.push(n.toGeoJSON(e).geometry.coordinates)})),wr(this,{type:"MultiPoint",coordinates:t})},toGeoJSON:function(e){var t=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===t)return this.toMultiPoint(e);var n="GeometryCollection"===t,r=[];return this.eachLayer((function(t){if(t.toGeoJSON){var i=t.toGeoJSON(e);if(n)r.push(i.geometry);else{var a=Sr(i);"FeatureCollection"===a.type?r.push.apply(r,a.features):r.push(a)}}})),n?wr(this,{geometries:r,type:"GeometryCollection"}):{type:"FeatureCollection",features:r}}});var Mr=Tr,Er=qn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(e,t,n){this._url=e,this._bounds=z(t),p(this,n)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(wt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){vt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(e){return this.options.opacity=e,this._image&&this._updateOpacity(),this},setStyle:function(e){return e.opacity&&this.setOpacity(e.opacity),this},bringToFront:function(){return this._map&&_t(this._image),this},bringToBack:function(){return this._map&&bt(this._image),this},setUrl:function(e){return this._url=e,this._image&&(this._image.src=e),this},setBounds:function(e){return this._bounds=z(e),this._map&&this._reset(),this},getEvents:function(){var e={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},setZIndex:function(e){return this.options.zIndex=e,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var e="IMG"===this._url.tagName,t=this._image=e?this._url:gt("img");wt(t,"leaflet-image-layer"),this._zoomAnimated&&wt(t,"leaflet-zoom-animated"),this.options.className&&wt(t,this.options.className),t.onselectstart=u,t.onmousemove=u,t.onload=i(this.fire,this,"load"),t.onerror=i(this._overlayOnError,this,"error"),(this.options.crossOrigin||""===this.options.crossOrigin)&&(t.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),e?this._url=t.src:(t.src=this._url,t.alt=this.options.alt)},_animateZoom:function(e){var t=this._map.getZoomScale(e.zoom),n=this._map._latLngBoundsToNewLayerBounds(this._bounds,e.zoom,e.center).min;Pt(this._image,n,t)},_reset:function(){var e=this._image,t=new N(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),n=t.getSize();Rt(e,t.min),e.style.width=n.x+"px",e.style.height=n.y+"px"},_updateOpacity:function(){Mt(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var e=this.options.errorOverlayUrl;e&&this._url!==e&&(this._url=e,this._image.src=e)},getCenter:function(){return this._bounds.getCenter()}}),Ar=function(e,t,n){return new Er(e,t,n)},Pr=Er.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var e="VIDEO"===this._url.tagName,t=this._image=e?this._url:gt("video");if(wt(t,"leaflet-image-layer"),this._zoomAnimated&&wt(t,"leaflet-zoom-animated"),this.options.className&&wt(t,this.options.className),t.onselectstart=u,t.onmousemove=u,t.onloadeddata=i(this.fire,this,"load"),e){for(var n=t.getElementsByTagName("source"),r=[],a=0;a<n.length;a++)r.push(n[a].src);this._url=n.length>0?r:[t.src]}else{v(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(t.style,"objectFit")&&(t.style.objectFit="fill"),t.autoplay=!!this.options.autoplay,t.loop=!!this.options.loop,t.muted=!!this.options.muted,t.playsInline=!!this.options.playsInline;for(var s=0;s<this._url.length;s++){var o=gt("source");o.src=this._url[s],t.appendChild(o)}}}});function Rr(e,t,n){return new Pr(e,t,n)}var Lr=Er.extend({_initImage:function(){var e=this._image=this._url;wt(e,"leaflet-image-layer"),this._zoomAnimated&&wt(e,"leaflet-zoom-animated"),this.options.className&&wt(e,this.options.className),e.onselectstart=u,e.onmousemove=u}});function kr(e,t,n){return new Lr(e,t,n)}var Dr=qn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(e,t){e&&(e instanceof F||v(e))?(this._latlng=V(e),p(this,t)):(p(this,e),this._source=t),this.options.content&&(this._content=this.options.content)},openOn:function(e){return(e=arguments.length?e:this._source._map).hasLayer(this)||e.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(e){return this._map?this.close():(arguments.length?this._source=e:e=this._source,this._prepareOpen(),this.openOn(e._map)),this},onAdd:function(e){this._zoomAnimated=e._zoomAnimated,this._container||this._initLayout(),e._fadeAnimated&&Mt(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),e._fadeAnimated&&Mt(this._container,1),this.bringToFront(),this.options.interactive&&(wt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(e){e._fadeAnimated?(Mt(this._container,0),this._removeTimeout=setTimeout(i(vt,void 0,this._container),200)):vt(this._container),this.options.interactive&&(St(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(e){return this._latlng=V(e),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(e){return this._content=e,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var e={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&_t(this._container),this},bringToBack:function(){return this._map&&bt(this._container),this},_prepareOpen:function(e){var t=this._source;if(!t._map)return!1;if(t instanceof Jn){t=null;var n=this._source._layers;for(var r in n)if(n[r]._map){t=n[r];break}if(!t)return!1;this._source=t}if(!e)if(t.getCenter)e=t.getCenter();else if(t.getLatLng)e=t.getLatLng();else{if(!t.getBounds)throw new Error("Unable to get source layer LatLng.");e=t.getBounds().getCenter()}return this.setLatLng(e),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var e=this._contentNode,t="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof t)e.innerHTML=t;else{for(;e.hasChildNodes();)e.removeChild(e.firstChild);e.appendChild(t)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var e=this._map.latLngToLayerPoint(this._latlng),t=O(this.options.offset),n=this._getAnchor();this._zoomAnimated?Rt(this._container,e.add(n)):t=t.add(e).add(n);var r=this._containerBottom=-t.y,i=this._containerLeft=-Math.round(this._containerWidth/2)+t.x;this._container.style.bottom=r+"px",this._container.style.left=i+"px"}},_getAnchor:function(){return[0,0]}});sn.include({_initOverlay:function(e,t,n,r){var i=t;return i instanceof e||(i=new e(r).setContent(t)),n&&i.setLatLng(n),i}}),qn.include({_initOverlay:function(e,t,n,r){var i=n;return i instanceof e?(p(i,r),i._source=this):(i=t&&!r?t:new e(r,this)).setContent(n),i}});var Ir=Dr.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(e){return!(e=arguments.length?e:this._source._map).hasLayer(this)&&e._popup&&e._popup.options.autoClose&&e.removeLayer(e._popup),e._popup=this,Dr.prototype.openOn.call(this,e)},onAdd:function(e){Dr.prototype.onAdd.call(this,e),e.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof sr||this._source.on("preclick",$t))},onRemove:function(e){Dr.prototype.onRemove.call(this,e),e.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof sr||this._source.off("preclick",$t))},getEvents:function(){var e=Dr.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(e.preclick=this.close),this.options.keepInView&&(e.moveend=this._adjustPan),e},_initLayout:function(){var e="leaflet-popup",t=this._container=gt("div",e+" "+(this.options.className||"")+" leaflet-zoom-animated"),n=this._wrapper=gt("div",e+"-content-wrapper",t);if(this._contentNode=gt("div",e+"-content",n),qt(t),Xt(this._contentNode),Ft(t,"contextmenu",$t),this._tipContainer=gt("div",e+"-tip-container",t),this._tip=gt("div",e+"-tip",this._tipContainer),this.options.closeButton){var r=this._closeButton=gt("a",e+"-close-button",t);r.setAttribute("role","button"),r.setAttribute("aria-label","Close popup"),r.href="#close",r.innerHTML='<span aria-hidden="true">&#215;</span>',Ft(r,"click",(function(e){Kt(e),this.close()}),this)}},_updateLayout:function(){var e=this._contentNode,t=e.style;t.width="",t.whiteSpace="nowrap";var n=e.offsetWidth;n=Math.min(n,this.options.maxWidth),n=Math.max(n,this.options.minWidth),t.width=n+1+"px",t.whiteSpace="",t.height="";var r=e.offsetHeight,i=this.options.maxHeight,a="leaflet-popup-scrolled";i&&r>i?(t.height=i+"px",wt(e,a)):St(e,a),this._containerWidth=this._container.offsetWidth},_animateZoom:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center),n=this._getAnchor();Rt(this._container,t.add(n))},_adjustPan:function(){if(this.options.autoPan)if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning)this._autopanning=!1;else{var e=this._map,t=parseInt(mt(this._container,"marginBottom"),10)||0,n=this._container.offsetHeight+t,r=this._containerWidth,i=new D(this._containerLeft,-n-this._containerBottom);i._add(Lt(this._container));var a=e.layerPointToContainerPoint(i),s=O(this.options.autoPanPadding),o=O(this.options.autoPanPaddingTopLeft||s),l=O(this.options.autoPanPaddingBottomRight||s),u=e.getSize(),c=0,d=0;a.x+r+l.x>u.x&&(c=a.x+r-u.x+l.x),a.x-c-o.x<0&&(c=a.x-o.x),a.y+n+l.y>u.y&&(d=a.y+n-u.y+l.y),a.y-d-o.y<0&&(d=a.y-o.y),(c||d)&&(this.options.keepInView&&(this._autopanning=!0),e.fire("autopanstart").panBy([c,d]))}},_getAnchor:function(){return O(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Or=function(e,t){return new Ir(e,t)};sn.mergeOptions({closePopupOnClick:!0}),sn.include({openPopup:function(e,t,n){return this._initOverlay(Ir,e,t,n).openOn(this),this},closePopup:function(e){return(e=arguments.length?e:this._popup)&&e.close(),this}}),qn.include({bindPopup:function(e,t){return this._popup=this._initOverlay(Ir,this._popup,e,t),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(e){return this._popup&&(this instanceof Jn||(this._popup._source=this),this._popup._prepareOpen(e||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(e){return this._popup&&this._popup.setContent(e),this},getPopup:function(){return this._popup},_openPopup:function(e){if(this._popup&&this._map){Zt(e);var t=e.layer||e.target;this._popup._source!==t||t instanceof sr?(this._popup._source=t,this.openPopup(e.latlng)):this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(e.latlng)}},_movePopup:function(e){this._popup.setLatLng(e.latlng)},_onKeyPress:function(e){13===e.originalEvent.keyCode&&this._openPopup(e)}});var Nr=Dr.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(e){Dr.prototype.onAdd.call(this,e),this.setOpacity(this.options.opacity),e.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(e){Dr.prototype.onRemove.call(this,e),e.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var e=Dr.prototype.getEvents.call(this);return this.options.permanent||(e.preclick=this.close),e},_initLayout:function(){var e="leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=gt("div",e),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+s(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(e){var t,n,r=this._map,i=this._container,a=r.latLngToContainerPoint(r.getCenter()),s=r.layerPointToContainerPoint(e),o=this.options.direction,l=i.offsetWidth,u=i.offsetHeight,c=O(this.options.offset),d=this._getAnchor();"top"===o?(t=l/2,n=u):"bottom"===o?(t=l/2,n=0):"center"===o?(t=l/2,n=u/2):"right"===o?(t=0,n=u/2):"left"===o?(t=l,n=u/2):s.x<a.x?(o="right",t=0,n=u/2):(o="left",t=l+2*(c.x+d.x),n=u/2),e=e.subtract(O(t,n,!0)).add(c).add(d),St(i,"leaflet-tooltip-right"),St(i,"leaflet-tooltip-left"),St(i,"leaflet-tooltip-top"),St(i,"leaflet-tooltip-bottom"),wt(i,"leaflet-tooltip-"+o),Rt(i,e)},_updatePosition:function(){var e=this._map.latLngToLayerPoint(this._latlng);this._setPosition(e)},setOpacity:function(e){this.options.opacity=e,this._container&&Mt(this._container,e)},_animateZoom:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center);this._setPosition(t)},_getAnchor:function(){return O(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Br=function(e,t){return new Nr(e,t)};sn.include({openTooltip:function(e,t,n){return this._initOverlay(Nr,e,t,n).openOn(this),this},closeTooltip:function(e){return e.close(),this}}),qn.include({bindTooltip:function(e,t){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Nr,this._tooltip,e,t),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(e){if(e||!this._tooltipHandlersAdded){var t=e?"off":"on",n={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?n.add=this._openTooltip:(n.mouseover=this._openTooltip,n.mouseout=this.closeTooltip,n.click=this._openTooltip,this._map?this._addFocusListeners():n.add=this._addFocusListeners),this._tooltip.options.sticky&&(n.mousemove=this._moveTooltip),this[t](n),this._tooltipHandlersAdded=!e}},openTooltip:function(e){return this._tooltip&&(this instanceof Jn||(this._tooltip._source=this),this._tooltip._prepareOpen(e)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(e){return this._tooltip&&this._tooltip.setContent(e),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(e){var t="function"==typeof e.getElement&&e.getElement();t&&(Ft(t,"focus",(function(){this._tooltip._source=e,this.openTooltip()}),this),Ft(t,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(e){var t="function"==typeof e.getElement&&e.getElement();t&&t.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(e){if(this._tooltip&&this._map)if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var t=this;this._map.once("moveend",(function(){t._openOnceFlag=!1,t._openTooltip(e)}))}else this._tooltip._source=e.layer||e.target,this.openTooltip(this._tooltip.options.sticky?e.latlng:void 0)},_moveTooltip:function(e){var t,n,r=e.latlng;this._tooltip.options.sticky&&e.originalEvent&&(t=this._map.mouseEventToContainerPoint(e.originalEvent),n=this._map.containerPointToLayerPoint(t),r=this._map.layerPointToLatLng(n)),this._tooltip.setLatLng(r)}});var Ur=er.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(e){var t=e&&"DIV"===e.tagName?e:document.createElement("div"),n=this.options;if(n.html instanceof Element?(yt(t),t.appendChild(n.html)):t.innerHTML=!1!==n.html?n.html:"",n.bgPos){var r=O(n.bgPos);t.style.backgroundPosition=-r.x+"px "+-r.y+"px"}return this._setIconStyles(t,"icon"),t},createShadow:function(){return null}});function zr(e){return new Ur(e)}er.Default=nr;var Fr=qn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:ze.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(e){p(this,e)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(e){e._addZoomLimit(this)},onRemove:function(e){this._removeAllTiles(),vt(this._container),e._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(_t(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(bt(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(e){return this.options.opacity=e,this._updateOpacity(),this},setZIndex:function(e){return this.options.zIndex=e,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var e=this._clampZoom(this._map.getZoom());e!==this._tileZoom&&(this._tileZoom=e,this._updateLevels()),this._update()}return this},getEvents:function(){var e={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=o(this._onMoveEnd,this.options.updateInterval,this)),e.move=this._onMove),this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},createTile:function(){return document.createElement("div")},getTileSize:function(){var e=this.options.tileSize;return e instanceof D?e:new D(e,e)},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(e){for(var t,n=this.getPane().children,r=-e(-1/0,1/0),i=0,a=n.length;i<a;i++)t=n[i].style.zIndex,n[i]!==this._container&&t&&(r=e(r,+t));isFinite(r)&&(this.options.zIndex=r+e(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!ze.ielt9){Mt(this._container,this.options.opacity);var e=+new Date,t=!1,n=!1;for(var r in this._tiles){var i=this._tiles[r];if(i.current&&i.loaded){var a=Math.min(1,(e-i.loaded)/200);Mt(i.el,a),a<1?t=!0:(i.active?n=!0:this._onOpaqueTile(i),i.active=!0)}}n&&!this._noPrune&&this._pruneTiles(),t&&(M(this._fadeFrame),this._fadeFrame=T(this._updateOpacity,this))}},_onOpaqueTile:u,_initContainer:function(){this._container||(this._container=gt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var e=this._tileZoom,t=this.options.maxZoom;if(void 0!==e){for(var n in this._levels)n=Number(n),this._levels[n].el.children.length||n===e?(this._levels[n].el.style.zIndex=t-Math.abs(e-n),this._onUpdateLevel(n)):(vt(this._levels[n].el),this._removeTilesAtZoom(n),this._onRemoveLevel(n),delete this._levels[n]);var r=this._levels[e],i=this._map;return r||((r=this._levels[e]={}).el=gt("div","leaflet-tile-container leaflet-zoom-animated",this._container),r.el.style.zIndex=t,r.origin=i.project(i.unproject(i.getPixelOrigin()),e).round(),r.zoom=e,this._setZoomTransform(r,i.getCenter(),i.getZoom()),u(r.el.offsetWidth),this._onCreateLevel(r)),this._level=r,r}},_onUpdateLevel:u,_onRemoveLevel:u,_onCreateLevel:u,_pruneTiles:function(){if(this._map){var e,t,n=this._map.getZoom();if(n>this.options.maxZoom||n<this.options.minZoom)this._removeAllTiles();else{for(e in this._tiles)(t=this._tiles[e]).retain=t.current;for(e in this._tiles)if((t=this._tiles[e]).current&&!t.active){var r=t.coords;this._retainParent(r.x,r.y,r.z,r.z-5)||this._retainChildren(r.x,r.y,r.z,r.z+2)}for(e in this._tiles)this._tiles[e].retain||this._removeTile(e)}}},_removeTilesAtZoom:function(e){for(var t in this._tiles)this._tiles[t].coords.z===e&&this._removeTile(t)},_removeAllTiles:function(){for(var e in this._tiles)this._removeTile(e)},_invalidateAll:function(){for(var e in this._levels)vt(this._levels[e].el),this._onRemoveLevel(Number(e)),delete this._levels[e];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(e,t,n,r){var i=Math.floor(e/2),a=Math.floor(t/2),s=n-1,o=new D(+i,+a);o.z=+s;var l=this._tileCoordsToKey(o),u=this._tiles[l];return u&&u.active?(u.retain=!0,!0):(u&&u.loaded&&(u.retain=!0),s>r&&this._retainParent(i,a,s,r))},_retainChildren:function(e,t,n,r){for(var i=2*e;i<2*e+2;i++)for(var a=2*t;a<2*t+2;a++){var s=new D(i,a);s.z=n+1;var o=this._tileCoordsToKey(s),l=this._tiles[o];l&&l.active?l.retain=!0:(l&&l.loaded&&(l.retain=!0),n+1<r&&this._retainChildren(i,a,n+1,r))}},_resetView:function(e){var t=e&&(e.pinch||e.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),t,t)},_animateZoom:function(e){this._setView(e.center,e.zoom,!0,e.noUpdate)},_clampZoom:function(e){var t=this.options;return void 0!==t.minNativeZoom&&e<t.minNativeZoom?t.minNativeZoom:void 0!==t.maxNativeZoom&&t.maxNativeZoom<e?t.maxNativeZoom:e},_setView:function(e,t,n,r){var i=Math.round(t);i=void 0!==this.options.maxZoom&&i>this.options.maxZoom||void 0!==this.options.minZoom&&i<this.options.minZoom?void 0:this._clampZoom(i);var a=this.options.updateWhenZooming&&i!==this._tileZoom;r&&!a||(this._tileZoom=i,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==i&&this._update(e),n||this._pruneTiles(),this._noPrune=!!n),this._setZoomTransforms(e,t)},_setZoomTransforms:function(e,t){for(var n in this._levels)this._setZoomTransform(this._levels[n],e,t)},_setZoomTransform:function(e,t,n){var r=this._map.getZoomScale(n,e.zoom),i=e.origin.multiplyBy(r).subtract(this._map._getNewPixelOrigin(t,n)).round();ze.any3d?Pt(e.el,i,r):Rt(e.el,i)},_resetGrid:function(){var e=this._map,t=e.options.crs,n=this._tileSize=this.getTileSize(),r=this._tileZoom,i=this._map.getPixelWorldBounds(this._tileZoom);i&&(this._globalTileRange=this._pxBoundsToTileRange(i)),this._wrapX=t.wrapLng&&!this.options.noWrap&&[Math.floor(e.project([0,t.wrapLng[0]],r).x/n.x),Math.ceil(e.project([0,t.wrapLng[1]],r).x/n.y)],this._wrapY=t.wrapLat&&!this.options.noWrap&&[Math.floor(e.project([t.wrapLat[0],0],r).y/n.x),Math.ceil(e.project([t.wrapLat[1],0],r).y/n.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(e){var t=this._map,n=t._animatingZoom?Math.max(t._animateToZoom,t.getZoom()):t.getZoom(),r=t.getZoomScale(n,this._tileZoom),i=t.project(e,this._tileZoom).floor(),a=t.getSize().divideBy(2*r);return new N(i.subtract(a),i.add(a))},_update:function(e){var t=this._map;if(t){var n=this._clampZoom(t.getZoom());if(void 0===e&&(e=t.getCenter()),void 0!==this._tileZoom){var r=this._getTiledPixelBounds(e),i=this._pxBoundsToTileRange(r),a=i.getCenter(),s=[],o=this.options.keepBuffer,l=new N(i.getBottomLeft().subtract([o,-o]),i.getTopRight().add([o,-o]));if(!(isFinite(i.min.x)&&isFinite(i.min.y)&&isFinite(i.max.x)&&isFinite(i.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var u in this._tiles){var c=this._tiles[u].coords;c.z===this._tileZoom&&l.contains(new D(c.x,c.y))||(this._tiles[u].current=!1)}if(Math.abs(n-this._tileZoom)>1)this._setView(e,n);else{for(var d=i.min.y;d<=i.max.y;d++)for(var h=i.min.x;h<=i.max.x;h++){var p=new D(h,d);if(p.z=this._tileZoom,this._isValidTile(p)){var f=this._tiles[this._tileCoordsToKey(p)];f?f.current=!0:s.push(p)}}if(s.sort((function(e,t){return e.distanceTo(a)-t.distanceTo(a)})),0!==s.length){this._loading||(this._loading=!0,this.fire("loading"));var m=document.createDocumentFragment();for(h=0;h<s.length;h++)this._addTile(s[h],m);this._level.el.appendChild(m)}}}}},_isValidTile:function(e){var t=this._map.options.crs;if(!t.infinite){var n=this._globalTileRange;if(!t.wrapLng&&(e.x<n.min.x||e.x>n.max.x)||!t.wrapLat&&(e.y<n.min.y||e.y>n.max.y))return!1}if(!this.options.bounds)return!0;var r=this._tileCoordsToBounds(e);return z(this.options.bounds).overlaps(r)},_keyToBounds:function(e){return this._tileCoordsToBounds(this._keyToTileCoords(e))},_tileCoordsToNwSe:function(e){var t=this._map,n=this.getTileSize(),r=e.scaleBy(n),i=r.add(n);return[t.unproject(r,e.z),t.unproject(i,e.z)]},_tileCoordsToBounds:function(e){var t=this._tileCoordsToNwSe(e),n=new U(t[0],t[1]);return this.options.noWrap||(n=this._map.wrapLatLngBounds(n)),n},_tileCoordsToKey:function(e){return e.x+":"+e.y+":"+e.z},_keyToTileCoords:function(e){var t=e.split(":"),n=new D(+t[0],+t[1]);return n.z=+t[2],n},_removeTile:function(e){var t=this._tiles[e];t&&(vt(t.el),delete this._tiles[e],this.fire("tileunload",{tile:t.el,coords:this._keyToTileCoords(e)}))},_initTile:function(e){wt(e,"leaflet-tile");var t=this.getTileSize();e.style.width=t.x+"px",e.style.height=t.y+"px",e.onselectstart=u,e.onmousemove=u,ze.ielt9&&this.options.opacity<1&&Mt(e,this.options.opacity)},_addTile:function(e,t){var n=this._getTilePos(e),r=this._tileCoordsToKey(e),a=this.createTile(this._wrapCoords(e),i(this._tileReady,this,e));this._initTile(a),this.createTile.length<2&&T(i(this._tileReady,this,e,null,a)),Rt(a,n),this._tiles[r]={el:a,coords:e,current:!0},t.appendChild(a),this.fire("tileloadstart",{tile:a,coords:e})},_tileReady:function(e,t,n){t&&this.fire("tileerror",{error:t,tile:n,coords:e});var r=this._tileCoordsToKey(e);(n=this._tiles[r])&&(n.loaded=+new Date,this._map._fadeAnimated?(Mt(n.el,0),M(this._fadeFrame),this._fadeFrame=T(this._updateOpacity,this)):(n.active=!0,this._pruneTiles()),t||(wt(n.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:n.el,coords:e})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),ze.ielt9||!this._map._fadeAnimated?T(this._pruneTiles,this):setTimeout(i(this._pruneTiles,this),250)))},_getTilePos:function(e){return e.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(e){var t=new D(this._wrapX?l(e.x,this._wrapX):e.x,this._wrapY?l(e.y,this._wrapY):e.y);return t.z=e.z,t},_pxBoundsToTileRange:function(e){var t=this.getTileSize();return new N(e.min.unscaleBy(t).floor(),e.max.unscaleBy(t).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var e in this._tiles)if(!this._tiles[e].loaded)return!1;return!0}});function Vr(e){return new Fr(e)}var Gr=Fr.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(e,t){this._url=e,(t=p(this,t)).detectRetina&&ze.retina&&t.maxZoom>0?(t.tileSize=Math.floor(t.tileSize/2),t.zoomReverse?(t.zoomOffset--,t.minZoom=Math.min(t.maxZoom,t.minZoom+1)):(t.zoomOffset++,t.maxZoom=Math.max(t.minZoom,t.maxZoom-1)),t.minZoom=Math.max(0,t.minZoom)):t.zoomReverse?t.minZoom=Math.min(t.maxZoom,t.minZoom):t.maxZoom=Math.max(t.minZoom,t.maxZoom),"string"==typeof t.subdomains&&(t.subdomains=t.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(e,t){return this._url===e&&void 0===t&&(t=!0),this._url=e,t||this.redraw(),this},createTile:function(e,t){var n=document.createElement("img");return Ft(n,"load",i(this._tileOnLoad,this,t,n)),Ft(n,"error",i(this._tileOnError,this,t,n)),(this.options.crossOrigin||""===this.options.crossOrigin)&&(n.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),"string"==typeof this.options.referrerPolicy&&(n.referrerPolicy=this.options.referrerPolicy),n.alt="",n.src=this.getTileUrl(e),n},getTileUrl:function(e){var t={r:ze.retina?"@2x":"",s:this._getSubdomain(e),x:e.x,y:e.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var r=this._globalTileRange.max.y-e.y;this.options.tms&&(t.y=r),t["-y"]=r}return g(this._url,n(t,this.options))},_tileOnLoad:function(e,t){ze.ielt9?setTimeout(i(e,this,null,t),0):e(null,t)},_tileOnError:function(e,t,n){var r=this.options.errorTileUrl;r&&t.getAttribute("src")!==r&&(t.src=r),e(n,t)},_onTileRemove:function(e){e.tile.onload=null},_getZoomForUrl:function(){var e=this._tileZoom,t=this.options.maxZoom;return this.options.zoomReverse&&(e=t-e),e+this.options.zoomOffset},_getSubdomain:function(e){var t=Math.abs(e.x+e.y)%this.options.subdomains.length;return this.options.subdomains[t]},_abortLoading:function(){var e,t;for(e in this._tiles)if(this._tiles[e].coords.z!==this._tileZoom&&((t=this._tiles[e].el).onload=u,t.onerror=u,!t.complete)){t.src=_;var n=this._tiles[e].coords;vt(t),delete this._tiles[e],this.fire("tileabort",{tile:t,coords:n})}},_removeTile:function(e){var t=this._tiles[e];if(t)return t.el.setAttribute("src",_),Fr.prototype._removeTile.call(this,e)},_tileReady:function(e,t,n){if(this._map&&(!n||n.getAttribute("src")!==_))return Fr.prototype._tileReady.call(this,e,t,n)}});function Hr(e,t){return new Gr(e,t)}var jr=Gr.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(e,t){this._url=e;var r=n({},this.defaultWmsParams);for(var i in t)i in this.options||(r[i]=t[i]);var a=(t=p(this,t)).detectRetina&&ze.retina?2:1,s=this.getTileSize();r.width=s.x*a,r.height=s.y*a,this.wmsParams=r},onAdd:function(e){this._crs=this.options.crs||e.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var t=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[t]=this._crs.code,Gr.prototype.onAdd.call(this,e)},getTileUrl:function(e){var t=this._tileCoordsToNwSe(e),n=this._crs,r=B(n.project(t[0]),n.project(t[1])),i=r.min,a=r.max,s=(this._wmsVersion>=1.3&&this._crs===$n?[i.y,i.x,a.y,a.x]:[i.x,i.y,a.x,a.y]).join(","),o=Gr.prototype.getTileUrl.call(this,e);return o+f(this.wmsParams,o,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+s},setParams:function(e,t){return n(this.wmsParams,e),t||this.redraw(),this}});function Wr(e,t){return new jr(e,t)}Gr.WMS=jr,Hr.wms=Wr;var Yr=qn.extend({options:{padding:.1},initialize:function(e){p(this,e),s(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),wt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var e={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(e.zoomanim=this._onAnimZoom),e},_onAnimZoom:function(e){this._updateTransform(e.center,e.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(e,t){var n=this._map.getZoomScale(t,this._zoom),r=this._map.getSize().multiplyBy(.5+this.options.padding),i=this._map.project(this._center,t),a=r.multiplyBy(-n).add(i).subtract(this._map._getNewPixelOrigin(e,t));ze.any3d?Pt(this._container,a,n):Rt(this._container,a)},_reset:function(){for(var e in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[e]._reset()},_onZoomEnd:function(){for(var e in this._layers)this._layers[e]._project()},_updatePaths:function(){for(var e in this._layers)this._layers[e]._update()},_update:function(){var e=this.options.padding,t=this._map.getSize(),n=this._map.containerPointToLayerPoint(t.multiplyBy(-e)).round();this._bounds=new N(n,n.add(t.multiplyBy(1+2*e)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),$r=Yr.extend({options:{tolerance:0},getEvents:function(){var e=Yr.prototype.getEvents.call(this);return e.viewprereset=this._onViewPreReset,e},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Yr.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var e=this._container=document.createElement("canvas");Ft(e,"mousemove",this._onMouseMove,this),Ft(e,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Ft(e,"mouseout",this._handleMouseOut,this),e._leaflet_disable_events=!0,this._ctx=e.getContext("2d")},_destroyContainer:function(){M(this._redrawRequest),delete this._ctx,vt(this._container),Gt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var e in this._redrawBounds=null,this._layers)this._layers[e]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){Yr.prototype._update.call(this);var e=this._bounds,t=this._container,n=e.getSize(),r=ze.retina?2:1;Rt(t,e.min),t.width=r*n.x,t.height=r*n.y,t.style.width=n.x+"px",t.style.height=n.y+"px",ze.retina&&this._ctx.scale(2,2),this._ctx.translate(-e.min.x,-e.min.y),this.fire("update")}},_reset:function(){Yr.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(e){this._updateDashArray(e),this._layers[s(e)]=e;var t=e._order={layer:e,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=t),this._drawLast=t,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(e){this._requestRedraw(e)},_removePath:function(e){var t=e._order,n=t.next,r=t.prev;n?n.prev=r:this._drawLast=r,r?r.next=n:this._drawFirst=n,delete e._order,delete this._layers[s(e)],this._requestRedraw(e)},_updatePath:function(e){this._extendRedrawBounds(e),e._project(),e._update(),this._requestRedraw(e)},_updateStyle:function(e){this._updateDashArray(e),this._requestRedraw(e)},_updateDashArray:function(e){if("string"==typeof e.options.dashArray){var t,n,r=e.options.dashArray.split(/[, ]+/),i=[];for(n=0;n<r.length;n++){if(t=Number(r[n]),isNaN(t))return;i.push(t)}e.options._dashArray=i}else e.options._dashArray=e.options.dashArray},_requestRedraw:function(e){this._map&&(this._extendRedrawBounds(e),this._redrawRequest=this._redrawRequest||T(this._redraw,this))},_extendRedrawBounds:function(e){if(e._pxBounds){var t=(e.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new N,this._redrawBounds.extend(e._pxBounds.min.subtract([t,t])),this._redrawBounds.extend(e._pxBounds.max.add([t,t]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var e=this._redrawBounds;if(e){var t=e.getSize();this._ctx.clearRect(e.min.x,e.min.y,t.x,t.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var e,t=this._redrawBounds;if(this._ctx.save(),t){var n=t.getSize();this._ctx.beginPath(),this._ctx.rect(t.min.x,t.min.y,n.x,n.y),this._ctx.clip()}this._drawing=!0;for(var r=this._drawFirst;r;r=r.next)e=r.layer,(!t||e._pxBounds&&e._pxBounds.intersects(t))&&e._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(e,t){if(this._drawing){var n,r,i,a,s=e._parts,o=s.length,l=this._ctx;if(o){for(l.beginPath(),n=0;n<o;n++){for(r=0,i=s[n].length;r<i;r++)a=s[n][r],l[r?"lineTo":"moveTo"](a.x,a.y);t&&l.closePath()}this._fillStroke(l,e)}}},_updateCircle:function(e){if(this._drawing&&!e._empty()){var t=e._point,n=this._ctx,r=Math.max(Math.round(e._radius),1),i=(Math.max(Math.round(e._radiusY),1)||r)/r;1!==i&&(n.save(),n.scale(1,i)),n.beginPath(),n.arc(t.x,t.y/i,r,0,2*Math.PI,!1),1!==i&&n.restore(),this._fillStroke(n,e)}},_fillStroke:function(e,t){var n=t.options;n.fill&&(e.globalAlpha=n.fillOpacity,e.fillStyle=n.fillColor||n.color,e.fill(n.fillRule||"evenodd")),n.stroke&&0!==n.weight&&(e.setLineDash&&e.setLineDash(t.options&&t.options._dashArray||[]),e.globalAlpha=n.opacity,e.lineWidth=n.weight,e.strokeStyle=n.color,e.lineCap=n.lineCap,e.lineJoin=n.lineJoin,e.stroke())},_onClick:function(e){for(var t,n,r=this._map.mouseEventToLayerPoint(e),i=this._drawFirst;i;i=i.next)(t=i.layer).options.interactive&&t._containsPoint(r)&&("click"!==e.type&&"preclick"!==e.type||!this._map._draggableMoved(t))&&(n=t);this._fireEvent(!!n&&[n],e)},_onMouseMove:function(e){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var t=this._map.mouseEventToLayerPoint(e);this._handleMouseHover(e,t)}},_handleMouseOut:function(e){var t=this._hoveredLayer;t&&(St(this._container,"leaflet-interactive"),this._fireEvent([t],e,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(e,t){if(!this._mouseHoverThrottled){for(var n,r,a=this._drawFirst;a;a=a.next)(n=a.layer).options.interactive&&n._containsPoint(t)&&(r=n);r!==this._hoveredLayer&&(this._handleMouseOut(e),r&&(wt(this._container,"leaflet-interactive"),this._fireEvent([r],e,"mouseover"),this._hoveredLayer=r)),this._fireEvent(!!this._hoveredLayer&&[this._hoveredLayer],e),this._mouseHoverThrottled=!0,setTimeout(i((function(){this._mouseHoverThrottled=!1}),this),32)}},_fireEvent:function(e,t,n){this._map._fireDOMEvent(t,n||t.type,e)},_bringToFront:function(e){var t=e._order;if(t){var n=t.next,r=t.prev;n&&(n.prev=r,r?r.next=n:n&&(this._drawFirst=n),t.prev=this._drawLast,this._drawLast.next=t,t.next=null,this._drawLast=t,this._requestRedraw(e))}},_bringToBack:function(e){var t=e._order;if(t){var n=t.next,r=t.prev;r&&(r.next=n,n?n.prev=r:r&&(this._drawLast=r),t.prev=null,t.next=this._drawFirst,this._drawFirst.prev=t,this._drawFirst=t,this._requestRedraw(e))}}});function Xr(e){return ze.canvas?new $r(e):null}var qr=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(e){return document.createElement("<lvml:"+e+' class="lvml">')}}catch(zA){}return function(e){return document.createElement("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Kr={_initContainer:function(){this._container=gt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Yr.prototype._update.call(this),this.fire("update"))},_initPath:function(e){var t=e._container=qr("shape");wt(t,"leaflet-vml-shape "+(this.options.className||"")),t.coordsize="1 1",e._path=qr("path"),t.appendChild(e._path),this._updateStyle(e),this._layers[s(e)]=e},_addPath:function(e){var t=e._container;this._container.appendChild(t),e.options.interactive&&e.addInteractiveTarget(t)},_removePath:function(e){var t=e._container;vt(t),e.removeInteractiveTarget(t),delete this._layers[s(e)]},_updateStyle:function(e){var t=e._stroke,n=e._fill,r=e.options,i=e._container;i.stroked=!!r.stroke,i.filled=!!r.fill,r.stroke?(t||(t=e._stroke=qr("stroke")),i.appendChild(t),t.weight=r.weight+"px",t.color=r.color,t.opacity=r.opacity,r.dashArray?t.dashStyle=v(r.dashArray)?r.dashArray.join(" "):r.dashArray.replace(/( *, *)/g," "):t.dashStyle="",t.endcap=r.lineCap.replace("butt","flat"),t.joinstyle=r.lineJoin):t&&(i.removeChild(t),e._stroke=null),r.fill?(n||(n=e._fill=qr("fill")),i.appendChild(n),n.color=r.fillColor||r.color,n.opacity=r.fillOpacity):n&&(i.removeChild(n),e._fill=null)},_updateCircle:function(e){var t=e._point.round(),n=Math.round(e._radius),r=Math.round(e._radiusY||n);this._setPath(e,e._empty()?"M0 0":"AL "+t.x+","+t.y+" "+n+","+r+" 0,23592600")},_setPath:function(e,t){e._path.v=t},_bringToFront:function(e){_t(e._container)},_bringToBack:function(e){bt(e._container)}},Zr=ze.vml?qr:J,Jr=Yr.extend({_initContainer:function(){this._container=Zr("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Zr("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){vt(this._container),Gt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!this._map._animatingZoom||!this._bounds){Yr.prototype._update.call(this);var e=this._bounds,t=e.getSize(),n=this._container;this._svgSize&&this._svgSize.equals(t)||(this._svgSize=t,n.setAttribute("width",t.x),n.setAttribute("height",t.y)),Rt(n,e.min),n.setAttribute("viewBox",[e.min.x,e.min.y,t.x,t.y].join(" ")),this.fire("update")}},_initPath:function(e){var t=e._path=Zr("path");e.options.className&&wt(t,e.options.className),e.options.interactive&&wt(t,"leaflet-interactive"),this._updateStyle(e),this._layers[s(e)]=e},_addPath:function(e){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(e._path),e.addInteractiveTarget(e._path)},_removePath:function(e){vt(e._path),e.removeInteractiveTarget(e._path),delete this._layers[s(e)]},_updatePath:function(e){e._project(),e._update()},_updateStyle:function(e){var t=e._path,n=e.options;t&&(n.stroke?(t.setAttribute("stroke",n.color),t.setAttribute("stroke-opacity",n.opacity),t.setAttribute("stroke-width",n.weight),t.setAttribute("stroke-linecap",n.lineCap),t.setAttribute("stroke-linejoin",n.lineJoin),n.dashArray?t.setAttribute("stroke-dasharray",n.dashArray):t.removeAttribute("stroke-dasharray"),n.dashOffset?t.setAttribute("stroke-dashoffset",n.dashOffset):t.removeAttribute("stroke-dashoffset")):t.setAttribute("stroke","none"),n.fill?(t.setAttribute("fill",n.fillColor||n.color),t.setAttribute("fill-opacity",n.fillOpacity),t.setAttribute("fill-rule",n.fillRule||"evenodd")):t.setAttribute("fill","none"))},_updatePoly:function(e,t){this._setPath(e,Q(e._parts,t))},_updateCircle:function(e){var t=e._point,n=Math.max(Math.round(e._radius),1),r="a"+n+","+(Math.max(Math.round(e._radiusY),1)||n)+" 0 1,0 ",i=e._empty()?"M0 0":"M"+(t.x-n)+","+t.y+r+2*n+",0 "+r+2*-n+",0 ";this._setPath(e,i)},_setPath:function(e,t){e._path.setAttribute("d",t)},_bringToFront:function(e){_t(e._path)},_bringToBack:function(e){bt(e._path)}});function Qr(e){return ze.svg||ze.vml?new Jr(e):null}ze.vml&&Jr.include(Kr),sn.include({getRenderer:function(e){var t=e.options.renderer||this._getPaneRenderer(e.options.pane)||this.options.renderer||this._renderer;return t||(t=this._renderer=this._createRenderer()),this.hasLayer(t)||this.addLayer(t),t},_getPaneRenderer:function(e){if("overlayPane"===e||void 0===e)return!1;var t=this._paneRenderers[e];return void 0===t&&(t=this._createRenderer({pane:e}),this._paneRenderers[e]=t),t},_createRenderer:function(e){return this.options.preferCanvas&&Xr(e)||Qr(e)}});var ei=pr.extend({initialize:function(e,t){pr.prototype.initialize.call(this,this._boundsToLatLngs(e),t)},setBounds:function(e){return this.setLatLngs(this._boundsToLatLngs(e))},_boundsToLatLngs:function(e){return[(e=z(e)).getSouthWest(),e.getNorthWest(),e.getNorthEast(),e.getSouthEast()]}});function ti(e,t){return new ei(e,t)}Jr.create=Zr,Jr.pointsToPath=Q,mr.geometryToLayer=gr,mr.coordsToLatLng=yr,mr.coordsToLatLngs=_r,mr.latLngToCoords=br,mr.latLngsToCoords=xr,mr.getFeature=wr,mr.asFeature=Sr,sn.mergeOptions({boxZoom:!0});var ni=_n.extend({initialize:function(e){this._map=e,this._container=e._container,this._pane=e._panes.overlayPane,this._resetStateTimeout=0,e.on("unload",this._destroy,this)},addHooks:function(){Ft(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Gt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){vt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(e){if(!e.shiftKey||1!==e.which&&1!==e.button)return!1;this._clearDeferredResetState(),this._resetState(),st(),Dt(),this._startPoint=this._map.mouseEventToContainerPoint(e),Ft(document,{contextmenu:Zt,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(e){this._moved||(this._moved=!0,this._box=gt("div","leaflet-zoom-box",this._container),wt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(e);var t=new N(this._point,this._startPoint),n=t.getSize();Rt(this._box,t.min),this._box.style.width=n.x+"px",this._box.style.height=n.y+"px"},_finish:function(){this._moved&&(vt(this._box),St(this._container,"leaflet-crosshair")),ot(),It(),Gt(document,{contextmenu:Zt,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(e){if((1===e.which||1===e.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(i(this._resetState,this),0);var t=new U(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(t).fire("boxzoomend",{boxZoomBounds:t})}},_onKeyDown:function(e){27===e.keyCode&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});sn.addInitHook("addHandler","boxZoom",ni),sn.mergeOptions({doubleClickZoom:!0});var ri=_n.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(e){var t=this._map,n=t.getZoom(),r=t.options.zoomDelta,i=e.originalEvent.shiftKey?n-r:n+r;"center"===t.options.doubleClickZoom?t.setZoom(i):t.setZoomAround(e.containerPoint,i)}});sn.addInitHook("addHandler","doubleClickZoom",ri),sn.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var ii=_n.extend({addHooks:function(){if(!this._draggable){var e=this._map;this._draggable=new wn(e._mapPane,e._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),e.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),e.on("zoomend",this._onZoomEnd,this),e.whenReady(this._onZoomEnd,this))}wt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){St(this._map._container,"leaflet-grab"),St(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var e=this._map;if(e._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var t=z(this._map.options.maxBounds);this._offsetLimit=B(this._map.latLngToContainerPoint(t.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(t.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;e.fire("movestart").fire("dragstart"),e.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(e){if(this._map.options.inertia){var t=this._lastTime=+new Date,n=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(n),this._times.push(t),this._prunePositions(t)}this._map.fire("move",e).fire("drag",e)},_prunePositions:function(e){for(;this._positions.length>1&&e-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var e=this._map.getSize().divideBy(2),t=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=t.subtract(e).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(e,t){return e-(e-t)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var e=this._draggable._newPos.subtract(this._draggable._startPos),t=this._offsetLimit;e.x<t.min.x&&(e.x=this._viscousLimit(e.x,t.min.x)),e.y<t.min.y&&(e.y=this._viscousLimit(e.y,t.min.y)),e.x>t.max.x&&(e.x=this._viscousLimit(e.x,t.max.x)),e.y>t.max.y&&(e.y=this._viscousLimit(e.y,t.max.y)),this._draggable._newPos=this._draggable._startPos.add(e)}},_onPreDragWrap:function(){var e=this._worldWidth,t=Math.round(e/2),n=this._initialWorldOffset,r=this._draggable._newPos.x,i=(r-t+n)%e+t-n,a=(r+t+n)%e-t-n,s=Math.abs(i+n)<Math.abs(a+n)?i:a;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=s},_onDragEnd:function(e){var t=this._map,n=t.options,r=!n.inertia||e.noInertia||this._times.length<2;if(t.fire("dragend",e),r)t.fire("moveend");else{this._prunePositions(+new Date);var i=this._lastPos.subtract(this._positions[0]),a=(this._lastTime-this._times[0])/1e3,s=n.easeLinearity,o=i.multiplyBy(s/a),l=o.distanceTo([0,0]),u=Math.min(n.inertiaMaxSpeed,l),c=o.multiplyBy(u/l),d=u/(n.inertiaDeceleration*s),h=c.multiplyBy(-d/2).round();h.x||h.y?(h=t._limitOffset(h,t.options.maxBounds),T((function(){t.panBy(h,{duration:d,easeLinearity:s,noMoveStart:!0,animate:!0})}))):t.fire("moveend")}}});sn.addInitHook("addHandler","dragging",ii),sn.mergeOptions({keyboard:!0,keyboardPanDelta:80});var ai=_n.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(e){this._map=e,this._setPanDelta(e.options.keyboardPanDelta),this._setZoomDelta(e.options.zoomDelta)},addHooks:function(){var e=this._map._container;e.tabIndex<=0&&(e.tabIndex="0"),Ft(e,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Gt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var e=document.body,t=document.documentElement,n=e.scrollTop||t.scrollTop,r=e.scrollLeft||t.scrollLeft;this._map._container.focus(),window.scrollTo(r,n)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(e){var t,n,r=this._panKeys={},i=this.keyCodes;for(t=0,n=i.left.length;t<n;t++)r[i.left[t]]=[-1*e,0];for(t=0,n=i.right.length;t<n;t++)r[i.right[t]]=[e,0];for(t=0,n=i.down.length;t<n;t++)r[i.down[t]]=[0,e];for(t=0,n=i.up.length;t<n;t++)r[i.up[t]]=[0,-1*e]},_setZoomDelta:function(e){var t,n,r=this._zoomKeys={},i=this.keyCodes;for(t=0,n=i.zoomIn.length;t<n;t++)r[i.zoomIn[t]]=e;for(t=0,n=i.zoomOut.length;t<n;t++)r[i.zoomOut[t]]=-e},_addHooks:function(){Ft(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Gt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(e){if(!(e.altKey||e.ctrlKey||e.metaKey)){var t,n=e.keyCode,r=this._map;if(n in this._panKeys){if(!r._panAnim||!r._panAnim._inProgress)if(t=this._panKeys[n],e.shiftKey&&(t=O(t).multiplyBy(3)),r.options.maxBounds&&(t=r._limitOffset(O(t),r.options.maxBounds)),r.options.worldCopyJump){var i=r.wrapLatLng(r.unproject(r.project(r.getCenter()).add(t)));r.panTo(i)}else r.panBy(t)}else if(n in this._zoomKeys)r.setZoom(r.getZoom()+(e.shiftKey?3:1)*this._zoomKeys[n]);else{if(27!==n||!r._popup||!r._popup.options.closeOnEscapeKey)return;r.closePopup()}Zt(e)}}});sn.addInitHook("addHandler","keyboard",ai),sn.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var si=_n.extend({addHooks:function(){Ft(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Gt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(e){var t=tn(e),n=this._map.options.wheelDebounceTime;this._delta+=t,this._lastMousePos=this._map.mouseEventToContainerPoint(e),this._startTime||(this._startTime=+new Date);var r=Math.max(n-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(i(this._performZoom,this),r),Zt(e)},_performZoom:function(){var e=this._map,t=e.getZoom(),n=this._map.options.zoomSnap||0;e._stop();var r=this._delta/(4*this._map.options.wheelPxPerZoomLevel),i=4*Math.log(2/(1+Math.exp(-Math.abs(r))))/Math.LN2,a=n?Math.ceil(i/n)*n:i,s=e._limitZoom(t+(this._delta>0?a:-a))-t;this._delta=0,this._startTime=null,s&&("center"===e.options.scrollWheelZoom?e.setZoom(t+s):e.setZoomAround(this._lastMousePos,t+s))}});sn.addInitHook("addHandler","scrollWheelZoom",si);var oi=600;sn.mergeOptions({tapHold:ze.touchNative&&ze.safari&&ze.mobile,tapTolerance:15});var li=_n.extend({addHooks:function(){Ft(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Gt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(e){if(clearTimeout(this._holdTimeout),1===e.touches.length){var t=e.touches[0];this._startPos=this._newPos=new D(t.clientX,t.clientY),this._holdTimeout=setTimeout(i((function(){this._cancel(),this._isTapValid()&&(Ft(document,"touchend",Kt),Ft(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",t))}),this),oi),Ft(document,"touchend touchcancel contextmenu",this._cancel,this),Ft(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function e(){Gt(document,"touchend",Kt),Gt(document,"touchend touchcancel",e)},_cancel:function(){clearTimeout(this._holdTimeout),Gt(document,"touchend touchcancel contextmenu",this._cancel,this),Gt(document,"touchmove",this._onMove,this)},_onMove:function(e){var t=e.touches[0];this._newPos=new D(t.clientX,t.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(e,t){var n=new MouseEvent(e,{bubbles:!0,cancelable:!0,view:window,screenX:t.screenX,screenY:t.screenY,clientX:t.clientX,clientY:t.clientY});n._simulated=!0,t.target.dispatchEvent(n)}});sn.addInitHook("addHandler","tapHold",li),sn.mergeOptions({touchZoom:ze.touch,bounceAtZoomLimits:!0});var ui=_n.extend({addHooks:function(){wt(this._map._container,"leaflet-touch-zoom"),Ft(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){St(this._map._container,"leaflet-touch-zoom"),Gt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(e){var t=this._map;if(e.touches&&2===e.touches.length&&!t._animatingZoom&&!this._zooming){var n=t.mouseEventToContainerPoint(e.touches[0]),r=t.mouseEventToContainerPoint(e.touches[1]);this._centerPoint=t.getSize()._divideBy(2),this._startLatLng=t.containerPointToLatLng(this._centerPoint),"center"!==t.options.touchZoom&&(this._pinchStartLatLng=t.containerPointToLatLng(n.add(r)._divideBy(2))),this._startDist=n.distanceTo(r),this._startZoom=t.getZoom(),this._moved=!1,this._zooming=!0,t._stop(),Ft(document,"touchmove",this._onTouchMove,this),Ft(document,"touchend touchcancel",this._onTouchEnd,this),Kt(e)}},_onTouchMove:function(e){if(e.touches&&2===e.touches.length&&this._zooming){var t=this._map,n=t.mouseEventToContainerPoint(e.touches[0]),r=t.mouseEventToContainerPoint(e.touches[1]),a=n.distanceTo(r)/this._startDist;if(this._zoom=t.getScaleZoom(a,this._startZoom),!t.options.bounceAtZoomLimits&&(this._zoom<t.getMinZoom()&&a<1||this._zoom>t.getMaxZoom()&&a>1)&&(this._zoom=t._limitZoom(this._zoom)),"center"===t.options.touchZoom){if(this._center=this._startLatLng,1===a)return}else{var s=n._add(r)._divideBy(2)._subtract(this._centerPoint);if(1===a&&0===s.x&&0===s.y)return;this._center=t.unproject(t.project(this._pinchStartLatLng,this._zoom).subtract(s),this._zoom)}this._moved||(t._moveStart(!0,!1),this._moved=!0),M(this._animRequest);var o=i(t._move,t,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=T(o,this,!0),Kt(e)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,M(this._animRequest),Gt(document,"touchmove",this._onTouchMove,this),Gt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});sn.addInitHook("addHandler","touchZoom",ui),sn.BoxZoom=ni,sn.DoubleClickZoom=ri,sn.Drag=ii,sn.Keyboard=ai,sn.ScrollWheelZoom=si,sn.TapHold=li,sn.TouchZoom=ui,e.Bounds=N,e.Browser=ze,e.CRS=H,e.Canvas=$r,e.Circle=ur,e.CircleMarker=or,e.Class=A,e.Control=ln,e.DivIcon=Ur,e.DivOverlay=Dr,e.DomEvent=rn,e.DomUtil=zt,e.Draggable=wn,e.Evented=k,e.FeatureGroup=Jn,e.GeoJSON=mr,e.GridLayer=Fr,e.Handler=_n,e.Icon=er,e.ImageOverlay=Er,e.LatLng=F,e.LatLngBounds=U,e.Layer=qn,e.LayerGroup=Kn,e.LineUtil=Gn,e.Map=sn,e.Marker=ir,e.Mixin=bn,e.Path=sr,e.Point=D,e.PolyUtil=En,e.Polygon=pr,e.Polyline=dr,e.Popup=Ir,e.PosAnimation=an,e.Projection=Wn,e.Rectangle=ei,e.Renderer=Yr,e.SVG=Jr,e.SVGOverlay=Lr,e.TileLayer=Gr,e.Tooltip=Nr,e.Transformation=$,e.Util=E,e.VideoOverlay=Pr,e.bind=i,e.bounds=B,e.canvas=Xr,e.circle=cr,e.circleMarker=lr,e.control=un,e.divIcon=zr,e.extend=n,e.featureGroup=Qn,e.geoJSON=Tr,e.geoJson=Mr,e.gridLayer=Vr,e.icon=tr,e.imageOverlay=Ar,e.latLng=V,e.latLngBounds=z,e.layerGroup=Zn,e.map=on,e.marker=ar,e.point=O,e.polygon=fr,e.polyline=hr,e.popup=Or,e.rectangle=ti,e.setOptions=p,e.stamp=s,e.svg=Qr,e.svgOverlay=kr,e.tileLayer=Hr,e.tooltip=Br,e.transformation=X,e.version=t,e.videoOverlay=Rr;var ci=window.L;e.noConflict=function(){return window.L=ci,this},window.L=e}(ore);const lre=ore;var ure,cre,dre,hre={};cre=YS,dre=function(){void 0===Array.isArray&&(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)});var e=function(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var n=[0,0,0,0];return n[3]+=e[3]+t[3],n[2]+=n[3]>>>16,n[3]&=65535,n[2]+=e[2]+t[2],n[1]+=n[2]>>>16,n[2]&=65535,n[1]+=e[1]+t[1],n[0]+=n[1]>>>16,n[1]&=65535,n[0]+=e[0]+t[0],n[0]&=65535,[n[0]<<16|n[1],n[2]<<16|n[3]]},t=function(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var n=[0,0,0,0];return n[3]+=e[3]*t[3],n[2]+=n[3]>>>16,n[3]&=65535,n[2]+=e[2]*t[3],n[1]+=n[2]>>>16,n[2]&=65535,n[2]+=e[3]*t[2],n[1]+=n[2]>>>16,n[2]&=65535,n[1]+=e[1]*t[3],n[0]+=n[1]>>>16,n[1]&=65535,n[1]+=e[2]*t[2],n[0]+=n[1]>>>16,n[1]&=65535,n[1]+=e[3]*t[1],n[0]+=n[1]>>>16,n[1]&=65535,n[0]+=e[0]*t[3]+e[1]*t[2]+e[2]*t[1]+e[3]*t[0],n[0]&=65535,[n[0]<<16|n[1],n[2]<<16|n[3]]},n=function(e,t){return 32==(t%=64)?[e[1],e[0]]:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t|e[0]>>>32-t]:(t-=32,[e[1]<<t|e[0]>>>32-t,e[0]<<t|e[1]>>>32-t])},r=function(e,t){return 0==(t%=64)?e:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t]:[e[1]<<t-32,0]},i=function(e,t){return[e[0]^t[0],e[1]^t[1]]},a=function(e){return e=i(e,[0,e[0]>>>1]),e=t(e,[4283543511,3981806797]),e=i(e,[0,e[0]>>>1]),e=t(e,[3301882366,444984403]),e=i(e,[0,e[0]>>>1])},s=function(s,o){o=o||0;for(var l=(s=s||"").length%16,u=s.length-l,c=[0,o],d=[0,o],h=[0,0],p=[0,0],f=[2277735313,289559509],m=[1291169091,658871167],g=0;g<u;g+=16)h=[255&s.charCodeAt(g+4)|(255&s.charCodeAt(g+5))<<8|(255&s.charCodeAt(g+6))<<16|(255&s.charCodeAt(g+7))<<24,255&s.charCodeAt(g)|(255&s.charCodeAt(g+1))<<8|(255&s.charCodeAt(g+2))<<16|(255&s.charCodeAt(g+3))<<24],p=[255&s.charCodeAt(g+12)|(255&s.charCodeAt(g+13))<<8|(255&s.charCodeAt(g+14))<<16|(255&s.charCodeAt(g+15))<<24,255&s.charCodeAt(g+8)|(255&s.charCodeAt(g+9))<<8|(255&s.charCodeAt(g+10))<<16|(255&s.charCodeAt(g+11))<<24],h=t(h,f),h=n(h,31),h=t(h,m),c=i(c,h),c=n(c,27),c=e(c,d),c=e(t(c,[0,5]),[0,1390208809]),p=t(p,m),p=n(p,33),p=t(p,f),d=i(d,p),d=n(d,31),d=e(d,c),d=e(t(d,[0,5]),[0,944331445]);switch(h=[0,0],p=[0,0],l){case 15:p=i(p,r([0,s.charCodeAt(g+14)],48));case 14:p=i(p,r([0,s.charCodeAt(g+13)],40));case 13:p=i(p,r([0,s.charCodeAt(g+12)],32));case 12:p=i(p,r([0,s.charCodeAt(g+11)],24));case 11:p=i(p,r([0,s.charCodeAt(g+10)],16));case 10:p=i(p,r([0,s.charCodeAt(g+9)],8));case 9:p=i(p,[0,s.charCodeAt(g+8)]),p=t(p,m),p=n(p,33),p=t(p,f),d=i(d,p);case 8:h=i(h,r([0,s.charCodeAt(g+7)],56));case 7:h=i(h,r([0,s.charCodeAt(g+6)],48));case 6:h=i(h,r([0,s.charCodeAt(g+5)],40));case 5:h=i(h,r([0,s.charCodeAt(g+4)],32));case 4:h=i(h,r([0,s.charCodeAt(g+3)],24));case 3:h=i(h,r([0,s.charCodeAt(g+2)],16));case 2:h=i(h,r([0,s.charCodeAt(g+1)],8));case 1:h=i(h,[0,s.charCodeAt(g)]),h=t(h,f),h=n(h,31),h=t(h,m),c=i(c,h)}return c=i(c,[0,s.length]),d=i(d,[0,s.length]),c=e(c,d),d=e(d,c),c=a(c),d=a(d),c=e(c,d),d=e(d,c),("00000000"+(c[0]>>>0).toString(16)).slice(-8)+("00000000"+(c[1]>>>0).toString(16)).slice(-8)+("00000000"+(d[0]>>>0).toString(16)).slice(-8)+("00000000"+(d[1]>>>0).toString(16)).slice(-8)},o={preprocessor:null,audio:{timeout:1e3,excludeIOS11:!0},fonts:{swfContainerId:"fingerprintjs2",swfPath:"flash/compiled/FontList.swf",userDefinedFonts:[],extendedJsFonts:!1},screen:{detectScreenOrientation:!0},plugins:{sortPluginsFor:[/palemoon/i],excludeIE:!1},extraComponents:[],excludes:{enumerateDevices:!0,pixelRatio:!0,doNotTrack:!0,fontsFlash:!0,adBlock:!0},NOT_AVAILABLE:"not available",ERROR:"error",EXCLUDED:"excluded"},l=function(e,t){if(Array.prototype.forEach&&e.forEach===Array.prototype.forEach)e.forEach(t);else if(e.length===+e.length)for(var n=0,r=e.length;n<r;n++)t(e[n],n,e);else for(var i in e)e.hasOwnProperty(i)&&t(e[i],i,e)},u=function(e,t){var n=[];return null==e?n:Array.prototype.map&&e.map===Array.prototype.map?e.map(t):(l(e,(function(e,r,i){n.push(t(e,r,i))})),n)},c=function(){return navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices},d=function(e){var t=[window.screen.width,window.screen.height];return e.screen.detectScreenOrientation&&t.sort().reverse(),t},h=function(e){if(window.screen.availWidth&&window.screen.availHeight){var t=[window.screen.availHeight,window.screen.availWidth];return e.screen.detectScreenOrientation&&t.sort().reverse(),t}return e.NOT_AVAILABLE},p=function(e){if(null==navigator.plugins)return e.NOT_AVAILABLE;for(var t=[],n=0,r=navigator.plugins.length;n<r;n++)navigator.plugins[n]&&t.push(navigator.plugins[n]);return m(e)&&(t=t.sort((function(e,t){return e.name>t.name?1:e.name<t.name?-1:0}))),u(t,(function(e){var t=u(e,(function(e){return[e.type,e.suffixes]}));return[e.name,e.description,t]}))},f=function(e){var t=[];return Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(window,"ActiveXObject")||"ActiveXObject"in window?t=u(["AcroPDF.PDF","Adodb.Stream","AgControl.AgControl","DevalVRXCtrl.DevalVRXCtrl.1","MacromediaFlashPaper.MacromediaFlashPaper","Msxml2.DOMDocument","Msxml2.XMLHTTP","PDF.PdfCtrl","QuickTime.QuickTime","QuickTimeCheckObject.QuickTimeCheck.1","RealPlayer","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","RealVideo.RealVideo(tm) ActiveX Control (32-bit)","Scripting.Dictionary","SWCtl.SWCtl","Shell.UIHelper","ShockwaveFlash.ShockwaveFlash","Skype.Detection","TDCCtl.TDCCtl","WMPlayer.OCX","rmocx.RealPlayer G2 Control","rmocx.RealPlayer G2 Control.1"],(function(t){try{return new window.ActiveXObject(t),t}catch(zA){return e.ERROR}})):t.push(e.NOT_AVAILABLE),navigator.plugins&&(t=t.concat(p(e))),t},m=function(e){for(var t=!1,n=0,r=e.plugins.sortPluginsFor.length;n<r;n++){var i=e.plugins.sortPluginsFor[n];if(navigator.userAgent.match(i)){t=!0;break}}return t},g=function(e){try{return!!window.sessionStorage}catch(zA){return e.ERROR}},v=function(e){try{return!!window.localStorage}catch(zA){return e.ERROR}},y=function(e){if(O())return e.EXCLUDED;try{return!!window.indexedDB}catch(zA){return e.ERROR}},_=function(e){return navigator.hardwareConcurrency?navigator.hardwareConcurrency:e.NOT_AVAILABLE},b=function(e){return navigator.cpuClass||e.NOT_AVAILABLE},x=function(e){return navigator.platform?navigator.platform:e.NOT_AVAILABLE},w=function(e){return navigator.doNotTrack?navigator.doNotTrack:navigator.msDoNotTrack?navigator.msDoNotTrack:window.doNotTrack?window.doNotTrack:e.NOT_AVAILABLE},S=function(){var e,t=0;void 0!==navigator.maxTouchPoints?t=navigator.maxTouchPoints:void 0!==navigator.msMaxTouchPoints&&(t=navigator.msMaxTouchPoints);try{document.createEvent("TouchEvent"),e=!0}catch(n){e=!1}return[t,e,"ontouchstart"in window]},C=function(e){var t=[],n=document.createElement("canvas");n.width=2e3,n.height=200,n.style.display="inline";var r=n.getContext("2d");return r.rect(0,0,10,10),r.rect(2,2,6,6),t.push("canvas winding:"+(!1===r.isPointInPath(5,5,"evenodd")?"yes":"no")),r.textBaseline="alphabetic",r.fillStyle="#f60",r.fillRect(125,1,62,20),r.fillStyle="#069",e.dontUseFakeFontInCanvas?r.font="11pt Arial":r.font="11pt no-real-font-123",r.fillText("Cwm fjordbank glyphs vext quiz, 😃",2,15),r.fillStyle="rgba(102, 204, 0, 0.2)",r.font="18pt Arial",r.fillText("Cwm fjordbank glyphs vext quiz, 😃",4,45),r.globalCompositeOperation="multiply",r.fillStyle="rgb(255,0,255)",r.beginPath(),r.arc(50,50,50,0,2*Math.PI,!0),r.closePath(),r.fill(),r.fillStyle="rgb(0,255,255)",r.beginPath(),r.arc(100,50,50,0,2*Math.PI,!0),r.closePath(),r.fill(),r.fillStyle="rgb(255,255,0)",r.beginPath(),r.arc(75,100,50,0,2*Math.PI,!0),r.closePath(),r.fill(),r.fillStyle="rgb(255,0,255)",r.arc(75,75,75,0,2*Math.PI,!0),r.arc(75,75,25,0,2*Math.PI,!0),r.fill("evenodd"),n.toDataURL&&t.push("canvas fp:"+n.toDataURL()),t},T=function(){var e,t=function(t){return e.clearColor(0,0,0,1),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),"["+t[0]+", "+t[1]+"]"};if(!(e=z()))return null;var n=[],r=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,r);var i=new Float32Array([-.2,-.9,0,.4,-.26,0,0,.732134444,0]);e.bufferData(e.ARRAY_BUFFER,i,e.STATIC_DRAW),r.itemSize=3,r.numItems=3;var a=e.createProgram(),s=e.createShader(e.VERTEX_SHADER);e.shaderSource(s,"attribute vec2 attrVertex;varying vec2 varyinTexCoordinate;uniform vec2 uniformOffset;void main(){varyinTexCoordinate=attrVertex+uniformOffset;gl_Position=vec4(attrVertex,0,1);}"),e.compileShader(s);var o=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(o,"precision mediump float;varying vec2 varyinTexCoordinate;void main() {gl_FragColor=vec4(varyinTexCoordinate,0,1);}"),e.compileShader(o),e.attachShader(a,s),e.attachShader(a,o),e.linkProgram(a),e.useProgram(a),a.vertexPosAttrib=e.getAttribLocation(a,"attrVertex"),a.offsetUniform=e.getUniformLocation(a,"uniformOffset"),e.enableVertexAttribArray(a.vertexPosArray),e.vertexAttribPointer(a.vertexPosAttrib,r.itemSize,e.FLOAT,!1,0,0),e.uniform2f(a.offsetUniform,1,1),e.drawArrays(e.TRIANGLE_STRIP,0,r.numItems);try{n.push(e.canvas.toDataURL())}catch(zA){}n.push("extensions:"+(e.getSupportedExtensions()||[]).join(";")),n.push("webgl aliased line width range:"+t(e.getParameter(e.ALIASED_LINE_WIDTH_RANGE))),n.push("webgl aliased point size range:"+t(e.getParameter(e.ALIASED_POINT_SIZE_RANGE))),n.push("webgl alpha bits:"+e.getParameter(e.ALPHA_BITS)),n.push("webgl antialiasing:"+(e.getContextAttributes().antialias?"yes":"no")),n.push("webgl blue bits:"+e.getParameter(e.BLUE_BITS)),n.push("webgl depth bits:"+e.getParameter(e.DEPTH_BITS)),n.push("webgl green bits:"+e.getParameter(e.GREEN_BITS)),n.push("webgl max anisotropy:"+function(e){var t=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic");if(t){var n=e.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT);return 0===n&&(n=2),n}return null}(e)),n.push("webgl max combined texture image units:"+e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS)),n.push("webgl max cube map texture size:"+e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE)),n.push("webgl max fragment uniform vectors:"+e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS)),n.push("webgl max render buffer size:"+e.getParameter(e.MAX_RENDERBUFFER_SIZE)),n.push("webgl max texture image units:"+e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)),n.push("webgl max texture size:"+e.getParameter(e.MAX_TEXTURE_SIZE)),n.push("webgl max varying vectors:"+e.getParameter(e.MAX_VARYING_VECTORS)),n.push("webgl max vertex attribs:"+e.getParameter(e.MAX_VERTEX_ATTRIBS)),n.push("webgl max vertex texture image units:"+e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS)),n.push("webgl max vertex uniform vectors:"+e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS)),n.push("webgl max viewport dims:"+t(e.getParameter(e.MAX_VIEWPORT_DIMS))),n.push("webgl red bits:"+e.getParameter(e.RED_BITS)),n.push("webgl renderer:"+e.getParameter(e.RENDERER)),n.push("webgl shading language version:"+e.getParameter(e.SHADING_LANGUAGE_VERSION)),n.push("webgl stencil bits:"+e.getParameter(e.STENCIL_BITS)),n.push("webgl vendor:"+e.getParameter(e.VENDOR)),n.push("webgl version:"+e.getParameter(e.VERSION));try{var u=e.getExtension("WEBGL_debug_renderer_info");u&&(n.push("webgl unmasked vendor:"+e.getParameter(u.UNMASKED_VENDOR_WEBGL)),n.push("webgl unmasked renderer:"+e.getParameter(u.UNMASKED_RENDERER_WEBGL)))}catch(zA){}return e.getShaderPrecisionFormat?(l(["FLOAT","INT"],(function(t){l(["VERTEX","FRAGMENT"],(function(r){l(["HIGH","MEDIUM","LOW"],(function(i){l(["precision","rangeMin","rangeMax"],(function(a){var s=e.getShaderPrecisionFormat(e[r+"_SHADER"],e[i+"_"+t])[a];"precision"!==a&&(a="precision "+a);var o=["webgl ",r.toLowerCase()," shader ",i.toLowerCase()," ",t.toLowerCase()," ",a,":",s].join("");n.push(o)}))}))}))})),F(e),n):(F(e),n)},M=function(){try{var e=z(),t=e.getExtension("WEBGL_debug_renderer_info"),n=e.getParameter(t.UNMASKED_VENDOR_WEBGL)+"~"+e.getParameter(t.UNMASKED_RENDERER_WEBGL);return F(e),n}catch(zA){return null}},E=function(){var e=document.createElement("div");e.innerHTML="&nbsp;",e.className="adsbox";var t=!1;try{document.body.appendChild(e),t=0===document.getElementsByClassName("adsbox")[0].offsetHeight,document.body.removeChild(e)}catch(zA){t=!1}return t},A=function(){if(void 0!==navigator.languages)try{if(navigator.languages[0].substr(0,2)!==navigator.language.substr(0,2))return!0}catch(e){return!0}return!1},P=function(){return window.screen.width<window.screen.availWidth||window.screen.height<window.screen.availHeight},R=function(){var e,t=navigator.userAgent.toLowerCase(),n=navigator.oscpu,r=navigator.platform.toLowerCase();if(e=t.indexOf("windows phone")>=0?"Windows Phone":t.indexOf("windows")>=0||t.indexOf("win16")>=0||t.indexOf("win32")>=0||t.indexOf("win64")>=0||t.indexOf("win95")>=0||t.indexOf("win98")>=0||t.indexOf("winnt")>=0||t.indexOf("wow64")>=0?"Windows":t.indexOf("android")>=0?"Android":t.indexOf("linux")>=0||t.indexOf("cros")>=0||t.indexOf("x11")>=0?"Linux":t.indexOf("iphone")>=0||t.indexOf("ipad")>=0||t.indexOf("ipod")>=0||t.indexOf("crios")>=0||t.indexOf("fxios")>=0?"iOS":t.indexOf("macintosh")>=0||t.indexOf("mac_powerpc)")>=0?"Mac":"Other",("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)&&"Windows"!==e&&"Windows Phone"!==e&&"Android"!==e&&"iOS"!==e&&"Other"!==e&&-1===t.indexOf("cros"))return!0;if(void 0!==n){if((n=n.toLowerCase()).indexOf("win")>=0&&"Windows"!==e&&"Windows Phone"!==e)return!0;if(n.indexOf("linux")>=0&&"Linux"!==e&&"Android"!==e)return!0;if(n.indexOf("mac")>=0&&"Mac"!==e&&"iOS"!==e)return!0;if((-1===n.indexOf("win")&&-1===n.indexOf("linux")&&-1===n.indexOf("mac"))!=("Other"===e))return!0}return r.indexOf("win")>=0&&"Windows"!==e&&"Windows Phone"!==e||(r.indexOf("linux")>=0||r.indexOf("android")>=0||r.indexOf("pike")>=0)&&"Linux"!==e&&"Android"!==e||(r.indexOf("mac")>=0||r.indexOf("ipad")>=0||r.indexOf("ipod")>=0||r.indexOf("iphone")>=0)&&"Mac"!==e&&"iOS"!==e||!(r.indexOf("arm")>=0&&"Windows Phone"===e)&&!(r.indexOf("pike")>=0&&t.indexOf("opera mini")>=0)&&((r.indexOf("win")<0&&r.indexOf("linux")<0&&r.indexOf("mac")<0&&r.indexOf("iphone")<0&&r.indexOf("ipad")<0&&r.indexOf("ipod")<0)!=("Other"===e)||void 0===navigator.plugins&&"Windows"!==e&&"Windows Phone"!==e)},L=function(){var e,t=navigator.userAgent.toLowerCase(),n=navigator.productSub;if(t.indexOf("edge/")>=0||t.indexOf("iemobile/")>=0)return!1;if(t.indexOf("opera mini")>=0)return!1;if(("Chrome"==(e=t.indexOf("firefox/")>=0?"Firefox":t.indexOf("opera/")>=0||t.indexOf(" opr/")>=0?"Opera":t.indexOf("chrome/")>=0?"Chrome":t.indexOf("safari/")>=0?t.indexOf("android 1.")>=0||t.indexOf("android 2.")>=0||t.indexOf("android 3.")>=0||t.indexOf("android 4.")>=0?"AOSP":"Safari":t.indexOf("trident/")>=0?"Internet Explorer":"Other")||"Safari"===e||"Opera"===e)&&"20030107"!==n)return!0;var r,i=eval.toString().length;if(37===i&&"Safari"!==e&&"Firefox"!==e&&"Other"!==e)return!0;if(39===i&&"Internet Explorer"!==e&&"Other"!==e)return!0;if(33===i&&"Chrome"!==e&&"AOSP"!==e&&"Opera"!==e&&"Other"!==e)return!0;try{throw"a"}catch(a){try{a.toSource(),r=!0}catch(s){r=!1}}return r&&"Firefox"!==e&&"Other"!==e},k=function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))},D=function(){if(!k())return!1;var e=z(),t=!!window.WebGLRenderingContext&&!!e;return F(e),t},I=function(){return"Microsoft Internet Explorer"===navigator.appName||!("Netscape"!==navigator.appName||!/Trident/.test(navigator.userAgent))},O=function(){return("msWriteProfilerMark"in window)+("msLaunchUri"in navigator)+("msSaveBlob"in navigator)>=2},N=function(){return void 0!==window.swfobject},B=function(){return window.swfobject.hasFlashPlayerVersion("9.0.0")},U=function(e,t){var n="___fp_swf_loaded";window[n]=function(t){e(t)};var r=t.fonts.swfContainerId;!function(e){var t=document.createElement("div");t.setAttribute("id",e.fonts.swfContainerId),document.body.appendChild(t)}();var i={onReady:n};window.swfobject.embedSWF(t.fonts.swfPath,r,"1","1","9.0.0",!1,i,{allowScriptAccess:"always",menu:"false"},{})},z=function(){var e=document.createElement("canvas"),t=null;try{t=e.getContext("webgl")||e.getContext("experimental-webgl")}catch(zA){}return t||(t=null),t},F=function(e){var t=e.getExtension("WEBGL_lose_context");null!=t&&t.loseContext()},V=[{key:"userAgent",getData:function(e){e(navigator.userAgent)}},{key:"webdriver",getData:function(e,t){e(null==navigator.webdriver?t.NOT_AVAILABLE:navigator.webdriver)}},{key:"language",getData:function(e,t){e(navigator.language||navigator.userLanguage||navigator.browserLanguage||navigator.systemLanguage||t.NOT_AVAILABLE)}},{key:"colorDepth",getData:function(e,t){e(window.screen.colorDepth||t.NOT_AVAILABLE)}},{key:"deviceMemory",getData:function(e,t){e(navigator.deviceMemory||t.NOT_AVAILABLE)}},{key:"pixelRatio",getData:function(e,t){e(window.devicePixelRatio||t.NOT_AVAILABLE)}},{key:"hardwareConcurrency",getData:function(e,t){e(_(t))}},{key:"screenResolution",getData:function(e,t){e(d(t))}},{key:"availableScreenResolution",getData:function(e,t){e(h(t))}},{key:"timezoneOffset",getData:function(e){e((new Date).getTimezoneOffset())}},{key:"timezone",getData:function(e,t){window.Intl&&window.Intl.DateTimeFormat?e((new window.Intl.DateTimeFormat).resolvedOptions().timeZone||t.NOT_AVAILABLE):e(t.NOT_AVAILABLE)}},{key:"sessionStorage",getData:function(e,t){e(g(t))}},{key:"localStorage",getData:function(e,t){e(v(t))}},{key:"indexedDb",getData:function(e,t){e(y(t))}},{key:"addBehavior",getData:function(e){e(!!window.HTMLElement.prototype.addBehavior)}},{key:"openDatabase",getData:function(e){e(!!window.openDatabase)}},{key:"cpuClass",getData:function(e,t){e(b(t))}},{key:"platform",getData:function(e,t){e(x(t))}},{key:"doNotTrack",getData:function(e,t){e(w(t))}},{key:"plugins",getData:function(e,t){I()?t.plugins.excludeIE?e(t.EXCLUDED):e(f(t)):e(p(t))}},{key:"canvas",getData:function(e,t){k()?e(C(t)):e(t.NOT_AVAILABLE)}},{key:"webgl",getData:function(e,t){D()?e(T()):e(t.NOT_AVAILABLE)}},{key:"webglVendorAndRenderer",getData:function(e){D()?e(M()):e()}},{key:"adBlock",getData:function(e){e(E())}},{key:"hasLiedLanguages",getData:function(e){e(A())}},{key:"hasLiedResolution",getData:function(e){e(P())}},{key:"hasLiedOs",getData:function(e){e(R())}},{key:"hasLiedBrowser",getData:function(e){e(L())}},{key:"touchSupport",getData:function(e){e(S())}},{key:"fonts",getData:function(e,t){var n=["monospace","sans-serif","serif"],r=["Andale Mono","Arial","Arial Black","Arial Hebrew","Arial MT","Arial Narrow","Arial Rounded MT Bold","Arial Unicode MS","Bitstream Vera Sans Mono","Book Antiqua","Bookman Old Style","Calibri","Cambria","Cambria Math","Century","Century Gothic","Century Schoolbook","Comic Sans","Comic Sans MS","Consolas","Courier","Courier New","Geneva","Georgia","Helvetica","Helvetica Neue","Impact","Lucida Bright","Lucida Calligraphy","Lucida Console","Lucida Fax","LUCIDA GRANDE","Lucida Handwriting","Lucida Sans","Lucida Sans Typewriter","Lucida Sans Unicode","Microsoft Sans Serif","Monaco","Monotype Corsiva","MS Gothic","MS Outlook","MS PGothic","MS Reference Sans Serif","MS Sans Serif","MS Serif","MYRIAD","MYRIAD PRO","Palatino","Palatino Linotype","Segoe Print","Segoe Script","Segoe UI","Segoe UI Light","Segoe UI Semibold","Segoe UI Symbol","Tahoma","Times","Times New Roman","Times New Roman PS","Trebuchet MS","Verdana","Wingdings","Wingdings 2","Wingdings 3"];t.fonts.extendedJsFonts&&(r=r.concat(["Abadi MT Condensed Light","Academy Engraved LET","ADOBE CASLON PRO","Adobe Garamond","ADOBE GARAMOND PRO","Agency FB","Aharoni","Albertus Extra Bold","Albertus Medium","Algerian","Amazone BT","American Typewriter","American Typewriter Condensed","AmerType Md BT","Andalus","Angsana New","AngsanaUPC","Antique Olive","Aparajita","Apple Chancery","Apple Color Emoji","Apple SD Gothic Neo","Arabic Typesetting","ARCHER","ARNO PRO","Arrus BT","Aurora Cn BT","AvantGarde Bk BT","AvantGarde Md BT","AVENIR","Ayuthaya","Bandy","Bangla Sangam MN","Bank Gothic","BankGothic Md BT","Baskerville","Baskerville Old Face","Batang","BatangChe","Bauer Bodoni","Bauhaus 93","Bazooka","Bell MT","Bembo","Benguiat Bk BT","Berlin Sans FB","Berlin Sans FB Demi","Bernard MT Condensed","BernhardFashion BT","BernhardMod BT","Big Caslon","BinnerD","Blackadder ITC","BlairMdITC TT","Bodoni 72","Bodoni 72 Oldstyle","Bodoni 72 Smallcaps","Bodoni MT","Bodoni MT Black","Bodoni MT Condensed","Bodoni MT Poster Compressed","Bookshelf Symbol 7","Boulder","Bradley Hand","Bradley Hand ITC","Bremen Bd BT","Britannic Bold","Broadway","Browallia New","BrowalliaUPC","Brush Script MT","Californian FB","Calisto MT","Calligrapher","Candara","CaslonOpnface BT","Castellar","Centaur","Cezanne","CG Omega","CG Times","Chalkboard","Chalkboard SE","Chalkduster","Charlesworth","Charter Bd BT","Charter BT","Chaucer","ChelthmITC Bk BT","Chiller","Clarendon","Clarendon Condensed","CloisterBlack BT","Cochin","Colonna MT","Constantia","Cooper Black","Copperplate","Copperplate Gothic","Copperplate Gothic Bold","Copperplate Gothic Light","CopperplGoth Bd BT","Corbel","Cordia New","CordiaUPC","Cornerstone","Coronet","Cuckoo","Curlz MT","DaunPenh","Dauphin","David","DB LCD Temp","DELICIOUS","Denmark","DFKai-SB","Didot","DilleniaUPC","DIN","DokChampa","Dotum","DotumChe","Ebrima","Edwardian Script ITC","Elephant","English 111 Vivace BT","Engravers MT","EngraversGothic BT","Eras Bold ITC","Eras Demi ITC","Eras Light ITC","Eras Medium ITC","EucrosiaUPC","Euphemia","Euphemia UCAS","EUROSTILE","Exotc350 Bd BT","FangSong","Felix Titling","Fixedsys","FONTIN","Footlight MT Light","Forte","FrankRuehl","Fransiscan","Freefrm721 Blk BT","FreesiaUPC","Freestyle Script","French Script MT","FrnkGothITC Bk BT","Fruitger","FRUTIGER","Futura","Futura Bk BT","Futura Lt BT","Futura Md BT","Futura ZBlk BT","FuturaBlack BT","Gabriola","Galliard BT","Gautami","Geeza Pro","Geometr231 BT","Geometr231 Hv BT","Geometr231 Lt BT","GeoSlab 703 Lt BT","GeoSlab 703 XBd BT","Gigi","Gill Sans","Gill Sans MT","Gill Sans MT Condensed","Gill Sans MT Ext Condensed Bold","Gill Sans Ultra Bold","Gill Sans Ultra Bold Condensed","Gisha","Gloucester MT Extra Condensed","GOTHAM","GOTHAM BOLD","Goudy Old Style","Goudy Stout","GoudyHandtooled BT","GoudyOLSt BT","Gujarati Sangam MN","Gulim","GulimChe","Gungsuh","GungsuhChe","Gurmukhi MN","Haettenschweiler","Harlow Solid Italic","Harrington","Heather","Heiti SC","Heiti TC","HELV","Herald","High Tower Text","Hiragino Kaku Gothic ProN","Hiragino Mincho ProN","Hoefler Text","Humanst 521 Cn BT","Humanst521 BT","Humanst521 Lt BT","Imprint MT Shadow","Incised901 Bd BT","Incised901 BT","Incised901 Lt BT","INCONSOLATA","Informal Roman","Informal011 BT","INTERSTATE","IrisUPC","Iskoola Pota","JasmineUPC","Jazz LET","Jenson","Jester","Jokerman","Juice ITC","Kabel Bk BT","Kabel Ult BT","Kailasa","KaiTi","Kalinga","Kannada Sangam MN","Kartika","Kaufmann Bd BT","Kaufmann BT","Khmer UI","KodchiangUPC","Kokila","Korinna BT","Kristen ITC","Krungthep","Kunstler Script","Lao UI","Latha","Leelawadee","Letter Gothic","Levenim MT","LilyUPC","Lithograph","Lithograph Light","Long Island","Lydian BT","Magneto","Maiandra GD","Malayalam Sangam MN","Malgun Gothic","Mangal","Marigold","Marion","Marker Felt","Market","Marlett","Matisse ITC","Matura MT Script Capitals","Meiryo","Meiryo UI","Microsoft Himalaya","Microsoft JhengHei","Microsoft New Tai Lue","Microsoft PhagsPa","Microsoft Tai Le","Microsoft Uighur","Microsoft YaHei","Microsoft Yi Baiti","MingLiU","MingLiU_HKSCS","MingLiU_HKSCS-ExtB","MingLiU-ExtB","Minion","Minion Pro","Miriam","Miriam Fixed","Mistral","Modern","Modern No. 20","Mona Lisa Solid ITC TT","Mongolian Baiti","MONO","MoolBoran","Mrs Eaves","MS LineDraw","MS Mincho","MS PMincho","MS Reference Specialty","MS UI Gothic","MT Extra","MUSEO","MV Boli","Nadeem","Narkisim","NEVIS","News Gothic","News GothicMT","NewsGoth BT","Niagara Engraved","Niagara Solid","Noteworthy","NSimSun","Nyala","OCR A Extended","Old Century","Old English Text MT","Onyx","Onyx BT","OPTIMA","Oriya Sangam MN","OSAKA","OzHandicraft BT","Palace Script MT","Papyrus","Parchment","Party LET","Pegasus","Perpetua","Perpetua Titling MT","PetitaBold","Pickwick","Plantagenet Cherokee","Playbill","PMingLiU","PMingLiU-ExtB","Poor Richard","Poster","PosterBodoni BT","PRINCETOWN LET","Pristina","PTBarnum BT","Pythagoras","Raavi","Rage Italic","Ravie","Ribbon131 Bd BT","Rockwell","Rockwell Condensed","Rockwell Extra Bold","Rod","Roman","Sakkal Majalla","Santa Fe LET","Savoye LET","Sceptre","Script","Script MT Bold","SCRIPTINA","Serifa","Serifa BT","Serifa Th BT","ShelleyVolante BT","Sherwood","Shonar Bangla","Showcard Gothic","Shruti","Signboard","SILKSCREEN","SimHei","Simplified Arabic","Simplified Arabic Fixed","SimSun","SimSun-ExtB","Sinhala Sangam MN","Sketch Rockwell","Skia","Small Fonts","Snap ITC","Snell Roundhand","Socket","Souvenir Lt BT","Staccato222 BT","Steamer","Stencil","Storybook","Styllo","Subway","Swis721 BlkEx BT","Swiss911 XCm BT","Sylfaen","Synchro LET","System","Tamil Sangam MN","Technical","Teletype","Telugu Sangam MN","Tempus Sans ITC","Terminal","Thonburi","Traditional Arabic","Trajan","TRAJAN PRO","Tristan","Tubular","Tunga","Tw Cen MT","Tw Cen MT Condensed","Tw Cen MT Condensed Extra Bold","TypoUpright BT","Unicorn","Univers","Univers CE 55 Medium","Univers Condensed","Utsaah","Vagabond","Vani","Vijaya","Viner Hand ITC","VisualUI","Vivaldi","Vladimir Script","Vrinda","Westminster","WHITNEY","Wide Latin","ZapfEllipt BT","ZapfHumnst BT","ZapfHumnst Dm BT","Zapfino","Zurich BlkEx BT","Zurich Ex BT","ZWAdobeF"])),r=(r=r.concat(t.fonts.userDefinedFonts)).filter((function(e,t){return r.indexOf(e)===t}));var i=document.getElementsByTagName("body")[0],a=document.createElement("div"),s=document.createElement("div"),o={},l={},u=function(){var e=document.createElement("span");return e.style.position="absolute",e.style.left="-9999px",e.style.fontSize="72px",e.style.fontStyle="normal",e.style.fontWeight="normal",e.style.letterSpacing="normal",e.style.lineBreak="auto",e.style.lineHeight="normal",e.style.textTransform="none",e.style.textAlign="left",e.style.textDecoration="none",e.style.textShadow="none",e.style.whiteSpace="normal",e.style.wordBreak="normal",e.style.wordSpacing="normal",e.innerHTML="mmmmmmmmmmlli",e},c=function(e,t){var n=u();return n.style.fontFamily="'"+e+"',"+t,n},d=function(e){for(var t=!1,r=0;r<n.length;r++)if(t=e[r].offsetWidth!==o[n[r]]||e[r].offsetHeight!==l[n[r]])return t;return t},h=function(){for(var e=[],t=0,r=n.length;t<r;t++){var i=u();i.style.fontFamily=n[t],a.appendChild(i),e.push(i)}return e}();i.appendChild(a);for(var p=0,f=n.length;p<f;p++)o[n[p]]=h[p].offsetWidth,l[n[p]]=h[p].offsetHeight;var m=function(){for(var e={},t=0,i=r.length;t<i;t++){for(var a=[],o=0,l=n.length;o<l;o++){var u=c(r[t],n[o]);s.appendChild(u),a.push(u)}e[r[t]]=a}return e}();i.appendChild(s);for(var g=[],v=0,y=r.length;v<y;v++)d(m[r[v]])&&g.push(r[v]);i.removeChild(s),i.removeChild(a),e(g)},pauseBefore:!0},{key:"fontsFlash",getData:function(e,t){return N()?B()?t.fonts.swfPath?void U((function(t){e(t)}),t):e("missing options.fonts.swfPath"):e("flash not installed"):e("swf object not loaded")},pauseBefore:!0},{key:"audio",getData:function(e,t){var n=t.audio;if(n.excludeIOS11&&navigator.userAgent.match(/OS 11.+Version\/11.+Safari/))return e(t.EXCLUDED);var r=window.OfflineAudioContext||window.webkitOfflineAudioContext;if(null==r)return e(t.NOT_AVAILABLE);var i=new r(1,44100,44100),a=i.createOscillator();a.type="triangle",a.frequency.setValueAtTime(1e4,i.currentTime);var s=i.createDynamicsCompressor();l([["threshold",-50],["knee",40],["ratio",12],["reduction",-20],["attack",0],["release",.25]],(function(e){void 0!==s[e[0]]&&"function"==typeof s[e[0]].setValueAtTime&&s[e[0]].setValueAtTime(e[1],i.currentTime)})),a.connect(s),s.connect(i.destination),a.start(0),i.startRendering();var o=setTimeout((function(){return console.warn('Audio fingerprint timed out. Please report bug at https://github.com/fingerprintjs/fingerprintjs with your user agent: "'+navigator.userAgent+'".'),i.oncomplete=function(){},i=null,e("audioTimeout")}),n.timeout);i.oncomplete=function(t){var n;try{clearTimeout(o),n=t.renderedBuffer.getChannelData(0).slice(4500,5e3).reduce((function(e,t){return e+Math.abs(t)}),0).toString(),a.disconnect(),s.disconnect()}catch(r){return void e(r)}e(n)}}},{key:"enumerateDevices",getData:function(e,t){if(!c())return e(t.NOT_AVAILABLE);navigator.mediaDevices.enumerateDevices().then((function(t){e(t.map((function(e){return"id="+e.deviceId+";gid="+e.groupId+";"+e.kind+";"+e.label})))})).catch((function(t){e(t)}))}}],G=function(e){throw new Error("'new Fingerprint()' is deprecated, see https://github.com/fingerprintjs/fingerprintjs#upgrade-guide-from-182-to-200")};return G.get=function(e,t){t?e||(e={}):(t=e,e={}),function(e,t){if(null==t)return e;var n,r;for(r in t)null==(n=t[r])||Object.prototype.hasOwnProperty.call(e,r)||(e[r]=n)}(e,o),e.components=e.extraComponents.concat(V);var n={data:[],addPreprocessedComponent:function(t,r){"function"==typeof e.preprocessor&&(r=e.preprocessor(t,r)),n.data.push({key:t,value:r})}},r=-1,i=function(a){if((r+=1)>=e.components.length)t(n.data);else{var s=e.components[r];if(e.excludes[s.key])i(!1);else{if(!a&&s.pauseBefore)return r-=1,void setTimeout((function(){i(!0)}),1);try{s.getData((function(e){n.addPreprocessedComponent(s.key,e),i(!1)}),e)}catch(o){n.addPreprocessedComponent(s.key,String(o)),i(!1)}}}};i(!1)},G.getPromise=function(e){return new Promise((function(t,n){G.get(e,t)}))},G.getV18=function(e,t){return null==t&&(t=e,e={}),G.get(e,(function(n){for(var r=[],i=0;i<n.length;i++){var a=n[i];if(a.value===(e.NOT_AVAILABLE||"not available"))r.push({key:a.key,value:"unknown"});else if("plugins"===a.key)r.push({key:"plugins",value:u(a.value,(function(e){var t=u(e[2],(function(e){return e.join?e.join("~"):e})).join(",");return[e[0],e[1],t].join("::")}))});else if(-1!==["canvas","webgl"].indexOf(a.key)&&Array.isArray(a.value))r.push({key:a.key,value:a.value.join("~")});else if(-1!==["sessionStorage","localStorage","indexedDb","addBehavior","openDatabase"].indexOf(a.key)){if(!a.value)continue;r.push({key:a.key,value:1})}else a.value?r.push(a.value.join?{key:a.key,value:a.value.join(";")}:a):r.push({key:a.key,value:a.value})}var o=s(u(r,(function(e){return e.value})).join("~~~"),31);t(o,r)}))},G.x64hash128=s,G.VERSION="2.1.4",G},(ure={get exports(){return hre},set exports(e){hre=e}}).exports?ure.exports=dre():cre.exports?cre.exports=dre():cre.Fingerprint2=dre();const pre=hre,fre=Ti("div",{id:"map"},null,-1),mre={class:"userList"},gre=Ti("div",{class:"userTitle"},"在线用户:",-1),vre={class:"mask"},yre=Fn({__name:"multiContainer",setup(e){let t={minZoom:5,maxZoom:18};let n,r=pt(new Map),i=At(!0),a=At("");function s(){return new Promise((e=>{pre.get((function(t){const n=t.map((e=>e.value)),r=pre.x64hash128(n.join(""),31);e({flag:!0,murmur:r})}))}))}return Kn((()=>{const e=lre.map("map",t).setView([30.55227,117.07424],12);function o(t){const n=lre.marker([30.515227,117.017424],{icon:lre.divIcon({className:t,iconSize:lre.point(.11,.1),html:`<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1692693197668" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5015" width="48" height="48" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M836.54 429.526667l-498.833333-288-91.946667-53.086667c-10-5.78-18.553333-2.1-21.76-0.246667A21.333333 21.333333 0 0 0 213.333333 106.666667v682.666666a21.333333 21.333333 0 0 0 36.113334 15.386667l154.666666-148.586667 130.38 225.826667A53.333333 53.333333 0 0 0 607.333333 901.486667l129.333334-74.666667a53.333333 53.333333 0 0 0 19.526666-72.86L625.8 528.133333l206-59.64a21.333333 21.333333 0 0 0 4.733333-38.966666z" fill="#${Math.floor(16777215*Math.random()).toString(16)}" p-id="5016"></path></svg>`,iconAnchor:[10,7],popupAnchor:[0,0]})}).bindPopup(`<b>用户id</b>:<br>${t}`);r.set(t,n),n.addTo(e)}function l(e,t){let n={add:[],del:[]},r={};for(let i=0;i<e.length;i++)r[e[i]]=e[i];for(let i=0;i<t.length;i++)r[t[i]]?delete r[t[i]]:n.add.push(t[i]);return Array.from(Object.values(r)).forEach((e=>{console.log(e),n.del.push(e)})),n}lre.tileLayer("http://t0.tianditu.gov.cn/img_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=img&STYLE=default&TILEMATRIXSET=w&FORMAT=tiles&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}&tk=8c2992a8d82ecb284c857aa88102a057",{attribution:"stamen"}).addTo(e),n||(n=new WebSocket("ws://127.0.0.1:8001")),n.onmessage=function(e){switch(JSON.parse(e.data).type){case"open":l(Array.from(r.keys()),JSON.parse(e.data).user).add.forEach((e=>{o(e)})),l(Array.from(r.keys()),JSON.parse(e.data).user).del.forEach((e=>{r.get(e).remove(),r.delete(e)}));break;case"reShow":0==r.size&&(console.log(JSON.parse(e.data).user),JSON.parse(e.data).user.forEach((e=>{console.log(e),o(e)})));break;case"move":r.has(JSON.parse(e.data).key)&&r.get(JSON.parse(e.data).key).setLatLng([JSON.parse(JSON.parse(e.data).latlng).lat,JSON.parse(JSON.parse(e.data).latlng).lng])}},n.onopen=function(e){i.value=!1,s().then((e=>{n.send(JSON.stringify({key:e.murmur,type:"open"})),a.value=e.murmur}))},n.onerror=function(){console.log("WebSocket连接发生错误")},n.onclose=function(e){console.log("WebSocket连接失联")},document.getElementById("map").addEventListener("mousemove",(function(t){let{xp:r,yp:i}=function(e){let t=e.clientX,n=e.clientY;return{xp:parseInt(t),yp:parseInt(n)}}(t);const s=lre.point(r,i),o=e.containerPointToLatLng(s);n&&n.send(JSON.stringify({coordinates:o,type:"coordinates",key:a.value}))})),s().then((e=>{n.send(JSON.stringify({key:e.murmur,type:"reShow"})),a.value=e.murmur}))})),er((()=>{n&&n.close()})),(e,t)=>(fi(),yi(li,null,[fre,Ti("div",mre,[gre,(fi(!0),yi(li,null,mr(Dt(r).keys(),((e,t)=>(fi(),yi("div",{class:"userItem",key:t},f(e[0]+e[1]+e[2]),1)))),128))]),ar(Ti("div",vre,null,512),[[is,Dt(i)]])],64))}});var _re=Object.defineProperty,bre=(e,t,n)=>(((e,t,n)=>{t in e?_re(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);const xre=class{constructor(e=1,t=1,n=1,r=1){bre(this,"r",0),bre(this,"g",0),bre(this,"b",0),bre(this,"a",0),this.setTo(e,t,n,r)}convertToHDRRGB(){return this.r=this.r*Math.pow(2.4,this.a),this.g=this.g*Math.pow(2.4,this.a),this.b=this.b*Math.pow(2.4,this.a),this}unSerialized(e){return this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this}hexToRGB(e){this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255}hexToRGBA(e){this.a=(e>>24&255)/255,this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255}static random(e=1){var t=new xre;return t.a=e,t.r=e*Math.random(),t.g=e*Math.random(),t.b=e*Math.random(),t}setTo(e,t,n,r){this.r=Math.max(e,0),this.g=Math.max(t,0),this.b=Math.max(n,0),this.a=Math.max(r,0)}setHex(e){if("string"!=typeof e||xre.NON_HEX_CHARS.test(e)||!xre.VALID_HEX_SIZE.test(e))throw new TypeError("Expected a valid hex string");let t=1;8===(e=e.replace(/^#/,"")).length&&(t=Number.parseInt(e.slice(6,8),16)/255,e=e.slice(0,6)),4===e.length&&(t=Number.parseInt(e.slice(3,4).repeat(2),16)/255,e=e.slice(0,3)),3===e.length&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]);var n=(e=Number.parseInt(e,16))>>16,r=e>>8&255,i=(e=255&e,t);this.a=i,this.r=n/255,this.g=r/255,this.b=e/255}getHex(){var e=e=>{let t=(e*=255).toString(16);return 1===t.length?"0"+t:t};return e(this.r)+e(this.g)+e(this.b)+e(this.a)}get rgb(){return[255*this.r>>>0,255*this.g>>>0,255*this.b>>>0]}set rgb(e){this.setTo(e[0]/255,e[1]/255,e[2]/255,this.a)}get rgba(){return[255*this.r>>>0,255*this.g>>>0,255*this.b>>>0,255*this.a>>>0]}set rgba(e){this.setTo(e[0]/255,e[1]/255,e[2]/255,e[3]/255)}clone(){return(new xre).copyFrom(this)}copyFrom(e){return this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this}copyFromArray(e,t=255){return this.r=e[0]/t,this.g=e[1]/t,this.b=e[2]/t,this.a=e[3]/t,this}copyFromVector(e){return this.r=e.x,this.g=e.y,this.b=e.z,this.a=e.w,this}static hexRGBColor(e,t=null){return(t=t||new xre).hexToRGB(e),t}};let wre=xre;bre(wre,"COLOR_RED",new xre(1,0,0,1)),bre(wre,"COLOR_GREEN",new xre(0,1,0,1)),bre(wre,"COLOR_BLUE",new xre(0,0,1,1)),bre(wre,"COLOR_WHITE",new xre(1,1,1,1)),bre(wre,"COLOR_0",new xre),bre(wre,"COLOR_1",new xre),bre(wre,"COLOR_2",new xre),bre(wre,"HEX_CHARACTERS","a-f\\d"),bre(wre,"MATCH_3OR4_HEX",`#?[${xre.HEX_CHARACTERS}]{3}[${xre.HEX_CHARACTERS}]?`),bre(wre,"MATCH_6OR8_HEX",`#?[${xre.HEX_CHARACTERS}]{6}([${xre.HEX_CHARACTERS}]{2})?`),bre(wre,"NON_HEX_CHARS",new RegExp(`[^#${xre.HEX_CHARACTERS}]`,"gi")),bre(wre,"VALID_HEX_SIZE",new RegExp(`^${xre.MATCH_3OR4_HEX}$|^${xre.MATCH_6OR8_HEX}$`,"i")),bre(wre,"PRIMARY",4149685),bre(wre,"PRIMARYDARK",3162015),bre(wre,"ACCENT",16728193),bre(wre,"WHITE",16777215),bre(wre,"IVORY",16777200),bre(wre,"LIGHTYELLOW",16777184),bre(wre,"YELLOW",16776960),bre(wre,"SNOW",16775930),bre(wre,"FLORALWHITE",16775920),bre(wre,"LEMONCHIFFON",16775885),bre(wre,"CORNSILK",16775388),bre(wre,"SEASHELL",16774638),bre(wre,"LAVENDERBLUSH",16773365),bre(wre,"PAPAYAWHIP",16773077),bre(wre,"BLANCHEDALMOND",16772045),bre(wre,"MISTYROSE",16770273),bre(wre,"BISQUE",16770244),bre(wre,"MOCCASIN",16770229),bre(wre,"NAVAJOWHITE",16768685),bre(wre,"PEACHPUFF",16767673),bre(wre,"GOLD",16766720),bre(wre,"PINK",16761035),bre(wre,"LIGHTPINK",16758465),bre(wre,"ORANGE",16753920),bre(wre,"LIGHTSALMON",16752762),bre(wre,"DARKORANGE",16747520),bre(wre,"CORAL",16744272),bre(wre,"HOTPINK",16738740),bre(wre,"TOMATO",16737095),bre(wre,"ORANGERED",16729344),bre(wre,"DEEPPINK",16716947),bre(wre,"FUCHSIA",16711935),bre(wre,"MAGENTA",16711935),bre(wre,"RED",16711680),bre(wre,"OLDLACE",16643558),bre(wre,"LIGHTGOLDENRODYELLOW",16448210),bre(wre,"LINEN",16445670),bre(wre,"ANTIQUEWHITE",16444375),bre(wre,"SALMON",16416882),bre(wre,"GHOSTWHITE",16316671),bre(wre,"MINTCREAM",16121850),bre(wre,"WHITESMOKE",16119285),bre(wre,"BEIGE",16119260),bre(wre,"WHEAT",16113331),bre(wre,"SANDYBROWN",16032864),bre(wre,"AZURE",15794175),bre(wre,"HONEYDEW",15794160),bre(wre,"ALICEBLUE",15792383),bre(wre,"KHAKI",15787660),bre(wre,"LIGHTCORAL",15761536),bre(wre,"PALEGOLDENROD",15657130),bre(wre,"VIOLET",15631086),bre(wre,"DARKSALMON",15308410),bre(wre,"LAVENDER",15132410),bre(wre,"LIGHTCYAN",14745599),bre(wre,"BURLYWOOD",14596231),bre(wre,"PLUM",14524637),bre(wre,"GAINSBORO",14474460),bre(wre,"CRIMSON",14423100),bre(wre,"PALEVIOLETRED",14381203),bre(wre,"GOLDENROD",14329120),bre(wre,"ORCHID",14315734),bre(wre,"THISTLE",14204888),bre(wre,"LIGHTGREY",13882323),bre(wre,"TAN",13808780),bre(wre,"CHOCOLATE",13789470),bre(wre,"PERU",13468991),bre(wre,"INDIANRED",13458524),bre(wre,"MEDIUMVIOLETRED",13047173),bre(wre,"SILVER",12632256),bre(wre,"DARKKHAKI",12433259),bre(wre,"ROSYBROWN",12357519),bre(wre,"MEDIUMORCHID",12211667),bre(wre,"DARKGOLDENROD",12092939),bre(wre,"FIREBRICK",11674146),bre(wre,"POWDERBLUE",11591910),bre(wre,"LIGHTSTEELBLUE",11584734),bre(wre,"PALETURQUOISE",11529966),bre(wre,"GREENYELLOW",11403055),bre(wre,"LIGHTBLUE",11393254),bre(wre,"DARKGRAY",11119017),bre(wre,"BROWN",10824234),bre(wre,"SIENNA",10506797),bre(wre,"DARKORCHID",10040012),bre(wre,"PALEGREEN",10025880),bre(wre,"DARKVIOLET",9699539),bre(wre,"MEDIUMPURPLE",9662683),bre(wre,"LIGHTGREEN",9498256),bre(wre,"DARKSEAGREEN",9419919),bre(wre,"SADDLEBROWN",9127187),bre(wre,"DARKMAGENTA",9109643),bre(wre,"DARKRED",9109504),bre(wre,"BLUEVIOLET",9055202),bre(wre,"LIGHTSKYBLUE",8900346),bre(wre,"SKYBLUE",8900331),bre(wre,"GRAY",8421504),bre(wre,"OLIVE",8421376),bre(wre,"PURPLE",8388736),bre(wre,"MAROON",8388608),bre(wre,"AQUAMARINE",8388564),bre(wre,"CHARTREUSE",8388352),bre(wre,"LAWNGREEN",8190976),bre(wre,"MEDIUMSLATEBLUE",8087790),bre(wre,"LIGHTSLATEGRAY",7833753),bre(wre,"SLATEGRAY",7372944),bre(wre,"OLIVEDRAB",7048739),bre(wre,"SLATEBLUE",6970061),bre(wre,"DIMGRAY",6908265),bre(wre,"MEDIUMAQUAMARINE",6737322),bre(wre,"CORNFLOWERBLUE",6591981),bre(wre,"CADETBLUE",6266528),bre(wre,"DARKOLIVEGREEN",5597999),bre(wre,"INDIGO",4915330),bre(wre,"MEDIUMTURQUOISE",4772300),bre(wre,"DARKSLATEBLUE",4734347),bre(wre,"STEELBLUE",4620980),bre(wre,"ROYALBLUE",4286945),bre(wre,"TURQUOISE",4251856),bre(wre,"MEDIUMSEAGREEN",3978097),bre(wre,"LIMEGREEN",3329330),bre(wre,"DARKSLATEGRAY",3100495),bre(wre,"SEAGREEN",3050327),bre(wre,"FORESTGREEN",2263842),bre(wre,"LIGHTSEAGREEN",2142890),bre(wre,"DODGERBLUE",2003199),bre(wre,"MIDNIGHTBLUE",1644912),bre(wre,"AQUA",65535),bre(wre,"CYAN",65535),bre(wre,"SPRINGGREEN",65407),bre(wre,"LIME",65280),bre(wre,"MEDIUMSPRINGGREEN",64154),bre(wre,"DARKTURQUOISE",52945),bre(wre,"DEEPSKYBLUE",49151),bre(wre,"DARKCYAN",35723),bre(wre,"TEAL",32896),bre(wre,"GREEN",32768),bre(wre,"DARKGREEN",25600),bre(wre,"BLUE",255),bre(wre,"MEDIUMBLUE",205),bre(wre,"DARKBLUE",139),bre(wre,"NAVY",128),bre(wre,"BLACK",0);class Sre{static start(e){this._startTime=performance.now(),this._timeLabel=e}static end(){console.log(this._timeLabel,performance.now()-this._startTime)}}bre(Sre,"time",0),bre(Sre,"frame",0),bre(Sre,"delta",0),bre(Sre,"_startTime",0),bre(Sre,"_timeLabel","");class Cre{constructor(e=null,t=null){bre(this,"target"),bre(this,"currentTarget"),bre(this,"type"),bre(this,"data"),bre(this,"param"),bre(this,"time",0),bre(this,"delay",0),bre(this,"mouseCode",0),bre(this,"ctrlKey"),bre(this,"altKey"),bre(this,"shiftKey"),bre(this,"targetTouches"),bre(this,"changedTouches"),bre(this,"touches"),bre(this,"_stopImmediatePropagation",!1),bre(this,"view"),this.type=e,this.data=t}stopImmediatePropagation(){this._stopImmediatePropagation=!0}reset(){this._stopImmediatePropagation=!1}get isStopImmediatePropagation(){return this._stopImmediatePropagation}}class Tre{constructor(e=null,t=null,n=null,r=null,i=0){bre(this,"id",0),bre(this,"current"),this.type=e,this.thisObject=t,this.handler=n,this.param=r,this.priority=i}equalCurrentListener(e,t,n,r){return this.type==e&&this.thisObject==n&&this.handler==t&&this.param==r}dispose(){this.handler=null,this.thisObject=null,this.param=null,this.priority=0}}bre(Tre,"event_id_count",0);class Mre{constructor(){bre(this,"listeners",{}),bre(this,"data")}dispatchEvent(e){if(null!=(t=this.listeners[e.type]))for(var t=t.slice(),n=0;n<t.length;n++){var r=t[n];if(r.handler){try{e.param=r.param,(e.currentTarget=r).thisObject,r.handler.call(r.thisObject,e)}catch{}if(e.isStopImmediatePropagation)break}}}destroy(){for(var e in this.listeners)for(var t=this.listeners[e];0<t.length;){var n=t[0];n.handler=null,n.thisObject=null,t.splice(0,1)}}addEventListener(e,t,n,r=null,i=0){if(null==this.listeners[e]&&(this.listeners[e]=[]),!this.hasEventListener(e,t,n))return(i=new Tre(e,n,t,r,i)).id=++Tre.event_id_count,(i.current=this).listeners[e].push(i),this.listeners[e].sort((function(e,t){return t.priority-e.priority})),i.id;for(let s=0;s<this.listeners[e].length;s++){var a=this.listeners[e][s];if(a.equalCurrentListener(e,t,n,r))return a.id}return 0}removeEventListener(e,t,n){if(this.hasEventListener(e,t,n))for(var r=0;r<this.listeners[e].length;r++){var i=this.listeners[e][r];if(i.equalCurrentListener(e,t,n,i.param))return i.handler=null,i.thisObject=null,void this.listeners[e].splice(r,1)}}removeEventListenerAt(e){for(var t in this.listeners)for(var n=0;n<this.listeners[t].length;n++){var r=this.listeners[t][n];if(r.id==e)return r.handler=null,r.thisObject=null,this.listeners[t].splice(n,1),!0}return!1}removeAllEventListener(e=null){if(e){if(this.listeners[e]){for(var t=0;t<this.listeners[e].length;t++)this.listeners[e][t].dispose(),this.listeners[e].splice(t,1);delete this.listeners[e]}}else for(var n in this.listeners){for(t=0;t<this.listeners[n].length;t++)this.listeners[n][t].dispose(),this.listeners[n].splice(t,1);delete this.listeners[n]}}containEventListener(e){return null!=this.listeners[e]&&0<this.listeners[e].length}hasEventListener(e,t=null,n=null){if(null!=this.listeners[e]&&n&&t)for(var r=0;r<this.listeners[e].length;r++){var i=this.listeners[e][r];if(i.equalCurrentListener(e,t,n,i.param))return!0}return!1}}class Ere extends Cre{constructor(){super(...arguments),bre(this,"keyCode",0)}}bre(Ere,"KEY_DOWN","onKeyDown"),bre(Ere,"KEY_UP","onKeyUp");let Are=class extends Cre{constructor(){super(...arguments),bre(this,"pointerId"),bre(this,"pointerType"),bre(this,"isPrimary"),bre(this,"pressure"),bre(this,"mouseX"),bre(this,"mouseY"),bre(this,"movementX"),bre(this,"movementY"),bre(this,"deltaX"),bre(this,"deltaY"),bre(this,"deltaZ")}reset(){super.reset(),this.mouseX=0,this.mouseY=0,this.movementX=0,this.movementY=0,this.deltaX=0,this.deltaY=0,this.deltaZ=0}};bre(Are,"PICK_OVER","onPickOver"),bre(Are,"PICK_OVER_GUI","onPickOverGUI"),bre(Are,"PICK_CLICK","onPickClick"),bre(Are,"PICK_CLICK_GUI","onPickClickGUI"),bre(Are,"PICK_OUT","onPickOut"),bre(Are,"PICK_OUT_GUI","onPickOutGUI"),bre(Are,"PICK_MOVE","onPickMove"),bre(Are,"PICK_UP","onPickUp"),bre(Are,"PICK_UP_GUI","onPickUpGUI"),bre(Are,"PICK_DOWN","onPickDown"),bre(Are,"PICK_DOWN_GUI","onPickDownGUI"),bre(Are,"POINTER_RIGHT_CLICK","onPointerRightClick"),bre(Are,"POINTER_MID_UP","onPointerMidUp"),bre(Are,"POINTER_MID_DOWN","onPointerMidDown"),bre(Are,"POINTER_CLICK","onPointerClick"),bre(Are,"POINTER_MOVE","onPointerMove"),bre(Are,"POINTER_DOWN","onPointerDown"),bre(Are,"POINTER_UP","onPointerUp"),bre(Are,"POINTER_OUT","onPointerOut"),bre(Are,"POINTER_OVER","onPointerOver"),bre(Are,"POINTER_WHEEL","onPointerWheel");const Pre=class{constructor(e=0,t=0,n=0,r=0){bre(this,"x",0),bre(this,"y",0),bre(this,"z",0),bre(this,"w",1),bre(this,"index",0),this.set(e,t,n,r),this.index=Pre._index++}static get ZERO(){return new Pre(0,0,0)}static get ONE(){return new Pre(1,1,1)}static get LEFT(){return new Pre(-1,0,0)}static get RIGHT(){return new Pre(1,0,0)}static get UP(){return new Pre(0,1,0)}static get DOWN(){return new Pre(0,-1,0)}static get BACK(){return new Pre(0,0,-1)}static get FORWARD(){return new Pre(0,0,1)}set a(e){this.w=e}set r(e){this.x=e}set g(e){this.y=e}set b(e){this.z=e}get a(){return this.w}get r(){return this.x}get g(){return this.y}get b(){return this.z}get length(){return Math.sqrt(this.lengthSquared)}get lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z}get position(){return this}static getTowPointbyDir(e,t,n,r,i){i==Pre.Z_AXIS?(t.x=e.y,t.y=-e.x,n.x=-e.y,n.y=e.x,t.scaleBy(.5*r),n.scaleBy(.5*r)):i==Pre.Y_AXIS&&(t.x=e.z,t.z=-e.x,n.x=-e.z,n.z=e.x,t.scaleBy(.5*r),n.scaleBy(.5*r))}static pointToLine(e,t,n){let r,i,a,s=0;return r=Pre.distance(e,t),i=Pre.distance(e,n),s=(a=Pre.distance(t,n))<=1e-6||i<=1e-6?0:r<=1e-6||r*r+i*i<=a*a?i:r*r+a*a<=i*i?a:(e=(r+i+a)/2,2*Math.sqrt(e*(e-r)*(e-i)*(e-a))/r),s}static cross(e,t,n=null){return(n=n||new Pre).x=e.y*t.z-e.z*t.y,n.y=e.z*t.x-e.x*t.z,n.z=e.x*t.y-e.y*t.x,n.w=1,n}static dot(e,t){return e.x*t.x+e.y*t.y+e.z*t.z}static getPoints(e,t){var n=[];for(let i=0;i<e;i++){var r=new Pre(Math.random()*t-.5*t,Math.random()*t-.5*t,Math.random()*t-.5*t);n.push(r)}return n}static getPointNumbers(e,t){var n=[];for(let r=0;r<e;r++)n.push(Math.random()*t-.5*t,Math.random()*t-.5*t,Math.random()*t-.5*t);return n}static getAngle(e,t){return e=e.dotProduct(t)/(e.length*t.length),180*Math.acos(e)/Math.PI}static sqrMagnitude(e){return e.x*e.x+e.y*e.y+e.z*e.z}static getZYAngle(e,t){return this.calAngle(e.y,e.z,t.y,t.z)}static sub(e,t,n=null){return(n=n||new Pre).x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z,n}static add(e,t,n=null){return(n=n||new Pre).x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z,n}static smoothDamp(e,t,n,r,i,a){return null}static distance(e,t){var n=e.x-t.x,r=e.y-t.y;e=e.z-t.z;return Math.sqrt(n*n+r*r+e*e)}static distanceXZ(e,t){var n=e.x-t.x;e=e.z-t.z;return Math.sqrt(n*n+0+e*e)}set(e,t,n,r=1){return this.x=e,this.y=t,this.z=n,this.w=r,this}add(e,t=null){t=t||new Pre;var n=this.x,r=this.y,i=this.z,a=this.w,s=e.x,o=e.y,l=e.z;e=e.w;return t.setTo(n+s,r+o,i+l,a+e),t}addXYZW(e,t,n,r,i=null){i=i||new Pre;var a=this.x,s=this.y,o=this.z,l=this.w;return i.setTo(a+e,s+t,o+n,l+r),i}clone(){return new Pre(this.x,this.y,this.z,this.w)}copyFrom(e){var t=this;return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}crossProduct(e,t=null){return(t=t||new Pre).x=this.y*e.z-this.z*e.y,t.y=this.z*e.x-this.x*e.z,t.z=this.x*e.y-this.y*e.x,t.w=1,t}decrementBy(e){this.x-=e.x,this.y-=e.y,this.z-=e.z}dotProduct(e){return this.x*e.x+this.y*e.y+this.z*e.z}equals(e,t=!1){return this.x==e.x&&this.y==e.y&&this.z==e.z&&(!t||this.w==e.w)}incrementBy(e){this.x+=e.x,this.y+=e.y,this.z+=e.z}divide(e){return e instanceof Pre?new Pre(this.x/e.x,this.y/e.y,this.z/e.z):(this.x=this.x/e,this.y=this.y/e,this.z=this.z/e,this)}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}normalize(e=1){return 0!=this.length&&(e/=this.length,this.x*=e,this.y*=e,this.z*=e),this}applyQuaternion(e){var t=this.x,n=this.y,r=this.z,i=e.x,a=e.y,s=e.z,o=(e=e.w)*t+a*r-s*n,l=e*n+s*t-i*r,u=e*r+i*n-a*t;t=-i*t-a*n-s*r;return this.x=o*e+t*-i+l*-s-u*-a,this.y=l*e+t*-a+u*-i-o*-s,this.z=u*e+t*-s+o*-a-l*-i,this}scaleBy(e){return this.x*=e,this.y*=e,this.z*=e,this}mul(e){var t=new Pre;return t.x=this.x*e,t.y=this.y*e,t.z=this.z*e,t}scale(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}scaleToRef(e,t){return(t=t||new Pre).x=this.x*e,t.y=this.y*e,t.z=this.z*e,t}setTo(e,t,n,r=1){this.x=e,this.y=t,this.z=n,this.w=r}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}subtract(e,t=null){return(t=t||new Pre).setTo(this.x-e.x,this.y-e.y,this.z-e.z),t}multiply(e,t=null){t=t||new Pre;var n=this.x,r=this.y,i=this.z,a=e.x,s=e.y;e=e.z;return t.setTo(n*a,r*s,i*e),t}divided(e,t=null){t=t||new Pre;var n=this.x,r=this.y,i=this.z,a=e.x,s=e.y;e=e.z;return t.setTo(n/a,r/s,i/e),t}div(e,t){t=t||new Pre;var n=this.x,r=this.y,i=this.z,a=this.w;return t.setTo(n/e,r/e,i/e,a/e),t}lerp(e,t,n){var r=e.x,i=e.y,a=e.z,s=(e=e.w,t.x),o=t.y,l=t.z;t=t.w;this.x=(s-r)*n+r,this.y=(o-i)*n+i,this.z=(l-a)*n+a,this.w=(t-e)*n+e}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}toString(){return"<"+this.x+", "+this.y+", "+this.z+">"}normalizeToWay2D_XY(){var e=Math.abs(this.x);Math.abs(this.y)<e?0<this.x?this.copyFrom(Pre.RIGHT):this.copyFrom(Pre.LEFT):0<this.y?this.copyFrom(Pre.DOWN):this.copyFrom(Pre.UP)}toArray(){return[this.x,this.y,this.z]}copyToBytes(e){e.setFloat32(0*Float32Array.BYTES_PER_ELEMENT,this.x,!0),e.setFloat32(+Float32Array.BYTES_PER_ELEMENT,this.y,!0),e.setFloat32(2*Float32Array.BYTES_PER_ELEMENT,this.z,!0)}cross(e,t=null){return(t=t||new Pre).x=this.y*e.z-this.z*e.y,t.y=this.z*e.x-this.x*e.z,t.z=this.x*e.y-this.y*e.x,t.w=1,t}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}setFromArray(e,t=0){this.x=e[t],this.y=e[t+1],this.z=e[t+2]}divideScalar(e){return this.multiplyScalar(1/e)}clampLength(e,t){var n=this.length;return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}setScalar(e){return this.x=e,this.y=e,this.z=e,this}static calAngle(e,t,n,r){var i,a;r=((i=[n-e,r-t])[0]*(a=[0,-1])[0]+i[1]*a[1])/(i=Math.sqrt(i[0]*i[0]+i[1]*i[1])*Math.sqrt(a[0]*a[0]+a[1]*a[1]));let s=180*Math.acos(r)/Math.PI;return n<e?-s:s}};let Rre=Pre;bre(Rre,"MAX",new Pre(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)),bre(Rre,"MIN",new Pre(Number.MIN_VALUE,Number.MIN_VALUE,Number.MIN_VALUE)),bre(Rre,"SAFE_MAX",new Pre(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER)),bre(Rre,"SAFE_MIN",new Pre(Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER)),bre(Rre,"X_AXIS",new Pre(1,0,0)),bre(Rre,"neg_X_AXIS",new Pre(-1,0,0)),bre(Rre,"Y_AXIS",new Pre(0,1,0)),bre(Rre,"Z_AXIS",new Pre(0,0,1)),bre(Rre,"HELP_0",new Pre),bre(Rre,"HELP_1",new Pre),bre(Rre,"HELP_2",new Pre),bre(Rre,"EPSILON",1e-5),bre(Rre,"HELP_3",new Pre),bre(Rre,"HELP_4",new Pre),bre(Rre,"HELP_5",new Pre),bre(Rre,"HELP_6",new Pre),bre(Rre,"_index",0);class Lre{constructor(e){bre(this,"canvasX"),bre(this,"canvasY"),bre(this,"identifier"),bre(this,"clientX"),bre(this,"clientY"),bre(this,"pageX"),bre(this,"pageY"),bre(this,"screenX"),bre(this,"screenY"),this.canvasX=e.clientX,this.canvasY=e.clientY,this.identifier=e.identifier,this.clientX=e.clientX,this.clientY=e.clientY,this.pageX=e.pageX,this.pageY=e.pageY,this.screenX=e.screenX,this.screenY=e.screenY}}class kre extends Mre{constructor(){super(...arguments),bre(this,"canvasX",0),bre(this,"canvasY",0),bre(this,"isMouseDown",!1),bre(this,"isRightMouseDown",!1),bre(this,"canvas"),bre(this,"mouseX",0),bre(this,"mouseY",0),bre(this,"wheelDelta",0),bre(this,"mouseOffsetX",0),bre(this,"mouseOffsetY",0),bre(this,"mouseLastX",0),bre(this,"mouseLastY",0),bre(this,"_time",0),bre(this,"_keyStatus"),bre(this,"_mouseStatus"),bre(this,"_isTouchStart"),bre(this,"_keyEvent3d"),bre(this,"_pointerEvent3D"),bre(this,"_windowsEvent3d"),bre(this,"_gp",!1),bre(this,"_oldPosition1",null),bre(this,"_oldPosition2",null),bre(this,"_downTime",0)}initCanvas(e){(this.canvas=e).onpointerdown=e=>{0==e.button?this.mouseStart(e):1==e.button?this.middleDown(e):2==e.button&&this.mouseStart(e)},e.onpointerup=e=>{0==e.button?this.mouseEnd(e):1==e.button?this.middleUp(e):2==e.button&&this.mouseEnd(e)},e.onpointerenter=e=>{this.mouseOver(e)},e.onpointermove=e=>{this.mouseMove(e)},e.onpointercancel=e=>{this.mouseEnd(e)},e.onpointerleave=e=>{this.mouseEnd(e)},e.onpointerout=e=>{this.mouseEnd(e)},e.addEventListener("click",(e=>{2==e.button?(this.isRightMouseDown=!1,this.rightClick(e)):0==e.button&&(this.isMouseDown=!1,this.mouseClick(e))}),!0),e.addEventListener("wheel",(e=>this.mouseWheel(e)),{passive:!1}),window.addEventListener("keydown",(e=>this.keyDown(e)),!0),window.addEventListener("keyup",(e=>this.keyUp(e)),!0),e.oncontextmenu=function(){return!1},e=this.canvas.getBoundingClientRect(),this.canvasX=e.left,this.canvasY=e.top,this._keyStatus={},this._mouseStatus={},this._isTouchStart=!1,this._keyEvent3d=new Ere,this._pointerEvent3D=new Are,this._windowsEvent3d=new Cre}onPinch(e,t,n,r){this._oldPosition1=new Rre(e,t),this._oldPosition2=new Rre(n,r)}onSwipe(e,t){this.mouseX=e,this.mouseY=t,this._oldPosition1=null,this._oldPosition2=null,this._time=(new Date).getTime()}GetTargetTouches(e){for(var t=new Array,n=0;n<e.length;n++){var r=new Lre(e[n]);t.push(r)}return t}rightClick(e){this._pointerEvent3D.reset(),this._pointerEvent3D.mouseCode=e.button,this._pointerEvent3D.mouseX=e.clientX-this.canvasX,this._pointerEvent3D.mouseY=e.clientY-this.canvasY,this._pointerEvent3D.type=Are.POINTER_RIGHT_CLICK,this._pointerEvent3D.ctrlKey=e.ctrlKey,this._pointerEvent3D.altKey=e.altKey,this._pointerEvent3D.shiftKey=e.shiftKey,this.dispatchEvent(this._pointerEvent3D)}middleDown(e){this._pointerEvent3D.reset(),this._pointerEvent3D.mouseCode=e.button,this._pointerEvent3D.mouseX=e.clientX-this.canvasX,this._pointerEvent3D.mouseY=e.clientY-this.canvasY,this._pointerEvent3D.type=Are.POINTER_MID_DOWN,this._pointerEvent3D.ctrlKey=e.ctrlKey,this._pointerEvent3D.altKey=e.altKey,this._pointerEvent3D.shiftKey=e.shiftKey,this._pointerEvent3D.pointerId=e.pointerId,this._pointerEvent3D.pointerType=e.pointerType,this._pointerEvent3D.isPrimary=e.isPrimary,this._pointerEvent3D.pressure=e.pressure,this.dispatchEvent(this._pointerEvent3D)}middleUp(e){this._pointerEvent3D.reset(),this._pointerEvent3D.mouseCode=e.button,this._pointerEvent3D.mouseX=e.clientX-this.canvasX,this._pointerEvent3D.mouseY=e.clientY-this.canvasY,this._pointerEvent3D.type=Are.POINTER_MID_UP,this._pointerEvent3D.ctrlKey=e.ctrlKey,this._pointerEvent3D.altKey=e.altKey,this._pointerEvent3D.shiftKey=e.shiftKey,this._pointerEvent3D.pointerId=e.pointerId,this._pointerEvent3D.pointerType=e.pointerType,this._pointerEvent3D.isPrimary=e.isPrimary,this._pointerEvent3D.pressure=e.pressure,this.dispatchEvent(this._pointerEvent3D)}mouseClick(e){this._pointerEvent3D.reset(),this._pointerEvent3D.mouseCode=e.button,this._pointerEvent3D.mouseX=e.clientX-this.canvasX,this._pointerEvent3D.mouseY=e.clientY-this.canvasY,this._pointerEvent3D.type=Are.POINTER_CLICK,this._pointerEvent3D.ctrlKey=e.ctrlKey,this._pointerEvent3D.altKey=e.altKey,this._pointerEvent3D.shiftKey=e.shiftKey,this.dispatchEvent(this._pointerEvent3D)}mouseEnd(e){this.isMouseDown=!1,this.mouseLastX=this.mouseX,this.mouseLastY=this.mouseY,this.mouseX=e.clientX-this.canvasX,this.mouseY=e.clientY-this.canvasY,this.mouseOffsetX=this.mouseX-this.mouseLastX,this.mouseOffsetY=this.mouseY-this.mouseLastY,this._pointerEvent3D.reset(),this._pointerEvent3D.mouseCode=e.button,this._mouseStatus[this._pointerEvent3D.mouseCode]=!1,this._pointerEvent3D.type=Are.POINTER_UP,this._pointerEvent3D.ctrlKey=e.ctrlKey,this._pointerEvent3D.altKey=e.altKey,this._pointerEvent3D.shiftKey=e.shiftKey,this._pointerEvent3D.pointerId=e.pointerId,this._pointerEvent3D.pointerType=e.pointerType,this._pointerEvent3D.isPrimary=e.isPrimary,this._pointerEvent3D.pressure=e.pressure,this._pointerEvent3D.mouseX=this.mouseX,this._pointerEvent3D.mouseY=this.mouseY,this.dispatchEvent(this._pointerEvent3D)}mouseStart(e){this.isMouseDown=!0,this.mouseLastX=this.mouseX,this.mouseLastY=this.mouseY,this.mouseX=e.clientX-this.canvasX,this.mouseY=e.clientY-this.canvasY,this.mouseOffsetX=this.mouseX-this.mouseLastX,this.mouseOffsetY=this.mouseY-this.mouseLastY,this._pointerEvent3D.reset(),this._pointerEvent3D.mouseCode=e.button,this._pointerEvent3D.ctrlKey=e.ctrlKey,this._pointerEvent3D.altKey=e.altKey,this._pointerEvent3D.shiftKey=e.shiftKey,this._pointerEvent3D.pointerId=e.pointerId,this._pointerEvent3D.pointerType=e.pointerType,this._pointerEvent3D.isPrimary=e.isPrimary,this._pointerEvent3D.pressure=e.pressure,this._pointerEvent3D.mouseX=this.mouseX,this._pointerEvent3D.mouseY=this.mouseY,this._pointerEvent3D.type=Are.POINTER_DOWN,this.dispatchEvent(this._pointerEvent3D)}mouseMove(e){this.mouseLastX=this.mouseX,this.mouseLastY=this.mouseY,this.mouseX=e.clientX-this.canvasX,this.mouseY=e.clientY-this.canvasY,this.mouseOffsetX=this.mouseX-this.mouseLastX,this.mouseOffsetY=this.mouseY-this.mouseLastY,this._pointerEvent3D.reset(),this._pointerEvent3D.type=Are.POINTER_MOVE,this._pointerEvent3D.ctrlKey=e.ctrlKey,this._pointerEvent3D.altKey=e.altKey,this._pointerEvent3D.shiftKey=e.shiftKey,this._pointerEvent3D.pointerId=e.pointerId,this._pointerEvent3D.pointerType=e.pointerType,this._pointerEvent3D.isPrimary=e.isPrimary,this._pointerEvent3D.pressure=e.pressure,this._pointerEvent3D.mouseX=this.mouseX,this._pointerEvent3D.mouseY=this.mouseY,this._pointerEvent3D.movementX=e.movementX,this._pointerEvent3D.movementY=e.movementY,this.dispatchEvent(this._pointerEvent3D)}mouseOver(e){this.isMouseDown=!1,this.mouseLastX=this.mouseX,this.mouseLastY=this.mouseY,this.mouseX=e.clientX-this.canvasX,this.mouseY=e.clientY-this.canvasY,this.mouseOffsetX=this.mouseX-this.mouseLastX,this.mouseOffsetY=this.mouseY-this.mouseLastY,this._pointerEvent3D.reset(),this._pointerEvent3D.type=Are.POINTER_OVER,this._pointerEvent3D.ctrlKey=e.ctrlKey,this._pointerEvent3D.altKey=e.altKey,this._pointerEvent3D.shiftKey=e.shiftKey,this._pointerEvent3D.pointerId=e.pointerId,this._pointerEvent3D.pointerType=e.pointerType,this._pointerEvent3D.isPrimary=e.isPrimary,this._pointerEvent3D.pressure=e.pressure,this._pointerEvent3D.mouseX=this.mouseX,this._pointerEvent3D.mouseY=this.mouseY,this.dispatchEvent(this._pointerEvent3D)}mouseWheel(e){e.preventDefault(),this.mouseLastX=this.mouseX,this.mouseLastY=this.mouseY,this.mouseX=e.clientX-this.canvasX,this.mouseY=e.clientY-this.canvasY,this.mouseOffsetX=this.mouseX-this.mouseLastX,this.mouseOffsetY=this.mouseY-this.mouseLastY,"wheelDelta"in e?(this._pointerEvent3D.delay=e.wheelDelta,this.wheelDelta=e.wheelDelta):"delta"in e&&(this.wheelDelta=e.delta),this._pointerEvent3D.reset(),this._pointerEvent3D.type=Are.POINTER_WHEEL,this._pointerEvent3D.ctrlKey=e.ctrlKey,this._pointerEvent3D.altKey=e.altKey,this._pointerEvent3D.shiftKey=e.shiftKey,this._pointerEvent3D.mouseX=this.mouseX,this._pointerEvent3D.mouseY=this.mouseY,this._pointerEvent3D.deltaX=e.deltaX,this._pointerEvent3D.deltaY=e.deltaY,this._pointerEvent3D.deltaZ=e.deltaZ,this.dispatchEvent(this._pointerEvent3D)}keyDown(e){this._keyEvent3d.reset(),this._keyEvent3d.keyCode=e.keyCode,this._keyEvent3d.ctrlKey=e.ctrlKey,this._keyEvent3d.altKey=e.altKey,this._keyEvent3d.shiftKey=e.shiftKey,this._keyStatus[e.keyCode]||(this._keyStatus[e.keyCode]=!0,this._keyEvent3d.type=Ere.KEY_DOWN,this.dispatchEvent(this._keyEvent3d))}keyUp(e){this._keyEvent3d.reset(),this._keyEvent3d.keyCode=e.keyCode,this._keyStatus[e.keyCode]=!1,this._keyEvent3d.type=Ere.KEY_UP,this.dispatchEvent(this._keyEvent3d)}GetSlideAngle(e,t){return 180*Math.atan2(t,e)/Math.PI}GetSlideDirection(e,t,n,r){return t-=r,r=n-e,n=0,Math.abs(r)<2&&Math.abs(t)<2||(-45<=(e=this.GetSlideAngle(r,t))&&e<45?n=4:45<=e&&e<135?n=1:-135<=e&&e<-45?n=2:(135<=e&&e<=180||-180<=e&&e<-135)&&(n=3)),n}}let Dre=new class{constructor(){bre(this,"adapter"),bre(this,"device"),bre(this,"context"),bre(this,"aspect"),bre(this,"presentationSize",[0,0]),bre(this,"presentationFormat"),bre(this,"canvas"),bre(this,"windowWidth"),bre(this,"windowHeight"),bre(this,"canvasConfig"),bre(this,"super",1)}get pixelRatio(){var e;return(null==(e=this.canvasConfig)?void 0:e.devicePixelRatio)||window.devicePixelRatio||1}async init(e){if((this.canvasConfig=e)&&e.canvas){if(this.canvas=e.canvas,null===this.canvas)throw new Error("no Canvas");var t=this.canvas.clientWidth,n=this.canvas.clientHeight;this.resize(this.canvas.clientWidth,this.canvas.clientHeight),t!=this.canvas.clientWidth&&(this.canvas.style.width=t+"px"),n!=this.canvas.clientHeight&&(this.canvas.style.width=n+"px")}else this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",this.canvas.style.top="0px",this.canvas.style.left="0px",this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.zIndex=null!=e&&e.zIndex?e.zIndex.toString():"0",document.body.appendChild(this.canvas);if(e&&e.backgroundImage?(this.canvas.style.background=`url(${e.backgroundImage})`,this.canvas.style["background-size"]="cover",this.canvas.style["background-position"]="center"):this.canvas.style.background="transparent",this.canvas.style["touch-action"]="none",this.canvas.style["object-fit"]="cover",void 0===navigator.gpu)throw new Error("Your browser is not support webgpu!");if(this.adapter=await navigator.gpu.requestAdapter({powerPreference:"high-performance"}),null==this.adapter)throw new Error("Your browser is not support webgpu!");if(this.device=await this.adapter.requestDevice({requiredLimits:{minUniformBufferOffsetAlignment:256,maxStorageBufferBindingSize:this.adapter.limits.maxStorageBufferBindingSize}}),null==this.device)throw new Error("Your browser is not support webgpu!");let r;return this.device.label="device",this.presentationFormat=navigator.gpu.getPreferredCanvasFormat(),this.context=this.canvas.getContext("webgpu"),this.context.configure({device:this.device,format:this.presentationFormat,usage:GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT,alphaMode:"premultiplied",colorSpace:"display-p3"}),this.resize(this.canvas.clientWidth,this.canvas.clientHeight),new ResizeObserver((()=>{clearTimeout(r),r=setTimeout((()=>{this.resize(this.canvas.clientWidth,this.canvas.clientHeight)}),50)})).observe(this.canvas),!0}resize(e,t){this.canvas.width=this.windowWidth=Math.floor(e*this.pixelRatio*this.super),this.canvas.height=this.windowHeight=Math.floor(t*this.pixelRatio*this.super),this.presentationSize[0]=this.windowWidth,this.presentationSize[1]=this.windowHeight,this.aspect=this.windowWidth/this.windowHeight}};class Ire{}bre(Ire,"Bloom_Brightness_frag_wgsl","\n    struct uniformData {\n        luminosityThreshold: f32\n    };\n\n    struct FragmentOutput {\n        @location(0) o_Target: vec4<f32>\n    };\n\n    var<private> fragUV1: vec2<f32>;\n    var<private> o_Target: vec4<f32>;\n    @group(1) @binding(0)\n    var baseMapSampler: sampler;\n    @group(1) @binding(1)\n    var baseMap: texture_2d<f32>;\n    @group(2) @binding(0)\n    var<uniform> global: uniformData;\n\n    fn Brightness(c: vec3<f32>) -> f32 {\n        var c1: vec3<f32>;\n\n        c1 = c;\n        let e8: vec3<f32> = c1;\n        let e10: vec3<f32> = c1;\n        let e12: vec3<f32> = c1;\n        let e14: vec3<f32> = c1;\n        let e17: vec3<f32> = c1;\n        let e19: vec3<f32> = c1;\n        let e21: vec3<f32> = c1;\n        let e23: vec3<f32> = c1;\n        let e25: vec3<f32> = c1;\n        let e28: vec3<f32> = c1;\n        return max(max(e23.x, e25.y), e28.z);\n    }\n\n    fn main1() {\n        var uv: vec2<f32>;\n        var LinearColor: vec4<f32>;\n        var TotalLuminance: f32;\n        var BloomLuminance: f32;\n        var BloomAmount: f32;\n\n        let e6: vec2<f32> = fragUV1;\n        uv = e6.xy;\n        let e11: vec2<f32> = uv;\n        uv.y = (1.0 - e11.y);\n        let e15: vec2<f32> = uv;\n        let e16: vec4<f32> = textureSample(baseMap, baseMapSampler, e15);\n        LinearColor = e16;\n        let e18: vec4<f32> = LinearColor;\n        let e27: vec4<f32> = LinearColor;\n        let e36: vec4<f32> = LinearColor;\n        let e38: vec3<f32> = min(vec3<f32>(f32(65000), f32(65000), f32(65000)), e36.xyz);\n        LinearColor.x = e38.x;\n        LinearColor.y = e38.y;\n        LinearColor.z = e38.z;\n        let e45: vec4<f32> = LinearColor;\n        let e47: vec4<f32> = LinearColor;\n        let e49: f32 = Brightness(e47.xyz);\n        TotalLuminance = e49;\n        let e51: f32 = TotalLuminance;\n        let e52: f32 = global.luminosityThreshold;\n        BloomLuminance = (e51 - e52);\n        let e55: f32 = BloomLuminance;\n        let e60: f32 = BloomLuminance;\n        BloomAmount = clamp((e60 * 0.5), 0.0, 1.0);\n        let e67: f32 = BloomAmount;\n        let e68: vec4<f32> = LinearColor;\n        o_Target = vec4<f32>((e67 * e68.xyz), f32(0));\n        return;\n    }\n\n    @fragment\n    fn main(@location(0) fragUV: vec2<f32>) -> FragmentOutput {\n        fragUV1 = fragUV;\n        main1();\n        let e13: vec4<f32> = o_Target;\n        return FragmentOutput(e13);\n    }\n    "),bre(Ire,"Bloom_blur_frag_wgsl","\n      struct uniformData {\n          texSize: vec2<f32>,\n          hScale: f32,\n          vScale: f32,\n          horizontal: f32\n      };\n\n      struct FragmentOutput {\n          @location(0) o_Target: vec4<f32>\n      };\n\n      var<private> fragUV1: vec2<f32>;\n      var<private> o_Target: vec4<f32>;\n      @group(1) @binding(0)\n      var baseMapSampler: sampler;\n      @group(1) @binding(1)\n      var baseMap: texture_2d<f32>;\n      @group(2) @binding(0)\n      var<uniform> global: uniformData;\n\n      fn main1() {\n          var uv: vec2<f32>;\n          var tex_offset: vec2<f32>;\n          var result: vec3<f32>;\n          var i: i32 = 1;\n          var local: array<f32,5> = array<f32,5>(0.22702699899673462, 0.194594606757164, 0.12162160128355026, 0.05405399948358536, 0.01621600054204464);\n          var local1: array<f32,5> = array<f32,5>(0.22702699899673462, 0.194594606757164, 0.12162160128355026, 0.05405399948358536, 0.01621600054204464);\n          var j: i32 = 1;\n          var local2: array<f32,5> = array<f32,5>(0.22702699899673462, 0.194594606757164, 0.12162160128355026, 0.05405399948358536, 0.01621600054204464);\n          var local3: array<f32,5> = array<f32,5>(0.22702699899673462, 0.194594606757164, 0.12162160128355026, 0.05405399948358536, 0.01621600054204464);\n\n          let e13: vec2<f32> = fragUV1;\n          uv = e13.xy;\n          let e18: vec2<f32> = uv;\n          uv.y = (1.0 - e18.y);\n          let e22: vec2<f32> = global.texSize;\n          tex_offset = (vec2<f32>(1.0) / vec2<f32>(e22));\n          let e28: vec2<f32> = uv;\n          let e29: vec4<f32> = textureSample(baseMap, baseMapSampler, e28);\n          result = (e29.xyz * array<f32,5>(0.22702699899673462, 0.194594606757164, 0.12162160128355026, 0.05405399948358536, 0.01621600054204464)[0]);\n          let e35: f32 = global.horizontal;\n          if ((e35 > 1.0)) {\n              {\n                  loop {\n                      let e40: i32 = i;\n                      if (!((e40 < 5))) {\n                          break;\n                      }\n                      {\n                          let e47: vec3<f32> = result;\n                          let e48: vec2<f32> = uv;\n                          let e49: vec2<f32> = tex_offset;\n                          let e51: i32 = i;\n                          let e54: f32 = global.hScale;\n                          let e59: vec2<f32> = uv;\n                          let e60: vec2<f32> = tex_offset;\n                          let e62: i32 = i;\n                          let e65: f32 = global.hScale;\n                          let e70: vec4<f32> = textureSample(baseMap, baseMapSampler, (e59 + vec2<f32>(((e60.x * f32(e62)) * e65), 0.0)));\n                          let e72: i32 = i;\n                          let e75: f32 = local[e72];\n                          result = (e47 + (e70.xyz * e75));\n                          let e78: vec3<f32> = result;\n                          let e79: vec2<f32> = uv;\n                          let e80: vec2<f32> = tex_offset;\n                          let e82: i32 = i;\n                          let e85: f32 = global.hScale;\n                          let e90: vec2<f32> = uv;\n                          let e91: vec2<f32> = tex_offset;\n                          let e93: i32 = i;\n                          let e96: f32 = global.hScale;\n                          let e101: vec4<f32> = textureSample(baseMap, baseMapSampler, (e90 - vec2<f32>(((e91.x * f32(e93)) * e96), 0.0)));\n                          let e103: i32 = i;\n                          let e106: f32 = local1[e103];\n                          result = (e78 + (e101.xyz * e106));\n                      }\n                      continuing {\n                          let e44: i32 = i;\n                          i = (e44 + 1);\n                      }\n                  }\n              }\n          }\n          let e109: f32 = global.horizontal;\n          if ((e109 < 1.0)) {\n              {\n                  loop {\n                      let e114: i32 = j;\n                      if (!((e114 < 5))) {\n                          break;\n                      }\n                      {\n                          let e121: vec3<f32> = result;\n                          let e122: vec2<f32> = uv;\n                          let e124: vec2<f32> = tex_offset;\n                          let e126: i32 = j;\n                          let e129: f32 = global.vScale;\n                          let e133: vec2<f32> = uv;\n                          let e135: vec2<f32> = tex_offset;\n                          let e137: i32 = j;\n                          let e140: f32 = global.vScale;\n                          let e144: vec4<f32> = textureSample(baseMap, baseMapSampler, (e133 + vec2<f32>(0.0, ((e135.y * f32(e137)) * e140))));\n                          let e146: i32 = j;\n                          let e149: f32 = local2[e146];\n                          result = (e121 + (e144.xyz * e149));\n                          let e152: vec3<f32> = result;\n                          let e153: vec2<f32> = uv;\n                          let e155: vec2<f32> = tex_offset;\n                          let e157: i32 = j;\n                          let e160: f32 = global.vScale;\n                          let e164: vec2<f32> = uv;\n                          let e166: vec2<f32> = tex_offset;\n                          let e168: i32 = j;\n                          let e171: f32 = global.vScale;\n                          let e175: vec4<f32> = textureSample(baseMap, baseMapSampler, (e164 - vec2<f32>(0.0, ((e166.y * f32(e168)) * e171))));\n                          let e177: i32 = j;\n                          let e180: f32 = local3[e177];\n                          result = (e152 + (e175.xyz * e180));\n                      }\n                      continuing {\n                          let e118: i32 = j;\n                          j = (e118 + 1);\n                      }\n                  }\n              }\n          }\n          let e183: vec3<f32> = result;\n          o_Target = vec4<f32>(e183, 1.0);\n          return;\n      }\n\n      @fragment\n      fn main(@location(0) fragUV: vec2<f32>) -> FragmentOutput {\n          fragUV1 = fragUV;\n          main1();\n          let e27: vec4<f32> = o_Target;\n          return FragmentOutput(e27);\n      }\n      "),bre(Ire,"Bloom_composite_frag_wgsl","\n      struct uniformData {\n          bloomStrength: f32,\n          bloomRadius: f32\n      };\n\n      struct FragmentOutput {\n          @location(0) o_Target: vec4<f32>\n      };\n\n      var<private> fragUV1: vec2<f32>;\n      var<private> o_Target: vec4<f32>;\n      @group(1) @binding(0)\n      var baseMapSampler: sampler;\n      @group(1) @binding(1)\n      var baseMap: texture_2d<f32>;\n      @group(1) @binding(2)\n      var blurTex1Sampler: sampler;\n      @group(1) @binding(3)\n      var blurTex1: texture_2d<f32>;\n      @group(1) @binding(4)\n      var blurTex2Sampler: sampler;\n      @group(1) @binding(5)\n      var blurTex2: texture_2d<f32>;\n      @group(1) @binding(6)\n      var blurTex3Sampler: sampler;\n      @group(1) @binding(7)\n      var blurTex3: texture_2d<f32>;\n      @group(1) @binding(8)\n      var blurTex4Sampler: sampler;\n      @group(1) @binding(9)\n      var blurTex4: texture_2d<f32>;\n      @group(1) @binding(10)\n      var blurTex5Sampler: sampler;\n      @group(1) @binding(11)\n      var blurTex5: texture_2d<f32>;\n      @group(2) @binding(0)\n      var<uniform> global: uniformData;\n\n      fn lerpBloomFactor(factor: f32) -> f32 {\n          var factor1: f32;\n          var mirrorFactor: f32;\n\n          factor1 = factor;\n          let e23: f32 = factor1;\n          mirrorFactor = (1.2000000476837158 - e23);\n          let e29: f32 = factor1;\n          let e30: f32 = mirrorFactor;\n          let e31: f32 = global.bloomRadius;\n          return mix(e29, e30, e31);\n      }\n\n      fn main1() {\n          var uv: vec2<f32>;\n          var source: vec4<f32>;\n\n          let e20: vec2<f32> = fragUV1;\n          uv = e20.xy;\n          let e25: vec2<f32> = uv;\n          uv.y = (1.0 - e25.y);\n          let e29: vec2<f32> = uv;\n          let e30: vec4<f32> = textureSample(baseMap, baseMapSampler, e29);\n          source = e30;\n          let e32: vec4<f32> = source;\n          let e33: f32 = global.bloomStrength;\n          let e38: f32 = lerpBloomFactor(array<f32,5>(1.0, 0.800000011920929, 0.6000000238418579, 0.4000000059604645, 0.20000000298023224)[0]);\n          let e45: vec2<f32> = uv;\n          let e46: vec4<f32> = textureSample(blurTex1, blurTex1Sampler, e45);\n          let e52: f32 = lerpBloomFactor(array<f32,5>(1.0, 0.800000011920929, 0.6000000238418579, 0.4000000059604645, 0.20000000298023224)[1]);\n          let e59: vec2<f32> = uv;\n          let e60: vec4<f32> = textureSample(blurTex2, blurTex2Sampler, e59);\n          let e67: f32 = lerpBloomFactor(array<f32,5>(1.0, 0.800000011920929, 0.6000000238418579, 0.4000000059604645, 0.20000000298023224)[2]);\n          let e74: vec2<f32> = uv;\n          let e75: vec4<f32> = textureSample(blurTex3, blurTex3Sampler, e74);\n          let e82: f32 = lerpBloomFactor(array<f32,5>(1.0, 0.800000011920929, 0.6000000238418579, 0.4000000059604645, 0.20000000298023224)[3]);\n          let e89: vec2<f32> = uv;\n          let e90: vec4<f32> = textureSample(blurTex4, blurTex4Sampler, e89);\n          let e97: f32 = lerpBloomFactor(array<f32,5>(1.0, 0.800000011920929, 0.6000000238418579, 0.4000000059604645, 0.20000000298023224)[4]);\n          let e104: vec2<f32> = uv;\n          let e105: vec4<f32> = textureSample(blurTex5, blurTex5Sampler, e104);\n          o_Target = (e32 + (e33 * ((((((e38 * vec4<f32>(array<vec3<f32>,5>(vec3<f32>(1.0, 1.0, 1.0), vec3<f32>(1.0, 1.0, 1.0), vec3<f32>(1.0, 1.0, 1.0), vec3<f32>(1.0, 1.0, 1.0), vec3<f32>(1.0, 1.0, 1.0))[0], 1.0)) * e46) + ((e52 * vec4<f32>(array<vec3<f32>,5>(vec3<f32>(1.0, 1.0, 1.0), vec3<f32>(1.0, 1.0, 1.0), vec3<f32>(1.0, 1.0, 1.0), vec3<f32>(1.0, 1.0, 1.0), vec3<f32>(1.0, 1.0, 1.0))[1], 1.0)) * e60)) + ((e67 * vec4<f32>(array<vec3<f32>,5>(vec3<f32>(1.0, 1.0, 1.0), vec3<f32>(1.0, 1.0, 1.0), vec3<f32>(1.0, 1.0, 1.0), vec3<f32>(1.0, 1.0, 1.0), vec3<f32>(1.0, 1.0, 1.0))[2], 1.0)) * e75)) + ((e82 * vec4<f32>(array<vec3<f32>,5>(vec3<f32>(1.0, 1.0, 1.0), vec3<f32>(1.0, 1.0, 1.0), vec3<f32>(1.0, 1.0, 1.0), vec3<f32>(1.0, 1.0, 1.0), vec3<f32>(1.0, 1.0, 1.0))[3], 1.0)) * e90)) + ((e97 * vec4<f32>(array<vec3<f32>,5>(vec3<f32>(1.0, 1.0, 1.0), vec3<f32>(1.0, 1.0, 1.0), vec3<f32>(1.0, 1.0, 1.0), vec3<f32>(1.0, 1.0, 1.0), vec3<f32>(1.0, 1.0, 1.0))[4], 1.0)) * e105))));\n          o_Target.a = e30.a ;\n          return;\n      } \n\n      @fragment\n      fn main(@location(0) fragUV: vec2<f32>) -> FragmentOutput {\n          fragUV1 = fragUV;\n          main1();\n        //   let e81: vec4<f32> = pow(o_Target,vec4<f32>(vec3<f32>(2.2),o_Target.w));\n          return FragmentOutput(o_Target);\n      }\n      ");class Ore{}bre(Ore,"sky_vs_frag_wgsl",'\n    #include "WorldMatrixUniform"\n    #include "GlobalUniform"\n\n    struct VertexOutput {\n      @location(0) fragUV: vec2<f32>,\n      @location(1) vWorldPos: vec4<f32>,\n      @location(2) vWorldNormal: vec3<f32>,\n      @builtin(position) member: vec4<f32>\n    };\n\n    var<private> ORI_VertexOut: VertexOutput ;\n\n    @vertex\n    fn main( \n      @builtin(instance_index) index : u32,\n      @location(0) position: vec3<f32>,\n      @location(1) normal: vec3<f32>,\n      @location(2) uv: vec2<f32>\n    ) -> VertexOutput {\n      ORI_VertexOut.fragUV = uv;\n      let modelMat = models.matrix[u32(index)];\n      let vm = globalUniform.viewMat * modelMat;\n      let normalMatrix = mat3x3<f32>(vm[0].xyz,vm[1].xyz,vm[2].xyz);\n\t    ORI_VertexOut.vWorldNormal = normalize( normalMatrix * normal );\n      ORI_VertexOut.vWorldPos = modelMat * vec4<f32>(position.xyz,1.0) ;\n\n      var fixProjMat = globalUniform.projMat ;\n      fixProjMat[2].z = 1.0 ;//99999.0 / (99999.0 - 1.0) ;\n      fixProjMat[3].z = -1.0 ;//(-1.0 * 99999.0) / (99999.0 - 1.0) ;\n\n      var fixViewMat = globalUniform.viewMat ;\n      fixViewMat[3].x = 0.0 ;\n      fixViewMat[3].y = 0.0 ;\n      fixViewMat[3].z = 0.0 ;\n\n      var clipPos = fixProjMat * fixViewMat * ORI_VertexOut.vWorldPos;\n      ORI_VertexOut.member = clipPos;\n      return ORI_VertexOut;\n    }\n  '),bre(Ore,"sky_fs_frag_wgsl",'\n    #include "GlobalUniform"\n\n    struct uniformData {\n        exposure: f32,\n        roughness: f32\n    };\n\n    struct FragmentOutput {\n        @location(0) o_Target: vec4<f32>,\n        #if USE_WORLDPOS\n          @location(1) o_Position: vec4<f32>,\n        #endif\n        #if USEGBUFFER\n          @location(2) o_Normal: vec4<f32>,\n          @location(3) o_Material: vec4<f32>\n        #endif\n    };\n\n    @group(1) @binding(0)\n    var baseMapSampler: sampler;\n    @group(1) @binding(1)\n    var baseMap: texture_cube<f32>;\n\n    @group(2) @binding(0)\n    var<uniform> global: uniformData;\n\n    fn LinearToGammaSpace(linRGB: vec3<f32>) -> vec3<f32> {\n      var linRGB1 = max(linRGB, vec3<f32>(0.0));\n      linRGB1 = pow(linRGB1, vec3<f32>(0.4166666567325592));\n      return max(((1.0549999475479126 * linRGB1) - vec3<f32>(0.054999999701976776)), vec3<f32>(0.0));\n    }\n\n    @fragment\n    fn main(@location(0) fragUV: vec2<f32>, @location(1) vWorldPos: vec4<f32>, @location(2) vWorldNormal: vec3<f32>) -> FragmentOutput {\n        let maxLevel: u32 = textureNumLevels(baseMap);\n        var textureColor:vec3<f32> = textureSampleLevel(baseMap, baseMapSampler, normalize(vWorldPos.xyz), global.roughness * f32(maxLevel) ).xyz;\n        #if IS_HDR_SKY\n        textureColor = LinearToGammaSpace(textureColor);\n        #endif\n        let o_Target: vec4<f32> =vec4<f32>(textureColor, 1.0) * globalUniform.skyExposure ;\n        var normal_rgba8unorm = (vWorldNormal + 1.0) * 0.5;\n        normal_rgba8unorm = clamp(normal_rgba8unorm, vec3<f32>(0.0), vec3<f32>(1.0));\n\n        return FragmentOutput(\n          o_Target,\n          #if USE_WORLDPOS\n              vWorldPos,\n          #endif\n          #if USEGBUFFER\n              vec4<f32>(normal_rgba8unorm,0.0),\n              vec4<f32>(0.0,1.0,0.0,0.0)\n          #endif\n        );\n    }\n    ');class Nre{static groupBindingAndFunctions(e,t){return`\n            struct JointsMatrix {\n                matrix : array<mat4x4<f32>>\n            };\n\n            @group(${e}) @binding(${t})\n            var<storage, read> jointsMatrixIndexTable: array<f32>;\n\n            @group(${e}) @binding(${t+1})\n            var<storage, read> jointsInverseMatrix: JointsMatrix;\n\n            @group(${e}) @binding(${t+2})\n            var<storage, read> jointsIndexMapingTable: array<f32>;\n\n            const MAX_JOINT_NUM = 8;\n            fn getSkeletonWorldMatrix(joints: array<f32, MAX_JOINT_NUM>, weights: array<f32, MAX_JOINT_NUM>, num: u32) -> mat4x4<f32> {\n                var result: mat4x4<f32>;\n                for(var i: u32 = 0; i < num; i = i + 1) {\n                    let jointId = i32(joints[i]);\n                    let jointIndex = u32(jointsIndexMapingTable[jointId]);\n                    let jointMatrixIndex = u32(jointsMatrixIndexTable[jointIndex]);\n                    let joint = models.matrix[jointMatrixIndex] * jointsInverseMatrix.matrix[jointId] * weights[i];\n                    result += joint;\n                }\n                return result;\n            }\n\n            fn getSkeletonWorldMatrix_4(joints: vec4<f32>, weights: vec4<f32>) -> mat4x4<f32> {\n                return getSkeletonWorldMatrix(array<f32, MAX_JOINT_NUM>(\n                    joints.x, joints.y, joints.z, joints.w,\n                    0, 0, 0, 0,\n                ), array<f32, MAX_JOINT_NUM>(\n                    weights.x, weights.y, weights.z, weights.w,\n                    0, 0, 0, 0,\n                ), 4);\n            }\n    \n            fn getSkeletonWorldMatrix_8(joints0: vec4<f32>, weights0: vec4<f32>, joints1: vec4<f32>, weights1: vec4<f32>) -> mat4x4<f32> {\n                return getSkeletonWorldMatrix(array<f32, MAX_JOINT_NUM>(\n                    joints0.x, joints0.y, joints0.z, joints0.w,\n                    joints1.x, joints1.y, joints1.z, joints1.w,\n                ), array<f32, MAX_JOINT_NUM>(\n                    weights0.x, weights0.y, weights0.z, weights0.w,\n                    weights1.x, weights1.y, weights1.z, weights1.w,\n                ), 8);\n            }\n        `}}class Bre{static getMorphTargetShaderBinding(e,t){return`\n            fn blendMorphTargetPosition(vertexID:i32, posIn:vec3<f32>) -> vec3<f32>{\n                let offset:i32 = vertexID * 3;\n                var pos = posIn * morphTargetConfig.morphBaseInfluence;\n                pos += vec3<f32>(morphTargetOpPositions[offset], morphTargetOpPositions[offset + 1], morphTargetOpPositions[offset + 2]);\n                return pos;\n            }\n\n            #if USE_MORPHNORMALS\n                fn blendMorphTargetNormal(vertexID:i32, normalIn:vec3<f32>) -> vec3<f32>{\n                    let offset:i32 = vertexID * 3;\n                    var normal = normalIn * morphTargetConfig.morphBaseInfluence;\n                    normal += vec3<f32>(morphTargetOpNormals[offset], morphTargetOpNormals[offset + 1], morphTargetOpNormals[offset + 2]);\n                    return normal;\n                }\n            #endif\n\n            struct MorphTargetConfigData {\n                morphBaseInfluence:f32,\n                morphTargetCount:f32,\n                totalVertexCount:f32,\n                computeWorkGroupXY:f32,\n            };\n            \n            @group(${e}) @binding(${t})\n            var<uniform> morphTargetConfig: MorphTargetConfigData;\n            \n            @group(${e}) @binding(${t+1})\n            var<storage,read> morphTargetOpPositions: array<f32>;\n\n            #if USE_MORPHNORMALS\n                @group(${e}) @binding(${t+2})\n                var<storage,read> morphTargetOpNormals: array<f32>;\n            #endif\n`}static getMorphTargetAttr(e){return`@location(${e}) vIndex: f32,`}static getMorphTargetCalcVertex(){return"\n            vertexPosition = blendMorphTargetPosition(i32(vertex.vIndex), vertexPosition);\n\n            #if USE_MORPHNORMALS\n                vertexNormal = blendMorphTargetNormal(i32(vertex.vIndex), vertexNormal);\n            #endif\n        "}}bre(Bre,"CsMain","\n        struct MorphTargetConfigData {\n            morphBaseInfluence:f32,\n            morphTargetCount:f32,\n            totalVertexCount:f32,\n            computeWorkGroupXY:f32,\n        };\n\n        @group(0) @binding(0) var<uniform> morphTargetConfig: MorphTargetConfigData;\n        @group(0) @binding(1) var<storage, read> morphTargetInfluence : array<f32>;\n        @group(0) @binding(2) var<storage, read> morphTargetPositions : array<f32>;\n        @group(0) @binding(3) var<storage, read_write> morphTargetOpPositions : array<f32>;\n        \n        #if USE_MORPHNORMALS\n            @group(0) @binding(4) var<storage, read> morphTargetNormals : array<f32>;\n            @group(0) @binding(5) var<storage, read_write> morphTargetOpNormals : array<f32>;\n        #endif\n        \n        @compute @workgroup_size( 8 , 8 , 1 )\n        fn CsMain(@builtin(global_invocation_id) globalInvocation_id : vec3<u32>)\n        {\n            let vertexIndex:i32 = i32(globalInvocation_id.y) * i32(morphTargetConfig.computeWorkGroupXY) + i32(globalInvocation_id.x);\n        \n            let morphTargetCount:i32 = i32(morphTargetConfig.morphTargetCount);\n            let totalVertexCount:i32 = i32(morphTargetConfig.totalVertexCount);\n            var vertexPosition:vec3<f32> = vec3<f32>(0.0);\n            var vertexNormal:vec3<f32> = vec3<f32>(0.0);\n            if(vertexIndex < totalVertexCount)\n            {\n                for(var i:i32 = 0; i < morphTargetCount; i ++){\n                    let offset:i32 = (i * totalVertexCount + vertexIndex) * 3;\n                    let morphPosition = vec3<f32>(morphTargetPositions[offset], morphTargetPositions[offset + 1], morphTargetPositions[offset + 2]);\n                    vertexPosition += morphTargetInfluence[i] * morphPosition;\n                }\n\n                var writeOffset = vertexIndex * 3;\n                //op position\n                morphTargetOpPositions[writeOffset] = vertexPosition.x;\n                morphTargetOpPositions[writeOffset + 1] = vertexPosition.y;\n                morphTargetOpPositions[writeOffset + 2] = vertexPosition.z;\n\n                #if USE_MORPHNORMALS\n                    for(var i:i32 = 0; i < morphTargetCount; i ++){\n                        let offset:i32 = (i * totalVertexCount + vertexIndex) * 3;\n                        let morphNormal = vec3<f32>(morphTargetNormals[offset], morphTargetNormals[offset + 1], morphTargetNormals[offset + 2]);\n                        vertexNormal += morphTargetInfluence[i] * morphNormal;\n                    }\n\n                    //op normal\n                    morphTargetOpNormals[writeOffset] = vertexNormal.x;\n                    morphTargetOpNormals[writeOffset + 1] = vertexNormal.y;\n                    morphTargetOpNormals[writeOffset + 2] = vertexNormal.z;\n                #endif\n            }\n        }\n");let Ure=`\n    #if USE_MORPHTARGETS\n    ${Bre.getMorphTargetShaderBinding(3,0)}\n    #endif\n\n    #if USE_SKELETON\n    ${Nre.groupBindingAndFunctions(3,0)} \n    #endif\n\n    struct VertexAttributes{\n    @builtin(instance_index) index : u32,\n    @location(0) position: vec3<f32>,\n    @location(1) normal: vec3<f32>,\n    @location(2) uv: vec2<f32>,\n    @location(3) TEXCOORD_1: vec2<f32>,\n\n    #if USE_TANGENT\n        @location(4) TANGENT: vec4<f32>,\n        #if USE_SKELETON\n            @location(5) joints0: vec4<f32>,\n            @location(6) weights0: vec4<f32>,\n            #if USE_JOINT_VEC8\n            @location(7) joints1: vec4<f32>,\n            @location(8) weights1: vec4<f32>,\n        #endif\n        #elseif USE_MORPHTARGETS\n            ${Bre.getMorphTargetAttr(5)}\n        #endif\n    #elseif USE_SKELETON\n        @location(4) joints0: vec4<f32>,\n        @location(5) weights0: vec4<f32>,\n        #if USE_JOINT_VEC8\n        @location(6) joints1: vec4<f32>,\n        @location(7) weights1: vec4<f32>,\n        #endif\n    #elseif USE_MORPHTARGETS\n        ${Bre.getMorphTargetAttr(4)}\n    #endif\n    }\n\n    struct VertexOutput {\n    @location(0) varying_UV0: vec2<f32>,\n    @location(1) varying_UV1: vec2<f32>,\n    @location(2) varying_ViewPos: vec4<f32>,\n    @location(3) varying_Clip: vec4<f32>,\n    @location(4) varying_WPos: vec4<f32>,\n    @location(5) varying_WNormal: vec3<f32>,\n    @location(6) varying_Color: vec4<f32>,\n\n    #if USE_SHADOWMAPING\n        @location(7) varying_ShadowPos: vec4<f32>,\n    #endif\n\n    #if USE_TANGENT\n        @location(8) varying_Tangent: vec4<f32>,\n    #endif\n\n    @builtin(position) member: vec4<f32>\n    };\n\n    var<private> ORI_VertexOut: VertexOutput ;\n\n    fn ORI_Vert(vertex:VertexAttributes){\n    var vertexPosition = vertex.position;\n    var vertexNormal = vertex.normal;\n\n    #if USE_MORPHTARGETS\n    ${Bre.getMorphTargetCalcVertex()}    \n    #endif\n\n    #if USE_SKELETON\n        #if USE_JOINT_VEC8\n            let skeletonNormal = getSkeletonWorldMatrix_8(vertex.joints0, vertex.weights0, vertex.joints1, vertex.weights1);\n            ORI_MATRIX_M *= skeletonNormal ;\n        #else\n            let skeletonNormal = getSkeletonWorldMatrix_4(vertex.joints0, vertex.weights0);\n            ORI_MATRIX_M *= skeletonNormal ;\n        #endif\n    #endif\n\n    #if USE_TANGENT\n        ORI_VertexOut.varying_Tangent = vertex.TANGENT ;\n    #endif\n\n    ORI_NORMALMATRIX = transpose(inverse( mat3x3<f32>(ORI_MATRIX_M[0].xyz,ORI_MATRIX_M[1].xyz,ORI_MATRIX_M[2].xyz) ));\n\n    var worldPos = (ORI_MATRIX_M * vec4<f32>(vertexPosition.xyz, 1.0));\n    var viewPosition = ORI_MATRIX_V * worldPos;\n    var clipPosition = ORI_MATRIX_P * viewPosition ;\n\n    ORI_CameraWorldDir = normalize(ORI_CAMERAMATRIX[3].xyz - worldPos.xyz) ;\n\n    ORI_VertexOut.varying_UV0 = vertex.uv.xy ;\n    ORI_VertexOut.varying_UV1 = vertex.TEXCOORD_1.xy;\n    ORI_VertexOut.varying_ViewPos = viewPosition / viewPosition.w;\n    ORI_VertexOut.varying_Clip = clipPosition ;\n    ORI_VertexOut.varying_WPos = worldPos ;\n    ORI_VertexOut.varying_WPos.w = f32(vertex.index);\n    ORI_VertexOut.varying_WNormal = normalize(ORI_NORMALMATRIX * vertexNormal.xyz) ;\n    ORI_VertexOut.member = clipPosition ;\n    }\n`,zre="\n  struct GlobalUniform {\n    projMat: mat4x4<f32>,\n    viewMat: mat4x4<f32>,\n    cameraWorldMatrix: mat4x4<f32>,\n    pvMatrixInv : mat4x4<f32>,\n    shadowMatrix: array<mat4x4<f32>,8>,\n    CameraPos: vec3<f32>,\n    \n    frame: f32,\n    time: f32,\n    delta: f32,\n    shadowBias: f32,\n    skyExposure: f32,\n    renderPassState:f32,\n    quadScale: f32,\n    hdrExposure: f32,\n  \n    renderState_left: i32,\n    renderState_right: i32,\n    renderState_split: f32,\n\n    mouseX: f32,\n    mouseY: f32,\n    windowWidth: f32,\n    windowHeight: f32,\n\n    near: f32,\n    far: f32,\n\n    pointShadowBias: f32,\n    shadowMapSize: f32,\n    shadowSoft: f32,\n  };\n\n  @group(0) @binding(0)\n  var<uniform> globalUniform: GlobalUniform;\n",Fre="\n    struct Uniforms {\n        matrix : array<mat4x4<f32>>\n    };\n\n    @group(0) @binding(1)\n    var<storage, read> models : Uniforms;\n",Vre="\n    struct FragmentOutput {\n        @location(0) color: vec4<f32>,\n        #if USE_WORLDPOS\n            @location(1) worldPos: vec4<f32>,\n        #endif\n        #if USEGBUFFER\n            @location(2) worldNormal: vec4<f32>,\n            @location(3) material: vec4<f32>,\n        #endif\n        // @builtin(frag_depth) out_depth: f32\n    };\n",Gre="\n    fn getHDRColor(color: vec3<f32>, exposure: f32) -> vec3 < f32 > {\n        // var newColor = color * (  1.0 / 255.0 ) ;\n        return color * pow(2.4, exposure) ;\n    }\n\n    fn lambda2rgb(lambda : f32) -> vec3 < f32 > {\n        let ultraviolet = 400.0;\n        let infrared = 700.0;\n\n        var a = (lambda - ultraviolet) / (infrared - ultraviolet);\n        let c = 10.0;\n        var b = vec3<f32>(a) - vec3<f32>(0.75, 0.5, 0.25);\n        return max((1.0 - c * b * b), vec3<f32>(0.0));\n    }\n\n    fn CEToneMapping(color: vec3<f32>, adapted_lum: f32) -> vec3<f32>\n    {\n        return 1.0 - exp(-adapted_lum * color);\n    }\n\n    fn ACESToneMapping(color: vec3<f32>, adapted_lum: f32) -> vec3<f32>\n    {\n        let A = 2.51;\n        let B = 0.03;\n        let C = 2.43;\n        let D = 0.59;\n        let E = 0.14;\n\n        var color2 = color * adapted_lum;\n        color2 = (color2 * (A * color2 + B)) / (color2 * (C * color2 + D) + E);\n        return color2;\n    }\n\n    fn gammaToLiner(color: vec4<f32>) -> vec4 < f32 > {\n        let gammaCorrect = 2.4;\n        var color2 = pow(color, vec4<f32>(gammaCorrect));\n        return color2 ;\n    }\n\n    fn linerToGamma4(color: vec4<f32>) -> vec4 < f32 > {\n        let gammaCorrect = 1.0 / 2.4;\n        var color2 = pow(color, vec4<f32>(gammaCorrect));\n        return color2 ;\n    }\n\n    fn linerToGamma3(color: vec3<f32>) -> vec3 < f32 > {\n        let gammaCorrect = 1.0 / 2.4;\n        var color2 = pow(color, vec3<f32>(gammaCorrect));\n        return color2 ;\n    }\n\n    fn LinearToGammaSpace(linRGB0: vec3<f32>) -> vec3 < f32 > {\n        var linRGB = max(linRGB0, vec3(0.0, 0.0, 0.0));\n        linRGB.r = pow(linRGB.r, 0.416666667);\n        linRGB.g = pow(linRGB.g, 0.416666667);\n        linRGB.b = pow(linRGB.b, 0.416666667);\n        return max(1.055 * linRGB - 0.055, vec3(0.0, 0.0, 0.0));\n    }\n\n    var<private>sRGB_2_LMS_MAT: mat3x3<f32> = mat3x3<f32>(\n        17.8824, 43.5161, 4.1193,\n        3.4557, 27.1554, 3.8671,\n        0.02996, 0.18431, 1.4670,\n    );\n\n    var<private>LMS_2_sRGB_MAT: mat3x3<f32> = mat3x3<f32>(\n        0.0809, -0.1305, 0.1167,\n        -0.0102, 0.0540, -0.1136,\n        -0.0003, -0.0041, 0.6935,\n    );\n\n    fn sRGB_2_LMS(RGB: vec3<f32>) -> vec3<f32>\n    {\n        return sRGB_2_LMS_MAT * RGB;\n    }\n\n    fn LMS_2_sRGB(LMS: vec3<f32>) -> vec3<f32>\n    {\n        return LMS_2_sRGB_MAT * LMS;\n    }\n\n    fn LinearToSrgbBranchless(lin: vec3<f32>) -> vec3<f32>\n    {\n        var lin2 = max(vec3<f32>(6.10352e-5), lin);\n        return min(lin2 * 12.92, pow(max(lin2, vec3<f32>(0.00313067)), vec3<f32>(1.0 / 2.4)) * vec3<f32>(1.055) - vec3<f32>(0.055));\n    }\n\n    fn sRGBToLinear(color : vec3<f32>) -> vec3<f32>\n    {\n        let color2 = max(vec3<f32>(6.10352e-5), color);\n        let c = 0.04045;\n        if (color2.r > c && color2.g > c && color2.b > c) {\n            return pow(color2 * (1.0 / 1.055) + 0.0521327, vec3<f32>(2.4));\n        } else {\n            return color2 * (1.0 / 12.92);\n        }\n    }\n";class Hre{static init(){Hre.register("MathShader","\nvar<private> PI: f32 = 3.14159265359;\n\n\nfn applyQuaternion(position:vec3<f32>, q:vec4<f32>) -> vec3<f32>{\n  let x:f32 = position.x;\n  let y:f32 = position.y;\n  let z:f32 = position.z;\n\n  let qx:f32 = q.x;\n  let qy:f32 = q.y;\n  let qz:f32 = q.z;\n  let qw:f32 = q.w;\n\n  let ix:f32 = qw * x + qy * z - qz * y;\n  let iy:f32 = qw * y + qz * x - qx * z;\n  let iz:f32 = qw * z + qx * y - qy * x;\n  let iw:f32 = -qx * x - qy * y - qz * z;\n\n  var ret: vec3<f32>;\n  ret.x = ix * qw + iw * -qx + iy * -qz - iz * -qy;\n  ret.y = iy * qw + iw * -qy + iz * -qx - ix * -qz;\n  ret.z = iz * qw + iw * -qz + ix * -qy - iy * -qx;\n\n  return ret;\n}\n\nfn inverse( m:mat3x3<f32>) -> mat3x3<f32>{\n  var a00 = m[0][0];\n  var a01 = m[0][1];\n  var a02 = m[0][2];\n  var a10 = m[1][0];\n  var a11 = m[1][1];\n  var a12 = m[1][2];\n  var a20 = m[2][0];\n  var a21 = m[2][1];\n  var a22 = m[2][2];\n\n  var b01 = a22 * a11 - a12 * a21;\n  var b11 = -a22 * a10 + a12 * a20;\n  var b21 = a21 * a10 - a11 * a20;\n\n  var det = a00 * b01 + a01 * b11 + a02 * b21 ;\n  return mat3x3<f32>(\n      vec3<f32>(b01/ det, (-a22 * a01 + a02 * a21)/ det, (a12 * a01 - a02 * a11)/ det),\n      vec3<f32>(b11/ det, (a22 * a00 - a02 * a20)/ det, (-a12 * a00 + a02 * a10)/ det),\n      vec3<f32>(b21/ det, (-a21 * a00 + a01 * a20)/ det, (a11 * a00 - a01 * a10)/ det)\n  );\n}\n\nfn dir_to_faceId(pt:vec3<f32>) -> i32 {\n    //**** nx px ny py nz pz\n    var abs_x = abs(pt.x);\n    var abs_y = abs(pt.y);\n    var abs_z = abs(pt.z);\n    var coord = max(max(abs_x, abs_y), abs_z);\n    if(coord == -pt.x){  return 0;}\n    if(coord == pt.x) { return 1;}\n\n    if(coord == -pt.y){  return 2;}\n    if(coord == pt.y) { return 3;}\n\n    if(coord == -pt.z) { return 4;}\n    return 5;\n  }\n\n  fn convert_xyz_to_cube_uv(x:f32, y:f32, z:f32 ) -> vec2<f32>\n  {\n    var dir = vec3<f32>(x, y, z);\n    var absX = abs(dir.x);\n    var absY = abs(dir.y);\n    var absZ = abs(dir.z);\n\n    var isXPositive = 0;\n    if(dir.x > 0.0){isXPositive = 1;}\n    var isYPositive = 0;\n    if(dir.y > 0.0){isYPositive = 1;}\n    var isZPositive = 0;\n    if(dir.z > 0.0){isZPositive = 1;}\n\n    var maxAxis:f32 = 0.0;\n    var uc:f32 = 0.0;\n    var vc:f32 = 0.0;\n\n    // POSITIVE X\n    if (isXPositive == 1 && absX >= absY && absX >= absZ) {\n      // u (0 to 1) goes from +z to -z\n      // v (0 to 1) goes from -y to +y\n      maxAxis = absX;\n      uc = -z;\n      vc = y;\n    }\n    // NEGATIVE X\n    if (isXPositive ==0 && absX >= absY && absX >= absZ) {\n      // u (0 to 1) goes from -z to +z\n      // v (0 to 1) goes from -y to +y\n      maxAxis = absX;\n      uc = z;\n      vc = y;\n    }\n    // POSITIVE Y\n    if (isYPositive==1 && absY >= absX && absY >= absZ) {\n      // u (0 to 1) goes from -x to +x\n      // v (0 to 1) goes from +z to -z\n      maxAxis = absY;\n      uc = x;\n      vc = -z;\n    }\n    // NEGATIVE Y\n    if (isYPositive ==0 && absY >= absX && absY >= absZ) {\n      // u (0 to 1) goes from -x to +x\n      // v (0 to 1) goes from -z to +z\n      maxAxis = absY;\n      uc = x;\n      vc = z;\n    }\n    // POSITIVE Z\n    if (isZPositive == 1&& absZ >= absX && absZ >= absY) {\n      // u (0 to 1) goes from -x to +x\n      // v (0 to 1) goes from -y to +y\n      maxAxis = absZ;\n      uc = x;\n      vc = y;\n    }\n    // NEGATIVE Z\n    if (isZPositive ==0 && absZ >= absX && absZ >= absY) {\n      // u (0 to 1) goes from +x to -x\n      // v (0 to 1) goes from -y to +y\n      maxAxis = absZ;\n      uc = -x;\n      vc = y;\n    }\n\n    // Convert range from -1 to 1 to 0 to 1\n    var u = 0.5f * (uc / maxAxis + 1.0f);\n    var v = 0.5f * (vc / maxAxis + 1.0f);\n\n    return vec2(u, v);\n  }\n\n    // Returns ±1\n    fn signNotZero( v1:vec2<f32>) -> vec2<f32> {\n        var v:vec2<f32> = v1;\n        if(v.x >= 0.0){\n            v.x = 1.0;\n        }else{\n            v.x = -1.0;\n        }\n        if(v.y >= 0.0){\n            v.y = 1.0;\n        }else{\n            v.y= -1.0;\n        }\n        return v;\n    }\n\n    fn octEncode( v:vec3<f32> ) -> vec2<f32> {\n        var l1norm = abs(v.x) + abs(v.y) + abs(v.z);\n        var result = v.xy * (1.0 / l1norm);\n        if (v.z < 0.0) {\n            result = (1.0 - abs(result.yx)) * signNotZero(result.xy);\n        }\n        return result;\n    }\n\n    // Returns a unit vector. Argument o is an octahedral vector packed via octEncode,on the [-1, +1] square*/\n    fn octDecode( o:vec2<f32> ) -> vec3<f32> {\n        var v = vec3<f32>(o.x, o.y, 1.0 - abs(o.x) - abs(o.y));\n        if (v.z < 0.0) {\n            var tmp = (1.0 - abs(v.yx)) * signNotZero(v.xy);\n            v.x = tmp.x;\n            v.y = tmp.y;\n        }\n        return normalize(v);\n    }\n\n    fn Linear01Depth(z:f32,near:f32,far:f32)-> f32{\n        let ZBufferZ = (-1.0+(far/near)) / far;\n        let ZBufferW = near /far ;\n        return 1.0 / (ZBufferZ * z + ZBufferW) ;\n    }\n\n    \n    fn LinearizeDepth( depth:f32 , nearPlane:f32 , farPlane:f32 )-> f32 {\n      var z = depth * 2.0 - 1.0;\n      return (2.0 * nearPlane * farPlane) / (farPlane + nearPlane - z * (farPlane - nearPlane));\n    }\n\n    fn QuaternionToMatrix(q: vec4<f32>) -> mat4x4<f32> {\n      // If q is guaranteed to be a unit quaternion, s will always\n      // be 1.  In that case, this calculation can be optimized out.\n      //float norm = GetNorm (q);\n      //float s = (norm > 0.0) ? 2.0/norm : 0;\n\n      var result: mat4x4<f32>;\n  \n      // Precalculate coordinate products\n      let x = q.x * 2.0;\n      let y = q.y * 2.0;\n      let z = q.z * 2.0;\n      let xx = q.x * x;\n      let yy = q.y * y;\n      let zz = q.z * z;\n      let xy = q.x * y;\n      let xz = q.x * z;\n      let yz = q.y * z;\n      let wx = q.w * x;\n      let wy = q.w * y;\n      let wz = q.w * z;\n  \n      // Calculate 3x3 matrix from orthonormal basis\n      result[0][0] = 1.0 - (yy + zz);\n      result[0][1] = xy + wz;\n      result[0][2] = xz - wy;\n      result[0][3] = 0.0;\n  \n      result[1][0] = xy - wz;\n      result[1][1] = 1.0 - (xx + zz);\n      result[1][2] = yz + wx;\n      result[1][3] = 0.0;\n  \n      result[2][0] = xz + wy;\n      result[2][1] = yz - wx;\n      result[2][2] = 1.0 - (xx + yy);\n      result[2][3] = 0.0;\n  \n      result[3][0] = 0.0;\n      result[3][1] = 0.0;\n      result[3][2] = 0.0;\n      result[3][3] = 1.0;\n\n      return result;\n    }\n\n    fn MakeScaleMatrix(scale: vec3<f32>) -> mat4x4<f32> {\n        return mat4x4<f32>(\n          scale.x, 0.0, 0.0, 0.0,\n          0.0, scale.y, 0.0, 0.0,\n          0.0, 0.0, scale.z, 0.0,\n          0.0, 0.0, 0.0, 1.0,\n        );\n    }\n\n    fn MakeRotationMatrix(rotationQuaternion: vec4<f32>) -> mat4x4<f32> {\n        return QuaternionToMatrix(rotationQuaternion);\n    }\n\n    fn MakeTranslationMatrix(translation: vec3<f32>) -> mat4x4<f32> {\n        return mat4x4<f32>(\n          1.0, 0.0, 0.0, 0.0,\n          0.0, 1.0, 0.0, 0.0,\n          0.0, 0.0, 1.0, 0.0,\n          translation.x, translation.y, translation.z, 1.0,\n        );\n    }\n\n    fn MakeMatrix4x4(scale: vec3<f32>, rotationQuaternion: vec4<f32>, translation: vec3<f32>) -> mat4x4<f32> {\n        var scaleMat: mat4x4<f32> = MakeScaleMatrix(scale);\n        var rotationMat: mat4x4<f32> = MakeRotationMatrix(rotationQuaternion);\n        var translationMat: mat4x4<f32> = MakeTranslationMatrix(translation);\n        return translationMat * scaleMat * rotationMat;\n    }\n\n    fn mixMatrix4x4(a: mat4x4<f32>, b: mat4x4<f32>, t:f32) -> mat4x4<f32> {\n      return a * (1.0 - t) + b * t;\n      // return mat4x4<f32>(\n      //   mix(a[0], b[0], t),\n      //   mix(a[1], b[1], t),\n      //   mix(a[2], b[2], t),\n      //   mix(a[3], b[3], t)\n      // );\n    }\n\n    fn decodeDepth( color:vec4<f32> ) -> f32{\n      var depth = 0.0 ;\n      const bitShifts = vec4<f32>(1.0 / (256.0 * 256.0 * 256.0), 1.0 / (256.0 * 256.0), 1.0 / 256.0, 1.0); \n      depth = dot(color, bitShifts);\n      return depth;\n    }\n\n    fn encodeDepth( depth:f32 ) -> vec4<f32>{\n      const bitSh  = vec4<f32>(256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0);\n      const bitMsk = vec4<f32>(0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0);\n      var comp:vec4<f32>;\n      comp  = depth * bitSh;\n      comp  = fract(comp);\n      comp -= comp.xxyz * bitMsk;\n      return comp;\n    }\n"),Hre.register("FastMathShader","\n  fn Pow3(  x : f32 ) -> f32\n  {\n      var xx = x*x;\n      return x * xx;\n  }\n\n  fn Pow4(  x : f32 ) -> f32\n  {\n      var xx = x*x;\n      return xx * xx;\n  }\n\n  fn pow5(x: f32) -> f32 {\n      var x2 = x * x;\n      return x2 * x2 * x;\n  }\n\n  fn rcp( x:f32 ) -> f32\n  {\n      return 1.0 / x;\n  }\n\n  fn rsqrt3( a : vec3<f32> ) -> vec3<f32>\n  {\n    return pow(a, vec3<f32>(-0.5));\n  }\n\n  fn rsqrt( a : f32 ) -> f32\n  {\n    return pow(a, -0.5);\n  }\n"),Hre.register("GlobalUniform",zre),Hre.register("WorldMatrixUniform",Fre),Hre.register("NormalMap_frag","\n    fn perturbNormal(  worldPos:vec3<f32>,  surf_norm:vec3<f32>,  mapN:vec3<f32> , normalScale:f32 , face:f32 ) -> vec3<f32> {\n        var q0 = vec3<f32>( dpdx( worldPos.x ), dpdx( worldPos.y ), dpdx( worldPos.z ) );\n        var q1 = vec3<f32>( dpdy( worldPos.x ), dpdy( worldPos.y ), dpdy( worldPos.z ) );\n        var st0 = dpdx( ORI_VertexVarying.fragUV0.xy );\n        var st1 = dpdy( ORI_VertexVarying.fragUV0.xy );\n        var N = surf_norm;\n        var q1perp = cross( q1, N );\n        var q0perp = cross( N, q0 );\n        var T = q1perp * st0.x + q0perp * st1.x;\n        var B = q1perp * st0.y + q0perp * st1.y;\n\n        var det = max( dot( T, T ), dot( B, B ) );\n        var scale = 1.0 ;\n        if( det != 0.0 ){\n            scale = inverseSqrt( det ) ;\n        }\n        scale *= normalScale;\n        return normalize( (T * ( -mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z ) * face ) ;\n    }\n\n    fn unpackNormalMap( normal : vec3<f32> ) -> vec3<f32>\n    {\n        var normalTex = vec3<f32>( normal.xyz * 2.0 - 1.0 ) ;\n        return normalize(normalTex);\n    }\n\n    fn unPackNormal(normal : vec3<f32> , height:f32 ) -> vec3<f32>{\n        var face = 1.0 ;\n        if(ORI_VertexVarying.face){\n            face = 1.0 ;\n        }else{\n            face = -1.0 ;\n        }\n\n        #if USE_RGNORMAL\n            return unPackRGNormal(normal,height,face);\n        #else\n            var n = normal ;\n            #if USE_NORMALFILPY\n            n.y = 1.0 - n.y ; \n            #endif\n            \n            var mapNormal: vec3<f32> = unpackNormalMap(n) ;\n            return perturbNormal(ORI_VertexVarying.vWorldPos.xyz , ORI_VertexVarying.vWorldNormal.xyz , mapNormal , height , face  ) ;\n        #endif\n    }\n\n    fn unPackRGNormal(normal : vec3<f32> , height:f32 , face:f32) -> vec3<f32> {\n        var d = normal.rg * 2.0 - 1.0 ;\n        var l = 1.0 - saturate(dot(d,d));\n        var s = sqrt(l);\n        var rg = d * height ; \n        var mapNormal = vec3<f32>(rg,s);\n        var outN = perturbNormal(ORI_VertexVarying.vWorldPos.xyz,ORI_VertexVarying.vWorldNormal,mapNormal,1.0,face) ;\n        return outN ;\n    }\n"),Hre.register("LightingFunction_frag",'\n#include "BRDF_frag"\n#include "LightStruct"\n#include "ShadowMapping_frag"\n\n#if USE_IES_PROFILE\n  #include "IESProfiles_frag"\n#endif\n\n\n\nconst LUMEN = 10.764;\n\n\n\nfn calcAttenuation( d : f32 ,  falloffStart : f32 ,  falloffEnd : f32)-> f32\n{\n    // Linear falloff.\n    return saturate((falloffEnd-d) / (falloffEnd - falloffStart));\n}\n\nfn directLighting( albedo:vec3<f32>, N:vec3<f32>, V:vec3<f32>,  roughness:f32 , light:LightData , shadowBias:f32 ) -> vec3<f32> {\n    var color = vec3<f32>(0.0) ;\n    #if USE_LIGHT\n      var L = -normalize(light.direction.xyz) ;\n      let lightCC = pow( light.lightColor.rgb,vec3<f32>(2.2));\n      var lightColor = getHDRColor( lightCC.rgb , light.linear )  ;\n      var att = light.intensity / LUMEN ;\n      if(light.castShadow>=0){\n          #if USE_SHADOWMAPING\n            att *= shadowStrut.directShadowVisibility[light.castShadow] ; \n          #endif\n      }\n\n      #if USE_LAMBERT\n        color = vec3<f32>(1.0,0.5,1.0) ;\n      #endif \n\n      #if USE_BRDF\n        color = simpleBRDF(albedo,N,V,L,att,lightColor,fragData.Roughness) ;\n      #endif \n    #endif \n    return color ;\n}\n\nfn pointLighting( albedo:vec3<f32>,WP:vec3<f32>, N:vec3<f32>, V:vec3<f32>, roughness:f32 , light:LightData ) -> vec3<f32> {\n    var color = vec3<f32>(0.0) ;\n    let lightPos = light.position.xyz;\n    var dir = lightPos.xyz - WP ;\n    let dist = length(dir);\n    if(dist != 0.0){\n      dir *= 1.0 / dist ;\n    }\n    if( abs(dist) < light.range ){\n        var L = dir ;\n        var atten = 1.0 ;\n        atten = 1.0 - smoothstep(0.0,light.range,dist) ;\n        atten *= 1.0 / max(light.radius,0.001) * light.intensity / LUMEN;\n        if( light.castShadow >= 0 )\n        {\n            atten *= shadowStrut.pointShadows[light.castShadow] ;\n        }\n\n        #if USE_IES_PROFILE\n          atten *= getLightIESProfileAtt(WP,light);\n        #endif\n\n        var lightColor = light.lightColor.rgb  ;\n        lightColor = getHDRColor(lightColor , light.linear )  ;\n        // lightColor = LinearToSrgbBranchless(lightColor.rgb) ;\n\n        #if USE_LAMBERT\n          color = vec3<f32>(1.0,0.5,1.0) ;\n        #endif \n\n        #if USE_BRDF\n          color = (simpleBRDF(albedo,N,V,L,atten,lightColor,fragData.Roughness))  ;\n        #endif \n    } \n    return color ;\n}\n\nfn getDistanceAtten(  light:LightData , dist : f32 ) -> f32 {\n  return 1.0 - smoothstep(0.0,light.range,dist) ;\n}\n\nfn spotLighting( albedo:vec3<f32>,WP:vec3<f32>, N:vec3<f32>, V:vec3<f32>, roughness:f32 , light:LightData ) -> vec3<f32> {\n    let lightPos = light.position.xyz;\n    var dir = lightPos.xyz - WP ;\n    let dist = length(dir) ;\n    if(dist != 0.0){\n      dir *= 1.0 / dist ;\n    }\n    var color = vec3<f32>(0.0) ;\n    if( abs(dist) < light.range * 2.0 ){\n        var L = dir ;\n        let theta = dot(-L, normalize(light.direction));\n        let angle = acos(theta) ;\n        var atten = 1.0 ;\n        var lightColor = light.lightColor.rgb  ;\n\n        atten = 1.0 - smoothstep(0.0,light.range,dist) ;\n        atten *= 1.0 / max(light.radius,0.1) * light.intensity / LUMEN;\n        if(angle < light.outerCutOff){\n          if(angle > light.innerCutOff){\n            atten *= 1.0 - smoothstep(light.innerCutOff, light.outerCutOff, angle) ;\n          \n          \n          }\n        }else{\n          atten = 0.0 ;\n        }\n\n        if( light.castShadow >= 0 )\n        {\n            atten *= shadowStrut.pointShadows[light.castShadow] ;\n        }\n\n        #if USE_IES_PROFILE\n            atten *= getLightIESProfileAtt(WP,light);\n        #endif\n\n        lightColor = getHDRColor(lightColor , light.linear ) ;\n\n        #if USE_LAMBERT\n          color = vec3<f32>(1.0,0.5,1.0) ;\n        #endif \n\n        #if USE_BRDF\n          color = (simpleBRDF(albedo,N,V,L,atten,lightColor,fragData.Roughness)) ;\n        #endif \n    }\n    return  color ;\n}\n'),Hre.register("PhysicMaterialUniform_frag","\n        struct MaterialUniform {\n          transformUV1:vec4<f32>,\n          transformUV2:vec4<f32>,\n\n          baseColor: vec4<f32>,\n          emissiveColor: vec4<f32>,\n          materialF0: vec4<f32>,\n          envIntensity: f32,\n          normalScale: f32,\n          roughness: f32,\n          metallic: f32,\n          ao: f32,\n\n          roughness_min: f32,\n          roughness_max: f32,\n          metallic_min: f32,\n          metallic_max: f32,\n          emissiveIntensity: f32,\n          alphaCutoff: f32,\n          ior: f32,\n          clearcoatColor: vec4<f32>,\n          clearcoatWeight: f32,\n          clearcoatFactor: f32,\n          clearcoatRoughnessFactor: f32,\n        };\n      \n        @group(2) @binding(0)\n        var<uniform> materialUniform: MaterialUniform;\n      "),Hre.register("UnLitMaterialUniform_frag","\nstruct MaterialUniform {\n  transformUV1:vec4<f32>,\n  transformUV2:vec4<f32>,\n  baseColor: vec4<f32>,\n  alphaCutoff: f32,\n};\n\n@group(2) @binding(0)\nvar<uniform> materialUniform: MaterialUniform;\n"),Hre.register("VideoUniform_frag","\nstruct MaterialUniform {\n  transformUV1:vec4<f32>,\n  transformUV2:vec4<f32>,\n  baseColor: vec4<f32>,\n  rectClip: vec4<f32>,\n  alphaCutoff: f32,\n};\n\n@group(2) @binding(0)\nvar<uniform> materialUniform: MaterialUniform;\n"),Hre.register("InstanceUniform","\n    #if USE_INSTANCEDRAW\n        struct InstanceUniform {\n            matrixIDs : array<i32>\n        };\n        @group(2) @binding(7)\n        var<storage, read> instanceDrawID : InstanceUniform;\n    #endif\n"),Hre.register("Inline_vert",'\n    #include "MathShader"\n    #include "FastMathShader"\n    #include "InstanceUniform"\n\n    var<private> ORI_MATRIX_P: mat4x4<f32>;\n    var<private> ORI_MATRIX_V: mat4x4<f32>;\n    var<private> ORI_MATRIX_M: mat4x4<f32>;\n    var<private> ORI_MATRIX_PV: mat4x4<f32>;\n    var<private> ORI_MATRIX_PVInv: mat4x4<f32>;\n    var<private> ORI_MATRIX_World: mat4x4<f32>;\n    var<private> ORI_CAMERAMATRIX: mat4x4<f32>;\n    var<private> ORI_NORMALMATRIX: mat3x3<f32>;\n    var<private> ORI_CameraWorldDir: vec3<f32>;\n\n    var<private> TIME: vec4<f32>;\n    var<private> MOUSE: vec4<f32>;\n    var<private> SCREEN: vec4<f32>;\n\n    var<private> ProjectionParams: vec4<f32>;\n\n    fn vertex_inline(vertex:VertexAttributes){\n        TIME.x = globalUniform.frame;\n        TIME.y = globalUniform.time;\n        TIME.z = globalUniform.delta;\n\n        MOUSE.x = globalUniform.mouseX;\n        MOUSE.y = globalUniform.mouseY;\n\n        SCREEN.x = globalUniform.windowWidth;\n        SCREEN.y = globalUniform.windowHeight;\n\n        ProjectionParams.x = globalUniform.near;\n        ProjectionParams.y = globalUniform.far;\n        ProjectionParams.z = 1.0 + 1.0 / globalUniform.far;\n\n        ORI_MATRIX_P = globalUniform.projMat ;\n        ORI_MATRIX_V = globalUniform.viewMat ;\n        ORI_MATRIX_PV = ORI_MATRIX_P * ORI_MATRIX_V ;\n        ORI_MATRIX_PVInv = globalUniform.pvMatrixInv ;\n        ORI_CAMERAMATRIX = globalUniform.cameraWorldMatrix ;\n\n        ORI_MATRIX_M = models.matrix[u32(vertex.index)];\n            \n        #if USE_INSTANCEDRAW\n            let modelID = instanceDrawID.matrixIDs[vertex.index];\n            ORI_MATRIX_M = models.matrix[modelID];\n        #endif\n    }\n'),Hre.register("VertexAttributes_vert",Ure),Hre.register("Common_vert",'\n    #include "WorldMatrixUniform"\n    #include "VertexAttributes_vert"\n    #include "GlobalUniform"\n    #include "Inline_vert"\n    @vertex\n    fn VertMain( vertex:VertexAttributes ) -> VertexOutput {\n        vertex_inline(vertex);\n        vert(vertex);\n        return ORI_VertexOut ;\n    }\n'),Hre.register("Common_frag",'\n  #include "GlobalUniform"\n  #include "FragmentVarying"\n  #include "ColorPassFragmentOutput"\n  #include "ShadingInput"\n\n  var<private> ORI_FragmentOutput: FragmentOutput;\n  var<private> ORI_VertexVarying: FragmentVarying;\n  var<private> ORI_ShadingInput: ShadingInput;\n  @fragment\n  fn FragMain( vertex_varying:FragmentVarying ) -> FragmentOutput {\n    ORI_VertexVarying = vertex_varying;\n    ORI_FragmentOutput.color = vec4<f32>(1.0, 0.0, 0.0, 1.0);\n    #if USE_WORLDPOS\n      ORI_FragmentOutput.worldPos = ORI_VertexVarying.vWorldPos;\n    #endif\n    #if USEGBUFFER\n      ORI_FragmentOutput.worldNormal = vec4<f32>(ORI_ShadingInput.Normal.rgb ,1.0); \n      ORI_FragmentOutput.material = vec4<f32>(0.0,1.0,0.0,0.0);\n    #endif\n    frag();\n    #if USE_DEBUG\n      debugFragmentOut();\n    #endif\n\n    return ORI_FragmentOutput ;\n  }\n'),Hre.register("FragmentVarying","\n    struct FragmentVarying {\n        @location(0) fragUV0: vec2<f32>,\n        @location(1) fragUV1: vec2<f32>,\n        @location(2) viewPosition: vec4<f32>,\n        @location(3) fragPosition: vec4<f32>,\n        @location(4) vWorldPos: vec4<f32>,\n        @location(5) vWorldNormal: vec3<f32>,\n        @location(6) vColor: vec4<f32>,\n\n        #if USE_SHADOWMAPING\n            @location(7) vShadowPos: vec4<f32>,\n        #endif\n\n        #if USE_TANGENT\n            @location(8) TANGENT: vec4<f32>,\n        #endif\n        \n        @builtin(front_facing) face: bool,\n        @builtin(position) fragCoord : vec4<f32>\n    };\n"),Hre.register("ColorPassFragmentOutput",Vre),Hre.register("LightStruct","\n    struct LightData {\n        index:f32,\n        lightType:i32,\n        radius:f32,\n        linear:f32,\n        \n        position:vec3<f32>,\n        lightMatrixIndex:f32,\n\n        direction:vec3<f32>,\n        quadratic:f32,\n\n        lightColor:vec3<f32>,\n        intensity:f32,\n\n        innerCutOff :f32,\n        outerCutOff:f32,\n        range :f32,\n        castShadow:i32,\n\n        lightTangent:vec3<f32>,\n        ies:f32,\n    };\n\n    const PointLightType = 1;\n    const DirectLightType = 2;\n    const SpotLightType = 3;\n\n    struct ClusterBox{\n        minPoint:vec4<f32>,\n        maxPoint:vec4<f32>\n    };\n\n    struct LightIndex\n    {\n        count:f32,\n        start:f32,\n        empty0:f32,\n        empty1:f32,\n    };\n\n    struct ClustersUniform{\n        clusterTileX:f32,\n        clusterTileY:f32,\n        clusterTileZ:f32,\n        numLights:f32,\n        maxNumLightsPerCluster:f32,\n        near:f32,\n        far:f32,\n        screenWidth:f32,\n        screenHeight:f32,\n        clusterPix:f32, \n    };\n\n    @group(2) @binding(1)\n    var<storage,read> lightBuffer: array<LightData>;\n    @group(2) @binding(2)\n    var<uniform> clustersUniform : ClustersUniform;\n    @group(2) @binding(3)\n    var<storage,read> lightAssignBuffer : array<f32>;\n    @group(2) @binding(4)\n    var<storage,read> assignTable : array<LightIndex>;\n    #if DEBUG_CLUSTER\n        @group(2) @binding(5)\n        var<storage,read> clusterBuffer : array<ClusterBox>;\n    #endif\n\n    fn getLight( index:i32 ) -> LightData{\n        let lightId = i32(lightAssignBuffer[index]);\n        var lightData = lightBuffer[lightId];\n        return lightData ;\n    }\n\n    fn linear01Depth(depth : f32) -> f32 {\n        return globalUniform.far * globalUniform.near / fma(depth, globalUniform.near-globalUniform.far, globalUniform.far);\n    }\n\n    fn getTile(fragCoord : vec4<f32>) -> vec3<u32> {\n        var coord = fragCoord ; \n        coord.z = linear01Depth(coord.z) ; \n\n        let sliceScale = f32(clustersUniform.clusterTileZ) / log2(globalUniform.far / globalUniform.near);\n        let sliceBias = -(f32(clustersUniform.clusterTileZ) * log2(globalUniform.near) / log2(globalUniform.far / globalUniform.near));\n        let zTile = u32(max(log2(coord.z) * sliceScale + sliceBias, 0.0));\n        return vec3<u32>(u32(coord.x / (clustersUniform.screenWidth / f32(clustersUniform.clusterTileX))),\n                        u32(coord.y / (clustersUniform.screenHeight / f32(clustersUniform.clusterTileY))),\n                        zTile);\n    }\n\n    fn getCluster(fragCoord : vec4<f32>) -> LightIndex {\n    let tile = getTile(fragCoord);\n    let id = tile.x +\n            tile.y * u32(clustersUniform.clusterTileX) +\n            tile.z * u32(clustersUniform.clusterTileX) * u32(clustersUniform.clusterTileY);\n    return assignTable[id];\n    }\n\n    #if DEBUG_CLUSTER\n        fn getClusterIndex(fragCoord : vec4<f32>) -> u32 {\n            let tile = getTile(fragCoord);\n            let id = tile.x +\n                tile.y * u32(clustersUniform.clusterTileX) +\n                tile.z * u32(clustersUniform.clusterTileX) * u32(clustersUniform.clusterTileY);\n            return id;\n            // return 0u ;\n        }\n    #endif\n"),Hre.register("ShadingInput","\n    struct ShadingInput{\n        BaseColor:vec4<f32>,\n        Roughness:f32,\n        Metallic:f32,\n        Specular:f32,\n        EmissiveColor:vec4<f32>,\n        SurfaceColor:vec4<f32>,\n        Normal:vec3<f32>,\n        Tangent:vec4<f32>,\n        WorldPositionOffset:vec3<f32>,\n        AmbientOcclusion:f32,\n        PixelDepthOffset:f32,\n\n        Opacity:f32,\n        OpacityMask:f32,\n\n        Refraction:f32,\n    }\n"),Hre.register("IESProfiles_frag","\n    #if USE_IES_PROFILE \n        @group(1) @binding(auto)\n        var iesTextureArrayMapSampler : sampler;\n        @group(1) @binding(auto)\n        var iesTextureArrayMap: texture_2d_array<f32> ;\n    #endif\n\n    fn getLightIESProfileAtt( wPos : vec3<f32> , light:LightData ) -> f32\n    {\n        #if USE_IES_PROFILE \n            let tangent = vec3<f32>(1.0,0.0,0.0);\n            let lightBitangent = normalize( cross( tangent, light.direction ) );\n            let lightMatrix = mat4x4( vec4<f32>(light.direction.xyz, 0.0), vec4<f32>(lightBitangent.xyz, 0.0), vec4<f32>(tangent.xyz, 0.0), vec4<f32>(0.0, 0.0, 0.0, 1.0) );\n            let lightMatrixInv = transpose(lightMatrix);\n            let lightPos = light.position.xyz;\n            let l = lightPos - wPos; \n            let toLight = normalize(l);\n            let localToLight = (vec4<f32>(toLight.xyz, 0.0) * lightMatrixInv).xyz;\n            let dotProd = dot(toLight, light.direction);\n            let angle = asin(dotProd);\n            let normAngle = (angle / PI) + 0.5 ;\n            let tangentAngle = atan2( -localToLight.z, -localToLight.x ); \n            let normTangentAngle = tangentAngle / (PI * 2.0) + 0.5 ;\n            if(light.ies >= 0.0){\n                return textureSampleLevel(iesTextureArrayMap, iesTextureArrayMapSampler, vec2<f32>(normAngle , normTangentAngle) , i32(light.ies) , 0.0).r ;\n            }else{\n                return 1.0;\n            }\n        #else \n            return 1.0;\n        #endif\n    }\n\n"),Hre.register("ShadowMapping_frag","\n    #if USE_SHADOWMAPING\n    @group(1) @binding(auto) var shadowMapSampler: sampler_comparison;\n    @group(1) @binding(auto) var shadowMap: texture_depth_2d_array;\n    #endif\n\n    @group(1) @binding(auto) var pointShadowMapSampler: sampler;\n    @group(1) @binding(auto) var pointShadowMap: texture_depth_cube_array;\n\n    struct ShadowStruct{\n      directShadowVisibility: array<f32, 8>,\n      pointShadows: array<f32, 8>,\n    }\n\n    var<private>shadowStrut: ShadowStruct;\n\n    struct ShadowBuffer{\n      nDirShadowStart: i32,\n      nDirShadowEnd: i32,\n      nPointShadowStart: i32,\n      nPointShadowEnd: i32,\n      shadowLights:array<u32,16>\n    }\n\n    @group(2) @binding(5) var<storage,read> shadowBuffer: ShadowBuffer;\n\n    fn useShadow(){\n        shadowStrut.directShadowVisibility = array<f32, 8>( 1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0) ;\n        shadowStrut.pointShadows = array<f32, 8>( 1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0) ;\n        directShadowMaping(globalUniform.shadowBias);\n        pointShadowMapCompare(globalUniform.pointShadowBias);\n    }\n\n    fn directShadowMaping(shadowBias: f32)  {\n        for (var i: i32 = shadowBuffer.nDirShadowStart; i < shadowBuffer.nDirShadowEnd ; i = i + 1) {\n          let ldx = shadowBuffer.shadowLights[i];\n          var light = lightBuffer[ldx];\n          var shadowIndex = i32(light.castShadow);\n          shadowStrut.directShadowVisibility[shadowIndex] = 1.0;\n          #if USE_SHADOWMAPING\n            var shadowPosTmp = globalUniform.shadowMatrix[shadowIndex] * vec4<f32>(ORI_VertexVarying.vWorldPos.xyz, 1.0);\n            var shadowPos = shadowPosTmp.xyz / shadowPosTmp.w;\n            var varying_shadowUV = shadowPos.xy * vec2<f32>(0.5, -0.5) + vec2<f32>(0.5, 0.5);\n            var bias = max(shadowBias * (1.0 - dot(ORI_ShadingInput.Normal, light.direction)), 0.000005);\n\n            // if(varying_shadowUV.y>=1.0) {\n            //     shadowStrut.directShadowVisibility[shadowIndex] = 2.0 ;\n            //     continue;\n            // }\n            if (varying_shadowUV.x <= 1.0 && varying_shadowUV.x >= 0.0 && varying_shadowUV.y <= 1.0 && varying_shadowUV.y >= 0.0 && shadowPosTmp.z <= 1.0) {\n              var texelSize = 1.0 / vec2<f32>(globalUniform.shadowMapSize);\n              var oneOverShadowDepthTextureSize = texelSize;\n              var size = 1;\n              var sizeBlock = size * 2 + 1;\n              var sizeBlockA = sizeBlock * sizeBlock;\n              var visibility = 0.0;\n              for (var y = -size; y <= size; y++) {\n                for (var x = -size; x <= size; x++) {\n                  var offset = vec2<f32>(f32(x), f32(y)) * oneOverShadowDepthTextureSize / f32(sizeBlock);\n                  visibility += textureSampleCompare(\n                    shadowMap,\n                    shadowMapSampler,\n                    varying_shadowUV + offset,\n                    shadowIndex,\n                    shadowPos.z - bias\n                  );\n                }\n              }\n              visibility /= f32(sizeBlockA);\n              shadowStrut.directShadowVisibility[shadowIndex] = visibility + 0.001;\n            }\n          #endif\n      }\n    }\n\n    fn pointShadowMapCompare(shadowBias: f32){\n      let worldPos = ORI_VertexVarying.vWorldPos.xyz;\n      let offset = 0.1;\n      // let lightIndex = getCluster(ORI_VertexVarying.fragCoord);\n      // let start = max(lightIndex.start, 0.0);\n      // let count = max(lightIndex.count, 0.0);\n      // let end = max(start + count, 0.0);\n\n      for (var i: i32 = shadowBuffer.nPointShadowStart; i < shadowBuffer.nPointShadowEnd ; i = i + 1) {\n        let ldx = shadowBuffer.shadowLights[i];\n        let light = lightBuffer[ldx] ;\n        shadowStrut.pointShadows[light.castShadow] = 1.0;\n\n        #if USE_SHADOWMAPING\n        let lightPos = light.position.xyz;\n        var shadow = 0.0;\n        let frgToLight = worldPos - lightPos.xyz;\n        var dir: vec3<f32> = normalize(frgToLight);\n        var len = length(frgToLight);\n        var bias = max(shadowBias * globalUniform.far * (1.0 - dot(ORI_ShadingInput.Normal, dir)), 0.005);\n\n        #if USE_PCF_SHADOW\n        let samples = 4.0;\n        for (var x: f32 = -offset; x < offset; x += offset / (samples * 0.5)) {\n          for (var y: f32 = -offset; y < offset; y += offset / (samples * 0.5)) {\n            for (var z: f32 = -offset; z < offset; z += offset / (samples * 0.5)) {\n              let offsetDir = normalize(dir.xyz + vec3<f32>(x, y, z));\n              var depth = textureSampleLevel(pointShadowMap, pointShadowMapSampler, offsetDir, light.castShadow, 0);\n              depth *= globalUniform.far;\n              if ((len - bias) > depth) {\n                shadow += 1.0 * dot(offsetDir, dir.xyz);\n              }\n            }\n          }\n        }\n        shadow = min(max(shadow / (samples * samples * samples), 0.0), 1.0);\n        #endif\n\n        #if USE_SOFT_SHADOW\n        let vDis = length(globalUniform.CameraPos.xyz - worldPos.xyz);\n        let sampleRadies = globalUniform.shadowSoft;\n        let samples = 20;\n        for (var j: i32 = 0; j < samples; j += 1) {\n          let offsetDir = normalize(dir.xyz + sampleOffetDir[j] * sampleRadies);\n          var depth = textureSampleLevel(pointShadowMap, pointShadowMapSampler, offsetDir, light.castShadow, 0);\n          depth *= globalUniform.far;\n          if ((len - bias) > depth) {\n            shadow += 1.0 * dot(offsetDir, dir.xyz);\n          }\n        }\n        shadow = min(max(shadow / f32(samples), 0.0), 1.0);\n        #endif\n\n        #if USE_HARD_SHADOW\n        var depth = textureSampleLevel(pointShadowMap, pointShadowMapSampler, dir.xyz, light.castShadow, 0);\n        depth *= globalUniform.far;\n        if ((len - bias) > depth) {\n          shadow = 1.0;\n        }\n        #endif\n\n        shadowStrut.pointShadows[light.castShadow] = 1.0 - shadow;\n        #endif\n      }\n    }\n\n    #if USE_SOFT_SHADOW\n    var<private>sampleOffetDir : array<vec3<f32>, 20> = array<vec3<f32>, 20>(\n      vec3<f32>(1.0, 1.0, 1.0), vec3<f32>(1.0, -1.0, 1.0), vec3<f32>(-1.0, -1.0, 1.0), vec3<f32>(-1.0, 1.0, 1.0),\n      vec3<f32>(1.0, 1.0, -1.0), vec3<f32>(1.0, -1.0, -1.0), vec3<f32>(-1.0, -1.0, -1.0), vec3<f32>(-1.0, 1.0, -1.0),\n      vec3<f32>(1.0, 1.0, 0.0), vec3<f32>(1.0, -1.0, 0.0), vec3<f32>(-1.0, -1.0, 0.0), vec3<f32>(-1.0, 1.0, 0.0),\n      vec3<f32>(1.0, 0.0, 1.0), vec3<f32>(-1.0, 0.0, 1.0), vec3<f32>(1.0, 0.0, -1.0), vec3<f32>(-1.0, 0.0, -1.0),\n      vec3<f32>(0.0, 1.0, 1.0), vec3<f32>(0.0, -1.0, 1.0), vec3<f32>(0.0, -1.0, -1.0), vec3<f32>(0.0, 1.0, -1.0),\n    );\n    #endif\n"),Hre.register("Irradiance_frag",'\n#include "IrradianceVolumeData_frag"\n    fn pow3(  x : f32 ) -> f32\n    {\n        return x*x*x;\n    }\n\n    struct IrradianceField {\n        probeStartPosition: vec4<f32>,\n        probeCounts:vec4<f32>,\n        probeStep:f32,\n        irradianceTextureWidth:f32,\n        irradianceTextureHeight:f32,\n        irradianceProbeSideLength:f32,\n    };\n\n    @group(1) @binding(auto)\n    var irradianceMapSampler: sampler;\n    @group(1) @binding(auto)\n    var irradianceMap: texture_2d<f32>;\n    @group(1) @binding(auto)\n    var irradianceDepthMapSampler: sampler;\n    @group(1) @binding(auto)\n    var irradianceDepthMap: texture_2d<f32>;\n\n    @group(2) @binding(6)\n    var<storage,read> irradianceData : IrradianceVolumeData ;\n\n    var<private> irradianceFieldSurface: IrradianceField;\n    var<private> energyPreservation: f32 = 0.85;\n    var<private> quaternion:vec4<f32> = vec4<f32>(0.0, -0.7071067811865475, 0.7071067811865475, 0.0);\n\n    fn getIrradianceFieldSurface() -> IrradianceField{\n        let data = irradianceData ;\n        irradianceFieldSurface.probeStartPosition = vec4<f32>(data.startX, data.startY, data.startZ, 0.0);\n        irradianceFieldSurface.probeCounts = vec4<f32>(data.gridXCount, data.gridYCount, data.gridZCount, 0.0);\n        irradianceFieldSurface.probeStep = data.ProbeSpace;\n        irradianceFieldSurface.irradianceTextureWidth = data.OctRTMaxSize;\n        irradianceFieldSurface.irradianceTextureHeight = data.OctRTMaxSize;\n        irradianceFieldSurface.irradianceProbeSideLength = data.OctRTSideSize;\n        return irradianceFieldSurface;\n    }\n\n    fn rotateDir(n:vec3<f32>) -> vec3<f32>{\n       return normalize(applyQuaternion(-n, quaternion));\n    }\n\n    fn square1f(v:f32) -> f32 {\n        return v * v ;\n     }\n\n   fn square(v:vec3<f32>) -> vec3<f32>{\n      return v*v;\n   }\n\n    fn getIrradiance() -> vec4<f32>{\n        var irradiance = sampleIrradianceField();\n        var outerVolumeFactor:f32 = getOuterVolume(irradianceFieldSurface, ORI_VertexVarying.vWorldPos.xyz);\n        irradiance *= outerVolumeFactor;\n       return irradiance ;\n    }\n    \n    fn debugProbe(id:i32) -> vec4<f32>{\n        getIrradianceFieldSurface();\n        var direction = normalize(ORI_VertexVarying.vWorldNormal);\n        direction = applyQuaternion(-direction, quaternion);\n        var probeTextureUV : vec2<f32> = textureCoordFromDirection(normalize(direction),\n            id,\n            irradianceFieldSurface.irradianceTextureWidth,\n            irradianceFieldSurface.irradianceTextureHeight,\n            irradianceFieldSurface.irradianceProbeSideLength);\n\n        var probeIrradiance: vec4<f32> = textureSampleLevel(irradianceMap, irradianceMapSampler, probeTextureUV ,0.0);\n        return probeIrradiance;\n    }\n    \n    fn debugProbeDepth(id:i32) -> vec4<f32>{\n        getIrradianceFieldSurface();\n        var direction = normalize(ORI_VertexVarying.vWorldNormal);\n        direction = applyQuaternion(-direction, quaternion);\n        var probeTextureUV : vec2<f32> = textureCoordFromDirection(normalize(direction),\n            id,\n            irradianceFieldSurface.irradianceTextureWidth,\n            irradianceFieldSurface.irradianceTextureHeight,\n            irradianceFieldSurface.irradianceProbeSideLength);\n        \n        var probeIrradiance: vec4<f32> = textureSampleLevel(irradianceDepthMap, irradianceDepthMapSampler, probeTextureUV ,0.0);\n        probeIrradiance.x = probeIrradiance.x / irradianceData.maxDistance;\n        probeIrradiance.y = 0.0;\n        probeIrradiance.z = 0.0;\n        probeIrradiance.w = 1.0;\n        return probeIrradiance;\n    }\n    \n    fn getOuterVolume(L:IrradianceField, position:vec3<f32>) -> f32{\n        let halfWidth:vec3<f32> = 0.5 * (L.probeCounts.xyz - 1.0) * L.probeStep;\n        let edgeWidth:vec3<f32> = halfWidth + L.probeStep;\n        let centerPosition:vec3<f32> = halfWidth + L.probeStartPosition.xyz;\n        let clampPos = min(edgeWidth, abs(position - centerPosition));\n        \n        let factorX = getOuterAxis(clampPos.x, edgeWidth.x, L.probeStep);\n        let factorY = getOuterAxis(clampPos.y, edgeWidth.y, L.probeStep);\n        let factorZ = getOuterAxis(clampPos.z, edgeWidth.z, L.probeStep);\n        return factorX * factorY * factorZ;\n    }\n    \n    fn getOuterAxis(current:f32, edge:f32, space:f32) -> f32{\n        return clamp((edge - current) / space, 0.0, 1.0);\n    }\n\n    fn getBaseGridCoord(L:IrradianceField, X:vec3<f32>) -> vec3<i32> {\n        var offsetIndex = (X - L.probeStartPosition.xyz) / irradianceFieldSurface.probeStep;\n        return clamp(vec3<i32>(offsetIndex.xyz), vec3<i32>(0), vec3<i32>(L.probeCounts.xyz) - 1);\n    }\n\n    fn gridCoordToProbeIndex(L:IrradianceField, grid:vec3<i32>) -> i32\n    {\n        return grid.x + i32(L.probeCounts.x) * grid.z + grid.y * i32(L.probeCounts.z * L.probeCounts.x);\n    }\n\n    fn gridCoordToPosition(L:IrradianceField, grid:vec3<i32>) -> vec3<f32>\n    {\n        var pos:vec3<f32> = vec3<f32>(grid.xyz) * L.probeStep + L.probeStartPosition.xyz;\n        return pos;\n    }\n\n    fn textureCoordFromDirection(dir:vec3<f32>, probeIndex:i32, width:f32, height:f32, sideLength:f32) -> vec2<f32>\n    {\n        var uv = getWriteOctUVByID(dir, u32(probeIndex), sideLength) ;\n        uv.x = uv.x / irradianceFieldSurface.irradianceTextureWidth;\n        uv.y = uv.y / irradianceFieldSurface.irradianceTextureHeight;\n        return uv ;\n    }\n\n    fn getWriteOctUVByID(dir:vec3<f32> , probeID:u32, size: f32) -> vec2<f32>\n    {\n        var blockCount = u32(irradianceFieldSurface.probeCounts.x * irradianceFieldSurface.probeCounts.z) ;\n        var offsetX = (probeID % blockCount) % u32(irradianceFieldSurface.probeCounts.x) ;\n        var offsetY = u32(irradianceFieldSurface.probeCounts.z - 1.0) - (probeID % blockCount) / u32(irradianceFieldSurface.probeCounts.x) ;\n        var offsetZ = probeID / blockCount ;\n\n        var pixelCoord = (( octEncode(dir) + 1.0 ) * 0.5) * vec2<f32>(size,size) ;\n\n        var blockOffset = vec2<f32>(0.0);\n        blockOffset.x = f32(offsetX) * size;\n        blockOffset.y = f32(offsetY) * size + f32(offsetZ) * irradianceFieldSurface.probeCounts.z * size;\n\n        let mapHeight = u32(irradianceFieldSurface.irradianceTextureHeight);\n        var probeCounts:vec3<f32> = irradianceFieldSurface.probeCounts.xyz;\n\n        var gridOffsetFrom = vec2<i32>(blockOffset) + 1;\n        var gridOffsetTo = offsetByCol(gridOffsetFrom, size, mapHeight, probeCounts);\n\n        pixelCoord = pixelCoord + vec2<f32>(gridOffsetTo - 1) + vec2<f32>(vec2<i32>(vec2<f32>(gridOffsetTo) / size) * 2);\n\n        return pixelCoord + 1.0 ;\n    }\n\n    fn offsetByCol(pixelCoord0:vec2<i32>, octSideSize:f32, mapHeight:u32, counts:vec3<f32>) -> vec2<i32>\n    {\n      var pixelCoord = pixelCoord0;\n      let blockSize:vec2<i32> = vec2<i32>(i32(octSideSize * counts.x),  i32(octSideSize * counts.z));\n      let blockSizeYBorder:i32 = i32((octSideSize + 2.0) * counts.z);\n      let blockMaxRowBorder:i32 = i32(mapHeight) / blockSizeYBorder;\n      let pixelCountYMax:i32 = blockMaxRowBorder * i32(octSideSize * counts.z);\n      let col:i32 = pixelCoord.y / pixelCountYMax;\n      pixelCoord.x = col * i32(octSideSize * counts.x) + pixelCoord.x;\n      pixelCoord.y = pixelCoord.y % pixelCountYMax;\n      return pixelCoord;\n    }\n\n    var<private> wpNormal:vec3<f32> ;\n    fn sampleIrradianceField() -> vec4<f32>{\n        wpNormal = ORI_ShadingInput.Normal.xyz ;\n        var wo:vec3<f32> = ORI_CameraWorldDir ;\n        var wsN:vec3<f32> = normalize(wpNormal);\n        var direction:vec3<f32> = wpNormal;\n        var worldPosition: vec3<f32> = ORI_VertexVarying.vWorldPos.xyz;\n   \n        getIrradianceFieldSurface();\n\n        let surfaceBias = (wsN + 3.0 * wo) * irradianceData.normalBias ;\n\n        var irradiance = vec3<f32>(0.0, 0.0, 0.0);\n        var accumulatedWeights = 0.0;\n        var biasedWorldPosition = (worldPosition + surfaceBias);\n\n        var baseProbeCoords: vec3<i32> = getBaseGridCoord(irradianceFieldSurface, worldPosition);\n        \n        var baseProbeWorldPosition: vec3<f32> = gridCoordToPosition(irradianceFieldSurface, baseProbeCoords) ;\n        \n        var gridSpaceDistance = (biasedWorldPosition - baseProbeWorldPosition);\n\n        // alpha is how far from the floor(currentVertex) position. on [0, 1] for each axis.\n        var alpha: vec3<f32> = clamp(gridSpaceDistance / (irradianceFieldSurface.probeStep), vec3<f32>(0.0), vec3<f32>(1.0));\n        // let irradianceDir = rotateDir(wsN.xyz);\n        // Iterate over adjacent probe cage\n        for (var i:i32 = 0; i < 8; i = i + 1) {\n            var adjacentProbeOffset : vec3<i32> = vec3<i32>(i, i32(f32(i) * 0.5), i32(f32(i) * 0.25)) & vec3<i32>(1);\n            var adjacentProbeCoords: vec3<i32> = clamp(baseProbeCoords + adjacentProbeOffset, vec3<i32>(0),  vec3<i32>(irradianceFieldSurface.probeCounts.xyz) - 1) ;\n            \n            var adjacentProbeIndex :i32 = gridCoordToProbeIndex(irradianceFieldSurface, adjacentProbeCoords);\n            var adjacentProbeWorldPosition :vec3<f32> = gridCoordToPosition(irradianceFieldSurface, adjacentProbeCoords) ;//+ (wsN + 3.0 * w_o) * globalUniform.normalBias;\n         \n            var worldPosToAdjProbe = normalize(adjacentProbeWorldPosition - worldPosition);\n            var biasedPosToAdjProbe = normalize(adjacentProbeWorldPosition - biasedWorldPosition);\n            var biasedPosToAdjProbeDist = length(adjacentProbeWorldPosition - biasedWorldPosition);\n\n            let trilinear = max(vec3<f32>(0.001), mix(1.0 - alpha, alpha, vec3<f32>(adjacentProbeOffset)));\n            let trilinearWeight = (trilinear.x * trilinear.y * trilinear.z);\n            var weight = 1.0;\n\n            var wrapShading = (dot(worldPosToAdjProbe, direction) + 1.0) * 0.5;\n            weight *= (wrapShading * wrapShading) + 0.2;\n\n            var depthDir = -biasedPosToAdjProbe;//probe - world\n            depthDir = applyQuaternion(depthDir, quaternion);\n            var probeTextureUV : vec2<f32> = textureCoordFromDirection(depthDir.xyz,\n                adjacentProbeIndex,\n                irradianceFieldSurface.irradianceTextureWidth,\n                irradianceFieldSurface.irradianceTextureHeight,\n                irradianceFieldSurface.irradianceProbeSideLength);\n\n            var filteredDistance : vec2<f32> = 2.0 * textureSampleLevel(irradianceDepthMap, irradianceDepthMapSampler, probeTextureUV,0.0).rg ;\n           \n            var variance = abs((filteredDistance.x * filteredDistance.x) - filteredDistance.y);\n\n            var chebyshevWeight = 1.0;\n            if(biasedPosToAdjProbeDist > filteredDistance.x ) // occluded\n            {\n                var v = biasedPosToAdjProbeDist - filteredDistance.x ;\n                chebyshevWeight = variance / (variance + (v * v));\n                // Increase the contrast in the weight\n                chebyshevWeight = max((chebyshevWeight * chebyshevWeight * chebyshevWeight), 0.0);\n            }\n\n            weight *= max(0.05, chebyshevWeight);\n            weight = max(0.000001, weight);\n\n            let crushThreshold = 0.2;\n            if (weight < crushThreshold)\n            {\n                weight *= (weight * weight) * (1.0 / (crushThreshold * crushThreshold));\n            }\n\n            weight *= trilinearWeight;\n            \n            //worldPosToAdjProbe\n            let rotateDir = applyQuaternion(-direction, quaternion);\n            probeTextureUV = textureCoordFromDirection((rotateDir),\n            adjacentProbeIndex,\n            irradianceFieldSurface.irradianceTextureWidth,\n            irradianceFieldSurface.irradianceTextureHeight,\n            irradianceFieldSurface.irradianceProbeSideLength);\n\n            var probeIrradiance: vec3<f32> = textureSampleLevel(irradianceMap, irradianceMapSampler, probeTextureUV ,0.0).xyz;\n\n            var exponent =  irradianceData.ddgiGamma * 0.5;\n            probeIrradiance = pow(probeIrradiance, vec3<f32>(exponent));\n            \n            irradiance += (weight * probeIrradiance);\n            accumulatedWeights += weight;\n        }\n\n        if(accumulatedWeights == 0.0){\n            return vec4<f32>(0.0, 0.0, 0.0,1.0);\n        }\n\n        irradiance *= (1.0 / accumulatedWeights);   \n        irradiance *= irradiance;                   \n\n        //irradiance *= 6.2831853071795864;\n        irradiance *= PI;\n        irradiance *= irradianceData.indirectIntensity;\n        return vec4<f32>(irradiance,1.0) ;\n    }\n\n'),Hre.register("IrradianceVolumeData_frag","\n    struct IrradianceVolumeData {\n        //0\n        orientationIndex:f32,\n            hysteresis:f32,\n            OctRTSideSize:f32,\n            OctRTMaxSize:f32,\n\n            //1\n            startX:f32,\n            startY:f32,\n            startZ:f32,\n            ProbeSpace:f32,\n\n            //2\n            gridXCount:f32,\n            gridYCount:f32,\n            gridZCount:f32,\n            maxDistance:f32,\n\n            //3\n            depthSharpness:f32,\n            ProbeSourceTextureSize:f32,\n            ProbeSize:f32,\n            bounceIntensity:f32,\n\n            //4\n            probeRoughness:f32,\n            normalBias:f32,\n            irradianceChebyshevBias:f32,\n            rayNumber:f32,\n\n            //5\n            irradianceDistanceBias:f32,\n            indirectIntensity:f32,\n            ddgiGamma:f32,\n            lerpHysteresis:f32,\n            //6\n\n            debugX:f32,\n            debugY:f32,\n            debugZ:f32,\n            slot0:f32,\n\n            //..\n            v7:vec4<f32>,\n    }\n"),Hre.register("BrdfLut_frag","\n    @group(1) @binding(auto)\n    var brdflutMapSampler: sampler;\n    @group(1) @binding(auto)\n    var brdflutMap: texture_2d<f32>;\n"),Hre.register("EnvMap_frag","\n    @group(1) @binding(auto)\n    var prefilterMapSampler: sampler;\n    @group(1) @binding(auto)\n    var prefilterMap: texture_cube<f32>;\n    @group(1) @binding(auto)\n    var envMapSampler: sampler;\n    @group(1) @binding(auto)\n    var envMap: texture_cube<f32>;\n"),Hre.register("ColorUtil_frag",Gre),Hre.register("ColorUtil",Gre),Hre.register("BRDF_frag",'\n#include "Clearcoat_frag"\n    #include "EnvMap_frag"\n    #include "BrdfLut_frag"\n\n    struct FragData {\n        Ao: f32,\n        Metallic: f32,\n        Roughness: f32,\n\n        Albedo: vec4<f32>,\n        Emissive: vec3<f32>,\n\n        N: vec3<f32>,\n        V: vec3<f32>,\n        R: vec3<f32>,\n\n        F0: vec3<f32>,\n        F: vec3<f32>,\n        KS: vec3<f32>,\n        KD: vec3<f32>,\n        Shadow: f32,\n        Indirect: f32,\n        Reflectance: f32,\n\n        NoV: f32,\n        FaceDirection:f32,\n\n        DiffuseColor: vec3<f32>,\n        SpecularColor: vec3<f32>,\n        ClearcoatRoughness:f32,\n        EnvColor: vec3<f32>,\n        Irradiance: vec3<f32>,\n    };\n\n    var<private> fragData: FragData;\n\n    struct BxDFContext\n    {\n        NoV : f32 ,\n        NoL : f32 ,\n        VoL : f32 ,\n        NoH : f32 ,\n        VoH : f32\n    };\n\n    fn getContext( N:vec3<f32>, V:vec3<f32>, H:vec3<f32>, L:vec3<f32> ) -> BxDFContext\n    {\n        var Context:BxDFContext ;\n        Context.NoL = saturate(dot(N, L))  ;\n        Context.NoV = saturate(dot(N, V))  ;\n        Context.VoL = saturate(dot(V, L)) ;\n        Context.NoH = saturate(dot(N, H));\n        Context.VoH = saturate(dot(V, H));\n\n        // Context.NoL = max(dot(N, L),0.0);\n        // Context.NoV = max(dot(N, V),0.0);\n        // Context.VoL = max(dot(V, L),0.0) ;\n        // Context.NoH = saturate(dot(N, H));\n        // Context.VoH = max(dot(V, H),0.0);\n        return Context ;\n    }\n\n    // convert roughness to mipmapLevel\n    fn roughnessToMipmapLevel( roughness: f32 , mipmapCount:i32 ) -> f32{\n        let level = roughness * (1.7 - 0.7 * roughness );\n        return level * f32(mipmapCount);\n    }\n\n    fn Fd90( NoL:f32, roughness:f32) -> f32\n    {\n        return (2.0 * NoL * roughness) + 0.4;\n    }\n\n    fn KDisneyTerm( NoL:f32, NoV:f32 , roughness:f32) -> f32\n    {\n        return (1.0 + Fd90(NoL, roughness) * pow(1.0 - NoL, 5.0)) * (1.0 + Fd90(NoV, roughness) * pow(1.0 - NoV, 5.0));\n    }\n\n    fn FresnelSchlick( NoV:f32,  F0:vec3<f32>) -> vec3<f32>\n    {\n        return F0 + (1.0 - F0) * pow(1.0 - NoV, 5.0);\n    }\n\n    fn FresnelSchlickRoughness( NoV:f32,  F0:vec3<f32>,  roughness:f32) -> vec3<f32>\n    {\n        return F0 + (max(vec3(1.0 - roughness), F0) - F0) * pow(1.0 - NoV, 5.0);\n    }\n\n    fn DistributionGGX( NdotH:f32 ,  roughness:f32 ) -> f32\n    {\n        let alpha = roughness * roughness;\n        let alpha2 = roughness * roughness;\n\n        let NdotH2 = NdotH * NdotH;\n\n        let nom   = alpha2;\n        var denom = (NdotH2 * (alpha2 - 1.0) + 1.0);\n        denom = PI * denom * denom;\n\n        return nom / denom;\n    }\n\n    // [Heitz 2014, "Understanding the Masking-Shadowing Function in Microfacet-Based BRDFs"]\n    fn Vis_SmithJoint( NoV : f32 ,  NoL : f32 ,  a2 : f32) -> f32\n    {\n        var Vis_SmithV = NoL * sqrt(NoV * (NoV - NoV * a2) + a2);\n        var Vis_SmithL = NoV * sqrt(NoL * (NoL - NoL * a2) + a2);\n        return 0.5 * rcp(Vis_SmithV + Vis_SmithL);\n    }\n\n    fn GeometrySchlickGGX( NdotV : f32 , roughness : f32 ) -> f32\n    {\n        //roughness compute ks\n        let r = (roughness + 1.0);\n        let k = (r*r) / 8.0;\n\n        let nom   = NdotV;\n        let denom = NdotV * (1.0 - k) + k;\n        \n        return nom / denom;\n    }\n    \n    fn GeometrySmith( NdotV:f32 , NdotL:f32 , roughness : f32) -> f32\n    {\n        // let NdotV = max(dot(N, V), 0.0);\n        // let NdotL = max(dot(N, L), 0.0);\n        let ggx1 = GeometrySchlickGGX(NdotV, roughness);\n        let ggx2 = GeometrySchlickGGX(NdotL, roughness);\n        return ggx1 * ggx2;\n    }\n\n    fn GeometryAttenuationGGXSmith( NdotL:f32,  NdotV:f32,  roughness:f32) -> f32\n    {\n        var NdotL2 = NdotL * NdotL;\n        var NdotV2 = NdotV * NdotV;\n        var kRough2 = roughness * roughness + 0.0001;\n\n        var ggxL = (2.0 * NdotL) / (NdotL + sqrt(NdotL2 + kRough2 * (1.0 - NdotL2)));\n        var ggxV = (2.0 * NdotV) / (NdotV + sqrt(NdotV2 + kRough2 * (1.0 - NdotV2)));\n\n        return ggxL * ggxV;\n    }\n\n    fn colorLinear( colorVector:vec3<f32> ) -> vec3<f32>\n    {\n        var linearColor = pow(colorVector.rgb, vec3<f32>(2.2));\n        return linearColor;\n    }\n\n    fn computeFresnelSchlick( NoV:f32 , F0:vec3<f32>) -> vec3<f32>\n    {\n        return F0 + (1.0 - F0) * pow(clamp(1.0 - NoV,0.0,1.0), 5.0);\n    }\n\n    fn computeFresnelSchlickRoughness(NoV:f32 , F0:vec3<f32>,  roughness:f32) -> vec3<f32>\n    {\n        return F0 + (max(vec3(1.0 - roughness), F0) - F0) * pow(clamp(1.0 - fragData.NoV,0.0,1.0), 5.0);\n    }\n\n    fn computeDistributionGGX( N:vec3<f32>,  H:vec3<f32>,  roughness:f32) -> f32\n    {\n        var alpha = roughness * roughness;\n        var alpha2 = alpha * alpha; \n\n        var NdotH = saturate(dot(N, H));\n        var NdotH2 = NdotH * NdotH;\n\n        return (alpha2) / (PI * (NdotH2 * (alpha2 - 1.0) + 1.0) * (NdotH2 * (alpha2 - 1.0) + 1.0));\n    }\n\n    fn D_GGX( N:vec3<f32>,  H:vec3<f32>,  roughness:f32 ) -> f32\n    {\n        var NoH = saturate(dot(N, H));\n        var d = ( NoH * roughness - NoH ) * NoH + 1.0;\t// 2 mad\n        return roughness / ( PI*d*d );\t\t\t\t\t// 4 mul, 1 rcp\n    }\n\n    fn computeGeometryAttenuationGGXSmith( NdotL:f32 ,  NdotV:f32,  roughness:f32) -> f32\n    {\n        var NdotL2 = NdotL * NdotL;\n        var NdotV2 = NdotV * NdotV;\n        var kRough2 = roughness * roughness + 0.0001;\n\n        var ggxL = (2.0 * NdotL) / (NdotL + sqrt(NdotL2 + kRough2 * (1.0 - NdotL2)));\n        var ggxV = (2.0 * NdotV) / (NdotV + sqrt(NdotV2 + kRough2 * (1.0 - NdotV2)));\n\n        return ggxL * ggxV;\n    }\n\n    fn Vis_Smith(  NoL:f32 ,  NoV:f32,  a2:f32 )-> f32\n    {\n        var Vis_SmithV = NoV + sqrt( NoV * (NoV - NoV * a2) + a2 );\n        var Vis_SmithL = NoL + sqrt( NoL * (NoL - NoL * a2) + a2 );\n        return rcp( Vis_SmithV * Vis_SmithL );\n    }\n\n    fn simpleBRDF( albedo:vec3<f32>, N:vec3<f32>, V:vec3<f32>,L:vec3<f32>,att:f32,lightColor:vec3<f32>,roughness:f32 )-> vec3<f32>{\n        let H = normalize(V + L);\n        let Context:BxDFContext = getContext(N,V,H,L);\n\n        let D = DistributionGGX( Context.NoH , roughness);\n        let G = GeometrySmith(Context.NoV,Context.NoL, roughness );\n        let F = FresnelSchlick(Context.VoH, vec3<f32>(fragData.F0));\n        let specular = ( D * G * F ) / (4.0 * Context.NoV * Context.NoL + 0.001);\n        let kS = F;\n        var kd = 1.0 - kS ;\n        kd *= 1.0 - fragData.Metallic ;\n        var diffuse = kd * (albedo.rgb / PI ) ;\n        let ambient = specular.rgb ;\n\n        fragData.KD += kd;\n        fragData.KS += F;\n\n        var col = (diffuse + ambient) * Context.NoL * lightColor * att ;\n        // var col = (diffuse + ambient) * Context.NoL * lightColor ;\n        return (col.rgb ) ;\n    }\n\n    fn getSpecularDominantDir (  N : vec3<f32> , R : vec3<f32> , roughness : f32 ) -> vec3<f32>\n    {\n        var smoothness = saturate (1.0 - roughness );\n        var lerpFactor = smoothness * ( sqrt ( smoothness ) + roughness );\n        // The result is not normalized as we fetch in a cubemap\n        return mix (N, R, lerpFactor );\n    }\n\n    fn approximateSpecularIBL( specularColor:vec3<f32> , roughness:f32 , R:vec3<f32>) -> vec3<f32> {\n        let NoV = fragData.NoV ;\n        let MAX_REFLECTION_LOD  = i32(textureNumLevels(prefilterMap)) ;\n        let mip = roughnessToMipmapLevel(roughness,MAX_REFLECTION_LOD);\n        var prefilteredColor: vec3<f32> = (textureSampleLevel(prefilterMap, prefilterMapSampler, getSpecularDominantDir(fragData.N,R,roughness) , mip ).rgb);\n        prefilteredColor = globalUniform.skyExposure * LinearToGammaSpace(prefilteredColor);\n        var envBRDF = textureSampleLevel(brdflutMap, brdflutMapSampler, vec2<f32>(NoV, roughness) , 0.0 ) ;\n        return prefilteredColor * (specularColor.rgb * envBRDF.x + saturate( 50.0 * specularColor.g ) * envBRDF.y) ;\n    }\n\n    fn fresnel_coat(n:vec3<f32>,v:vec3<f32>,ior:f32) -> f32 {\n        var f0 = (1.0-ior)/(1.0+ior);\n        f0 = f0 * f0  ;\n        let fr = pow((f0 + (1.0 - f0)*(1.0 - abs( max(dot(n,v),0.0) ))) , 5.0 ) ;  \n        return fr ;\n    }\n\n    fn reflectEnvMap(n:vec3<f32> , v:vec3<f32> , roughness:f32) -> vec3<f32> {\n        let MAX_REFLECTION_LOD  = i32(textureNumLevels(envMap)) ;\n        let mip = roughnessToMipmapLevel(roughness,MAX_REFLECTION_LOD);\n        let R = 2.0 * dot( v , n ) * n - v ;\n        var prefilteredColor: vec3<f32> = globalUniform.skyExposure * (textureSampleLevel(envMap, envMapSampler, R , mip ).rgb);\n        prefilteredColor = LinearToGammaSpace(prefilteredColor);\n        return prefilteredColor ;\n    }\n\n    fn Specular_D_GGX( NoH:f32,  roughness:f32 ) -> f32\n    {\n        let a2 = roughness * roughness ;\n        let f = (NoH * a2 - NoH) * NoH + 1.0;\n        return a2 / (PI * f * f) ;\n    }\n\n    fn V_Kelemen( LoH : f32 ) -> f32 {\n        return 0.25 / (LoH * LoH);\n    }\n\n    fn F_Schlick( f0:vec3<f32> ,  f90 : f32 ,  VoH : f32 ) -> vec3<f32> {\n        return f0 + (f90 - f0) * pow(1.0 - VoH,5.0);\n    }\n\n    //https://google.github.io/filament/Filament.html materialsystem/clearcoatmodel/clearcoatparameterization\n    fn CoatSpecular_brdf( f:vec3<f32>, s:vec3<f32>, n:vec3<f32> , v:vec3<f32> , l:vec3<f32> , att:f32 , layer :vec3<f32>) -> vec3<f32> {\n        let H = normalize(v + l); \n        let VdotNc = max(dot(v,n),0.0);\n        let LdotNc = max(dot(l,n),0.0);\n        let NoH = max(dot(n,H),0.0);\n        let LoH = clamp(dot(l,H),0.0,1.0);\n        let NoL = max(dot(n,l),0.0);\n\n        let Fd = f ; \n        let Fr = s ; \n\n        let clearcoatRoughnessFactor = clamp(materialUniform.clearcoatRoughnessFactor,0.089,1.0);\n        let clearCoatRoughness = clearcoatRoughnessFactor * clearcoatRoughnessFactor ;\n\n        let Dc = Specular_D_GGX( NoH , clearCoatRoughness ) ;\n        let Vc = V_Kelemen( LoH ) ;\n        let Fc = F_Schlick(vec3<f32>(0.04), clearCoatRoughness , pow(LoH,2.0)); \n        let Frc = (Dc * Vc) * Fc ;\n        // return layer * vec3<f32>((Fd + Fr * (1.0 - Fc)) * (1.0 - Fc) + Frc) ;//* NoL;\n        return layer * vec3<f32>((Fd + Fr * (1.0 - Fc)) * (1.0 - Fc) + Frc) * ( 0.5 + NoL * 0.5 ) ;\n    }\n\n    fn approximate_coating(base:vec3<f32> , clearColor: vec3<f32>, n:vec3<f32> , v:vec3<f32> , light:LightData ) -> vec3<f32> {\n        let clearcoatRoughnessFactor = clamp(materialUniform.clearcoatRoughnessFactor,0.084,1.0);\n        var clearcoatAlpha = clearcoatRoughnessFactor * clearcoatRoughnessFactor + fragData.ClearcoatRoughness;\n\n        // var lightColor = getHDRColor( lightCC.rgb , light.linear )  ;\n        var att = light.intensity ;\n        let l = light.direction ;\n   \n        let NdotV = max(dot(n,v),0.0);\n        let MAX_REFLECTION_LOD  = i32(textureNumLevels(prefilterMap)) ;\n        let mip = roughnessToMipmapLevel(clearcoatAlpha,MAX_REFLECTION_LOD);\n        let R = 2.0 * dot( v , n ) * n - v ;\n        var envIBL: vec3<f32> = globalUniform.skyExposure * (textureSampleLevel(prefilterMap, prefilterMapSampler, R ,mip ).rgb) ;\n        envIBL = LinearToGammaSpace(envIBL);\n\n        let clearCoat = materialUniform.clearcoatFactor ;\n        let f = FresnelSchlickRoughness( max(dot(n,v),0.0) , vec3<f32>(0.0) , clearcoatAlpha ) ;\n        let clearcoat_brdf = (f * envIBL) + CoatSpecular_brdf( clearColor , vec3<f32>( clearCoat ) , n , v , -l , att , envIBL ) ;\n\n        // return clearcoat_brdf;+ fragData.ClearcoatRoughness \n        return mix(base,clearcoat_brdf,materialUniform.clearcoatWeight ) ;\n    }\n'),Hre.register("BxDF_frag",'\n  #include "Clearcoat_frag"\n  #include "BRDF_frag"\n  #include "MathShader"\n  #include "FastMathShader"\n  #include "Common_frag"\n  #include "GlobalUniform"\n\n  #include "PhysicMaterialUniform_frag"\n  #include "NormalMap_frag"\n  #include "LightingFunction_frag"\n  #include "Irradiance_frag"\n  #include "ColorUtil_frag"\n  #include "BxdfDebug_frag"\n\n\n \n  //ORI_ShadingInput\n  fn initFragData() {\n      fragData.Albedo = ORI_ShadingInput.BaseColor ;\n      fragData.Ao = ORI_ShadingInput.AmbientOcclusion ; \n      fragData.Roughness = max(ORI_ShadingInput.Roughness,0.003) ; \n      fragData.Metallic = ORI_ShadingInput.Metallic ; \n      fragData.Emissive = ORI_ShadingInput.EmissiveColor.rgb ; \n      fragData.N = ORI_ShadingInput.Normal;\n      fragData.V = normalize(globalUniform.cameraWorldMatrix[3].xyz - ORI_VertexVarying.vWorldPos.xyz) ;\n\n      let R = 2.0 * dot( fragData.V , fragData.N ) * fragData.N - fragData.V ;\n      fragData.R = R;//reflect( fragData.V , -fragData.N ) ;\n\n      fragData.NoV = saturate(dot(fragData.N, fragData.V)) ;\n\n      fragData.F0 = mix(vec3<f32>(0.04), fragData.Albedo.rgb, fragData.Metallic);\n      \n      fragData.F = computeFresnelSchlick(fragData.NoV, fragData.F0);\n      fragData.KD = vec3<f32>(fragData.F) ;\n      fragData.KS = vec3<f32>(0.0) ;\n\n      fragData.Indirect = 0.0 ;\n      fragData.Reflectance = 1.0 ;\n\n      fragData.DiffuseColor = fragData.Albedo.rgb * (1.0 - fragData.Metallic);\n      fragData.SpecularColor = mix(vec3<f32>(1.0), fragData.Albedo.rgb, fragData.Metallic);\n\n      fragData.ClearcoatRoughness = 0.0 ;\n      #if USE_CLEARCOAT_ROUGHNESS\n        fragData.ClearcoatRoughness = getClearcoatRoughnees() ;\n      #endif\n  }\n\n  fn BxDFShading(){\n      initFragData();\n\n      var color = vec3<f32>(0.0);\n\n      let lightIndex = getCluster(ORI_VertexVarying.fragCoord);\n      let start = max(lightIndex.start, 0.0);\n      let count = max(lightIndex.count, 0.0);\n      let end = max(start + count , 0.0);\n      for(var i:i32 = i32(start) ; i < i32(end); i += 1 )\n      {\n        let light = getLight(i32(i));\n\n        switch (light.lightType) {\n          case PointLightType: {\n              color += pointLighting( fragData.Albedo.rgb,ORI_VertexVarying.vWorldPos.xyz,fragData.N,fragData.V,fragData.Roughness , light ) ;\n          }\n          case DirectLightType: {\n            color += directLighting( fragData.Albedo.rgb ,fragData.N,fragData.V,fragData.Roughness , light , globalUniform.shadowBias) ;\n          }\n          case SpotLightType: {\n            color += spotLighting( fragData.Albedo.rgb,ORI_VertexVarying.vWorldPos.xyz,fragData.N,fragData.V,fragData.Roughness , light ) ;\n          }\n          default: {\n          }\n        }\n      }\n\n      var kS = FresnelSchlickRoughness(fragData.NoV, fragData.F0, fragData.Roughness );\n      var kD = vec3(1.0) - kS;\n      kD = kD * (1.0 - fragData.Metallic);\n      kD = max(vec3<f32>(0.04),kD) ;\n\n      let MAX_REFLECTION_LOD  = f32(textureNumLevels(prefilterMap)) ;\n      var diffuseIrradiance: vec3<f32> = vec3<f32>(0.0);//\n\n      #if USE_SKYLIGHT\n          var prefilterTex: vec3<f32> = globalUniform.skyExposure * (textureSampleLevel(prefilterMap, prefilterMapSampler, fragData.N.xyz, 8.0 ).rgb);\n          prefilterTex = LinearToGammaSpace(prefilterTex);\n          var skyLight = kD * fragData.Albedo.xyz * prefilterTex;\n          // color += skyLight ;\n      #endif\n\n      var envRef = kS * approximateSpecularIBL( fragData.SpecularColor , fragData.Roughness , fragData.R ) ;//* (materialUniform.ior - 1.0) ;\n      var irradiance = diffuseIrradiance ;\n      #if USEGI\n          irradiance += getIrradiance().rgb ;\n      #else\n          irradiance += LinearToGammaSpace(globalUniform.skyExposure * textureSampleLevel(prefilterMap, prefilterMapSampler, fragData.N.xyz, 0.8 * (MAX_REFLECTION_LOD) ).rgb);\n      #endif\n\n      fragData.Irradiance = irradiance;\n\n\n      var diffuseIBL = fragData.Albedo.rgb * irradiance.rgb ;\n      // var ambientIBL = kD * fragData.Albedo.rgb * fragData.Ao;\n      fragData.EnvColor = materialUniform.envIntensity * envRef  ;\n\n      ORI_FragmentOutput.color = vec4<f32>(0.0);\n\n      #if USE_CLEARCOAT\n          for(var i:i32 = i32(start) ; i < i32(end); i = i + 1 )\n          {\n              let light = getLight(i);\n              switch (light.lightType) {\n                  case PointLightType: {\n                      color += pointLighting(fragData.Albedo.rgb,ORI_VertexVarying.vWorldPos.xyz,fragData.N,fragData.V,fragData.Roughness , light ) ;\n                  }\n                  case DirectLightType: {\n                      color += directLighting( fragData.Albedo.rgb ,fragData.N,fragData.V,fragData.Roughness , light , globalUniform.shadowBias) ;\n                  }\n                  case SpotLightType: {\n                      color += spotLighting( fragData.Albedo.rgb,ORI_VertexVarying.vWorldPos.xyz,fragData.N,fragData.V,fragData.Roughness , light ) ;\n                  }\n                  default: {\n                  }\n              }\n          }\n      #endif\n    \n      // // Using stripped down, \'pure log\', formula. Parameterized by grey points and dynamic range covered.\n      #if USEGBUFFER\n          var normal_rgba8unorm = (ORI_VertexVarying.vWorldNormal + 1.0) * 0.5;\n          normal_rgba8unorm = clamp(normal_rgba8unorm, vec3<f32>(0.0), vec3<f32>(1.0));\n      #endif\n      \n      // ORI_FragmentOutput.color = vec4<f32>(ORI_FragmentOutput.color.xyz,fragData.Albedo.a) ;\n      #if USE_WORLDPOS\n          ORI_FragmentOutput.worldPos = vec4<f32>(ORI_VertexVarying.vWorldPos.xyzw);\n      #endif\n\n      #if USEGBUFFER\n          ORI_FragmentOutput.worldNormal = vec4<f32>(normal_rgba8unorm,1.0);\n          ORI_FragmentOutput.material = vec4<f32>(1.0,fragData.Roughness,fragData.Metallic,1.0);\n      #endif\n      \n      // color = pow(color.rgb,vec3<f32>(2.0));\n\n      color += diffuseIBL ;\n      // color += ambientIBL ;\n      color += fragData.EnvColor * fragData.Ao ;\n      color += fragData.Emissive.xyz ;\n\n      //-1 1\n      // color = diffuseIBL ;\n      ORI_FragmentOutput.color = vec4<f32>(color.rgb,fragData.Albedo.a) ;\n\n      // let gamma = 2.0 ;\n      // ORI_FragmentOutput.color = pow(ORI_FragmentOutput.color,vec4(gamma,gamma,gamma,1.0));\n  }\n  '),Hre.register("UnLit_frag",'\n    #include "Common_frag"\n    #include "GlobalUniform"\n\n    fn UnLit(){\n        \n        let alpha = ORI_ShadingInput.BaseColor.a ;\n        ORI_FragmentOutput.color = vec4<f32>(ORI_ShadingInput.BaseColor.rgb * alpha , alpha) ;\n\n        #if USE_WORLDPOS\n            ORI_FragmentOutput.worldPos = vec4<f32>(ORI_VertexVarying.vWorldPos.xyzw);\n        #endif\n\n        #if USEGBUFFER\n            var normal_rgba8unorm = (ORI_VertexVarying.vWorldNormal + 1.0) * 0.5;\n            normal_rgba8unorm = clamp(normal_rgba8unorm, vec3<f32>(0.0), vec3<f32>(1.0));\n            ORI_FragmentOutput.worldNormal = vec4<f32>(normal_rgba8unorm,1.0);\n            ORI_FragmentOutput.material = vec4<f32>(1.0,1.0,0.0,1.0);\n        #endif\n    }\n\n    fn debugFragmentOut(){\n\n    }\n'),Hre.register("Clearcoat_frag","\n    #if USE_CLEARCOAT_ROUGHNESS\n    @group(1) @binding(auto)\n    var clearCoatRoughnessMapSampler: sampler;\n    @group(1) @binding(auto)\n    var clearCoatRoughnessMap: texture_2d<f32>;\n\n                fn getClearcoatRoughnees() -> f32{\n        let clearcoatRoughness = textureSample(clearCoatRoughnessMap, clearCoatRoughnessMapSampler, ORI_VertexVarying.fragUV0.xy).r;\n        return clearcoatRoughness;\n    }\n    #else\n                fn getClearcoatRoughnees() -> f32{\n        return 0.0;\n    }\n    #endif\n"),Hre.register("LitShader",'\n    #include "Common_vert"\n    #include "Common_frag"\n    #include "BxDF_frag"\n\n    fn vert(inputData:VertexAttributes) -> VertexOutput {\n        ORI_Vert(inputData) ;\n        return ORI_VertexOut ;\n    }\n\n    fn frag(){\n        ORI_ShadingInput.BaseColor = materialUniform.baseColor ;\n        ORI_ShadingInput.Roughness = materialUniform.roughness  ;\n        ORI_ShadingInput.Metallic = materialUniform.metallic ;\n        ORI_ShadingInput.Specular = 0.5 ;\n        ORI_ShadingInput.AmbientOcclusion = materialUniform.ao ;\n        ORI_ShadingInput.EmissiveColor = vec4<f32>(0.0);\n\n        ORI_ShadingInput.Normal = ORI_VertexVarying.vWorldNormal.rgb ;\n\n        BxDFShading();\n    }\n'),Hre.register("PBRLItShader",'\n    #include "Common_vert"\n    #include "Common_frag"\n    #include "BxDF_frag"\n\n    @group(1) @binding(auto)\n    var baseMapSampler: sampler;\n    @group(1) @binding(auto)\n    var baseMap: texture_2d<f32>;\n\n    @group(1) @binding(auto)\n    var normalMapSampler: sampler;\n    @group(1) @binding(auto)\n    var normalMap: texture_2d<f32>;\n\n    #if USE_ARMC\n    @group(1) @binding(auto)\n    var maskMapSampler: sampler;\n    @group(1) @binding(auto)\n    var maskMap: texture_2d<f32>;\n    #endif\n\n    #if USE_AOTEX\n    @group(1) @binding(auto)\n    var aoMapSampler: sampler;\n    @group(1) @binding(auto)\n    var aomapMap: texture_2d<f32>;\n    #endif\n\n    @group(1) @binding(auto)\n    var emissiveMapSampler: sampler;\n    @group(1) @binding(auto)\n    var emissiveMap: texture_2d<f32>;\n\n    fn vert(inputData:VertexAttributes) -> VertexOutput {\n        ORI_Vert(inputData) ;\n        return ORI_VertexOut ;\n    }\n\n    fn frag(){\n        var transformUV1 = materialUniform.transformUV1;\n        var transformUV2 = materialUniform.transformUV2;\n\n        var uv = transformUV1.zw * ORI_VertexVarying.fragUV0 + transformUV1.xy; \n\n        ORI_ShadingInput.BaseColor = textureSample(baseMap, baseMapSampler, uv ) * materialUniform.baseColor ;\n    \n        // #if USE_ALPHACUT\n            // ORI_ShadingInput.BaseColor.a = clamp(ORI_ShadingInput.BaseColor.a, 0.001 , 1.0 );\n            if( (ORI_ShadingInput.BaseColor.a - materialUniform.alphaCutoff) <= 0.0 ){\n                ORI_FragmentOutput.color = vec4<f32>(0.0,0.0,0.0,1.0);\n                ORI_FragmentOutput.worldPos = vec4<f32>(0.0,0.0,0.0,1.0);\n                ORI_FragmentOutput.worldNormal = vec4<f32>(0.0,0.0,0.0,1.0);\n                ORI_FragmentOutput.material = vec4<f32>(0.0,0.0,0.0,1.0);\n                discard;\n            }\n        // #endif\n\n        #if USE_SHADOWMAPING\n            useShadow();\n        #endif\n\n        // ORI_ShadingInput.BaseColor = vec4<f32>(sRGBToLinear(ORI_ShadingInput.BaseColor.xyz),ORI_ShadingInput.BaseColor.w);\n    \n        #if USE_ARMC\n            var maskTex = textureSample(maskMap, maskMapSampler, uv ) ;\n\n            ORI_ShadingInput.AmbientOcclusion = maskTex.r * materialUniform.ao ; \n\n            #if USE_AOTEX\n                var aoMap = textureSample(aomapMap, aoMapSampler, uv );\n                ORI_ShadingInput.AmbientOcclusion = mix(0.0,aoMap.r,materialUniform.ao) ;\n            #endif\n\n            ORI_ShadingInput.Roughness = maskTex.g * materialUniform.roughness ;\n            ORI_ShadingInput.Metallic =  maskTex.b * materialUniform.metallic ;\n\n        #else\n            ORI_ShadingInput.Roughness = materialUniform.roughness ;\n            ORI_ShadingInput.Metallic = materialUniform.metallic ;\n            ORI_ShadingInput.AmbientOcclusion =  materialUniform.ao ;\n            #if USE_AOTEX\n                var aoMap = textureSample(aomapMap, aoMapSampler, ORI_VertexVarying.fragUV0.xy );\n                ORI_ShadingInput.AmbientOcclusion = mix(0.0,aoMap.r,materialUniform.ao) ;\n            #endif\n        #endif\n\n        ORI_ShadingInput.Roughness = clamp(ORI_ShadingInput.Roughness,0.084,1.0);\n        ORI_ShadingInput.Specular = 0.5 ;\n\n        var emissiveColor = textureSample(emissiveMap, emissiveMapSampler , ORI_VertexVarying.fragUV0.xy) ;\n        ORI_ShadingInput.EmissiveColor = vec4<f32>(materialUniform.emissiveColor.rgb * emissiveColor.rgb * materialUniform.emissiveIntensity,1.0);\n\n        var Normal = textureSample(normalMap,normalMapSampler,ORI_VertexVarying.fragUV0).rgb ;\n        // Normal.y = 1.0 - Normal.y ;\n        // let normal = unPackNormal(Normal,1.0,materialUniform.normalScale) ;\n        let normal = unPackNormal(Normal,materialUniform.normalScale) ;  \n        ORI_ShadingInput.Normal = normal ;\n\n        BxDFShading();\n    }\n'),Hre.register("ClusterDebug_frag","\n        var<private> colorSet : array<vec3<f32>, 9> = array<vec3<f32>, 9>(\n            vec3<f32>(1.0, 0.0, 0.0),\n            vec3<f32>(1.0, 0.5, 0.0),\n            vec3<f32>(0.5, 1.0, 0.0),\n            vec3<f32>(0.0, 1.0, 0.0),\n            vec3<f32>(0.0, 1.0, 0.5),\n            vec3<f32>(0.0, 0.5, 1.0),\n            vec3<f32>(0.0, 0.0, 1.0),\n            vec3<f32>(0.5, 0.0, 1.0),\n            vec3<f32>(1.0, 0.0, 0.5)\n        );\n\n        #if DEBUG_CLUSTER\n        fn debugCluster(fragCoord:vec4<f32>) {\n            #if USE_LIGHT\n              var tile : vec3<u32> = getTile(fragCoord);\n              let clusterDebug = vec4<f32>(colorSet[u32(tile.z) % 9u], 1.0);\n              ORI_FragmentOutput.color = clusterDebug ;\n              // ORI_FragmentOutput.color = vec4<f32>(0.5,0.5,0.0,1.0); \n            #endif\n          }\n      \n          fn debugClusterBox(fragCoord:vec4<f32>) {\n            #if USE_LIGHT\n              let clusterIndex : u32 = getClusterIndex(fragCoord);\n              let cluster = clusterBuffer[clusterIndex];\n        \n              let midPoint : vec3<f32> = (cluster.maxPoint.xyz - cluster.minPoint.xyz) / vec3<f32>(2.0, 2.0, 2.0);\n              let center : vec3<f32> = cluster.minPoint.xyz + midPoint;\n              let radius : f32 = length(midPoint) ;\n        \n              let fragToBoundsCenter : vec3<f32> = ORI_VertexVarying.viewPosition.xyz - center;\n              let distToBoundsCenter : f32 = length(fragToBoundsCenter);\n              let normDist : f32 = distToBoundsCenter / radius;\n              ORI_FragmentOutput.color = vec4<f32>(vec3<f32>(normDist,normDist,normDist)  , 1.0);\n            #endif\n          }\n      \n          fn debugClusterLightCount(fragCoord:vec4<f32>){\n            #if USE_LIGHT\n              let clusterIndex : u32 = getClusterIndex(fragCoord);\n              let lightCount : u32 = u32(assignTable[clusterIndex].count);\n              let lightFactor : f32 = f32(lightCount) / f32(32.0);\n              ORI_FragmentOutput.color =  mix(vec4<f32>(0.0, 0.0, 1.0, 1.0), vec4<f32>(1.0, 0.0, 0.0, 1.0), vec4<f32>(lightFactor, lightFactor, lightFactor, lightFactor));\n            #endif\n          }\n          #endif\n    "),Hre.register("BxdfDebug_frag",'\n#include "ClusterDebug_frag" \n\n        fn debugPosition(){\n            ORI_FragmentOutput.color = vec4<f32>(ORI_VertexVarying.vWorldPos.xyz,1.0);\n        }\n\n        fn debugNormal(){\n            ORI_FragmentOutput.color = vec4<f32>(ORI_ShadingInput.Normal.xyz,1.0);\n        }\n\n        fn debugUV(){\n            ORI_FragmentOutput.color = vec4<f32>(ORI_VertexVarying.fragUV0.xy,0.0,1.0);\n        }\n\n        fn debugColor(){\n            ORI_FragmentOutput.color = vec4<f32>(fragData.Albedo.rgb,1.0);\n        }\n\n        fn debugDiffuse(){\n            ORI_FragmentOutput.color = vec4<f32>(1.0/3.1415926 * fragData.Albedo.rgb,1.0);\n            // ORI_FragmentOutput.color = vec4<f32>(0.2,0.2,0.2,1.0);\n        }\n\n        fn debugAmbient(){\n            ORI_FragmentOutput.color = vec4<f32>(fragData.Irradiance * fragData.Albedo.rgb,1.0);\n        }\n        \n        fn debugEmissive(){\n            ORI_FragmentOutput.color = vec4<f32>(fragData.Emissive.rgb,1.0);\n        }\n\n        fn debugEnvment(){\n            ORI_FragmentOutput.color = vec4<f32>(fragData.EnvColor.rgb,1.0);\n        }\n\n        fn debugAo(){\n            ORI_FragmentOutput.color = vec4<f32>(vec3<f32>(fragData.Ao),1.0);\n        }\n\n        fn debugRoughness(){\n            ORI_FragmentOutput.color = vec4<f32>(vec3<f32>(fragData.Roughness),1.0);\n        }\n\n        fn debugMetallic(){\n            ORI_FragmentOutput.color = vec4<f32>(vec3<f32>(fragData.Metallic),1.0);\n        }\n\n        fn debugIrradiance(){\n            ORI_FragmentOutput.color = vec4<f32>(vec3<f32>(fragData.Irradiance),1.0);\n        }\n\n        fn debugFragmentOut(){\n            if(ORI_VertexVarying.fragCoord.x > globalUniform.renderState_split) {\n                switch (globalUniform.renderState_right)\n                {\n                  case 0: {\n                    debugPosition();\n                  }\n                  case 1: {\n                    debugColor();\n                  }\n                  case 2: {\n                    debugNormal();\n                  }\n                  case 3: {\n                    debugIrradiance();\n                  }\n                  case 4: {\n                    debugDiffuse();\n                  }\n                  case 5: {\n                    // debugAmbient();\n                  }\n                  case 6: {\n                    debugEmissive();\n                  }\n                  case 7: {\n                    debugEnvment();\n                  }\n                  case 8: {\n                    debugAo();\n                  }\n                  case 9: {\n                    debugRoughness();\n                  }\n                  case 10: {\n                    debugMetallic();\n                  }\n                  case 11: {\n                    debugDiffuse();\n                  }\n                  case 12: {\n                    debugAmbient();\n                  }\n                  case 13: {\n                    debugPosition();\n                  }\n                  case 14: {\n                    #if DEBUG_CLUSTER\n                      debugCluster( ORI_VertexVarying.fragCoord );\n                    #endif\n                  }\n                  case 15: {\n                    #if DEBUG_CLUSTER\n                      debugClusterBox( ORI_VertexVarying.fragCoord );\n                    #endif\n                  }\n                  case 16: {\n                    #if DEBUG_CLUSTER\n                      debugClusterLightCount( vec4<f32>(ORI_VertexVarying.fragCoord.xyz,0.0));\n                      #endif\n                  }\n                  default: {\n                  }\n                }\n              } else {\n                switch (globalUniform.renderState_left)\n                {\n                  case 0: {\n                    debugPosition();\n                  }\n                  case 1: {\n                    debugColor();\n                  }\n                  case 2: {\n                    debugNormal();\n                  }\n                  case 3: {\n                    debugIrradiance();\n                  }\n                  case 4: {\n                    debugDiffuse();\n                  }\n                  case 5: {\n                    // debugAmbient();\n                  }\n                  case 6: {\n                    debugEmissive();\n                  }\n                  case 7: {\n                    debugEnvment();\n                  }\n                  case 8: {\n                    debugAo();\n                  }\n                  case 9: {\n                    debugRoughness();\n                  }\n                  case 10: {\n                    debugMetallic();\n                  }\n                  case 11: {\n                    debugDiffuse();\n                  }\n                  case 12: {\n                    debugAmbient();\n                  }\n                  case 13: {\n                    debugPosition();\n                  }\n                  case 14: {\n                    // debugCluster( vec4<f32>(ORI_VertexVarying.fragCoord.xyz,0.0));\n                  }\n                  case 15: {\n                    // debugClusterBox( vec4<f32>(ORI_VertexVarying.fragCoord.xyz,0.0));\n                  }\n                  case 16: {\n                    // debugClusterLightCount( vec4<f32>(ORI_VertexVarying.fragCoord.xyz,0.0));\n                  }\n                  default: {\n                  }\n                }\n              }\n        }\n'),Hre.register("GenerayRandomDir","\n    fn madfrac(A:f32, B:f32)-> f32 {\n        return A*B-floor(A*B) ;\n    }\n\n    fn sampleRandomDir(count:u32,SAMPLE_COUNT:u32) -> vec3<f32>{\n    var ray_dir = sphericalFibonacci(f32((count)), f32(SAMPLE_COUNT) );\n    return normalize(ray_dir) ;\n    }\n\n    fn sphericalFibonacci( i : f32 ,  n : f32 ) -> vec3<f32>{\n        const PHI = sqrt(5.0) * 0.5 + 0.5;\n        let phi = 2.0 * PI * madfrac(i, PHI - 1);\n        let cosTheta = 1.0 - (2.0 * i + 1.0) * (1.0 / n);\n        let sinTheta = sqrt(saturate(1.0 - cosTheta*cosTheta));\n\n        return vec3<f32>(\n            cos(phi) * sinTheta,\n            sin(phi) * sinTheta,\n            cosTheta);\n\n    }\n"),Hre.register("Quad_vert_wgsl",'\n#include "WorldMatrixUniform"\n      #include "GlobalUniform"\n   \n      struct MaterialUniform {\n        x:f32,\n        y:f32,\n        width:f32,\n        height:f32,\n      };\n\n      struct VertexOutput {\n          @location(0) fragUV: vec2<f32>,\n          @builtin(position) member: vec4<f32>\n      };\n\n      @vertex\n      fn main(@builtin(instance_index) index : u32,@location(0) position: vec3<f32>, @location(1) TEXCOORD_1: vec2<f32>) -> VertexOutput {\n          let id = u32(index) ;\n          let worldMatrix = models.matrix[id];\n\n          let windowSize = vec2<f32>(globalUniform.windowWidth,globalUniform.windowHeight) ;\n\n        //   let pos = worldMatrix[3].xy ;\n\n          let size = vec2<f32>(worldMatrix[0].x,worldMatrix[1].y) / windowSize ;\n\n          let uv = vec2(((TEXCOORD_1.xy * 2.0) - vec2<f32>(1.0)))  ;// / windowSize * size - offset ;\n\n          return VertexOutput(TEXCOORD_1, vec4<f32>(uv, 0.0, 1.0));\n      }\n'),Hre.register("Quad_frag_wgsl","\n    struct FragmentOutput {\n        @location(0) o_Target: vec4<f32>\n    };\n\n    var<private> fragUV1: vec2<f32>;\n    var<private> o_Target: vec4<f32>;\n    @group(1) @binding(0)\n    var baseMapSampler: sampler;\n    @group(1) @binding(1)\n    var baseMap: texture_2d<f32>;\n\n    @fragment\n    fn main(@location(0) fragUV: vec2<f32>) -> FragmentOutput {\n        var uv = fragUV ;\n        uv.y = 1.0 - uv.y ;\n        var color: vec4<f32> = textureSample(baseMap, baseMapSampler, uv );\n\n        return FragmentOutput(color);\n    }\n"),Hre.register("Quad_depth2d_frag_wgsl","\n    struct FragmentOutput {\n        @location(0) o_Target: vec4<f32>\n    }; \n\n    var<private> fragUV1: vec2<f32>;\n    var<private> o_Target: vec4<f32>;\n\n    @group(1) @binding(0)\n    var baseMapSampler: sampler;\n    @group(1) @binding(1)\n    var baseMap: texture_depth_2d ;\n\n    fn Linear01Depth(  z : f32 ) -> f32\n    {\n        return 1.0 / (1.0 * z + 5000.0);\n    }\n\n    @fragment\n    fn main(@location(0) fragUV: vec2<f32>) -> FragmentOutput {\n        var uv = fragUV ;\n        uv.y = 1.0 - uv.y ;\n        var depth = textureSample(baseMap, baseMapSampler, uv , vec2<i32>(0) ) ;\n        return FragmentOutput(vec4<f32>(depth,0.0,0.0,1.0));\n    }\n"),Hre.register("Quad_depthCube_frag_wgsl","\n    struct FragmentOutput {\n        @location(0) o_Target: vec4<f32>\n    };\n\n    var<private> fragUV1: vec2<f32>;\n    var<private> o_Target: vec4<f32>;\n\n    @group(1) @binding(0)\n    var baseMapSampler: sampler;\n    @group(1) @binding(1)\n    var baseMap: texture_depth_cube ;\n\n    fn uvToXYZ( face : i32 ,  uv : vec2<f32> ) -> vec3<f32>\n    {\n        var out : vec3<f32> ;\n        if(face == 0){\n            out = vec3<f32>( 1.0, uv.y, -uv.x);\n        }else if(face == 1){\n            out = vec3<f32>( -1.0, uv.y, uv.x);\n        }else if(face == 2){\n            out = vec3<f32>( uv.x, -1.0, uv.y);\n        }else if(face == 3){\n            out = vec3<f32>( uv.x,  1.0, -uv.y);\n        }else if(face == 4){\n            out = vec3<f32>( uv.x, uv.y, 1.0);\n        }else{\t\n            out = vec3<f32>( -uv.x, uv.y, -1.0);\n        }\n        return out ;\n    }\n\n    @fragment\n    fn main(@location(0) fragUV: vec2<f32>) -> FragmentOutput {\n        var uv = fragUV ;\n        uv.y = 1.0 - uv.y ;\n        var ii = 0.16 ;\n        var ouv = vec3<f32>(0.0);\n        if(uv.x < ii * 6.0){\n            ouv = uvToXYZ(5,uv/ii);\n        }\n        if(uv.x < ii * 5.0){\n            ouv = uvToXYZ(4,uv/ii);\n        }\n        if(uv.x < ii * 4.0){\n            ouv = uvToXYZ(3,uv/ii);\n        } \n        if(uv.x < ii * 3.0){\n            ouv = uvToXYZ(2,uv/ii);\n        }\n        if(uv.x < ii * 2.0){\n            ouv = uvToXYZ(1,uv/ii);\n        }\n        if(uv.x < ii * 1.0){\n            ouv = uvToXYZ(0,uv/ii);\n        }\n        var depth = textureSample(baseMap, baseMapSampler, ouv ) ;\n        depth = 1.0 - depth; \n\n        return FragmentOutput(vec4<f32>(depth,0.0,0.0,1.0));\n    }\n"),Hre.register("sky_vs_frag_wgsl",Ore.sky_vs_frag_wgsl),Hre.register("sky_fs_frag_wgsl",Ore.sky_fs_frag_wgsl),Hre.register("Bloom_Brightness_frag_wgsl",Ire.Bloom_Brightness_frag_wgsl),Hre.register("Bloom_blur_frag_wgsl",Ire.Bloom_blur_frag_wgsl),Hre.register("Bloom_composite_frag_wgsl",Ire.Bloom_composite_frag_wgsl)}static register(e,t){Hre[e.toLowerCase()]||(Hre[e.toLowerCase()]=t)}static getShader(e){return Hre[e.toLowerCase()],Hre[e.toLowerCase()]}}const jre=class{constructor(e=0,t=0){bre(this,"x",0),bre(this,"y",0),this.x=e,this.y=t}static getAngle(e,t){return Math.atan2(t.y-e.y,t.x-e.x)}static slerp(e,t,n){let r=new jre,i=e.dot(t);var a,s,o;return i<0&&(t.x=-t.x,t.y=-t.y,i=-i),.9995<i?(r.x=e.x+n*(t.x-e.x),r.y=e.y+n*(t.y-e.y)):(a=Math.acos(i),s=Math.sin(a),o=Math.sin((1-n)*a)/s,n=Math.sin(n*a)/s,r.x=o*e.x+n*t.x,r.y=o*e.y+n*t.y),r}static lerp(e,t,n){return jre.HELP_0.copyFrom(e),jre.HELP_1.copyFrom(t),jre.HELP_0.scale(n),jre.HELP_1.scale(1-n),new jre(jre.HELP_0.x+jre.HELP_1.x,jre.HELP_0.y+jre.HELP_1.y)}set(e=0,t=0){return this.x=e,this.y=t,this}distance(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))}add(e,t){return(t=t||new jre).x=this.x+e.x,t.y=this.y+e.y,t}sub(e,t){return(t=t||new jre).x=this.x-e.x,t.y=this.y-e.y,t}scale(e){return this.x=this.x*e,this.y=this.y*e,this}multiply(e,t){return(t=t||new jre).x=this.x*e,t.y=this.y*e,t}multiplyScaler(e){return this.x*=e,this.y*=e,this}divide(e,t){return(t=t||new jre).x=this.x/e,t.y=this.y/e,t}neg(e){return(e=e||new jre).x=-e.x,e.y=-e.y,e}abs(){return Math.sqrt(this.x*this.x+this.y*this.y)}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}getAngle(e){return Math.atan2(e.y-this.y,e.x-this.x)}unt(e){e=e||new jre;var t=this.abs();return e.x=this.x/t,e.y=this.y/t,e}angleTo(e){var t=e.x-this.x;e=e.y-this.y;return Math.atan2(e,t)}equals(e){return Math.abs(this.x-e.x)<1e-6&&Math.abs(this.y-e.y)<1e-6}pal(e){var t=this.unt();e=e.unt();return t.equals(e)?1:t.equals(e.neg())?-1:0}clone(){return new jre(this.x,this.y)}copyFrom(e){return this.x=e.x,this.y=e.y,this}dot(e){return this.x*e.x+this.y*e.y}normalize(){var e=this.abs();return this.x=this.x/e,this.y=this.y/e,this}addInPlace(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}};let Wre=jre;bre(Wre,"HELP_0",new jre),bre(Wre,"HELP_1",new jre),bre(Wre,"ZERO",new jre(0,0)),bre(Wre,"SAFE_MAX",new jre(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER)),bre(Wre,"SAFE_MIN",new jre(Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER));const Yre=class{constructor(e=0,t=0,n=0,r=0){bre(this,"x",0),bre(this,"y",0),bre(this,"z",0),bre(this,"w",1),this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}get height(){return this.w}static crossVectors(e,t,n){n=n||new Yre;var r=e.x,i=e.y,a=(e=e.z,t.x),s=t.y;t=t.z;return n.x=i*t-e*s,n.y=e*a-r*t,n.z=r*s-i*a,n}static distance(e,t){var n=e.x-t.x,r=e.y-t.y,i=e.z-t.z;e=e.w-t.w;return Math.sqrt(n*n+r*r+i*i+e*e)}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}copyFrom(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}clone(){return new Yre(this.x,this.y,this.z,this.w)}};let $re=Yre;bre($re,"X_AXIS",new Yre(1,0,0)),bre($re,"Y_AXIS",new Yre(0,1,0)),bre($re,"Z_AXIS",new Yre(0,0,1)),bre($re,"HELP_0",new Yre),bre($re,"HELP_1",new Yre),bre($re,"HELP_2",new Yre),bre($re,"EPSILON",1e-5),bre($re,"HELP_3",new Yre),bre($re,"HELP_4",new Yre),bre($re,"HELP_5",new Yre),bre($re,"HELP_6",new Yre),bre($re,"ZERO",new Yre),bre($re,"ONE",new Yre(1,1,1,1)),bre($re,"LEFT",new Yre(-1,0,0)),bre($re,"RIGHT",new Yre(1,0,0)),bre($re,"UP",new Yre(0,-1,0)),bre($re,"DOWN",new Yre(0,1,0)),bre($re,"BACK",new Yre(0,0,-1)),bre($re,"FORWARD",new Yre(0,0,1));var Xre=(e=>(e[e.Number=0]="Number",e[e.Vector2=1]="Vector2",e[e.Vector3=2]="Vector3",e[e.Vector4=3]="Vector4",e[e.Color=4]="Color",e[e.Float32Array=5]="Float32Array",e))(Xre||{});class qre{constructor(e){bre(this,"size"),bre(this,"memoryInfo"),bre(this,"bindOnChange"),bre(this,"_data"),bre(this,"_type",Xre.Number),this.data=e}get data(){return this._data}set data(e){this._data=e,this._type=Xre.Number,e instanceof Wre?(this.size=2,this._type=Xre.Vector2):e instanceof Rre?(this.size=3,this._type=Xre.Vector3):e instanceof $re?(this.size=4,this._type=Xre.Vector4):e instanceof wre?(this.size=4,this._type=Xre.Color):e instanceof Float32Array?(this.size=e.length,this._type=Xre.Float32Array):(this.size=1,this._type=Xre.Number)}get color(){return new wre(this._data.r,this._data.g,this._data.b,this._data.a)}set color(e){this._data.r==e.r&&this._data.g==e.g&&this._data.b==e.b&&this._data.a==e.a||(this._data.r=e.r,this._data.g=e.g,this._data.b=e.b,this._data.a=e.a,this.onChange())}get value(){return this._data}set value(e){this._data!=e&&(this._data=e,this.onChange())}get vector2(){return new Wre(this._data.x,this._data.y)}set vector2(e){this._data.x==e.x&&this._data.y==e.y||(this._data.x=e.x,this._data.y=e.y,this.onChange())}get vector3(){return new Rre(this._data.x,this._data.y,this._data.z)}set vector3(e){this._data.x==e.x&&this._data.y==e.y&&this._data.z==e.z||(this._data.x=e.x,this._data.y=e.y,this._data.z=e.z,this.onChange())}get vector4(){return new $re(this._data.x,this._data.y,this._data.z,this._data.w)}set vector4(e){this._data.x==e.x&&this._data.y==e.y&&this._data.z==e.z&&this._data.w==e.w||(this._data.x=e.x,this._data.y=e.y,this._data.z=e.z,this._data.w=e.w,this.onChange())}onChange(){this.bindOnChange&&this.bindOnChange()}float32Array(e){this._data.set(e),this.onChange()}update(){switch(this._type){case Xre.Number:this.memoryInfo.dataBytes.setFloat32(0*Float32Array.BYTES_PER_ELEMENT,this._data,!0);break;case Xre.Vector2:this.memoryInfo.setVector2(0,this._data);break;case Xre.Vector3:this.memoryInfo.setVector3(0,this._data);break;case Xre.Vector4:this.memoryInfo.setVector4(0,this._data);break;case Xre.Color:this.memoryInfo.setColor(0,this._data);break;case Xre.Float32Array:this.memoryInfo.setFloat32Array(0,this._data)}}}let Kre="clamp-to-edge",Zre="repeat",Jre="less",Qre="less-equal",eie="always",tie="none",nie="front",rie="back",iie="linear",aie="line-list",sie="triangle-list",oie="rgba8unorm",lie="rgba8uint",uie="rgba8sint",cie="bgra8unorm",die="rgba16float",hie="rgba32float",pie="depth24plus",fie="depth32float",mie="float32",gie="float32x2",vie="float32x3",yie="float32x4";class _ie{}bre(_ie,"colorBufferTex_NAME","colorBufferTex"),bre(_ie,"positionBufferTex_NAME","positionBufferTex"),bre(_ie,"normalBufferTex_NAME","normalBufferTex"),bre(_ie,"materialBufferTex_NAME","materialBufferTex"),bre(_ie,"zBufferTexture_NAME","zBufferTexture"),bre(_ie,"zPreDepthTexture_NAME","zPreDepthTexture"),bre(_ie,"outTex_NAME","outTex");var bie=(e=>(e[e.Default=1]="Default",e[e.IgnoreDepthPass=2]="IgnoreDepthPass",e[e.Sky=6]="Sky",e[e.Particle=10]="Particle",e[e.SkinnedMesh=16]="SkinnedMesh",e[e.MorphTarget=32]="MorphTarget",e[e.Terrain=64]="Terrain",e[e.UI=128]="UI",e))(bie||{});class xie{static addMask(e,t){return e|t}static removeMask(e,t){return e&~t}static hasMask(e,t){return(e&t)==t}}const wie=class{constructor(){bre(this,"__refection"),bre(this,"__size",0)}getValueType(){if(!this.__refection){var e;this.__refection=[];for(const t in this)t.includes("__")||(e={name:t,type:(e=this[t]).constructor.name},this.__refection.push(e))}return this.__refection}static getValueSize(e){switch(e.constructor.name){case"Boolean":case"Number":case"f32":case"i32":case"u32":return 4;case"Float32Array":return 4*e.byteLength;case"Vector2":return 8;case"Vector3":case"Vector4":case"Color":return 16;case"Array":let t=0;for(let n=0,r=e.length;n<r;n++)t+=wie.getValueSize(e[n]);return t}return 0}static Ref(e){return this.Get(e).getValueType()}static Get(e){let t=wie.__cacheStruct.get(e.prototype);return t||(t=new e,wie.__cacheStruct.set(e.prototype,t)),t}static GetSize(e){var t,n=this.Get(e);if(0==n.__size){for(const e in n)-1==e.indexOf("__")&&(t=n[e],n.__size+=wie.getValueSize(t));4<n.__size&&(n.__size=4*Math.ceil(n.__size/4))}return n.__size}};let Sie=wie;bre(Sie,"__cacheStruct",new Map);class Cie{constructor(){bre(this,"byteOffset"),bre(this,"byteSize"),bre(this,"offset",0),bre(this,"dataBytes")}get x(){return this.dataBytes.getFloat32(0*Float32Array.BYTES_PER_ELEMENT,!0)}set x(e){this.dataBytes.setFloat32(0*Float32Array.BYTES_PER_ELEMENT,e,!0)}get y(){return this.dataBytes.getFloat32(+Float32Array.BYTES_PER_ELEMENT,!0)}set y(e){this.dataBytes.setFloat32(+Float32Array.BYTES_PER_ELEMENT,e,!0)}get z(){return this.dataBytes.getFloat32(2*Float32Array.BYTES_PER_ELEMENT,!0)}set z(e){this.dataBytes.setFloat32(2*Float32Array.BYTES_PER_ELEMENT,e,!0)}get w(){return this.dataBytes.getFloat32(3*Float32Array.BYTES_PER_ELEMENT,!0)}set w(e){this.dataBytes.setFloat32(3*Float32Array.BYTES_PER_ELEMENT,e,!0)}setX(e){this.x=e}setXY(e,t){this.x=e,this.y=t}setXYZ(e,t,n){this.x=e,this.y=t,this.z=n}setXYZW(e,t,n,r){this.x=e,this.y=t,this.z=n,this.w=r}setVector2Array(e){for(let n=0;n<e.length;n++){var t=e[n];this.dataBytes.setFloat32((2*n+0)*Float32Array.BYTES_PER_ELEMENT,t.x,!0),this.dataBytes.setFloat32((2*n+1)*Float32Array.BYTES_PER_ELEMENT,t.y,!0)}}setVector3Array(e){for(let n=0;n<e.length;n++){var t=e[n];this.dataBytes.setFloat32((3*n+0)*Float32Array.BYTES_PER_ELEMENT,t.x,!0),this.dataBytes.setFloat32((3*n+1)*Float32Array.BYTES_PER_ELEMENT,t.y,!0),this.dataBytes.setFloat32((3*n+2)*Float32Array.BYTES_PER_ELEMENT,t.z,!0)}}setVector4Array(e){for(let n=0;n<e.length;n++){var t=e[n];this.dataBytes.setFloat32((4*n+0)*Float32Array.BYTES_PER_ELEMENT,t.x,!0),this.dataBytes.setFloat32((4*n+1)*Float32Array.BYTES_PER_ELEMENT,t.y,!0),this.dataBytes.setFloat32((4*n+2)*Float32Array.BYTES_PER_ELEMENT,t.z,!0),this.dataBytes.setFloat32((4*n+3)*Float32Array.BYTES_PER_ELEMENT,t.w,!0)}}setColorArray(e){for(let n=0;n<e.length;n++){var t=e[n];this.dataBytes.setFloat32((4*n+0)*Float32Array.BYTES_PER_ELEMENT,t.r,!0),this.dataBytes.setFloat32((4*n+1)*Float32Array.BYTES_PER_ELEMENT,t.g,!0),this.dataBytes.setFloat32((4*n+2)*Float32Array.BYTES_PER_ELEMENT,t.b,!0),this.dataBytes.setFloat32((4*n+3)*Float32Array.BYTES_PER_ELEMENT,t.a,!0)}}setInt8(e,t=0){this.dataBytes.setInt8(t*Int8Array.BYTES_PER_ELEMENT,e)}getInt8(e=0){return this.dataBytes.getInt8(e*Int8Array.BYTES_PER_ELEMENT)}setInt16(e,t=0){this.dataBytes.setInt16(t*Int16Array.BYTES_PER_ELEMENT,e,!0)}getInt16(e=0){return this.dataBytes.getInt16(e*Int16Array.BYTES_PER_ELEMENT,!0)}setInt32(e,t=0){this.dataBytes.setInt32(t*Int32Array.BYTES_PER_ELEMENT,e,!0)}getInt32(e=0){return this.dataBytes.getInt32(e*Int32Array.BYTES_PER_ELEMENT,!0)}setFloat(e,t=0){this.dataBytes.setFloat32(t*Float32Array.BYTES_PER_ELEMENT,e,!0)}getFloat(e=0){return this.dataBytes.getFloat32(e*Float32Array.BYTES_PER_ELEMENT,!0)}setUint8(e,t=0){this.dataBytes.setUint8(t*Uint8Array.BYTES_PER_ELEMENT,e)}getUint8(e=0){return this.dataBytes.getUint8(e*Uint8Array.BYTES_PER_ELEMENT)}setUint16(e,t=0){this.dataBytes.setUint16(t*Uint16Array.BYTES_PER_ELEMENT,e,!0)}getUint16(e=0){return this.dataBytes.getUint16(e*Uint16Array.BYTES_PER_ELEMENT,!0)}setUint32(e,t=0){this.dataBytes.setUint32(t*Uint32Array.BYTES_PER_ELEMENT,e,!0)}getUint32(e=0){return this.dataBytes.getUint32(e*Uint32Array.BYTES_PER_ELEMENT,!0)}setArray(e,t){for(let r=0;r<t.length;r++){var n=t[r];this.dataBytes.setFloat32((e+r)*Float32Array.BYTES_PER_ELEMENT,n,!0)}}setFloat32Array(e,t){new Float32Array(this.dataBytes.buffer,this.dataBytes.byteOffset+e*Float32Array.BYTES_PER_ELEMENT).set(t)}setArrayBuffer(e,t){t instanceof Uint8Array?this.setUint8Array(e,t):t instanceof Uint16Array?this.setUint16Array(e,t):t instanceof Uint32Array?this.setUint32Array(e,t):t instanceof Int8Array?this.setInt8Array(e,t):t instanceof Int16Array?this.setInt16Array(e,t):t instanceof Int32Array?this.setInt32Array(e,t):t instanceof Float32Array&&this.setFloat32Array(e,t)}setInt8Array(e,t){new Int8Array(this.dataBytes.buffer,this.dataBytes.byteOffset+e*Int8Array.BYTES_PER_ELEMENT).set(t)}setInt16Array(e,t){new Int16Array(this.dataBytes.buffer,this.dataBytes.byteOffset+e*Int16Array.BYTES_PER_ELEMENT).set(t)}setInt32Array(e,t){new Int32Array(this.dataBytes.buffer,this.dataBytes.byteOffset+e*Int32Array.BYTES_PER_ELEMENT).set(t)}setUint8Array(e,t){new Uint8Array(this.dataBytes.buffer,this.dataBytes.byteOffset+e*Uint8Array.BYTES_PER_ELEMENT).set(t)}setUint16Array(e,t){new Uint16Array(this.dataBytes.buffer,this.dataBytes.byteOffset+e*Uint16Array.BYTES_PER_ELEMENT).set(t)}setUint32Array(e,t){new Uint32Array(this.dataBytes.buffer,this.dataBytes.byteOffset+e*Uint32Array.BYTES_PER_ELEMENT).set(t)}setData(e,t){this.dataBytes.setFloat32(e*Float32Array.BYTES_PER_ELEMENT,t,!0)}setVector2(e,t){this.dataBytes.setFloat32(e*Float32Array.BYTES_PER_ELEMENT,t.x,!0),this.dataBytes.setFloat32((e+1)*Float32Array.BYTES_PER_ELEMENT,t.y,!0)}setVector3(e,t){this.dataBytes.setFloat32(e*Float32Array.BYTES_PER_ELEMENT,t.x,!0),this.dataBytes.setFloat32((e+1)*Float32Array.BYTES_PER_ELEMENT,t.y,!0),this.dataBytes.setFloat32((e+2)*Float32Array.BYTES_PER_ELEMENT,t.z,!0)}setVector4(e,t){this.dataBytes.setFloat32(e*Float32Array.BYTES_PER_ELEMENT,t.x,!0),this.dataBytes.setFloat32((e+1)*Float32Array.BYTES_PER_ELEMENT,t.y,!0),this.dataBytes.setFloat32((e+2)*Float32Array.BYTES_PER_ELEMENT,t.z,!0),this.dataBytes.setFloat32((e+3)*Float32Array.BYTES_PER_ELEMENT,t.w,!0)}setColor(e,t){this.dataBytes.setFloat32(e*Float32Array.BYTES_PER_ELEMENT,t.r,!0),this.dataBytes.setFloat32((e+1)*Float32Array.BYTES_PER_ELEMENT,t.g,!0),this.dataBytes.setFloat32((e+2)*Float32Array.BYTES_PER_ELEMENT,t.b,!0),this.dataBytes.setFloat32((e+3)*Float32Array.BYTES_PER_ELEMENT,t.a,!0)}getData(e){return this.dataBytes.getFloat32(e*Float32Array.BYTES_PER_ELEMENT,!0)}writeFloat(e){this.dataBytes.setFloat32(this.offset,e,!0),this.offset+=Float32Array.BYTES_PER_ELEMENT}writeInt8(e){this.dataBytes.setInt8(this.offset,e),this.offset+=Int8Array.BYTES_PER_ELEMENT}writeInt16(e){this.dataBytes.setInt16(this.offset,e,!0),this.offset+=Int16Array.BYTES_PER_ELEMENT}writeInt32(e){this.dataBytes.setInt32(this.offset,e,!0),this.offset+=Int32Array.BYTES_PER_ELEMENT}writeUint8(e){this.dataBytes.setUint8(this.offset,e),this.offset+=Uint8Array.BYTES_PER_ELEMENT}writeUint16(e){this.dataBytes.setUint16(this.offset,e,!0),this.offset+=Uint16Array.BYTES_PER_ELEMENT}writeUint32(e){this.dataBytes.setUint32(this.offset,e,!0),this.offset+=Uint32Array.BYTES_PER_ELEMENT}writeVector2(e){this.writeFloat(e.x),this.writeFloat(e.y)}writeVector3(e){this.writeFloat(e.x),this.writeFloat(e.y),this.writeFloat(e.z)}writeVector4(e){this.writeFloat(e.x),this.writeFloat(e.y),this.writeFloat(e.z),this.writeFloat(e.w)}writeRGBColor(e){this.writeFloat(e.r),this.writeFloat(e.g),this.writeFloat(e.b)}writeArray(e){for(let n=0;n<e.length;n++){var t=e[n];this.writeFloat(t)}}writeFloat32Array(e){new Float32Array(this.dataBytes.buffer,this.dataBytes.byteOffset+this.offset).set(e),this.offset+=e.byteLength}writeInt8Array(e){new Int8Array(this.dataBytes.buffer,this.dataBytes.byteOffset+this.offset).set(e),this.offset+=e.byteLength}writeInt16Array(e){new Int16Array(this.dataBytes.buffer,this.dataBytes.byteOffset+this.offset).set(e),this.offset+=e.byteLength}writeInt32Array(e){new Int32Array(this.dataBytes.buffer,this.dataBytes.byteOffset+this.offset).set(e),this.offset+=e.byteLength}writeUint8Array(e){new Uint8Array(this.dataBytes.buffer,this.dataBytes.byteOffset+this.offset).set(e),this.offset+=e.byteLength}writeUint16Array(e){new Uint16Array(this.dataBytes.buffer,this.dataBytes.byteOffset+this.offset).set(e),this.offset+=e.byteLength}writeUint32Array(e){new Uint32Array(this.dataBytes.buffer,this.dataBytes.byteOffset+this.offset).set(e),this.offset+=e.byteLength}reset(){this.offset=0}destroy(){this.byteOffset=null,this.byteSize=null,this.offset=null,this.dataBytes=null}}class Tie{constructor(){bre(this,"shareDataBuffer"),bre(this,"_byteOffset",0)}allocation(e){this.shareDataBuffer&&this.shareDataBuffer.byteLength<e?this._byteOffset=0:this.shareDataBuffer=new ArrayBuffer(e)}allocation_node(e){var t;return this._byteOffset+e>this.shareDataBuffer.byteLength?(console.error("memory not enough!",this._byteOffset,e,this.shareDataBuffer.byteLength),null):((t=new Cie).byteOffset=this._byteOffset,t.byteSize=e,t.dataBytes=new DataView(this.shareDataBuffer,this._byteOffset,t.byteSize),this._byteOffset+=t.byteSize,t)}allocation_memory(e){return this._byteOffset+e.byteSize>this.shareDataBuffer.byteLength?(console.error("memory not enough!",this._byteOffset,e.byteSize,this.shareDataBuffer.byteLength),null):(e.byteOffset=this._byteOffset,e.dataBytes=new DataView(this.shareDataBuffer,this._byteOffset,e.byteSize),this._byteOffset+=e.byteSize,e)}reset(){this._byteOffset=0}destroy(e){this.shareDataBuffer=null,this._byteOffset=0}}class Mie{constructor(){bre(this,"bufferType"),bre(this,"buffer"),bre(this,"memory"),bre(this,"memoryNodes"),bre(this,"seek"),bre(this,"outFloat32Array"),bre(this,"byteSize"),bre(this,"usage"),bre(this,"visibility",GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT|GPUShaderStage.COMPUTE),bre(this,"_readBuffer"),bre(this,"_readFlag",!1),this.memory=new Tie,this.memoryNodes=new Map}debug(){}reset(e=!1,t=0,n){this.seek=0,this.memory.reset(),e&&this.createBuffer(this.usage,t,n)}setBoolean(e,t){let n=this.memoryNodes.get(e);n||(n=this.memory.allocation_node(4),this.memoryNodes.set(e,n)),n.setX(t?1:0)}setFloat(e,t){let n=this.memoryNodes.get(e);n||(n=this.memory.allocation_node(4),this.memoryNodes.set(e,n)),n.setX(t)}setInt8(e,t){let n=this.memoryNodes.get(e);n||(n=this.memory.allocation_node(1),this.memoryNodes.set(e,n)),n.setInt8(t)}setInt16(e,t){let n=this.memoryNodes.get(e);n||(n=this.memory.allocation_node(2),this.memoryNodes.set(e,n)),n.setInt16(t)}setInt32(e,t){let n=this.memoryNodes.get(e);n||(n=this.memory.allocation_node(4),this.memoryNodes.set(e,n)),n.setInt32(t)}setUint8(e,t){let n=this.memoryNodes.get(e);n||(n=this.memory.allocation_node(1),this.memoryNodes.set(e,n)),n.setUint8(t)}setUint16(e,t){let n=this.memoryNodes.get(e);n||(n=this.memory.allocation_node(2),this.memoryNodes.set(e,n)),n.setUint16(t)}setUint32(e,t){let n=this.memoryNodes.get(e);n||(n=this.memory.allocation_node(4),this.memoryNodes.set(e,n)),n.setUint32(t)}setVector2(e,t){let n=this.memoryNodes.get(e);n||(n=this.memory.allocation_node(8),this.memoryNodes.set(e,n)),n.setXY(t.x,t.y)}setVector3(e,t){let n=this.memoryNodes.get(e);n||(n=this.memory.allocation_node(12),this.memoryNodes.set(e,n)),n.setXYZ(t.x,t.y,t.z)}setVector4(e,t){let n=this.memoryNodes.get(e);n||(n=this.memory.allocation_node(16),this.memoryNodes.set(e,n)),n.setXYZW(t.x,t.y,t.z,t.w)}setVector4Array(e,t){let n=this.memoryNodes.get(e);n||(n=this.memory.allocation_node(16*t.length),this.memoryNodes.set(e,n)),n.setVector4Array(t)}setColor(e,t){let n=this.memoryNodes.get(e);n||(n=this.memory.allocation_node(16),this.memoryNodes.set(e,n)),n.setXYZW(t.r,t.g,t.b,t.a)}setColorArray(e,t){let n=this.memoryNodes.get(e);n||(n=this.memory.allocation_node(16*t.length),this.memoryNodes.set(e,n)),n.setColorArray(t)}setMatrix(e,t){let n=this.memoryNodes.get(e);n||(n=this.memory.allocation_node(64),this.memoryNodes.set(e,n)),n.setFloat32Array(0,t.rawData)}setMatrixArray(e,t){let n=this.memoryNodes.get(e);n||(n=this.memory.allocation_node(64*t.length),this.memoryNodes.set(e,n));for(let i=0;i<t.length;i++){var r=t[i];n.setFloat32Array(16*i,r.rawData)}}setArray(e,t){let n=this.memoryNodes.get(e);n||(n=this.memory.allocation_node(4*t.length),this.memoryNodes.set(e,n)),n.setArray(0,t)}setFloat32Array(e,t){let n=this.memoryNodes.get(e);n||(n=this.memory.allocation_node(4*t.length),this.memoryNodes.set(e,n)),n.setFloat32Array(0,t)}setInt32Array(e,t){let n=this.memoryNodes.get(e);n||(n=this.memory.allocation_node(4*t.length),this.memoryNodes.set(e,n)),n.setInt32Array(0,t)}setUint32Array(e,t){let n=this.memoryNodes.get(e);n||(n=this.memory.allocation_node(4*t.length),this.memoryNodes.set(e,n)),n.setUint32Array(0,t)}setStruct(e,t,n,r){var i=Sie.Ref(e),a=(e=(Sie.GetSize(e),t),this.memoryNodes.get(e));a.reset();let s=n;r&&(s=s[r]);for(let u=0;u<i.length;u++){var o=i[u],l=s[o.name];switch(o.type){case"Boolean":case"Number":a.writeFloat(l);break;case"Float32Array":a.writeFloat32Array(l);break;case"Vector2":a.writeVector2(l);break;case"Vector3":a.writeVector3(l);break;case"Vector4":a.writeVector4(l);break;case"Color":a.writeRGBColor(l);break;case"Array":a.writeArray(l)}}}setStructArray(e,t,n){var r=t.length;for(let a=0;a<r;a++){var i=t[a];this.setStruct(e,a,i,n)}}clean(){var e=new Float32Array(this.memory.shareDataBuffer);e.fill(0,0,e.length)}apply(){Dre.device.queue.writeBuffer(this.buffer,0,this.memory.shareDataBuffer)}destroy(e){this.memoryNodes&&this.memoryNodes.forEach((e=>{e.destroy()})),this.bufferType=null,this.seek=null,this.byteSize=null,this.usage=null,this.visibility=null,this.outFloat32Array=null,this.buffer&&this.buffer.destroy(),this.buffer=null,this.memory&&this.memory.destroy(),this.memory=null,this._readBuffer&&this._readBuffer.destroy()}createBuffer(e,t,n){var r=Dre.device;this.byteSize=4*t,this.usage=e,this.buffer&&this.destroy(),this.buffer=r.createBuffer({size:this.byteSize,usage:e,mappedAtCreation:!1}),this.memory.allocation(this.byteSize),n&&(this.memory.allocation_node(4*n.length).setArrayBuffer(0,n),this.apply())}createBufferByStruct(e,t,n){var r=Sie.GetSize(t),i=(t=r*n,Dre.device);this.buffer=i.createBuffer({size:t,usage:e,mappedAtCreation:!1}),this.memory.allocation(t);for(let o=0;o<n;o++){var a,s=o;this.memoryNodes.get(s)||(a=this.memory.allocation_node(r),this.memoryNodes.set(s,a))}}readBuffer(){return this.outFloat32Array||(this.outFloat32Array=new Float32Array(this.memory.shareDataBuffer.byteLength/4)),this._readBuffer||(this._readBuffer=Dre.device.createBuffer({size:this.memory.shareDataBuffer.byteLength,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ,mappedAtCreation:!1})),this._readFlag||this.read(),this.outFloat32Array}async read(){this._readFlag=!0;var e=((e=Dre.device.createCommandEncoder()).copyBufferToBuffer(this.buffer,0,this._readBuffer,0,this.memory.shareDataBuffer.byteLength),Dre.device.queue.submit([e.finish()]),await this._readBuffer.mapAsync(GPUMapMode.READ),this._readBuffer.getMappedRange());this.outFloat32Array.set(new Float32Array(e),0),this._readBuffer.unmap(),this._readFlag=!1}}var Eie=(e=>(e[e.IndicesGPUBuffer=0]="IndicesGPUBuffer",e[e.VertexGPUBuffer=1]="VertexGPUBuffer",e[e.UniformGPUBuffer=2]="UniformGPUBuffer",e[e.StorageGPUBuffer=3]="StorageGPUBuffer",e[e.ComputeGPUBuffer=4]="ComputeGPUBuffer",e[e.MaterialDataUniformGPUBuffer=5]="MaterialDataUniformGPUBuffer",e[e.StructStorageGPUBuffer=6]="StructStorageGPUBuffer",e))(Eie||{});class Aie extends Mie{constructor(e,t=0,n){super(),this.bufferType=Eie.StorageGPUBuffer,this.createBuffer(GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST|t,e,n)}}class Pie extends Mie{constructor(e,t){super(),this.bufferType=Eie.UniformGPUBuffer,this.createBuffer(GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST|GPUBufferUsage.COPY_SRC,e,t)}genUniformNodes(){}}let Rie=function(e=16,t=16){var n,r,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),a=[];if(t=t||i.length,e)for(n=0;n<e;n++)a[n]=i[0|Math.random()*t];else for(a[8]=a[13]=a[18]=a[23]="-",a[14]="4",n=0;n<36;n++)a[n]||(r=0|16*Math.random(),a[n]=i[19==n?3&r|8:r]);return a.join("")};class Lie{constructor(){bre(this,"instanceID"),bre(this,"shaderVariant"),bre(this,"vsEntryPoint","main"),bre(this,"fsEntryPoint","main"),bre(this,"bindGroups"),bre(this,"shaderReflection"),bre(this,"defineValue"),bre(this,"constValues"),bre(this,"uniforms"),bre(this,"_bufferDic"),bre(this,"_shaderChange",!1),bre(this,"_stateChange",!1),this.instanceID=Rie(),this.defineValue={},this.constValues={},this.uniforms={},this._bufferDic=new Map}noticeShaderChange(){this._shaderChange=!0}noticeStateChange(){this._stateChange=!0}setStorageBuffer(e,t){this._bufferDic.has(e)?(this._bufferDic.set(e,t),this.noticeBufferChange(e)):this._bufferDic.set(e,t)}setStructStorageBuffer(e,t){this._bufferDic.has(e)?(this._bufferDic.set(e,t),this.noticeBufferChange(e)):this._bufferDic.set(e,t)}setUniformBuffer(e,t){this._bufferDic.has(e)?(this._bufferDic.set(e,t),this.noticeBufferChange(e)):this._bufferDic.set(e,t)}setDefine(e,t){this.defineValue[e]=t,this.noticeShaderChange()}hasDefine(e){return null!=this.defineValue[e]}deleteDefine(e){delete this.defineValue[e],this.noticeShaderChange()}setUniformFloat(e,t){this.uniforms[e]?this.uniforms[e].value=t:(this.uniforms[e]=new qre(t),this.noticeStateChange())}setUniformVector2(e,t){this.uniforms[e]?this.uniforms[e].vector2=t:this.uniforms[e]=new qre(t)}setUniformVector3(e,t){this.uniforms[e]?this.uniforms[e].vector3=t:this.uniforms[e]=new qre(t)}setUniformVector4(e,t){this.uniforms[e]?this.uniforms[e].vector4=t:this.uniforms[e]=new qre(t)}setUniformColor(e,t){this.uniforms[e]?this.uniforms[e].color=t:this.uniforms[e]=new qre(t)}setUniformArray(e,t){this.uniforms[e]?this.uniforms[e].float32Array(t):this.uniforms[e]=new qre(t)}noticeBufferChange(e){}destroy(e){}}var kie=(e=>(e[e.u32=1]="u32",e[e.f32=1]="f32",e[e["vec2<f32>"]=2]="vec2<f32>",e[e["vec3<f32>"]=3]="vec3<f32>",e[e["vec4<f32>"]=4]="vec4<f32>",e[e.float32=1]="float32",e[e.float32x2=2]="float32x2",e[e.float32x3=3]="float32x3",e[e.float32x4=4]="float32x4",e))(kie||{});let Die=[null,mie,gie,vie,yie];class Iie{static parse(e,t){return e=this.filterComment(e),e=this.parsePreprocess(new Oie,e,t),this.parseAutoBindingForGroupX(e,1)}static parseComputeShader(e,t){return e=this.filterComment(e),this.parsePreprocess(new Oie,e,t)}static parsePreprocess(e,t,n){var r,i,a=t.indexOf("#");return-1==a?t:(r=t.substring(0,a),i=t.indexOf("\n",t.lastIndexOf("#")),a=t.substring(a,i),t=t.substring(i),r+this.parsePreprocessCommand(e,a,n)+t)}static parseAutoBindingForGroupX(e,t){let n=0,r="",i=new Map;for(;n<e.length;){if(-1==(l=e.indexOf("@group(",n))){r+=e.substring(n);break}var a,s=e.indexOf(")",l),o=Number.parseInt(e.substring(l+7,s)),l=e.indexOf("@binding(",s);s=e.indexOf(")",l);r+=e.substring(n,l),o==t?i.has(o)?(r+=`@binding(${a=i.get(o)+1})`,i.set(o,a)):(r+="@binding(0)",i.set(o,0)):r+=e.substring(l,s+1),n=s+1}return r}static parsePreprocessCommand(e,t,n){let r="",i=t.split("\n"),a=[!1],s=[!1];for(let c=0;c<i.length;c++){let t=i[c],d=a[a.length-1];if(0!=t.trim().indexOf("#"))d||(r+=t+"\n");else{var o,l=t.trim();if(-1!=l.indexOf("#if"))d&&1<a.length?a.push(d):(o=l.substring(3).trim(),d=!this.parseCondition(o,n),a.push(d),s.push(!d));else if(-1!=l.indexOf("#elseif")||-1!=l.indexOf("#else")&&-1!=l.indexOf(" if"))s[s.length-1]?(a.pop(),d=!0,a.push(d)):(a.pop(),(d=a[a.length-1])&&1<a.length?a.push(d):(""==(o=l.substring(l.indexOf("if")+2).trim())&&console.error("preprocess command error, conditions missing: "+l),d=!this.parseCondition(o,n),a.push(d),s.push(!d)));else if(-1!=l.indexOf("#else"))a.pop(),d&&1<a.length&&a[a.length-1]?a.push(d):a.push(!d);else if(-1!=l.indexOf("#endif"))a.pop(),s.pop();else if(-1!=l.indexOf("#include")){let t="",i=l.charAt(l.length-1);if(t=">"==i?this.extract(l,"<",">"):this.extract(l,i,i),!e.includeMap.has(t)){e.includeMap.set(t,!0);var u=Hre.getShader(t);if(!u)throw`${l} error: '${t}' not found`;u=this.filterComment(u),r+=(u=this.parsePreprocess(e,u,n))+"\r\n"}}else{if(-1==l.indexOf("#define "))throw"nonsupport: "+l;{let e=l.substring(l.indexOf("#define ")+8).trim(),t=e.indexOf(" "),r=e,i="";-1!=t&&(r=e.substring(0,t).trim(),i=e.substring(t+1).trim()),n[r]=i}}}}return r}static parseCondition(e,t){return null!=(t=t[e])&&(1==t||0!=t)}static filterComment(e){let t="",n=!0,r=!0;for(let i=0;i<e.length;){let a=n?e.indexOf("//",i):-1,s=r?e.indexOf("/*",i):-1;if(-1==a&&-1==s){t+=e.substring(i);break}n=-1!=a,r=-1!=s,-1!=a&&-1!=s&&(a<s?s=-1:a=-1),-1!=a?(s=e.indexOf("\n",a),t+=e.substring(i,a),i=-1!=s?s:e.length):-1!=s&&(a=e.indexOf("*/",s),t+=e.substring(i,s),i=a+2)}return t}static extract(e,t,n){return t=e.indexOf(t)+t.length,n=e.indexOf(n,t),e.substring(t,n).trim()}}class Oie{constructor(){bre(this,"includeMap",new Map)}}const Nie=class{constructor(){bre(this,"attributes",[]),bre(this,"vs_variables",[]),bre(this,"fs_variables",[]),bre(this,"cs_variables",[]),bre(this,"groups",[]),bre(this,"variables",{}),bre(this,"useSplit",!1)}static parser(e,t){t.shaderReflection||(t.shaderReflection=new Nie),-1!=e.indexOf("@vertex")?(t.shaderReflection.attributes=this.parserVertexOld(e),t.shaderReflection.vs_variables=this.parserVariables(e)):-1!=e.indexOf("@fragment")?t.shaderReflection.fs_variables=this.parserVariables(e):-1!=e.indexOf("@compute")&&(t.shaderReflection.cs_variables=this.parserVariables(e))}static parser2(e,t){t.shaderReflection||(t.shaderReflection=new Nie);var n=t.shaderReflection;-1!=e.indexOf("@vertex")?(n.attributes=this.parserVertex(t.vsEntryPoint,e),n.vs_variables=this.parserVariables(e)):-1!=e.indexOf("@fragment")?n.fs_variables=this.parserVariables(e):-1!=e.indexOf("@compute")&&(n.cs_variables=this.parserVariables(e)),-1!=e.indexOf("splitTexture")&&(n.useSplit=!0)}static combineShaderReflectionVarInfo(e,t){for(const a of t){e.groups[a.group]||(e.groups[a.group]=[]);var n=a;if(e.groups[a.group][a.binding]){var r=e.groups[a.group][a.binding],i=a;if(r.dataFields)for(let e=0;e<r.dataFields.length;e++)r.dataFields[e];if(i.dataFields)for(let e=0;e<i.dataFields.length;e++)i.dataFields[e]}e.groups[a.group][a.binding]=n,e.variables[a.varName]=n}}static final(e){var t=e.shaderReflection;this._shaderReflectionMap.set(e.shaderVariant,t),this.combineShaderReflectionVarInfo(t,t.vs_variables),this.combineShaderReflectionVarInfo(t,t.fs_variables)}static getShaderReflection2(e,t){null!=t.shaderVariant&&(e=Iie.parse(e,t.defineValue),Nie.parser2(e,t))}static poolGetReflection(e){return this._shaderReflectionMap.get(e)}static genShaderVar(e){let t=""+e.vs+e.fs+e.compute;t+="|";for(const n in e.uniforms)t+=n+":";t+="|";for(const n in e.constValues)t+=n+":",t+=e.constValues[n];t+="|";for(const n in e.defines)t+=n+":",t+=e.defines[n];t+="|";for(const n in e.shaderState)t+=n+":",t+=e.shaderState[n]+";";return t}static genShaderVariant(e){let t="";for(const n in e.uniforms)t+=n+":";t+="|";for(const n in e.constValues)t+=n+":",t+=e.constValues[n];t+="|";for(const n in e.defineValue)t+=n+":",t+=e.defineValue[n];return t}static genRenderShaderVariant(e){let t=`RenderShader(${e.vsName},${e.fsName})`;t=(t+="|")+this.genShaderVariant(e)+"|";for(const n in e.shaderState)t+=n+":",t+=e.shaderState[n]+";";return t}static genComputeShaderVariant(e){var t=`ComputeShader(${e.instanceID})`;return(t+="|")+this.genShaderVariant(e)}combine(e){var t=e.shaderReflection,n=e.defines,r={};for(let l=0;l<this.attributes.length;l++){var i=this.attributes[l];n[i.name]&&(r[i.name]=i)}var a=t.attributes.length;for(let l=0;l<a;l++){var s,o=t.attributes[l];r[o.name]?(s=r[o.name]).location==o.location&&s.name!=o.name&&console.log("location must same!"):this.attributes.push(o)}}static parserVariables(e){let t=0,n=[];for(;t<e.length;){var r=e.indexOf("@group(",t);if(r<0)break;var i=e.indexOf(";",r);t=i;let a=e.substring(r,i),s=this.extract(a,"@group(",")"),o=this.extract(a,"@binding(",")"),l="",u="var";-1!=a.indexOf("var<")?(l=this.extract(a,">",":"),u=this.extract(a,"var<",">").replace(",","-").replaceAll(" ","")):l=this.extract(a,"var",":"),r=a.substring(a.lastIndexOf(":")+1).trim(),(i={group:0,binding:0,varType:"",varName:"",dataType:"",dataIsBuiltinType:!0,dataFields:null}).group=Number.parseInt(s),i.binding=Number.parseInt(o),i.varType=u,i.varName=l,i.dataType=r,i.dataIsBuiltinType=this.isBuiltinTypes(i.dataType),i.dataIsBuiltinType||(i.dataFields=this.parserStructFields(e,i.dataType)),n.push(i)}return n}static extract(e,t,n){return t=e.indexOf(t)+t.length,n=e.indexOf(n,t),e.substring(t,n).trim()}static isBuiltinTypes(e){switch(e){case"i32":case"u32":case"f32":return!0;default:var t=e.indexOf("<");if(-1!=t)switch(e.substring(0,t)){case"vec2":case"vec3":case"vec4":case"mat3":case"mat4":return!0;case"array":return this.isBuiltinTypes(e.substring(t+1,e.lastIndexOf(">")))}}return!1}static parserStructFields(e,t){let n=[],r=0;for(;r<e.length&&!((a=e.indexOf("struct ",r))<0);){if(r=s=e.indexOf("{",a),e.substring(a+6,s).trim()===t){var i,a=e.indexOf("{",a),s=e.indexOf("}",a);for(i of e.substring(a+1,s).split(",")){var o=i.indexOf(":");-1!=o&&(o={name:i.substring(0,o).trim(),type:i.substring(o+1).trim()},n.push(o))}break}}return n}static parserVertexOld(e){let t=[],n=e.split("fn main(")[1].split("->")[0],r=n.split("@");if(r&&1<r.length)for(let s=1;s<r.length;s++){let e=r[s].replace(/\s*$/g,"");e=(e=(e=e.replaceAll(",","")).replaceAll("\n","")).replaceAll("  "," "),this.parserAttribute(e,t)}else{var i=n.split(":")[1],a=(e=(i=(i=(i=i.replaceAll("  ","")).replaceAll(" ","")).replaceAll(")",""),(i=e.split("struct "+i)[1]).indexOf("{")),i.indexOf("}"));r=(i=i.slice(e,a)).split("@");for(let e=1;e<r.length;e++){let n=r[e].replace(/\s*$/g,"");n=(n=(n=n.replaceAll("\n","")).split(",")[0]).replaceAll("  "," "),this.parserAttribute(n,t)}}return t}static parserVertex(e,t){let n=[],r=t.split(`fn ${e}(`)[1].split("->")[0],i=r.split("@");if(i&&1<i.length)for(let s=1;s<i.length;s++){let e=i[s].replace(/\s*$/g,"");e=(e=(e=e.replaceAll(",","")).replaceAll("\n","")).replaceAll("  "," "),this.parserAttribute(e,n)}else{t=(e=(e=(e=(e=r.split(":")[1]).replaceAll("  ","")).replaceAll(" ","")).replaceAll(")",""),(e=t.split("struct "+e)[1]).indexOf("{"));var a=e.indexOf("}");i=(e=e.slice(t,a)).split("@");for(let e=1;e<i.length;e++){let t=i[e].replace(/\s*$/g,"");t=(t=(t=t.replaceAll("\n","")).split(",")[0]).replaceAll("  "," "),this.parserAttribute(t,n)}}return n}static parserAttribute(e,t){var n,r,i={name:"",group:0,location:0,type:"",valueType:"",value:0,size:0,format:"float32"};-1!=e.indexOf("builtin")?(i.type="builtin",n=e.match(/\((.+?)\)/g)[0],n=(n=(n=e.match(/\((.+?)\)/g)[0]).replace("(","")).replaceAll(")",""),i.location=parseInt(n),r=e.split(":"),i.name=r[0].split(" ")[1],i.name=i.name.replaceAll("  "," "),i.name=i.name.replaceAll(" ",""),i.valueType=r[1],i.valueType=i.valueType.replaceAll("  "," "),i.valueType=i.valueType.replaceAll(" ",""),i.valueType=i.valueType.replaceAll("\r",""),i.valueType=i.valueType.replaceAll(")",""),i.valueType=i.valueType.replaceAll(")",""),i.size=kie[i.valueType],t.push(i)):-1!=e.indexOf("location")&&(i.type="location",n=e.match(/\((.+?)\)/g)[0],n=(n=(n=e.match(/\((.+?)\)/g)[0]).replace("(","")).replaceAll(")",""),i.location=parseInt(n),r=e.split(":"),i.name=r[0].split(" ")[1],i.name=i.name.replaceAll("  "," "),i.name=i.name.replaceAll(" ",""),i.valueType=r[1],i.valueType=i.valueType.replaceAll("  "," "),i.valueType=i.valueType.replaceAll(" ",""),i.valueType=i.valueType.replaceAll("\r",""),i.valueType=i.valueType.replaceAll(")",""),i.valueType=i.valueType.replaceAll(")",""),i.size=kie[i.valueType],t.push(i)),i.format=Die[kie[i.valueType]]}};let Bie=Nie;bre(Bie,"_shaderReflectionMap",new Map);class Uie extends Lie{constructor(e){super(),bre(this,"entryPoint","CsMain"),bre(this,"workerSizeX",1),bre(this,"workerSizeY",0),bre(this,"workerSizeZ",0),bre(this,"_computePipeline"),bre(this,"_csShaderModule"),bre(this,"_destCS"),bre(this,"_sourceCS"),bre(this,"_storageTextureDic"),bre(this,"_sampleTextureDic"),bre(this,"_groupsShaderReflectionVarInfos"),bre(this,"_groupCache",{}),this._sourceCS=e,Bie.getShaderReflection2(e,this),this._storageTextureDic=new Map,this._sampleTextureDic=new Map}setStorageTexture(e,t){this._storageTextureDic.has(e)||this._storageTextureDic.set(e,t)}setSamplerTexture(e,t){this._sampleTextureDic.set(e,t)}compute(e){this._computePipeline||this.genComputePipeline(),e.setPipeline(this._computePipeline);for(let t=0;t<this.bindGroups.length;++t)e.setBindGroup(t,this.bindGroups[t]);this.workerSizeX&&this.workerSizeY&&this.workerSizeZ?e.dispatchWorkgroups(this.workerSizeX,this.workerSizeY,this.workerSizeZ):this.workerSizeX&&this.workerSizeY?e.dispatchWorkgroups(this.workerSizeX,this.workerSizeY):e.dispatchWorkgroups(this.workerSizeX)}createBufferBindGroup(e,t,n,r){var i=this._bufferDic.get(t);i?(n={binding:n,resource:{buffer:i.buffer,offset:0,size:i.memory.shareDataBuffer.byteLength}},r.push(n)):console.error(`ComputeShader(${this.instanceID})`,`buffer ${t} is missing!`)}noticeBufferChange(e){(e=this._groupCache[e])&&this.genGroups(e.groupIndex,e.infos,!0)}genGroups(e,t,n=!1){if(!this.bindGroups[e]||n){var r=t[e],i=[];for(let n=0;n<r.length;++n){var a,s,o,l,u=r[n];if(u)switch(u.varType){case"uniform":case"storage-read":case"storage-read_write":this.createBufferBindGroup(e,u.varName,u.binding,i),this._groupCache[u.varName]={groupIndex:e,infos:t};break;case"var":"sampler"==u.dataType?(a=u.varName.replace("Sampler",""),(a=this._sampleTextureDic.get(a))?(a={binding:u.binding,resource:a.gpuSampler},i.push(a)):console.error(`ComputeShader(${this.instanceID})`,`texture ${u.varName} is missing! `)):"sampler_comparison"==u.dataType?(a=u.varName.replace("Sampler",""),(s=this._sampleTextureDic.get(a))?(s={binding:u.binding,resource:s.gpuSampler_comparison},i.push(s)):console.error(`ComputeShader(${this.instanceID})`,`texture ${u.varName} is missing! `)):-1!=u.dataType.indexOf("texture_storage")?(s=this._storageTextureDic.get(u.varName))?(o={binding:u.binding,resource:s.getGPUView()},i.push(o),Pse.getInstance().attached(s,this)):console.error(`ComputeShader(${this.instanceID})`,`texture ${u.varName} is missing! `):-1!=u.dataType.indexOf("texture")&&((o=this._sampleTextureDic.get(u.varName))?(l={binding:u.binding,resource:o.getGPUView()},i.push(l),Pse.getInstance().attached(o,this)):console.error(`ComputeShader(${this.instanceID})`,`texture ${u.varName} is missing! `));break;default:console.error("unprocessed type:",u.varType)}}n=Dre.device.createBindGroup({layout:this._computePipeline.getBindGroupLayout(e),entries:i}),this.bindGroups[e]=n}}genComputePipeline(){this.preCompileShader(this._sourceCS),this.genReflection(),this._computePipeline=Dre.device.createComputePipeline({layout:"auto",compute:{module:this.compileShader(),entryPoint:this.entryPoint}}),this._groupsShaderReflectionVarInfos=[];var e=this.shaderReflection;this.bindGroups=[];for(let n=0;n<e.groups.length;++n){var t=e.groups[n];this._groupsShaderReflectionVarInfos[n]=t,this.genGroups(n,this._groupsShaderReflectionVarInfos)}}preCompileShader(e){for(const n in this.constValues){var t;Object.prototype.hasOwnProperty.call(this.constValues,n)&&(t=this.constValues[n],e=e.replaceAll("&"+n,t.toString()))}this._destCS=Iie.parseComputeShader(e,this.defineValue)}compileShader(){var e=Dre.device.createShaderModule({label:`ComputeShader(${this.instanceID})`,code:this._destCS});return e.getCompilationInfo().then((e=>{0<e.messages.length&&console.log(this._destCS)})),this._csShaderModule=e}genReflection(){this.shaderVariant+=Bie.genComputeShaderVariant(this);var e=Bie.poolGetReflection(this.shaderVariant);e?this.shaderReflection=e:(Bie.getShaderReflection2(this._destCS,this),Bie.combineShaderReflectionVarInfo(this.shaderReflection,this.shaderReflection.cs_variables))}}class zie{static start(e){let t=this.profilerLabelMap.get(e);t||(t={lable:e,start:0,end:0,total:0,count:0,child:new Map},this.profilerLabelMap.set(e,t)),t.start=performance.now(),t.end=performance.now(),t.count=0,t.child.clear()}static end(e){(e=this.profilerLabelMap.get(e))&&(e.end=performance.now(),e.total=e.end-e.start)}static countStart(e,t=""){if((e=this.profilerLabelMap.get(e))&&(e.count++,""!=t)){let n=e.child.get(t);(n=n||{lable:t,start:0,end:0,total:0,count:0}).start=performance.now(),n.end=performance.now(),n.count=0,e.child.set(t,n)}}static countEnd(e,t){if((e=this.profilerLabelMap.get(e))&&""!=t){let n=e.child.get(t);(n=n||{lable:t,start:0,end:0,total:0,count:0}).end=performance.now(),n.total=n.end-n.start,n.count++}}static print(e){var t=this.profilerLabelMap.get(e);t&&console.log("performance",e,t.total+" ms")}}bre(zie,"profilerLabelMap",new Map);class Fie{}bre(Fie,"AXIS_ANGLE","axisAngle"),bre(Fie,"EULER_ANGLES","eulerAngles"),bre(Fie,"QUATERNION","quaternion");const Vie=class{constructor(e=0,t=0,n=0,r=1){bre(this,"x",0),bre(this,"y",0),bre(this,"z",0),bre(this,"w",1),this.x=e,this.y=t,this.z=n,this.w=r}static identity(){return Vie._zero}static quaternionToMatrix(e,t){var n=2*e.x,r=2*e.y,i=2*e.z,a=e.x*n,s=e.y*r,o=e.z*i,l=e.x*r,u=e.x*i,c=e.y*i;n=e.w*n,r=e.w*r,e=e.w*i;t.rawData[0]=1-(s+o),t.rawData[1]=l+e,t.rawData[2]=u-r,t.rawData[3]=0,t.rawData[4]=l-e,t.rawData[5]=1-(a+o),t.rawData[6]=c+n,t.rawData[7]=0,t.rawData[8]=u+r,t.rawData[9]=c-n,t.rawData[10]=1-(a+s),t.rawData[11]=0,t.rawData[12]=0,t.rawData[13]=0,t.rawData[14]=0,t.rawData[15]=1}get magnitude(){return Math.sqrt(this.w*this.w+this.x*this.x+this.y*this.y+this.z*this.z)}set(e=0,t=0,n=0,r=1){this.x=e,this.y=t,this.z=n,this.w=r}divide(e){return e instanceof Vie?new Vie(this.x/e.x,this.y/e.y,this.z/e.z):(this.x=this.x/e,this.y=this.y/e,this.z=this.z/e,this)}setFromArray(e){return this.x=e[0],this.y=e[1],this.z=e[2],this.w=e[3],this}multiply(e,t){var n=e.w,r=e.x,i=e.y,a=(e=e.z,t.w),s=t.x,o=t.y;t=t.z;this.w=n*a-r*s-i*o-e*t,this.x=n*s+r*a+i*t-e*o,this.y=n*o-r*t+i*a+e*s,this.z=n*t+r*o-i*s+e*a}multiplyVector(e,t=null){t=t||new Vie;var n=e.x,r=e.y;e=e.z;return t.w=-this.x*n-this.y*r-this.z*e,t.x=this.w*n+this.y*e-this.z*r,t.y=this.w*r-this.x*e+this.z*n,t.z=this.w*e+this.x*r-this.y*n,t}fromAxisAngle(e,t){t=.5*(t*=Math.PI/180);var n=Math.sin(t);this.w=Math.cos(t),this.x=e.x*n,this.y=e.y*n,this.z=e.z*n,this.normalize()}toAxisAngle(e){var t=this.x*this.x+this.y*this.y+this.z*this.z,n=0;return 0<t?(n=2*Math.acos(this.w),t=1/Math.sqrt(t),e.x=this.x*t,e.y=this.y*t,e.z=this.z*t):(n=0,e.x=1,e.y=0,e.z=0),n}slerp(e,t,n){var r,i,a=e.w,s=e.x,o=e.y,l=(e=e.z,t.w),u=t.x,c=t.y,d=a*l+s*u+o*c+e*(t=t.z);d<0&&(d=-d,l=-l,u=-u,c=-c,t=-t),d<.95?(d=Math.acos(d),i=1/Math.sin(d),r=Math.sin(d*(1-n))*i,d=Math.sin(d*n)*i,this.w=a*r+l*d,this.x=s*r+u*d,this.y=o*r+c*d,this.z=e*r+t*d):(this.w=a+n*(l-a),this.x=s+n*(u-s),this.y=o+n*(c-o),this.z=e+n*(t-e),i=1/Math.sqrt(this.w*this.w+this.x*this.x+this.y*this.y+this.z*this.z),this.w*=i,this.x*=i,this.y*=i,this.z*=i)}lerp(e,t,n){var r=e.w,i=e.x,a=e.y,s=(e=e.z,t.w),o=t.x,l=t.y;r*s+i*o+a*l+e*(t=t.z)<0&&(s=-s,o=-o,l=-l,t=-t),this.w=r+n*(s-r),this.x=i+n*(o-i),this.y=a+n*(l-a),this.z=e+n*(t-e),s=1/Math.sqrt(this.w*this.w+this.x*this.x+this.y*this.y+this.z*this.z),this.w*=s,this.x*=s,this.y*=s,this.z*=s}fromEulerAngles(e,t,n){e=.5*(e*=jie),t=.5*(t*=jie),n=.5*(n*=jie);var r=Math.cos(e),i=(e=Math.sin(e),Math.cos(t)),a=(t=Math.sin(t),Math.cos(n));n=Math.sin(n);return this.w=r*i*a+e*t*n,this.x=e*i*a-r*t*n,this.y=r*t*a+e*i*n,this.z=r*i*n-e*t*a,this}setFromRotationMatrix(e){var t=(e=e.rawData)[0],n=e[4],r=e[8],i=e[1],a=e[5],s=e[9],o=e[2],l=e[6],u=t+a+(e=e[10]);return 0<u?(u=.5/Math.sqrt(u+1),this.w=.25/u,this.x=(l-s)*u,this.y=(r-o)*u,this.z=(i-n)*u):a<t&&e<t?(u=2*Math.sqrt(1+t-a-e),this.w=(l-s)/u,this.x=.25*u,this.y=(n+i)/u,this.z=(r+o)/u):e<a?(u=2*Math.sqrt(1+a-t-e),this.w=(r-o)/u,this.x=(n+i)/u,this.y=.25*u,this.z=(s+l)/u):(u=2*Math.sqrt(1+e-t-a),this.w=(i-n)/u,this.x=(r+o)/u,this.y=(s+l)/u,this.z=.25*u),this}getEulerAngles(e){var t,n,r,i,a,s,o;return e=e||new Rre,r=this.x,i=this.y,a=this.z,o=(o=2*((s=this.w)*i-r*a))<=-.99999?(t=2*Math.atan2(r,s),n=-Math.PI/2,0):.99999<=o?(t=2*Math.atan2(r,s),n=Math.PI/2,0):(t=Math.atan2(2*(s*r+i*a),1-2*(r*r+i*i)),n=Math.asin(o),Math.atan2(2*(s*a+r*i),1-2*(i*i+a*a))),e.set(t,n,o).scaleBy(Hie)}normalize(e=1){e/=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w),this.x*=e,this.y*=e,this.z*=e,this.w*=e}toString(){return"{x:"+this.x+" y:"+this.y+" z:"+this.z+" w:"+this.w+"}"}fromMatrix(e){e=e.decompose(Fie.QUATERNION)[1],this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w}inverse(e=null){e=e||new Vie;var t=this.w*this.w+this.x*this.x+this.y*this.y+this.z*this.z;return 0<t&&(e.w=this.w*(t=1/t),e.x=-this.x*t,e.y=-this.y*t,e.z=-this.z*t),e}clone(){return new Vie(this.x,this.y,this.z,this.w)}transformVector(e,t=null){var n,r,i,a=e.x,s=e.y;e=e.z;return t=t||new Rre,i=-this.x*a-this.y*s-this.z*e,n=this.w*a+this.y*e-this.z*s,r=this.w*s-this.x*e+this.z*a,e=this.w*e+this.x*s-this.y*a,t.x=-i*this.x+n*this.w-r*this.z+e*this.y,t.y=-i*this.y+n*this.z+r*this.w-e*this.x,t.z=-i*this.z-n*this.y+r*this.x+e*this.w,t}copyFrom(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}mul(e,t,n){return(n=n||new Vie).x=e.w*t.x+e.x*t.w+e.y*t.z-e.z*t.y,n.y=e.w*t.y+e.y*t.w+e.z*t.x-e.x*t.z,n.z=e.w*t.z+e.z*t.w+e.x*t.y-e.y*t.x,n.w=e.w*t.w-e.x*t.x-e.y*t.y-e.z*t.z,n}clampf(e,t,n){var r;return n<t&&(r=t,t=n,n=r),e<t?t:e<n?e:n}};let Gie=Vie;bre(Gie,"HELP_0",new Vie),bre(Gie,"HELP_1",new Vie),bre(Gie,"HELP_2",new Vie),bre(Gie,"_zero",new Vie(0,0,0,1)),bre(Gie,"CALCULATION_QUATERNION",new Vie);let Hie=180/Math.PI,jie=Math.PI/180;function Wie(e,t,n){return Math.max(t,Math.min(n,e))}class Yie{static gaussFunction(e,t,n,r){return e=Math.pow(e-n,2),n=2*Math.pow(r,2),r=Math.pow(Math.E,e/n*-1),Math.round(r*t)}static computeGaussian(e,t){return 1/Math.sqrt(2*Math.PI*t)*Math.exp(-e*e/(2*t*t))}static gaussCoef(e){e<.5&&(e=.5);e=Math.exp(.527076)/e;var t=(1-(i=Math.exp(-e)))*(1-i)/(1+2*e*i-(a=Math.exp(-2*e))),n=t*(e-1)*i,r=(e=t*(1+e)*i,-t*a),i=2*i,a=-a;return new Float32Array([t,n,e,r,i,a,(t+n)/(1-i-a),(e+r)/(1-i-a)])}static clampf(e,t,n){var r;return n<t&&(r=t,t=n,n=r),e<t?t:e<n?e:n}static normalizeAngle(e){for(;180<e;)e-=360;for(;e<-180;)e+=360;return e}static fract(e){return e-Math.floor(e)}static getRandDirXZ(e){e*=Math.random();var t=360*Math.random()*jie;return{x:Math.cos(t)*e,z:Math.sin(t)*e}}static getRandDirXYZ(e){e*=Math.random();var t=360*Math.random()*jie,n=Math.cos(t)*e,r=Math.tan(t)*e;t=Math.sin(t)*e;return new Rre(n,r,t)}static getCycleXYZ(e){var t=e*Math.random(),n=360*Math.random()*jie,r=Math.cos(n)*t;e=e*Math.random()-.5*e,n=Math.sin(n)*t;return new Rre(r,e,n)}static angle(e,t){var n=Wre.HELP_0,r=Wre.HELP_1;return n.set(e.x,e.z),r.set(t.x,t.z),Math.acos((n.x*r.x+n.y*r.y)/(n.abs()*r.abs()))}static angle_360(e,t){var n=Rre.HELP_0;return e.cross(t,n),0<n.z?Yie.angle(e,t):360-Yie.angle(e,t)}getRotationY(e){return Yie.normalizeAngle(Math.atan2(e.z,e.x)*Hie)}static fromToRotation(e,t,n=null){n=n||new Gie;var r=new Kie;return Kie.fromToRotation(e,t,r),n.fromMatrix(r),n}static getEularDir_yUp(e){var t=Gie.HELP_0;return t.fromEulerAngles(0,e,0),t.transformVector(Rre.Z_AXIS,Rre.HELP_5),Rre.HELP_5}static transformVector(e,t,n=null){n=n||new Rre;var r=(e=e.rawData)[0],i=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=e[6],c=e[7],d=e[8],h=e[9],p=e[10],f=e[11],m=e[12],g=e[13],v=e[14],y=(e=e[15],t.x),_=t.y;t=t.z;return n.x=r*y+o*_+d*t+m,n.y=i*y+l*_+h*t+g,n.z=a*y+u*_+p*t+v,n.w=s*y+c*_+f*t+e,n}}function $ie(e,t){return e instanceof Rre&&t instanceof Rre||e instanceof Gie&&t instanceof Gie?e.x*t.x+e.y*t.y+e.z*t.z:e.x*t.x+e.y*t.y}function Xie(e,t){return e-Math.floor(e/t)*t}const qie=class{constructor(e=0){bre(this,"index",0),bre(this,"offset",0),bre(this,"rawData"),bre(this,"_position"),qie.useCount>=qie.allocCount&&qie.allocMatrix(qie.allocCount+1e3),this.index=qie.useCount,this.offset=qie.useCount*qie.blockBytes+qie.wasmMatrixPtr,qie.globalMatrixRef[this.index]=this,qie.useCount++,this.rawData=new Float32Array(qie.matrixBytes.buffer,this.offset,16),this._position=new Rre,this.identity()}static allocMatrix(e){this.allocCount=e,qie.matrixBytes=new Float32Array(16*e),qie.buffer=qie.matrixBytes.buffer,qie.wasmMatrixPtr=0,this.globalMatrixRef||(this.globalMatrixRef=[]),this.globalMatrixRef.forEach((e=>{var t=e.rawData;e.rawData=new Float32Array(qie.matrixBytes.buffer,e.offset,16);for(let n=0;n<t.length;n++)e.rawData[n]=t[n]})),qie.help_matrix_0||(qie.help_matrix_0=new qie),qie.help_matrix_1||(qie.help_matrix_1=new qie),qie.help_matrix_2||(qie.help_matrix_2=new qie),qie.helpMatrix||(qie.helpMatrix=new qie),qie.helpMatrix2||(qie.helpMatrix2=new qie),qie._getEulerMatrix||(qie._getEulerMatrix=new qie),qie._getEulerMatrix.identity()}static fromToRotation(e,t,n){return(n=n||new qie).transformDir(e,t),n}static getAxisRotation(e,t,n,r){var i,a=new qie,s=(r=r*(Math.PI/180),Math.cos(r)),o=(r=Math.sin(r),1-s);return a.rawData[0]=s+e*e*o,a.rawData[5]=s+t*t*o,a.rawData[10]=s+n*n*o,a.rawData[1]=(s=e*t*o)+(i=n*r),a.rawData[4]=s-i,a.rawData[8]=(s=e*n*o)+(i=t*r),a.rawData[2]=s-i,a.rawData[9]=(s=t*n*o)-(i=e*r),a.rawData[6]=s+i,a}static sanitizeEuler(e){qie.makePositive(e)}static makePositive(e){var t=2*Math.PI-1e-4;e.x<-1e-4?e.x+=2*Math.PI:e.x>t&&(e.x-=2*Math.PI),e.y<-1e-4?e.y+=2*Math.PI:e.y>t&&(e.y-=2*Math.PI),e.z<-1e-4?e.z+=2*Math.PI:e.z>t&&(e.z-=2*Math.PI)}static matrixToEuler(e,t){return e.get(1,2)<.999?-.999<e.get(1,2)?(t.x=Math.asin(-e.get(1,2)),t.y=Math.atan2(e.get(0,2),e.get(2,2)),t.z=Math.atan2(e.get(1,0),e.get(1,1)),qie.sanitizeEuler(t),!0):(t.x=.5*Math.PI,t.y=Math.atan2(e.get(0,1),e.get(0,0)),t.z=0,qie.sanitizeEuler(t),!1):(t.x=.5*-Math.PI,t.y=Math.atan2(-e.get(0,1),e.get(0,0)),t.z=0,qie.sanitizeEuler(t),!1)}static matrixMultiply(e,t,n){qie.wasm.Matrix_Multiply(e.index,t.index,n.index)}static matrixAppend(e,t,n){qie.wasm.Matrix_Append(e.index,t.index,n.index)}static matrixRotateY(e,t){qie.wasm.Matrix_Append(e,t.index)}static matrixRotate(e,t,n){qie.wasm.Matrix_Rotate(e,t,n.index)}lookAt(e,t,n=Rre.Y_AXIS){var r=this.rawData,i=((t=t.subtract(e,Rre.HELP_0)).length<1e-4&&(t.z=1),t.normalize(),n.crossProduct(t,Rre.HELP_1));i.length<1e-4&&(.9999<Math.abs(n.z)?t.x+=1e-4:t.z+=1e-4,t.normalize()),i=n.cross(t,i).normalize(),n=t.crossProduct(i,Rre.HELP_2).normalize();r[0]=i.x,r[1]=n.x,r[2]=t.x,r[3]=0,r[4]=i.y,r[5]=n.y,r[6]=t.y,r[7]=0,r[8]=i.z,r[9]=n.z,r[10]=t.z,r[11]=0,r[12]=-i.dotProduct(e),r[13]=-n.dotProduct(e),r[14]=-t.dotProduct(e),r[15]=1}multiply(e){var t=this.rawData,n=(e=e.rawData,qie.float32Array);n[0]=t[0]*e[0]+t[1]*e[4]+t[2]*e[8]+t[3]*e[12],n[1]=t[0]*e[1]+t[1]*e[5]+t[2]*e[9]+t[3]*e[13],n[2]=t[0]*e[2]+t[1]*e[6]+t[2]*e[10]+t[3]*e[14],n[3]=t[0]*e[3]+t[1]*e[7]+t[2]*e[11]+t[3]*e[15],n[4]=t[4]*e[0]+t[5]*e[4]+t[6]*e[8]+t[7]*e[12],n[5]=t[4]*e[1]+t[5]*e[5]+t[6]*e[9]+t[7]*e[13],n[6]=t[4]*e[2]+t[5]*e[6]+t[6]*e[10]+t[7]*e[14],n[7]=t[4]*e[3]+t[5]*e[7]+t[6]*e[11]+t[7]*e[15],n[8]=t[8]*e[0]+t[9]*e[4]+t[10]*e[8]+t[11]*e[12],n[9]=t[8]*e[1]+t[9]*e[5]+t[10]*e[9]+t[11]*e[13],n[10]=t[8]*e[2]+t[9]*e[6]+t[10]*e[10]+t[11]*e[14],n[11]=t[8]*e[3]+t[9]*e[7]+t[10]*e[11]+t[11]*e[15],n[12]=t[12]*e[0]+t[13]*e[4]+t[14]*e[8]+t[15]*e[12],n[13]=t[12]*e[1]+t[13]*e[5]+t[14]*e[9]+t[15]*e[13],n[14]=t[12]*e[2]+t[13]*e[6]+t[14]*e[10]+t[15]*e[14],n[15]=t[12]*e[3]+t[13]*e[7]+t[14]*e[11]+t[15]*e[15],t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]}multiplyMatrices(e,t){e=e.rawData,t=t.rawData;var n=this.rawData,r=e[0],i=e[4],a=e[8],s=e[12],o=e[1],l=e[5],u=e[9],c=e[13],d=e[2],h=e[6],p=e[10],f=e[14],m=e[3],g=e[7],v=e[11],y=(e=e[15],t[0]),_=t[4],b=t[8],x=t[12],w=t[1],S=t[5],C=t[9],T=t[13],M=t[2],E=t[6],A=t[10],P=t[14],R=t[3],L=t[7],k=t[11];t=t[15];return n[0]=r*y+i*w+a*M+s*R,n[4]=r*_+i*S+a*E+s*L,n[8]=r*b+i*C+a*A+s*k,n[12]=r*x+i*T+a*P+s*t,n[1]=o*y+l*w+u*M+c*R,n[5]=o*_+l*S+u*E+c*L,n[9]=o*b+l*C+u*A+c*k,n[13]=o*x+l*T+u*P+c*t,n[2]=d*y+h*w+p*M+f*R,n[6]=d*_+h*S+p*E+f*L,n[10]=d*b+h*C+p*A+f*k,n[14]=d*x+h*T+p*P+f*t,n[3]=m*y+g*w+v*M+e*R,n[7]=m*_+g*S+v*E+e*L,n[11]=m*b+g*C+v*A+e*k,n[15]=m*x+g*T+v*P+e*t,this}multiplyPoint3(e,t){t=t||new Rre;var n=this.rawData;return t.x=n[0]*e.x+n[4]*e.y+n[8]*e.z+n[12],t.y=n[1]*e.x+n[5]*e.y+n[9]*e.z+n[13],t.z=n[2]*e.x+n[6]*e.y+n[10]*e.z+n[14],t}multiplyVector4(e,t){t=t||new Rre;var n=this.rawData,r=e.x,i=e.y,a=(e=e.z,n[3]*r+n[7]*i+n[11]*e+n[15]);return t.x=(n[0]*r+n[4]*i+n[8]*e+n[12])/(a=a||1),t.y=(n[1]*r+n[5]*i+n[9]*e+n[13])/a,t.z=(n[2]*r+n[6]*i+n[10]*e+n[14])/a,t.w=1,t}perspectiveB(e,t,n,r){return t*=e=Math.tan(e*Math.PI/360)*n,this.frustum(-t,t,-e,e,n,r)}transformVector4(e,t){var n=this.rawData,r=(t=t||new Rre,e.x),i=e.y,a=e.z;e=e.w;return t.x=r*n[0]+i*n[4]+a*n[8]+e*n[12],t.y=r*n[1]+i*n[5]+a*n[9]+e*n[13],t.z=r*n[2]+i*n[6]+a*n[10]+e*n[14],t.w=r*n[3]+i*n[7]+a*n[11]+e*n[15],t}perspectiveMultiplyPoint3(e,t){var n=Rre.HELP_2,r=this.rawData;return n.x=r[0]*e.x+r[4]*e.y+r[8]*e.z+r[12],n.y=r[1]*e.x+r[5]*e.y+r[9]*e.z+r[13],n.z=r[2]*e.x+r[6]*e.y+r[10]*e.z+r[14],e=r[3]*e.x+r[7]*e.y+r[11]*e.z+r[15],1e-7<Math.abs(e)?(t.x=n.x*(r=1/e),t.y=n.y*r,t.z=n.z*r,!0):(t.x=0,t.y=0,t.z=0,!1)}perspective(e,t,n,r){var i=this.rawData;e=e*jie/2,e=Math.cos(e)/Math.sin(e);i[0]=-e/t,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=e,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=r/(r-n),i[11]=1,i[12]=0,i[13]=0,i[14]=-n*r/(r-n),i[15]=0}ortho(e,t,n,r){var i=this.rawData;return i[0]=2/e,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2/t,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1/(r-n),i[11]=0,i[12]=0,i[13]=0,i[14]=n/(n-r),i[15]=1,this}orthoZO(e,t,n,r,i,a){var s=this.rawData,o=1/(e-t),l=1/(n-r);a=1/(i-a);return s[0]=-2*o,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*l,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=a,s[11]=0,s[12]=(e+t)*o,s[13]=(r+n)*l,s[14]=i*a,s[15]=1,this}orthoOffCenter(e,t,n,r,i,a){var s=this.rawData;s[0]=2/(t-e),s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=2/(r-n),s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1/(a-i),s[11]=0,s[12]=(e+t)/(e-t),s[13]=(r+n)/(n-r),s[14]=i/(i-a),s[15]=1}transformDir(e,t){var n,r,i,a,s,o=this.rawData,l=Rre.HELP_0;.999999<(t=(t.crossProduct(e,l),t.dotProduct(e)))?this.identity():(n=(e=(1-t)/l.dotProduct(l))*l.x,r=e*l.z,i=n*l.y,a=n*l.z,s=r*l.y,o[0]=t+n*l.x,o[1]=i-l.z,o[2]=a+l.y,o[4]=i+l.z,o[5]=t+e*l.y*l.y,o[6]=s-l.x,o[8]=a-l.y,o[9]=s+l.x,o[10]=t+r*l.z,o[3]=0,o[7]=0,o[11]=0,o[15]=1)}append(e){var t=this.rawData,n=t[0],r=t[4],i=t[8],a=t[12],s=t[1],o=t[5],l=t[9],u=t[13],c=t[2],d=t[6],h=t[10],p=t[14],f=t[3],m=t[7],g=t[11],v=t[15];t[0]=n*e.rawData[0]+s*e.rawData[4]+c*e.rawData[8]+f*e.rawData[12],t[1]=n*e.rawData[1]+s*e.rawData[5]+c*e.rawData[9]+f*e.rawData[13],t[2]=n*e.rawData[2]+s*e.rawData[6]+c*e.rawData[10]+f*e.rawData[14],t[3]=n*e.rawData[3]+s*e.rawData[7]+c*e.rawData[11]+f*e.rawData[15],t[4]=r*e.rawData[0]+o*e.rawData[4]+d*e.rawData[8]+m*e.rawData[12],t[5]=r*e.rawData[1]+o*e.rawData[5]+d*e.rawData[9]+m*e.rawData[13],t[6]=r*e.rawData[2]+o*e.rawData[6]+d*e.rawData[10]+m*e.rawData[14],t[7]=r*e.rawData[3]+o*e.rawData[7]+d*e.rawData[11]+m*e.rawData[15],t[8]=i*e.rawData[0]+l*e.rawData[4]+h*e.rawData[8]+g*e.rawData[12],t[9]=i*e.rawData[1]+l*e.rawData[5]+h*e.rawData[9]+g*e.rawData[13],t[10]=i*e.rawData[2]+l*e.rawData[6]+h*e.rawData[10]+g*e.rawData[14],t[11]=i*e.rawData[3]+l*e.rawData[7]+h*e.rawData[11]+g*e.rawData[15],t[12]=a*e.rawData[0]+u*e.rawData[4]+p*e.rawData[8]+v*e.rawData[12],t[13]=a*e.rawData[1]+u*e.rawData[5]+p*e.rawData[9]+v*e.rawData[13],t[14]=a*e.rawData[2]+u*e.rawData[6]+p*e.rawData[10]+v*e.rawData[14],t[15]=a*e.rawData[3]+u*e.rawData[7]+p*e.rawData[11]+v*e.rawData[15]}add(e){var t=this.rawData,n=t[0],r=t[4],i=t[8],a=t[12],s=t[1],o=t[5],l=t[9],u=t[13],c=t[2],d=t[6],h=t[10],p=t[14],f=t[3],m=t[7],g=t[11],v=t[15],y=e.rawData[0],_=e.rawData[4],b=e.rawData[8],x=e.rawData[12],w=e.rawData[1],S=e.rawData[5],C=e.rawData[9],T=e.rawData[13],M=e.rawData[2],E=e.rawData[6],A=e.rawData[10],P=e.rawData[14],R=e.rawData[3],L=e.rawData[7],k=e.rawData[11];e=e.rawData[15];return t[0]=n+y,t[1]=s+w,t[2]=c+M,t[3]=f+R,t[4]=r+_,t[5]=o+S,t[6]=d+E,t[7]=m+L,t[8]=i+b,t[9]=l+C,t[10]=h+A,t[11]=g+k,t[12]=a+x,t[13]=u+T,t[14]=p+P,t[15]=v+e,this}sub(e){var t=this.rawData,n=t[0],r=t[4],i=t[8],a=t[12],s=t[1],o=t[5],l=t[9],u=t[13],c=t[2],d=t[6],h=t[10],p=t[14],f=t[3],m=t[7],g=t[11],v=t[15],y=e.rawData[0],_=e.rawData[4],b=e.rawData[8],x=e.rawData[12],w=e.rawData[1],S=e.rawData[5],C=e.rawData[9],T=e.rawData[13],M=e.rawData[2],E=e.rawData[6],A=e.rawData[10],P=e.rawData[14],R=e.rawData[3],L=e.rawData[7],k=e.rawData[11];e=e.rawData[15];return t[0]=n-y,t[1]=s-w,t[2]=c-M,t[3]=f-R,t[4]=r-_,t[5]=o-S,t[6]=d-E,t[7]=m-L,t[8]=i-b,t[9]=l-C,t[10]=h-A,t[11]=g-k,t[12]=a-x,t[13]=u-T,t[14]=p-P,t[15]=v-e,this}mult(e){var t=this.rawData;return t[0]*=e,t[1]*=e,t[2]*=e,t[3]*=e,t[4]*=e,t[5]*=e,t[6]*=e,t[7]*=e,t[8]*=e,t[9]*=e,t[10]*=e,t[11]*=e,t[12]*=e,t[13]*=e,t[14]*=e,t[15]*=e,this}appendRotation(e,t){t=qie.getAxisRotation(t.x,t.y,t.z,e),this.append(t)}createByRotation(e,t){var n=qie.helpMatrix,r=(e=e*jie,Math.sin(e));e=Math.cos(e);1==t.x&&(n.rawData[0]=1,n.rawData[1]=0,n.rawData[2]=0,n.rawData[3]=0,n.rawData[4]=0,n.rawData[5]=e,n.rawData[6]=r,n.rawData[7]=0,n.rawData[8]=0,n.rawData[9]=-r,n.rawData[10]=e,n.rawData[11]=0,n.rawData[12]=0,n.rawData[13]=0,n.rawData[14]=0,n.rawData[15]=1),1==t.y&&(n.rawData[0]=e,n.rawData[1]=0,n.rawData[2]=-r,n.rawData[3]=0,n.rawData[4]=0,n.rawData[5]=1,n.rawData[6]=0,n.rawData[7]=0,n.rawData[8]=r,n.rawData[9]=0,n.rawData[10]=e,n.rawData[11]=0,n.rawData[12]=0,n.rawData[13]=0,n.rawData[14]=0,n.rawData[15]=1),1==t.z&&(n.rawData[0]=e,n.rawData[1]=r,n.rawData[2]=0,n.rawData[3]=0,n.rawData[4]=-r,n.rawData[5]=e,n.rawData[6]=0,n.rawData[7]=0,n.rawData[8]=0,n.rawData[9]=0,n.rawData[10]=1,n.rawData[11]=0,n.rawData[12]=0,n.rawData[13]=0,n.rawData[14]=0,n.rawData[15]=1),this.append(n)}appendScale(e,t,n){qie.helpMatrix.createByScale(e,t,n),this.append(qie.helpMatrix)}createByScale(e,t,n){var r=this.rawData;r[0]=e,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=n,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1}appendTranslation(e,t,n){var r=this.rawData;r[12]+=e,r[13]+=t,r[14]+=n}clone(){var e=new qie;return e.copyFrom(this),e}copyRowFrom(e,t){var n=this.rawData;switch(e){case 0:n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w;break;case 1:n[4]=t.x,n[5]=t.y,n[6]=t.z,n[7]=t.w;break;case 2:n[8]=t.x,n[9]=t.y,n[10]=t.z,n[11]=t.w;break;case 3:n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=t.w}}copyRowTo(e,t){var n=this.rawData;switch(e){case 0:t.x=n[0],t.y=n[1],t.z=n[2],t.w=n[3];break;case 1:t.x=n[4],t.y=n[5],t.z=n[6],t.w=n[7];break;case 2:t.x=n[8],t.y=n[9],t.z=n[10],t.w=n[11];break;case 3:t.x=n[12],t.y=n[13],t.z=n[14],t.w=n[15]}}copyFrom(e){var t=this.rawData;return t[0]=e.rawData[0],t[1]=e.rawData[1],t[2]=e.rawData[2],t[3]=e.rawData[3],t[4]=e.rawData[4],t[5]=e.rawData[5],t[6]=e.rawData[6],t[7]=e.rawData[7],t[8]=e.rawData[8],t[9]=e.rawData[9],t[10]=e.rawData[10],t[11]=e.rawData[11],t[12]=e.rawData[12],t[13]=e.rawData[13],t[14]=e.rawData[14],t[15]=e.rawData[15],this}copyRawDataTo(e,t=0,n){var r=this.rawData;e[0+t]=r[0],e[1+t]=r[1],e[2+t]=r[2],e[3+t]=r[3],e[4+t]=r[4],e[5+t]=r[5],e[6+t]=r[6],e[7+t]=r[7],e[8+t]=r[8],e[9+t]=r[9],e[10+t]=r[10],e[11+t]=r[11],e[12+t]=r[12],e[13+t]=r[13],e[14+t]=r[14],e[15+t]=r[15]}copyColFrom(e,t){var n=this.rawData;switch(e){case 0:n[0]=t.x,n[4]=t.y,n[8]=t.z,n[12]=t.w;break;case 1:n[1]=t.x,n[5]=t.y,n[9]=t.z,n[13]=t.w;break;case 2:n[2]=t.x,n[6]=t.y,n[10]=t.z,n[14]=t.w;break;case 3:n[3]=t.x,n[7]=t.y,n[11]=t.z,n[15]=t.w}}copyColTo(e,t){var n=this.rawData;switch(e){case 0:t.x=n[0],t.y=n[4],t.z=n[8],t.w=n[12];break;case 1:t.x=n[1],t.y=n[5],t.z=n[9],t.w=n[13];break;case 2:t.x=n[2],t.y=n[6],t.z=n[10],t.w=n[14];break;case 3:t.x=n[3],t.y=n[7],t.z=n[11],t.w=n[15]}}copyToMatrix3D(e){e.rawData=this.rawData.slice(0)}makeRotationFromQuaternion(e){return this.compose(qie._zero,e,qie._one),this}decompose(e="eulerAngles",t){var n=Gie.CALCULATION_QUATERNION,r=(t=t||qie._prs,this.copyRawDataTo(qie.decomposeRawData),qie.decomposeRawData),i=t[0],a=(i.x=r[12],i.y=r[13],i.z=r[14],r[12]=0,r[13]=0,r[14]=0,t[2]);a.x=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]),a.y=Math.sqrt(r[4]*r[4]+r[5]*r[5]+r[6]*r[6]),a.z=Math.sqrt(r[8]*r[8]+r[9]*r[9]+r[10]*r[10]),r[0]*(r[5]*r[10]-r[6]*r[9])-r[1]*(r[4]*r[10]-r[6]*r[8])+r[2]*(r[4]*r[9]-r[5]*r[8])<0&&(a.z=-a.z),r[0]/=a.x,r[1]/=a.x,r[2]/=a.x,r[4]/=a.y,r[5]/=a.y,r[6]/=a.y,r[8]/=a.z,r[9]/=a.z,r[10]/=a.z;let s,o=t[1];switch(e){case Fie.AXIS_ANGLE:o.w=Math.acos((r[0]+r[5]+r[10]-1)/2);var l=Math.sqrt((r[6]-r[9])*(r[6]-r[9])+(r[8]-r[2])*(r[8]-r[2])+(r[1]-r[4])*(r[1]-r[4]));o.x=(r[6]-r[9])/l,o.y=(r[8]-r[2])/l,o.z=(r[1]-r[4])/l;break;case Fie.QUATERNION:0<(s=r[0]+r[5]+r[10])?(o.w=Math.sqrt(1+s)/2,o.x=(r[6]-r[9])/(4*o.w),o.y=(r[8]-r[2])/(4*o.w),o.z=(r[1]-r[4])/(4*o.w)):r[0]>r[5]&&r[0]>r[10]?(o.x=Math.sqrt(1+r[0]-r[5]-r[10])/2,o.w=(r[6]-r[9])/(4*o.x),o.y=(r[1]+r[4])/(4*o.x),o.z=(r[8]+r[2])/(4*o.x)):r[5]>r[10]?(o.y=Math.sqrt(1+r[5]-r[0]-r[10])/2,o.x=(r[1]+r[4])/(4*o.y),o.w=(r[8]-r[2])/(4*o.y),o.z=(r[6]+r[9])/(4*o.y)):(o.z=Math.sqrt(1+r[10]-r[0]-r[5])/2,o.x=(r[8]+r[2])/(4*o.z),o.y=(r[6]+r[9])/(4*o.z),o.w=(r[1]-r[4])/(4*o.z));break;case Fie.EULER_ANGLES:0<(s=r[0]+r[5]+r[10])?(n.w=Math.sqrt(1+s)/2,n.x=(r[6]-r[9])/(4*n.w),n.y=(r[8]-r[2])/(4*n.w),n.z=(r[1]-r[4])/(4*n.w)):r[0]>r[5]&&r[0]>r[10]?(n.x=Math.sqrt(1+r[0]-r[5]-r[10])/2,n.w=(r[6]-r[9])/(4*n.x),n.y=(r[1]+r[4])/(4*n.x),n.z=(r[8]+r[2])/(4*n.x)):r[5]>r[10]?(o.y=Math.sqrt(1+r[5]-r[0]-r[10])/2,n.x=(r[1]+r[4])/(4*n.y),n.w=(r[8]-r[2])/(4*n.y),n.z=(r[6]+r[9])/(4*n.y)):(n.z=Math.sqrt(1+r[10]-r[0]-r[5])/2,n.x=(r[8]+r[2])/(4*n.z),n.y=(r[6]+r[9])/(4*n.z),n.w=(r[1]-r[4])/(4*n.z)),n.getEulerAngles(o)}return t[0]=i,t[1]=o,t[2]=a,t}static getEuler(e,t,n=!0,r){return e=e||new Rre,qie._getEulerMatrix.makeRotationFromQuaternion(t).makeEuler(e,n,r),e}compose(e,t,n){var r=this.rawData,i=(s=t.x)*(c=s+s),a=s*(d=(l=t.y)+l),s=s*(h=(u=t.z)+u),o=l*d,l=l*h,u=u*h,c=(t=t.w)*c,d=t*d,h=(t=t*h,n.x),p=n.y;n=n.z;return r[0]=(1-(o+u))*h,r[1]=(a+t)*h,r[2]=(s-d)*h,r[3]=0,r[4]=(a-t)*p,r[5]=(1-(i+u))*p,r[6]=(l+c)*p,r[7]=0,r[8]=(s+d)*n,r[9]=(l-c)*n,r[10]=(1-(i+o))*n,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}deltaTransformVector(e,t){t=t||new Rre;var n=this.rawData,r=e.x,i=e.y;e=e.z;return t.x=r*n[0]+i*n[4]+e*n[8],t.y=r*n[1]+i*n[5]+e*n[9],t.z=r*n[2]+i*n[6]+e*n[10],t.w=r*n[3]+i*n[7]+e*n[11],t}identity(){var e=this.rawData;return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}fill(e){var t=this.rawData;t[1]=e,t[2]=e,t[3]=e,t[4]=e,t[6]=e,t[7]=e,t[8]=e,t[9]=e,t[11]=e,t[12]=e,t[13]=e,t[14]=e,t[0]=e,t[5]=e,t[10]=e,t[15]=e}invers33(){var e=this.rawData,t=e[5]*e[10]-e[9]*e[6],n=e[8]*e[6]-e[4]*e[10],r=e[4]*e[9]-e[8]*e[5],i=e[9]*e[2]-e[1]*e[10],a=e[0]*e[10]-e[8]*e[2],s=e[8]*e[1]-e[0]*e[9],o=e[1]*e[6]-e[5]*e[2],l=e[4]*e[2]-e[0]*e[6],u=e[0]*e[5]-e[4]*e[1],c=e[0]*t+e[4]*i+e[8]*o;1e-11<Math.abs(c)&&(e[0]=(c=1/c)*t,e[4]=c*n,e[8]=c*r,e[1]=c*i,e[5]=c*a,e[9]=c*s,e[2]=c*o,e[6]=c*l,e[10]=c*u)}invert(){var e,t,n,r,i,a,s,o,l,u,c,d,h,p,f,m,g=this.determinant,v=1e-11<Math.abs(g),y=this.rawData;return v&&(e=y[0],t=y[4],n=y[8],r=y[12],i=y[1],a=y[5],s=y[9],o=y[13],l=y[2],u=y[6],c=y[10],d=y[14],h=y[3],p=y[7],f=y[11],m=y[15],y[0]=(g=1/g)*(a*(c*m-d*f)-s*(u*m-d*p)+o*(u*f-c*p)),y[1]=-g*(i*(c*m-d*f)-s*(l*m-d*h)+o*(l*f-c*h)),y[2]=g*(i*(u*m-d*p)-a*(l*m-d*h)+o*(l*p-u*h)),y[3]=-g*(i*(u*f-c*p)-a*(l*f-c*h)+s*(l*p-u*h)),y[4]=-g*(t*(c*m-d*f)-n*(u*m-d*p)+r*(u*f-c*p)),y[5]=g*(e*(c*m-d*f)-n*(l*m-d*h)+r*(l*f-c*h)),y[6]=-g*(e*(u*m-d*p)-t*(l*m-d*h)+r*(l*p-u*h)),y[7]=g*(e*(u*f-c*p)-t*(l*f-c*h)+n*(l*p-u*h)),y[8]=g*(t*(s*m-o*f)-n*(a*m-o*p)+r*(a*f-s*p)),y[9]=-g*(e*(s*m-o*f)-n*(i*m-o*h)+r*(i*f-s*h)),y[10]=g*(e*(a*m-o*p)-t*(i*m-o*h)+r*(i*p-a*h)),y[11]=-g*(e*(a*f-s*p)-t*(i*f-s*h)+n*(i*p-a*h)),y[12]=-g*(t*(s*d-o*c)-n*(a*d-o*u)+r*(a*c-s*u)),y[13]=g*(e*(s*d-o*c)-n*(i*d-o*l)+r*(i*c-s*l)),y[14]=-g*(e*(a*d-o*u)-t*(i*d-o*l)+r*(i*u-a*l)),y[15]=g*(e*(a*c-s*u)-t*(i*c-s*l)+n*(i*u-a*l))),v}transformPoint(e,t){var n=this.rawData,r=(t=t||new Rre,e.x),i=e.y;e=e.z;return t.x=r*n[0]+i*n[4]+e*n[8]+n[12],t.y=r*n[1]+i*n[5]+e*n[9]+n[13],t.z=r*n[2]+i*n[6]+e*n[10]+n[14],t}transformVector(e,t){var n=this.rawData,r=(t=t||new Rre,e.x),i=e.y;e=e.z;return t.x=r*n[0]+i*n[4]+e*n[8],t.y=r*n[1]+i*n[5]+e*n[9],t.z=r*n[2]+i*n[6]+e*n[10],t}transpose(){var e=this.rawData;for(let t=0;t<qie.helpMatrix.rawData.length;t++)qie.helpMatrix.rawData[t]=e[t];e[1]=qie.helpMatrix.rawData[4],e[2]=qie.helpMatrix.rawData[8],e[3]=qie.helpMatrix.rawData[12],e[4]=qie.helpMatrix.rawData[1],e[6]=qie.helpMatrix.rawData[9],e[7]=qie.helpMatrix.rawData[13],e[8]=qie.helpMatrix.rawData[2],e[9]=qie.helpMatrix.rawData[6],e[11]=qie.helpMatrix.rawData[14],e[12]=qie.helpMatrix.rawData[3],e[13]=qie.helpMatrix.rawData[7],e[14]=qie.helpMatrix.rawData[11]}get determinant(){var e=this.rawData;return(e[0]*e[5]-e[4]*e[1])*(e[10]*e[15]-e[14]*e[11])-(e[0]*e[9]-e[8]*e[1])*(e[6]*e[15]-e[14]*e[7])+(e[0]*e[13]-e[12]*e[1])*(e[6]*e[11]-e[10]*e[7])+(e[4]*e[9]-e[8]*e[5])*(e[2]*e[15]-e[14]*e[3])-(e[4]*e[13]-e[12]*e[5])*(e[2]*e[11]-e[10]*e[3])+(e[8]*e[13]-e[12]*e[9])*(e[2]*e[7]-e[6]*e[3])}getPosition(e){e=e||new Rre;var t=this.rawData;return e.x=t[12],e.y=t[13],e.z=t[14],e}get position(){return this._position.set(this.rawData[12],this.rawData[13],this.rawData[14]),this._position}set position(e){var t=this.rawData;t[12]=e.x,t[13]=e.y,t[14]=e.z}get scale(){var e=this.rawData;return new Rre(e[0],e[5],e[10])}set scale(e){var t=this.rawData;t[0]=e.x,t[5]=e.y,t[10]=e.z}toString(){var e=this.rawData;return"matrix3d("+Math.round(1e3*e[0])/1e3+","+Math.round(1e3*e[1])/1e3+","+Math.round(1e3*e[2])/1e3+","+Math.round(1e3*e[3])/1e3+","+Math.round(1e3*e[4])/1e3+","+Math.round(1e3*e[5])/1e3+","+Math.round(1e3*e[6])/1e3+","+Math.round(1e3*e[7])/1e3+","+Math.round(1e3*e[8])/1e3+","+Math.round(1e3*e[9])/1e3+","+Math.round(1e3*e[10])/1e3+","+Math.round(1e3*e[11])/1e3+","+Math.round(1e3*e[12])/1e3+","+Math.round(1e3*e[13])/1e3+","+Math.round(1e3*e[14])/1e3+","+Math.round(1e3*e[15])/1e3+")"}lerp(e,t,n){this.copyFrom(t).sub(e).mult(n).add(e)}get(e,t){return this.rawData[e+4*t]}set(e,t,n){this.rawData[e+4*t]=n}getMaxScaleOnAxis(){var e=(n=this.rawData)[0]*n[0]+n[1]*n[1]+n[2]*n[2],t=n[4]*n[4]+n[5]*n[5]+n[6]*n[6],n=n[8]*n[8]+n[9]*n[9]+n[10]*n[10];return Math.sqrt(Math.max(e,t,n))}translate(e){var t=this.get(0,0)*e.x+this.get(0,1)*e.y+this.get(0,2)*e.z+this.get(0,3),n=this.get(1,0)*e.x+this.get(1,1)*e.y+this.get(1,2)*e.z+this.get(1,3),r=this.get(2,0)*e.x+this.get(2,1)*e.y+this.get(2,2)*e.z+this.get(2,3);e=this.get(3,0)*e.x+this.get(3,1)*e.y+this.get(3,2)*e.z+this.get(3,3);return this.set(0,3,t),this.set(1,3,n),this.set(2,3,r),this.set(3,3,e),this}setTRInverse(e,t){t=t.inverse(),Gie.quaternionToMatrix(t,this),this.translate(new Rre(-e.x,-e.y,-e.z))}setScale(e){return this.set(0,0,e.x),this.set(0,1,0),this.set(0,2,0),this.set(0,3,0),this.set(1,0,0),this.set(1,1,e.y),this.set(1,2,0),this.set(1,3,0),this.set(2,0,0),this.set(2,1,0),this.set(2,2,e.z),this.set(2,3,0),this.set(3,0,0),this.set(3,1,0),this.set(3,2,0),this.set(3,3,1),this}makeBasis(e,t,n){return this.setElements(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}makeRotationAxis(e,t){var n=Math.cos(t),r=(t=Math.sin(t),1-n),i=e.x,a=e.y,s=(e=e.z,r*i),o=r*a;return this.setElements(s*i+n,s*a-t*e,s*e+t*a,0,s*a+t*e,o*a+n,o*e-t*i,0,s*e-t*a,o*e+t*i,r*e*e+n,0,0,0,0,1),this}static transpose(e,t){t=t||new qie;e=e.rawData;var n=t.rawData;return n[0]=e[0],n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=e[1],n[5]=e[5],n[6]=e[9],n[7]=e[13],n[8]=e[2],n[9]=e[6],n[10]=e[10],n[11]=e[14],n[12]=e[3],n[13]=e[7],n[14]=e[11],n[15]=e[15],t}static inverse(e,t){t=t||new qie;e=e.rawData;var n=t.rawData,r=(n[0]=e[5]*e[10]*e[15]-e[5]*e[14]*e[11]-e[6]*e[9]*e[15]+e[6]*e[13]*e[11]+e[7]*e[9]*e[14]-e[7]*e[13]*e[10],n[1]=-e[1]*e[10]*e[15]+e[1]*e[14]*e[11]+e[2]*e[9]*e[15]-e[2]*e[13]*e[11]-e[3]*e[9]*e[14]+e[3]*e[13]*e[10],n[2]=e[1]*e[6]*e[15]-e[1]*e[14]*e[7]-e[2]*e[5]*e[15]+e[2]*e[13]*e[7]+e[3]*e[5]*e[14]-e[3]*e[13]*e[6],n[3]=-e[1]*e[6]*e[11]+e[1]*e[10]*e[7]+e[2]*e[5]*e[11]-e[2]*e[9]*e[7]-e[3]*e[5]*e[10]+e[3]*e[9]*e[6],n[4]=-e[4]*e[10]*e[15]+e[4]*e[14]*e[11]+e[6]*e[8]*e[15]-e[6]*e[12]*e[11]-e[7]*e[8]*e[14]+e[7]*e[12]*e[10],n[5]=e[0]*e[10]*e[15]-e[0]*e[14]*e[11]-e[2]*e[8]*e[15]+e[2]*e[12]*e[11]+e[3]*e[8]*e[14]-e[3]*e[12]*e[10],n[6]=-e[0]*e[6]*e[15]+e[0]*e[14]*e[7]+e[2]*e[4]*e[15]-e[2]*e[12]*e[7]-e[3]*e[4]*e[14]+e[3]*e[12]*e[6],n[7]=e[0]*e[6]*e[11]-e[0]*e[10]*e[7]-e[2]*e[4]*e[11]+e[2]*e[8]*e[7]+e[3]*e[4]*e[10]-e[3]*e[8]*e[6],n[8]=e[4]*e[9]*e[15]-e[4]*e[13]*e[11]-e[5]*e[8]*e[15]+e[5]*e[12]*e[11]+e[7]*e[8]*e[13]-e[7]*e[12]*e[9],n[9]=-e[0]*e[9]*e[15]+e[0]*e[13]*e[11]+e[1]*e[8]*e[15]-e[1]*e[12]*e[11]-e[3]*e[8]*e[13]+e[3]*e[12]*e[9],n[10]=e[0]*e[5]*e[15]-e[0]*e[13]*e[7]-e[1]*e[4]*e[15]+e[1]*e[12]*e[7]+e[3]*e[4]*e[13]-e[3]*e[12]*e[5],n[11]=-e[0]*e[5]*e[11]+e[0]*e[9]*e[7]+e[1]*e[4]*e[11]-e[1]*e[8]*e[7]-e[3]*e[4]*e[9]+e[3]*e[8]*e[5],n[12]=-e[4]*e[9]*e[14]+e[4]*e[13]*e[10]+e[5]*e[8]*e[14]-e[5]*e[12]*e[10]-e[6]*e[8]*e[13]+e[6]*e[12]*e[9],n[13]=e[0]*e[9]*e[14]-e[0]*e[13]*e[10]-e[1]*e[8]*e[14]+e[1]*e[12]*e[10]+e[2]*e[8]*e[13]-e[2]*e[12]*e[9],n[14]=-e[0]*e[5]*e[14]+e[0]*e[13]*e[6]+e[1]*e[4]*e[14]-e[1]*e[12]*e[6]-e[2]*e[4]*e[13]+e[2]*e[12]*e[5],n[15]=e[0]*e[5]*e[10]-e[0]*e[9]*e[6]-e[1]*e[4]*e[10]+e[1]*e[8]*e[6]+e[2]*e[4]*e[9]-e[2]*e[8]*e[5],e[0]*n[0]+e[1]*n[4]+e[2]*n[8]+e[3]*n[12]);for(let i=0;i<16;i++)n[i]/=r;return t}makeEuler(e,t,n="XYZ"){var r=this.rawData,i=r[0],a=r[4],s=r[8],o=r[1],l=r[5],u=r[9],c=r[2],d=r[6],h=r[10];switch(n){case"XYZ":e.y=Math.asin(Wie(s,-1,1)),Math.abs(s)<.9999999?(e.x=Math.atan2(-u,h),e.z=Math.atan2(-a,i)):(e.x=Math.atan2(d,l),e.z=0);break;case"YXZ":e.x=Math.asin(-Wie(u,-1,1)),Math.abs(u)<.9999999?(e.y=Math.atan2(s,h),e.z=Math.atan2(o,l)):(e.y=Math.atan2(-c,i),e.z=0);break;case"ZXY":e.x=Math.asin(Wie(d,-1,1)),Math.abs(d)<.9999999?(e.y=Math.atan2(-c,h),e.z=Math.atan2(-a,l)):(e.y=0,e.z=Math.atan2(o,i));break;case"ZYX":e.y=Math.asin(-Wie(c,-1,1)),Math.abs(c)<.9999999?(e.x=Math.atan2(d,h),e.z=Math.atan2(o,i)):(e.x=0,e.z=Math.atan2(-a,l));break;case"YZX":e.z=Math.asin(Wie(o,-1,1)),Math.abs(o)<.9999999?(e.x=Math.atan2(-u,l),e.y=Math.atan2(-c,i)):(e.x=0,e.y=Math.atan2(s,h));break;case"XZY":e.z=Math.asin(-Wie(a,-1,1)),Math.abs(a)<.9999999?(e.x=Math.atan2(d,l),e.y=Math.atan2(s,i)):(e.x=Math.atan2(-u,h),e.y=0)}return t&&e.multiplyScalar(Hie),e}frustum(e,t,n,r,i,a){var s=this.rawData;return s[0]=2*i/(t-e),s[1]=0,s[2]=(t+e)/(t-e),s[3]=0,s[4]=0,s[5]=2*i/(r-n),s[6]=(r+n)/(r-n),s[7]=0,s[8]=0,s[9]=0,s[10]=-(a+i)/(a-i),s[11]=-2*a*i/(a-i),s[12]=0,s[13]=0,s[14]=-1,s[15]=0,this}setElements(e,t,n,r,i,a,s,o,l,u,c,d,h,p,f,m){var g=this.rawData;return g[0]=e,g[4]=t,g[8]=n,g[12]=r,g[1]=i,g[5]=a,g[9]=s,g[13]=o,g[2]=l,g[6]=u,g[10]=c,g[14]=d,g[3]=h,g[7]=p,g[11]=f,g[15]=m,this}makeMatrix44ByQuaternion(e,t,n){this.identity(),Gie.quaternionToMatrix(n,this),this.appendTranslation(e.x,e.y,e.z),this.appendScale(t.x,t.y,t.z)}};let Kie=qie;function Zie(e,t,n){for(let r=0;r<4;r++)n.rawData[r]=e.rawData[r]*t.rawData[0]+e.rawData[r+4]*t.rawData[1]+e.rawData[r+8]*t.rawData[2]+e.rawData[r+12]*t.rawData[3],n.rawData[r+4]=e.rawData[r]*t.rawData[4]+e.rawData[r+4]*t.rawData[5]+e.rawData[r+8]*t.rawData[6]+e.rawData[r+12]*t.rawData[7],n.rawData[r+8]=e.rawData[r]*t.rawData[8]+e.rawData[r+4]*t.rawData[9]+e.rawData[r+8]*t.rawData[10]+e.rawData[r+12]*t.rawData[11],n.rawData[r+12]=e.rawData[r]*t.rawData[12]+e.rawData[r+4]*t.rawData[13]+e.rawData[r+8]*t.rawData[14]+e.rawData[r+12]*t.rawData[15]}function Jie(e,t,n,r){r=r.rawData;var i=e.x*jie*.5,a=e.y*jie*.5,s=(e=e.z*jie*.5,Math.cos(i)),o=(i=Math.sin(i),Math.cos(a)),l=(a=Math.sin(a),(p=i*o*(v=Math.cos(e))-s*a*(e=Math.sin(e)))+p),u=(m=s*a*v+i*o*e)+m,c=(g=s*o*e-i*a*v)+g,d=p*l,h=p*u,p=p*c,f=m*u,m=m*c,g=g*c,v=(o=(s=s*o*v+i*a*e)*l,s*u);i=s*c,a=n.x,e=n.y,l=n.z;r[0]=(1-(f+g))*a,r[1]=(h+i)*a,r[2]=(p-v)*a,r[3]=0,r[4]=(h-i)*e,r[5]=(1-(d+g))*e,r[6]=(m+o)*e,r[7]=0,r[8]=(p+v)*l,r[9]=(m-o)*l,r[10]=(1-(d+f))*l,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1}function Qie(e,t,n){var r=(e=e.rawData)[0],i=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=e[6],c=e[7],d=e[8],h=e[9],p=e[10],f=e[11],m=e[12],g=e[13],v=e[14],y=(e=e[15],t=t.rawData,n=n.rawData,t[0]),_=t[1],b=t[2],x=t[3];return n[0]=y*r+_*o+b*d+x*m,n[1]=y*i+_*l+b*h+x*g,n[2]=y*a+_*u+b*p+x*v,n[3]=y*s+_*c+b*f+x*e,y=t[4],_=t[5],b=t[6],x=t[7],n[4]=y*r+_*o+b*d+x*m,n[5]=y*i+_*l+b*h+x*g,n[6]=y*a+_*u+b*p+x*v,n[7]=y*s+_*c+b*f+x*e,y=t[8],_=t[9],b=t[10],x=t[11],n[8]=y*r+_*o+b*d+x*m,n[9]=y*i+_*l+b*h+x*g,n[10]=y*a+_*u+b*p+x*v,n[11]=y*s+_*c+b*f+x*e,y=t[12],_=t[13],b=t[14],x=t[15],n[12]=y*r+_*o+b*d+x*m,n[13]=y*i+_*l+b*h+x*g,n[14]=y*a+_*u+b*p+x*v,n[15]=y*s+_*c+b*f+x*e,n}bre(Kie,"blockBytes",64),bre(Kie,"block",16),bre(Kie,"allocCount",0),bre(Kie,"maxCount",2e5),bre(Kie,"useCount",0),bre(Kie,"buffer"),bre(Kie,"wasmMatrixPtr",0),bre(Kie,"matrixBytes"),bre(Kie,"globalMatrixRef"),bre(Kie,"wasm"),bre(Kie,"help_matrix_0"),bre(Kie,"help_matrix_1"),bre(Kie,"help_matrix_2"),bre(Kie,"helpMatrix"),bre(Kie,"helpMatrix2"),bre(Kie,"_getEulerMatrix"),bre(Kie,"_zero",new Rre(0,0,0)),bre(Kie,"_one",new Rre(1,1,1)),bre(Kie,"_prs",[new Rre,new Rre,new Rre]),bre(Kie,"float32Array",new Float32Array(16).fill(0)),bre(Kie,"decomposeRawData",new Float32Array(16).fill(0));var eae=(e=>(e[e.None=0]="None",e[e.PointLight=1]="PointLight",e[e.DirectionLight=2]="DirectionLight",e[e.SpotLight=3]="SpotLight",e[e.SkyLight=4]="SkyLight",e))(eae||{});class tae extends Sie{constructor(){super(...arguments),bre(this,"index",-1),bre(this,"lightType",-1),bre(this,"radius",.5),bre(this,"linear",1),bre(this,"lightPosition",new Rre),bre(this,"lightMatrixIndex",-1),bre(this,"direction",new Rre),bre(this,"quadratic",.032),bre(this,"lightColor",new wre(1,1,1,1)),bre(this,"intensity",1),bre(this,"innerAngle",0),bre(this,"outerAngle",1),bre(this,"range",100),bre(this,"castShadowIndex",-1),bre(this,"lightTangent",Rre.FORWARD),bre(this,"iesIndex",-1)}}bre(tae,"lightSize",24);const nae=class{static init(){this._init||(this._init=!0,nae.componentsUpdateList=new Map,nae.componentsLateUpdateList=new Map,nae.componentsBeforeUpdateList=new Map,nae.componentsComputeList=new Map,nae.graphicComponent=new Map,nae.waitStartComponent=new Map)}static bindUpdate(e,t,n){this.init();let r=nae.componentsUpdateList.get(e);r||(r=new Map,nae.componentsUpdateList.set(e,r)),r.set(t,n)}static unBindUpdate(e,t){this.init(),(e=nae.componentsUpdateList.get(e))&&e.delete(t)}static bindLateUpdate(e,t,n){this.init();let r=nae.componentsLateUpdateList.get(e);r||(r=new Map,nae.componentsLateUpdateList.set(e,r)),r.set(t,n)}static unBindLateUpdate(e,t){this.init(),(e=nae.componentsLateUpdateList.get(e))&&e.delete(t)}static bindBeforeUpdate(e,t,n){this.init();let r=nae.componentsBeforeUpdateList.get(e);r||(r=new Map,nae.componentsBeforeUpdateList.set(e,r)),r.set(t,n)}static unBindBeforeUpdate(e,t){this.init(),(e=nae.componentsBeforeUpdateList.get(e))&&e.delete(t)}static bindCompute(e,t,n){this.init();let r=nae.componentsComputeList.get(e);r||(r=new Map,nae.componentsComputeList.set(e,r)),r.set(t,n)}static unBindCompute(e,t){this.init(),(e=nae.componentsComputeList.get(e))&&e.delete(t)}static bindGraphic(e,t,n){this.init();let r=nae.graphicComponent.get(e);r||(r=new Map,nae.graphicComponent.set(e,r)),r.set(t,n)}static unBindGraphic(e,t){this.init(),(e=nae.graphicComponent.get(e))&&e.delete(t)}static appendWaitStart(e,t){this.init();var n=nae.waitStartComponent.get(e);n?-1==n.indexOf(t)&&n.push(t):nae.waitStartComponent.set(e,[t])}};let rae=nae;bre(rae,"componentsUpdateList"),bre(rae,"componentsLateUpdateList"),bre(rae,"componentsBeforeUpdateList"),bre(rae,"componentsComputeList"),bre(rae,"graphicComponent"),bre(rae,"waitStartComponent"),bre(rae,"_init",!1);class iae{constructor(){bre(this,"object3D",null),bre(this,"eventDispatcher"),bre(this,"_enable",!0),bre(this,"__isStart",!1),this.eventDispatcher=new Mre}get transform(){return this.object3D.transform}set enable(e){this._enable!=e&&(this._enable=e,this._enable?null!=(e=this.onEnable)&&e.call(this):null!=(e=this.onDisable)&&e.call(this))}get enable(){return this._enable}__init(e){this.init(e)}__start(){var e;this.transform&&this.transform.scene3D&&0==this.__isStart&&(null!=(e=this.start)&&e.call(this),this.__isStart=!0),this.transform&&this.transform.scene3D&&null!=(e=this.onEnable)&&e.call(this),this.onUpdate&&this._onUpdate(this.onUpdate.bind(this)),this.onLateUpdate&&this._onLateUpdate(this.onLateUpdate.bind(this)),this.onBeforeUpdate&&this._onBeforeUpdate(this.onBeforeUpdate.bind(this)),this.onCompute&&this._onCompute(this.onCompute.bind(this)),this.onGraphic&&this._onGraphic(this.onGraphic.bind(this))}__stop(){var e;this.transform&&this.transform.scene3D&&null!=(e=this.onDisable)&&e.call(this),this._onUpdate(null),this._onLateUpdate(null),this._onBeforeUpdate(null),this._onCompute(null),this._onGraphic(null)}init(e){}start(){}stop(){}cloneTo(e){}_onUpdate(e){null!=e?rae.bindUpdate(this.transform.view3D,this,e):rae.unBindUpdate(this.transform.view3D,this)}_onLateUpdate(e){null!=e?rae.bindLateUpdate(this.transform.view3D,this,e):rae.unBindLateUpdate(this.transform.view3D,this)}_onBeforeUpdate(e){null!=e?rae.bindBeforeUpdate(this.transform.view3D,this,e):rae.unBindBeforeUpdate(this.transform.view3D,this)}_onCompute(e){null!=e?rae.bindCompute(this.transform.view3D,this,e):rae.unBindCompute(this.transform.view3D,this)}_onGraphic(e){null!=e?rae.bindGraphic(this.transform.view3D,this,e):rae.unBindGraphic(this.transform.view3D,this)}destroy(e){this.enable=!1,this.stop(),this._onBeforeUpdate(null),this._onUpdate(null),this._onLateUpdate(null),this.onEnable=null,this.onDisable=null,this.onUpdate=null,this.onLateUpdate=null,this.onBeforeUpdate=null,this.onCompute=null,this.onGraphic=null}}class aae{constructor(){bre(this,"value",0),bre(this,"inv_base",0)}static get(e,t){let n=0,r=1/t;for(;0<e;)n+=e%t*r,e/=t,r/=t;return n}getBase(e,t){let n=this.inv_base=1/t;for(;0<e;)this.value+=n*(e%t),e/=t,n*=this.inv_base}next(){var e=1-this.value-1e-7;if(this.inv_base<e)this.value+=this.inv_base;else{let t,n=this.inv_base;for(;t=n,(n*=this.inv_base)>=e;);this.value+=t+n-1}}get(){return this.value}}const sae=class{constructor(e,t){bre(this,"origin",new Rre),bre(this,"length",Number.MAX_VALUE),bre(this,"_vector",new Rre),bre(this,"_dir",new Rre),bre(this,"_v0",new Rre),bre(this,"_v1",new Rre),bre(this,"_v2",new Rre),bre(this,"_E1",new Rre),bre(this,"_E2",new Rre),bre(this,"_P",new Rre),bre(this,"_T",new Rre),bre(this,"_Q",new Rre),this.origin.copyFrom(e||new Rre),this._dir.copyFrom(t||new Rre),this._dir.normalize()}get direction(){return this._dir}set direction(e){this._dir.copyFrom(e),this._dir.normalize()}clone(){return new sae(this.origin,this.direction)}intersectBox(e,t){t=t||new Rre;let n,r,i,a,s,o,l=this.direction,u=this.origin;var c=1/l.x,d=1/l.y,h=1/l.z,p=e.min;e=e.max;return n=((0<=c?p:e).x-u.x)*c,r=((0<=c?e:p).x-u.x)*c,i=((0<=d?p:e).y-u.y)*d,a=((0<=d?e:p).y-u.y)*d,n>a||i>r||(i>n&&(n=i),a<r&&(r=a),s=((0<=h?p:e).z-u.z)*h,o=((0<=h?e:p).z-u.z)*h,n>o)||s>r||(s>n&&(n=s),(r=o<r?o:r)<0)?null:this.pointAt(0<=n?n:r,t)}pointAt(e,t){return(t=t||new Rre).copy(this.direction),t.multiplyScalar(e),t.add(this.origin,t),t}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this._dir.copy(e._dir),this.length=e.length,this}setApproxDirection(e){this._dir=e.normalize()}setOrigin(e){this.origin.copyFrom(e)}getOrigin(){return this.origin}getPoint(e){return this._dir.scaleBy(e),this.origin.add(this._dir)}sqrDistToPoint(e){var t=this._dir,n=$ie(e.subtract(this.origin),t);t=$ie(t,t),n=this.getPoint(n/t);return function(e){return $ie(e,e)}(e.subtract(n))}applyMatrix(e){this.origin=e.transformPoint(this.origin),this._dir=e.transformVector(this._dir)}pointInTriangle(e,t,n,r){var i=this._v0,a=this._v1,s=this._v2;r.subtract(t,i),n.subtract(t,a),e.subtract(t,s),r=Rre.dot(i,i),n=Rre.dot(i,a),e=Rre.dot(i,s),s=((t=Rre.dot(a,a))*e-n*(i=Rre.dot(a,s)))*(a=1/(r*t-n*n)),t=(r*i-n*e)*a;return 0<=s&&0<=t&&s+t<1}intersectTriangle(e,t,n){var r=n.v1,i=n.v2,a=n.v3;i.subtract(r,this._E1),a.subtract(r,this._E2),t.cross(this._E2,this._P);let s=this._E1.dotProduct(this._P);return 0<s?e.subtract(r,this._T):(r.subtract(e,this._T),s=-s),s<1e-4||(n.u=this._T.dotProduct(this._P),n.u<0)||n.u>s||(this._T.cross(this._E1,this._Q),n.v=t.dotProduct(this._Q),n.v<0)||n.u+n.v>s?null:(i=new Rre,n.t0=n.t=this._E2.dotProduct(this._Q),a=1/s,n.t*=a,n.u*=a,n.v*=a,i.x=e.x+n.t*t.x,i.y=e.y+n.t*t.y,i.z=e.z+n.t*t.z,i)}intersectSphere(e,t,n,r){n=e.subtract(n);var i=Rre.dot(t,t),a=2*Rre.dot(n,t);n=a*a-4*i*(Rre.dot(n,n)-r*r),r=Rre.HELP_3;return n<0||(a=(-a-Math.sqrt(n))/(2*i))<0?null:(r.x=e.x+a*t.x,r.y=e.y+a*t.y,r.z=e.z+a*t.z,r)}intersectionSegment(e,t,n){var r,i,a=this.origin,s=Rre.HELP_0,o=Rre.HELP_1,l=Rre.HELP_2,u=Rre.HELP_3,c=(o=(t.subtract(e,s),this._dir.scaleToRef(sae._rayl,l),a.add(l,o),e.subtract(a,u),Rre.dot(s,s)),a=Rre.dot(s,l),Rre.dot(l,l)),d=Rre.dot(s,u),h=Rre.dot(l,u),p=o*c-a*a,f=p,m=p;p<sae._smallnum?(r=0,f=1,i=h,m=c):(i=o*h-a*d,(r=a*h-c*d)<0?(r=0,i=h,m=c):f<r&&(r=f,i=h+a,m=c)),i<0?-d<(i=0)?r=0:o<-d?r=f:(r=-d,f=o):m<i&&(i=m,-d+a<0?r=0:o<-d+a?r=f:(r=-d+a,f=o)),p=Math.abs(r)<sae._smallnum?0:r/f,h=Math.abs(i)<sae._smallnum?0:i/m,c=Rre.HELP_4,l.scaleToRef(h,c),d=Rre.HELP_5,s.scaleToRef(p,d),d.add(u,d),a=Rre.HELP_6;return d.subtract(c,a),0<h&&h<=this._dir.length&&a.lengthSquared<n*n?((o=new Rre).copyFrom(t.subtract(e)),o.scaleBy(p),o.add(e,o),{out:o,length:d.length}):{out:null,length:-1}}get_vec(e,t){var n=Rre.HELP_1;return n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z,n}};let oae=sae;bre(oae,"_rayl",1e9),bre(oae,"_smallnum",1e-8);class lae{constructor(e=0,t=0,n=0,r=0){bre(this,"x"),bre(this,"y"),bre(this,"w"),bre(this,"h"),this.x=e,this.y=t,this.w=n,this.h=r}get width(){return this.w}set width(e){this.w=e}get height(){return this.h}set height(e){this.h=e}static pointInRect(e,t,n,r,i,a){return!(e<n||i<e||t<r||a<t)}clone(){return new lae(this.x,this.y,this.w,this.h)}copyFrom(e){this.x=e.x,this.y=e.y,this.w=e.w,this.h=e.h}copyTo(e){e.copyFrom(this)}inner(e,t){return!(e<this.x||e>this.x+this.width||t<this.y||t>this.y+this.height)}equal(e){return!(this.x!=e.x||this.y!=e.y||this.width!=e.width||this.height!=e.height)}equalArea(e,t,n,r){return!(this.x!=e||this.y!=t||this.width!=n||this.height!=r)}equalInnerArea(e){var t=this.x,n=this.y,r=this.x+this.width,i=this.y+this.height,a=e.x,s=e.y,o=e.x+e.width;e=e.y+e.height;return Math.max(t,a)<=Math.min(r,o)&&Math.max(n,s)<=Math.min(i,e)}innerArea(e,t){t=t||new lae;var n=this.x,r=this.y,i=this.x+this.width,a=this.y+this.height,s=e.x,o=e.y,l=e.x+e.width;e=e.y+e.height,r=Math.max(r,o),o=Math.min(a,e),a=Math.max(n,s),e=Math.min(l,i);return 0<=r&&0<=o&&0<=o-r&&0<e-a?(t.x=a,t.y=r,t.width=e-a,t.height=o-r):(t.x=0,t.y=0,t.width=0,t.height=0),t}setTo(e,t,n,r){this.x=e,this.y=t,this.width=n,this.height=r}}class uae{constructor(){bre(this,"viewProj",new Kie),bre(this,"planes"),bre(this,"corners"),bre(this,"_centerSize"),this._centerSize=new Rre,this.planes=[],this.corners=[];for(var e=0;e<6;e++)this.planes[e]=new Rre;for(e=0;e<8;e++)this.corners[e]=new Rre}genBox(e){let t=0,n=9999999,r=9999999,i=9999999,a=-9999999,s=-9999999,o=-9999999;for(let u=0;u<2;++u)for(let c=0;c<2;++c)for(let d=0;d<2;++d){var l=this.corners[t];l.set(2*u-1,2*c-1,d,1),e.transformVector4(l,l),l.div(l.w,l),t++,n=Math.min(l.x,n),r=Math.min(l.y,r),i=Math.min(l.z,i),a=Math.max(l.x,a),s=Math.max(l.y,s),o=Math.max(l.z,o)}return this._centerSize.x=a-n,this._centerSize.y=s-r,this._centerSize.x=o-i,{minX:n,minY:r,minZ:i,maxX:a,maxY:s,maxZ:o}}setFrustumCorners(e){let t=0;for(let r=0;r<2;++r)for(let i=0;i<2;++i)for(let a=0;a<2;++a){var n=this.corners[t];n.set(2*r-1,2*i-1,a,1),e.transformVector4(n,n),n.div(n.w,n),t++}}update(e){e=e.rawData;var t=(this.planes[0].x=e[3]-e[0],this.planes[0].y=e[7]-e[4],this.planes[0].z=e[11]-e[8],this.planes[0].w=e[15]-e[12],Math.sqrt(this.planes[0].x*this.planes[0].x+this.planes[0].y*this.planes[0].y+this.planes[0].z*this.planes[0].z));this.planes[0].x/=t,this.planes[0].y/=t,this.planes[0].z/=t,this.planes[0].w/=t,this.planes[1].x=e[3]+e[0],this.planes[1].y=e[7]+e[4],this.planes[1].z=e[11]+e[8],this.planes[1].w=e[15]+e[12],t=Math.sqrt(this.planes[1].x*this.planes[1].x+this.planes[1].y*this.planes[1].y+this.planes[1].z*this.planes[1].z),this.planes[1].x/=t,this.planes[1].y/=t,this.planes[1].z/=t,this.planes[1].w/=t,this.planes[2].x=e[3]+e[1],this.planes[2].y=e[7]+e[5],this.planes[2].z=e[11]+e[9],this.planes[2].w=e[15]+e[13],t=Math.sqrt(this.planes[2].x*this.planes[2].x+this.planes[2].y*this.planes[2].y+this.planes[2].z*this.planes[2].z),this.planes[2].x/=t,this.planes[2].y/=t,this.planes[2].z/=t,this.planes[2].w/=t,this.planes[3].x=e[3]-e[1],this.planes[3].y=e[7]-e[5],this.planes[3].z=e[11]-e[9],this.planes[3].w=e[15]-e[13],t=Math.sqrt(this.planes[3].x*this.planes[3].x+this.planes[3].y*this.planes[3].y+this.planes[3].z*this.planes[3].z),this.planes[3].x/=t,this.planes[3].y/=t,this.planes[3].z/=t,this.planes[3].w/=t,this.planes[4].x=e[3]-e[2],this.planes[4].y=e[7]-e[6],this.planes[4].z=e[11]-e[10],this.planes[4].w=e[15]-e[14],t=Math.sqrt(this.planes[4].x*this.planes[4].x+this.planes[4].y*this.planes[4].y+this.planes[4].z*this.planes[4].z),this.planes[4].x/=t,this.planes[4].y/=t,this.planes[4].z/=t,this.planes[4].w/=t,this.planes[5].x=e[3]+e[2],this.planes[5].y=e[7]+e[6],this.planes[5].z=e[11]+e[10],this.planes[5].w=e[15]+e[14],t=Math.sqrt(this.planes[5].x*this.planes[5].x+this.planes[5].y*this.planes[5].y+this.planes[5].z*this.planes[5].z),this.planes[5].x/=t,this.planes[5].y/=t,this.planes[5].z/=t,this.planes[5].w/=t}containsPoint(e){for(var t=0;t<6;t++)if(this.planes[t].x*e.x+this.planes[t].y*e.y+this.planes[t].z*e.z+this.planes[t].w<=0)return!1;return!0}containsSphere(e){let t,n,r,i=e.bound,a=0,s=e.transform.worldPosition,o=i.radius,l=i.center.x+s.x,u=i.center.y+s.y,c=i.center.z+s.z,d=this.planes;for(n=0;n<6;n++){if((t=(r=d[n]).x*l+r.y*u+r.z*c+r.w)<=-o)return 0;o<t&&a++}return 6===a?2:1}containsBox(e){let t,n,r=e.bound,i=0;e.updateBound();var a,s=2*Math.max(r.size.x,r.size.y,r.size.z),o=r.center.x,l=r.center.y,u=r.center.z,c=this.planes;for(n=0;n<6;n++){if((t=(a=c[n]).x*o+a.y*l+a.z*u+a.w)<=-s)return 0;s<t&&i++}return 6===i?2:1}}var cae=(e=>(e[e.ortho=0]="ortho",e[e.perspective=1]="perspective",e[e.shadow=2]="shadow",e))(cae||{});class dae extends iae{constructor(){super(),bre(this,"fov",1),bre(this,"name"),bre(this,"aspect",1),bre(this,"near",1),bre(this,"far",5e3),bre(this,"viewPort",new lae),bre(this,"frustum"),bre(this,"isShadowCamera",!1),bre(this,"_projectionMatrixInv",new Kie),bre(this,"_projectionMatrix",new Kie),bre(this,"_viewMatrix",new Kie),bre(this,"_unprojection",new Kie),bre(this,"_pvMatrixInv",new Kie),bre(this,"_pvMatrix",new Kie),bre(this,"_halfw"),bre(this,"_halfh"),bre(this,"_ray"),bre(this,"lookTarget"),bre(this,"type",cae.perspective),bre(this,"cubeShadowCameras",[]),bre(this,"_haltonSeq"),bre(this,"_jitterOffsetList"),bre(this,"_useJitterProjection",!1),bre(this,"_jitterFrameIndex",0),bre(this,"_sampleIndex",0),bre(this,"_jitterX",0),bre(this,"_jitterY",0)}get projectionMatrix(){return this._projectionMatrix}init(){super.init(),this._ray=new oae,this.frustum=new uae,this.viewPort.x=0,this.viewPort.y=0,this.viewPort.w=Dre.presentationSize[0],this.viewPort.h=Dre.presentationSize[1],this.lookTarget=new Rre(0,0,0)}perspective(e,t,n,r){this.fov=e,this.aspect=t,this.near=n,this.far=r,this._projectionMatrix.perspective(e,t,n,r),this.type=cae.perspective}ortho(e,t,n,r){this.near=Math.max(n,.1),this.far=r,this._projectionMatrix.ortho(e,t,n,r),this.type=cae.ortho}orthoOffCenter(e,t,n,r,i,a){this.near=Math.max(i,.01),this.far=a,this._projectionMatrix.orthoOffCenter(e,t,n,r,i,a),this.type=cae.ortho}orthoZo(e,t,n,r,i,a){this.near=Math.max(i,.01),this.far=a,this._projectionMatrix.orthoZO(e,t,n,r,i,a),this.type=cae.ortho}get viewMatrix(){return this._viewMatrix.copyFrom(this.transform.worldMatrix),this._viewMatrix.invert(),this._viewMatrix}get shadowViewMatrix(){return this._viewMatrix.copyFrom(this.transform.worldMatrix),this._viewMatrix.appendScale(1,1,1),this._viewMatrix.invert(),this._viewMatrix}object3DToScreenRay(e,t=null){return t=t||new Rre(0,0,0,1),this._halfw=.5*this.viewPort.width,this._halfh=.5*this.viewPort.height,Yie.transformVector(this.viewMatrix,e,t),this.project(t,t),t.x=this._halfw+t.x*this._halfw,t.y=this.viewPort.height-(this._halfh-t.y*this._halfh),t}screenRayToObject3D(e,t=null){t=t||new Rre,this._halfw=.5*this.viewPort.width,this._halfh=.5*this.viewPort.height;var n=e.x,r=e.y;return t.x=n/this.viewPort.width-.25,t.y=r/this.viewPort.height-.25,this.unProject(t.x,t.y,e.z,t),t}get pvMatrix(){return Qie(this._projectionMatrix,this.viewMatrix,this._pvMatrix),this._pvMatrix}get pvMatrix2(){return Qie(this._projectionMatrix,this.transform.worldMatrix,this._pvMatrix),this._pvMatrix}get pvMatrixInv(){var e=this._pvMatrixInv.copyFrom(this.pvMatrix);return e.invert(),e}get projectionMatrixInv(){return this._projectionMatrixInv.copyFrom(this._projectionMatrix),this._projectionMatrixInv.invert(),this._projectionMatrixInv}unProject(e,t,n,r){return(r=r||new Rre).x=e,r.y=-t,r.z=n,r.w=1,r.x*=n,r.y*=n,this._unprojection.copyFrom(this._projectionMatrix),this._unprojection.invert(),Yie.transformVector(this._unprojection,r,r),r.z=n,r}project(e,t){return this._projectionMatrix.perspectiveMultiplyPoint3(e,t),t.x=t.x/t.w,t.y=-t.y/t.w,t.z=e.z,t}screenPointToRay(e,t){let n=this._ray,r=xae.UnProjection(e,t,.01,this),i=xae.UnProjection(e,t,1,this);return i=i.subtract(r).normalize(),n.origin.copyFrom(r),n.direction=i,n}screenPointToWorld(e,t,n){return xae.UnProjection(e,t,n,this)}worldToScreenPoint(e,t){return xae.Projection(e,this,t)}lookAt(e,t,n=Rre.Y_AXIS){this.transform.lookAt(e,t,n),t&&this.lookTarget.copyFrom(t)}resetProjectMatrix(){this.perspective(this.fov,this.aspect,this.near,this.far)}onUpdate(){this.type==cae.perspective&&(this.aspect=Dre.aspect,this.resetProjectMatrix()),this._useJitterProjection&&this.getJitteredProjectionMatrix(),this.frustum.update(this.pvMatrix)}get jitterFrameIndex(){return this._jitterFrameIndex}get jitterX(){return this._jitterX}get jitterY(){return this._jitterY}enableJitterProjection(e){this._jitterFrameIndex=0,this._useJitterProjection=e,this._haltonSeq||(this._haltonSeq=new aae),this._jitterOffsetList=[];for(let n=0;n<8;n++){var t=this.generateRandomOffset();this._jitterOffsetList.push(t)}this._jitterOffsetList.reverse()}generateRandomOffset(){var e=new Wre(aae.get(1+(1023&this._sampleIndex),2)-.5,aae.get(1+(1023&this._sampleIndex),3)-.5);return 8<=++this._sampleIndex&&(this._sampleIndex=0),e}getJitteredProjectionMatrix(){var e=nce.setting.render.postProcessing.taa,t=this._projectionMatrix,n=e.temporalJitterScale,r=(e=this._jitterFrameIndex%e.jitterSeedCount,this._jitterOffsetList[e].x*n),i=(e=this._jitterOffsetList[e].y*n,n=t.get(0,2),t.get(1,2));this._jitterX=r/this.viewPort.width,this._jitterY=e/this.viewPort.height,n+=this._jitterX,i+=this._jitterY,t.set(0,2,n),t.set(1,2,i),this._jitterFrameIndex++}getCastShadowLightSpaceMatrix(e,t){var n=this.frustum,r=this.projectionMatrixInv,i=this.transform.worldMatrix,a=(r=(Kie.helpMatrix.copyFrom(r),Kie.helpMatrix.multiply(i),n.setFrustumCorners(Kie.helpMatrix),n.corners),Rre.HELP_6);a.set(0,0,0);for(const h of r)a.add(h,a);a.div(r.length,a),(i=Rre.HELP_5).copyFrom(a),Rre.HELP_0.copyFrom(t),i.add(Rre.HELP_0,i),e.lookAt(i,a,Rre.UP);let s=Number.MAX_VALUE,o=-Number.MAX_VALUE,l=Number.MAX_VALUE,u=-Number.MAX_VALUE,c=Number.MAX_VALUE,d=-Number.MAX_VALUE;for(const h of r)s=Math.min(s,h.x),o=Math.max(o,h.x),l=Math.min(l,h.y),u=Math.max(u,h.y),c=Math.min(c,h.z),d=Math.max(d,h.z);n=nce.setting.shadow.shadowQuality,c<0?c*=n:c/=n,d<0?d/=n:d*=n,e.orthoOffCenter(s,o,l,u,c,d)}getWorldDirection(e){e=e||new Rre,this.transform.updateWorldMatrix();var t=this.transform._worldMatrix.rawData;return e.set(-t[8],-t[9],-t[10]).normalize()}}const hae=class extends iae{constructor(){super(),bre(this,"eventPositionChange",new Cre(hae.POSITION_ONCHANGE)),bre(this,"eventRotationChange",new Cre(hae.ROTATION_ONCHANGE)),bre(this,"eventScaleChange",new Cre(hae.SCALE_ONCHANGE)),bre(this,"onPositionChange"),bre(this,"onRotationChange"),bre(this,"onScaleChange"),bre(this,"_scene3d"),bre(this,"_parent"),bre(this,"_localPos"),bre(this,"_localRot"),bre(this,"_localRotQuat"),bre(this,"_localScale"),bre(this,"_forward",new Rre),bre(this,"_back",new Rre),bre(this,"_right",new Rre),bre(this,"_left",new Rre),bre(this,"_up",new Rre),bre(this,"_down",new Rre),bre(this,"_worldMatrix"),bre(this,"_localChange",!0),bre(this,"_targetPos"),this._worldMatrix=new Kie(!0),this._localPos=new Rre,this._localRot=new Rre,this._localRotQuat=new Gie,this._localScale=new Rre(1,1,1)}get targetPos(){return this._targetPos}set targetPos(e){this._targetPos=e}get parent(){return this._parent}set parent(e){let t=null==(n=this._parent)?void 0:n.object3D;var n=(this._parent=e)?e.scene3D:null;n?(this._scene3d=n,this.object3D.components.forEach((e=>{rae.appendWaitStart(this.object3D,e)}))):this.object3D.components.forEach((e=>{e.__stop()})),this.object3D.entityChildren.forEach((t=>{t.transform.parent=e?this:null})),e&&this.transform.updateWorldMatrix(),this.object3D.components.forEach((e=>{var n;null!=(n=e.onParentChange)&&n.call(e,t,null==(n=this._parent)?void 0:n.object3D)}))}set enable(e){this.transform._scene3d&&e?super.enable=!0:super.enable=!1,this.object3D.entityChildren.forEach((t=>{t.transform.enable=e}))}get enable(){return this._enable}get scene3D(){return this._scene3d}set scene3D(e){this._scene3d=e}get view3D(){return this._scene3d&&this._scene3d.view?this._scene3d.view:null}awake(){}start(){}stop(){}notifyLocalChange(){this._localChange=!0;var e=this.object3D.entityChildren;for(let t=0,n=e.length;t<n;t++)e[t].transform.notifyLocalChange()}get up(){return this.worldMatrix.transformVector(Rre.UP,this._up),this._up}set up(e){this._up.copyFrom(e),this.notifyLocalChange(),this.onRotationChange&&this.onRotationChange(),this.eventRotationChange&&this.eventDispatcher.dispatchEvent(this.eventRotationChange)}get down(){return this.worldMatrix.transformVector(Rre.DOWN,this._down),this._down}set down(e){this._down.copyFrom(e),this.notifyLocalChange(),this.onRotationChange&&this.onRotationChange(),this.eventRotationChange&&this.eventDispatcher.dispatchEvent(this.eventRotationChange)}get forward(){return this.worldMatrix.transformVector(Rre.FORWARD,this._forward),this._forward}set forward(e){this._forward.copyFrom(e),Yie.fromToRotation(Rre.FORWARD,this._forward,Gie.HELP_0),this.transform.localRotQuat=Gie.HELP_0,this.notifyLocalChange(),this.onRotationChange&&this.onRotationChange(),this.eventRotationChange&&this.eventDispatcher.dispatchEvent(this.eventRotationChange)}get back(){return this.worldMatrix.transformVector(Rre.BACK,this._back),this._back}set back(e){this._back.copyFrom(e),Yie.fromToRotation(Rre.BACK,this._back,Gie.HELP_0),this.transform.localRotQuat=Gie.HELP_0,this.notifyLocalChange(),this.onRotationChange&&this.onRotationChange(),this.eventRotationChange&&this.eventDispatcher.dispatchEvent(this.eventRotationChange)}get left(){return this.worldMatrix.transformVector(Rre.neg_X_AXIS,this._left),this._left}set left(e){this._left.copyFrom(e),this.notifyLocalChange(),this.onRotationChange&&this.onRotationChange(),this.eventRotationChange&&this.eventDispatcher.dispatchEvent(this.eventRotationChange)}get right(){return this.worldMatrix.transformVector(Rre.X_AXIS,this._right),this._right}set right(e){this._right.copyFrom(e),this.notifyLocalChange(),this.onRotationChange&&this.onRotationChange(),this.eventRotationChange&&this.eventDispatcher.dispatchEvent(this.eventRotationChange)}get localRotQuat(){return this._localRotQuat}set localRotQuat(e){this._localRotQuat=e,this._localRotQuat.getEulerAngles(this._localRot),this.notifyLocalChange(),this.onRotationChange&&this.onRotationChange(),this.eventRotationChange&&this.eventDispatcher.dispatchEvent(this.eventRotationChange)}notifyChange(){this.notifyLocalChange(),this.onRotationChange&&this.onRotationChange(),this.eventRotationChange&&this.eventDispatcher.dispatchEvent(this.eventRotationChange),this.eventPositionChange&&this.eventDispatcher.dispatchEvent(this.eventPositionChange),this.eventScaleChange&&this.eventDispatcher.dispatchEvent(this.eventScaleChange)}get worldMatrix(){return this.updateWorldMatrix(),this._worldMatrix}updateWorldMatrix(e=!1){(this._localChange||e)&&(this.parent?(Jie(this._localRot,this._localPos,this.localScale,this._worldMatrix),function(e,t,n){e=e.rawData,n=n.rawData;var r=e[0],i=e[4],a=e[8],s=e[12],o=e[1],l=e[5],u=e[9],c=e[13],d=e[2],h=e[6],p=e[10],f=e[14],m=e[3],g=e[7],v=e[11];e=e[15],n[0]=r*t.rawData[0]+o*t.rawData[4]+d*t.rawData[8]+m*t.rawData[12],n[1]=r*t.rawData[1]+o*t.rawData[5]+d*t.rawData[9]+m*t.rawData[13],n[2]=r*t.rawData[2]+o*t.rawData[6]+d*t.rawData[10]+m*t.rawData[14],n[3]=r*t.rawData[3]+o*t.rawData[7]+d*t.rawData[11]+m*t.rawData[15],n[4]=i*t.rawData[0]+l*t.rawData[4]+h*t.rawData[8]+g*t.rawData[12],n[5]=i*t.rawData[1]+l*t.rawData[5]+h*t.rawData[9]+g*t.rawData[13],n[6]=i*t.rawData[2]+l*t.rawData[6]+h*t.rawData[10]+g*t.rawData[14],n[7]=i*t.rawData[3]+l*t.rawData[7]+h*t.rawData[11]+g*t.rawData[15],n[8]=a*t.rawData[0]+u*t.rawData[4]+p*t.rawData[8]+v*t.rawData[12],n[9]=a*t.rawData[1]+u*t.rawData[5]+p*t.rawData[9]+v*t.rawData[13],n[10]=a*t.rawData[2]+u*t.rawData[6]+p*t.rawData[10]+v*t.rawData[14],n[11]=a*t.rawData[3]+u*t.rawData[7]+p*t.rawData[11]+v*t.rawData[15],n[12]=s*t.rawData[0]+c*t.rawData[4]+f*t.rawData[8]+e*t.rawData[12],n[13]=s*t.rawData[1]+c*t.rawData[5]+f*t.rawData[9]+e*t.rawData[13],n[14]=s*t.rawData[2]+c*t.rawData[6]+f*t.rawData[10]+e*t.rawData[14],n[15]=s*t.rawData[3]+c*t.rawData[7]+f*t.rawData[11]+e*t.rawData[15]}(this._worldMatrix,this.parent.worldMatrix,this._worldMatrix)):Jie(this._localRot,this._localPos,this.localScale,this._worldMatrix),this._localChange=!1)}lookTarget(e,t=Rre.UP){var n=this.transform.worldPosition;this.lookAt(n,e,t)}lookAt(e,t,n=Rre.UP){this._targetPos||(this._targetPos=new Rre),this._targetPos.copyFrom(t),this.localPosition=e,Kie.helpMatrix.lookAt(e,t,n),Kie.helpMatrix.invert(),e=Kie.helpMatrix.decompose(Fie.QUATERNION),this.localRotQuat=Gie.CALCULATION_QUATERNION.copyFrom(e[1])}decomposeFromMatrix(e,t="eulerAngles"){return e=e.decompose(t),(t=this.transform).localRotQuat.copyFrom(e[1]),t.localRotQuat=t.localRotQuat,t.localPosition.copyFrom(e[0]),t.localPosition=t.localPosition,t.localScale.copyFrom(e[2]),t.localScale=t.localScale,this.updateWorldMatrix(),this}cloneTo(e){e.transform.localPosition.copyFrom(this.localPosition),e.transform.localRotation.copyFrom(this.localRotation),e.transform.localScale.copyFrom(this.localScale)}set x(e){this._localPos.x!=e&&(this._localPos.x=e,this.notifyLocalChange(),this.onPositionChange&&this.onPositionChange(),this.eventPositionChange)&&this.eventDispatcher.dispatchEvent(this.eventPositionChange)}get x(){return this._localPos.x}set y(e){this._localPos.y!=e&&(this._localPos.y=e,this.notifyLocalChange(),this.onPositionChange&&this.onPositionChange(),this.eventPositionChange)&&this.eventDispatcher.dispatchEvent(this.eventPositionChange)}get y(){return this._localPos.y}set z(e){this._localPos.z!=e&&(this._localPos.z=e,this.notifyLocalChange(),this.onPositionChange&&this.onPositionChange(),this.eventPositionChange)&&this.eventDispatcher.dispatchEvent(this.eventPositionChange)}get z(){return this._localPos.z}set scaleX(e){this._localScale.x!=e&&(this._localScale.x=e,this.notifyLocalChange(),this.eventScaleChange)&&this.eventDispatcher.dispatchEvent(this.eventScaleChange)}get scaleX(){return this._localScale.x}set scaleY(e){this._localScale.y!=e&&(this._localScale.y=e,this.notifyLocalChange(),this.eventScaleChange)&&this.eventDispatcher.dispatchEvent(this.eventScaleChange)}get scaleY(){return this._localScale.y}set scaleZ(e){this._localScale.z!=e&&(this._localScale.z=e,this.notifyLocalChange(),this.eventScaleChange)&&this.eventDispatcher.dispatchEvent(this.eventScaleChange)}get scaleZ(){return this._localScale.z}set rotationX(e){this._localRot.x!=e&&(this._localRot.x=e,this.notifyLocalChange(),this.onRotationChange&&this.onRotationChange(),this.eventRotationChange)&&this.eventDispatcher.dispatchEvent(this.eventRotationChange)}get rotationX(){return this._localRot.x}set rotationY(e){this._localRot.y!=e&&(this._localRot.y=e,this.notifyLocalChange(),this.onRotationChange&&this.onRotationChange(),this.eventRotationChange)&&this.eventDispatcher.dispatchEvent(this.eventRotationChange)}get rotationY(){return this._localRot.y}set rotationZ(e){this._localRot.z!=e&&(this._localRot.z=e,this.notifyLocalChange(),this.onRotationChange&&this.onRotationChange(),this.eventRotationChange)&&this.eventDispatcher.dispatchEvent(this.eventRotationChange)}get rotationZ(){return this._localRot.z}get worldPosition(){return this._localChange&&this.updateWorldMatrix(),this._worldMatrix.position}set localPosition(e){this.x=e.x,this.y=e.y,this.z=e.z,this.notifyLocalChange(),this.onPositionChange&&this.onPositionChange(),this.eventPositionChange&&this.eventDispatcher.dispatchEvent(this.eventPositionChange)}get localPosition(){return this._localPos}set localRotation(e){this.rotationX=e.x,this.rotationY=e.y,this.rotationZ=e.z,this.notifyLocalChange(),this.onRotationChange&&this.onRotationChange(),this.eventRotationChange&&this.eventDispatcher.dispatchEvent(this.eventRotationChange)}get localRotation(){return this._localRot}set localScale(e){this.scaleX=e.x,this.scaleY=e.y,this.scaleZ=e.z,this.notifyLocalChange(),this.eventScaleChange&&this.eventDispatcher.dispatchEvent(this.eventScaleChange)}get localScale(){return this._localScale}beforeDestroy(e){var t;this.parent&&this.parent.object3D&&this.parent.object3D.removeChild(this.object3D),null!=(t=super.beforeDestroy)&&t.call(this,e)}destroy(){super.destroy(),this.scene3D=null,this.eventPositionChange=null,this.eventRotationChange=null,this.eventScaleChange=null,this.onPositionChange=null,this.onRotationChange=null,this.onScaleChange=null,this._scene3d=null,this._parent=null,this._localPos=null,this._localRot=null,this._localRotQuat=null,this._localScale=null,this._forward=null,this._back=null,this._right=null,this._left=null,this._up=null,this._down=null,this._localChange=null,this._targetPos=null}};let pae=hae;bre(pae,"LIMIT",1),bre(pae,"COMPONENT_NAME","UUTransform"),bre(pae,"COMPONENT_TYPE","Transform"),bre(pae,"POSITION_ONCHANGE","POSITION_ONCHANGE"),bre(pae,"ROTATION_ONCHANGE","ROTATION_ONCHANGE"),bre(pae,"SCALE_ONCHANGE","SCALE_ONCHANGE"),bre(pae,"PARENT_ONCHANGE","PARENT_ONCHANGE"),bre(pae,"CHILDREN_ONCHANGE","CHILDREN_ONCHANGE"),bre(pae,"ADD_ONCHANGE","ADD_ONCHANGE");var fae=(e=>(e[e.None=2]="None",e[e.StaticBatch=4]="StaticBatch",e[e.DynamicBatch=8]="DynamicBatch",e))(fae||{});class mae{static addMask(e,t){return e|t}static removeMask(e,t){return e&~t}static hasMask(e,t){return 0!=(e&t)}}class gae{constructor(e,t){bre(this,"center"),bre(this,"extents"),bre(this,"max"),bre(this,"min"),bre(this,"size"),this.center=e,this.extents=new Rre(t.x/2,t.y/2,t.z/2),this.size=t,this.max=this.center.add(this.extents),this.min=this.center.subtract(this.extents)}setFromMinMax(e,t){this.min||(this.min=new Rre),this.max||(this.max=new Rre),this.size||(this.size=new Rre),this.center||(this.center=new Rre),this.extents||(this.extents=new Rre),this.size.set(t.x-e.x,t.y-e.y,t.z-e.z),this.extents.copyFrom(this.size).multiplyScalar(.5),this.center.copyFrom(this.min).add(this.extents,this.center),this.min.copyFrom(e),this.max.copyFrom(t)}setFromCenterAndSize(e,t){this.size=t,this.center=e,this.extents=new Rre(this.size.x/2,this.size.y/2,this.size.z/2),this.min=new Rre(this.center.x+-this.extents.x,this.center.y+-this.extents.y,this.center.z+-this.extents.z),this.max=new Rre(this.center.x+this.extents.x,this.center.y+this.extents.y,this.center.z+this.extents.z)}containsFrustum(e,t){return t.containsBox(e)}merge(e){e.min.x<this.min.x&&(this.min.x=e.min.x),e.min.y<this.min.y&&(this.min.y=e.min.y),e.min.z<this.min.z&&(this.min.z=e.min.z),e.max.x>this.max.x&&(this.max.x=e.max.x),e.max.y>this.max.y&&(this.max.y=e.max.y),e.max.z>this.max.z&&(this.max.z=e.max.z),this.size.x=e.max.x-e.min.x,this.size.y=e.max.y-e.min.y,this.size.z=e.max.z-e.min.z,this.extents.x=.5*this.size.x,this.extents.y=.5*this.size.y,this.extents.z=.5*this.size.z,this.center.x=this.extents.x+e.min.x,this.center.y=this.extents.y+e.min.y,this.center.z=this.extents.z+e.min.z}intersects(e){return this.min.x<=e.max.x&&this.max.x>=e.min.x&&this.min.y<=e.max.y&&this.max.y>=e.min.y&&this.min.z<=e.max.z&&this.max.z>=e.min.z}intersectsSphere(e){return this.min.x<=e.max.x&&this.max.x>=e.min.x&&this.min.y<=e.max.y&&this.max.y>=e.min.y&&this.min.z<=e.max.z&&this.max.z>=e.min.z}intersectsBox(e){return this.min.x<=e.max.x&&this.max.x>=e.min.x&&this.min.y<=e.max.y&&this.max.y>=e.min.y&&this.min.z<=e.max.z&&this.max.z>=e.min.z}equals(e){return this.center.equals(e.center)&&this.extents.equals(e.extents)}expandByPoint(e){e.x<this.min.x&&(this.min.x=e.x),e.x>this.max.x&&(this.max.x=e.x),e.y<this.min.y&&(this.min.y=e.y),e.y>this.max.y&&(this.max.y=e.y),e.z<this.min.z&&(this.min.z=e.z),e.z>this.max.z&&(this.max.z=e.z)}static fromPoints(e){for(var t=new gae(new Rre,new Rre),n=0;n<e.length;n++)t.expandByPoint(e[n]);return t}calculateTransform(e){}clone(){return new gae(this.center.clone(),this.size.clone())}intersectsRay(e,t){throw new Error("Method not implemented.")}containsPoint(e){return this.min.x<=e.x&&this.max.x>=e.x&&this.min.y<=e.y&&this.max.y>=e.y&&this.min.z<=e.z&&this.max.z>=e.z}updateBound(){}destroy(e){this.center=null,this.extents=null,this.min=null,this.max=null,this.size=null}}const vae=class{static genMeshBounds(e,t){var n=this.genMeshMinVector,r=this.genMeshMaxVector,i=this.genMeshVectorList8;(t=t||new gae(Rre.ZERO,Rre.ZERO)).setFromMinMax(this.maxVector,this.minVector),e=e.getComponents(soe);for(const s of e)if(s&&s.geometry){var a=s.object3D.transform.worldMatrix;n.copy(s.geometry.bounds.min),r.copy(s.geometry.bounds.max),i[0].set(n.x,n.y,n.z),i[1].set(n.x,n.y,r.z),i[2].set(n.x,r.y,n.z),i[3].set(n.x,r.y,r.z),i[4].set(r.x,n.y,n.z),i[5].set(r.x,n.y,r.z),i[6].set(r.x,r.y,n.z),i[7].set(r.x,r.y,r.z);for(const e of i)a.transformPoint(e,e),t.expandByPoint(e)}return r.copyFrom(t.max),n.copyFrom(t.min),t.setFromMinMax(n,r),t}static transformBound(e,t,n){var r=this.genMeshMinVector.copyFrom(t.min),i=(t=this.genMeshMaxVector.copyFrom(t.max),this.genMeshVectorList8);(n=n||new gae(Rre.ZERO,Rre.ZERO)).setFromMinMax(this.maxVector,this.minVector),i[0].set(r.x,r.y,r.z),i[1].set(r.x,r.y,t.z),i[2].set(r.x,t.y,r.z),i[3].set(r.x,t.y,t.z),i[4].set(t.x,r.y,r.z),i[5].set(t.x,r.y,t.z),i[6].set(t.x,t.y,r.z),i[7].set(t.x,t.y,t.z);for(const a of i)e.transformPoint(a,a),n.expandByPoint(a);return t.copyFrom(n.max),r.copyFrom(n.min),n.setFromMinMax(r,t),n}};let yae=vae;bre(yae,"maxVector",new Rre(.1*Number.MAX_VALUE,.1*Number.MAX_VALUE,.1*Number.MAX_VALUE)),bre(yae,"minVector",vae.maxVector.clone().multiplyScalar(-1)),bre(yae,"genMeshMaxVector",Rre.ZERO.clone()),bre(yae,"genMeshMinVector",Rre.ZERO.clone()),bre(yae,"genMeshVectorList8",[new Rre,new Rre,new Rre,new Rre,new Rre,new Rre,new Rre,new Rre]);class _ae extends Mre{constructor(){super(),bre(this,"name",""),bre(this,"_uuid",""),bre(this,"_renderLayer",fae.None),bre(this,"transform"),bre(this,"renderNode"),bre(this,"entityChildren"),bre(this,"components"),bre(this,"waitDisposeComponents"),bre(this,"_bound"),bre(this,"_boundWorld"),bre(this,"_dispose",!1),this.entityChildren=[],this.components=new Map,this.waitDisposeComponents=[],this._uuid=Rie()}get uuid(){return this._uuid}get renderLayer(){return this._renderLayer}set renderLayer(e){for(let t=0;t<this.entityChildren.length;t++)this.entityChildren[t].renderLayer=e;this._renderLayer=e}getObjectByName(e){if(0<=e.indexOf("/")){let n=e.split("/"),r=this;for(;0<n.length&&r;){var t=n.shift();if(!(r=r.getChildByName(t,!1)))return null}return r}return this.getChildByName(e,!1)}get numChildren(){return this.entityChildren.length}addChild(e){return null==e?new console.error("child is null!"):e===this?new console.error("child is self!"):-1==this.entityChildren.indexOf(e)?(e.transform.parent&&e.transform.parent.object3D.removeChild(e),e.transform.parent=this.transform,this.entityChildren.push(e),e.transform.notifyLocalChange(),e):null}removeChild(e){var t;return null===e?new console.error("remove child is null!"):e===this?new console.error("add child is self!"):void(-1!=(t=this.entityChildren.indexOf(e))&&(this.entityChildren.splice(t,1),e.transform.parent=null))}removeAllChild(){for(;0<this.numChildren;)this.removeChild(this.entityChildren[0])}removeSelf(){return this.removeFromParent()}removeChildByIndex(e){0<=e&&e<this.entityChildren.length?this.removeChild(this.entityChildren[e]):console.error("remove child by index , index out of range")}hasChild(e){return-1!=this.entityChildren.indexOf(e)}removeFromParent(){var e=this.transform.parent;return e&&e.object3D&&e.object3D.removeChild(this),this}getChildByIndex(e){let t=null;return e<this.entityChildren.length?this.entityChildren[e]:t}getChildByName(e,t=!0){let n=null;for(const r of this.entityChildren){if(r.name==e)return r;if(t&&(n=r.getChildByName(e,t)))return n}return n}update(){}instantiate(){return null}waitUpdate(){this._dispose?(this.removeFromParent(),this.components.forEach(((e,t)=>{var n;e.enable=!1,null!=(n=e.beforeDestroy)&&n.call(e),e.destroy()})),this.components.clear()):rae.waitStartComponent.forEach(((e,t)=>{e.forEach((e=>{e.__start()})),rae.waitStartComponent.delete(t)}))}get bound(){return this._bound||this.updateBound(),this._boundWorld}set bound(e){this._bound=e,this._boundWorld=this._bound.clone(),this.updateBound()}updateBound(){this._bound||(this._bound=new gae(Rre.ZERO.clone(),Rre.ONE.clone()),this._boundWorld=this._bound.clone()),yae.transformBound(this.transform.worldMatrix,this._bound,this._boundWorld)}destroy(e){this._dispose||(this.components.forEach((t=>{var n;null!=(n=t.beforeDestroy)&&n.call(t,e)})),this.components.forEach((t=>{t.destroy(e)})),this.components.clear(),this.entityChildren.forEach((t=>{t.destroy(e)})),this.transform.parent=null,this._dispose=!0,super.destroy())}}class bae extends _ae{constructor(){super(),bre(this,"_isScene3D"),bre(this,"prefabRef"),this.transform=this.addComponent(pae)}get isScene3D(){return this._isScene3D}forChild(e){this.entityChildren.forEach((t=>{e(t),t.forChild(e)}))}addComponent(e,t){var n=e.name;return this.components.has(n)?null:(((e=new e).object3D=this).components.set(n,e),e.__init(t),rae.appendWaitStart(this,e),e)}getOrAddComponent(e){let t=e.name,n=this.components.get(t);return n||this.addComponent(e)}removeComponent(e){var t;e=e.name;this.components.has(e)&&(t=this.components.get(e),this.components.delete(e),t.__stop(),null!=(e=t.beforeDestroy)&&e.call(t),t.destroy())}hasComponent(e){return e=e.name,this.components.has(e)}getComponent(e){return e=e.name,this.components.get(e)}getComponentFromParent(e){return this.parent?this.parent.object3D.getComponent(e)||this.parent.object3D.getComponentFromParent(e):null}getComponentsInChild(e){var t=[],n=e.name;(n=this.components.get(n))&&t.push(n);for(let i=0;i<this.entityChildren.length;i++){var r=this.entityChildren[i].getComponentsInChild(e);t.push(...r)}return t}getComponents(e,t,n){t=t||[];var r=this.getComponent(e);r&&(r.enable||n)&&t.push(r);for(let a=0,s=this.entityChildren.length;a<s;a++){var i=this.entityChildren[a];i&&i instanceof bae&&i.getComponents(e,t,n)}return t}getComponentsExt(e,t,n){t=t||[];var r=this.components.get(e.name);if(r&&(r.enable||n))t.push(r);else for(const i of this.entityChildren)i instanceof bae&&i.getComponentsExt(e,t,n);return t}getComponentsByProperty(e,t,n=!0,r,i){let a;r=r||[];for(const s of this.components.values())s&&(s.enable||i)&&s[e]==t&&(r.push(s),a=!0);if(!a||!n)for(const s of this.entityChildren)s instanceof bae&&s.getComponentsByProperty(e,t,n,r,i);return r}clone(){return this.instantiate()}instantiate(){let e=new bae;return e.name=this.name+"_clone",this.entityChildren.forEach(((t,n)=>{t=t.instantiate(),e.addChild(t)})),this.components.forEach(((t,n)=>{t.cloneTo(e)})),e}get localPosition(){return this.transform.localPosition}set localPosition(e){this.transform.localPosition=e}get localRotation(){return this.transform.localRotation}set localRotation(e){this.transform.localRotation=e}get localScale(){return this.transform.localScale}set localScale(e){this.transform.localScale=e}get localQuaternion(){return this.transform.localRotQuat}set localQuaternion(e){this.transform.localRotQuat=e}notifyChange(){this.transform.notifyChange()}get parent(){return this.transform.parent}get parentObject(){return this.transform.parent.object3D}set x(e){this.transform.x=e}get x(){return this.transform.x}set y(e){this.transform.y=e}get y(){return this.transform.y}set z(e){this.transform.z=e}get z(){return this.transform.z}set scaleX(e){this.transform.scaleX=e}get scaleX(){return this.transform.scaleX}set scaleY(e){this.transform.scaleY=e}get scaleY(){return this.transform.scaleY}set scaleZ(e){this.transform.scaleZ=e}get scaleZ(){return this.transform.scaleZ}set rotationX(e){this.transform.rotationX=e}get rotationX(){return this.transform.rotationX}set rotationY(e){this.transform.rotationY=e}get rotationY(){return this.transform.rotationY}set rotationZ(e){this.transform.rotationZ=e}get rotationZ(){return this.transform.rotationZ}fixedUpdate(){}lateUpdate(){}traverse(e){e(this);for(let n=0,r=this.entityChildren.length;n<r;n++){var t=this.entityChildren[n];t instanceof bae&&t.traverse(e)}}destroy(e){super.destroy(e)}}class xae{static createCamera3DObject(e,t){return this.createCamera3D(null,e,t)}static createCamera3D(e,t,n){return e=e||new bae,t&&t.addChild(e),n&&(e.name=n),e.getOrAddComponent(dae)}static UnProjection(e,t,n=1,r){e=new Rre(e,t,0),t=Rre.HELP_0;var i=Dre.canvas.offsetLeft,a=Dre.canvas.offsetTop,s=Dre.canvas.clientWidth,o=Dre.canvas.clientHeight;t.x=2*((e.x-i)/s-.5),t.y=2*-((e.y-a)/o-.5),t.z=n,i=new Rre(0,0,0);return(e=((s=Kie.helpMatrix2).copyFrom(r.projectionMatrix),s.invert(),Kie.helpMatrix)).identity(),e.multiply(s),e.multiply(r.transform.worldMatrix),e.perspectiveMultiplyPoint3(t,i),i}static Projection(e,t,n){n=n||new Rre(0,0,0),(r=Kie.helpMatrix).copyFrom(t.viewMatrix),r.multiply(t.projectionMatrix),r.perspectiveMultiplyPoint3(e,n),t=Dre.canvas.clientWidth/2;var r=Dre.canvas.clientHeight/2;return n.x=n.x*t+t,n.y=r-n.y*r,n}static UnProjection2(e,t,n,r,i){i=i||new Rre(0,0,0);var a=Kie.helpMatrix,s=(r=(a.copyFrom(r.pvMatrixInv),Dre.canvas.clientWidth/2),Dre.canvas.clientHeight/2);return i.x=(e-r)/r,i.y=(s-t)/s,i.z=n,a.perspectiveMultiplyPoint3(i,i),i}}const wae=class{static init(){this.directionLightList=new Map,this.pointLightList=new Map,this.shadowBuffer=new Map,this.shadowLights=new Map}static createBuffer(e){var t,n;this.shadowBuffer.has(e)||((t=new Aie(20)).visibility=GPUShaderStage.FRAGMENT,this.shadowBuffer.set(e,t),t.setInt32("nDirShadowStart",0),t.setInt32("nDirShadowEnd",1),t.setInt32("nPointShadowStart",0),t.setInt32("nPointShadowEnd",0),n=new Uint32Array(16),this.shadowLights.set(e,n),t.setUint32Array("shadowLights",n),t.apply())}static getShadowLightList(e){if(!e.transform.view3D)return null;if(e.lightData.lightType==eae.DirectionLight){let t=this.directionLightList.get(e.transform.view3D.scene);return t||(t=[],this.directionLightList.set(e.transform.view3D.scene,t)),t}if(e.lightData.lightType==eae.PointLight){let t=this.pointLightList.get(e.transform.view3D.scene);return t||(t=[],this.pointLightList.set(e.transform.view3D.scene,t)),t}if(e.lightData.lightType==eae.SpotLight){let t=this.pointLightList.get(e.transform.view3D.scene);return t||(t=[],this.pointLightList.set(e.transform.view3D.scene,t)),t}}static getShadowLightWhichScene(e,t){if(t==eae.DirectionLight){let t=this.directionLightList.get(e);return t||(t=[],this.directionLightList.set(e,t)),t}if(t==eae.PointLight){let t=this.pointLightList.get(e);return t||(t=[],this.pointLightList.set(e,t)),t}}static getDirectShadowLightWhichScene(e){let t=this.directionLightList.get(e);return t||(t=[],this.directionLightList.set(e,t)),t}static getPointShadowLightWhichScene(e){let t=this.pointLightList.get(e);return t||(t=[],this.pointLightList.set(e,t)),t}static addShadowLight(e){if(!e.transform.view3D)return null;var t=e.transform.view3D.scene;if(e.lightData.lightType==eae.DirectionLight){let n=this.directionLightList.get(t);return n||(n=[],this.directionLightList.set(t,n)),e.shadowCamera||(e.shadowCamera=xae.createCamera3DObject(null,"shadowCamera"),e.shadowCamera.name=Rie(),e.shadowCamera.isShadowCamera=!0,e.shadowCamera.orthoOffCenter(nce.setting.shadow.shadowBound,-nce.setting.shadow.shadowBound,nce.setting.shadow.shadowBound,-nce.setting.shadow.shadowBound,1,5e4)),-1==n.indexOf(e)&&(n.length<8&&(e.lightData.castShadowIndex=n.length),n.push(e)),n}if(e.lightData.lightType==eae.PointLight||e.lightData.lightType==eae.SpotLight){let n=this.pointLightList.get(t);return n||(n=[],this.pointLightList.set(t,n)),-1==n.indexOf(e)&&(n.length<8&&(e.lightData.castShadowIndex=n.length),n.push(e)),n}}static removeShadowLight(e){var t,n;return e.transform.view3D?e.lightData.lightType==eae.DirectionLight?((n=this.directionLightList.get(e.transform.view3D.scene))&&-1!=(t=n.indexOf(e))&&n.splice(t,1),n):e.lightData.lightType==eae.PointLight||e.lightData.lightType==eae.SpotLight?((t=this.pointLightList.get(e.transform.view3D.scene))&&-1!=(n=t.indexOf(e))&&t.splice(n,1),t):void 0:null}static update(e){let t=this.shadowBuffer.get(e),n=this.shadowLights.get(e),r=wae.directionLightList.get(e),i=wae.pointLightList.get(e),a=0,s=0,o=0;if(n.fill(-1),r){for(let e=0;e<r.length;e++){var l=r[e];n[e]=l.lightData.index}a=r.length}if(t.setInt32("nDirShadowStart",0),t.setInt32("nDirShadowEnd",a),i){for(let e=s=a;e<i.length;e++){var u=i[e];n[e]=u.lightData.index}o=s+i.length}t.setInt32("nPointShadowStart",s),t.setInt32("nPointShadowEnd",o),t.setUint32Array("shadowLights",n),t.apply()}};let Sae=wae;bre(Sae,"maxNumDirectionShadow",8),bre(Sae,"maxNumPointShadow",8),bre(Sae,"directionLightList"),bre(Sae,"pointLightList"),bre(Sae,"shadowBuffer"),bre(Sae,"shadowLights");class Cae{static getGlobalDataBindGroupLayout(){var e;return this._globalDataBindGroupLayout||((e=[]).push({binding:0,visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT|GPUShaderStage.COMPUTE,buffer:{type:"uniform"}}),e.push({binding:1,visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT|GPUShaderStage.COMPUTE,buffer:{type:"read-only-storage"}}),this._globalDataBindGroupLayout=Dre.device.createBindGroupLayout({entries:e})),this._globalDataBindGroupLayout}}bre(Cae,"_globalDataBindGroupLayout");class Tae{constructor(e){bre(this,"uuid"),bre(this,"usage"),bre(this,"globalBindGroup"),bre(this,"uniformGPUBuffer"),bre(this,"matrixBindGroup"),bre(this,"uniformByteLength"),bre(this,"matrixesByteLength"),this.uuid=Rie(),this.usage=GPUBufferUsage.UNIFORM|GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST,this.uniformGPUBuffer=new Pie(688),this.uniformGPUBuffer.visibility=GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT|GPUShaderStage.COMPUTE,this.matrixBindGroup=e,this.createBindGroup()}createBindGroup(){this.uniformByteLength=this.uniformGPUBuffer.memory.shareDataBuffer.byteLength,this.matrixesByteLength=Kie.blockBytes*Kie.maxCount,this.globalBindGroup=Dre.device.createBindGroup({label:"global_bindGroupLayout",layout:Cae.getGlobalDataBindGroupLayout(),entries:[{binding:0,resource:{buffer:this.uniformGPUBuffer.buffer,offset:0,size:this.uniformByteLength}},{binding:1,resource:{buffer:this.matrixBindGroup.matrixBufferDst.buffer,offset:0,size:this.matrixesByteLength}}]})}setCamera(e){e.transform.updateWorldMatrix(!0),this.uniformGPUBuffer.setMatrix("_projectionMatrix",e.projectionMatrix),this.uniformGPUBuffer.setMatrix("_viewMatrix",e.viewMatrix),this.uniformGPUBuffer.setMatrix("_cameraWorldMatrix",e.transform.worldMatrix),this.uniformGPUBuffer.setMatrix("_projectionMatrixInv",e.projectionMatrixInv);var t=new Float32Array(128);for(let a=0;a<8;a++){var n=Sae.getDirectShadowLightWhichScene(e.transform.scene3D);a<n.length?(n=n[a].shadowCamera.pvMatrix.rawData,t.set(n,16*a)):t.set(e.transform.worldMatrix.rawData,16*a)}this.uniformGPUBuffer.setFloat32Array("_shadowCamera",t),this.uniformGPUBuffer.setVector3("CameraPos",e.transform.worldPosition),this.uniformGPUBuffer.setFloat("Time.frame",Sre.frame),this.uniformGPUBuffer.setFloat("Time.time",Sre.frame),this.uniformGPUBuffer.setFloat("Time.detail",Sre.delta),this.uniformGPUBuffer.setFloat("EngineSetting.Shadow.shadowBias",nce.setting.shadow.shadowBias),this.uniformGPUBuffer.setFloat("skyExposure",nce.setting.sky.skyExposure),this.uniformGPUBuffer.setFloat("EngineSetting.Render.renderPassState",nce.setting.render.renderPassState),this.uniformGPUBuffer.setFloat("EngineSetting.Render.quadScale",nce.setting.render.quadScale),this.uniformGPUBuffer.setFloat("EngineSetting.Render.hdrExposure",nce.setting.render.hdrExposure),this.uniformGPUBuffer.setInt32("renderState_left",nce.setting.render.renderState_left),this.uniformGPUBuffer.setInt32("renderState_right",nce.setting.render.renderState_right),this.uniformGPUBuffer.setFloat("renderState_split",nce.setting.render.renderState_split);var r=nce.inputSystem.mouseX*Dre.pixelRatio,i=nce.inputSystem.mouseY*Dre.pixelRatio;this.uniformGPUBuffer.setFloat("mouseX",r),this.uniformGPUBuffer.setFloat("mouseY",i),this.uniformGPUBuffer.setFloat("windowWidth",Dre.windowWidth),this.uniformGPUBuffer.setFloat("windowHeight",Dre.windowHeight),this.uniformGPUBuffer.setFloat("near",e.near),this.uniformGPUBuffer.setFloat("far",e.far),this.uniformGPUBuffer.setFloat("EngineSetting.Shadow.pointShadowBias",nce.setting.shadow.pointShadowBias),this.uniformGPUBuffer.setFloat("shadowMapSize",nce.setting.shadow.shadowSize),this.uniformGPUBuffer.setFloat("shadowSoft",nce.setting.shadow.shadowSoft),this.uniformGPUBuffer.apply()}setShadowCamera(e){e.transform.updateWorldMatrix(!0),this.uniformGPUBuffer.setMatrix("_projectionMatrix",e.projectionMatrix),this.uniformGPUBuffer.setMatrix("_viewMatrix",e.viewMatrix),this.uniformGPUBuffer.setMatrix("_pvMatrix",e.pvMatrix),this.uniformGPUBuffer.apply()}addUniformNode(){}}let Mae=new class{constructor(){bre(this,"_pool",[]),bre(this,"_worldPosition",new Rre),bre(this,"_viewPosition",new Rre),bre(this,"_zSortList",[])}pop(){return this._pool.pop()||{}}recycle(){for(var e of this._zSortList)e.z=0,e.userData=null,e.obj3d=null,this._pool.push(e);this._zSortList.length=0}sort(e,t,n,r){for(var i of(this._zSortList=[],t)){var a=this.pop();a.userData=i,a.obj3d=n(i),a.z=this.worldToCameraDepth(a.obj3d,e),this._zSortList.push(a)}for(var s of(this._zSortList.sort(((e,t)=>0<e.z-t.z?1:-1)),r=r||[],this._zSortList))r.push(s.userData);return this.recycle(),r}worldToCameraDepth(e,t){let n=0;return(t=t||e.transform.view3D.camera)&&(this._worldPosition.copyFrom(e.transform.worldPosition),t.worldToScreenPoint(this._worldPosition,this._viewPosition),n=this._viewPosition.z),n}},Eae=`\n#include "WorldMatrixUniform"\n#include "GlobalUniform"\n\nstruct VertexOutput {\n    @location(0) fragUV: vec2<f32>,\n    @builtin(position) member: vec4<f32>\n};\n\n#if USE_MORPHTARGETS\n    ${Bre.getMorphTargetShaderBinding(2,1)}\n#endif\n\n#if USE_SKELETON\n    ${Nre.groupBindingAndFunctions(2,1)} \n#endif\n\nvar<private> worldMatrix: mat4x4<f32>;\n\nstruct VertexAttributes{\n  @builtin(instance_index) index : u32,\n  @location(0) position: vec3<f32>,\n  @location(1) normal: vec3<f32>,\n  @location(2) uv: vec2<f32>,\n  @location(3) TEXCOORD_1: vec2<f32>,\n\n  #if USE_TANGENT\n      @location(4) TANGENT: vec4<f32>,\n      #if USE_SKELETON\n          @location(5) joints0: vec4<f32>,\n          @location(6) weights0: vec4<f32>,\n          #if USE_JOINT_VEC8\n          @location(7) joints1: vec4<f32>,\n          @location(8) weights1: vec4<f32>,\n      #endif\n      #elseif USE_MORPHTARGETS\n          ${Bre.getMorphTargetAttr(5)}\n      #endif\n  #elseif USE_SKELETON\n      @location(4) joints0: vec4<f32>,\n      @location(5) weights0: vec4<f32>,\n      #if USE_JOINT_VEC8\n      @location(6) joints1: vec4<f32>,\n      @location(7) weights1: vec4<f32>,\n      #endif\n  #elseif USE_MORPHTARGETS\n     ${Bre.getMorphTargetAttr(4)}\n  #endif\n}\n\n@vertex\nfn main(vertex:VertexAttributes) -> VertexOutput {\n    worldMatrix = models.matrix[vertex.index];\n    let shadowMatrix: mat4x4<f32> = globalUniform.projMat * globalUniform.viewMat ;\n    var vertexPosition = vertex.position.xyz;\n    var vertexNormal = vertex.normal.xyz;\n\n    #if USE_MORPHTARGETS\n     ${Bre.getMorphTargetCalcVertex()}    \n    #endif\n\n    #if USE_SKELETON\n        #if USE_JOINT_VEC8\n          worldMatrix *= getSkeletonWorldMatrix_8(vertex.joints0, vertex.weights0, vertex.joints1, vertex.weights1);\n        #else\n          worldMatrix *= getSkeletonWorldMatrix_4(vertex.joints0, vertex.weights0);\n        #endif\n    #endif\n\n    var worldPos = worldMatrix * vec4<f32>(vertexPosition, 1.0) ;\n    var vPos = shadowMatrix * worldPos;\n    return VertexOutput(vertex.uv, vPos );  \n}\n`,Aae=`\n#include "WorldMatrixUniform"\n#include "GlobalUniform"\n\nstruct VertexOutput {\n    @location(0) fragUV: vec2<f32>,\n    @location(1) worldPos: vec3<f32>,\n    @builtin(position) member: vec4<f32>\n};\n\n#if USE_MORPHTARGETS\n    ${Bre.getMorphTargetShaderBinding(2,1)}\n##endif\n \n#if USE_SKELETON\n    ${Nre.groupBindingAndFunctions(2,1)} \n#endif\n\nvar<private> worldMatrix: mat4x4<f32>;\n\nstruct VertexAttributes{\n  @builtin(instance_index) index : u32,\n  @location(0) position: vec3<f32>,\n  @location(1) normal: vec3<f32>,\n  @location(2) uv: vec2<f32>,\n  @location(3) TEXCOORD_1: vec2<f32>,\n\n  #if USE_TANGENT\n      @location(4) TANGENT: vec4<f32>,\n      #if USE_SKELETON\n          @location(5) joints0: vec4<f32>,\n          @location(6) weights0: vec4<f32>,\n          #if USE_JOINT_VEC8\n          @location(7) joints1: vec4<f32>,\n          @location(8) weights1: vec4<f32>,\n      #endif\n      #elseif USE_MORPHTARGETS\n         ${Bre.getMorphTargetAttr(5)}\n      #endif\n  #elseif USE_SKELETON\n      @location(4) joints0: vec4<f32>,\n      @location(5) weights0: vec4<f32>,\n      #if USE_JOINT_VEC8\n      @location(6) joints1: vec4<f32>,\n      @location(7) weights1: vec4<f32>,\n      #endif\n  #elseif USE_MORPHTARGETS\n      ${Bre.getMorphTargetAttr(4)}\n  #endif\n}\n\n@vertex\nfn main(vertex:VertexAttributes) -> VertexOutput {\n    worldMatrix = models.matrix[vertex.index];\n    let shadowMatrix: mat4x4<f32> = globalUniform.projMat * globalUniform.viewMat ;\n    var vertexPosition = vertex.position.xyz;\n\n    #if USE_MORPHTARGETS\n        ${Bre.getMorphTargetCalcVertex()}\n    #endif\n\n    #if USE_SKELETON\n        #if USE_JOINT_VEC8\n          worldMatrix *= getSkeletonWorldMatrix_8(vertex.joints0, vertex.weights0, vertex.joints1, vertex.weights1);\n        #else\n          worldMatrix *= getSkeletonWorldMatrix_4(vertex.joints0, vertex.weights0);\n        #endif\n    #endif\n\n    var worldPos = worldMatrix * vec4<f32>(vertexPosition, 1.0) ;\n    var vPos = shadowMatrix * worldPos;\n    return VertexOutput(vertex.uv, worldPos.xyz , vPos ); \n}\n`,Pae="\n#if USE_ALPHACUT\n@group(1) @binding(0)\nvar baseMapSampler: sampler;\n@group(1) @binding(1)\nvar baseMap: texture_2d<f32>;\n#endif\n\nstruct FragmentOutput {\n  @location(0) o_Target: vec4<f32>,\n  @builtin(frag_depth) out_depth: f32\n};\n\nstruct MaterialUniform {\nlightWorldPos: vec3<f32>,\ncameraFar: f32,\n};\n\n@group(2) @binding(0)\nvar<uniform> materialUniform: MaterialUniform;\n\n@fragment\nfn main(@location(0) fragUV: vec2<f32> , @location(1) worldPos:vec3<f32> ) -> FragmentOutput {\nvar distance = length(worldPos.xyz - materialUniform.lightWorldPos ) ;\ndistance = distance / materialUniform.cameraFar ;\n\n#if USE_ALPHACUT\n  let Albedo = textureSample(baseMap,baseMapSampler,fragUV);\n  var fragOut:FragmentOutput; \n  if(Albedo.w > 0.5){\n    fragOut = FragmentOutput(vec4<f32>(0.0),distance);\n  }\n//   if(Albedo.w > 0.5){\n//     fragOut = FragmentOutput(vec4<f32>(0.0),distance);\n//   }else{\n//     discard;\n//   }\n  return fragOut ;\n#else\n    fragOut = FragmentOutput(vec4<f32>(0.0),distance);\n#endif\n}\n";const Rae=class{static getMipmapPipeline(e){let t,n=e.format,r=Dre.device,i=Rae.pipelineCache[e.format];return i||(t=r.createShaderModule({code:Rae.mipmapShader}),e=r.createBindGroupLayout({entries:[{binding:0,visibility:e.visibility,sampler:e.samplerBindingLayout},{binding:1,visibility:e.visibility,texture:e.textureBindingLayout}]}),e=Dre.device.createPipelineLayout({bindGroupLayouts:[e]}),i=roe.createPipeline({layout:e,vertex:{module:t,entryPoint:"vertexMain"},fragment:{module:t,entryPoint:"fragmentMain",targets:[{format:n}]}}),Rae.pipelineCache[n]=i),i}static webGPUGenerateMipmap(e){var t,n=Dre.device,r=e.textureDescriptor;Rae.pipeline||(t=n.createShaderModule({code:"\n        var<private> pos : array<vec2<f32>, 4> = array<vec2<f32>, 4>(\n          vec2<f32>(-1.0, 1.0), vec2<f32>(1.0, 1.0),\n          vec2<f32>(-1.0, -1.0), vec2<f32>(1.0, -1.0));\n\n        struct VertexOutput {\n          @builtin(position) position : vec4<f32>,\n          @location(0) texCoord : vec2<f32>\n        };\n\n        @vertex\n        fn vertexMain(@builtin(vertex_index) vertexIndex : u32) -> VertexOutput {\n          var output : VertexOutput;\n          output.texCoord = pos[vertexIndex] * vec2<f32>(0.5, -0.5) + vec2<f32>(0.5);\n          output.position = vec4<f32>(pos[vertexIndex], 0.0, 1.0);\n          return output;\n        }\n\n        @binding(0) @group(0) var imgSampler : sampler;\n        @binding(1) @group(0) var img : texture_2d<f32>;\n\n        @fragment\n        fn fragmentMain(@location(0) texCoord : vec2<f32>) -> @location(0) vec4<f32> {\n          var outColor: vec4<f32> = textureSample(img, imgSampler, texCoord);\n          return outColor;\n        }\n      "}),Rae.pipeline=n.createRenderPipeline({layout:"auto",vertex:{module:t,entryPoint:"vertexMain"},fragment:{module:t,entryPoint:"fragmentMain",targets:[{format:r.format}]},primitive:{topology:"triangle-strip",stripIndexFormat:"uint32"}}));let i,a=(i="rgba16float"==e.format?n.createSampler({minFilter:"nearest",magFilter:"linear"}):n.createSampler({minFilter:"linear",magFilter:"linear"}),e.getGPUTexture().createView({baseMipLevel:0,mipLevelCount:1}));var s=roe.beginCommandEncoder();for(let c=1;c<r.mipLevelCount;++c){var o=e.getGPUTexture().createView({baseMipLevel:c,mipLevelCount:1}),l=s.beginRenderPass({colorAttachments:[{view:o,clearValue:[0,0,0,0],loadOp:"clear",storeOp:"store"}]}),u=n.createBindGroup({layout:Rae.pipeline.getBindGroupLayout(0),entries:[{binding:0,resource:i},{binding:1,resource:a}]});l.setPipeline(Rae.pipeline),l.setBindGroup(0,u),l.draw(4),l.end(),a=o}roe.endCommandEncoder(s)}};let Lae=Rae;bre(Lae,"mipmapShader","\n    var<private> pos : array<vec2<f32>, 3> = array<vec2<f32>, 3>(\n        vec2<f32>(-1.0, -1.0), vec2<f32>(-1.0, 3.0), vec2<f32>(3.0, -1.0));\n      struct VertexOutput {\n        @builtin(position) position : vec4<f32>;\n        @location(0) texCoord : vec2<f32>;\n      };\n      @vertex\n      fn vertexMain(@builtin(vertex_index) vertexIndex : u32) -> VertexOutput {\n        var output : VertexOutput;\n        output.texCoord = pos[vertexIndex] * vec2<f32>(0.5, -0.5) + vec2<f32>(0.5);\n        output.position = vec4<f32>(pos[vertexIndex], 0.0, 1.0);\n        return output;\n      }\n      @binding(0) @group(0) var imgSampler : sampler;\n      @binding(1) @group(0) var img : texture_2d<f32>;\n      @fragment\n      fn fragmentMain(@location(0) texCoord : vec2<f32>) -> @location(0) vec4<f32> {\n        var outColor: vec4<f32> = textureSample(img, imgSampler, texCoord);\n        return outColor ;\n      }"),bre(Lae,"pipelineCache",{}),bre(Lae,"pipeline");class kae{constructor(e=32,t=32,n=1){bre(this,"name"),bre(this,"url"),bre(this,"gpuTexture"),bre(this,"pid"),bre(this,"view"),bre(this,"gpuSampler"),bre(this,"gpuSampler_comparison"),bre(this,"format"),bre(this,"usage"),bre(this,"width",4),bre(this,"height",4),bre(this,"depthOrArrayLayers",1),bre(this,"numberLayer",1),bre(this,"viewDescriptor"),bre(this,"textureDescriptor"),bre(this,"visibility",GPUShaderStage.COMPUTE|GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT),bre(this,"textureBindingLayout",{viewDimension:"2d",multisampled:!1}),bre(this,"samplerBindingLayout",{type:"filtering"}),bre(this,"sampler_comparisonBindingLayout",{type:"comparison"}),bre(this,"flipY"),bre(this,"isVideoTexture"),bre(this,"isHDRTexture"),bre(this,"_useMipmap",!1),bre(this,"_sourceImageData"),bre(this,"_addressModeU"),bre(this,"_addressModeV"),bre(this,"_addressModeW"),bre(this,"_magFilter"),bre(this,"_minFilter"),bre(this,"_mipmapFilter"),bre(this,"_lodMinClamp"),bre(this,"_lodMaxClamp"),bre(this,"_compare"),bre(this,"_maxAnisotropy"),bre(this,"mipmapCount",1),bre(this,"_textureChange",!1),bre(this,"_stateChangeRef",new Map),this.width=e,this.height=t,this.numberLayer=n,this.minFilter="linear",this.magFilter="linear",this.mipmapFilter="linear",this.addressModeU=Zre,this.addressModeV=Zre,this.visibility=GPUShaderStage.FRAGMENT}init(){var e=this;return e.internalCreateBindingLayoutDesc&&e.internalCreateBindingLayoutDesc(),e.internalCreateTexture&&e.internalCreateTexture(),e.internalCreateView&&e.internalCreateView(),e.internalCreateSampler&&e.internalCreateSampler(),this}createTextureDescriptor(e,t,n,r,i=GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.COPY_SRC|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.STORAGE_BINDING,a=1,s=0){this.width=e,this.height=t,this.format=r,this.usage=i,this.textureDescriptor={size:[e,t,a],mipLevelCount:n,format:r,usage:i,label:""+(this.name+this.width+this.height+this.format)},0<s&&(this.textureDescriptor.sampleCount=s),this.viewDescriptor=1<a?{dimension:"2d-array"}:{dimension:this.textureBindingLayout.viewDimension}}generate(e){let t=32,n=32;"width"in e&&(t=e.width,n=e.height),(t<32||n<32)&&console.log(e.name+"Size must be greater than 32!"),this.width=t,this.height=n,this.visibility=GPUShaderStage.FRAGMENT,this.createTexture(e)}createTexture(e){this._sourceImageData=e,this.updateTextureDescription(),this.updateGPUTexture(),e=Dre.device,this.gpuTexture instanceof GPUTexture&&e.queue.copyExternalImageToTexture({source:this._sourceImageData},{texture:this.gpuTexture},[this.width,this.height]),this.useMipmap&&Lae.webGPUGenerateMipmap(this)}get useMipmap(){return this._useMipmap}set useMipmap(e){var t;e?(this.samplerBindingLayout.type="filtering",0==this._useMipmap&&this._sourceImageData&&(this._useMipmap=!0,this.updateTextureDescription(),this.updateGPUTexture(),t=Dre.device,this.gpuTexture instanceof GPUTexture&&t.queue.copyExternalImageToTexture({source:this._sourceImageData},{texture:this.gpuTexture},[this.width,this.height]),Lae.webGPUGenerateMipmap(this))):(this.samplerBindingLayout.type="non-filtering",1==this._useMipmap&&this._sourceImageData&&(this._useMipmap=!1,this.updateTextureDescription(),this.updateGPUTexture(),t=Dre.device,this.gpuTexture instanceof GPUTexture)&&t.queue.copyExternalImageToTexture({source:this._sourceImageData},{texture:this.gpuTexture},[this.width,this.height])),this._textureChange=!0,this._useMipmap=e,this.noticeChange()}updateTextureDescription(){this.mipmapCount=Math.floor(this.useMipmap?Math.log2(Math.min(this.width,this.height)):1),this.createTextureDescriptor(this.width,this.height,this.mipmapCount,this.format)}updateGPUTexture(){this.gpuTexture&&this.gpuTexture instanceof GPUTexture&&this.gpuTexture.destroy(),this.gpuTexture=null,this.view=null,this.gpuTexture=this.getGPUTexture()}getGPUTexture(){return this.gpuTexture||(this.gpuTexture=Dre.device.createTexture(this.textureDescriptor)),this.gpuTexture}getGPUView(e=0){return this.view||(this.gpuTexture=this.getGPUTexture(),this.gpuTexture instanceof GPUTexture&&(this.view=this.gpuTexture.createView(this.viewDescriptor))),this.view}bindStateChange(e,t){this._stateChangeRef.set(t,e)}unBindStateChange(e){this._stateChangeRef.delete(e)}noticeChange(){this.gpuSampler=Dre.device.createSampler(this),this._stateChangeRef.forEach(((e,t)=>{e()}))}destroy(e){e&&this.gpuTexture instanceof GPUTexture&&(this.gpuSampler=null,this.gpuSampler_comparison=null,this.textureBindingLayout=null,this.textureDescriptor=null,this.gpuTexture.destroy(),this.gpuTexture=null),this._stateChangeRef.clear()}get addressModeU(){return this._addressModeU}set addressModeU(e){this._addressModeU!=e&&(this._addressModeU=e,this.noticeChange())}get addressModeV(){return this._addressModeV}set addressModeV(e){this._addressModeV!=e&&(this._addressModeV=e,this.noticeChange())}get addressModeW(){return this._addressModeW}set addressModeW(e){this._addressModeW!=e&&(this._addressModeW=e,this.noticeChange())}get magFilter(){return this._magFilter}set magFilter(e){this._magFilter!=e&&(this._magFilter=e,this.noticeChange())}get minFilter(){return this._minFilter}set minFilter(e){this._minFilter!=e&&(this._minFilter=e,this.noticeChange())}get mipmapFilter(){return this._mipmapFilter}set mipmapFilter(e){this._mipmapFilter!=e&&(this._mipmapFilter=e,this.noticeChange())}get lodMinClamp(){return this._lodMinClamp}set lodMinClamp(e){this._lodMinClamp!=e&&(this._lodMinClamp=e,this.noticeChange())}get lodMaxClamp(){return this._lodMaxClamp}set lodMaxClamp(e){this._lodMaxClamp!=e&&(this._lodMaxClamp=e,this.noticeChange())}get compare(){return this._compare}set compare(e){this._compare!=e&&(this._compare=e,this.noticeChange())}get maxAnisotropy(){return this._maxAnisotropy}set maxAnisotropy(e){this._maxAnisotropy!=e&&(this._maxAnisotropy=e,this.noticeChange())}}class Dae extends kae{constructor(e,t,n){super(e,t,n),bre(this,"_bitmapTextures"),this.visibility=GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT|GPUShaderStage.COMPUTE,this.format=oie,this.mipmapCount=1,this._bitmapTextures=[],this.init()}setTextures(e){for(let n=this._bitmapTextures.length=0;n<e.length;n++){var t=e[n];this.addTexture(t)}}addTexture(e){e.width==this.width&&e.height==this.height||console.error("bitmap texture muse match bitmapTextureArray size!"),-1==this._bitmapTextures.indexOf(e)&&(e.pid=this._bitmapTextures.length,this._bitmapTextures.push(e),this.updateTexture())}removeTexture(e){if(-1!=(e=this._bitmapTextures.indexOf(e))){this._bitmapTextures.splice(e,1);for(let e=0;e<this._bitmapTextures.length;e++)this._bitmapTextures[e].pid=e}}updateTexture(){var e=roe.beginCommandEncoder();for(let n=0;n<this._bitmapTextures.length;n++){var t=this._bitmapTextures[n];e.copyTextureToTexture({texture:t.getGPUTexture(),mipLevel:0,origin:{x:0,y:0,z:0}},{texture:this.getGPUTexture(),mipLevel:0,origin:{x:0,y:0,z:n}},{width:this.width,height:this.height,depthOrArrayLayers:1})}roe.endCommandEncoder(e)}internalCreateBindingLayoutDesc(){this.textureBindingLayout.viewDimension="2d-array",this.samplerBindingLayout.type="filtering",this.minFilter=iie,this.magFilter=iie}internalCreateTexture(){this.textureDescriptor={format:this.format,size:{width:this.width,height:this.height,depthOrArrayLayers:this.numberLayer},dimension:"2d",usage:GPUTextureUsage.COPY_DST|GPUTextureUsage.TEXTURE_BINDING},this.gpuTexture=Dre.device.createTexture(this.textureDescriptor)}internalCreateView(){this.viewDescriptor={dimension:"2d-array"},this.view=this.gpuTexture.createView(this.viewDescriptor)}internalCreateSampler(){this.gpuSampler=Dre.device.createSampler(this)}}const Iae=class{constructor(){bre(this,"_iesTexture"),bre(this,"index",0)}generateIES(e){}set IESTexture(e){(this._iesTexture=e).addressModeU=Zre,e.addressModeV=Zre,e.addressModeW=Zre,-1==Iae.ies_list.indexOf(this)&&(this.index=Iae.ies_list.length,Iae.ies_list.push(this),Iae.iesTexture||Iae.create(e.width,e.height),Iae.iesTexture.addTexture(e))}get IESTexture(){return this._iesTexture}static create(e,t){this.iesTexture=new Dae(e,t,48)}};let Oae=Iae;bre(Oae,"use",!1),bre(Oae,"iesTexture"),bre(Oae,"ies_list",[]);var Nae=(e=>(e.position="position",e.normal="normal",e.uv="uv",e.TANGENT="TANGENT",e.TEXCOORD_1="TEXCOORD_1",e.TEXCOORD_2="TEXCOORD_2",e.color="color",e.joints0="joints0",e.joints1="joints1",e.weights0="weights0",e.weights1="weights1",e.indices="indices",e.vIndex="vIndex",e.a_morphPositions_0="a_morphPositions_0",e))(Nae||{}),Bae=(e=>(e[e.NONE=0]="NONE",e[e.ABOVE=1]="ABOVE",e[e.ALPHA=2]="ALPHA",e[e.NORMAL=3]="NORMAL",e[e.ADD=4]="ADD",e[e.BELOW=5]="BELOW",e[e.ERASE=6]="ERASE",e[e.MUL=7]="MUL",e[e.SCREEN=8]="SCREEN",e[e.DIVD=9]="DIVD",e[e.SOFT_ADD=10]="SOFT_ADD",e))(Bae||{}),Uae=(e=>(e[e.src_a=0]="src_a",e[e.dest_a=1]="dest_a",e))(Uae||{});class zae{static getBlend(e){var t={color:{srcFactor:"src-alpha",dstFactor:"one"},alpha:{srcFactor:"one",dstFactor:"one"}};switch(e){case 0:t.color.srcFactor="one",t.color.dstFactor="zero",t.color.operation="add";break;case 1:t.color.srcFactor="one-minus-src-alpha",t.color.dstFactor="dst-alpha",t.color.operation="add";break;case 4:t.color.srcFactor="one",t.color.dstFactor="one",t.color.operation="add",t.alpha.srcFactor="one",t.alpha.dstFactor="one",t.alpha.operation="add";break;case 2:t.color.srcFactor="src-alpha",t.color.dstFactor="one-minus-src-alpha";break;case 5:t.color.srcFactor="one-minus-src-alpha",t.color.dstFactor="one",t.color.operation="add";break;case 6:t.color.srcFactor="zero",t.color.dstFactor="one-minus-src-alpha",t.color.operation="add";break;case 7:t.color.srcFactor="dst",t.color.dstFactor="one-minus-src-alpha",t.color.operation="add";break;case 3:t.color.srcFactor="one",t.color.dstFactor="one-minus-src-alpha",t.color.operation="add";break;case 10:t.color.srcFactor="one",t.color.dstFactor="one",t.color.operation="max",t.alpha.srcFactor="one",t.alpha.dstFactor="one",t.alpha.operation="add";break;case 8:t.color.srcFactor="one",t.color.dstFactor="one-minus-src",t.color.operation="add"}return t}}class Fae{constructor(e=0,t="\0"){bre(this,"Type",0),bre(this,"Line",0),bre(this,"Colume",0),bre(this,"Literal",""),this.Type=e,this.Literal=t}isTypeEqual(e){return this.Type==e}isLiteralEqual(e){return this.Literal==e}isBuiltinType(){return 33<this.Type&&this.Type<101}isDataType(){return 1==this.Type||this.isBuiltinType()}isOperation(){return 102<this.Type&&this.Type<127}isAssignOperation(){return 128<this.Type&&this.Type<133}get nOperationPriorityLevel(){switch(this.Type){case 26:case 27:return 1;case 125:return 2;case 110:case 114:return 3;case 105:case 106:return 4;case 103:case 104:return 5;case 115:case 116:return 6;case 119:case 120:case 122:case 123:return 7;case 121:case 124:return 8;case 111:return 9;case 113:return 10;case 112:return 11;case 107:return 12;case 109:return 13;case 108:return 14;case 24:return 15;case 126:case 129:case 130:case 131:case 132:return 16}return 99}}var Vae=(e=>(e[e.EOF=0]="EOF",e[e.IDENT=1]="IDENT",e[e.VOID=2]="VOID",e[e.CONST=3]="CONST",e[e.LAYOUT=4]="LAYOUT",e[e.PRECISION=5]="PRECISION",e[e.ATTRIBUTE=6]="ATTRIBUTE",e[e.UNIFORM=7]="UNIFORM",e[e.VARYING=8]="VARYING",e[e.INVARIANT=9]="INVARIANT",e[e.IN=10]="IN",e[e.OUT=11]="OUT",e[e.INOUT=12]="INOUT",e[e.IF=13]="IF",e[e.ELSE=14]="ELSE",e[e.FOR=15]="FOR",e[e.WHILE=16]="WHILE",e[e.DO=17]="DO",e[e.BREAK=18]="BREAK",e[e.RETURN=19]="RETURN",e[e.CONTINUE=20]="CONTINUE",e[e.STRUCT=21]="STRUCT",e[e.COMMA=22]="COMMA",e[e.COLON=23]="COLON",e[e.QUEMARK=24]="QUEMARK",e[e.SEMICOLON=25]="SEMICOLON",e[e.LEFTSAMLL=26]="LEFTSAMLL",e[e.RIGHTSAMLL=27]="RIGHTSAMLL",e[e.LEFTMEDI=28]="LEFTMEDI",e[e.RIGHTMEDI=29]="RIGHTMEDI",e[e.LEFTBIG=30]="LEFTBIG",e[e.RIGHTBIG=31]="RIGHTBIG",e[e.LITERAL=32]="LITERAL",e[e.BeginBuiltinType=33]="BeginBuiltinType",e[e.INT=34]="INT",e[e.INT_ARRAY=35]="INT_ARRAY",e[e.UINT=36]="UINT",e[e.UINT_ARRAY=37]="UINT_ARRAY",e[e.BOOL=38]="BOOL",e[e.BOOL_ARRAY=39]="BOOL_ARRAY",e[e.FLOAT=40]="FLOAT",e[e.FLOAT_ARRAY=41]="FLOAT_ARRAY",e[e.DOUBLE=42]="DOUBLE",e[e.DOUBLE_ARRAY=43]="DOUBLE_ARRAY",e[e.VEC2=44]="VEC2",e[e.VEC2_ARRAY=45]="VEC2_ARRAY",e[e.VEC3=46]="VEC3",e[e.VEC3_ARRAY=47]="VEC3_ARRAY",e[e.VEC4=48]="VEC4",e[e.VEC4_ARRAY=49]="VEC4_ARRAY",e[e.BVEC2=50]="BVEC2",e[e.BVEC2_ARRAY=51]="BVEC2_ARRAY",e[e.BVEC3=52]="BVEC3",e[e.BVEC3_ARRAY=53]="BVEC3_ARRAY",e[e.BVEC4=54]="BVEC4",e[e.BVEC4_ARRAY=55]="BVEC4_ARRAY",e[e.IVEC2=56]="IVEC2",e[e.IVEC2_ARRAY=57]="IVEC2_ARRAY",e[e.IVEC3=58]="IVEC3",e[e.IVEC3_ARRAY=59]="IVEC3_ARRAY",e[e.IVEC4=60]="IVEC4",e[e.IVEC4_ARRAY=61]="IVEC4_ARRAY",e[e.UVEC2=62]="UVEC2",e[e.UVEC2_ARRAY=63]="UVEC2_ARRAY",e[e.UVEC3=64]="UVEC3",e[e.UVEC3_ARRAY=65]="UVEC3_ARRAY",e[e.UVEC4=66]="UVEC4",e[e.UVEC4_ARRAY=67]="UVEC4_ARRAY",e[e.MAT2x2=68]="MAT2x2",e[e.MAT2x2_ARRAY=69]="MAT2x2_ARRAY",e[e.MAT2x3=70]="MAT2x3",e[e.MAT2x3_ARRAY=71]="MAT2x3_ARRAY",e[e.MAT2x4=72]="MAT2x4",e[e.MAT2x4_ARRAY=73]="MAT2x4_ARRAY",e[e.MAT3x2=74]="MAT3x2",e[e.MAT3x2_ARRAY=75]="MAT3x2_ARRAY",e[e.MAT3x3=76]="MAT3x3",e[e.MAT3x3_ARRAY=77]="MAT3x3_ARRAY",e[e.MAT3x4=78]="MAT3x4",e[e.MAT3x4_ARRAY=79]="MAT3x4_ARRAY",e[e.MAT4x2=80]="MAT4x2",e[e.MAT4x2_ARRAY=81]="MAT4x2_ARRAY",e[e.MAT4x3=82]="MAT4x3",e[e.MAT4x3_ARRAY=83]="MAT4x3_ARRAY",e[e.MAT4x4=84]="MAT4x4",e[e.MAT4x4_ARRAY=85]="MAT4x4_ARRAY",e[e.SAMPLER=86]="SAMPLER",e[e.SAMPLER_1D=87]="SAMPLER_1D",e[e.SAMPLER_2D=88]="SAMPLER_2D",e[e.SAMPLER_3D=89]="SAMPLER_3D",e[e.SAMPLER_CUBE=90]="SAMPLER_CUBE",e[e.SAMPLER_SHADOW=91]="SAMPLER_SHADOW",e[e.SAMPLER_1D_SHADOW=92]="SAMPLER_1D_SHADOW",e[e.SAMPLER_2D_SHADOW=93]="SAMPLER_2D_SHADOW",e[e.TEXTURE_1D=94]="TEXTURE_1D",e[e.TEXTURE_1D_ARRAY=95]="TEXTURE_1D_ARRAY",e[e.TEXTURE_2D=96]="TEXTURE_2D",e[e.TEXTURE_2D_ARRAY=97]="TEXTURE_2D_ARRAY",e[e.TEXTURE_3D=98]="TEXTURE_3D",e[e.TEXTURE_CUBE=99]="TEXTURE_CUBE",e[e.TEXTURE_CUBE_ARRAY=100]="TEXTURE_CUBE_ARRAY",e[e.EndBuiltinType=101]="EndBuiltinType",e[e.BeginOperation=102]="BeginOperation",e[e.ADD=103]="ADD",e[e.SUB=104]="SUB",e[e.MUL=105]="MUL",e[e.DIV=106]="DIV",e[e.AND=107]="AND",e[e.OR=108]="OR",e[e.XOR=109]="XOR",e[e.NOT=110]="NOT",e[e.BITAND=111]="BITAND",e[e.BITOR=112]="BITOR",e[e.BITXOR=113]="BITXOR",e[e.BITNOT=114]="BITNOT",e[e.BITSHIFT_L=115]="BITSHIFT_L",e[e.BITSHIFT_R=116]="BITSHIFT_R",e[e.INC=117]="INC",e[e.DEC=118]="DEC",e[e.GREATER=119]="GREATER",e[e.GREATEREQUAL=120]="GREATEREQUAL",e[e.EQUAL=121]="EQUAL",e[e.LESS=122]="LESS",e[e.LESSEQUAL=123]="LESSEQUAL",e[e.NOTEQUAL=124]="NOTEQUAL",e[e.DOT=125]="DOT",e[e.ASSIGN=126]="ASSIGN",e[e.EndOperation=127]="EndOperation",e[e.BeginAssignOperation=128]="BeginAssignOperation",e[e.ADDASSIGN=129]="ADDASSIGN",e[e.SUBASSIGN=130]="SUBASSIGN",e[e.MULASSIGN=131]="MULASSIGN",e[e.DIVASSIGN=132]="DIVASSIGN",e[e.EndAssignOperation=133]="EndAssignOperation",e))(Vae||{});class Gae{constructor(e){bre(this,"_char"),bre(this,"_line"),bre(this,"_column"),bre(this,"_source"),bre(this,"_currPosition"),bre(this,"_nextPosition"),this.reset(e)}reset(e){this._char="",this._line=0,this._column=0,this._source=e,this._currPosition=0,this._nextPosition=0}get source(){return this._source}getChar(){return this._char}get currPosition(){return this._currPosition}peekChar(){return this._nextPosition>=this._source.length?"\0":this._source[this._nextPosition]}readChar(){this._char=this._nextPosition>=this._source.length?"\0":this._source[this._nextPosition],"\n"!==this._char?this._column++:(this._line++,this._column=0),this._currPosition=this._nextPosition,this._nextPosition++}readCharAndSkipWhitespace(){this.readChar(),this.skipWhitespace()}readIdentifier(){for(var e=this._currPosition;this.isIdentifier(this._char);)this.readChar();return this._source.substring(e,this._currPosition)}isIdentifier(e){return 97<=(e=e.charCodeAt(0))&&e<=122||65<=e&&e<=90||48<=e&&e<=57||95==e}skipWhitespace(){for(;this.IsWhitespace(this._char);)this.readChar()}IsWhitespace(e){return" "===e||"\t"===e||"\r"===e||"\n"===e}skipComment(){for(;"\n"!==this._char&&"\0"!==this._char;)this.readChar();this.skipWhitespace()}skipMultilineComment(){if("/"===this._char||"*"===this.peekChar()){this.readChar(),this.readChar();for(let e=1;0<e&&"\0"!==this._char;)this.readChar(),"/"!==this._char||"*"!==this.peekChar()?"*"!==this._char||"/"!==this.peekChar()||(e--,this.readChar()):(e++,this.readChar());this.readChar(),this.readChar(),this.skipWhitespace()}}isDigit(e){return 48<=(e=e.charCodeAt(0))&&e<=57}readNumber(){for(var e=this._currPosition;this.isDigit(this._char);)this.readChar();if("."===this._char)for(this.readChar();this.isDigit(this._char);)this.readChar();return this._source.substring(e,this._currPosition)}readValue(){return this.isDigit(this._char)?this.readNumber():this.readIdentifier()}readLine(){var e=this._currPosition,t=this._source.indexOf("\n",this._currPosition);return-1==t&&(t=this._source.length),this._line++,this._column=0,this._currPosition=t,this._nextPosition=t+1,this._source.substring(e,t+1)}}class Hae extends Gae{constructor(e){super(e.source),bre(this,"_tokenPosition",0),bre(this,"_tokens",[]),this.parse()}skipToken(e){this._tokenPosition+=e}peekToken(e){return this._tokenPosition+e>=this._tokens.length?new Fae(Vae.EOF,"\0"):this._tokens[this._tokenPosition+e]}GetNextToken(){var e;return this._tokenPosition>=this._tokens.length?new Fae(Vae.EOF,"\0"):(e=this._tokens[this._tokenPosition],this._tokenPosition++,e)}get currTokenPosition(){return this._tokenPosition}parse(){var e;for(this.readChar(),this._tokens=new Array;e=this.nextToken(),this._tokens.push(e),e.Type!=Vae.EOF;);}nextToken(){if(this.skipWhitespace(),"/"===this._char){if("/"===this.peekChar())return this.skipComment(),this.nextToken();if("*"===this.peekChar())return this.skipMultilineComment(),this.nextToken()}var e=new Fae;switch(e.Line=this._line,e.Colume=this._column,this._char){case"\0":e.Type=Vae.EOF,e.Literal="EOF";break;case".":e.Type=Vae.DOT,e.Literal=".";break;case",":e.Type=Vae.COMMA,e.Literal=",";break;case":":e.Type=Vae.COLON,e.Literal=":";break;case"?":e.Type=Vae.QUEMARK,e.Literal="?";break;case";":e.Type=Vae.SEMICOLON,e.Literal=";";break;case"(":e.Type=Vae.LEFTSAMLL,e.Literal="(";break;case")":e.Type=Vae.RIGHTSAMLL,e.Literal=")";break;case"[":e.Type=Vae.LEFTMEDI,e.Literal="[";break;case"]":e.Type=Vae.RIGHTMEDI,e.Literal="]";break;case"{":e.Type=Vae.LEFTBIG,e.Literal="{";break;case"}":e.Type=Vae.RIGHTBIG,e.Literal="}";break;case"+":"+"===this.peekChar()?(this.readChar(),e.Type=Vae.INC,e.Literal="++"):"="===this.peekChar()?(this.readChar(),e.Type=Vae.ADDASSIGN,e.Literal="+="):(e.Type=Vae.ADD,e.Literal="+");break;case"-":"-"===this.peekChar()?(this.readChar(),e.Type=Vae.DEC,e.Literal="--"):"="===this.peekChar()?(this.readChar(),e.Type=Vae.SUBASSIGN,e.Literal="-="):(e.Type=Vae.SUB,e.Literal="-");break;case"*":"="===this.peekChar()?(this.readChar(),e.Type=Vae.MULASSIGN,e.Literal="*="):(e.Type=Vae.MUL,e.Literal="*");break;case"/":"="===this.peekChar()?(this.readChar(),e.Type=Vae.DIVASSIGN,e.Literal="/="):(e.Type=Vae.DIV,e.Literal="/");break;case"&":"&"===this.peekChar()?(this.readChar(),e.Type=Vae.AND,e.Literal="&&"):(e.Type=Vae.BITAND,e.Literal="&");break;case"|":"|"===this.peekChar()?(this.readChar(),e.Type=Vae.OR,e.Literal="||"):(e.Type=Vae.BITOR,e.Literal="&");break;case"^":e.Type=Vae.BITXOR,e.Literal="^";break;case"!":"="===this.peekChar()?(this.readChar(),e.Type=Vae.NOTEQUAL,e.Literal="!="):(e.Type=Vae.NOT,e.Literal="!");break;case">":"="===this.peekChar()?(this.readChar(),e.Type=Vae.GREATEREQUAL,e.Literal=">="):">"===this.peekChar()?(this.readChar(),e.Type=Vae.BITSHIFT_R,e.Literal=">>"):(e.Type=Vae.GREATER,e.Literal=">");break;case"=":"="===this.peekChar()?(this.readChar(),e.Type=Vae.EQUAL,e.Literal="=="):(e.Type=Vae.ASSIGN,e.Literal="=");break;case"<":"="===this.peekChar()?(this.readChar(),e.Type=Vae.LESSEQUAL,e.Literal="<="):"<"===this.peekChar()?(this.readChar(),e.Type=Vae.BITSHIFT_L,e.Literal="<<"):(e.Type=Vae.LESS,e.Literal="<");break;default:return this.isDigit(this._char)?this.readDecimal():(e.Literal=this.readIdentifier(),e.Type=this.lookupIdentifier(e.Literal),"["==this.getChar()&&"]"==this.peekChar()&&e.isBuiltinType()&&(e.Type++,e.Literal+="[]",this.readChar(),this.readChar()),e)}return this.readChar(),e}readDecimal(){var e=new Fae,t=(e.Line=this._line,e.Colume=this._column,e.Type=Vae.LITERAL,this.readNumber());return"e"===this._char?(e.Literal=t+this._char,this.readChar(),e.Literal+=this._char,this.readChar(),e.Literal+=this.readNumber(),e.Type=Vae.LITERAL):"u"===this._char?(this.readChar(),e.Type=Vae.LITERAL,e.Literal=t+"u"):"f"===this._char?(this.readChar(),e.Type=Vae.LITERAL,e.Literal=t+"f"):(e.Type=Vae.LITERAL,e.Literal=t),e}lookupIdentifier(e){switch(e){case"void":return Vae.VOID;case"int":return Vae.INT;case"uint":return Vae.UINT;case"bool":case"true":case"false":return Vae.BOOL;case"float":return Vae.FLOAT;case"vec2":return Vae.VEC2;case"vec3":return Vae.VEC3;case"vec4":return Vae.VEC4;case"bvec2":return Vae.BVEC2;case"bvec3":return Vae.BVEC3;case"bvec4":return Vae.BVEC4;case"ivec2":return Vae.IVEC2;case"ivec3":return Vae.IVEC3;case"ivec4":return Vae.IVEC4;case"uvec2":return Vae.UVEC2;case"uvec3":return Vae.UVEC3;case"uvec4":return Vae.UVEC4;case"mat2":case"mat2x2":return Vae.MAT2x2;case"mat2x3":return Vae.MAT2x3;case"mat2x4":return Vae.MAT2x4;case"mat3":case"mat3x3":return Vae.MAT3x3;case"mat3x2":return Vae.MAT3x2;case"mat3x4":return Vae.MAT3x4;case"mat4":case"mat4x4":return Vae.MAT4x4;case"mat4x2":return Vae.MAT4x2;case"mat4x3":return Vae.MAT4x3;case"sampler":return Vae.SAMPLER;case"sampler1D":return Vae.SAMPLER_1D;case"sampler2D":return Vae.SAMPLER_2D;case"sampler3D":return Vae.SAMPLER_3D;case"samplerCube":return Vae.SAMPLER_CUBE;case"samplerShadow":return Vae.SAMPLER_SHADOW;case"sampler1DShadow":return Vae.SAMPLER_1D_SHADOW;case"sampler2DShadow":return Vae.SAMPLER_2D_SHADOW;case"texture1D":return Vae.TEXTURE_1D;case"texture2D":return Vae.TEXTURE_2D;case"texture3D":return Vae.TEXTURE_3D;case"textureCube":return Vae.TEXTURE_CUBE;case"texture1DArray":return Vae.TEXTURE_1D_ARRAY;case"texture2DArray":return Vae.TEXTURE_2D_ARRAY;case"textureCubeArray":return Vae.TEXTURE_CUBE_ARRAY;case"const":return Vae.CONST;case"layout":return Vae.LAYOUT;case"precision":return Vae.PRECISION;case"attribute":return Vae.ATTRIBUTE;case"uniform":return Vae.UNIFORM;case"varying":return Vae.VARYING;case"invariant":return Vae.INVARIANT;case"in":return Vae.IN;case"out":return Vae.OUT;case"inout":return Vae.INOUT;case"if":return Vae.IF;case"else":return Vae.ELSE;case"for":return Vae.FOR;case"while":return Vae.WHILE;case"do":return Vae.DO;case"break":return Vae.BREAK;case"return":return Vae.RETURN;case"continue":return Vae.CONTINUE;case"struct":return Vae.STRUCT}return Vae.IDENT}}class jae{constructor(){bre(this,"name",""),bre(this,"value",""),bre(this,"args",[])}}class Wae extends Gae{constructor(e){super(e),bre(this,"_result"),bre(this,"_skipLine"),bre(this,"_definitionTables"),this._result="",this._skipLine=!1,this._definitionTables=new Map,this.parse()}parse(){for(this.readChar();"\0"!==this._char;){if(this.skipWhitespace(),"/"===this._char){if("/"===this.peekChar()){this.skipComment();continue}if("*"===this.peekChar()){this.skipMultilineComment();continue}}if("#"===this._char){this.readCharAndSkipWhitespace();var e=this.readIdentifier();switch(e){case"version":this.readLine().trim();break;case"define":this.readCharAndSkipWhitespace();var t=this.readIdentifier();if("("===this.getChar()){var n=new jae;if(this.readCharAndSkipWhitespace(),")"!==this.getChar())do{var r=this.readIdentifier()}while(n.args.push(r),this.skipWhitespace(),","===this.getChar()&&this.readCharAndSkipWhitespace(),")"!==this.getChar());this.readCharAndSkipWhitespace(),n.name=t,n.value=this.readLine().trim(),this._definitionTables.set(t,n),this.readCharAndSkipWhitespace()}else{let e=this.readLine().trim();"="==e[0]&&(e=e.substring(1)),this._definitionTables.set(t,e)}break;case"if":"0"==(t=this.readLine().trim())||"false"==t?this._skipLine=!0:!this._definitionTables.has(t)||"0"!=(t=this._definitionTables.get(t))&&"false"!=t||(this._skipLine=!0);break;case"ifdef":this.readCharAndSkipWhitespace();var i=this.readIdentifier();this._skipLine=!this._definitionTables.has(i);break;case"else":this._skipLine=!this._skipLine;break;case"endif":this._skipLine=!1;break;default:throw"Unknown preprocessing command:"+e}}else{var a=this.readLine();if(!this._skipLine){for(var s of this._definitionTables.keys()){var o=a.indexOf(s);if(-1!=o){var l=this._definitionTables.get(s);if("string"==typeof l)a=a.replace(s,l);else{var u=l,c=new Gae(a.substring(o+s.length));if(c.readCharAndSkipWhitespace(),"("===c.getChar()){c.readCharAndSkipWhitespace();for(let e=1;"\0"!==c.getChar()&&0<e;){switch(c.getChar()){case"(":e++;break;case")":e--}c.readCharAndSkipWhitespace()}}if(l=o+s.length+c.currPosition,s=a.substring(o,l).trim(),0<u.args.length){let e=[],t=s.substring(s.indexOf("(")+1,s.lastIndexOf(")")).trim(),n=(0<t.length&&(e=this.parseArgs(t)),u.value.substring(u.value.indexOf("(")));for(let r=0;r<u.args.length;r++)n=n.replace(u.args[r],e[r]);n=u.value.substring(0,u.value.indexOf("("))+n,a=a.replace(s,n)}else a=a.replace(s,u.value)}}}this._result+=a}this.readChar()}}}get source(){return this._result}parseArgs(e){let t=[],n=0,r=new Gae(e),i=r.currPosition;if(r.readCharAndSkipWhitespace(),"\0"!==r.getChar())for(r.readCharAndSkipWhitespace();"\0"!==r.getChar();){switch(r.getChar()){case"(":n++;break;case")":n--;break;case",":var a;0==n&&(a=e.substring(i,r.currPosition),t.push(a),i=r.currPosition+1)}r.readCharAndSkipWhitespace()}var s;return i<r.currPosition&&(s=e.substring(i,r.currPosition),t.push(s)),t}}class Yae{constructor(e){bre(this,"result"),bre(this,"ASTRoot"),bre(this,"_syntax"),this.result="",this._syntax=e,this.ASTRoot=e.ASTRoot}generateWGSL(){var e,t,n,r,i,a,s=new $ae,o=new Sse,l=[],u=[],c=[];for(e of this.ASTRoot.nodes)if(e instanceof vse)if("in"==e.scope)if(e.nodes[0]instanceof Qae){s.layoutsIn.push(e);var d=new wse;d.name=e.nodes[0].name,d.type=e.nodes[0].type,d.locationID=Number.parseInt(e.qualifier.get("location")),o.inputAttribute.push(d)}else{if(!e.qualifier.has("local_size_x"))throw"not impl";s.workGroupSize=e}else if("out"==e.scope){if(s.layoutsOut.push(e),!(e.nodes[0]instanceof Qae))throw"not impl";(d=new wse).name=e.nodes[0].name,d.type=e.nodes[0].type,d.locationID=Number.parseInt(e.qualifier.get("location")),o.outputAttribute.push(d)}else if("uniform"==e.scope)if(u.push(e),e.nodes[0]instanceof Qae){var h=new xse;h.name=e.nodes[0].name,h.type=e.nodes[0].type,h.setID=Number.parseInt(e.qualifier.get("set")),h.bindingID=Number.parseInt(e.qualifier.get("binding")),o.uniformInfo.push(h)}else{if(!(e.nodes[0]instanceof qae))throw"not impl";(h=new xse).name="unif"+o.uniformInfo.length.toString(),h.type=e.nodes[0].name,h.setID=Number.parseInt(e.qualifier.get("set")),h.bindingID=Number.parseInt(e.qualifier.get("binding")),o.uniformInfo.push(h)}else"buffer"==e.scope&&l.push(e);else c.push(e);s.stage="fragment";let p=0,f=new Gae(""),m=this._syntax.lexer.source,g=new Map;for(;-1!=(p=m.indexOf("gl_",p));){f.reset(m.substring(p,p+32)),f.readChar();var v=f.readIdentifier();if(p+=v.length,!g.has(v))switch(g.set(v,v),v){case"gl_InstanceID":s.stage="vertex",s.builtinIn.push("@builtin(instance_index) gl_InstanceID: u32");break;case"gl_Position":s.stage="vertex",s.builtinOut.push("@builtin(position) gl_Position: vec4<f32>"),s.addIdentifier("gl_Position","stout.gl_Position");break;case"gl_VertexIndex":s.stage="vertex",s.builtinIn.push("@builtin(vertex_index) gl_VertexIndex: u32");break;case"gl_FrontFacing":s.stage="fragment",s.builtinIn.push("@builtin(front_facing) gl_FrontFacing: bool");break;case"gl_FragDepth":s.stage="fragment",s.builtinOut.push("@builtin(frag_depth) gl_FragDepth: f32"),s.addIdentifier("gl_FragDepth","stout.gl_FragDepth");break;case"gl_WorkGroupID":s.stage="compute",s.builtinIn.push("@builtin(workgroup_id) gl_WorkGroupID: vec3<u32>");break;case"gl_NumWorkGroups":s.stage="compute",s.builtinIn.push("@builtin(num_workgroups) gl_NumWorkGroups: vec3<u32>");break;case"gl_LocalInvocationID":s.stage="compute",s.builtinIn.push("@builtin(local_invocation_id) gl_LocalInvocationID: vec3<u32>");break;case"gl_LocalInvocationIndex":s.stage="compute",s.builtinIn.push("@builtin(local_invocation_index) gl_LocalInvocationIndex: u32");break;case"gl_GlobalInvocationID":s.stage="compute",s.builtinIn.push("@builtin(global_invocation_id) gl_GlobalInvocationID: vec3<u32>");break;default:throw"Unprocessed built-in variables: "+v}}for(t of u)t.nodes[0]instanceof qae&&(o.sourceCode+=t.nodes[0].formatToWGSL(s,0),o.sourceCode+="\r\n");for(n of u)o.sourceCode+=n.formatToWGSL(s,0);for(r of(o.sourceCode+="\r\n",l))r.nodes[0]instanceof qae&&(o.sourceCode+=r.nodes[0].formatToWGSL(s,0),o.sourceCode+="\r\n");for(i of l)o.sourceCode+=i.formatToWGSL(s,0);for(a of(o.sourceCode+="\r\n",c))o.sourceCode+=a.formatToWGSL(s,0),a instanceof Qae&&(o.sourceCode+=";\r\n");return o}}class $ae{constructor(e){bre(this,"_stage","fragment"),bre(this,"_builtinIn",[]),bre(this,"_builtinOut",[]),bre(this,"_layoutsIn",[]),bre(this,"_layoutsOut",[]),bre(this,"_layoutUniformCount",0),bre(this,"_workGroupSize"),bre(this,"_parentContext"),bre(this,"_identifierEnv",new Map),this._parentContext=e}get stage(){return null!=this.parentContext?this.parentContext.stage:this._stage}set stage(e){null!=this.parentContext&&(this.parentContext.stage=e),this._stage=e}get builtinIn(){return null!=this.parentContext?this.parentContext.builtinIn:this._builtinIn}get builtinOut(){return null!=this.parentContext?this.parentContext.builtinOut:this._builtinOut}get layoutsIn(){return null!=this.parentContext?this.parentContext.layoutsIn:this._layoutsIn}get layoutsOut(){return null!=this.parentContext?this.parentContext.layoutsOut:this._layoutsOut}get layoutUniformCount(){return null!=this.parentContext?this.parentContext.layoutUniformCount:this._layoutUniformCount}set layoutUniformCount(e){null!=this.parentContext?this.parentContext.layoutUniformCount=e:this._layoutUniformCount=e}get workGroupSize(){return null!=this.parentContext?this.parentContext.workGroupSize:this._workGroupSize}set workGroupSize(e){null!=this.parentContext&&(this.parentContext.workGroupSize=e),this._workGroupSize=e}get parentContext(){return this._parentContext}findIdentifier(e){return this._identifierEnv.has(e)?this._identifierEnv.get(e):null!=this._parentContext?this._parentContext.findIdentifier(e):e}addIdentifier(e,t){this._identifierEnv.set(e,t)}hasIdentifier(e){return this._identifierEnv.has(e)}}class Xae{constructor(){bre(this,"nodes",[])}addNode(e){this.nodes.push(e)}formatToWGSL(e,t){return""}}class qae extends Xae{constructor(e){super(),bre(this,"name",""),bre(this,"fields",[]),this.name=e}static parse(e){if(e.peekToken(0).Type!=Vae.IDENT||e.peekToken(1).Type!=Vae.LEFTBIG)throw"Error parsing structure: Unexpected character";var t=new qae(e.peekToken(0).Literal);for(e.skipToken(2);e.peekToken(0).Type!=Vae.RIGHTBIG;){var n=Qae.parse(e);t.fields.push(n)}return e.peekToken(0).Type==Vae.RIGHTBIG&&e.skipToken(1),e.peekToken(0).Type==Vae.SEMICOLON&&e.skipToken(1),t}formatToWGSL(e,t){let n="",r=t<=0?"":"    ".repeat(t);for(var i of(n+=r+"struct "+this.name+" {\r\n",this.fields))i.arraySize.nodes.length<=0?n+=r+"  "+i.name+": "+yse(i.type)+",\r\n":i.arraySize.nodes[0]instanceof sse?n+=r+"  "+i.name+": array<"+yse(i.type)+", "+i.arraySize.nodes[0].value+">,\r\n":n+=r+"  "+i.name+": array<"+yse(i.type)+", "+i.arraySize.nodes[0].formatToWGSL(e,0)+">,\r\n";return n+(r+"};\r\n")}}class Kae extends Xae{constructor(e,t,n,r){super(),bre(this,"name"),bre(this,"args"),bre(this,"body"),bre(this,"returnType"),this.name=e,this.args=t,this.body=n,this.returnType=r}static parse(e){if(!e.peekToken(0).isBuiltinType()&&e.peekToken(0).Type!=Vae.VOID||e.peekToken(1).Type!=Vae.IDENT||e.peekToken(2).Type!=Vae.LEFTSAMLL)throw"Error parsing function: Unexpected character";var t=e.peekToken(0).Literal,n=e.peekToken(1).Literal,r=(e.skipToken(2),new Array);if(e.peekToken(0).Type!=Vae.LEFTSAMLL)throw"Error parsing function parameter list: Unexpected character";for(e.skipToken(1);e.peekToken(0).Type!=Vae.EOF;){if(e.peekToken(0).Type==Vae.RIGHTSAMLL){e.skipToken(1);break}e.peekToken(0).Type!=Vae.INOUT&&e.peekToken(0).Type!=Vae.IN&&e.peekToken(0).Type!=Vae.OUT||e.skipToken(1);var i=Qae.parse(e);r.push(i),e.peekToken(0).Type==Vae.COMMA&&e.skipToken(1)}var a=mse.parse(e);return new Kae(n,r,a,t)}formatToWGSL(e,t){let n,r="",i=t<=0?"":"    ".repeat(t),a=0<e.layoutsOut.length||0<e.builtinOut.length;switch(e.stage){case"compute":n="ComputeOutput";break;case"vertex":n="VertexOutput";break;case"fragment":n="FragmentOutput";break;default:n="StructOutput"}if("main"==this.name&&a){for(var s of(r+="struct "+n+" {\r\n",e.layoutsOut)){var o;s.nodes[0]instanceof Qae&&(o=s.nodes[0],1==s.qualifier.size&&s.qualifier.has("location")&&(r+="  @location("+s.qualifier.get("location")+") "),r+=o.name+": "+yse(o.type)+",\r\n",e.addIdentifier(o.name,"stout."+o.name))}var l;for(l of e.builtinOut)r+="  "+l+",\r\n";r+="};\r\n\r\n"}let u="";if("main"==this.name&&(null!=e.workGroupSize?u+="@"+e.stage+" "+e.workGroupSize.formatToWGSL(e,0)+" \r\n":u+="@"+e.stage+"\r\n"),e=new $ae(e),u+=i+"fn "+this.name+"(","main"!=this.name){for(let t=0;t<this.args.length;t++){var c=this.args[t];0<t&&(u+=", "),u+=c.name+": "+yse(c.type),e.addIdentifier(c.name,c.name)}u+=") -> "+yse(this.returnType)}else{var d,h=e.layoutsIn;for(let t=0;t<h.length;t++){var p,f=h[t];u+=0<t?",\r\n    ":"\r\n    ",f.nodes[0]instanceof Qae&&(p=f.nodes[0],1==f.qualifier.size&&f.qualifier.has("location")&&(u+="@location("+f.qualifier.get("location")+") "),u+=p.name+": "+yse(p.type),e.addIdentifier(p.name,p.name))}for(d of(0<h.length&&(u+=",\r\n    "),e.builtinIn))u+=d+",\r\n    ";u+=a?") -> "+n:") "}let m="";for(var g of("main"==this.name&&a&&(m+="    var stout: "+n+" ;\r\n"),this.body.nodes))m+=g.formatToWGSL(e,t+1),g instanceof nse||g instanceof tse||g instanceof ese||(m+=";\r\n");return"main"==this.name&&a&&(m+="    return stout;\r\n"),(r=(r+=u+" {\r\n")+m)+i+"}\r\n\r\n"}}class Zae extends Xae{constructor(){super(),bre(this,"args",[])}static parse(e){if(e.peekToken(0).Type!=Vae.LEFTSAMLL)throw"Error parsing function argument table: Unexpected character";e.skipToken(1);for(var t=new Zae;e.peekToken(0).Type!=Vae.EOF;){if(e.peekToken(0).Type==Vae.RIGHTSAMLL){e.skipToken(1);break}var n=rse.parse(e);t.args.push(n),e.peekToken(0).Type==Vae.COMMA&&e.skipToken(1)}return t}}class Jae extends Xae{constructor(e,t){super(),bre(this,"name"),bre(this,"args"),this.name=e,this.args=t}static parse(e){var t;if(e.peekToken(0).isDataType()&&e.peekToken(1).Type==Vae.LEFTSAMLL)return t=e.peekToken(0).Literal,e.skipToken(1),e=Zae.parse(e),new Jae(t,e);throw"Error parsing function argument table: Unexpected character"}formatToWGSL(e,t){let n="",r=t<=0?"":"    ".repeat(t);if("texture"==this.name&&this.args.args[0].nodes[0]instanceof Jae){var i=this.args.args[0].nodes[0];if("sampler2D"==i.name){n+=r+"textureSample(";for(let t=0;t<i.args.args.length;t++){0<t&&(n+=", "),n+=i.args.args[t].formatToWGSL(e,0)}for(let t=1;t<this.args.args.length;t++){0<t&&(n+=", "),n+=this.args.args[t].formatToWGSL(e,0)}return n+")"}}n+=r+yse(this.name)+"(";for(let a=0;a<this.args.args.length;a++){0<a&&(n+=", "),n+=this.args.args[a].formatToWGSL(e,0)}return n+")"}}class Qae extends Xae{constructor(e,t,n=new rse){super(),bre(this,"type"),bre(this,"name"),bre(this,"arraySize"),bre(this,"hasIn"),bre(this,"hasOut"),bre(this,"hasConst"),this.type=e,this.name=t,this.hasIn=!1,this.hasOut=!1,this.hasConst=!1,this.arraySize=n}static parse(e){let t=new Qae("",""),n=e.peekToken(0);if(n.Type==Vae.CONST)e.skipToken(1),t.hasConst=!0;else if(n.Type==Vae.IN)e.skipToken(1),t.hasIn=!0;else if(n.Type==Vae.OUT)e.skipToken(1),t.hasOut=!0;else if(n.Type==Vae.INOUT)e.skipToken(1),t.hasIn=!0,t.hasOut=!0;else if(!n.isDataType())throw"Error parsing declaration expression: Unexpected character("+n.Literal+")";if((n=e.peekToken(0)).isDataType()&&e.peekToken(1).Type==Vae.LEFTMEDI){if(t.type=n.Literal,e.skipToken(2),t.arraySize=rse.parse(e),e.peekToken(0).Type==Vae.RIGHTMEDI&&e.skipToken(1),e.peekToken(0).Type!=Vae.IDENT)throw"Unexpected";t.name=e.peekToken(0).Literal,e.skipToken(1)}else if(n.isDataType()&&e.peekToken(1).Type==Vae.IDENT&&e.peekToken(2).Type==Vae.LEFTMEDI)t.type=e.peekToken(0).Literal,t.name=e.peekToken(1).Literal,e.skipToken(3),e.peekToken(0).Type!=Vae.RIGHTMEDI&&(t.arraySize=rse.parse(e),e.peekToken(0).Type!=Vae.RIGHTMEDI)||e.skipToken(1);else{if(!n.isDataType()||e.peekToken(1).Type!=Vae.IDENT)throw"Error parsing declaration expression: Unexpected character("+n.Literal+")";t.type=e.peekToken(0).Literal,t.name=e.peekToken(1).Literal,e.skipToken(2)}var r,i,a;if((n=e.peekToken(0)).Type==Vae.SEMICOLON)e.skipToken(1);else if(n.Type!=Vae.RIGHTSAMLL)if(n.Type==Vae.ASSIGN)r=e.peekToken(0),e.skipToken(1),i=new ase(t.name),a=rse.parse(e),e.peekToken(0).Type==Vae.SEMICOLON&&e.skipToken(1),t.addNode(new dse(r,i,a));else{if(n.Type!=Vae.COMMA)throw"Error parsing declaration expression: Unexpected character("+e.peekToken(0).Literal+")";for(;e.peekToken(0).Type==Vae.COMMA&&e.peekToken(1).Type==Vae.IDENT;){var s=new Qae(t.type,e.peekToken(1).Literal);t.addNode(s),e.skipToken(2),e.peekToken(0).Type==Vae.ASSIGN&&(e.skipToken(-1),s.addNode(rse.parse(e)))}}return t}formatToWGSL(e,t){let n="",r=t<=0?"":"    ".repeat(t);if(this.hasConst?n+=r+"let ":n+=r+"var ",e.addIdentifier(this.name,this.name),this.arraySize.nodes.length<=0?n+=this.name+": "+yse(this.type):this.arraySize.nodes[0]instanceof sse?n+=this.name+": array<"+yse(this.type)+", "+this.arraySize.nodes[0].value+">":n+=this.name+": array<"+yse(this.type)+", "+this.arraySize.nodes[0].formatToWGSL(e,0)+">",0<this.nodes.length&&this.nodes[0]instanceof dse)n+=" = "+this.nodes[0].rightValue.formatToWGSL(e,0);else if(0<this.nodes.length&&this.nodes[0]instanceof rse&&this.nodes[0].nodes[0]instanceof dse)n+=" = "+this.nodes[0].nodes[0].rightValue.formatToWGSL(e,0);else if(0<this.nodes.length&&this.nodes[0]instanceof Qae)for(var i of(n+=";\r\n",this.nodes))n+=i.formatToWGSL(e,t)+";\r\n";else n+=";\r\n";return n}}class ese extends Xae{constructor(e,t,n,r){super(),bre(this,"expression1"),bre(this,"condition"),bre(this,"expression2"),bre(this,"loopBody"),this.expression1=e,this.condition=t,this.expression2=n,this.loopBody=r}static parse(e){if(e.peekToken(0).Type!=Vae.FOR||e.peekToken(1).Type!=Vae.LEFTSAMLL)throw"Error parsing for loop: Unexpected character";{let t,n,r,i;return e.skipToken(2),e.peekToken(0).Type==Vae.SEMICOLON?(e.skipToken(1),t=new rse):(e.peekToken(0).isDataType()&&e.peekToken(1).Type==Vae.IDENT&&e.peekToken(2).Type==Vae.ASSIGN?(t=new Qae(e.peekToken(0).Literal,e.peekToken(1).Literal),e.skipToken(1),t.addNode(rse.parse(e))):t=rse.parse(e),e.peekToken(0).Type==Vae.SEMICOLON&&e.skipToken(1)),e.peekToken(0).Type==Vae.SEMICOLON?(e.skipToken(1),n=new rse):(n=rse.parse(e),e.peekToken(0).Type==Vae.SEMICOLON&&e.skipToken(1)),e.peekToken(0).Type==Vae.SEMICOLON?(e.skipToken(1),r=new rse):(r=rse.parse(e),e.peekToken(0).Type==Vae.SEMICOLON&&e.skipToken(1)),e.peekToken(0).Type==Vae.RIGHTSAMLL&&e.skipToken(1),i=e.peekToken(0).Type==Vae.LEFTBIG?mse.parse(e):new mse,new ese(t,n,r,i)}}formatToWGSL(e,t){let n="",r=t<=0?"":"    ".repeat(t);for(var i of(n=(n=(n=(n+=r+"for (")+this.expression1.formatToWGSL(e,0)+"; ")+this.condition.formatToWGSL(e,0)+"; ")+this.expression2.formatToWGSL(e,0)+") { \r\n",this.loopBody.nodes))n+=i.formatToWGSL(e,t+1),i instanceof nse||i instanceof tse||i instanceof ese||(n+=";\r\n");return n+(r+"} \r\n")}}class tse extends Xae{constructor(e,t){super(),bre(this,"conditionExpr"),bre(this,"loopBody"),this.conditionExpr=e,this.loopBody=t}static parse(e){var t;if(e.peekToken(0).Type==Vae.WHILE)return e.skipToken(1),e.peekToken(0).Type==Vae.LEFTSAMLL&&e.skipToken(1),t=rse.parse(e),e.peekToken(0).Type==Vae.RIGHTSAMLL&&e.skipToken(1),e=mse.parse(e),new tse(t,e);throw"Error parsing while loop: Unexpected character"}formatToWGSL(e,t){let n="",r=t<=0?"":"    ".repeat(t);for(var i of(n=(n+=r+"loop {\r\n")+r+"    if ("+this.conditionExpr.formatToWGSL(e,0)+") { break; }\r\n\r\n",this.loopBody.nodes))n+=i.formatToWGSL(e,t+1),i instanceof nse||i instanceof tse||i instanceof ese||(n+=";\r\n");return n+(r+"}\r\n")}}class nse extends Xae{constructor(e,t,n){super(),bre(this,"conditionExpr"),bre(this,"trueBranch"),bre(this,"falseBranch"),this.conditionExpr=e,this.trueBranch=t,this.falseBranch=n}static parse(e){if(e.peekToken(0).Type!=Vae.IF)throw"Error parsing IF branch statement: Unexpected character";{e.skipToken(1),e.peekToken(0).Type==Vae.LEFTSAMLL&&e.skipToken(1);let t,n=rse.parse(e),r=new mse;if(e.peekToken(0).Type==Vae.RIGHTSAMLL&&e.skipToken(1),e.peekToken(0).Type==Vae.LEFTBIG?t=mse.parse(e):(t=new mse,e.peekToken(0).Type==Vae.RETURN?t.addNode(use.parse(e)):t.addNode(rse.parse(e))),e.peekToken(0).Type==Vae.ELSE){if(e.skipToken(1),e.peekToken(0).Type!=Vae.LEFTBIG)throw"not impl";r=mse.parse(e)}return new nse(n,t,r)}}formatToWGSL(e,t){let n="",r=t<=0?"":"    ".repeat(t);for(var i of(n+=r+"if ("+this.conditionExpr.formatToWGSL(e,0)+") {\r\n",this.trueBranch.nodes))n+=i.formatToWGSL(e,t+1)+";\r\n";if(0<this.falseBranch.nodes.length)for(var a of(n+=r+"} else {\r\n",this.falseBranch.nodes))n+=a.formatToWGSL(e,t+1)+";\r\n";return n+(r+"}\r\n")}}class rse extends Xae{constructor(){super()}static parse(e){let t=new Array,n=new Array,r=0;for(;e.peekToken(0).Type!=Vae.EOF;){var i,a,s,o=e.peekToken(0);if(o.Type==Vae.SEMICOLON||o.Type==Vae.RIGHTMEDI||o.Type==Vae.COMMA||o.Type==Vae.COLON||o.Type==Vae.RIGHTBIG)break;if(o.isOperation())o.isOperation()&&(o.Type==Vae.INC||o.Type==Vae.DEC?(i=o,e.skipToken(1),a=rse.parse(e),n.push(new cse(i,void 0,a))):(0<t.length&&(t[t.length-1].nOperationPriorityLevel<=o.nOperationPriorityLevel?rse.unionOperation(t,n):0<t.length&&"-"==t[t.length-1].Literal&&(i=t.pop(),a=n.pop(),n.push(new cse(i,void 0,a)))),t.push(o),e.skipToken(1)));else if(o.Type==Vae.LITERAL)n.push(new sse(o.Literal)),e.skipToken(1);else if(o.Type==Vae.LEFTSAMLL)r++,t.push(o),e.skipToken(1);else if(o.Type==Vae.RIGHTSAMLL){if(r<=0)break;for(r--;rse.unionOperation(t,n););t[t.length-1].Type==Vae.LEFTSAMLL&&(t.pop(),(s=new ise).addNode(n.pop()),n.push(s)),e.skipToken(1)}else if(o.Type==Vae.IDENT)e.peekToken(1).Type==Vae.INC||e.peekToken(1).Type==Vae.DEC?(s=e.peekToken(1),l=new ase(o.Literal),n.push(new cse(s,l,void 0)),e.skipToken(2)):e.peekToken(1).Type==Vae.LEFTSAMLL?n.push(Jae.parse(e)):e.peekToken(1).Type==Vae.DOT?n.push(pse.parse(e)):e.peekToken(1).Type!=Vae.LEFTMEDI?(n.push(new ase(o.Literal)),e.skipToken(1)):n.push(fse.parse(e));else if(o.isBuiltinType()&&e.peekToken(1).Type==Vae.LEFTSAMLL)n.push(Jae.parse(e));else if(o.isAssignOperation()){var l=o,u=(e.skipToken(1),n.pop()),c=rse.parse(e);n.push(new dse(l,u,c))}else if(o.Type==Vae.LEFTBIG&&(e.peekToken(1).Type==Vae.LITERAL||e.peekToken(1).Type==Vae.SUB&&e.peekToken(2).Type==Vae.LITERAL))n.push(ose.parse(e));else if(o.Type==Vae.QUEMARK){0<t.length&&t[t.length-1].nOperationPriorityLevel<=o.nOperationPriorityLevel&&rse.unionOperation(t,n),e.skipToken(1);u=n.pop(),c=rse.parse(e);var d=(e.peekToken(0).Type==Vae.COLON&&e.skipToken(1),rse.parse(e));if(n.push(new hse(u,c,d)),e.peekToken(-1).Type==Vae.SEMICOLON)break}else{if(o.Type!=Vae.LEFTMEDI)throw"An unexpected character";e.skipToken(1),d=rse.parse(e),e.peekToken(0).Type==Vae.RIGHTMEDI&&e.skipToken(1),o=n.pop(),n.push(new fse(o,d))}}for(;0<t.length&&rse.unionOperation(t,n););var h;if(t.length<=0&&1==n.length)return(h=new rse).addNode(n.pop()),h;throw"Error parsing expression: Unexpected character("+e.peekToken(0).Literal+")"}formatToWGSL(e,t){return this.nodes[0].formatToWGSL(e,t)}static unionOperation(e,t){var n,r;return e.length<0||t.length<2?0<e.length&&"-"==e[e.length-1].Literal&&(n=e.pop(),r=t.pop(),t.push(new cse(n,void 0,r)),!0):!!e[e.length-1].isOperation()&&(n=t.pop(),r=e.pop(),e=t.pop(),r.Type==Vae.DOT?t.push(new pse(e,n)):t.push(new dse(r,e,n)),!0)}}class ise extends Xae{constructor(){super()}formatToWGSL(e,t){return(t<=0?"":"    ".repeat(t))+"("+this.nodes[0].formatToWGSL(e,0)+")"}}class ase extends Xae{constructor(e){super(),bre(this,"name"),this.name=e}formatToWGSL(e,t){return(t<=0?"":"    ".repeat(t))+e.findIdentifier(this.name)}}class sse extends Xae{constructor(e){super(),bre(this,"value"),this.value=e}static parse(e){var t,n=e.peekToken(0);if(n.Type==Vae.SUB&&e.peekToken(1).Type==Vae.LITERAL)return t=new sse("-"+e.peekToken(1).Literal),e.skipToken(2),t;if(n.Type==Vae.LITERAL)return t=new sse(n.Literal),e.skipToken(1),t;throw"Error parsing literal constants: Unexpected characters("+n.Literal+")"}formatToWGSL(e,t){return(t<=0?"":"    ".repeat(t))+this.value}}class ose extends sse{constructor(e){super(""),bre(this,"arrayValue"),this.arrayValue=e}static parse(e){if(e.peekToken(0).Type==Vae.LEFTBIG&&e.peekToken(1).Type==Vae.LITERAL||e.peekToken(0).Type==Vae.LEFTBIG&&e.peekToken(1).Type==Vae.SUB&&e.peekToken(2).Type==Vae.LITERAL){e.skipToken(1);for(var t=[];e.peekToken(0).Type!=Vae.RIGHTBIG;)if(e.peekToken(0).Type==Vae.LEFTSAMLL)t.push(ose.parse(e));else{if(t.push(sse.parse(e)),e.peekToken(0).Type!=Vae.COMMA){if(e.peekToken(0).Type!=Vae.RIGHTBIG)throw"Error parsing array constants: Unexpected characters";e.skipToken(1);break}e.skipToken(1)}return new ose(t)}throw"Error parsing array constants: Unexpected characters"}formatToWGSL(e,t){let n="",r=t<=0?"":"    ".repeat(t);this.arrayValue[0].value.includes(".")?n+=r+"array<f32, "+this.arrayValue.length.toString()+">(":n+=r+"array<i32, "+this.arrayValue.length.toString()+">(";for(let i=0;i<this.arrayValue.length;i++)0<i&&(n+=", "),n+=this.arrayValue[i].formatToWGSL(e,0);return n+")"}}class lse extends Xae{constructor(){super()}static parse(e){if(e.peekToken(0).Type==Vae.CONTINUE&&e.peekToken(1).Type==Vae.SEMICOLON)return e.skipToken(2),new lse;throw"Error parsing continue: Unexpected character"}formatToWGSL(e,t){return""+((t<=0?"":"    ".repeat(t))+"continue")}}class use extends Xae{constructor(e){super(),bre(this,"value"),this.value=e}static parse(e){var t;if(e.peekToken(0).Type==Vae.RETURN)return e.skipToken(1),t=rse.parse(e),e.peekToken(0).Type==Vae.SEMICOLON&&e.skipToken(1),new use(t);throw"Error parsing return expression: Unexpected character"}formatToWGSL(e,t){return""+((t<=0?"":"    ".repeat(t))+"return ")+this.value.formatToWGSL(e,0)}}class cse extends Xae{constructor(e,t,n){super(),bre(this,"op"),bre(this,"leftValue"),bre(this,"rightValue"),this.op=e,this.leftValue=t,this.rightValue=n}formatToWGSL(e,t){let n="",r=t<=0?"":"    ".repeat(t);return"++"==this.op.Literal||"--"==this.op.Literal?null!=this.leftValue?n+=r+(t=this.leftValue.formatToWGSL(e,0))+" = "+t+" "+this.op.Literal[0]+" 1":n+=r+(t=this.rightValue.formatToWGSL(e,0))+" = "+t+" "+this.op.Literal[0]+" 1":null!=this.leftValue?n+=r+this.leftValue.formatToWGSL(e,0)+this.op.Literal:n+=r+this.op.Literal+this.rightValue.formatToWGSL(e,0),n}}class dse extends Xae{constructor(e,t,n){super(),bre(this,"op"),bre(this,"leftValue"),bre(this,"rightValue"),this.op=e,this.leftValue=t,this.rightValue=n}formatToWGSL(e,t){return""+((t<=0?"":"    ".repeat(t))+this.leftValue.formatToWGSL(e,0)+" ")+this.op.Literal+" "+this.rightValue.formatToWGSL(e,0)}}class hse extends Xae{constructor(e,t,n){super(),bre(this,"condition"),bre(this,"expression1"),bre(this,"expression2"),this.condition=e,this.expression1=t,this.expression2=n}static parse(e){throw"Error parsing ternary operation expression: Unexpected character"}formatToWGSL(e,t){return""}}class pse extends Xae{constructor(e,t){super(),bre(this,"leftValue"),bre(this,"rightValue"),this.leftValue=e,this.rightValue=t}static parse(e){var t,n;if(e.peekToken(0).Type==Vae.IDENT&&e.peekToken(1).Type==Vae.DOT&&e.peekToken(2).Type==Vae.IDENT)return t=new ase(e.peekToken(0).Literal),n=new ase(e.peekToken(2).Literal),e.skipToken(3),new pse(t,n);throw"Error parsing selection expression: Unexpected character"}formatToWGSL(e,t){return(t<=0?"":"    ".repeat(t))+this.leftValue.formatToWGSL(e,0)+"."+this.rightValue.formatToWGSL(e,0)}}class fse extends Xae{constructor(e,t){super(),bre(this,"leftValue"),bre(this,"indexValue"),this.leftValue=e,this.indexValue=t}static parse(e){if(e.peekToken(0).Type!=Vae.IDENT||e.peekToken(1).Type!=Vae.LEFTMEDI)throw"Error parsing index expression: Unexpected character";{var t=new ase(e.peekToken(0).Literal),n=(e.skipToken(2),rse.parse(e));e.peekToken(0).Type==Vae.RIGHTMEDI&&e.skipToken(1);let r=new fse(t,n);for(;e.peekToken(0).Type==Vae.LEFTMEDI;)e.skipToken(1),n=rse.parse(e),e.peekToken(0).Type==Vae.RIGHTMEDI&&e.skipToken(1),r=new fse(r,n);return r}}formatToWGSL(e,t){return(t<=0?"":"    ".repeat(t))+this.leftValue.formatToWGSL(e,0)+"["+this.indexValue.formatToWGSL(e,0)+"]"}}class mse extends Xae{constructor(){super()}static parse(e){if(e.peekToken(0).Type!=Vae.LEFTBIG)throw"Error parsing block: Unexpected symbol";e.skipToken(1);var t=new mse;for(let o=1;0<o&&e.peekToken(0).Type!=Vae.EOF;){var n=e.peekToken(0);if(n.Type==Vae.LEFTBIG)o++,e.skipToken(1);else if(n.Type==Vae.RIGHTBIG)o--,e.skipToken(1);else if(n.Type==Vae.SEMICOLON)e.skipToken(1);else if(n.isDataType()&&e.peekToken(1).Type==Vae.IDENT)t.addNode(Qae.parse(e));else if(n.Type==Vae.CONST&&e.peekToken(1).isDataType()&&e.peekToken(2).Type==Vae.IDENT)t.addNode(Qae.parse(e));else if(n.Type==Vae.IDENT&&e.peekToken(1).Type==Vae.ASSIGN)t.addNode(rse.parse(e)),e.peekToken(0).Type==Vae.SEMICOLON&&e.skipToken(1);else if(n.Type==Vae.IDENT&&e.peekToken(1).Type==Vae.LEFTMEDI){var r=fse.parse(e);e.peekToken(0).Type==Vae.ASSIGN?(i=e.peekToken(0),e.skipToken(1),a=rse.parse(e),e.peekToken(0).Type==Vae.RIGHTMEDI&&e.skipToken(1),t.addNode(new dse(i,r,a))):t.addNode(r)}else if(n.Type==Vae.IDENT&&e.peekToken(1).Type==Vae.DOT){var i=rse.parse(e);t.addNode(i)}else if(n.Type==Vae.IDENT&&e.peekToken(1).isAssignOperation()){var a=e.peekToken(1),s=(r=new ase(n.Literal),e.skipToken(2),rse.parse(e));e.peekToken(0).Type==Vae.SEMICOLON&&e.skipToken(1),t.addNode(new dse(a,r,s))}else if(n.Type!=Vae.IDENT||e.peekToken(1).Type!=Vae.INC&&e.peekToken(1).Type!=Vae.DEC||e.peekToken(2).Type!=Vae.SEMICOLON)if(n.Type==Vae.RETURN)t.addNode(use.parse(e));else if(n.Type==Vae.CONTINUE)t.addNode(lse.parse(e));else if(n.Type==Vae.WHILE)t.addNode(tse.parse(e));else if(n.Type==Vae.FOR)t.addNode(ese.parse(e));else if(n.Type==Vae.IF)t.addNode(nse.parse(e));else{if(n.Type!=Vae.IDENT||e.peekToken(1).Type!=Vae.LEFTSAMLL)throw"Error parsing block: Unexpected symbol("+n.Literal+")";t.addNode(Jae.parse(e)),e.peekToken(0).Type==Vae.SEMICOLON&&e.skipToken(0)}else s=e.peekToken(1),t.addNode(new cse(s,new ase(n.Literal),void 0)),e.skipToken(3)}return t}}class gse extends Xae{constructor(e,t){super(),bre(this,"type"),bre(this,"qualifier"),this.type=t,this.qualifier=e}static parse(e){var t;if(e.peekToken(0).Type==Vae.PRECISION&&e.peekToken(1).Type==Vae.IDENT&&e.peekToken(2).isBuiltinType())return t=new gse(e.peekToken(1).Literal,e.peekToken(2).Literal),e.skipToken(3),e.peekToken(0).Type==Vae.SEMICOLON&&e.skipToken(1),t;throw"Error parsing precision qualifier: Unexpected character"}formatToWGSL(e,t){return""}}class vse extends Xae{constructor(){super(),bre(this,"scope",""),bre(this,"qualifier",new Map)}addQualifier(e,t=""){this.qualifier.set(e,t)}static parse(e){if(e.peekToken(0).Type!=Vae.LAYOUT||e.peekToken(1).Type!=Vae.LEFTSAMLL)throw"Error parsing layout qualifier: Unexpected symbol";var t,n=new vse;e.skipToken(2);do{if(e.peekToken(0).Type==Vae.IDENT)if(e.peekToken(1).Type==Vae.ASSIGN&&e.peekToken(2).Type==Vae.LITERAL){var r=e.peekToken(0).Literal,i=e.peekToken(2).Literal;if(n.addQualifier(r,i),e.skipToken(3),e.peekToken(0).Type==Vae.COMMA){e.skipToken(1);continue}e.peekToken(0).Line=0}else{if(e.peekToken(1).Type==Vae.RIGHTSAMLL){r=e.peekToken(0).Literal,n.addQualifier(r,""),e.skipToken(1);break}if(e.peekToken(1).Type==Vae.COMMA){i=e.peekToken(0).Literal,n.addQualifier(i,""),e.skipToken(2);continue}}}while(e.peekToken(0).Type!=Vae.RIGHTSAMLL);if(e.peekToken(0).Type==Vae.RIGHTSAMLL&&e.skipToken(1),n.scope=e.peekToken(0).Literal,e.skipToken(1),e.peekToken(0).Type==Vae.SEMICOLON)return e.skipToken(1),n;if(e.peekToken(0).isBuiltinType()&&e.peekToken(1).Type==Vae.IDENT&&e.peekToken(2).Type==Vae.SEMICOLON)return t=new Qae(e.peekToken(0).Literal,e.peekToken(1).Literal),n.addNode(t),e.skipToken(3),n;if(e.peekToken(0).Type==Vae.IDENT&&e.peekToken(1).Type==Vae.LEFTBIG)return t=qae.parse(e),n.addNode(t),e.peekToken(0).Type==Vae.IDENT&&e.peekToken(1).Type==Vae.SEMICOLON&&(t.addNode(new Qae(t.name,e.peekToken(0).Literal)),e.skipToken(2)),n;throw"Error parsing layout qualifier type: Unexpected symbol("+e.peekToken(0).Literal+")"}formatToWGSL(e,t){let n="";if(1==this.qualifier.size&&this.qualifier.has("location"))n+="@location("+this.qualifier.get("location")+") ";else if(2==this.qualifier.size&&this.qualifier.has("set")&&this.qualifier.has("binding"))n+="@group("+this.qualifier.get("set")+") @binding("+this.qualifier.get("binding")+") ";else if(1<=this.qualifier.size&&this.qualifier.has("binding"))n+="@group(0) @binding("+this.qualifier.get("binding")+") ";else if(1==this.qualifier.size&&this.qualifier.has("push_constant"))n+="@push_constant ";else if(1<=this.qualifier.size&&this.qualifier.has("local_size_x"))n=(n=(n=(n+="@workgroup_size(")+this.qualifier.get("local_size_x")+", ")+(this.qualifier.has("local_size_y")?this.qualifier.get("local_size_y")+", ":"1, "))+(this.qualifier.has("local_size_z")?this.qualifier.get("local_size_z")+"":"1")+")";else if(this.nodes.length<=0)return"";var r=this.nodes[0];if(r instanceof Qae){switch(r.type){case"sampler":case"texture2D":n+="var ";break;default:"buffer"==this.scope?"compute"==e.stage?n+="var<storage, read_write> ":n+="var<storage, read> ":n+="var<"+this.scope+"> "}e.addIdentifier(r.name,r.name),n+=r.name+": "+yse(r.type)+";\r\n"}else if(r instanceof qae)if("buffer"==this.scope?"compute"==e.stage?n+="var<storage, read_write> ":n+="var<storage, read> ":n+="var<"+this.scope+"> ",r.nodes.length<=0){let t="unif"+e.layoutUniformCount.toString();for(;e.hasIdentifier(t);)e.layoutUniformCount++,t="unif"+e.layoutUniformCount.toString();for(var i of r.fields)e.addIdentifier(i.name,t+"."+i.name);n+=t+": "+r.name+";\r\n",e.layoutUniformCount++}else n+=(r=r.nodes[0]).name+": "+r.type+";\r\n";return n}}function yse(e){switch(e){case"int":return"i32";case"int[]":return"array<i32>";case"uint":return"u32";case"uint[]":return"array<u32>";case"float":return"f32";case"float[]":return"array<f32>";case"vec2":return"vec2<f32>";case"vec3":return"vec3<f32>";case"vec4":return"vec4<f32>";case"vec2[]":return"array<vec2<f32>>";case"vec3[]":return"array<vec3<f32>>";case"vec4[]":return"array<vec4<f32>>";case"ivec2":return"vec2<i32>";case"ivec3":return"vec3<i32>";case"ivec4":return"vec4<i32>";case"ivec2[]":return"array<vec2<i32>>";case"ivec3[]":return"array<vec3<i32>>";case"ivec4[]":return"array<vec4<i32>>";case"mat2":case"mat2x2":return"mat2x2<f32>";case"mat2x3":return"mat2x3<f32>";case"mat2x4":return"mat2x4<f32>";case"mat2[]":case"mat2x2[]":return"array<mat2x2<f32>>";case"mat2x3[]":return"array<mat2x3<f32>>";case"mat2x4[]":return"array<mat2x4<f32>>";case"mat3":case"mat3x3":return"mat3x3<f32>";case"mat3x2":return"mat3x2<f32>";case"mat3x4":return"mat3x4<f32>";case"mat3[]":case"mat3x3[]":return"array<mat3x3<f32>>";case"mat3x2[]":return"array<mat3x2<f32>>";case"mat3x4[]":return"array<mat3x4<f32>>";case"mat4":case"mat4x4":return"mat4x4<f32>";case"mat4x2":return"mat4x2<f32>";case"mat4x3":return"mat4x3<f32>";case"mat4[]":case"mat4x4[]":return"array<mat4x4<f32>>";case"mat4x2[]":return"array<mat4x2<f32>>";case"mat4x3[]":return"array<mat4x3<f32>>";case"texture2D":return"texture_2d<f32>"}return e}class _se{constructor(e){bre(this,"_lexer"),bre(this,"_rootNode"),this._lexer=e,this._rootNode=new Xae,this.parse()}get lexer(){return this._lexer}parse(){for(;this.peekToken(0).Type!==Vae.EOF;){var e;this.peekToken(0).Type==Vae.SEMICOLON?this.skipToken(1):null!==(e=this.parseStatement())&&this._rootNode.addNode(e)}}parseStatement(){var e=this.peekToken();if(e.Type==Vae.LAYOUT&&this.peekToken(1).Type==Vae.LEFTSAMLL)return vse.parse(this._lexer);if(e.Type==Vae.STRUCT)return this.skipToken(1),qae.parse(this._lexer);if((e.isBuiltinType()||e.Type==Vae.VOID)&&this.peekToken(1).Type==Vae.IDENT&&this.peekToken(2).Type==Vae.LEFTSAMLL)return Kae.parse(this._lexer);if(e.Type==Vae.CONST&&this.peekToken(1).isDataType())return Qae.parse(this._lexer);if(e.isDataType()&&this.peekToken(1).Type==Vae.IDENT)return Qae.parse(this._lexer);if(e.Type==Vae.OUT&&this.peekToken(1).isDataType()&&this.peekToken(2).Type==Vae.IDENT)return Qae.parse(this._lexer);if(e.Type==Vae.PRECISION)return gse.parse(this._lexer);throw"Error parsing statement: Unexpected character"}skipToken(e){this._lexer.skipToken(e)}peekToken(e=0){return this._lexer.peekToken(e)}getNextToken(){return this._lexer.GetNextToken()}get ASTRoot(){return this._rootNode}}class bse{static convertGLSL(e){return e=new Wae(e),e=new Hae(e),e=new _se(e),new Yae(e).generateWGSL()}}bre(bse,"VertexShader","VertexShader"),bre(bse,"FragmentShader","FragmentShader");class xse{constructor(){bre(this,"setID",0),bre(this,"bindingID",0),bre(this,"name",""),bre(this,"type","")}}class wse{constructor(){bre(this,"name",""),bre(this,"type",""),bre(this,"locationID",0),bre(this,"builtinName","")}isBuiltinAttribute(){return""!=this.builtinName}}class Sse{constructor(){bre(this,"uniformInfo",[]),bre(this,"inputAttribute",[]),bre(this,"outputAttribute",[]),bre(this,"sourceCode","")}}var Cse=(e=>(e[e.vertex=0]="vertex",e[e.fragment=1]="fragment",e[e.computer=2]="computer",e))(Cse||{});class Tse{constructor(){bre(this,"blendMode",Bae.NONE),bre(this,"depthCompare",Jre),bre(this,"depthWriteEnabled",!0),bre(this,"frontFace","ccw"),bre(this,"cullMode",rie),bre(this,"topology",sie),bre(this,"depthBias",10),bre(this,"useLight",!1),bre(this,"useProbe",!1),bre(this,"acceptGI",!1),bre(this,"acceptShadow",!1),bre(this,"castShadow",!1),bre(this,"castReflection",!1),bre(this,"receiveEnv",!1),bre(this,"renderLayer",1e3),bre(this,"renderOrder",0),bre(this,"unclippedDepth",!1),bre(this,"multisample",0),bre(this,"label"),bre(this,"useZ",!0),bre(this,"splitTexture",!1)}setFromMapValues(e){e.has("blendMode")&&(this.blendMode=this.convertBlendMode(e.get("blendMode"))),e.has("depthCompare")&&(this.depthCompare=e.get("depthCompare")),e.has("depthWriteEnabled")&&(this.depthWriteEnabled=e.get("depthWriteEnabled")),e.has("frontFace")&&(this.frontFace=e.get("frontFace")),e.has("cullMode")&&(this.cullMode=e.get("cullMode")),e.has("topology")&&(this.topology=e.get("topology")),e.has("depthBias")&&(this.depthBias=e.get("depthBias")),e.has("useLight")&&(this.useLight=e.get("useLight")),e.has("useProbe")&&(this.useProbe=e.get("useProbe")),e.has("acceptGI")&&(this.acceptGI=e.get("acceptGI")),e.has("acceptShadow")&&(this.acceptShadow=e.get("acceptShadow")),e.has("castShadow")&&(this.castShadow=e.get("castShadow")),e.has("receiveEnv")&&(this.receiveEnv=e.get("receiveEnv")),e.has("renderLayer")&&(this.renderLayer=e.get("renderLayer")),e.has("renderOrder")&&(this.renderOrder=e.get("renderOrder")),e.has("unclippedDepth")&&(this.unclippedDepth=e.get("unclippedDepth")),e.has("multisample")&&(this.multisample=e.get("multisample")),e.has("label")&&(this.label=e.get("label")),e.has("useZ")&&(this.useZ=e.get("useZ"))}convertBlendMode(e){switch(e){case"ABOVE":return Bae.ABOVE;case"ALPHA":return Bae.ALPHA;case"NORMAL":return Bae.NORMAL;case"ADD":return Bae.ADD;case"BELOW":return Bae.BELOW;case"ERASE":return Bae.ERASE;case"MUL":return Bae.MUL;case"SCREEN":return Bae.SCREEN;case"DIVD":return Bae.DIVD;case"SOFT_ADD":return Bae.SOFT_ADD}return Bae.NONE}}class Mse extends Mie{constructor(){super(),bre(this,"uniformNodes",[]),bre(this,"_onChange",!0),this.bufferType=Eie.MaterialDataUniformGPUBuffer}initDataUniform(e){let t=0;for(const a in this.uniformNodes=e){var n=e[a];n||console.error(a,"is empty"),t+=4*n.size}t=256*Math.floor(t/256+1),this.createBuffer(GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,t/4);for(const a in e){var r=e[a],i=(r||console.error(a,"is empty"),this.memory.allocation_node(4*r.size));r.memoryInfo=i,r.bindOnChange=()=>this.onChange()}}onChange(){this._onChange=!0}apply(){if(0!=this.uniformNodes.length&&this._onChange){for(const e in this.uniformNodes)this.uniformNodes[e].update();super.apply(),this._onChange=!1}}}class Ese{static init(){this.renderShaderModulePool=new Map,this.renderShader=new Map}}bre(Ese,"renderShaderModulePool"),bre(Ese,"renderShader");const Ase=class{constructor(){bre(this,"reference")}static getInstance(){return this._ins||(this._ins=new Ase),this._ins}attached(e,t){this.reference||(this.reference=new Map);let n=this.reference.get(e);(n=n||new Map).set(t,e),this.reference.set(e,n)}detached(e,t){(e=this.reference.get(e))&&e.delete(t)}hasReference(e){return!!(e=this.reference.get(e))&&0<e.size}getReferenceCount(e){return(e=this.reference.get(e))?e.size:0}getReference(e){return this.reference.get(e)||null}};let Pse=Ase;bre(Pse,"_ins");class Rse extends Lie{constructor(e,t){super(),bre(this,"useRz",!1),bre(this,"vsName"),bre(this,"fsName"),bre(this,"shaderState"),bre(this,"textures"),bre(this,"pipeline"),bre(this,"bindGroupLayouts"),bre(this,"materialDataUniformBuffer"),bre(this,"_sourceVS"),bre(this,"_sourceFS"),bre(this,"_destVS"),bre(this,"_destFS"),bre(this,"_vsShaderModule"),bre(this,"_fsShaderModule"),bre(this,"_textureGroup",-1),bre(this,"_textureChange",!1),bre(this,"_vs_limit",[]),bre(this,"_fs_limit",[]),bre(this,"_cs_limit",[]),bre(this,"_groupsShaderReflectionVarInfos"),bre(this,"_passShaderCache",new Map),this.vsName=e.toLowerCase(),this.fsName=t.toLowerCase(),this.vsName in Hre||console.error("Shader Not Register, Please Register Shader!",this.vsName),this.fsName in Hre||console.error("Shader Not Register, Please Register Shader!",this.fsName),Hre[this.vsName]&&(this._sourceVS=Hre[this.vsName]),Hre[this.fsName]&&(this._sourceFS=Hre[this.fsName]),this.textures={},this.bindGroups=[],this.shaderState=new Tse,this.materialDataUniformBuffer=new Mse,this.materialDataUniformBuffer.visibility=GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,this._bufferDic.set("global",this.materialDataUniformBuffer),this._bufferDic.set("materialUniform",this.materialDataUniformBuffer)}get cullMode(){return this.shaderState.cullMode}set cullMode(e){this.shaderState.cullMode!=e&&(this._stateChange=!0),this.shaderState.cullMode=e}get frontFace(){return this.shaderState.frontFace}set frontFace(e){this.shaderState.frontFace!=e&&(this._stateChange=!0),this.shaderState.frontFace=e}get depthBias(){return this.shaderState.depthBias}set depthBias(e){this.shaderState.depthBias!=e&&(this._stateChange=!0),this.shaderState.depthBias=e}get topology(){return this.shaderState.topology}set topology(e){this.shaderState.topology!=e&&(this._stateChange=!0),this.shaderState.topology=e}get blendMode(){return this.shaderState.blendMode}set blendMode(e){this.shaderState.blendMode!=e&&(this._stateChange=!0),this.shaderState.blendMode=e}get depthCompare(){return this.shaderState.depthCompare}set depthCompare(e){this.shaderState.depthCompare!=e&&(this._stateChange=!0),this.shaderState.depthCompare=e}static createShader(e,t){return e=new Rse(e,t),Ese.renderShader.set(e.instanceID,e),e.instanceID}static destroyShader(e){Ese.renderShader.has(e)&&(Ese.renderShader.get(e).destroy(),Ese.renderShader.delete(e))}static getShader(e){return Ese.renderShader.get(e)}setPassShader(e,t){this._passShaderCache.set(e,t)}getPassShader(e){return this._passShaderCache.get(e)}setShaderEntry(e="",t=""){this.vsEntryPoint=e,this.fsEntryPoint=t}setTexture(e,t){t&&this.textures[e]!=t&&(this.textures[e]&&this.textures[e].unBindStateChange(this),this._textureChange=!0,(this.textures[e]=t).bindStateChange((()=>{this._textureChange=!0}),this))}getTexture(e){return this.textures[e]}genRenderPipeline(e,t){var n=this.createGroupLayouts();this.createPipeline(e,t,n)}reBuild(e,t){this.compileShader(Cse.vertex,this._destVS,t),this.compileShader(Cse.fragment,this._destFS,t),this.genRenderPipeline(e,t)}apply(e,t,n,r){this.materialDataUniformBuffer.apply(),this._textureChange&&-1!=this._textureGroup&&(this._textureChange=!1,this.genGroups(this._textureGroup,this.shaderReflection.groups,!0)),this._stateChange&&(this._shaderChange&&(this.preCompile(e),this._shaderChange=!1),this.reBuild(e,n),this._stateChange=!1,r)&&r()}preCompile(e){this.preDefine(e),this.preCompileShader(Cse.vertex,this._sourceVS.concat()),this.preCompileShader(Cse.fragment,this._sourceFS.concat()),this.genReflection()}applyPostDefine(e,t){return"pixel"==nce.setting.pick.mode&&(this.defineValue.USE_WORLDPOS=!0),1<t.outAttachments.length?(this.defineValue.USE_WORLDPOS=!0,this.defineValue.USEGBUFFER=!0):(this.defineValue.USE_WORLDPOS=!1,this.defineValue.USEGBUFFER=!1),nce.setting.gi.enable?this.defineValue.USEGI=!0:this.defineValue.USEGI=!1,nce.setting.material.materialChannelDebug&&(this.defineValue.USE_DEBUG=!0),this.shaderState.useLight?this.defineValue.USE_LIGHT=!0:this.defineValue.USE_LIGHT=!1,Iie.parse(e,this.defineValue)}setBindGroup(e,t){this.bindGroups[e]=t}setDefault(){this.setUniformFloat("shadowBias",35e-5),this.setUniformVector4("transformUV1",new $re(0,0,1,1)),this.setUniformVector4("transformUV2",new $re(0,0,1,1)),this.setUniformColor("baseColor",new wre),this.setUniformColor("emissiveColor",new wre(1,1,1)),this.setUniformVector4("materialF0",new $re(.04,.04,.04,1)),this.setUniformFloat("envIntensity",1),this.setUniformFloat("normalScale",1),this.setUniformFloat("roughness",1),this.setUniformFloat("metallic",0),this.setUniformFloat("ao",1),this.setUniformFloat("roughness_min",0),this.setUniformFloat("roughness_max",1),this.setUniformFloat("metallic_min",0),this.setUniformFloat("metallic_max",1),this.setUniformFloat("emissiveIntensity",0),this.setUniformFloat("alphaCutoff",0),this.setUniformFloat("ior",1.5),this.setUniformFloat("clearcoatFactor",0),this.setUniformFloat("clearcoatRoughnessFactor",0),this.setUniformColor("clearcoatColor",new wre(1,1,1)),this.setUniformFloat("clearcoatWeight",0)}destroy(e){for(const n in this.textures)if(Object.prototype.hasOwnProperty.call(this.textures,n)){var t=this.textures[n];if(Pse.getInstance().detached(t,this),e&&!Pse.getInstance().hasReference(t))t.destroy(e);else{t.destroy(!1);let e=Pse.getInstance().getReference(t),n=[];e.forEach(((e,t)=>{"name"in e?n.push(e.name):n.push("NaN")}))}}this.bindGroups.length=0,this._passShaderCache.clear(),this.shaderState=null,this.textures=null,this.pipeline=null,this.bindGroupLayouts=null,this._sourceVS=null,this._sourceFS=null,this._destVS=null,this._destFS=null,this._vsShaderModule=null,this._fsShaderModule=null,this.materialDataUniformBuffer.destroy(e),this.materialDataUniformBuffer=null}checkBuffer(e,t){}preCompileShader(e,t,n){let r=t;var i;-1!=r.indexOf("version ")&&(r=(t=bse.convertGLSL(r)).sourceCode);for(const a in this.constValues)Object.prototype.hasOwnProperty.call(this.constValues,a)&&(i=this.constValues[a],r=r.replaceAll("&"+a,i.toString()));switch(e){case Cse.vertex:this._destVS=r;break;case Cse.fragment:this._destFS=r}}compileShader(e,t,n){let r=t,i=(r=this.applyPostDefine(r,n),t);for(var a in this.defineValue)i+=`${a}=${this.defineValue[a]},`;let s=Ese.renderShaderModulePool.get(i);switch(s||(r=this.applyPostDefine(r,n),(s=Dre.device.createShaderModule({label:e==Cse.vertex?this.vsName:this.fsName,code:r})).getCompilationInfo().then((e=>{0<e.messages.length&&(console.log(r),console.log(e))})),Ese.renderShaderModulePool.set(i,s)),e){case Cse.vertex:this._vsShaderModule=s,this._destVS=r;break;case Cse.fragment:this._fsShaderModule=s,this._destFS=r}}getGroupLayout(e,t){var n=[];for(let d=0;d<t.length;d++){var r=t[d];if(r)if("uniform"==r.varType){this._bufferDic.has(r.varName)||console.error(`not set ${r.varName} buffer`);var i=this._bufferDic.get(r.varName).visibility;i={binding:r.binding,visibility:i,buffer:{type:"uniform"}};n.push(i)}else if("storage-read"==r.varType){this._bufferDic.has(r.varName)||console.error(`not set ${r.varName} buffer`);i=this._bufferDic.get(r.varName).visibility;var a={binding:r.binding,visibility:i,buffer:{type:"read-only-storage"}};n.push(a)}else if("var"==r.varType)switch(r.dataType){case"sampler":var s=r.varName.replace("Sampler","");s=this.textures[s]||nce.res.redTexture,s={binding:r.binding,visibility:s.visibility,sampler:s.samplerBindingLayout};n.push(s),this._textureGroup=e;break;case"sampler_comparison":s=r.varName.replace("Sampler","");var o=this.textures[s]||nce.res.redTexture;o={binding:r.binding,visibility:o.visibility,sampler:o.sampler_comparisonBindingLayout};n.push(o),this._textureGroup=e;break;case"texture_2d<f32>":case"texture_2d_array<f32>":case"texture_cube<f32>":case"texture_depth_2d":case"texture_depth_2d_array":case"texture_depth_cube":case"texture_depth_cube_array":o=this.textures[r.varName]||nce.res.redTexture;var l={binding:r.binding,visibility:o.visibility,texture:o.textureBindingLayout};n.push(l),this._textureGroup=e,Pse.getInstance().attached(o,this);break;case"texture_external":l=this.textures[r.varName]||nce.res.redTexture;var u={binding:r.binding,visibility:l.visibility,externalTexture:{}};n.push(u),this._textureGroup=e,Pse.getInstance().attached(l,this);break;default:u=this.textures[r.varName]||nce.res.redTexture;var c={binding:r.binding,visibility:u.visibility,texture:u.textureBindingLayout};n.push(c),this._textureGroup=e,Pse.getInstance().attached(u,this)}else console.error("bind group can't empty")}return n}genGroups(e,t,n=!1){if(!this.bindGroups[e]||n){var r=t[e],i=[];for(let e=0;e<r.length;e++){var a=r[e];if(a)if("uniform"==a.varType){var s=this._bufferDic.get(a.varName);if(s){if(s.bufferType==Eie.MaterialDataUniformGPUBuffer){var o=[];for(let e=0;e<a.dataFields.length;e++){var l=a.dataFields[e];this.uniforms[l.name]||console.error(`shader-${this.vsName}:${this.fsName} ${l.name}is empty`),o.push(this.uniforms[l.name])}this.materialDataUniformBuffer.initDataUniform(o)}var u={binding:a.binding,resource:{buffer:s.buffer,offset:0,size:s.memory.shareDataBuffer.byteLength}};i.push(u),this.checkBuffer(a.varName,s)}else console.error(`shader${this.vsName}-`+this.fsName,`buffer ${a.varName} is missing!`)}else if("storage-read"==a.varType)(u=this._bufferDic.get(a.varName))?(s={binding:a.binding,resource:{buffer:u.buffer,offset:0,size:u.memory.shareDataBuffer.byteLength}},i.push(s),this.checkBuffer(a.varName,u)):console.error(`buffer ${a.varName} is missing!`);else if("var"==a.varType)if("sampler"==a.dataType){let e=a.varName.replace("Sampler",""),t=this.textures[e];t||(t=nce.res.blackTexture,this.setTexture(e,t)),t?(c={binding:a.binding,resource:t.gpuSampler},i.push(c)):console.error(`shader${this.vsName}-`+this.fsName,`texture ${a.varName} is missing! `)}else if("sampler_comparison"==a.dataType){var c=a.varName.replace("Sampler",""),d=this.textures[c];d?(d={binding:a.binding,resource:d.gpuSampler_comparison},i.push(d)):console.error(`shader${this.vsName}-`+this.fsName,`texture ${a.varName} is missing! `)}else{let e=this.textures[a.varName];e||(e=nce.res.whiteTexture,this.setTexture(a.varName,e)),e?(d={binding:a.binding,resource:e.getGPUView()},i.push(d)):console.error(`shader${this.vsName}-`+this.fsName,`texture ${a.varName} is missing! `)}}n=Dre.device.createBindGroup({layout:this.bindGroupLayouts[e],entries:i}),this.bindGroups[e]=n}}createPipeline(e,t,n){var r=this.shaderState,i=t.outAttachments,a=(-1!=t.outColor&&(a=i[t.outColor],r.blendMode!=Bae.NONE?a.blend=zae.getBlend(r.blendMode):a.blend=void 0),{label:this.vsName+"|"+this.fsName,layout:n,primitive:{topology:r.topology,cullMode:r.cullMode,frontFace:r.frontFace},vertex:void 0});""!=this.vsEntryPoint&&(a.vertex={module:this._vsShaderModule,entryPoint:this.vsEntryPoint,buffers:e.vertexBuffer.vertexBufferLayouts}),""!=this.fsEntryPoint&&(a.fragment={module:this._fsShaderModule,entryPoint:this.fsEntryPoint,targets:i}),0<r.multisample&&(a.multisample={count:r.multisample}),(t.zPreTexture||t.depthTexture)&&(r.blendMode,Bae.NONE,nce.setting.render.zPrePass&&t.zPreTexture&&r.useZ?a.depthStencil={depthWriteEnabled:r.depthWriteEnabled,depthCompare:r.depthCompare,format:t.zPreTexture.format}:(a.depthStencil={depthWriteEnabled:r.depthWriteEnabled,depthCompare:r.depthCompare,format:t.depthTexture.format},this.useRz)),this.pipeline=roe.createPipeline(a)}createGroupLayouts(){this._groupsShaderReflectionVarInfos=[];var e=this.shaderReflection;this.bindGroupLayouts=[Cae.getGlobalDataBindGroupLayout()];for(let i=1;i<e.groups.length;i++){var t,n=e.groups[i];n?(t=this.getGroupLayout(i,n),this._groupsShaderReflectionVarInfos[i]=n,n=Dre.device.createBindGroupLayout({entries:t,label:`vs${this.vsName} fs`+this.fsName}),this.bindGroupLayouts[i]=n):console.error("can't set empty group!",i)}var r=Dre.device.createPipelineLayout({bindGroupLayouts:this.bindGroupLayouts});return this._groupsShaderReflectionVarInfos[0],this._groupsShaderReflectionVarInfos[1]&&this.genGroups(1,this._groupsShaderReflectionVarInfos),this._groupsShaderReflectionVarInfos[2]&&this.genGroups(2,this._groupsShaderReflectionVarInfos),this._groupsShaderReflectionVarInfos[3]&&this.genGroups(3,this._groupsShaderReflectionVarInfos),r}preDefine(e){var t=e.hasAttribute(Nae.joints0),n=e.hasAttribute(Nae.a_morphPositions_0),r=e.hasAttribute(Nae.TANGENT),i=(e=e.hasAttribute(Nae.color),this.shaderState.acceptGI),a=this.shaderState.useLight;this.defineValue.USE_SKELETON=t,this.defineValue.USE_MORPHTARGETS=n,this.defineValue.USE_TANGENT=r,this.defineValue.USE_GI=i,this.defineValue.USE_CASTSHADOW=this.shaderState.castShadow,this.defineValue.USE_SHADOWMAPING=this.shaderState.acceptShadow,this.defineValue.USE_LIGHT=a,this.defineValue.USE_VERTXCOLOR=e,this.defineValue.USE_PCF_SHADOW="PCF"==nce.setting.shadow.type,this.defineValue.USE_HARD_SHADOW="HARD"==nce.setting.shadow.type,this.defineValue.USE_SOFT_SHADOW="SOFT"==nce.setting.shadow.type,this.defineValue.USE_IES_PROFILE=Oae.use}genReflection(){this.shaderVariant+=Bie.genRenderShaderVariant(this);var e=Bie.poolGetReflection(this.shaderVariant);e?this.shaderReflection=e:(e=Iie.parse(this._destVS,this.defineValue),e=Iie.parse(e,this.defineValue),Bie.getShaderReflection2(e,this),e=Iie.parse(this._destFS,this.defineValue),e=Iie.parse(e,this.defineValue),Bie.getShaderReflection2(e,this),Bie.final(this)),this.shaderState.splitTexture=this.shaderReflection.useSplit}}class Lse{constructor(){bre(this,"renderPasses"),bre(this,"enable",!0),bre(this,"renderShader"),bre(this,"_shaderID"),bre(this,"_sort",3e3),bre(this,"_transparent",!1)}get sort(){return this._sort}set sort(e){this._sort=e}get shaderID(){return this._shaderID}set shaderID(e){this._shaderID=e}setShader(e,t){return this._shaderID=Rse.createShader(e,t),this.renderShader=this.getShader(),this.renderShader.setDefault(),this.renderShader}getShader(){return Rse.getShader(this._shaderID)}get blendMode(){return this.renderShader.blendMode}set blendMode(e){this.renderShader.blendMode=e}get transparent(){return this._transparent}set transparent(e){this._transparent=e}get frontFace(){return this.renderShader.frontFace}set frontFace(e){this.renderShader.frontFace=e}get doubleSide(){return this.renderShader.cullMode==tie}set doubleSide(e){e?this.renderShader.cullMode=tie:this.renderShader.cullMode==tie&&(this.renderShader.cullMode=rie)}get cullMode(){return this.renderShader.cullMode}set cullMode(e){this.renderShader.cullMode=e||this.renderShader.cullMode}get depthBias(){return this.renderShader.depthBias}set depthBias(e){this.renderShader.depthBias=e}get depthCompare(){return this.renderShader.depthCompare}set depthCompare(e){this.renderShader.depthCompare=e||this.renderShader.depthCompare}destroy(e){this.renderShader&&this.renderShader.destroy(e),this.renderShader=null,this.renderPasses.forEach(((t,n)=>{for(let i=0;i<t.length;i++){var r=t[i];r!=this&&r.destroy(e)}t.length=0})),this.renderPasses.clear(),this.renderPasses=null}clone(){return null}debug(){throw new Error("Method not implemented.")}}class kse extends Lse{constructor(){super(),bre(this,"name"),bre(this,"instanceID"),bre(this,"isPassMaterial",!1),bre(this,"receiveEnv",!0),bre(this,"_normalMapYFlip"),this.instanceID=Rie(),this.renderPasses=new Map}get shaderState(){return this.renderShader.shaderState}set shaderState(e){this.renderShader.shaderState=e}get normalMapYFlip(){return this._normalMapYFlip}set normalMapYFlip(e){(this._normalMapYFlip=e)&&this.renderShader.setDefine("USE_NORMALFILPY",!0)}set shadowMap(e){this.renderShader.setTexture("shadowMap",e)}set envMap(e){this.renderShader.setTexture("envMap",e)}set baseMap(e){this.renderShader.setTexture("baseMap",e),this.notifyPropertyChange("baseMap",e)}get baseMap(){return this.renderShader.textures.baseMap}get normalMap(){return this.renderShader.textures.normalMap}set normalMap(e){this.renderShader.setTexture("normalMap",e),this.notifyPropertyChange("normalMap",e)}get emissiveMap(){return this.renderShader.textures.emissiveMap}get emissiveColor(){return this.renderShader.uniforms.emissiveColor.color}set emissiveColor(e){this.renderShader.setUniformColor("emissiveColor",e),this.notifyPropertyChange("emissiveColor",e)}set emissiveIntensity(e){this.renderShader.setUniformFloat("emissiveIntensity",e),this.notifyPropertyChange("emissiveIntensity",e)}get emissiveIntensity(){return this.renderShader.uniforms.emissiveIntensity.value}set emissiveMap(e){this.renderShader.setTexture("emissiveMap",e),this.notifyPropertyChange("emissiveMap",e)}get envIntensity(){return this.renderShader.uniforms.envIntensity.value}set envIntensity(e){"envIntensity"in this.renderShader.uniforms&&(this.renderShader.uniforms.envIntensity.value=e),this.notifyPropertyChange("envIntensity",e)}get normalScale(){return this.renderShader.uniforms.normalScale.value}set normalScale(e){"normalScale"in this.renderShader.uniforms&&(this.renderShader.uniforms.envIntensity.value=e),this.notifyPropertyChange("normalScale",e)}get alphaCutoff(){return this.renderShader.uniforms.alphaCutoff.value}set alphaCutoff(e){"alphaCutoff"in this.renderShader.uniforms&&((this.renderShader.uniforms.alphaCutoff.value=e)<1&&0!=e?(this.renderShader.setDefine("USE_ALPHACUT",!0),console.log("USE_ALPHACUT")):this.renderShader.setDefine("USE_ALPHACUT",!1),this.notifyPropertyChange("alphaCutoff",e))}get irradianceMap(){return this.renderShader.textures.irradianceMap}set irradianceMap(e){this.renderShader.setTexture("irradianceMap",e),this.notifyPropertyChange("irradianceMap",e)}get irradianceDepthMap(){return this.renderShader.textures.irradianceDepthMap}set irradianceDepthMap(e){this.renderShader.setTexture("irradianceDepthMap",e),this.notifyPropertyChange("irradianceDepthMap",e)}get baseColor(){return this.renderShader.uniforms.baseColor.color}set baseColor(e){this.renderShader.setUniformColor("baseColor",e),this.notifyPropertyChange("baseColor",e)}get uvTransform_1(){return this.renderShader.uniforms.transformUV1.vector4}set uvTransform_1(e){this.renderShader.uniforms.transformUV1.vector4=e,this.notifyPropertyChange("transformUV1",e)}get uvTransform_2(){return this.renderShader.uniforms.transformUV2.vector4}set uvTransform_2(e){this.renderShader.uniforms.transformUV2.vector4=e,this.notifyPropertyChange("uvTransform_2",e)}notifyPropertyChange(e,t){}setDefine(e,t){this.renderShader.setDefine(e,!0)}hasPass(e){return this.renderPasses.has(e)}addPass(e,t,n=-1){return this.renderPasses.has(e)||this.renderPasses.set(e,[]),-1==(e=this.renderPasses.get(e)).indexOf(t)&&(-1==n?e.push(t):e.splice(n,-1,t)),e}removePass(e,t){this.renderPasses.has(e)&&t<(e=this.renderPasses.get(e)).length&&e.splice(t,1)}destroy(e){super.destroy(e)}clone(){return null}}class Dse extends kse{constructor(){super(),bre(this,"transparency"),this.isPassMaterial=!0,Hre.register("castPointShadowMap_vert",Aae),Hre.register("shadowCastMap_frag",Pae);var e=this.setShader("castPointShadowMap_vert","shadowCastMap_frag");e.setShaderEntry("main","main"),e.setUniformFloat("cameraFar",5e3),e.setUniformVector3("lightWorldPos",Rre.ZERO),e.shaderState.receiveEnv=!1}}class Ise extends kse{constructor(){super(),bre(this,"transparency"),this.isPassMaterial=!0,Hre.register("shadowCastMap_vert",Eae),Hre.register("shadowCastMap_frag",Pae);var e=this.setShader("shadowCastMap_vert","shadowCastMap_frag");e.setShaderEntry("main"),e.setUniformFloat("cameraFar",5e3),e.setUniformVector3("lightWorldPos",Rre.ZERO),e.shaderState.receiveEnv=!1}}let Ose=`\n    #include "GlobalUniform"\n\n    struct VertexOutput {\n        @location(0) vID: f32 ,\n        @location(1) vPos: vec3<f32> ,\n        @builtin(position) member: vec4<f32>\n    };\n\n    struct Uniforms {\n        matrix : array<mat4x4<f32>>\n    };\n\n    @group(0) @binding(1)\n    var<storage, read> models : Uniforms;\n\n    var<private> worldMatrix: mat4x4<f32>;\n\n    #if USE_MORPHTARGETS\n        ${Bre.getMorphTargetShaderBinding(1,0)}\n    #endif\n\n    #if USE_SKELETON\n        ${Nre.groupBindingAndFunctions(1,0)}\n    #endif\n\n    @vertex\n    fn main(\n        @builtin(instance_index) index : u32,\n        @location(0) position: vec3<f32>,\n        @location(1) normal: vec3<f32>,\n        @location(2) uv: vec2<f32>,\n        @location(3) TEXCOORD_1: vec2<f32>,\n\n    #if USE_TANGENT\n        @location(4) TANGENT: vec4<f32>,\n        #if USE_SKELETON\n            @location(5) joints0: vec4<f32>,\n            @location(6) weights0: vec4<f32>,\n            #if USE_JOINT_VEC8\n                @location(7) joints1: vec4<f32>,\n                @location(8) weights1: vec4<f32>,\n            #endif\n        #elseif USE_MORPHTARGETS\n            ${Bre.getMorphTargetAttr(5)}\n        #endif\n    #elseif USE_SKELETON\n        @location(4) joints0: vec4<f32>,\n        @location(5) weights0: vec4<f32>,\n        #if USE_JOINT_VEC8\n            @location(6) joints1: vec4<f32>,\n            @location(7) weights1: vec4<f32>,\n        #endif\n    #elseif USE_MORPHTARGETS\n        ${Bre.getMorphTargetAttr(4)}\n    #endif\n    ) -> VertexOutput {\n    worldMatrix = models.matrix[index];\n\n    var vertexPosition = position;\n    var vertexNormal = normal;\n    #if USE_MORPHTARGETS\n        ${Bre.getMorphTargetCalcVertex()}\n    #endif\n\n    #if USE_SKELETON\n        #if USE_JOINT_VEC8\n            worldMatrix *= getSkeletonWorldMatrix_8(joints0, weights0, joints1, weights1);\n        #else\n            worldMatrix *= getSkeletonWorldMatrix_4(joints0, weights0);\n        #endif\n    #endif\n\n        \n        let wPos = worldMatrix * vec4<f32>(vertexPosition.xyz, 1.0);\n        var fixProjMat = globalUniform.projMat ;\n        // fixProjMat[2].z = -1.0 ;//99999.0 / (99999.0 - 1.0) ;\n        // fixProjMat[3].z = 0.0 ;//(-1.0 * 99999.0) / (99999.0 - 1.0) ;\n        var rzMatrix : mat4x4<f32> ;\n        rzMatrix[0] = vec4<f32>(1.0,0.0,0.0,0.0) ; \n        rzMatrix[1] = vec4<f32>(0.0,1.0,0.0,0.0) ; \n        rzMatrix[2] = vec4<f32>(0.0,0.0,1.0,0.0) ; \n        rzMatrix[3] = vec4<f32>(0.0,0.0,0.0,1.0) ; \n        // rzMatrix[2].z = (-globalUniform.near * globalUniform.far) / (globalUniform.far - globalUniform.near) ;\n        // rzMatrix[3].z = globalUniform.far / (globalUniform.far - globalUniform.near) ;\n        var clipPos:vec4<f32> = fixProjMat * globalUniform.viewMat * rzMatrix * wPos ;\n        // clipPos.z = clipPos.z + (clipPos.z / clipPos.w + globalUniform.near / clipPos.w + 0.002 / clipPos.w) * (globalUniform.near / globalUniform.far) ; \n        // clipPos.z = depthToLinear01(clipPos.z / clipPos.w) ; \n        return VertexOutput(f32(index) , wPos.xyz, clipPos);\n    }\n\n    fn depthToLinear01(depth:f32) -> f32 {\n        let a = 1.0 / (globalUniform.near - globalUniform.far);\n        return (globalUniform.near*globalUniform.far*a) / (depth + globalUniform.far * a) ;\n    }\n`;class Nse extends kse{constructor(){super(),bre(this,"transparency"),this.isPassMaterial=!0,Hre.register("ZPass_shader_vs",Ose),Hre.register("ZPass_shader_fs","\n    struct FragmentOutput {\n        @location(0) o_Target: vec4<f32>\n    };\n\n    @fragment\n    fn main(@location(0) vID: f32, @location(1) vPos:vec3<f32>) -> FragmentOutput {\n        var op = vec4<f32>( vPos, vID);\n        return FragmentOutput(op);\n    }\n");var e=this.setShader("ZPass_shader_vs","ZPass_shader_fs");e.useRz=!0,e.shaderState.receiveEnv=!1}}class Bse extends kse{constructor(){super(),bre(this,"transparency"),this.isPassMaterial=!0,Hre.register("gbuffer_vs",rce),Hre.register("gbuffer_fs",rce),this.setShader("gbuffer_vs","gbuffer_fs").setShaderEntry("VertMain","FragMain"),this.shaderState.cullMode="none",this.renderShader.setUniformColor("baseColor",new wre),this.renderShader.setUniformColor("emissiveColor",new wre),this.renderShader.setUniformFloat("emissiveIntensity",1),this.renderShader.setUniformFloat("normalScale",1),this.renderShader.setUniformFloat("alphaCutoff",1),this.blendMode=Bae.NONE,this.renderShader.setTexture("normalMap",nce.res.normalTexture)}set shadowMap(e){}set envMap(e){}set normalScale(e){this.renderShader.setUniformFloat("normalScale",e)}get normalScale(){return this.renderShader.uniforms.normalScale.value}set alphaCutoff(e){this.renderShader.setUniformFloat("alphaCutoff",e)}get alphaCutoff(){return this.renderShader.uniforms.alphaCutoff.value}}class Use extends kse{constructor(){var e;super(),bre(this,"transparency"),this.isPassMaterial=!0,Hre.register("SkyGBuffer_fs",ice),(e=((e=this.setShader("sky_vs_frag_wgsl","SkyGBuffer_fs")).setUniformFloat("exposure",1),e.setUniformFloat("roughness",0),this.shaderState)).frontFace="ccw",e.cullMode=nie,e.depthWriteEnabled=!1,e.depthCompare=Jre}get exposure(){return this.renderShader.uniforms.exposure.value}set exposure(e){this.renderShader.setUniformFloat("exposure",e)}get roughness(){return this.renderShader.uniforms.roughness.value}set roughness(e){this.renderShader.setUniformFloat("roughness",e)}set shadowMap(e){}set envMap(e){}set emissiveIntensity(e){this.renderShader.setUniformFloat("emissiveIntensity",e)}get emissiveIntensity(){return this.renderShader.uniforms.emissiveIntensity.value}set normalScale(e){this.renderShader.setUniformFloat("normalScale",e)}get normalScale(){return this.renderShader.uniforms.normalScale.value}set alphaCutoff(e){this.renderShader.setUniformFloat("alphaCutoff",e)}get alphaCutoff(){return this.renderShader.uniforms.alphaCutoff.value}}var zse=(e=>(e[e.COLOR=1]="COLOR",e[e.NORMAL=2]="NORMAL",e[e.POSITION=4]="POSITION",e[e.GRAPHIC=8]="GRAPHIC",e[e.GI=16]="GI",e[e.Cluster=32]="Cluster",e[e.SHADOW=64]="SHADOW",e[e.POINT_SHADOW=128]="POINT_SHADOW",e[e.POST=256]="POST",e[e.DEPTH=512]="DEPTH",e[e.REFLECTION=1024]="REFLECTION",e))(zse||{});class Fse{}bre(Fse,"GLTF_NODE_INDEX_PROPERTY"),bre(Fse,"BASE_COLOR_UNIFORM","u_baseColorFactor"),bre(Fse,"BASE_COLOR_TEXTURE_UNIFORM","u_baseColorSampler"),bre(Fse,"METALROUGHNESS_UNIFORM","u_metallicRoughnessValues"),bre(Fse,"METALROUGHNESS_TEXTURE_UNIFORM","u_metallicRoughnessSampler"),bre(Fse,"NORMAL_TEXTURE_UNIFORM","u_normalSampler"),bre(Fse,"NORMAL_SCALE_UNIFORM","u_normalScale"),bre(Fse,"EMISSIVE_TEXTURE_UNIFORM","u_emissiveSampler"),bre(Fse,"EMISSIVE_FACTOR_UNIFORM","u_emissiveFactor"),bre(Fse,"OCCLUSION_TEXTURE_UNIFORM","u_occlusionSampler"),bre(Fse,"OCCLUSION_FACTOR_UNIFORM","u_occlusionFactor"),bre(Fse,"MAX_MORPH_TARGETS",8),bre(Fse,"MORPH_POSITION_PREFIX","a_morphPositions_"),bre(Fse,"MORPH_NORMAL_PREFIX","a_morphNormals_"),bre(Fse,"MORPH_TANGENT_PREFIX","a_morphTangents_"),bre(Fse,"MORPH_WEIGHT_UNIFORM","u_morphWeights"),bre(Fse,"SCENE_ROOT_SKELETON","SCENE_ROOT"),bre(Fse,"IDENTITY_INVERSE_BIND_MATRICES","IDENTITY_IBM"),bre(Fse,"JOINT_MATRICES_UNIFORM","u_jointMatrix"),bre(Fse,"ALPHA_CUTOFF_UNIFORM","u_alphaCutoff");class Vse{static createGIPass(e,t){var n,r,i;xie.hasMask(e.rendererMask,bie.Sky)?((n=new Use).baseMap=t.baseMap,r=t,(i=n.getShader()).shaderState.cullMode=r.getShader().cullMode,i.shaderState.frontFace=r.getShader().frontFace,t.addPass(zse.GI,n,0),n.renderShader.preCompile(e.geometry)):this.castGBufferPass(e,t)}static castGBufferPass(e,t){for(let s=0;s<e.materials.length;s++){var n,r,i,a=e.materials[s];let o=a.renderShader.getPassShader(zse.GI);o||(n=(o=new Bse).renderShader,o.baseColor=a.baseColor,o.baseMap=a.baseMap,o.normalMap=a.normalMap,o.envIntensity=a.envIntensity,o.emissiveMap=a.emissiveMap,o.emissiveColor=a.emissiveColor,o.emissiveIntensity=a.emissiveIntensity,o.alphaCutoff=a.alphaCutoff,r=e.materials[0],(i=o.getShader()).shaderState.cullMode=r.getShader().cullMode,i.shaderState.frontFace=r.getShader().frontFace,n.preCompile(e.geometry),a.renderShader.setPassShader(zse.GI,o)),t.addPass(zse.GI,o,s)}}static createShadowPass(e,t){let n=xie.hasMask(e.rendererMask,bie.SkinnedMesh),r=e.geometry.hasAttribute("TANGENT"),i=e.geometry.hasAttribute(Fse.MORPH_POSITION_PREFIX+"0"),a=e.geometry.hasAttribute(Fse.MORPH_NORMAL_PREFIX+"0"),s=t.renderShader.getPassShader(zse.SHADOW);if(!s){(s=new Ise).baseMap=e.materials[0].baseMap,s.alphaCutoff=e.materials[0].alphaCutoff,s.setDefine("USE_ALPHACUT",e.materials[0].alphaCutoff<1);for(let l=0;l<1;l++){var o=s.renderShader;r&&o.setDefine("USE_TANGENT",r),n&&o.setDefine("USE_SKELETON",n),i&&o.setDefine("USE_MORPHTARGETS",i),a&&o.setDefine("USE_MORPHNORMALS",a),"none"==t.getShader().cullMode?o.shaderState.cullMode="none":"back"==t.getShader().cullMode?o.shaderState.cullMode="front":"front"==t.getShader().cullMode&&(o.shaderState.cullMode="back"),o.preCompile(e.geometry)}t.renderShader.setPassShader(zse.SHADOW,s)}t.addPass(zse.SHADOW,s,0);let l=t.renderShader.getPassShader(zse.POINT_SHADOW);if(!l){(l=new Dse).baseMap=e.materials[0].baseMap,l.alphaCutoff=e.materials[0].alphaCutoff,l.setDefine("USE_ALPHACUT",e.materials[0].alphaCutoff<1);for(let t=0;t<1;t++){var u=l.renderShader;r&&u.setDefine("USE_TANGENT",r),n&&u.setDefine("USE_SKELETON",n),i&&u.setDefine("USE_MORPHTARGETS",i),a&&u.setDefine("USE_MORPHNORMALS",a),u.shaderState.cullMode="front",u.preCompile(e.geometry)}t.renderShader.setPassShader(zse.POINT_SHADOW,l)}t.addPass(zse.POINT_SHADOW,l,0)}static createReflectionPass(e,t){}static createDepthPass(e,t){var n=t.renderShader.getPassShader(zse.DEPTH);if(!n){var r=new Nse,i=e.materials[0],a=(r.baseMap=i.baseMap,e.geometry.hasAttribute("TANGENT")),s=e.geometry.hasAttribute(Fse.MORPH_POSITION_PREFIX+"0"),o=e.geometry.hasAttribute(Fse.MORPH_NORMAL_PREFIX+"0"),l=xie.hasMask(e.rendererMask,bie.SkinnedMesh),u=r.getShader();u.shaderState.cullMode=i.getShader().cullMode,u.shaderState.frontFace=i.getShader().frontFace;for(let t=0;t<1;t++){var c=r.getShader();a||c.setDefine("USE_TANGENT",a),l&&c.setDefine("USE_SKELETON",l),s&&c.setDefine("USE_MORPHTARGETS",s),o&&c.setDefine("USE_MORPHNORMALS",o),c.preCompile(e.geometry)}t.renderShader.setPassShader(zse.DEPTH,r)}t.addPass(zse.DEPTH,n,0)}}class Gse extends iae{constructor(){super(),bre(this,"instanceCount",0),bre(this,"lodLevel",0),bre(this,"alwaysRender",!1),bre(this,"instanceID"),bre(this,"drawType",0),bre(this,"_geometry"),bre(this,"_materials",[]),bre(this,"_castShadow",!0),bre(this,"_castReflection",!1),bre(this,"_castGI",!1),bre(this,"_rendererMask",bie.Default),bre(this,"_inRenderer",!1),bre(this,"_readyPipeline",!1),bre(this,"_combineShaderRefection"),bre(this,"_ignoreEnvMap"),bre(this,"_ignorePrefilterMap"),bre(this,"__renderOrder",0),bre(this,"_renderOrder",0),bre(this,"isRenderOrderChange"),bre(this,"needSortOnCameraZ"),this.rendererMask=bie.Default}get renderOrder(){return this._renderOrder}set renderOrder(e){e!=this._renderOrder&&(this.isRenderOrderChange=!0,this._renderOrder=e,this.__renderOrder=e)}get geometry(){return this._geometry}set geometry(e){this._geometry!=e&&(this._geometry&&Pse.getInstance().detached(this._geometry,this),Pse.getInstance().attached(e,this)),this._geometry=e}addMask(e){this._rendererMask=xie.addMask(this.rendererMask,e)}removeMask(e){this._rendererMask=xie.removeMask(this.rendererMask,e)}hasMask(e){return xie.hasMask(this.rendererMask,e)}get rendererMask(){return this._rendererMask}set rendererMask(e){this._rendererMask=e}get materials(){return this._materials}set materials(e){for(let s=0;s<this._materials.length;s++){var t=this._materials[s];Pse.getInstance().detached(t,this)}for(let s=0;s<e.length;s++){var n=e[s];Pse.getInstance().attached(n,this)}this._materials=e;let r=!1,i=0;for(let s=0;s<e.length;s++){var a=e[s];a.transparent&&(r=!0,i=i>a.sort?i:a.sort)}this.renderOrder=r?this.renderOrder:i,this._readyPipeline||this.initPipeline()}init(){this.instanceID=Rie()}addRendererMask(e){this._rendererMask=xie.addMask(this._rendererMask,e)}removeRendererMask(e){this._rendererMask=xie.removeMask(this._rendererMask,e)}onEnable(){this._readyPipeline||this.initPipeline(),Kse.instance.addRenderNode(this.transform.scene3D,this)}onDisable(){Kse.instance.removeRenderNode(this.transform.scene3D,this)}selfCloneMaterials(e){var t=[];for(let r=0,i=this.materials.length;r<i;r++){var n=this.materials[r].clone();t.push(n)}return this.materials=t,this._readyPipeline=!1,this.initPipeline(),this}initPipeline(){if(this._geometry&&0<this._materials.length){for(let r=0;r<this._materials.length;r++){var e=this._materials[r],t=e.addPass(zse.COLOR,e);for(let e=0;e<t.length;e++){var n=t[e];(n=Rse.getShader(n.shaderID)).shaderReflection||n.preCompile(this._geometry),this._geometry.generate(n.shaderReflection)}this.object3D.bound=this._geometry.bounds.clone()}this._readyPipeline=!0;let i=0;for(let e=0;e<this.materials.length;e++){var r=this.materials[e];r.transparent,i=r.transparent?i>r.sort?i:r.sort:Math.max(i-3e3,0),this.castNeedPass(r.getShader())}this.renderOrder=i,this.enable&&this.transform&&this.transform.scene3D&&Kse.instance.addRenderNode(this.transform.scene3D,this)}}castNeedPass(e){if(this.castGI)for(let a=0;a<this.materials.length;a++){var t=this.materials[a];Vse.createGIPass(this,t)}if(this.castShadow)for(let a=0;a<this.materials.length;a++){var n=this.materials[a];n.shaderState.castShadow&&Vse.createShadowPass(this,n)}if(this.castReflection)for(let a=0;a<this.materials.length;a++){var r=this.materials[a];r.shaderState.castShadow&&Vse.createShadowPass(this,r)}if(!xie.hasMask(this.rendererMask,bie.IgnoreDepthPass)&&nce.setting.render.zPrePass&&e.shaderState.useZ)for(let a=0;a<this.materials.length;a++){var i=this.materials[a];Vse.createDepthPass(this,i)}else for(let a=0;a<this.materials.length;a++)this.materials[a].removePass(zse.DEPTH,0)}get castShadow(){return this._castShadow}set castShadow(e){this._castShadow=e}get castGI(){return this._castGI}set castGI(e){this._castGI=e}get castReflection(){return this._castReflection}set castReflection(e){this._castReflection=e}renderPass(e,t,n){var r=this,i=r.transform._worldMatrix;for(let o=0;o<r.materials.length;o++){var a,s=r.materials[o].renderPasses.get(t);if(s&&0!=s.length){roe.bindGeometryBuffer(n.encoder,r._geometry);for(let t=0;t<s.length;t++)s&&0!=s.length&&(a=s[t]).enable&&((a=a.renderShader).shaderState.splitTexture&&(n.endRenderPass(),Coe.WriteSplitColorTexture(r.instanceID),n.beginRenderPass(),roe.bindCamera(n.encoder,e.camera),roe.bindGeometryBuffer(n.encoder,r._geometry)),roe.bindPipeline(n.encoder,a),a=r._geometry.subGeometries[o].lodLevels[r.lodLevel],0<r.instanceCount?roe.drawIndexed(n.encoder,a.indexCount,r.instanceCount,a.indexStart,0,0):roe.drawIndexed(n.encoder,a.indexCount,1,a.indexStart,0,i.index))}}}renderPass2(e,t,n,r,i,a=0){if(this.enable){this.nodeUpdate(e,t,n,r);var s=this.object3D.transform._worldMatrix;for(let e=0;e<this.materials.length;e++){var o=this.materials[e].renderPasses.get(t);if(!o||0==o.length)return;if(2==this.drawType)for(let e=0;e<o.length;e++){var l=o[e];l.enable&&(roe.bindPipeline(i,l.renderShader),roe.draw(i,6,1,0,s.index))}else{roe.bindGeometryBuffer(i,this._geometry);for(let t=0;t<o.length;t++){var u=o[t];u.enable&&(roe.bindPipeline(i,u.renderShader),u=this._geometry.subGeometries[e].lodLevels[this.lodLevel],roe.drawIndexed(i,u.indexCount,1,u.indexStart,0,s.index))}}}}}recordRenderPass2(e,t,n,r,i,a=0){if(this.enable){this.nodeUpdate(e,t,n,r);for(let e=0;e<this.materials.length;e++){var s=this.materials[e].renderPasses.get(t);if(!s||0==s.length)return;var o=this.object3D.transform._worldMatrix;for(let t=0;t<s.length;t++){var l=s[t].renderShader;l=(roe.bindPipeline(i,l),this._geometry.subGeometries[e].lodLevels[this.lodLevel]);roe.drawIndexed(i,l.indexCount,1,l.indexStart,0,o.index)}}}}noticeShaderChange(){this.enable&&this.onEnable()}nodeUpdate(e,t,n,r){for(let u=0;u<this.materials.length;u++){var i=this.materials[u].renderPasses.get(t);if(i)for(let t=0;t<i.length;t++){var a,s,o=i[t],l=o.renderShader;l.shaderState.splitTexture&&(a=Coe.CreateSplitTexture(this.instanceID),l.setTexture("splitTexture_Map",a)),this._ignoreEnvMap||l.setTexture("envMap",e.scene.envMap),this._ignorePrefilterMap||l.setTexture("prefilterMap",e.scene.envMap),l.pipeline?l.apply(this._geometry,o,n,(()=>this.noticeShaderChange())):(a=nce.res.getTexture("BRDFLUT"),l.setTexture("brdflutMap",a),(s=nce.getRenderJob(e).shadowMapPassRenderer)&&s.depth2DArrayTexture&&(l.setTexture("shadowMap",nce.getRenderJob(e).shadowMapPassRenderer.depth2DArrayTexture),l.setStorageBuffer("shadowBuffer",Sae.shadowBuffer.get(e.scene))),(s=nce.getRenderJob(e).pointLightShadowRenderer)&&s.cubeArrayTexture&&l.setTexture("pointShadowMap",s.cubeArrayTexture),(s=Oae.iesTexture)&&l.setTexture("iesTextureArrayMap",s),n.irradianceBuffer&&0<n.irradianceBuffer.length&&(l.setTexture("irradianceMap",n.irradianceBuffer[0]),l.setTexture("irradianceDepthMap",n.irradianceBuffer[1])),(s=toe.getLightEntries(e.scene))&&(l.setStorageBuffer("lightBuffer",s.storageGPUBuffer),s.irradianceVolume)&&l.setStructStorageBuffer("irradianceData",s.irradianceVolume.irradianceVolumeBuffer),r&&(l.setStorageBuffer("clustersUniform",r.clustersUniformBuffer),l.setStorageBuffer("lightAssignBuffer",r.lightAssignBuffer),l.setStorageBuffer("assignTable",r.assignTableBuffer),l.setStorageBuffer("clusterBuffer",r.clusterBuffer)),l.apply(this._geometry,o,n))}}}beforeDestroy(e){var t;Pse.getInstance().detached(this._geometry,this),Pse.getInstance().hasReference(this._geometry)||this._geometry.destroy(e);for(let r=0;r<this._materials.length;r++){var n=this._materials[r];Pse.getInstance().detached(n,this),Pse.getInstance().hasReference(n)||n.destroy(e)}null!=(t=super.beforeDestroy)&&t.call(this,e)}destroy(e){super.destroy(e),this._geometry=null,this._materials=null,this._combineShaderRefection=null}}class Hse{constructor(e,t){bre(this,"mCount"),bre(this,"mBatchSize"),bre(this,"mBatchCount"),bre(this,"mMinIndexCount"),bre(this,"mOffset"),bre(this,"mIndexBuffer"),bre(this,"mDataBuffer"),bre(this,"mBatchBuffers"),bre(this,"mVertexShader"),bre(this,"mFragmentShader"),bre(this,"mRenderPipeline"),bre(this,"mRenderPipelineLayout"),bre(this,"mVertexBufferLayout"),bre(this,"mGPUPrimitiveTopology"),this.mMinIndexCount=e,this.mGPUPrimitiveTopology=t,this.mBatchSize=Math.trunc(65536/this.mMinIndexCount),this.init()}reset(){this.mCount=0,this.mOffset=0,this.mBatchCount=0}addShapeData(e){let t=e.shapeData;for(;0<t.length;){if(this.mOffset>=this.mDataBuffer.length&&this.flush(),this.mOffset+t.length<=this.mDataBuffer.length){this.mDataBuffer.set(t,this.mOffset),this.mOffset+=t.length;break}var n=this.mDataBuffer.length-this.mOffset;this.mDataBuffer.set(t.slice(0,n),this.mOffset),this.mOffset+=n,t=t.slice(n)}}flush(){if(0<this.mOffset){let e;this.mBatchCount<this.mBatchBuffers.length?e=this.mBatchBuffers[this.mBatchCount]:(e=Dre.device.createBuffer({size:this.mDataBuffer.byteLength,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST}),this.mBatchBuffers.push(e)),Dre.device.queue.writeBuffer(e,0,this.mDataBuffer,0,this.mOffset),this.mCount+=this.mOffset/8,this.mBatchCount++,this.mOffset=0}}render(e,t){var n=Dre.device;if(this.mRenderPipeline||(r=e.outAttachments,-1!=e.outColor&&(r[e.outColor].blend=zae.getBlend(Bae.NONE)),this.mRenderPipelineLayout=n.createPipelineLayout({bindGroupLayouts:[Cae.getGlobalDataBindGroupLayout()]}),n={label:"Graphic3DFixedRenderPipeline",layout:this.mRenderPipelineLayout,vertex:{module:this.mVertexShader,entryPoint:"main",buffers:[this.mVertexBufferLayout]},fragment:{module:this.mFragmentShader,entryPoint:"main",targets:r},primitive:{topology:this.mGPUPrimitiveTopology,cullMode:rie,frontFace:"ccw"}},e.depthTexture&&(n.depthStencil={depthWriteEnabled:!0,depthCompare:Qre,format:e.depthTexture.format}),this.mRenderPipeline=roe.createPipeline(n)),this.flush(),0<this.mBatchCount){t.setPipeline(this.mRenderPipeline),t.setIndexBuffer(this.mIndexBuffer,"uint16");var r=this.mCount/this.mMinIndexCount;for(let e=Math.trunc(r/this.mBatchSize)-1;0<=e;e--)t.setVertexBuffer(0,this.mBatchBuffers[e]),t.drawIndexed(this.mMinIndexCount*this.mBatchSize,1,0,0,0);0!=(r%=this.mBatchSize)&&(t.setVertexBuffer(0,this.mBatchBuffers[this.mBatchCount-1]),t.drawIndexed(this.mMinIndexCount*r,1,0,0,0))}}init(){var e=Dre.device,t=new Uint16Array(4*(Math.trunc(this.mMinIndexCount*this.mBatchSize/4)+1));for(let n=0;n<t.length;n++)t[n]=n;this.mIndexBuffer=e.createBuffer({size:t.byteLength,usage:GPUBufferUsage.INDEX|GPUBufferUsage.COPY_DST}),e.queue.writeBuffer(this.mIndexBuffer,0,t),this.mVertexBufferLayout={arrayStride:32,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float32x4"},{shaderLocation:1,offset:16,format:"float32x4"}]},this.mBatchBuffers=[],this.mDataBuffer=new Float32Array(8*t.length),this.mBatchBuffers.push(e.createBuffer({size:this.mDataBuffer.byteLength,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST})),this.mVertexShader=this.createShaderModule("Graphic3DFixedRenderPipeline.vs",Iie.parse('\n    #include "WorldMatrixUniform"\n    #include "GlobalUniform"\n\n    struct VertexAttributes {\n        @location(0) position: vec4<f32>,\n        @location(1) color: vec4<f32>,\n    }\n\n    struct VertexOutput {\n        @location(0) varying_WPos: vec4<f32>,\n        @location(1) varying_Color: vec4<f32>,\n        @builtin(position) member: vec4<f32>\n    };\n\n    @vertex\n    fn main( vertex:VertexAttributes ) -> VertexOutput {\n        var worldMatrix = models.matrix[u32(vertex.position.w)];\n        var worldPos = (worldMatrix * vec4<f32>(vertex.position.xyz, 1.0));\n        var viewPosition = ((globalUniform.viewMat) * worldPos);\n        var clipPosition = globalUniform.projMat * viewPosition;\n\n        var ORI_VertexOut: VertexOutput; \n        ORI_VertexOut.varying_WPos = worldPos;\n        ORI_VertexOut.varying_Color = vertex.color;\n        ORI_VertexOut.member = clipPosition;\n        return ORI_VertexOut;\n    }\n',{})),this.mFragmentShader=this.createShaderModule("Graphic3DFixedRenderPipeline.fs",Iie.parse("\n    struct FragmentOutput {\n        @location(0) color: vec4<f32>,\n        // #if USE_WORLDPOS\n            @location(1) worldPos: vec4<f32>,\n        // #endif\n        // #if USEGBUFFER\n            @location(2) worldNormal: vec4<f32>,\n            @location(3) material: vec4<f32>\n        // #endif\n    };\n\n    @fragment\n    fn main(  \n        @location(0) vWorldPos: vec4<f32>,\n        @location(1) varying_Color: vec4<f32>,\n    ) -> FragmentOutput {\n        var result: FragmentOutput;\n\n        // #if USE_WORLDPOS\n            result.worldPos = vWorldPos;\n        // #endif\n\n        // #if USEGBUFFER\n            // result.worldNormal = vec4<f32>(0.0, 0.0, 0.0, 1.0); \n            result.material = vec4<f32>(0.0, 1.0, 0.0, 0.0);\n        // #endif\n\n        result.color = varying_Color;\n        return result;\n    }\n",{})),this.reset()}createShaderModule(e,t){return(e=Dre.device.createShaderModule({label:e,code:t})).getCompilationInfo().then((e=>{0<e.messages.length&&(console.log(t),console.log(e))})),e}}class jse{}bre(jse,"ShapeVertexSize",8);class Wse{constructor(e){bre(this,"uuid"),bre(this,"type"),bre(this,"color"),bre(this,"count",0),bre(this,"shapeData"),bre(this,"dirtyData",!1),bre(this,"memoryDataIndex",-1),bre(this,"transformIndex"),this.transformIndex=e}buildAxis(e=new Rre(0,0,0),t=10){this.buildLines([e,new Rre(e.x+t,e.y,e.z)],wre.hexRGBColor(wre.RED)),this.buildLines([e,new Rre(e.x,e.y+t,e.z)],wre.hexRGBColor(wre.GREEN)),this.buildLines([e,new Rre(e.x,e.y,e.z+t)],wre.hexRGBColor(wre.BLUE))}buildLines(e,t=wre.COLOR_WHITE){if(!(e.length<2))if(2==e.length)this.fillShapeData(e,t);else{var n=new Array(e.length+e.length-2);for(let t=1,r=0;t<e.length;++t)n[r++]=e[t-1],n[r++]=e[t];this.fillShapeData(n,t)}}buildArcLine(e,t,n,r,i=16,a=Rre.Y_AXIS,s=wre.COLOR_WHITE){var o=(r-n)*jie,l=(n*=jie,[]);for(let h=0;h<=i;++h){1<h&&l.push(l[l.length-1]);var u=o*(h/i)+n,c=t*Math.cos(u),d=t*Math.sin(u);switch(a){case Rre.X_AXIS:l.push(e.add(new Rre(0,c,d)));break;case Rre.Y_AXIS:l.push(e.add(new Rre(c,0,d)));break;default:Rre.Z_AXIS,l.push(e.add(new Rre(c,d,0)))}}this.fillShapeData(l,s)}buildCircle(e,t,n=32,r=Rre.Y_AXIS,i=wre.COLOR_WHITE){var a=[];for(let u=0;u<=n;++u){var s=2*Math.PI*u/n,o=t*Math.cos(s),l=t*Math.sin(s);switch(r){case Rre.X_AXIS:a.push(e.add(new Rre(0,o,l)));break;case Rre.Y_AXIS:a.push(e.add(new Rre(o,0,l)));break;default:Rre.Z_AXIS,a.push(e.add(new Rre(o,l,0)))}0<u&&a.push(a[a.length-1])}a.push(a[0]),this.fillShapeData(a,i)}fillShapeData(e,t){this.shapeData?this.count+jse.ShapeVertexSize*e.length>=this.shapeData.length&&((n=new Float32Array(this.shapeData.length+jse.ShapeVertexSize*e.length)).set(this.shapeData),this.shapeData=n):this.shapeData=new Float32Array(jse.ShapeVertexSize*e.length);var n,r=this.shapeData;for(let a=0;a<e.length;++a){var i=e[a];r[this.count++]=i.x,r[this.count++]=i.y,r[this.count++]=i.z,r[this.count++]=this.transformIndex,t instanceof wre?(r[this.count++]=t.r,r[this.count++]=t.g,r[this.count++]=t.b,r[this.count++]=t.a):(i=t[a],r[this.count++]=i.r,r[this.count++]=i.g,r[this.count++]=i.b,r[this.count++]=i.a)}this.dirtyData=!0}reset(){this.count=0}}class Yse extends Gse{constructor(e,t){super(),bre(this,"shapes"),bre(this,"mDirtyData",!1),bre(this,"mMinIndexCount"),bre(this,"mGPUPrimitiveTopology"),bre(this,"mRenderPipeline"),this.alwaysRender=!0,this.mMinIndexCount=e,this.mGPUPrimitiveTopology=t,this.shapes=new Map,this.addRendererMask(bie.Particle)}fillShapeData(e,t,n,r){this.mDirtyData=!0,this.shapes.has(e)?(i=this.shapes.get(e)).shapeData.length<jse.ShapeVertexSize*r.length&&(i.shapeData=new Float32Array(jse.ShapeVertexSize*r.length)):((i=new Wse(this.transform._worldMatrix.index)).type=t,i.color=n,i.shapeData=new Float32Array(jse.ShapeVertexSize*r.length));var i,a=i.shapeData,s=this.transform._worldMatrix.index;for(let l=0,u=0;l<r.length;++l){var o=r[l];a[u++]=o.x,a[u++]=o.y,a[u++]=o.z,a[u++]=s,a[u++]=n.r,a[u++]=n.g,a[u++]=n.b,a[u++]=n.a}this.shapes.set(e,i)}init(){super.init(),this.castGI=!1,this.castShadow=!1,this.mRenderPipeline=new Hse(this.mMinIndexCount,this.mGPUPrimitiveTopology)}removeShape(e){this.shapes.has(e)&&(this.mDirtyData=!0,this.shapes.delete(e))}initPipeline(){this.object3D.bound=new gae(Rre.ZERO,Rre.MAX),this._readyPipeline=!0}nodeUpdate(e,t,n,r){this.mDirtyData&&(this.mRenderPipeline.reset(),this.shapes.forEach(((e,t)=>{this.mRenderPipeline.addShapeData(e)})),this.mDirtyData=!1)}renderPass2(e,t,n,r,i,a=0){this.mRenderPipeline.render(n,i)}allocGraphics3DShape(e,t){let n;return this.shapes.has(e)?(n=this.shapes.get(e)).reset():((n=new Wse(t)).uuid=e,n.type="line",n.color=wre.COLOR_WHITE,this.shapes.set(n.uuid,n)),this.mDirtyData=!0,n}}class $se{constructor(){bre(this,"opaqueList",[]),bre(this,"transparentList",[]),bre(this,"offset",0),bre(this,"sky")}clean(){this.opaqueList.length=0,this.transparentList.length=0,this.offset=0}}class Xse{constructor(){bre(this,"renderGroup"),this.renderGroup=new Map}collect_add(e){let t="",n="";t+=e.geometry.uuid;for(let i=0;i<e.materials.length;i++){n+=e.materials[i].renderShader.shaderVariant}var r=t+n;this.renderGroup.has(r)||this.renderGroup.set(r,{bundleMap:new Map,key:r,renderNodes:[]}),-1==this.renderGroup.get(r).renderNodes.indexOf(e)&&this.renderGroup.get(r).renderNodes.push(e)}}const qse=class{constructor(){bre(this,"_sceneLights"),bre(this,"_sceneGIProbes"),bre(this,"_source_opaqueRenderNodes"),bre(this,"_source_transparentRenderNodes"),bre(this,"_graphics"),bre(this,"_op_renderGroup"),bre(this,"_tr_renderGroup"),bre(this,"state",{giLightingChange:!0}),bre(this,"sky"),bre(this,"_collectInfo"),this._sceneLights=new Map,this._sceneGIProbes=new Map,this._source_opaqueRenderNodes=new Map,this._source_transparentRenderNodes=new Map,this._graphics=[],this._op_renderGroup=new Map,this._tr_renderGroup=new Map,this._collectInfo=new $se}static get instance(){return this._instance||(this._instance=new qse),this._instance}getPashList(e,t){return t.renderOrder<3e3?this._source_opaqueRenderNodes.get(e):3e3<=t.renderOrder?this._source_transparentRenderNodes.get(e):void 0}sortRenderNode(e,t){for(let n=e.length-1;0<n;n--)if(e[n].renderOrder<t.renderOrder)return void e.push(t);e.push(t)}addRenderNode(e,t){var n;e&&(t.hasMask(bie.Sky)?this.sky=t:t instanceof Yse?-1==this._graphics.indexOf(t)&&this._graphics.push(t):mae.hasMask(t.object3D.renderLayer,fae.None)?(this.removeRenderNode(e,t),t.renderOrder<3e3?(this._source_opaqueRenderNodes.has(e)||this._source_opaqueRenderNodes.set(e,[]),this._source_opaqueRenderNodes.get(e).push(t)):3e3<=t.renderOrder&&(this._source_transparentRenderNodes.has(e)||this._source_transparentRenderNodes.set(e,[]),this._source_transparentRenderNodes.get(e).push(t)),-1==(n=this.getPashList(e,t)).indexOf(t)&&this.sortRenderNode(n,t)):(this.removeRenderNode(e,t),t.renderOrder<3e3?(this._op_renderGroup.has(e)||this._op_renderGroup.set(e,new Xse),this._op_renderGroup.get(e).collect_add(t)):3e3<=t.renderOrder&&(this._tr_renderGroup.has(e)||this._tr_renderGroup.set(e,new Xse),this._tr_renderGroup.get(e).collect_add(t))),t.object3D.renderNode=t)}removeRenderNode(e,t){t.hasMask(bie.Sky)?this.sky=null:mae.hasMask(t.object3D.renderLayer,fae.None)&&(e=this.getPashList(e,t))&&-1!=(t=e.indexOf(t))&&e.splice(t,1)}addLight(e,t){var n;this._sceneLights.has(e)?(n=this._sceneLights.get(e)).length>=nce.setting.light.maxLight?console.warn("Alreay meet maxmium light number:",nce.setting.light.maxLight):-1==n.indexOf(t)&&n.push(t):this._sceneLights.set(e,[t])}removeLight(e,t){this._sceneLights.has(e)&&-1!=(t=(e=this._sceneLights.get(e)).indexOf(t))&&e.splice(t,1)}getLights(e){return this._sceneLights.get(e)||[]}addGIProbe(e,t){this._sceneGIProbes.has(e)?this._sceneGIProbes.get(e).push(t):this._sceneGIProbes.set(e,[t])}removeGIProbe(e,t){this._sceneGIProbes.has(e)&&-1!=(t=(e=this._sceneGIProbes.get(e)).indexOf(t))&&e.splice(t,1)}getProbes(e){return this._sceneGIProbes.get(e)||[]}autoSortRenderNodes(e){var t;if(e=this._source_transparentRenderNodes.get(e)){let n=!1;for(const t of e)if(t.isRenderOrderChange||t.needSortOnCameraZ){n=!0;break}if(n){for(const n of e){let e=n.renderOrder;n.needSortOnCameraZ&&(t=Mae.worldToCameraDepth(n.object3D),e+=t=1-Math.max(0,Math.min(1,t))),n.__renderOrder=e,n.isRenderOrderChange=!1}e.sort(((e,t)=>e.__renderOrder>t.__renderOrder?1:-1))}return this}}getRenderNodes(e){var t;return this._collectInfo.clean(),this._collectInfo.sky=this.sky,(t=((t=this._source_opaqueRenderNodes.get(e))&&(this._collectInfo.opaqueList=t.concat(),this._collectInfo.offset=t.length),this._source_transparentRenderNodes.get(e)))&&(this._collectInfo.transparentList=t.concat()),this._collectInfo}getOpRenderGroup(e){return this._op_renderGroup.get(e)}getTrRenderGroup(e){return this._tr_renderGroup.get(e)}getGraphicList(){return this._graphics}};let Kse=qse;bre(Kse,"_instance");class Zse{constructor(){bre(this,"setting"),bre(this,"probesBufferData"),bre(this,"probesBuffer"),bre(this,"isVolumeFrameChange",!0),bre(this,"randomOrientation"),bre(this,"startPosition",new Rre),bre(this,"isVolumeChange",!0),bre(this,"irradianceVolumeBuffer"),bre(this,"directionDistance",20),bre(this,"randomSeedCount",3),bre(this,"useRandomIndex",0),bre(this,"centerDirection",new Rre(0,0,this.directionDistance).normalize(1)),bre(this,"arroundPositions",[]),bre(this,"debugX",0),bre(this,"debugY",0),bre(this,"debugZ",0)}updateOrientation(){return this.useRandomIndex++,this.useRandomIndex>=this.arroundPositions.length&&(this.useRandomIndex=0),Kie.fromToRotation(this.centerDirection,this.arroundPositions[this.useRandomIndex],this.randomOrientation),this.randomOrientation}init(e){this.setting=e,this.randomOrientation=new Kie(!1),this.randomOrientation.identity(),this.irradianceVolumeBuffer=new Aie(80),this.createFramesBuffer(),this.arroundPositions.push(this.centerDirection.clone());for(let n=0;n<this.randomSeedCount;n++){var t=2*Math.PI*n/this.randomSeedCount;t=new Rre(Math.sin(t),Math.cos(t),this.directionDistance).normalize(1);this.arroundPositions.push(t)}}setVolumeDataChange(){this.isVolumeChange=!0}updateProbes(e){var t,n=this.probesBufferData;for(t of e)n[3+4*t.index]=t.drawCallFrame}createFramesBuffer(){var e;this.probesBufferData||(e=this.setting.probeXCount*this.setting.probeYCount*this.setting.probeZCount,this.probesBufferData=new Float32Array(4*e),this.probesBufferData.fill(-1),this.probesBuffer=new Aie(4*e,GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST))}uploadBuffer(){this.isVolumeChange&&(this.fillIrradianceData(),this.isVolumeChange=!1,this.isVolumeFrameChange=!0),this.probesBuffer.setFloat32Array("uniformFramesBuffer",this.probesBufferData)}calcPosition(e,t,n,r){var i=this.setting,a=this.setting.probeSpace;return(r=r||new Rre).x=e*a-a*(i.probeXCount-1)*.5+i.offsetX,r.y=t*a-a*(i.probeYCount-1)*.5+i.offsetY,r.z=n*a-a*(i.probeZCount-1)*.5+i.offsetZ,r}fillIrradianceData(){var e=this.setting,t=this.calcPosition(0,0,0,this.startPosition);this.irradianceVolumeBuffer.setFloat("orientationIndex",this.randomOrientation.index),this.irradianceVolumeBuffer.setFloat("hysteresis",e.hysteresis),this.irradianceVolumeBuffer.setFloat("OctRTSideSize",e.octRTSideSize),this.irradianceVolumeBuffer.setFloat("OctRTMaxSize",e.octRTMaxSize),this.irradianceVolumeBuffer.setFloat("startX",t.x),this.irradianceVolumeBuffer.setFloat("startY",t.y),this.irradianceVolumeBuffer.setFloat("startZ",t.z),this.irradianceVolumeBuffer.setFloat("ProbeSpace",e.probeSpace),this.irradianceVolumeBuffer.setFloat("probeXCount",e.probeXCount),this.irradianceVolumeBuffer.setFloat("probeYCount",e.probeYCount),this.irradianceVolumeBuffer.setFloat("probeZCount",e.probeZCount),this.irradianceVolumeBuffer.setFloat("maxDistance",1.732*e.probeSpace),this.irradianceVolumeBuffer.setFloat("depthSharpness",e.depthSharpness),this.irradianceVolumeBuffer.setFloat("ProbeSourceTextureSize",e.probeSourceTextureSize),this.irradianceVolumeBuffer.setFloat("ProbeSize",e.probeSize),this.irradianceVolumeBuffer.setFloat("bounceIntensity",e.bounceIntensity),this.irradianceVolumeBuffer.setFloat("probeRoughness",e.probeRoughness),this.irradianceVolumeBuffer.setFloat("normalBias",e.normalBias),this.irradianceVolumeBuffer.setFloat("irradianceChebyshevBias",e.irradianceChebyshevBias),this.irradianceVolumeBuffer.setFloat("rayNumber",e.rayNumber),this.irradianceVolumeBuffer.setFloat("irradianceDistanceBias",e.irradianceDistanceBias),this.irradianceVolumeBuffer.setFloat("indirectIntensity",e.indirectIntensity),this.irradianceVolumeBuffer.setFloat("ddgiGamma",e.ddgiGamma),this.irradianceVolumeBuffer.setFloat("lerpHysteresis",e.lerpHysteresis),this.irradianceVolumeBuffer.setFloat("debugX",this.debugX),this.irradianceVolumeBuffer.setFloat("debugY",this.debugY),this.irradianceVolumeBuffer.setFloat("debugZ",this.debugZ),this.irradianceVolumeBuffer.apply()}}class Jse{constructor(){bre(this,"storageGPUBuffer"),bre(this,"irradianceVolume"),bre(this,"_lightList",[]),this.storageGPUBuffer=new Aie(tae.lightSize*nce.setting.light.maxLight,GPUBufferUsage.COPY_SRC),this.irradianceVolume=new Zse,this.irradianceVolume.init(nce.setting.gi);for(let t=0;t<nce.setting.light.maxLight;t++){var e=this.storageGPUBuffer.memory.allocation_node(4*tae.lightSize);this._lightList.push(e)}this.storageGPUBuffer.visibility=GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT|GPUShaderStage.COMPUTE}update(e){this.storageGPUBuffer.clean();var t=Kse.instance.getLights(e.scene);for(let r=0;r<t.length;r++){var n=t[r].lightData;n.index=r,this.writeLightBytes(n,this._lightList[r])}this.storageGPUBuffer.apply()}writeLightBytes(e,t){t.offset=0,t.writeFloat(e.index),t.writeInt32(e.lightType),t.writeFloat(e.radius),t.writeFloat(e.linear),t.writeVector3(e.lightPosition),t.writeFloat(e.lightMatrixIndex),t.writeVector3(e.direction),t.writeFloat(e.quadratic),t.writeRGBColor(e.lightColor),t.writeFloat(e.intensity),t.writeFloat(e.innerAngle),t.writeFloat(e.outerAngle),t.writeFloat(e.range),t.writeInt32(e.castShadowIndex),t.writeVector3(e.lightTangent),t.writeFloat(e.iesIndex)}}class Qse{constructor(){bre(this,"gpuBuffer"),bre(this,"probes"),bre(this,"memoryDo"),bre(this,"_probeInfoList")}initDataUniform(e){this.memoryDo=new Tie,this.probes=e,this._probeInfoList=[],this.memoryDo.destroy(),this.memoryDo.allocation(17*e.length*4);for(let r=0;r<e.length;r++){var t=this.memoryDo.allocation_node(68),n=(this._probeInfoList.push(t),e[r].transform.worldPosition);t.setArray(0,[n.x,n.y,n.z])}this.gpuBuffer=Dre.device.createBuffer({size:this.memoryDo.shareDataBuffer.byteLength,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.STORAGE,label:"ProbeBuffer",mappedAtCreation:!1})}updateGPUBuffer(){var e=this.memoryDo.shareDataBuffer;let t=this.memoryDo.shareDataBuffer.byteLength,n=0;for(;n<t;)Dre.device.queue.writeBuffer(this.gpuBuffer,n,e,n,Math.floor(Math.min(32e4,t-n))),n+=32e4}}class eoe{constructor(){bre(this,"uuid"),bre(this,"index"),bre(this,"usage"),bre(this,"groupBufferSize"),bre(this,"matrixBufferDst"),this.uuid=Rie(),this.groupBufferSize=0,this.usage=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST,this.cacheWorldMatrix()}cacheWorldMatrix(){this.groupBufferSize=Kie.maxCount*Kie.blockBytes,this.matrixBufferDst=new Aie(this.groupBufferSize/4),this.matrixBufferDst.visibility=GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT|GPUShaderStage.COMPUTE,this.matrixBufferDst.buffer.label=this.groupBufferSize.toString()}writeBuffer(){var e=Kie.matrixBytes;let t=e.byteLength,n=0;for(;n<t;){var r=Math.min(32e4,t-n);Dre.device.queue.writeBuffer(this.matrixBufferDst.buffer,n,e.buffer,e.byteOffset+n,r),n+=r}}}class toe{static init(){this.modelMatrixBindGroup=new eoe,this._cameraBindGroups=new Map,this._lightEntriesMap=new Map}static getCameraGroup(e){let t=this._cameraBindGroups.get(e);return t||(t=new Tae(this.modelMatrixBindGroup),this._cameraBindGroups.set(e,t)),e.isShadowCamera?t.setShadowCamera(e):t.setCamera(e),t}static getLightEntries(e){var t;return e||console.log("getLightEntries scene is null"),this._lightEntriesMap.get(e)||(t=new Jse,this._lightEntriesMap.set(e,t)),this._lightEntriesMap.get(e)}static updateProbes(e){this._probeEntries||(this._probeEntries=new Qse,this._probeEntries.initDataUniform(e))}}bre(toe,"_cameraBindGroups"),bre(toe,"_lightEntriesMap"),bre(toe,"_probeEntries"),bre(toe,"modelMatrixBindGroup");const noe=class{static bindPipeline(e,t){if(noe.lastShader!=t){noe.lastShader=t,noe.lastPipeline!=t.pipeline&&(noe.lastPipeline=t.pipeline,e.setPipeline(t.pipeline));for(let r=1;r<t.bindGroups.length;r++){var n=t.bindGroups[r];n&&e.setBindGroup(r,n)}}}static bindCamera(e,t){t=toe.getCameraGroup(t),e.setBindGroup(0,t.globalBindGroup)}static bindGeometryBuffer(e,t){if(this.lastGeometry!=t){(this.lastGeometry=t).indicesBuffer&&e.setIndexBuffer(t.indicesBuffer.indicesGPUBuffer.buffer,t.indicesBuffer.indicesFormat);var n=t.vertexBuffer.vertexGPUBuffer,r=t.vertexBuffer.vertexBufferLayouts;for(let t=0;t<r.length;t++){var i=r[t];e.setVertexBuffer(t,n.buffer,i.offset,i.size)}}}static cleanCache(){this.lastGeometry=null,this.lastPipeline=null,this.lastShader=null}static createPipeline(e){return zie.countStart("GPUContext","pipeline"),Dre.device.createRenderPipeline(e)}static beginCommandEncoder(){return zie.countStart("GPUContext","beginCommandEncoder"),this.LastCommand&&Dre.device.queue.submit([this.LastCommand.finish()]),this.LastCommand=Dre.device.createCommandEncoder(),this.LastCommand}static endCommandEncoder(e){this.LastCommand==e&&(Dre.device.queue.submit([this.LastCommand.finish()]),this.LastCommand=null,zie.countStart("GPUContext","endCommandEncoder"))}static recordBundleEncoder(e){return Dre.device.createRenderBundleEncoder(e)}static beginRenderPass(e,t){var n;if(this.cleanCache(),this.renderPassCount++,(this.lastRenderPassState=t).renderTargets&&0<t.renderTargets.length)for(let a=0;a<t.renderTargets.length;++a){var r=t.renderTargets[a],i=t.renderPassDescriptor.colorAttachments[a];0<t.multisample&&1==t.renderTargets.length?(i.view=t.multiTexture.createView(),i.resolveTarget=r.getGPUView()):i.view=r.getGPUTexture().createView()}else(n=t.renderPassDescriptor.colorAttachments[0])&&(0<t.multisample?(n.view=t.multiTexture.createView(),n.resolveTarget=Dre.context.getCurrentTexture().createView()):n.view=Dre.context.getCurrentTexture().createView());return e.beginRenderPass(t.renderPassDescriptor)}static drawIndexed(e,t,n,r,i,a){e.drawIndexed(t,n,r,i,a),this.drawCount++}static draw(e,t,n,r,i){e.draw(t,n,r,i),this.drawCount++}static endPass(e){e.insertDebugMarker("end"),e.end()}static computeCommand(e,t){var n=e.beginComputePass();for(let r=0;r<t.length;r++)t[r].compute(n);n.end()}};let roe=noe;bre(roe,"lastGeometry"),bre(roe,"lastPipeline"),bre(roe,"lastShader"),bre(roe,"drawCount",0),bre(roe,"renderPassCount",0),bre(roe,"geometryCount",0),bre(roe,"pipelineCount",0),bre(roe,"matrixCount",0),bre(roe,"lastRenderPassState"),bre(roe,"LastCommand");class ioe{constructor(){bre(this,"source"),bre(this,"input"),bre(this,"output")}reset(e){this.input&&this.input.destroy(),this.output&&this.output.destroy(),this.input=this.output=null,this.source=e}apply(e){var t;this.source&&(this.input||(t=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST,this.input=new Aie(this.source.length,t,this.source),this.input.apply()),this.output||(t=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST|GPUBufferUsage.COPY_SRC,this.output=new Aie(3*e,t),this.output.apply()))}}class aoe{constructor(){bre(this,"enable"),bre(this,"morphTargetsRelative"),bre(this,"MaxMorphTargetCount",64),bre(this,"_computeConfigArray"),bre(this,"_computeConfigBuffer"),bre(this,"_morphInfluenceArray"),bre(this,"_morphInfluenceBuffer"),bre(this,"_positionAttrDataGroup"),bre(this,"_normalAttrDataGroup"),bre(this,"_isInfluenceDirty"),bre(this,"_morphTargetCount"),bre(this,"_totalVertexCount"),bre(this,"_computeShader"),bre(this,"_computeShaders"),bre(this,"_computeWorkGroupXY",1),bre(this,"_collectMorphTargetData"),this._isInfluenceDirty=!0,this.generateGPUBuffer(),this._positionAttrDataGroup=new ioe,this._normalAttrDataGroup=new ioe}initMorphTarget(e){this._collectMorphTargetData=this.collectMorphTargetList(e),this._computeShader&&this._computeShader.destroy(),e=Bre.CsMain,this._computeShader=new Uie(e),this._collectMorphTargetData.mergedNormal?this._computeShader.setDefine("USE_MORPHNORMALS",!0):this._computeShader.deleteDefine("USE_MORPHNORMALS"),this._computeShaders=[this._computeShader],this._isInfluenceDirty=!0,this._morphTargetCount=this._collectMorphTargetData.mtCount,this._totalVertexCount=this._collectMorphTargetData.vCount,this._morphInfluenceArray.fill(0),this._computeWorkGroupXY=this.calcWorkGroup(this._totalVertexCount),this._positionAttrDataGroup.reset(this._collectMorphTargetData.mergedPos),this._normalAttrDataGroup.reset(this._collectMorphTargetData.mergedNormal)}applyRenderShader(e){this.uploadMorphTargetBuffer(),this.uploadConfigGBuffer(),e.setUniformBuffer("morphTargetConfig",this._computeConfigBuffer),e.setStorageBuffer("morphTargetOpPositions",this._positionAttrDataGroup.output),this._collectMorphTargetData.mergedNormal&&e.setStorageBuffer("morphTargetOpNormals",this._normalAttrDataGroup.output)}computeMorphTarget(e){this.uploadConfigGBuffer(),this.uploadMorphTargetBuffer(),this._computeShader.setUniformBuffer("morphTargetConfig",this._computeConfigBuffer),this._computeShader.setStorageBuffer("morphTargetInfluence",this._morphInfluenceBuffer),this._computeShader.setStorageBuffer("morphTargetPositions",this._positionAttrDataGroup.input),this._computeShader.setStorageBuffer("morphTargetOpPositions",this._positionAttrDataGroup.output),this._collectMorphTargetData.mergedNormal&&(this._computeShader.setStorageBuffer("morphTargetNormals",this._normalAttrDataGroup.input),this._computeShader.setStorageBuffer("morphTargetOpNormals",this._normalAttrDataGroup.output)),this._computeShader.workerSizeX=this._computeWorkGroupXY,this._computeShader.workerSizeY=this._computeWorkGroupXY,this._computeShader.workerSizeZ=1,roe.computeCommand(e,this._computeShaders)}updateInfluence(e,t){this._isInfluenceDirty=!0,this._morphInfluenceArray[e]=t}collectMorphTargetList(e){var t=this.collectAttribute("a_morphPositions_",e),n=t.length,r=t[0].data.length/3,i=new Float32Array(r*n*3);{let e=0;for(let r=0;r<n;r++){var a=t[r];i.set(a.data,e),e+=a.data.length}}let s,o=this.collectAttribute("a_morphNormals_",e);if(o&&0<o.length){let e=0;s=new Float32Array(r*n*3);for(let t=0;t<n;t++){var l=o[t];s.set(l.data,e),e+=l.data.length}}return{mtCount:n,vCount:r,mergedPos:i,mergedNormal:s}}collectAttribute(e,t){var n=[];for(let i=0;i<this.MaxMorphTargetCount;i++){var r=e+i;if(!(r=t.getAttribute(r)))break;n[i]=r}return n}uploadConfigGBuffer(){if(this._isInfluenceDirty){let e=0;for(let t=0;t<this._morphTargetCount;t++)e+=this._morphInfluenceArray[t];this._morphInfluenceBuffer.setFloat32Array("data",this._morphInfluenceArray),this._morphInfluenceBuffer.apply(),this._computeConfigArray[0]=this.morphTargetsRelative?1:1-e,this._computeConfigArray[1]=this._morphTargetCount,this._computeConfigArray[2]=this._totalVertexCount,this._computeConfigArray[3]=this._computeWorkGroupXY,this._computeConfigBuffer.setFloat32Array("data",this._computeConfigArray),this._computeConfigBuffer.apply(),this._isInfluenceDirty=!1}}calcWorkGroup(e){return e=Math.ceil(Math.sqrt(e)),e=Math.ceil(Math.log2(e)),Math.pow(2,e)}uploadMorphTargetBuffer(){this._positionAttrDataGroup.output||this._positionAttrDataGroup.apply(this._totalVertexCount),this._normalAttrDataGroup.output||this._normalAttrDataGroup.apply(this._totalVertexCount)}generateGPUBuffer(){this._computeConfigArray=new Float32Array(4),this._computeConfigBuffer=new Pie(4),this._morphInfluenceArray=new Float32Array(this.MaxMorphTargetCount);var e=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST;this._morphInfluenceBuffer=new Aie(this.MaxMorphTargetCount,e)}}class soe extends Gse{constructor(){super(),bre(this,"receiveShadow"),bre(this,"morphData")}onEnable(){super.onEnable()}onDisable(){super.onDisable()}get geometry(){return this._geometry}set geometry(e){var t=null!=(super.geometry=e).morphTargetDictionary;t&&(this.morphData||(this.morphData=new aoe),this.morphData.morphTargetsRelative=e.morphTargetsRelative,this.morphData.initMorphTarget(e)),this.morphData&&(this.morphData.enable=t),this.morphData&&this.morphData.enable?this.addRendererMask(bie.MorphTarget):(this.removeRendererMask(bie.MorphTarget),this.onCompute=null),this.object3D.bound=this._geometry.bounds.clone(),this._readyPipeline&&this.initPipeline()}get material(){return this._materials[0]}set material(e){this.materials=[e]}setMorphInfluence(e,t){this.morphData&&this.morphData.enable&&0<=(e=this._geometry.morphTargetDictionary[e])&&this.morphData.updateInfluence(e,t)}setMorphInfluenceIndex(e,t){this.morphData&&this.morphData.enable&&0<=e&&this.morphData.updateInfluence(e,t)}onCompute(e,t){this.morphData&&this.morphData.enable&&this.morphData.computeMorphTarget(t)}nodeUpdate(e,t,n,r){if(this.morphData&&this.morphData.enable)for(let s=0;s<this.materials.length;s++){var i=this.materials[s].renderPasses.get(t);if(i)for(let e=0;e<i.length;e++){var a=i[e].renderShader;this.morphData.applyRenderShader(a)}}super.nodeUpdate(e,t,n,r)}destroy(e){super.destroy(e)}cloneTo(e){(e=e.addComponent(soe)).geometry=this.geometry,e.material=this.material,e.castShadow=this.castShadow,e.castGI=this.castGI,e.receiveShadow=this.receiveShadow,e.rendererMask=this.rendererMask}}class ooe{constructor(){bre(this,"label",""),bre(this,"customSize",!1),bre(this,"zPreTexture",null),bre(this,"depthTexture",null),bre(this,"outAttachments"),bre(this,"outColor",-1),bre(this,"renderTargets"),bre(this,"rtTextureDescripts"),bre(this,"irradianceBuffer"),bre(this,"multisample",0),bre(this,"multiTexture"),bre(this,"depthViewIndex",0),bre(this,"depthCleanValue",0),bre(this,"isOutTarget",!0),bre(this,"camera3D"),bre(this,"rtFrame"),bre(this,"renderPassDescriptor"),bre(this,"renderBundleEncoderDescriptor"),bre(this,"depthLoadOp")}getLastRenderTexture(){return this.renderTargets&&0<this.renderTargets.length?this.renderTargets[0]:nce.res.redTexture}}const loe=class{static createRendererPassState(e,t=null){var n=new ooe;if(n.label=e.label,n.customSize=e.customSize,n.rtFrame=e,n.zPreTexture=e.zPreTexture,n.depthTexture=e.depthTexture,n.depthViewIndex=e.depthViewIndex,n.isOutTarget=e.isOutTarget,n.depthCleanValue=e.depthCleanValue,n.depthLoadOp=e.depthLoadOp,e&&0<e.attachments.length){n.renderTargets=e.attachments,n.rtTextureDescripts=e.rtDescriptors,n.renderPassDescriptor=loe.getRenderPassDescriptor(n),n.renderBundleEncoderDescriptor=loe.getRenderBundleDescriptor(n),n.outAttachments=[];for(let t=0;t<e.attachments.length;t++){var r=e.attachments[t];n.outAttachments[t]={format:r.format},-1!=r.name.indexOf(_ie.colorBufferTex_NAME)&&(n.outColor=t)}}else n.renderPassDescriptor=loe.getRenderPassDescriptor(n,t),n.renderBundleEncoderDescriptor=loe.getRenderBundleDescriptor(n),n.outAttachments=[{format:Dre.presentationFormat}],n.outColor=0;return n}static getRenderPassDescriptor(e,t=null){Dre.device,Dre.presentationSize;var n,r=[];if(e.renderTargets&&0<e.renderTargets.length){e.renderTargets[0].width,e.renderTargets[0].height;for(let t=0;t<e.renderTargets.length;t++){var i=e.renderTargets[t],a=e.rtTextureDescripts[t];r.push({view:i.getGPUView(),resolveTarget:void 0,loadOp:a.loadOp,clearValue:a.clearValue,storeOp:a.storeOp})}}else e.customSize||(n=Dre.canvasConfig&&Dre.canvasConfig.alpha?[1,1,1,0]:[0,0,0,1],1==e.isOutTarget&&r.push({view:void 0,resolveTarget:void 0,loadOp:Dre.canvasConfig&&Dre.canvasConfig.alpha||null!=t?"load":"clear",clearValue:n,storeOp:"store"}));let s=null;return s=e.depthTexture||e.zPreTexture?(e.zPreTexture&&(e.depthTexture=e.zPreTexture),{label:e.label+" renderPassDescriptor zPreTexture"+(e.zPreTexture?"load":"clear"),colorAttachments:r,depthStencilAttachment:{view:e.depthTexture.getGPUView(),depthLoadOp:e.zPreTexture?"load":e.depthLoadOp,depthClearValue:e.zPreTexture?1:e.depthCleanValue,depthStoreOp:"store"}}):{colorAttachments:r,label:"renderPassDescriptor not writeDepth"},this.renderPassDescriptorCount++,s}static getRenderBundleDescriptor(e){Dre.presentationSize;var t=[];if(e.renderTargets&&0<e.renderTargets.length){e.renderTargets[0].width,e.renderTargets[0].height;for(let r=0;r<e.renderTargets.length;r++){var n=e.renderTargets[r];t.push(n.format)}}let r=null;return r=e.depthTexture?{colorFormats:t,depthStencilFormat:e.depthTexture.format}:{colorFormats:t},this.renderPassDescriptorCount++,r}};let uoe=loe;bre(uoe,"bindGroupDescriptorCount",0),bre(uoe,"bindTextureDescriptorCount",0),bre(uoe,"renderPassDescriptorCount",0),bre(uoe,"pipelineDescriptorCount",0);class coe extends Mie{constructor(e){super(),bre(this,"node"),this.bufferType=Eie.VertexGPUBuffer,this.createVertexBuffer(GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST|GPUBufferUsage.VERTEX,e)}createVertexBuffer(e,t){var n=Dre.device;this.byteSize=t*Float32Array.BYTES_PER_ELEMENT,this.usage=e,this.buffer&&this.destroy(),this.buffer=n.createBuffer({size:this.byteSize,usage:e,mappedAtCreation:!1}),this.memory.allocation(this.byteSize),this.node=this.memory.allocation_node(this.byteSize)}}var doe=(e=>(e[e.split=0]="split",e[e.compose=1]="compose",e))(doe||{});class hoe{constructor(){bre(this,"vertexCount",0),bre(this,"vertexGPUBuffer"),bre(this,"geometryType",doe.compose),bre(this,"_vertexBufferLayouts"),bre(this,"_attributeSlotLayouts"),bre(this,"_attributeLocation"),this._vertexBufferLayouts=[],this._attributeLocation={},this._attributeSlotLayouts=[]}get vertexBufferLayouts(){return this._vertexBufferLayouts}createVertexBuffer(e,t){switch(this.geometryType){case doe.split:this.createSplitVertexBuffer(e,t);break;case doe.compose:this.createComposeVertexBuffer(e,t)}}createSplitVertexBuffer(e,t){let n=0;for(let a=0;a<t.attributes.length;a++){var r=t.attributes[a];if("index"!=r.name){this._attributeLocation[r.name]=r.location;var i={name:r.name,format:r.format,offset:0,shaderLocation:r.location,stride:kie[r.format]};this._attributeSlotLayouts[r.location]=[i];let t=e.get(r.name);t||(t={attribute:r.name,data:new Float32Array(r.size*this.vertexCount)},e.set(r.name,t)),i=t.data.length/i.stride,0!=this.vertexCount&&this.vertexCount!=i&&console.error(" vertex count not match attribute count"),this.vertexCount=i,this._vertexBufferLayouts[r.location]={name:r.name,arrayStride:4*r.size,stepMode:"vertex",attributes:this._attributeSlotLayouts[r.location],offset:4*n,size:this.vertexCount*r.size*4},n+=this.vertexCount*r.size}}this.vertexGPUBuffer=new coe(n)}createComposeVertexBuffer(e,t){this._attributeSlotLayouts[0]=[];let n=0;for(let a=0;a<t.attributes.length;a++){var r=t.attributes[a];if("index"!=r.name){this._attributeLocation[r.name]=r.location;var i={name:r.name,format:r.format,offset:4*n,shaderLocation:r.location,stride:kie[r.format]};this._attributeSlotLayouts[0][r.location]=i;let t=e.get(r.name);t||(t={attribute:r.name,data:new Float32Array(r.size*this.vertexCount)},e.set(r.name,t)),i=t.data.length/i.stride,0!=this.vertexCount&&this.vertexCount!=i&&console.error(" vertex count not match attribute count"),this.vertexCount=i,n+=r.size}}this._vertexBufferLayouts[0]={name:"composeStruct",arrayStride:4*n,stepMode:"vertex",attributes:this._attributeSlotLayouts[0],offset:0,size:this.vertexCount*n*4},this.vertexGPUBuffer=new coe(this.vertexCount*n)}upload(e,t){var n;switch(this.geometryType){case doe.split:var r=this._attributeLocation[e];r=this._vertexBufferLayouts[r];this.vertexGPUBuffer.node.setFloat32Array(r.offset/4,t.data);break;case doe.compose:for(let n=0;n<this.vertexCount;n++){var i=this._attributeSlotLayouts[0][this._attributeLocation[e]];for(let e=0;e<i.stride;e++){var a=t.data[n*i.stride+e],s=n*(this._vertexBufferLayouts[0].arrayStride/4)+i.offset/4+e;this.vertexGPUBuffer.node.setFloat(a,s)}}}null!=(n=this.vertexGPUBuffer)&&n.apply()}updateAttributes(e){switch(this.geometryType){case doe.split:for(let r=0;r<this._vertexBufferLayouts.length;r++){var t=this._vertexBufferLayouts[r],n=e.get(t.name);this.vertexGPUBuffer.node.setFloat32Array(t.offset/4,n.data)}break;case doe.compose:for(let t=0;t<this.vertexCount;t++)this._attributeSlotLayouts.forEach((n=>{for(let o=0;o<n.length;o++){var r=n[o],i=e.get(r.name);for(let e=0;e<r.stride;e++){var a=i.data[t*r.stride+e],s=t*(this._vertexBufferLayouts[0].arrayStride/4)+r.offset/4+e;this.vertexGPUBuffer.node.setFloat(a,s)}}}))}this.vertexGPUBuffer.apply()}compute(){}destroy(e){this.vertexCount=null,this.geometryType=null,this._vertexBufferLayouts=null,this._attributeSlotLayouts=null,this._attributeLocation=null,this.vertexGPUBuffer.destroy(e),this.vertexGPUBuffer=null}}class poe extends Mie{constructor(e){super(),bre(this,"indicesNode"),this.bufferType=Eie.IndicesGPUBuffer,this.createIndicesBuffer(GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST|GPUBufferUsage.INDEX|GPUBufferUsage.INDIRECT,e)}createIndicesBuffer(e,t){var n=Dre.device;this.byteSize=4*t.length,this.usage=e,this.buffer&&this.destroy(),this.buffer=n.createBuffer({size:this.byteSize,usage:e,mappedAtCreation:!1}),this.memory.allocation(this.byteSize),t&&(this.indicesNode=this.memory.allocation_node(4*t.length),this.indicesNode.setArrayBuffer(0,t),this.apply())}}class foe{constructor(){bre(this,"uuid",""),bre(this,"name"),bre(this,"indicesGPUBuffer"),bre(this,"indicesFormat","uint16"),bre(this,"indicesCount",0)}createIndicesBuffer(e){e.data instanceof Uint16Array?this.indicesFormat="uint16":e.data instanceof Uint32Array&&(this.indicesFormat="uint32"),this.indicesCount=e.data.length,this.indicesGPUBuffer=new poe(e.data)}upload(e){this.indicesGPUBuffer.indicesNode.setArrayBuffer(0,e),this.indicesGPUBuffer.apply()}compute(){}destroy(){this.uuid=null,this.name=null,this.indicesFormat=null,this.indicesCount=null,this.indicesGPUBuffer.destroy(),this.indicesGPUBuffer=null}}class moe{constructor(){bre(this,"lodLevels")}}const goe=class{constructor(){bre(this,"uuid"),bre(this,"name"),bre(this,"subGeometries",[]),bre(this,"morphTargetsRelative"),bre(this,"morphTargetDictionary"),bre(this,"_bounds"),bre(this,"_attributeMap"),bre(this,"_attributes"),bre(this,"_indicesBuffer"),bre(this,"_vertexBuffer"),this.uuid=Rie(),this._attributeMap=new Map,this._attributes=[],this._vertexBuffer=new hoe}get indicesBuffer(){return this._indicesBuffer}get vertexBuffer(){return this._vertexBuffer}get vertexAttributes(){return this._attributes}get vertexAttributeMap(){return this._attributeMap}get geometryType(){return this._vertexBuffer.geometryType}set geometryType(e){this._vertexBuffer.geometryType=e}get bounds(){if(!this._bounds){this._bounds=new gae(new Rre,new Rre(1,1,1)),this._bounds.min.x=Number.MAX_VALUE,this._bounds.min.y=Number.MAX_VALUE,this._bounds.min.z=Number.MAX_VALUE,this._bounds.max.x=-Number.MAX_VALUE,this._bounds.max.y=-Number.MAX_VALUE,this._bounds.max.z=-Number.MAX_VALUE;var e=this.getAttribute(Nae.position);if(e)for(let i=0;i<e.data.length/3;i++){var t=e.data[3*i+0],n=e.data[3*i+1],r=e.data[3*i+2];this._bounds.min.x>t&&(this._bounds.min.x=t),this._bounds.min.y>n&&(this._bounds.min.y=n),this._bounds.min.z>r&&(this._bounds.min.z=r),this._bounds.max.x<t&&(this._bounds.max.x=t),this._bounds.max.y<n&&(this._bounds.max.y=n),this._bounds.max.z<r&&(this._bounds.max.z=r)}this._bounds.setFromMinMax(this._bounds.min,this._bounds.max)}return this._bounds}set bounds(e){this._bounds=e}addSubGeometry(...e){var t=new moe;t.lodLevels=e,this.subGeometries.push(t)}generate(e){this._indicesBuffer.upload(this.getAttribute(Nae.indices).data),this._vertexBuffer.createVertexBuffer(this._attributeMap,e),this._vertexBuffer.updateAttributes(this._attributeMap)}setIndices(e){this._attributeMap.has(Nae.indices)||(e={attribute:Nae.indices,data:e},this._attributeMap.set(Nae.indices,e),this._indicesBuffer=new foe,this._indicesBuffer.createIndicesBuffer(e))}setAttribute(e,t){e==Nae.indices?this.setIndices(t):(this._attributeMap.set(e,{attribute:e,data:t}),this._attributes.push(e))}getAttribute(e){return this._attributeMap.get(e)}hasAttribute(e){return this._attributeMap.has(e)}genWireframe(){var e=this.getAttribute("position"),t=this.getAttribute("indices");if(t&&e&&0<t.data.length){var n=e.data,r=[];for(let e=0;e<t.data.length/3;e++){var i=t.data[3*e+0],a=t.data[3*e+1],s=t.data[3*e+2];i=new Rre(n[3*i+0],n[3*i+1],n[3*i+2]),a=new Rre(n[3*a+0],n[3*a+1],n[3*a+2]),s=new Rre(n[3*s+0],n[3*s+1],n[3*s+2]);r.push(i,a),r.push(a,s),r.push(s,i)}return r}return null}compute(){this._indicesBuffer&&this._indicesBuffer.compute(),this._vertexBuffer&&this._vertexBuffer.compute()}computeNormals(){var e=this.getAttribute(Nae.position),t=this.getAttribute(Nae.normal),n=this.getAttribute(Nae.indices);if(e&&t&&n){var r=n.data.length/3,i=goe.point1,a=goe.point2,s=goe.point3,o=goe.crossA,l=goe.crossB,u=goe.crossRet;for(let f=0;f<r;f++){var c=n.data[3*f],d=n.data[3*f+1],h=n.data[3*f+2],p=(i.set(e.data[3*c],e.data[3*c+1],e.data[3*c+2]),a.set(e.data[3*d],e.data[3*d+1],e.data[3*d+2]),s.set(e.data[3*h],e.data[3*h+1],e.data[3*h+2]),Rre.sub(i,a,o).normalize(),Rre.sub(i,s,l).normalize(),o.crossProduct(l,u).normalize());t.data[3*c]=t.data[3*d]=t.data[3*h]=p.x,t.data[3*c+1]=t.data[3*d+1]=t.data[3*h+1]=p.y,t.data[3*c+2]=t.data[3*d+2]=t.data[3*h+2]=p.z}this._vertexBuffer.upload(Nae.normal,t)}return this}isPrimitive(){return!1}destroy(e){this.uuid=null,this.name=null,this.subGeometries=null,this.morphTargetDictionary=null,this._bounds.destroy(),this._bounds=null,this._attributeMap=null,this._attributes=null,this._indicesBuffer.destroy(),this._vertexBuffer.destroy(),this._indicesBuffer=null,this._vertexBuffer=null}};let voe=goe;bre(voe,"crossA",Rre.UP.clone()),bre(voe,"crossB",Rre.UP.clone()),bre(voe,"crossRet",Rre.UP.clone()),bre(voe,"point1",Rre.UP.clone()),bre(voe,"point2",Rre.UP.clone()),bre(voe,"point3",Rre.UP.clone());class yoe extends voe{constructor(e,t,n=1,r=1,i=Rre.Y_AXIS){super(),bre(this,"width"),bre(this,"height"),bre(this,"segmentW"),bre(this,"segmentH"),bre(this,"up"),this.width=e,this.height=t,this.segmentW=n,this.segmentH=r,this.up=i,this.buildGeometry(this.up)}buildGeometry(e){for(var t,n,r,i=this.segmentW+1,a=(this.segmentH,this.bounds=new gae(Rre.ZERO.clone(),new Rre(this.width,1,this.height)),c=this.segmentH*this.segmentW*6,(this.segmentW+1)*(this.segmentH+1)),s=new Float32Array(3*a),o=new Float32Array(3*a),l=new Float32Array(2*a),u=new Uint16Array(this.segmentW*this.segmentH*2*3),c=0,d=0,h=0,p=0,f=0;f<=this.segmentH;++f)for(var m=0;m<=this.segmentW;++m){switch(t=(m/this.segmentW-.5)*this.width,n=(f/this.segmentH-.5)*this.height,e){case Rre.Y_AXIS:s[d++]=t,s[d++]=0,s[d++]=n,o[h++]=0,o[h++]=1,o[h++]=0;break;case Rre.Z_AXIS:s[d++]=t,s[d++]=-n,s[d++]=0,o[h++]=0,o[h++]=0,o[h++]=1;break;case Rre.X_AXIS:s[d++]=0,s[d++]=t,s[d++]=n,o[h++]=1,o[h++]=0,o[h++]=0;break;default:s[d++]=t,s[d++]=0,s[d++]=n,o[h++]=0,o[h++]=1,o[h++]=0}l[p++]=m/this.segmentW,l[p++]=f/this.segmentH,m!=this.segmentW&&f!=this.segmentH&&(u[c++]=(r=m+f*i)+1,u[c++]=r,u[c++]=r+i,u[c++]=r+1,u[c++]=r+i,u[c++]=r+i+1)}this.setIndices(u),this.setAttribute(Nae.position,s),this.setAttribute(Nae.normal,o),this.setAttribute(Nae.uv,l),this.setAttribute(Nae.TEXCOORD_1,l),this.addSubGeometry({indexStart:0,indexCount:u.length,vertexStart:0,index:0})}}class _oe extends bae{constructor(e="QuadGlsl_vs",t="QuadGlsl_fs",n,r,i=0,a=!1){super(),bre(this,"width",128),bre(this,"height",128),bre(this,"quadRenderer"),bre(this,"material"),bre(this,"uniforms"),bre(this,"rendererPassState");var s=n?n.attachments:[];Hre.register("QuadGlsl_vs",'\n    #include "WorldMatrixUniform"\n    #include "GlobalUniform"\n\n    struct VertexOutput {\n        @location(0) fragUV: vec2<f32>,\n            @builtin(position) member: vec4<f32>\n    };\n\n    @vertex\n    fn main(@builtin(instance_index) index : u32, @location(0) position: vec3<f32>, @location(1) TEXCOORD_1: vec2<f32>) -> VertexOutput {\n        let id = u32(index);\n        let worldMatrix = models.matrix[id];\n\n        let screenPos = vec2(((TEXCOORD_1 * 2.0) - vec2<f32>(1.0))) * 0.5 ; \n        return VertexOutput(TEXCOORD_1, vec4<f32>(screenPos, 0.0, 1.0));\n    }\n'),Hre.register("QuadGlsl_fs","\n#version 450\n\nlayout(location = 0) in vec2 fragUV;\n\nlayout(location = 0) out vec4 o_Target;\n\nlayout(set = 0, binding = 0) uniform ConstUniform {\n    mat4 projMat;\n    mat4 viewMat;\n    mat4 shadowMatrix;\n    mat4 cameraWorldMatrix;\n    mat4 pvMatrixInv;\n    float frame;\n    float time;\n    float detail;\n    float shadowBias;\n    float skyExposure;\n    float renderPassState;\n    float quadScale;\n\n};\n\nlayout(set = 2, binding = 0) uniform sampler baseMapSampler;\nlayout(set = 2, binding = 1) uniform texture2D baseMap;\nlayout(set = 3, binding = 0) uniform MaterialDataUniform {\n    vec4 color;\n};\n\nvoid main() {\n        vec2 uv = fragUV.xy;\n    uv.y = 1.0 - uv.y;\n        vec4 colorTexture = texture(sampler2D(baseMap, baseMapSampler), uv * quadScale) * color;\n    o_Target = vec4(colorTexture.rgb, colorTexture.a);\n\n    if (o_Target.r <= 0.5 && o_Target.g <= 0.5 && o_Target.b <= 0.5) {\n        discard;\n    }\n    // float gamma     = 2.2;\n    // float exposure  = 1.0;\n    // float pureWhite = 1.0;\n\n    // float luminance = dot(colorTexture.rgb, vec3(0.2126, 0.7152, 0.0722));\n    // float mappedLuminance = (luminance * (1.0 + luminance/(pureWhite*pureWhite))) / (1.0 + luminance);\n\n    // // Scale color by ratio of average luminances.\n    // vec3 mappedColor = (mappedLuminance / luminance) * colorTexture.rgb;\n\n    // // Gamma correction.\n    // o_Target = vec4(pow(o_Target.rgb, vec3(1.0/gamma)), 1.0);\n};\n"),this.material=new kse,this.material.setShader(e,t),e=this.material.getShader();(t=(this.material.blendMode=Bae.NONE,e.shaderState)).frontFace="cw",t.depthWriteEnabled=!1,t.depthCompare=eie,t.multisample=i,this.uniforms=e.uniforms=r||{color:new qre(new wre)},this.quadRenderer=this.addComponent(soe),this.quadRenderer.material=this.material,this.quadRenderer.castGI=!1,this.quadRenderer.castShadow=!1,this.quadRenderer.drawType=a?2:0,this.quadRenderer.geometry=new yoe(100,100,1,1),this.quadRenderer.__start(),this.quadRenderer._enable=!0,this.quadRenderer.onEnable(),this.colorTexture=nce.res.blackTexture,e.setUniformFloat("x",0),e.setUniformFloat("y",0),e.setUniformFloat("width",100),e.setUniformFloat("height",100),this.rendererPassState=uoe.createRendererPassState(n,"load"),0<t.multisample&&(this.rendererPassState.multisample=t.multisample,this.rendererPassState.multiTexture=Dre.device.createTexture({size:{width:Dre.presentationSize[0],height:Dre.presentationSize[1]},sampleCount:t.multisample,format:0<s.length?s[0].format:Dre.presentationFormat,usage:GPUTextureUsage.RENDER_ATTACHMENT}))}set colorTexture(e){this.material.baseMap=e}renderTarget(e,t,n){var r=e.camera;n=roe.beginRenderPass(n,t.rendererPassState);roe.bindCamera(n,r),t.quadRenderer.nodeUpdate(e,zse.COLOR,t.rendererPassState,null),t.quadRenderer.renderPass2(e,zse.COLOR,t.rendererPassState,null,n),roe.endPass(n)}renderToViewQuad(e,t,n,r){var i=e.camera;t.colorTexture=r,r=roe.beginRenderPass(n,t.rendererPassState);roe.bindCamera(r,i),t.quadRenderer.nodeUpdate(e,zse.COLOR,t.rendererPassState,null),t.quadRenderer.renderPass2(e,zse.COLOR,t.rendererPassState,null,r),roe.endPass(r)}}class boe extends kae{constructor(e,t,n=oie,r,i,a=1,s=0,o){super(e,t,a),bre(this,"resolveTarget");var l=Dre.device;this.name=Rie(),this.usage=null!=i?i:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_SRC|GPUTextureUsage.COPY_DST,this.createTextureDescriptor(e,t,1,n,this.usage,a,s),this.useMipmap=!1,this.visibility=GPUShaderStage.COMPUTE|GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,n==hie?(this.samplerBindingLayout.type="non-filtering",this.textureBindingLayout.sampleType="unfilterable-float",this.gpuSampler=l.createSampler({})):n==fie?(this.samplerBindingLayout.type="filtering",this.sampler_comparisonBindingLayout.type="comparison",this.textureBindingLayout.sampleType="depth",this.gpuSampler=Dre.device.createSampler({}),this.gpuSampler_comparison=Dre.device.createSampler({compare:"less",label:"sampler_comparison"})):n==pie?(this.samplerBindingLayout={type:"filtering"},this.sampler_comparisonBindingLayout={type:"comparison"},this.textureBindingLayout.sampleType="depth",this.gpuSampler=Dre.device.createSampler({}),this.gpuSampler_comparison=Dre.device.createSampler({compare:"less",label:"sampler_comparison"})):(this.samplerBindingLayout.type="filtering",this.textureBindingLayout.sampleType="float",0<s&&(this.textureBindingLayout.multisampled=!0),this.minFilter="linear",this.magFilter="linear",this.mipmapFilter="linear",this.maxAnisotropy=16,this.addressModeU=Kre,this.addressModeV=Kre,this.gpuSampler=l.createSampler(this))}create(e,t,n=0){var r=Dre.device,i=4*e,a=new Float32Array(e*t*4),s=r.createBuffer({size:a.byteLength,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.COPY_SRC});(r=(r.queue.writeBuffer(s,0,a),roe.beginCommandEncoder())).copyBufferToTexture({buffer:s,bytesPerRow:i},{texture:this.getGPUTexture()},{width:e,height:t,depthOrArrayLayers:1}),roe.endCommandEncoder(r)}readTextureToImage(){var e=Dre.device,t=Dre.windowWidth,n=Dre.windowHeight,r=new Float32Array(t*n*4);e=e.createBuffer({size:r.byteLength,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.COPY_SRC});roe.beginCommandEncoder().copyTextureToBuffer({texture:this.getGPUTexture()},{buffer:e},[t,n]),e.getMappedRange(0,r.byteLength)}}class xoe{constructor(){bre(this,"storeOp","store"),bre(this,"loadOp","clear"),bre(this,"clearValue",[0,0,0,0])}}class woe{constructor(e,t,n,r,i=!0){bre(this,"label"),bre(this,"customSize",!1),bre(this,"attachments"),bre(this,"rtDescriptors"),bre(this,"zPreTexture"),bre(this,"depthTexture"),bre(this,"depthViewIndex",0),bre(this,"depthCleanValue",1),bre(this,"depthLoadOp","clear"),bre(this,"isOutTarget",!0),this.attachments=e,this.rtDescriptors=t,this.depthTexture=n,this.zPreTexture=r,this.isOutTarget=i}clone2Frame(e){e.attachments.push(...this.attachments.concat());for(let r=0;r<this.rtDescriptors.length;r++){var t=this.rtDescriptors[r],n=new xoe;n.loadOp=t.loadOp,n.storeOp=t.storeOp,n.clearValue=t.clearValue,e.rtDescriptors.push(n)}e.depthTexture=this.depthTexture,e.zPreTexture=this.zPreTexture,e.customSize=this.customSize}clone(){var e=new woe([],[]);return this.clone2Frame(e),e}}const Soe=class{static init(){this.rtTextureMap=new Map,this.rtViewQuad=new Map}static createRTTexture(e,t,n,r,i=!1,a=0){let s=this.rtTextureMap.get(e);return s||((s=new boe(t,n,r,i,void 0,1,a,e!=_ie.colorBufferTex_NAME)).name=e,Soe.rtTextureMap.set(e,s)),s}static createRTTextureArray(e,t,n,r,i=1,a=!1,s=0){let o=this.rtTextureMap.get(e);return o||((o=new boe(t,n,r,a,void 0,i,s)).name=e,Soe.rtTextureMap.set(e,o)),o}static createViewQuad(e,t,n,r,i,a=0){return r=new woe([r],[new xoe]),t=new _oe(t,n,r,i,a),Soe.rtViewQuad.set(e,t),t}static getTexture(e){return this.rtTextureMap.get(e)}static CreateSplitTexture(e){let t=this.getTexture(_ie.colorBufferTex_NAME),n=this.getTexture(e+"_split");return n||this.createRTTexture(e+"_split",t.width,t.height,t.format,!1)}static WriteSplitColorTexture(e){var t=this.getTexture(_ie.colorBufferTex_NAME),n=(e=this.getTexture(e+"_split"),roe.beginCommandEncoder());n.copyTextureToTexture({texture:t.getGPUTexture(),mipLevel:0,origin:{x:0,y:0,z:0}},{texture:e.getGPUTexture(),mipLevel:0,origin:{x:0,y:0,z:0}},{width:e.width,height:e.height,depthOrArrayLayers:1}),roe.endCommandEncoder(n)}};let Coe=Soe;bre(Coe,"rtTextureMap"),bre(Coe,"rtViewQuad");class Toe{constructor(){bre(this,"enable",!0),bre(this,"postRenderer"),bre(this,"rtViewQuad"),bre(this,"virtualTexture"),this.rtViewQuad=new Map,this.virtualTexture=new Map}createRTTexture(e,t,n,r,i=!1,a=0){return(t=Coe.createRTTexture(e,t,n,r,i,a)).name=e,this.virtualTexture.set(e,t),Pse.getInstance().attached(t,this),t}createViewQuad(e,t,n,r,i=0){return t=Coe.createViewQuad(e,"Quad_vert_wgsl",t,n,r,i),this.rtViewQuad.set(e,t),t}getOutTexture(){let e=roe.lastRenderPassState.renderTargets;return 0<e.length?e[0]:Coe.getTexture(_ie.colorBufferTex_NAME)}autoSetColorTexture(e,t){var n=this.getOutTexture();t.setSamplerTexture(e,n)}compute(e){}onAttach(e){}onDetach(e){}render(e,t){this.compute(e),this.rtViewQuad.forEach(((n,r)=>{var i=roe.lastRenderPassState.getLastRenderTexture();n.renderToViewQuad(e,n,t,i)}))}destroy(e){this.postRenderer=null;for(let n=0;n<this.rtViewQuad.size;n++)this.rtViewQuad.values[n].destroy(e);this.rtViewQuad.clear(),this.rtViewQuad=null;for(let n=0;n<this.virtualTexture.size;n++){var t=this.virtualTexture.values[n];Pse.getInstance().detached(t,this),t.destroy(e)}}}class Moe extends Toe{constructor(){super();var e=Dre.presentationSize,t=(Coe.createRTTexture(_ie.colorBufferTex_NAME,e[0],e[1],die,!1),Hre.register("FXAA_Shader",oce),{u_texel:new qre(new Wre(1/e[0],1/e[1])),u_strength:new qre(4)});e=this.createRTTexture("FXAAPost",e[0],e[1],die);this.createViewQuad("fxaa","FXAA_Shader",e,t)}onAttach(e){nce.setting.render.postProcessing.fxaa.enable=!0}onDetach(e){nce.setting.render.postProcessing.fxaa.enable=!1}}class Eoe{constructor(e){bre(this,"command"),bre(this,"encoder"),bre(this,"rendererPassStates"),bre(this,"rtFrame"),this.rtFrame=e,this.rendererPassStates=[]}clean(){this.rendererPassStates.length=0,roe.cleanCache()}beginContinueRendererPassState(){if(0<this.rendererPassStates.length){var e=this.rtFrame.clone();for(const t of e.rtDescriptors)t.loadOp="load";e.depthLoadOp="load";e=uoe.createRendererPassState(e);return this.rendererPassStates.push(e),e}return e=uoe.createRendererPassState(this.rtFrame),this.rendererPassStates.push(e),e}get rendererPassState(){return this.rendererPassStates[this.rendererPassStates.length-1]}beginRenderPass(){this.beginContinueRendererPassState(),this.begineNewCommand(),this.beginNewEncoder()}endRenderPass(){this.endEncoder(),this.endCommand()}begineNewCommand(){return this.command=roe.beginCommandEncoder(),this.command}endCommand(){roe.endCommandEncoder(this.command),this.command=null}beginNewEncoder(){return this.encoder=roe.beginRenderPass(this.command,this.rendererPassState),this.encoder}endEncoder(){roe.endPass(this.encoder),this.encoder=null}}class Aoe extends Mre{constructor(){super(),bre(this,"rendererPassState"),bre(this,"splitRendererPassState"),bre(this,"useRenderBundle",!1),bre(this,"debugViewQuads"),bre(this,"debugTextures"),bre(this,"renderContext"),bre(this,"_rendererType"),bre(this,"_rtFrame"),this.debugTextures=[],this.debugViewQuads=[]}get passType(){return this._rendererType}set passType(e){this._rendererType=e}setRenderStates(e){if(this._rtFrame=e){this.rendererPassState=uoe.createRendererPassState(e);var t=e.clone();t.depthLoadOp="load";for(const e of t.rtDescriptors)e.loadOp="load";this.splitRendererPassState=uoe.createRendererPassState(t)}this.renderContext=new Eoe(e)}setIrradiance(e,t){this.rendererPassState.irradianceBuffer=[e,t]}compute(e,t){}render(e,t,n,r=!1){roe.cleanCache();var i=e.camera,a=e.scene,s=(a=(this.rendererPassState.camera3D=i,Kse.instance.getRenderNodes(a)),this.renderBundleOp(e,a,t,n)),o=r?[]:this.renderBundleTr(e,a,t,n),l=roe.beginCommandEncoder(),u=roe.beginRenderPass(l,this.rendererPassState);0<s.length&&u.executeBundles(s),!r&&Kse.instance.sky&&(roe.bindCamera(u,i),Kse.instance.sky.renderPass2(e,this._rendererType,this.rendererPassState,n,u)),this.drawRenderNodes(e,u,l,a.opaqueList,t),roe.endPass(u),roe.endCommandEncoder(l),s=roe.beginCommandEncoder(),n=roe.beginRenderPass(s,this.rendererPassState);0<o.length&&n.executeBundles(o),r||(roe.bindCamera(n,i),this.drawRenderNodes(e,n,s,a.transparentList,t)),roe.endPass(n),roe.endCommandEncoder(s)}nodeUpload(e,t,n){}occlusionRenderNodeTest(e,t,n){return!n||0<n.occlusionRenderNodeTest(e)}renderOp(e,t,n,r,i){}renderTr(e,t,n,r,i){}renderBundleOp(e,t,n,r){var i=Kse.instance.getOpRenderGroup(e.scene);if(i){let t=[];return i.renderGroup.forEach((n=>{var i;n.bundleMap.has(this._rendererType)?t.push(n.bundleMap.get(this._rendererType)):(i=roe.recordBundleEncoder(this.rendererPassState.renderBundleEncoderDescriptor),this.recordRenderBundleNode(e,i,n.renderNodes,r),i=i.finish(),n.bundleMap.set(this._rendererType,i),t.push(i))})),t}return[]}renderBundleTr(e,t,n,r){var i=Kse.instance.getTrRenderGroup(e.scene);if(i){let t=[];return i.renderGroup.forEach((n=>{var i;n.bundleMap.has(this._rendererType)?t.push(n.bundleMap.get(this._rendererType)):(i=roe.recordBundleEncoder(this.rendererPassState.renderBundleEncoderDescriptor),this.recordRenderBundleNode(e,i,n.renderNodes,r),i=i.finish(),n.bundleMap.set(this._rendererType,i),t.push(i))})),t}return[]}recordRenderBundleNode(e,t,n,r){roe.bindCamera(t,e.camera),roe.bindGeometryBuffer(t,n[0].geometry);for(let a=0;a<n.length;++a){var i=n[a];i.transform.worldMatrix.index,i.transform.enable&&i.recordRenderPass2(e,this._rendererType,this.rendererPassState,r,t)}}drawRenderNodes(e,t,n,r,i,a){roe.bindCamera(t,e.camera);for(let o=nce.setting.render.drawOpMin;o<Math.min(r.length,nce.setting.render.drawOpMax);++o){var s=r[o];i.renderCommitTesting(e.camera,s)&&s.transform.enable&&s.enable&&s.renderPass2(e,this._rendererType,this.rendererPassState,a,t)}}setDebugTexture(e){for(let n=0;n<e.length;n++){let r=e[n],i="Quad_frag_wgsl";switch(r.format){case uie:case lie:case oie:case die:case hie:i="Quad_frag_wgsl";break;case pie:case fie:i="Quad_depth2d_frag_wgsl","cube"==r.textureBindingLayout.viewDimension&&(i="Quad_depthCube_frag_wgsl")}var t=new _oe("Quad_vert_wgsl",i,new woe([],[]));this.debugTextures.push(e[n]),this.debugViewQuads.push(t)}}}class Poe extends Aoe{constructor(){super(),this.passType=zse.COLOR}render(e,t,n,r=!1){this.renderContext.clean();var i=e.scene,a=e.camera,s=(this.rendererPassState.camera3D=a,Kse.instance.getRenderNodes(i)),o=this.renderBundleOp(e,s,t,n),l=r?[]:this.renderBundleTr(e,s,t,n),u=(zie.start("colorPass Renderer"),zie.start("ColorPass Draw Opaque"),this.renderContext.beginRenderPass(),this.renderContext.command,this.renderContext.encoder),c=(roe.bindCamera(u,a),0<o.length&&(Kse.instance.getOpRenderGroup(i).renderGroup.forEach((e=>{for(let t=0;t<e.renderNodes.length;t++)e.renderNodes[t].transform.updateWorldMatrix()})),u.executeBundles(o)),!r&&Kse.instance.sky&&(roe.bindCamera(u,a),Kse.instance.sky.renderPass2(e,this._rendererType,this.rendererPassState,n,u)),roe.bindCamera(u,a),this.drawNodes(e,this.renderContext,s.opaqueList,t,n),this.renderContext.endRenderPass(),zie.end("ColorPass Draw Opaque"),zie.start("ColorPass Draw Transparent"),this.renderContext.beginRenderPass(),this.renderContext.command,this.renderContext.encoder),d=(0<l.length&&c.executeBundles(l),r||(roe.bindCamera(c,a),this.drawNodes(e,this.renderContext,s.transparentList,t,n)),Kse.instance.getGraphicList());for(let p=0;p<d.length;p++){var h=d[p];h.transform.worldMatrix.index,h.nodeUpdate(e,this._rendererType,this.splitRendererPassState,n),h.renderPass2(e,this._rendererType,this.splitRendererPassState,n,c)}this.renderContext.endRenderPass(),zie.end("ColorPass Draw Transparent"),zie.end("colorPass Renderer")}drawNodes(e,t,n,r,i){for(let s=nce.setting.render.drawOpMin;s<Math.min(n.length,nce.setting.render.drawOpMax);++s){var a=n[s];r.renderCommitTesting(e.camera,a)&&a.transform.enable&&a.enable&&(a.nodeUpdate(e,this._rendererType,this.rendererPassState,i),a.renderPass(e,this.passType,this.renderContext))}}occlusionRenderNodeTest(e,t,n){return 0<n.zDepthRenderNodeTest(t)}}const Roe=class extends woe{constructor(){super([],[])}crateGBuffer(e,t,n){var r=this.attachments,i=this.rtDescriptors,a=Coe.createRTTexture(e+_ie.colorBufferTex_NAME,t,n,die,!1),s=Coe.createRTTexture(e+_ie.positionBufferTex_NAME,t,n,die,!1),o=Coe.createRTTexture(e+_ie.normalBufferTex_NAME,t,n,oie,!1);e=Coe.createRTTexture(e+_ie.materialBufferTex_NAME,t,n,oie,!1);(s=((a=(r.push(a),r.push(s),r.push(o),r.push(e),new xoe)).loadOp="clear",new boe(t,n,"depth24plus",!1))).name="depthTexture",(new xoe).loadOp="load",this.depthTexture=s,i.push(a),i.push(new xoe),i.push(new xoe),i.push(new xoe)}getColorMap(){return this.attachments[0]}getPositionMap(){return this.attachments[1]}getNormalMap(){return this.attachments[2]}getMaterialMap(){return this.attachments[3]}static getGBufferFrame(e){let t;var n;return Roe.gBufferMap.has(e)?t=Roe.gBufferMap.get(e):(t=new Roe,n=Dre.presentationSize,t.crateGBuffer(e,n[0],n[1]),Roe.gBufferMap.set(e,t)),t}clone(){var e=new Roe;return this.clone2Frame(e),e}};let Loe=Roe;bre(Loe,"gBufferMap",new Map);class koe{constructor(){bre(this,"frustumCullingList"),bre(this,"zVisibleList"),bre(this,"_renderList"),this._renderList=new Map}occlusionRenderNodeTest(e){return nce.setting.occlusionQuery.enable?this.frustumCullingList?this.frustumCullingList[e]:0:1}zDepthRenderNodeTest(e){return this.zVisibleList?this.zVisibleList[e]:0}update(e,t){let n=this._renderList.get(e);n||(n=new Map,this._renderList.set(e,n)),n.clear(),Kse.instance.autoSortRenderNodes(t);var r=Kse.instance.getRenderNodes(t);for(let s=0;s<r.opaqueList.length;s++){var i=r.opaqueList[s];let t=0;(t=i.enable&&i.transform.enable&&i.object3D.bound?i.object3D.bound.containsFrustum(i.object3D,e.frustum):t)&&n.set(i,t)}for(let s=0;s<r.transparentList.length;s++){var a=r.transparentList[s];let t=0;(t=a.enable&&a.transform.enable&&a.object3D.bound?a.object3D.bound.containsFrustum(a.object3D,e.frustum):t)&&n.set(a,t)}}renderCommitTesting(e,t){return!!this._renderList.get(e)&&0<this._renderList.get(e).get(t)}}class Doe extends Mie{constructor(e,t){super(),this.bufferType=Eie.ComputeGPUBuffer,this.createBuffer(GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST,e,t)}}class Ioe{constructor(e,t){bre(this,"clusterBuffer"),bre(this,"lightAssignBuffer"),bre(this,"assignTableBuffer"),bre(this,"clustersUniformBuffer"),this.clusterBuffer=new Doe(2*e*4),this.clustersUniformBuffer=new Pie(10),this.clustersUniformBuffer.visibility=GPUShaderStage.FRAGMENT|GPUShaderStage.COMPUTE,this.lightAssignBuffer=new Doe(e*t),this.lightAssignBuffer.visibility=GPUShaderStage.FRAGMENT|GPUShaderStage.COMPUTE,this.assignTableBuffer=new Doe(4*e),this.assignTableBuffer.visibility=GPUShaderStage.FRAGMENT|GPUShaderStage.COMPUTE}update(e,t,n,r,i,a,s,o,l,u){this.clustersUniformBuffer.setFloat("clusterTileX",r),this.clustersUniformBuffer.setFloat("clusterTileY",i),this.clustersUniformBuffer.setFloat("clusterTileZ",a),this.clustersUniformBuffer.setFloat("numLights",s),this.clustersUniformBuffer.setFloat("maxNumLightsPerCluster",o),this.clustersUniformBuffer.setFloat("near",l),this.clustersUniformBuffer.setFloat("far",u),this.clustersUniformBuffer.setFloat("screenWidth",e),this.clustersUniformBuffer.setFloat("screenHeight",t),this.clustersUniformBuffer.setFloat("clusterPix",n),this.clustersUniformBuffer.apply()}}class Ooe extends Aoe{constructor(e){super(),bre(this,"clusterTileX",16),bre(this,"clusterTileY",9),bre(this,"clusterTileZ",16),bre(this,"maxNumLights",128),bre(this,"maxNumLightsPerCluster",1024),bre(this,"clusterPix",1),bre(this,"clusterLightingBuffer"),bre(this,"_currentLightCount",0),bre(this,"_clusterGenerateCompute"),bre(this,"_clusterLightingCompute"),bre(this,"_useCamera"),this.passType=zse.Cluster,this.initCompute(e)}initCompute(e){this._clusterGenerateCompute=new Uie('\n  #include "GlobalUniform"\n\n        struct ClusterBox{\n            minPoint:vec4<f32>,\n            maxPoint:vec4<f32>\n        }\n\n        struct ClustersUniform{\n            clusterTileX:f32,\n            clusterTileY:f32,\n            clusterTileZ:f32,\n            numLights:f32,\n            maxNumLightsPerCluster:f32,\n            near:f32,\n            far:f32,\n            screenWidth:f32,\n            screenHeight:f32,\n            clusterPix:f32\n        }\n     \n        @group(0) @binding(1) var<uniform> clustersUniform : ClustersUniform;\n        @group(0) @binding(2) var<storage,read_write> clusterBuffer : array<ClusterBox>;\n\n\n        var<private> clusterTileX:f32 ;\n        var<private> clusterTileY:f32 ;\n        var<private> clusterTileZ:f32 ;\n        fn convertNDCToView( v4:vec4<f32> ) -> vec4<f32> {\n            var v = globalUniform.pvMatrixInv * v4 ;\n            v = v / v.w ;\n            return v ;\n        }\n\n        fn gridToIndex(i:vec3<u32>) -> u32{\n            return i.z * u32(clusterTileX) * u32(clusterTileY) + i.y * u32(clusterTileX) + i.x ;\n        }\n\n        fn ScreenToView(screen : vec4<f32>) -> vec4<f32> {\n            let texCoord = screen.xy / vec2<f32>(clustersUniform.screenWidth, clustersUniform.screenHeight);\n            let clip = vec4<f32>(vec2<f32>(texCoord.x, 1.0 - texCoord.y) * 2.0 - vec2<f32>(1.0, 1.0), screen.z, screen.w);\n            return convertNDCToView(clip);\n          }\n\n        fn LineIntersectionToZPlane( eye:vec3<f32> , ndcPoint :vec3<f32> , z:f32) -> vec3<f32>\n        {\n            var normal = vec3<f32>(0.0, 0.0, 1.0);\n            var dir = ndcPoint - eye;\n            var t = (z - dot(normal, eye)) / dot(normal, dir);\n            var result = eye + t * dir;\n            return result;\n        }\n\n        @compute @workgroup_size(16,9,1)\n        fn CsMain( @builtin(workgroup_id) workgroup_id : vec3<u32> , @builtin(local_invocation_id) local_invocation_id : vec3<u32> ){\n            let i = local_invocation_id.x ;\n            let j = local_invocation_id.y ;\n            let k = workgroup_id.x ;\n\n            clusterTileX = clustersUniform.clusterTileX;\n            clusterTileY = clustersUniform.clusterTileY;\n            clusterTileZ = clustersUniform.clusterTileZ;\n\n            let clusterGrid = vec3<u32>(i,j,k);\n            let tileIndex = gridToIndex(clusterGrid);\n            let eyePos = vec3<f32>(0.0, 0.0, 0.0);\n\n            let tx = clusterTileX;\n            let ty = clusterTileY;\n            let tz = clusterTileZ ;\n            let near = clustersUniform.near ;\n            let far = clustersUniform.far ;\n\n            let titleSize = vec2<f32>( clustersUniform.screenWidth / tx ,  clustersUniform.screenHeight / ty ) ;\n\n            var maxPointSs = vec4<f32>(vec2<f32>(f32(i) + 1.0, f32(j) + 1.0) * titleSize, 0.0, 1.0);\n\t        var minPointSs = vec4<f32>(vec2<f32>(f32(i) , f32(j)) * titleSize, 0.0, 1.0);\n\n            var maxPointVs = ScreenToView(maxPointSs).xyz;\n\t        var minPointVs = ScreenToView(minPointSs).xyz;\n \n            var tileNear = clustersUniform.near * pow(clustersUniform.far / clustersUniform.near, f32(k) / clustersUniform.clusterTileZ);\n\t        var tileFar = clustersUniform.near * pow(clustersUniform.far / clustersUniform.near, (f32(k) + 1.0) / clustersUniform.clusterTileZ);\n\n            var minPointNear = LineIntersectionToZPlane(eyePos, minPointVs, tileNear);\n            var minPointFar = LineIntersectionToZPlane(eyePos, minPointVs, tileFar);\n            var maxPointNear = LineIntersectionToZPlane(eyePos, maxPointVs, tileNear);\n            var maxPointFar = LineIntersectionToZPlane(eyePos, maxPointVs, tileFar);\n\n            var minPointAABB = min(min(minPointNear, minPointFar), min(maxPointNear, maxPointFar));\n            var maxPointAABB = max(max(minPointNear, minPointFar), max(maxPointNear, maxPointFar));\n\n            var clusterBox : ClusterBox ;\n            clusterBox.minPoint = vec4<f32>(minPointAABB,f32(tileIndex)) ;\n            clusterBox.maxPoint = vec4<f32>(maxPointAABB,f32(tileIndex)) ;\n            clusterBuffer[tileIndex] = clusterBox;\n        }\n'),this._clusterLightingCompute=new Uie('\n#include "GlobalUniform"\n\nstruct ClusterBox{\n    minPoint:vec4<f32>,\n    maxPoint:vec4<f32>\n}\n\nstruct Light {\n    index:f32,\n    lightType:i32,\n    radius:f32,\n    linear:f32,\n\n    position:vec3<f32>,\n    lightMatrixIndex:f32,\n\n    direction:vec3<f32>,\n    quadratic:f32,\n\n    lightColor:vec3<f32>,\n    intensity:f32,\n\n    innerCutOff :f32,\n    outerCutOff:f32,\n    range :f32,\n    castShadow:f32,\n\n    lightTangent:vec3<f32>,\n    ies:f32,\n};\n\nstruct LightIndex\n{\n    count:f32,\n    start:f32,\n    empty0:f32,\n    empty1:f32,\n};\n\nstruct ClustersUniform{\n    clusterTileX:f32,\n    clusterTileY:f32,\n    clusterTileZ:f32,\n    numLights:f32,\n    maxNumLightsPerCluster:f32,\n    near:f32,\n    far:f32,\n    screenWidth:f32,\n    screenHeight:f32,\n    clusterPix:f32, \n}\n\nstruct Uniforms {\n    matrix : array<mat4x4<f32>>\n};\n\n\n\nvar<private> clusterTileX:f32 ;\nvar<private> clusterTileY:f32 ;\nvar<private> clusterTileZ:f32 ;\n\n// @group(0) @binding(1) var<storage, read> models : Uniforms;\n@group(0) @binding(2) var<uniform> clustersUniform : ClustersUniform;\n@group(0) @binding(3) var<storage,read> clusterBuffer : array<ClusterBox>;\n@group(0) @binding(4) var<storage,read> lightBuffer : array<Light>;\n@group(0) @binding(5) var<storage,read_write> lightAssignBuffer : array<f32>;\n@group(0) @binding(6) var<storage,read_write> assignTable : array<LightIndex>;\n\nfn gridToIndex(i:vec3<u32>) -> u32{\n    return i.z * u32(clusterTileX) * u32(clusterTileY) + i.y * u32(clusterTileX) + i.x ;\n}\n\nfn GetSqdisPointAABB( pos:vec3<f32>,  clusterIndex:u32 ) -> f32\n{\n    var sqDistance = 0.0;\n    let cluster = clusterBuffer[clusterIndex];\n    for (var i = 0u; i < 3u; i+=1u)\n    {\n        var v = pos[i];\n        if (v < cluster.minPoint[i])\n        {\n            let diff = cluster.minPoint[i] - v;\n            sqDistance += diff * diff;\n        }\n\n        if (v > cluster.maxPoint[i])\n        {\n            let diff =  v - cluster.maxPoint[i];\n            sqDistance += diff * diff;\n        }\n    }\n    return sqDistance;\n}\n\nfn TestSphereAABB( lightIndex:i32 ,  clusterIndex : u32 ) -> bool\n{\n    let light = lightBuffer[lightIndex];\n    let lightPos = light.position.xyz;\n    var radius = light.range * 2.0 ;\n    let spherePos =  globalUniform.viewMat * vec4<f32>(lightPos.xyz, 1.0) ;\n    let sqDistance = GetSqdisPointAABB(spherePos.xyz , clusterIndex);\n    return sqDistance <= (radius*radius);\n}\n\n\n\n@compute @workgroup_size(16,9,1)\nfn CsMain( @builtin(workgroup_id) workgroup_id : vec3<u32> , @builtin(local_invocation_id) local_invocation_id : vec3<u32> ){\n    clusterTileX = clustersUniform.clusterTileX;\n    clusterTileY = clustersUniform.clusterTileY;\n    clusterTileZ = clustersUniform.clusterTileZ;\n    // cluster ID \n    let i = local_invocation_id.x ;\n    let j = local_invocation_id.y ;\n    let k = workgroup_id.x ;\n\n    var clusterId_3D = vec3<u32>(i,j,k);\n    var clusterId_1D = gridToIndex(clusterId_3D);\n\n    var startIndex = i32(clusterId_1D) * i32(clustersUniform.maxNumLightsPerCluster) ;\n    var endIndex = startIndex;\n\n    for(var lightID = 0 ; lightID < i32(clustersUniform.numLights) ; lightID+=1)\n    {\n        if(!TestSphereAABB(lightID, clusterId_1D)) {\n           continue;\n        };\n        lightAssignBuffer[endIndex] = f32(lightID);\n        endIndex += 1 ;\n    }\n\n    // workgroupBarrier();\n\n    var idx: LightIndex;\n    idx.count = f32(endIndex-startIndex);\n    idx.start = f32(startIndex);\n    assignTable[clusterId_1D] = idx;\n}\n');var t=Dre.presentationSize,n=this.clusterTileX*this.clusterTileY*this.clusterTileZ,r=(i=e.camera).near,i=i.far;this.clusterLightingBuffer=new Ioe(n,this.maxNumLightsPerCluster),this.clusterLightingBuffer.update(t[0],t[1],this.clusterPix,this.clusterTileX,this.clusterTileY,this.clusterTileZ,this.maxNumLights,this.maxNumLightsPerCluster,r,i),this._clusterGenerateCompute.setUniformBuffer("clustersUniform",this.clusterLightingBuffer.clustersUniformBuffer),this._clusterGenerateCompute.setStorageBuffer("clusterBuffer",this.clusterLightingBuffer.clusterBuffer),n=toe.getLightEntries(e.scene);this._clusterLightingCompute.setStorageBuffer("models",toe.modelMatrixBindGroup.matrixBufferDst),this._clusterLightingCompute.setUniformBuffer("clustersUniform",this.clusterLightingBuffer.clustersUniformBuffer),this._clusterLightingCompute.setStorageBuffer("clusterBuffer",this.clusterLightingBuffer.clusterBuffer),this._clusterLightingCompute.setStorageBuffer("lightBuffer",n.storageGPUBuffer),this._clusterLightingCompute.setStorageBuffer("lightAssignBuffer",this.clusterLightingBuffer.lightAssignBuffer),this._clusterLightingCompute.setStorageBuffer("assignTable",this.clusterLightingBuffer.assignTableBuffer)}render(e,t){var n=e.scene;n=Kse.instance.getLights(n);this._useCamera!=e.camera&&(this._useCamera=e.camera,e=toe.getCameraGroup(this._useCamera),this._clusterGenerateCompute.setUniformBuffer("globalUniform",e.uniformGPUBuffer),this._clusterLightingCompute.setUniformBuffer("globalUniform",e.uniformGPUBuffer)),this._currentLightCount!=n.length&&(this._currentLightCount=n.length,this.clusterLightingBuffer.clustersUniformBuffer.setFloat("numLights",n.length),this.clusterLightingBuffer.clustersUniformBuffer.apply(),this._clusterGenerateCompute.workerSizeX=this.clusterTileZ,this._clusterLightingCompute.workerSizeX=this.clusterTileZ),0<n.length&&(e=roe.beginCommandEncoder(),roe.computeCommand(e,[this._clusterGenerateCompute,this._clusterLightingCompute]),roe.endCommandEncoder(e))}}class Noe extends bae{constructor(e=.001,t=1e4,n=90,r=!1){super(),bre(this,"up_camera"),bre(this,"down_camera"),bre(this,"left_camera"),bre(this,"right_camera"),bre(this,"front_camera"),bre(this,"back_camera"),this.initCubeCamera(e,t,n,r)}set label(e){this.up_camera.name=e+"up",this.down_camera.name=e+"down",this.left_camera.name=e+"left",this.right_camera.name=e+"right",this.front_camera.name=e+"front",this.back_camera.name=e+"back"}initCubeCamera(e,t,n=90,r=!1){this.up_camera=xae.createCamera3DObject(this,"up"),this.down_camera=xae.createCamera3DObject(this,"down"),this.left_camera=xae.createCamera3DObject(this,"left"),this.right_camera=xae.createCamera3DObject(this,"right"),this.front_camera=xae.createCamera3DObject(this,"front"),this.back_camera=xae.createCamera3DObject(this,"back"),this.up_camera.isShadowCamera=r,this.down_camera.isShadowCamera=r,this.left_camera.isShadowCamera=r,this.right_camera.isShadowCamera=r,this.front_camera.isShadowCamera=r,this.back_camera.isShadowCamera=r,this.up_camera.perspective(n,1,e,t),this.up_camera.lookAt(Rre.ZERO,Rre.UP,Rre.DOWN),this.up_camera.object3D.scaleX=-1,this.up_camera.object3D.rotationY=180,this.down_camera.perspective(n,1,e,t),this.down_camera.lookAt(Rre.ZERO,Rre.DOWN,Rre.DOWN),this.down_camera.object3D.scaleX=-1,this.down_camera.object3D.rotationY=180,this.left_camera.perspective(n,1,e,t),this.left_camera.lookAt(Rre.ZERO,Rre.LEFT),this.left_camera.object3D.scaleX=-1,this.right_camera.perspective(n,1,e,t),this.right_camera.lookAt(Rre.ZERO,Rre.RIGHT),this.right_camera.object3D.scaleX=-1,this.front_camera.perspective(n,1,e,t),this.front_camera.lookAt(Rre.ZERO,Rre.FORWARD),this.front_camera.object3D.scaleX=-1,this.back_camera.perspective(n,1,e,t),this.back_camera.lookAt(Rre.ZERO,Rre.BACK),this.back_camera.object3D.scaleX=-1,this.up_camera.type=cae.shadow,this.down_camera.type=cae.shadow,this.left_camera.type=cae.shadow,this.right_camera.type=cae.shadow,this.front_camera.type=cae.shadow,this.back_camera.type=cae.shadow}}class Boe extends kae{constructor(e,t,n){super(e,t,n),this.visibility=GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT|GPUShaderStage.COMPUTE,this.format=fie,this.mipmapCount=1,this.init()}internalCreateBindingLayoutDesc(){this.textureBindingLayout.sampleType="depth",this.textureBindingLayout.viewDimension="cube-array",this.samplerBindingLayout.type="filtering",this.sampler_comparisonBindingLayout.type="comparison"}internalCreateTexture(){this.textureDescriptor={format:this.format,size:{width:this.width,height:this.height,depthOrArrayLayers:6*this.numberLayer},dimension:"2d",usage:GPUTextureUsage.COPY_DST|GPUTextureUsage.TEXTURE_BINDING},this.gpuTexture=Dre.device.createTexture(this.textureDescriptor)}internalCreateView(){this.viewDescriptor={dimension:"cube-array"},this.view=this.gpuTexture.createView(this.viewDescriptor)}internalCreateSampler(){this.gpuSampler=Dre.device.createSampler({minFilter:iie,magFilter:iie}),this.gpuSampler_comparison=Dre.device.createSampler({compare:"less",label:"sampler_comparison"})}}class Uoe extends Aoe{constructor(){super(),bre(this,"shadowPassCount"),bre(this,"_forceUpdate",!1),bre(this,"_shadowCameraDic"),bre(this,"shadowCamera"),bre(this,"cubeArrayTexture"),bre(this,"colorTexture"),bre(this,"shadowSize",1024),this.passType=zse.POINT_SHADOW,this._shadowCameraDic=new Map,this.cubeArrayTexture=new Boe(this.shadowSize,this.shadowSize,8),this.colorTexture=new boe(this.shadowSize,this.shadowSize,cie,!1),Pse.getInstance().attached(this.cubeArrayTexture,this)}getShadowCamera(e,t){let n;if(this._shadowCameraDic.has(t))n=this._shadowCameraDic.get(t);else{var r=new Noe(e.camera.near,e.camera.far,90,!0),i=(r.label=t.name,[]),a=[];for(let n=0;n<6;n++){var s=new boe(this.shadowSize,this.shadowSize,this.cubeArrayTexture.format,!1),o=new woe([this.colorTexture],[new xoe]);o=(s.name="shadowDepthTexture_"+t.name+n+"_face",o.depthTexture=s,o.label="shadowRender",o.customSize=!0,uoe.createRendererPassState(o));a[n]=o,i[n]=s,nce.getRenderJob(e).postRenderer.setDebugTexture([s]),nce.getRenderJob(e).debug()}n={cubeCamera:r,depthTexture:i,rendererPassState:a},this._shadowCameraDic.set(t,n)}return n}render(e,t){if(nce.setting.shadow.enable){this.shadowPassCount=0,e.camera;var n=e.scene,r=Kse.instance.getRenderNodes(n),i=Sae.getPointShadowLightWhichScene(n),a=i.length;for(let c=0;c<a;c++){var s=i[c];if(s.lightData.lightType!=eae.DirectionLight&&-1<s.lightData.castShadowIndex&&(s.needUpdateShadow||this._forceUpdate||Sre.frame<5||s.realTimeShadow)){s.needUpdateShadow=!1;var o=this.getShadowCamera(e,s),l=s.transform.worldPosition,u=(o.cubeCamera.x=l.x,o.cubeCamera.y=l.y,o.cubeCamera.z=l.z,o.cubeCamera.transform.updateWorldMatrix(!0),t.update(o.cubeCamera.right_camera,n),this.renderSceneOnce(0,o,e,o.cubeCamera.right_camera,r,t),t.update(o.cubeCamera.left_camera,n),this.renderSceneOnce(1,o,e,o.cubeCamera.left_camera,r,t),t.update(o.cubeCamera.up_camera,n),this.renderSceneOnce(2,o,e,o.cubeCamera.up_camera,r,t),t.update(o.cubeCamera.down_camera,n),this.renderSceneOnce(3,o,e,o.cubeCamera.down_camera,r,t),t.update(o.cubeCamera.front_camera,n),this.renderSceneOnce(4,o,e,o.cubeCamera.front_camera,r,t),t.update(o.cubeCamera.back_camera,n),this.renderSceneOnce(5,o,e,o.cubeCamera.back_camera,r,t),roe.beginCommandEncoder());for(let e=0;e<6;e++)u.copyTextureToTexture({texture:o.depthTexture[e].getGPUTexture(),mipLevel:0,origin:{x:0,y:0,z:0}},{texture:this.cubeArrayTexture.getGPUTexture(),mipLevel:0,origin:{x:0,y:0,z:6*s.shadowIndex+e}},{width:this.shadowSize,height:this.shadowSize,depthOrArrayLayers:1});roe.endCommandEncoder(u)}}this._forceUpdate=!1}}renderSceneOnce(e,t,n,r,i,a){this.rendererPassState=t.rendererPassState[e],t=roe.beginCommandEncoder(),(e=roe.beginRenderPass(t,this.rendererPassState)).setViewport(0,0,this.shadowSize,this.shadowSize,0,1),e.setScissorRect(0,0,this.shadowSize,this.shadowSize),r.onUpdate(),r.transform.updateWorldMatrix(!0),this.drawShadowRenderNodes(n,r,e,i.opaqueList,a),this.drawShadowRenderNodes(n,r,e,i.transparentList,a),roe.endPass(e),roe.endCommandEncoder(t)}drawShadowRenderNodes(e,t,n,r,i){roe.bindCamera(n,t);for(let d=nce.setting.render.drawOpMin;d<Math.min(r.length,nce.setting.render.drawOpMax);++d){var a=r[d];if(a.transform.worldMatrix.index,a.transform.enable&&i.renderCommitTesting(t,a)&&a.enable){a.nodeUpdate(e,this._rendererType,this.rendererPassState);for(let e=0;e<a.materials.length;e++){var s=a.materials[e].renderPasses.get(this._rendererType);if(s&&0!=s.length){roe.bindGeometryBuffer(n,a.geometry);var o=a.object3D.transform._worldMatrix;for(let e=0;e<s.length;e++){var l=s[e].renderShader,u=(l.setUniformFloat("cameraFar",t.far),l.setUniformVector3("lightWorldPos",t.transform.worldPosition),l.materialDataUniformBuffer.apply(),roe.bindPipeline(n,l),a.geometry.subGeometries);for(let e=0;e<u.length;e++){var c=u[e].lodLevels[a.lodLevel];roe.drawIndexed(n,c.indexCount,1,c.indexStart,0,o.index)}}}}}}}}class zoe extends kae{constructor(e,t,n=fie){super(e,t,4),this.visibility=GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT|GPUShaderStage.COMPUTE,this.format=n,this.mipmapCount=1,this.init()}internalCreateBindingLayoutDesc(){this.textureBindingLayout.sampleType="depth",this.textureBindingLayout.viewDimension="2d-array",this.samplerBindingLayout.type="filtering",this.sampler_comparisonBindingLayout.type="comparison"}internalCreateTexture(){this.textureDescriptor={format:this.format,size:{width:this.width,height:this.height,depthOrArrayLayers:this.numberLayer},dimension:"2d",usage:GPUTextureUsage.COPY_DST|GPUTextureUsage.TEXTURE_BINDING},this.gpuTexture=Dre.device.createTexture(this.textureDescriptor)}internalCreateView(){this.viewDescriptor={dimension:"2d-array"},this.view=this.gpuTexture.createView(this.viewDescriptor)}internalCreateSampler(){this.gpuSampler=Dre.device.createSampler({}),this.gpuSampler_comparison=Dre.device.createSampler({compare:"less",label:"sampler_comparison"})}}class Foe extends Aoe{constructor(){super(),bre(this,"shadowPassCount"),bre(this,"depth2DArrayTexture"),bre(this,"rendererPassStates"),bre(this,"_forceUpdate",!1),this.passType=zse.SHADOW,this.setShadowMap(nce.setting.shadow.shadowSize),nce.setting.shadow.debug&&this.debug()}debug(){}setShadowMap(e){this.rendererPassStates=[],this.depth2DArrayTexture=new zoe(e,e),Pse.getInstance().attached(this.depth2DArrayTexture,this);for(let r=0;r<8;r++){var t=new woe([],[]),n=((n=new boe(e,e,fie,!1)).name="shadowDepthTexture_"+r,t.depthTexture=n,t.label="shadowRender",t.customSize=!0,t.depthCleanValue=1,uoe.createRendererPassState(t));this.rendererPassStates[r]=n}}render(e,t){if(nce.setting.shadow.enable){var n=e.camera,r=e.scene;if(this.shadowPassCount=0,nce.setting.shadow.needUpdate&&Sre.frame%nce.setting.shadow.updateFrameRate==0){n.transform.updateWorldMatrix();var i=Sae.getDirectShadowLightWhichScene(r);for(let r=0;r<i.length;r++){var a,s,o,l=i[r];l.lightData.lightType==eae.DirectionLight&&(this.rendererPassState=this.rendererPassStates[l.shadowIndex],(l.castShadow&&l.needUpdateShadow||this._forceUpdate||l.castShadow&&nce.setting.shadow.autoUpdate)&&(l.needUpdateShadow=!1,a=Wie(nce.setting.shadow.shadowFar,n.near,n.far),s=Rre.HELP_4,(o=Rre.HELP_5).copy(n.lookTarget),s.copy(l.direction),s.normalize(),Rre.distance(n.transform.worldPosition,o),s.scaleBy(-a),s.add(o,s),l.shadowCamera.transform.lookAt(s,o),a=nce.setting.shadow.shadowBound,s=nce.setting.shadow.shadowBound,l.shadowCamera.orthoOffCenter(a/-2,a/2,s/-2,s/2,n.near,n.far),this.renderShadow(e,l.shadowCamera,t)),(o=roe.beginCommandEncoder()).copyTextureToTexture({texture:this.rendererPassStates[l.shadowIndex].depthTexture.getGPUTexture(),mipLevel:0,origin:{x:0,y:0,z:0}},{texture:this.depth2DArrayTexture.getGPUTexture(),mipLevel:0,origin:{x:0,y:0,z:l.shadowIndex}},{width:nce.setting.shadow.shadowSize,height:nce.setting.shadow.shadowSize,depthOrArrayLayers:1}),roe.endCommandEncoder(o))}this._forceUpdate=!1}}}compute(){}renderShadow(e,t,n){var r=Kse.instance.getRenderNodes(e.scene),i=roe.beginCommandEncoder(),a=roe.beginRenderPass(i,this.rendererPassState),s=(n=(t.transform.updateWorldMatrix(),n.update(t,e.scene),roe.bindCamera(a,t),this.renderShadowBundleOp(e,t)),this.renderShadowBundleTr(e,t));0<n.length&&a.executeBundles(n),this.drawShadowRenderNodes(e,t,a,r.opaqueList),0<s.length&&a.executeBundles(s),this.drawShadowRenderNodes(e,t,a,r.transparentList),roe.endPass(a),roe.endCommandEncoder(i)}renderShadowBundleOp(e,t){var n=Kse.instance.getOpRenderGroup(e.scene);if(n){let r=[];return n.renderGroup.forEach((n=>{var i;n.bundleMap.has(this._rendererType)?r.push(n.bundleMap.get(this._rendererType)):(i=roe.recordBundleEncoder(this.rendererPassState.renderBundleEncoderDescriptor),this.recordShadowRenderBundleNode(e,t,i,n.renderNodes),i=i.finish(),n.bundleMap.set(this._rendererType,i),r.push(i))})),r}return[]}renderShadowBundleTr(e,t){var n=Kse.instance.getTrRenderGroup(e.scene);if(n){let r=[];return n.renderGroup.forEach((n=>{var i;n.bundleMap.has(this._rendererType)?r.push(n.bundleMap.get(this._rendererType)):(i=roe.recordBundleEncoder(this.rendererPassState.renderBundleEncoderDescriptor),this.recordShadowRenderBundleNode(e,t,i,n.renderNodes),i=i.finish(),n.bundleMap.set(this._rendererType,i),r.push(i))})),r}return[]}recordShadowRenderBundleNode(e,t,n,r,i){roe.bindCamera(n,t),roe.bindGeometryBuffer(n,r[0].geometry);for(let s=0;s<r.length;++s){var a=r[s];a.transform.worldMatrix.index,a.transform.enable&&a.recordRenderPass2(e,this._rendererType,this.rendererPassState,i,n)}}drawShadowRenderNodes(e,t,n,r,i){roe.bindCamera(n,t);for(let s=nce.setting.render.drawOpMin;s<Math.min(r.length,nce.setting.render.drawOpMax);++s){var a=r[s];a.transform.enable&&a.enable&&a.renderPass2(e,this._rendererType,this.rendererPassState,i,n)}}}class Voe extends Aoe{constructor(){super(),bre(this,"zBufferTexture"),bre(this,"useRenderBundle",!1),bre(this,"shadowPassCount"),bre(this,"zCullingCompute"),this.passType=zse.DEPTH;var e=Dre.presentationSize,t=((t=(this.zBufferTexture=Coe.createRTTexture(_ie.zBufferTexture_NAME,Math.floor(+e[0]),Math.floor(+e[1]),die,!1),new xoe)).clearValue=[0,0,0,0],t.loadOp="clear",new woe([this.zBufferTexture],[new xoe],Coe.createRTTexture(_ie.zPreDepthTexture_NAME,Math.floor(e[0]),Math.floor(e[1]),fie,!1),null,!0));this.setRenderStates(t)}render(e,t){}}class Goe{constructor(){bre(this,"map"),bre(this,"passRendererList"),this.map=new Map,this.passRendererList=[]}addRenderer(e){this.map.has(e.passType)?console.error("same renderer pass repeat!"):(this.map.set(e.passType,e),e.passType<=8&&this.addPassRenderer(e))}getRenderer(e){return this.map.get(e)}addPassRenderer(e){this.passRendererList.push(e)}getAllRenderer(){return this.map}getAllPassRenderer(){return this.passRendererList}}class Hoe extends Aoe{constructor(){super(),bre(this,"finalQuadView"),bre(this,"postList"),this._rendererType=zse.POST,this.postList=[],this.initRenderer()}initRenderer(){Hre.register("FullQuad_vert_wgsl",'\n    #include "WorldMatrixUniform"\n    #include "GlobalUniform"\n\n    struct MaterialUniform {\n    x:f32,\n    y:f32,\n    width:f32,\n    height:f32,\n    };\n\n    struct VertexOutput {\n        @location(0) fragUV: vec2<f32>,\n        @builtin(position) position: vec4<f32>\n    };\n\n    @vertex\n    fn main(@builtin(vertex_index) vertexIndex : u32, @builtin(instance_index) index : u32 ) -> VertexOutput {\n        const pos = array(\n        vec2(-1.0, -1.0), vec2(1.0, -1.0), vec2(-1.0, 1.0),\n        vec2(-1.0, 1.0), vec2(1.0, -1.0), vec2(1.0, 1.0),\n        );\n        const uv = array(\n        vec2(1.0, 0.0), vec2(1.0, 1.0), vec2(0.0, 1.0), \n        vec2(1.0, 0.0), vec2(0.0, 1.0), vec2(0.0, 0.0),\n        );\n        let id = u32(index) ;\n        var output : VertexOutput;\n        output.fragUV = uv[vertexIndex] ;\n        output.position = vec4<f32>(pos[vertexIndex] , 0.0, 1.0) ;\n        return output ;\n    }\n'),this.finalQuadView=new _oe("Quad_vert_wgsl","Quad_frag_wgsl",new woe([],[]),null,null,!1)}attachPost(e,t){-1==(t.postRenderer=this).postList.indexOf(t)&&(this.postList.push(t),t.onAttach(e))}detachPost(e,t){var n=this.postList.indexOf(t);return 0<=n&&(this.postList.splice(n,1),t.onDetach(e),t.postRenderer=null),0<=n}render(e){var t=roe.beginCommandEncoder();for(let i=0;i<this.postList.length;i++){var n=this.postList[i];n.enable&&n.render(e,t)}var r=roe.lastRenderPassState.getLastRenderTexture();this.finalQuadView.renderToViewQuad(e,this.finalQuadView,t,r),this.debugViewQuads.length&&0<=(r=nce.setting.render.debugQuad)&&this.debugViewQuads[r].renderToViewQuad(e,this.debugViewQuads[r],t,this.debugTextures[r]),roe.endCommandEncoder(t)}}class joe{constructor(e){bre(this,"rendererMap"),bre(this,"shadowMapPassRenderer"),bre(this,"pointLightShadowRenderer"),bre(this,"ddgiProbeRenderer"),bre(this,"postRenderer"),bre(this,"clusterLightingRender"),bre(this,"occlusionSystem"),bre(this,"depthPassRenderer"),bre(this,"colorPassRenderer"),bre(this,"pauseRender",!1),bre(this,"pickFire"),bre(this,"_view"),this._view=e,this.rendererMap=new Goe,this.occlusionSystem=new koe,this.clusterLightingRender=this.addRenderer(Ooe,e),nce.setting.render.zPrePass&&(this.depthPassRenderer=this.addRenderer(Voe)),this.shadowMapPassRenderer=new Foe,this.pointLightShadowRenderer=new Uoe}addRenderer(e,t){let n;return n=t?new e(t):new e,this.rendererMap.addRenderer(n),n}get view(){return this._view}set view(e){this._view=e}start(){}stop(){}pause(){this.pauseRender=!0}resume(){this.pauseRender=!1}enablePost(e){this.postRenderer=this.addRenderer(Hoe),this.postRenderer.setRenderStates(e)}addPost(e){return this.postRenderer||this.enablePost(Loe.getGBufferFrame("ColorPassGBuffer")),e instanceof Toe&&this.postRenderer.attachPost(this.view,e),e}removePost(e){if(e instanceof Toe)this.postRenderer.detachPost(this.view,e);else for(let t=0;t<e.length;t++)this.postRenderer.detachPost(this.view,e[t])}renderFrame(){var e=this._view,t=(this.view.scene.waitUpdate(),toe.getLightEntries(e.scene).update(e),this.occlusionSystem.update(e.camera,e.scene),this.clusterLightingRender.render(e,this.occlusionSystem),this.shadowMapPassRenderer&&(Sae.update(e.scene),this.shadowMapPassRenderer.render(e,this.occlusionSystem)),this.pointLightShadowRenderer&&this.pointLightShadowRenderer.render(e,this.occlusionSystem),this.depthPassRenderer&&(this.depthPassRenderer.compute(e,this.occlusionSystem),this.depthPassRenderer.render(e,this.occlusionSystem)),nce.setting.gi.enable&&this.ddgiProbeRenderer&&(this.ddgiProbeRenderer.compute(e,this.occlusionSystem),this.ddgiProbeRenderer.render(e,this.occlusionSystem)),this.rendererMap.getAllPassRenderer());for(let r=0;r<t.length;r++){var n=t[r];n.compute(e,this.occlusionSystem),n.render(e,this.occlusionSystem,this.clusterLightingRender.clusterLightingBuffer)}this.postRenderer&&0<this.postRenderer.postList.length&&this.postRenderer.render(e)}debug(){}}class Woe extends bae{constructor(e=.001,t=1e4,n=90,r=!1){super(),bre(this,"up_camera"),bre(this,"down_camera"),bre(this,"left_camera"),bre(this,"right_camera"),bre(this,"front_camera"),bre(this,"back_camera"),this.initCubeCamera(e,t,n,r)}initCubeCamera(e,t,n=90,r=!1){this.up_camera=xae.createCamera3DObject(this,"up"),this.down_camera=xae.createCamera3DObject(this,"down"),this.left_camera=xae.createCamera3DObject(this,"left"),this.right_camera=xae.createCamera3DObject(this,"right"),this.front_camera=xae.createCamera3DObject(this,"front"),this.back_camera=xae.createCamera3DObject(this,"back"),this.up_camera.isShadowCamera=r,this.down_camera.isShadowCamera=r,this.left_camera.isShadowCamera=r,this.right_camera.isShadowCamera=r,this.front_camera.isShadowCamera=r,this.back_camera.isShadowCamera=r,this.up_camera.perspective(n,1,e,t),this.up_camera.lookAt(Rre.ZERO,Rre.UP,Rre.DOWN),this.down_camera.perspective(n,1,e,t),this.down_camera.lookAt(Rre.ZERO,Rre.DOWN,Rre.DOWN),this.left_camera.perspective(n,1,e,t),this.left_camera.lookAt(Rre.ZERO,Rre.LEFT),this.right_camera.perspective(n,1,e,t),this.right_camera.lookAt(Rre.ZERO,Rre.RIGHT),this.front_camera.perspective(n,1,e,t),this.front_camera.lookAt(Rre.ZERO,Rre.FORWARD),this.back_camera.perspective(n,1,e,t),this.back_camera.lookAt(Rre.ZERO,Rre.BACK),this.up_camera.type=cae.shadow,this.down_camera.type=cae.shadow,this.left_camera.type=cae.shadow,this.right_camera.type=cae.shadow,this.front_camera.type=cae.shadow,this.back_camera.type=cae.shadow}}class Yoe extends woe{constructor(e,t){super([],[]),this.crateGBuffer(e,t)}crateGBuffer(e,t){var n=this.attachments,r=this.rtDescriptors,i=new boe(e,t,die,!1),a=(i.name="positionMap",new xoe),s=(a.loadOp="load",new boe(e,t,die,!1)),o=(s.name="normalMap",new xoe),l=(o.loadOp="load",new boe(e,t,die,!1)),u=(l.name="colorMap",new xoe);(e=(u.loadOp="load",new boe(e,t,pie,!1))).name="depthTexture",(new xoe).loadOp="load",n.push(i),n.push(s),n.push(l),r.push(a),r.push(o),r.push(u),this.depthTexture=e}}class $oe{constructor(e){bre(this,"irradianceBuffer"),bre(this,"depthBuffer"),bre(this,"probeIrradianceMap"),bre(this,"probeDepthMap"),bre(this,"volume"),bre(this,"computeShader"),bre(this,"depthRaysBuffer"),this.volume=e,this.initPipeline()}initPipeline(){this.computeShader=new Uie('\n#include "GenerayRandomDir"\n#include "MathShader"\n#include "IrradianceVolumeData_frag"\n\nstruct ProbeData{\n  offsetX:f32,\n  offsetY:f32,\n  offsetZ:f32,\n  frame:f32,\n}\n\n struct Uniforms {\n     matrix : array<mat4x4<f32>>\n };\n\nstruct RayProbeBuffer{\n  WPosition: vec3<f32>,\n  WNormal:vec3<f32>,\n  WRadiance:vec4<f32>,\n}\n\nstruct CacheHitData{\n  color:vec4<f32>,\n  depth:vec4<f32>,\n}\n\n//  struct RayInfo{\n//   rays:array<vec4<f32>,4096>\n//  }\n\n@group(0) @binding(0) var<storage, read> probes : array<ProbeData>;\n@group(0) @binding(1) var<storage, read_write> irradianceBuffer : array<vec4<f32>>;\n@group(0) @binding(2) var<storage, read_write> depthBuffer : array<vec4<f32>>;\n@group(0) @binding(3) var<storage, read> uniformData : IrradianceVolumeData ;\n@group(0) @binding(4) var probeIrradianceMap : texture_storage_2d<rgba16float, write>;\n@group(0) @binding(5) var probeDepthMap : texture_storage_2d<rgba16float, write>;\n@group(0) @binding(6) var<storage, read_write> depthRaysBuffer : array<vec4<f32>>;\n\n@group(1) @binding(0) var positionMap : texture_2d<f32>;\n@group(1) @binding(1) var normalMap : texture_2d<f32>;\n@group(1) @binding(2) var colorMap : texture_2d<f32>;\n\n@group(2) @binding(0)\nvar<storage, read> models : Uniforms;\n\nvar<private> probeID: u32 ;\nvar<private> workgroup_idx: u32 ;\nvar<private> workgroup_idy: u32 ;\nvar<private> hysteresis: f32 = 0.98 ;\nvar<private> epsilon: f32 = 1e-6 ;\nvar<private> probeLocation:vec3<f32> = vec3<f32>(0.0);\nvar<private> energyConservation: f32 = 0.85 ;\nvar<private> resultIrradiance: vec4<f32> ;\nvar<private> resultDepth: vec4<f32> ;\nvar<private> RAYS_PER_PROBE: f32 = 144.0 ;\nvar<private> OCT_RT_SIZE: u32;\nvar<private> PROBE_OCT_RT_SIZE: u32;\nvar<private> OCT_SIDE_SIZE_u32: u32;\nvar<private> OCT_SIDE_SIZE_f32: f32;\nvar<private> OCT_RT_SIZE_f32: f32;\nvar<private> PROBE_SOURCESIZE: f32;\nvar<private> PROBEMAP_SOURCESIZE: f32;\nvar<private> quaternion:vec4<f32> = vec4<f32>(0.0, -0.7071067811865475, 0.7071067811865475, 0.0);\nvar<private> randomMatrix:mat4x4<f32>;\n\n@compute @workgroup_size( 8 , 8 , 1 )\nfn CsMain(@builtin(global_invocation_id) globalInvocation_id : vec3<u32>)\n{\n   RAYS_PER_PROBE = f32(i32(uniformData.rayNumber));\n   OCT_RT_SIZE = u32(uniformData.OctRTMaxSize);\n   OCT_RT_SIZE_f32 = f32(uniformData.OctRTMaxSize);\n   OCT_SIDE_SIZE_u32 = u32(uniformData.OctRTSideSize);\n   OCT_SIDE_SIZE_f32 = f32(uniformData.OctRTSideSize);\n   PROBE_SOURCESIZE = f32(uniformData.ProbeSize);\n   PROBEMAP_SOURCESIZE = f32(uniformData.ProbeSourceTextureSize);\n   hysteresis = uniformData.hysteresis;\n    // probe index\n    probeID = globalInvocation_id.z ;\n    // pixel coord\n    workgroup_idx = globalInvocation_id.x ;\n    workgroup_idy = globalInvocation_id.y;\n\n    probeLocation = calcProbePosition(probeID);\n\n    resultIrradiance = vec4<f32>(0.0);\n    resultDepth = vec4<f32>(0.0,0.0,0.0,0.0);\n\n    var tdr = normalize(getCurrentDir());\n    let orientationIndex = u32(uniformData.orientationIndex);\n    randomMatrix = models.matrix[orientationIndex];\n\n    var distancePprobeUV = getSampleProbeUV(tdr.xyz);\n    var rayUv:vec2<i32> = vec2<i32>(distancePprobeUV.xy * f32(PROBEMAP_SOURCESIZE - 1.0));\n    let rayHitPosition = textureLoad(positionMap, rayUv, 0).xyz ;\n    \n    for(var i:f32 = 0.0; i < RAYS_PER_PROBE ; i = i + 1.0 ){\n      radianceProbeOnce(i, tdr);\n    }\n\n    if (resultIrradiance.w > epsilon) {\n      var color = vec3<f32>(resultIrradiance.xyz/(2.0*resultIrradiance.w)) ;\n      color = pow(color.rgb, vec3<f32>(1.0 / uniformData.ddgiGamma));\n      resultIrradiance = vec4<f32>(color,1.0-hysteresis);\n    }\n\n    // if nonzero\n    if (resultDepth.w > epsilon) {\n      resultDepth = vec4<f32>(resultDepth.xyz/(2.0*resultDepth.w),1.0-hysteresis) ;\n    }\n\n   let pixelCoord = getWriteOctUVByID();\n\n   var lerpDataResult:CacheHitData;\n\n   lerpDataResult.color = resultIrradiance;\n\n   lerpDataResult.depth = resultDepth;\n\n   lerpDataResult = lerpHitData(lerpDataResult, pixelCoord);\n\n   writeRayHitData(pixelCoord, lerpDataResult);\n\n   storePixelAtCoord(probeIrradianceMap, pixelCoord , vec4<f32>(lerpDataResult.color.xyz, 1.0), true);\n\n   storePixelAtCoord(probeDepthMap, pixelCoord , vec4<f32>(resultDepth.xy, 0.0, 1.0), false);\n}\n\nfn lerpHitData(data:CacheHitData, coord:vec2<i32>) -> CacheHitData{\n   let frameIndex = probes[probeID].frame;\n   var newData:CacheHitData = data;\n\n   //if(frameIndex > 1.0){\n      var oldData = readRayHitData(coord);\n      newData.color = mix(oldData.color, newData.color, uniformData.lerpHysteresis);\n      newData.depth = mix(oldData.depth, newData.depth, uniformData.lerpHysteresis);\n   //}\n   return newData;\n}\n\nfn square(v:vec3<f32>) -> vec3<f32>{\n   var v3 = v;\n   v3.x = v3.x * v3.x;\n   v3.y = v3.y * v3.y;\n   v3.z = v3.z * v3.z;\n   return v3;\n}\n\n fn testSample() ->vec4<f32>{\n   var ux = f32(workgroup_idx) / OCT_SIDE_SIZE_f32;\n   var uy = f32(workgroup_idy) / OCT_SIDE_SIZE_f32;\n   var uv = vec2<f32>(ux,uy) * 2.0 - 1.0 ;\n   var dir = octDecode(uv);\n   var probeUV = getSampleProbeUV(dir.xyz);\n   var rayProbeBuffer = getCurrentRayHitBuffer(probeUV);\n   return rayProbeBuffer.WRadiance;\n }\n\n fn gridCoordToProbeIndex(grid:vec3<i32>) -> i32\n {\n     return grid.x + grid.z * i32(uniformData.gridXCount) + grid.y * i32(uniformData.gridXCount * uniformData.gridZCount);\n }\n\nfn storePixelAtCoord(texture:texture_storage_2d<rgba16float, write>, coord:vec2<i32>, color:vec4<f32>, isColor:bool){\n   let sideCnt = i32(OCT_SIDE_SIZE_u32);\n   let sideBorderCnt = sideCnt + 2;\n   let indexXY = coord / sideCnt;\n   let modeXY = coord % sideCnt;\n\n   var newCoord = indexXY * sideBorderCnt + modeXY;\n   textureStore(texture, newCoord + 1, color);\n\n   var borderCoord = vec2<i32>(-1);\n   //左右\n   if(modeXY.x % (sideCnt - 1) == 0){\n     borderCoord = modeXY;\n     borderCoord.y = sideCnt - borderCoord.y;\n     if(modeXY.x == sideCnt - 1){\n       borderCoord.x = sideBorderCnt - 1;\n     }\n     borderCoord = indexXY * sideBorderCnt + borderCoord;\n     textureStore(texture, borderCoord, color);\n   }\n   //上下\n   if(modeXY.y % (sideCnt - 1) == 0){\n     borderCoord = modeXY;\n     borderCoord.x = sideCnt - borderCoord.x;\n     if(modeXY.y == sideCnt - 1){\n         borderCoord.y = sideBorderCnt - 1;\n     }\n     borderCoord = indexXY * sideBorderCnt + borderCoord;\n     textureStore(texture, borderCoord, color);\n   }\n   //补角\n   if(modeXY.x % (sideCnt - 1) == 0 && modeXY.y % (sideCnt - 1) == 0){\n      var cornerCoord = modeXY;\n      if(modeXY.x == 0){\n         cornerCoord.x = sideBorderCnt - 1;\n      }else{\n         cornerCoord.x = 0;\n      }\n       if(modeXY.y == 0){\n         cornerCoord.y = sideBorderCnt - 1;\n      }else{\n         cornerCoord.y = 0;\n      }\n      cornerCoord = indexXY * sideBorderCnt + cornerCoord;\n      textureStore(texture, cornerCoord, color);\n   }\n}\n\nfn calcProbePosition(id:u32) -> vec3<f32>{\n   var probeLocation = vec3<f32>(0.0);\n   var blockCount = u32(uniformData.gridXCount * uniformData.gridZCount) ;\n   var grid = vec3<u32>(0u);\n   grid.x = (id % blockCount) % u32(uniformData.gridXCount);\n   grid.y = id / blockCount;\n   grid.z = (id % blockCount) / u32(uniformData.gridXCount);\n   probeLocation.x = f32(grid.x) * uniformData.ProbeSpace + uniformData.startX;\n   probeLocation.y = f32(grid.y) * uniformData.ProbeSpace + uniformData.startY;\n   probeLocation.z = f32(grid.z) * uniformData.ProbeSpace + uniformData.startZ;\n   return probeLocation;\n}\n\nfn getWriteOctUVByID() -> vec2<i32>\n{\n   var blockCount = u32(uniformData.gridXCount * uniformData.gridZCount) ;\n   var offsetX = (probeID % blockCount) % u32(uniformData.gridXCount) ;\n   var offsetY = u32(uniformData.gridZCount - 1.0) - (probeID % blockCount) / u32(uniformData.gridXCount) ;\n   var offsetZ = probeID / blockCount ;\n   var pixelCoord = vec2<i32>(i32(workgroup_idx), i32(workgroup_idy));\n   pixelCoord.x = pixelCoord.x + i32(offsetX * OCT_SIDE_SIZE_u32);\n   pixelCoord.y = pixelCoord.y + i32(offsetY * OCT_SIDE_SIZE_u32 + offsetZ * u32(uniformData.gridZCount) * OCT_SIDE_SIZE_u32);\n\n   pixelCoord = offsetByCol(pixelCoord, OCT_SIDE_SIZE_f32, OCT_RT_SIZE, vec3<f32>(uniformData.gridXCount, uniformData.gridYCount, uniformData.gridZCount));\n   return pixelCoord;\n}\n\nfn offsetByCol(pixelCoord0:vec2<i32>, octSideSize:f32, mapHeight:u32, counts:vec3<f32>) -> vec2<i32>\n{\n var pixelCoord = pixelCoord0;\n let blockSize:vec2<i32> = vec2<i32>(i32(octSideSize * counts.x),  i32(octSideSize * counts.z));\n let blockSizeYBorder:i32 = i32((octSideSize + 2.0) * counts.z);\n let blockMaxRowBorder:i32 = i32(mapHeight) / blockSizeYBorder;\n let pixelCountYMax:i32 = blockMaxRowBorder * i32(octSideSize * counts.z);\n let col:i32 = pixelCoord.y / pixelCountYMax;\n\n pixelCoord.x = col * i32(octSideSize * counts.x) + pixelCoord.x;\n pixelCoord.y = pixelCoord.y % pixelCountYMax;\n\n return pixelCoord;\n}\n\nfn radianceProbeOnce(rayID:f32, tdr:vec3<f32>){\n   var texelDirection = sphericalFibonacci(rayID, RAYS_PER_PROBE ) ;\n   var rayDirection = normalize( vec3<f32>((randomMatrix * vec4<f32>(texelDirection, 1.0)).xyz));\n   var probeUV = getSampleProbeUV(rayDirection.xyz);\n   var rayWriteUV = getWriteRayInfoUV();\n\n   var rayProbeBuffer = getCurrentRayHitBuffer(probeUV);\n   var rayHitLocation = rayProbeBuffer.WPosition + normalize(rayProbeBuffer.WNormal) * 0.01;\n\n   var rayProbeDistance = length(probeLocation - rayHitLocation) ;\n   // rayProbeDistance = min(uniformData.ProbeSpace * 4.0, rayProbeDistance) ;\n\n   // if (dot(rayProbeBuffer.WNormal, rayProbeBuffer.WNormal) < epsilon) {\n   //   rayProbeDistance = epsilon ;\n   // }\n\n   let rid = i32(probeID) * i32(RAYS_PER_PROBE) + i32(rayID) ;\n   depthRaysBuffer[rid] = vec4<f32>(rayDirection.xyz,rayProbeDistance) ;\n\n   // Detect misses and force depth\n   var i_weight = max(0.0, dot(tdr,rayDirection) );\n   var d_weight = pow(i_weight, uniformData.depthSharpness);\n   \n   if (i_weight >= epsilon) {\n     //  var weightColor = pow(weight, (2.0 - uniformData.probeRoughness) * 2.0);\n      resultIrradiance += vec4(rayProbeBuffer.WRadiance.rgb, i_weight );\n     \n   }\n   if(d_weight>= epsilon){\n       resultDepth += vec4(rayProbeDistance * d_weight, rayProbeDistance * rayProbeDistance * d_weight, 0.0 , i_weight);\n   }\n}\n\nfn getCurrentRayHitBuffer(probeUV:vec2<f32>) -> RayProbeBuffer {\n  var rayProbeBuffer : RayProbeBuffer ;\n  var uv:vec2<i32> = vec2<i32>(probeUV.xy * f32(PROBEMAP_SOURCESIZE - 1.0));\n  rayProbeBuffer.WPosition = textureLoad(positionMap, uv, 0).xyz ;\n  rayProbeBuffer.WNormal = normalize(textureLoad(normalMap, uv, 0).xyz * 2.0 - 1.0);\n  rayProbeBuffer.WRadiance = textureLoad(colorMap, uv, 0).xyzw * energyConservation;\n  return rayProbeBuffer ;\n}\n\nfn getSampleProbeUV(dir0:vec3<f32>) -> vec2<f32> {\n   var dir = applyQuaternion(dir0, quaternion);\n   let faceId = dir_to_faceId(dir);\n   var targetUV:vec2<f32> = convert_xyz_to_cube_uv(dir.x, dir.y, dir.z);\n   targetUV.x = 1.0 - targetUV.x;\n   let threshould = 0.5 / PROBE_SOURCESIZE;\n   targetUV = clamp(targetUV, vec2<f32>(threshould), vec2<f32>(1.0 - threshould));\n\n   targetUV.x = f32(faceId) + targetUV.x;\n\n   let aspect:f32 = PROBE_SOURCESIZE / PROBEMAP_SOURCESIZE;\n   targetUV = targetUV * aspect ;\n\n   var fullCol = u32(PROBEMAP_SOURCESIZE) / u32(PROBE_SOURCESIZE);\n   var offsetSampleUv = vec2<f32>( f32(probeID / fullCol) * 6.0 , f32(probeID % fullCol)) * aspect;\n   return targetUV + offsetSampleUv;\n}\n\nfn getWriteRayInfoUV() -> vec2<i32> {\n  var writeUV = vec2<i32>(i32(workgroup_idy),i32(probeID)) ;\n  return writeUV ;\n}\n\nfn writeRayHitData( uv:vec2<i32> , data:CacheHitData){\n  let index = uv.y * i32(OCT_RT_SIZE) + uv.x ;\n  irradianceBuffer[index] = data.color ;\n  depthBuffer[index] = data.depth ;\n}\n\nfn readRayHitData( uv:vec2<i32> ) -> CacheHitData{\n  var data:CacheHitData;\n  let index = uv.y * i32(OCT_RT_SIZE) + uv.x ;\n  data.color = irradianceBuffer[index] ;\n  data.depth = depthBuffer[index] ;\n  return data;\n}\n\nfn getCurrentDir() -> vec3<f32> {\n  var ux = f32(workgroup_idx) / OCT_SIDE_SIZE_f32;\n  var uy = f32(workgroup_idy) / OCT_SIDE_SIZE_f32;\n  var uv = vec2<f32>(ux,uy) * 2.0 - 1.0 ;\n  var dir = octDecode(uv) ;\n  return normalize(dir) ;\n}\n\n\n');var e=(e=nce.setting.gi).octRTMaxSize*e.octRTMaxSize;this.irradianceBuffer=new Aie(4*e,GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST),this.computeShader.setStorageBuffer("irradianceBuffer",this.irradianceBuffer),this.depthBuffer=new Aie(4*e,GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST),this.computeShader.setStorageBuffer("depthBuffer",this.depthBuffer),this.depthRaysBuffer=new Aie(131072,GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST|GPUBufferUsage.COPY_SRC),this.computeShader.setStorageBuffer("depthRaysBuffer",this.depthRaysBuffer),this.computeShader.setStorageBuffer("probes",this.volume.probesBuffer),this.computeShader.setStorageBuffer("uniformData",this.volume.irradianceVolumeBuffer),this.computeShader.setStorageBuffer("models",toe.modelMatrixBindGroup.matrixBufferDst)}setTextures(e,t,n){this.probeIrradianceMap=t,this.probeDepthMap=n,t=e[0],n=e[1],e=e[2],this.computeShader.setStorageTexture("probeIrradianceMap",this.probeIrradianceMap),this.computeShader.setStorageTexture("probeDepthMap",this.probeDepthMap),this.computeShader.setSamplerTexture("positionMap",t),this.computeShader.setSamplerTexture("normalMap",n),this.computeShader.setSamplerTexture("colorMap",e)}readBuffer(){return this.depthRaysBuffer.readBuffer()}computer(e,t){var n=this.volume.setting,r=roe.beginCommandEncoder();e=Kse.instance.getProbes(e.scene);this.computeShader.workerSizeX=n.octRTSideSize/8,this.computeShader.workerSizeY=n.octRTSideSize/8,this.computeShader.workerSizeZ=e.length,roe.computeCommand(r,[this.computeShader])}}class Xoe{constructor(e){bre(this,"blendTexture"),bre(this,"volume"),bre(this,"computerShader"),this.volume=e,this.initPipeline()}initPipeline(){var e=nce.setting.gi;this.blendTexture=new boe(e.probeSourceTextureSize,e.probeSourceTextureSize,die,!1,GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.STORAGE_BINDING),this.computerShader=new Uie('\n  #include "MathShader"\n  #include "IrradianceVolumeData_frag"\n\n  struct IrradianceField {\n      probeStartPosition: vec4<f32>,\n      probeCounts:vec4<f32>,\n      probeStep:f32,\n      irradianceTextureWidth:f32,\n      irradianceTextureHeight:f32,\n      irradianceProbeSideLength:f32,\n  };\n\n  @group(0) @binding(0) var outputBuffer : texture_storage_2d<rgba16float, write>;\n  @group(0) @binding(1) var<storage,read> uniformData : IrradianceVolumeData ;\n\n  @group(1) @binding(0) var normalMapSampler : sampler;\n  @group(1) @binding(1) var normalMap : texture_2d<f32>;\n\n  @group(1) @binding(2) var colorMapSampler : sampler;\n  @group(1) @binding(3) var colorMap : texture_2d<f32>;\n\n  @group(1) @binding(4) var litMapSampler : sampler;\n  @group(1) @binding(5) var litMap : texture_2d<f32>;\n\n  @group(1) @binding(6) var irradianceMapSampler : sampler;\n  @group(1) @binding(7) var irradianceMap : texture_2d<f32>;\n\n  var<private> wsn:vec3<f32>;\n  var<private> ulitColor:vec4<f32>;\n  var<private> litColor:vec4<f32>;\n  var<private> irradianceFieldSurface : IrradianceField ;\n  var<private> probeID:u32;\n\n  var<private> quaternion:vec4<f32> = vec4<f32>(0.0, -0.7071067811865475, 0.7071067811865475, 0.0);\n\n  fn getIrradianceFieldSurface() -> IrradianceField{\n    let data = uniformData;\n    irradianceFieldSurface.probeStartPosition = vec4<f32>(data.startX, data.startY, data.startZ, 0.0);\n    irradianceFieldSurface.probeCounts = vec4<f32>(data.gridXCount, data.gridYCount, data.gridZCount, 0.0);\n    irradianceFieldSurface.probeStep = data.ProbeSpace;\n    irradianceFieldSurface.irradianceTextureWidth = data.OctRTMaxSize;\n    irradianceFieldSurface.irradianceTextureHeight = data.OctRTMaxSize;\n    irradianceFieldSurface.irradianceProbeSideLength = data.OctRTSideSize;\n    return irradianceFieldSurface;\n  }\n\n  fn rotateDir(n:vec3<f32>) -> vec3<f32>{\n     return normalize(applyQuaternion(-n, quaternion));\n  }\n\n  fn sampleLitColor(uv:vec2<i32>) -> vec4<f32>\n  {\n      var oc1:vec4<f32> = textureSampleLevel(litMap, litMapSampler, vec2<f32>(0.0), 0.0);\n      var oc:vec4<f32> = textureLoad(litMap, uv, 0);\n      return oc;\n  }\n\n  fn sampleNormal(uv:vec2<i32>) -> vec4<f32>\n  {\n      var oc1:vec4<f32> = textureSampleLevel(normalMap, normalMapSampler, vec2<f32>(0.0), 0.0);\n      var oc:vec4<f32> = textureLoad(normalMap, uv, 0);\n      return oc;\n  }\n\n  fn sampleColor(uv:vec2<i32>) -> vec4<f32>\n  {\n      var oc1:vec4<f32> = textureSampleLevel(colorMap, colorMapSampler, vec2<f32>(0.0), 0.0);\n      var oc:vec4<f32> = textureLoad(colorMap, uv, 0);\n      return oc;\n  }\n\n  fn sampleProbe(fragCoord:vec2<u32>){\n    var uv = vec2<i32>(i32(fragCoord.x), i32(fragCoord.y)) ;\n\n    litColor = sampleLitColor(uv);\n\n    var normalMap = sampleNormal(uv);\n    wsn = normalMap.xyz * 2.0 - 1.0;\n\n    ulitColor = sampleColor(uv);\n  }\n\n  @compute @workgroup_size( 8 , 8 , 1 )\n  fn CsMain(@builtin(global_invocation_id) globalInvocation_id : vec3<u32>)\n  {\n    getIrradianceFieldSurface();\n    var fragCoord = vec2<u32>( globalInvocation_id.x, globalInvocation_id.y);\n    probeID = globalInvocation_id.z;\n    fragCoord = fragCoord + getCoordOffset(probeID);\n\n    sampleProbe(fragCoord);\n\n    let irradiance = getIrradianceColor();\n    let result = blendIrradianceColor(irradiance);\n    textureStore(outputBuffer, vec2<i32>(fragCoord), result);\n  }\n\n  fn blendIrradianceColor(irradiance:vec4<f32>) -> vec4<f32>{\n     var bounceColor = irradiance * ulitColor;\n     let bounceIntensity = getBounceIntensity(uniformData.bounceIntensity);\n     let conservation1 = 1.0 / sqrt((1.0 + bounceIntensity * 0.55));\n     let conservation2 = 1.0 / sqrt((1.0 + bounceIntensity));\n     var result = litColor * conservation2 + bounceColor * sqrt(bounceIntensity) * conservation1;\n     return vec4<f32>(result.xyz, litColor.w);\n  }\n\n  fn getBounceIntensity(intensity:f32) -> f32 {\n    var value = clamp(intensity, 0.0, 1.0) * 10.0;\n    return value;\n  }\n\n  fn getCoordOffset(id:u32) -> vec2<u32>{\n      var fullCol = u32(uniformData.ProbeSourceTextureSize / uniformData.ProbeSize);\n      var offsetSampleUv = vec2<u32>( (id / fullCol) * 6u , id % fullCol) * u32(uniformData.ProbeSize);\n      return offsetSampleUv;\n  }\n\n  fn getIrradianceColor() -> vec4<f32>{\n     var probeIrradiance: vec4<f32> = vec4<f32>(0.0);\n     if(length(wsn) > 0.01){\n       probeIrradiance = getIrrdiaceIndex(i32(probeID), wsn);\n     }\n     return probeIrradiance;\n  }\n\n  fn getIrrdiaceIndex(index:i32, wsn:vec3<f32>) -> vec4<f32>{\n    var wsN = rotateDir(wsn.xyz);\n    var texCoord:vec2<f32> = textureCoordFromDirection(wsN,\n      index,\n      irradianceFieldSurface.irradianceTextureWidth,\n      irradianceFieldSurface.irradianceTextureHeight,\n      irradianceFieldSurface.irradianceProbeSideLength);\n\n    var probeIrradiance: vec3<f32> = textureSampleLevel(irradianceMap, irradianceMapSampler, texCoord, 0.0).xyz;\n    return vec4<f32>(probeIrradiance, 1.0);\n  }\n\n  fn textureCoordFromDirection(dir:vec3<f32>, probeIndex:i32, width:f32, height:f32, sideLength:f32) -> vec2<f32>\n  {\n      var uv = getWriteOctUVByID(dir, u32(probeIndex), sideLength) ;\n      uv.x = uv.x / irradianceFieldSurface.irradianceTextureWidth;\n      uv.y = uv.y / irradianceFieldSurface.irradianceTextureHeight;\n      return uv ;\n  }\n\n  fn getWriteOctUVByID(dir:vec3<f32> , probeID:u32, size: f32) -> vec2<f32>\n  {\n      var blockCount = u32(irradianceFieldSurface.probeCounts.x * irradianceFieldSurface.probeCounts.z) ;\n      var offsetX = (probeID % blockCount) % u32(irradianceFieldSurface.probeCounts.x) ;\n      var offsetY = u32(irradianceFieldSurface.probeCounts.z - 1.0) - (probeID % blockCount) / u32(irradianceFieldSurface.probeCounts.x) ;\n      var offsetZ = probeID / blockCount ;\n\n      var pixelCoord = (( octEncode(dir) + 1.0 ) * 0.5) * vec2<f32>(size,size) ;\n\n      var blockOffset = vec2<f32>(0.0);\n      blockOffset.x = f32(offsetX) * size;\n      blockOffset.y = f32(offsetY) * size + f32(offsetZ) * f32(irradianceFieldSurface.probeCounts.z) * size;\n\n      let mapHeight = u32(irradianceFieldSurface.irradianceTextureHeight);\n      var probeCounts:vec3<f32> = vec3<f32>(irradianceFieldSurface.probeCounts.xyz);\n\n      var gridOffsetFrom = vec2<i32>(blockOffset) + 1;\n      var gridOffsetTo = offsetByCol(gridOffsetFrom, size, mapHeight, probeCounts);\n\n      pixelCoord = pixelCoord + vec2<f32>(gridOffsetTo - 1) + vec2<f32>(vec2<i32>(vec2<f32>(gridOffsetTo) / size) * 2);\n\n      return pixelCoord + 1.0 ;\n  }\n\n  fn offsetByCol(pixelCoord0:vec2<i32>, octSideSize:f32, mapHeight:u32, counts:vec3<f32>) -> vec2<i32>\n  {\n    var pixelCoord = pixelCoord0;\n    let blockSize:vec2<i32> = vec2<i32>(i32(octSideSize * counts.x),  i32(octSideSize * counts.z));\n    let blockSizeYBorder:i32 = i32((octSideSize + 2.0) * counts.z);\n    let blockMaxRowBorder:i32 = i32(mapHeight) / blockSizeYBorder;\n    let pixelCountYMax:i32 = blockMaxRowBorder * i32(octSideSize * counts.z);\n    let col:i32 = pixelCoord.y / pixelCountYMax;\n\n    pixelCoord.x = col * i32(octSideSize * counts.x) + pixelCoord.x;\n    pixelCoord.y = pixelCoord.y % pixelCountYMax;\n\n    return pixelCoord;\n  }\n'),this.computerShader.setStorageTexture("outputBuffer",this.blendTexture),this.computerShader.setStorageBuffer("uniformData",this.volume.irradianceVolumeBuffer)}setInputs(e){var t=e[0],n=e[1],r=e[2];e=e[3];this.computerShader.setSamplerTexture("normalMap",t),this.computerShader.setSamplerTexture("colorMap",n),this.computerShader.setSamplerTexture("litMap",r),this.computerShader.setSamplerTexture("irradianceMap",e)}computer(e,t){var n=roe.beginCommandEncoder(),r=(i=this.volume.setting).probeXCount*i.probeYCount*i.probeZCount,i=i.probeSize;this.computerShader.workerSizeX=6*i/8,this.computerShader.workerSizeY=i/8,this.computerShader.workerSizeZ=r,roe.computeCommand(n,[this.computerShader])}}class qoe{constructor(){bre(this,"computeShader"),bre(this,"worldPosMap"),bre(this,"worldNormalMap"),bre(this,"colorMap"),bre(this,"shadowMap"),bre(this,"pointShadowMap"),bre(this,"lightingTexture");var e=nce.setting.gi;this.lightingTexture=new boe(e.probeSourceTextureSize,e.probeSourceTextureSize,die,!1,GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.STORAGE_BINDING)}create(e){e=toe.getLightEntries(e.scene),this.computeShader=new Uie('\n\n#include "MathShader"\n#include "FastMathShader"\n#include "ColorUtil"\nstruct GlobalUniform {\n   projMat: mat4x4<f32>,\n   viewMat: mat4x4<f32>,\n   cameraWorldMatrix: mat4x4<f32>,\n   pvMatrixInv : mat4x4<f32>,\n   shadowMatrix: array<mat4x4<f32>,8>,\n   CameraPos: vec3<f32>,\n   \n   frame: f32,\n   time: f32,\n   delta: f32,\n   shadowBias: f32,\n   skyExposure: f32,\n   renderPassState:f32,\n   quadScale: f32,\n   hdrExposure: f32,\n  \n   renderState_left: i32,\n   renderState_right: i32,\n   renderState_split: f32,\n\n   mouseX: f32,\n   mouseY: f32,\n   windowWidth: f32,\n   windowHeight: f32,\n\n   near: f32,\n   far: f32,\n\n   pointShadowBias: f32,\n   shadowMapSize: f32,\n   shadowSoft: f32,\n };\n\nstruct ConstUniform{\n   screenWidth:f32,\n   screenHeight:f32\n}\n\nstruct LightData {\n     index:f32,\n     lightType:i32,\n     radius:f32,\n     linear:f32,\n     \n     position:vec3<f32>,\n     lightMatrixIndex:f32,\n\n     direction:vec3<f32>,\n     quadratic:f32,\n\n     lightColor:vec3<f32>,\n     intensity:f32,\n\n     innerCutOff :f32,\n     outerCutOff:f32,\n     range :f32,\n     castShadow:i32,\n\n     lightTangent:vec3<f32>,\n     ies:f32,\n};\n\nstruct Uniforms {\n     matrix : array<mat4x4<f32>>\n };\n\nconst PointLightType = 1;\nconst DirectLightType = 2;\nconst SpotLightType = 3;\n\n@group(0) @binding(0) var outputBuffer : texture_storage_2d<rgba16float, write>;\n@group(0) @binding(1) var prefilterMapSampler: sampler;\n@group(0) @binding(2) var prefilterMap: texture_cube<f32>;\n@group(0) @binding(3) var<uniform> globalUniform: GlobalUniform;\n\n@group(1) @binding(0) var positionMapSampler : sampler;\n@group(1) @binding(1) var positionMap : texture_2d<f32>;\n\n@group(1) @binding(2) var normalMapSampler : sampler;\n@group(1) @binding(3) var normalMap : texture_2d<f32>;\n\n@group(1) @binding(4) var colorMapSampler : sampler;\n@group(1) @binding(5) var colorMap : texture_2d<f32>;\n\n@group(1) @binding(6) var shadowMapSampler : sampler_comparison;\n@group(1) @binding(7) var shadowMap : texture_depth_2d_array;\n\n@group(1) @binding(8) var pointShadowMapSampler: sampler;\n@group(1) @binding(9) var pointShadowMap: texture_depth_cube_array ;\n\n@group(2) @binding(0)\nvar<storage,read> lightBuffer: array<LightData>;\n\n@group(2) @binding(1)\nvar<storage, read> models : Uniforms;\n\nstruct ShadowStruct{\n directShadowVisibility:f32,\n pointShadows:array<f32,8>,\n}\nvar<private> shadowStrut: ShadowStruct ;\n\nvar<private> wsn:vec3<f32>;\nvar<private> ulitColor:vec3<f32>;\n\nvar<private> shadow:f32 = 1.0;\n\nconst LUMEN = 10.764;\n\nfn samplePosition(uv:vec2<i32>) -> vec4<f32>\n{\n   var oc1:vec4<f32> = textureSampleLevel(positionMap, positionMapSampler, vec2<f32>(0.0), 0.0);\n   var oc:vec4<f32> = textureLoad(positionMap, uv, 0) ;\n   return oc;\n}\n\nfn sampleNormal(uv:vec2<i32>) -> vec4<f32>\n{\n   var oc1:vec4<f32> = textureSampleLevel(normalMap, normalMapSampler, vec2<f32>(0.0), 0.0);\n   var oc:vec4<f32> = textureLoad(normalMap, uv, 0);\n   return oc;\n}\n\nfn sampleColor(uv:vec2<i32>) -> vec4<f32>\n{\n   var oc1:vec4<f32> = textureSampleLevel(colorMap, colorMapSampler, vec2<f32>(0.0), 0.0);\n   var oc:vec4<f32> = textureLoad(colorMap, uv, 0);\n   ulitColor = vec3(oc.xyz);\n   return oc;\n}\n\nfn directionShadowMapping(worldPos:vec3<f32>,shadowBias:f32) {\n   var shadowPos = globalUniform.shadowMatrix[0] * vec4<f32>(worldPos.xyz, 1.0);\n   var shadowUV = shadowPos.xy * vec2<f32>(0.5, -0.5) + vec2<f32>(0.5, 0.5) ;\n   let texelSize = 1.0 / vec2<f32>(globalUniform.shadowMapSize);\n\n   var visibility = 0.0 ;\n   let oneOverShadowDepthTextureSize = texelSize ;\n   for (var y = -1; y <= 1; y++) {\n       for (var x = -1; x <= 1; x++) {\n           let offset = shadowUV * oneOverShadowDepthTextureSize;\n           visibility += textureSampleCompareLevel( shadowMap, shadowMapSampler, shadowUV + offset , 0 , shadowPos.z - shadowBias );\n       }\n   }\n   visibility /= 9.0;\n   shadowStrut.directShadowVisibility = visibility;\n}\n\nfn pointShadowMapCompare(worldPos:vec3<f32>,shadowBias:f32){\n   for(var i:i32 = i32(0) ; i < i32(8); i = i + 1 )\n   { \n       var v = 1.0 ;\n       let light = lightBuffer[i] ;\n       if(light.castShadow < 0 ){\n         shadowStrut.pointShadows[i] = v ;\n         continue ;\n       }\n\n       let frgToLight = worldPos - light.position.xyz;\n       var dir:vec3<f32> = normalize(frgToLight)  ;\n\n       var len = length(frgToLight) ;\n       var depth = textureSampleLevel(pointShadowMap,pointShadowMapSampler,dir.xyz,i,0); \n       depth *= globalUniform.far ;\n       if((len - shadowBias) > depth){\n          v = 0.0 ; \n       }\n       shadowStrut.pointShadows[i] = v ;\n   }\n} \n\nfn directLighting( albedo:vec3<f32> , WP :vec3<f32>, N:vec3<f32> , V:vec3<f32> , light:LightData , shadowBias:f32  ) -> vec3<f32> {\n var L = -normalize(light.direction.xyz) ;\n var NoL = max(dot(N,L),0.0);\n let lightCC = pow( light.lightColor.rgb,vec3<f32>(2.2));\n var lightColor = getHDRColor( lightCC , light.linear ) ;\n var att = light.intensity / LUMEN ;\n if(light.castShadow>=0){\n     lightColor *= shadowStrut.directShadowVisibility ;\n }\n let finalLight = (albedo / PI) * lightColor * NoL * att * 2.0 ;\n return finalLight ;\n}\n\nfn pointLighting( albedo:vec3<f32>,WP:vec3<f32>, N:vec3<f32>, V:vec3<f32>, light:LightData ) -> vec3<f32> {\n let lightPos = models.matrix[u32(light.lightMatrixIndex)][3].xyz;\n var dir = lightPos.xyz - WP ;\n let dist = length(dir);\n var color = vec3<f32>(0.0) ;\n\n if(dist != 0.0){\n   dir *= 1.0 / dist ;\n }\n\n if( abs(dist) < light.range ){\n     var L = dir ;\n     var atten = 1.0 ;\n     atten = 1.0 - smoothstep(0.0,light.range,dist) ;\n     atten *= 1.0 / max(light.radius,0.0001) ;\n\n     var lightColor = light.lightColor.rgb  ;\n     lightColor = getHDRColor(lightColor , light.linear ) * light.intensity / LUMEN * 2.0;\n     color = (albedo / PI) * lightColor.rgb * atten ;\n }\n\n return  color *0.0;\n}\n\nfn spotLight( albedo:vec3<f32>,WP:vec3<f32>, N:vec3<f32>, V:vec3<f32>, light:LightData ) -> vec3<f32> {\n let lightPos = models.matrix[u32(light.lightMatrixIndex)][3].xyz;\n var dir = lightPos.xyz - WP ;\n let dist = length(dir) ;\n\n if(dist != 0.0){\n   dir *= 1.0 / dist ;\n }\n\n var color = vec3<f32>(0.0) ;\n if( abs(dist) < light.range * 2.0 ){\n     var L = dir ;\n     let theta = dot(-L, normalize(light.direction));\n     let angle = acos(theta) ;\n     var atten = 1.0 ;\n     atten = 1.0 - smoothstep(0.0,light.range,dist) ;\n     atten *= 1.0 / max(light.radius,0.1) ;\n     if(angle < light.outerCutOff){\n       if(angle > light.innerCutOff){\n         atten *= 1.0 - smoothstep(light.innerCutOff, light.outerCutOff, angle) ;\n       }\n     }else{\n       atten = 0.0 ;\n     }\n     var lightColor = light.lightColor.rgb  ;\n     lightColor = getHDRColor(lightColor , light.linear ) * light.intensity / LUMEN * 2.0;\n     color = (albedo / PI) * lightColor.rgb * atten ;\n   }\n return  color ;\n}\n\nfn coordFun(fragCoord:vec2<u32>)-> vec4<f32>{\n var uv = vec2<i32>(i32(fragCoord.x), i32(fragCoord.y)) ;\n var pos = samplePosition(uv);\n\n var normalMap = sampleNormal(uv);\n wsn = normalMap.xyz * 2.0 - 1.0;\n var normal = normalize( wsn );\n\n var color = sampleColor(uv);\n var emissive = vec4<f32>(pos.a,normalMap.a,color.a,0.0) * 1.0 ;\n if(pos.w + 1.0 > 10000.0){\n   return vec4<f32>(color);\n }\n var V = normalize(pos.xyz - globalUniform.cameraWorldMatrix[3].xyz);\n var N = normal.xyz ;\n\n directionShadowMapping(pos.xyz,globalUniform.shadowBias);\n pointShadowMapCompare(pos.xyz,globalUniform.shadowBias);\n\n var lighting = vec3<f32>(0.0);\n let lightCount = 32 ;\n for(var i:i32 = 0 ; i < lightCount ; i = i + 1 )\n {\n     let light = lightBuffer[i];\n     switch (light.lightType) {\n         case PointLightType: {\n             lighting += pointLighting(color.rgb,pos.xyz,N,V,light);\n         }\n         case DirectLightType: {\n             lighting += directLighting(color.rgb,pos.xyz,N,V,light,globalUniform.shadowBias);\n         }\n         case SpotLightType: {\n             lighting += spotLight(color.rgb,pos.xyz,N,V,light);\n         }\n         default: {\n         }\n     }\n }\n\n // lighting = vec3<f32>(1.0) / (vec3<f32>(1.0) + lighting.rgb) * lighting.rgb;\n\n var skyLight: vec3<f32> = globalUniform.skyExposure * (textureSampleLevel(prefilterMap, prefilterMapSampler, N.xyz, 8.0 ).rgb);\n // skyLight = LinearToGammaSpace(skyLight);\n // skyLight = (color.rgb / 3.1415926 ) * skyLight;\n // skyLight = vec3<f32>(1.0) / (vec3<f32>(1.0) + skyLight.rgb) * skyLight.rgb;\n\n lighting = lighting.rgb ;//+ skyLight.rgb ;\n\n return vec4<f32>(lighting.rgb,color.w)+emissive;\n}\n\n// fn vertexToCoord(vertexPosition:vec3<f32>) -> vec4<f32>{\n//   var worldPos = vec4<f32>(vertexPosition.xyz, 1.0);\n//   var fragPosition = globalUniform.viewMat * worldPos ;\n//   // var position = globalUniform.projMat * fragPosition ;\n//   return fragPosition;\n// }\n\n@compute @workgroup_size( 8 , 8 , 1 )\nfn CsMain( @builtin(workgroup_id) workgroup_id : vec3<u32> , @builtin(global_invocation_id) globalInvocation_id : vec3<u32>)\n{\n   var fragCoord = vec2<u32>( globalInvocation_id.x, globalInvocation_id.y);\n   var color = coordFun(fragCoord);\n   \n   // color = vec4(pow(color.rgb,vec3<f32>(1.0/2.4)),1.0);\n   textureStore(outputBuffer, vec2<i32>(fragCoord),color);\n}\n\n'),this.computeShader.setStorageTexture("outputBuffer",this.lightingTexture),this.computeShader.setStorageBuffer("lightBuffer",e.storageGPUBuffer),this.computeShader.setStorageBuffer("models",toe.modelMatrixBindGroup.matrixBufferDst),this.computeShader.setSamplerTexture("positionMap",this.worldPosMap),this.computeShader.setSamplerTexture("normalMap",this.worldNormalMap),this.computeShader.setSamplerTexture("colorMap",this.colorMap),this.computeShader.setSamplerTexture("shadowMap",this.shadowMap),this.computeShader.setSamplerTexture("pointShadowMap",this.pointShadowMap),this.computeShader.setSamplerTexture("prefilterMap",nce.res.defaultSky)}setInputs(e){this.worldPosMap=e[0],this.worldNormalMap=e[1],this.colorMap=e[2],this.shadowMap=e[3],this.pointShadowMap=e[4]}computer(e,t){this.computeShader||(this.create(e),e=toe.getCameraGroup(e.camera),this.computeShader.setUniformBuffer("globalUniform",e.uniformGPUBuffer));e=roe.beginCommandEncoder();var n=nce.setting.gi;this.computeShader.workerSizeX=n.probeSourceTextureSize/8,this.computeShader.workerSizeY=n.probeSourceTextureSize/8,this.computeShader.workerSizeZ=1,roe.computeCommand(e,[this.computeShader])}}let Koe=new Cre("GIRenderStartEvent"),Zoe=new Cre("GIRenderCompleteEvent");class Joe{constructor(){bre(this,"count"),bre(this,"complete")}}class Qoe extends Aoe{constructor(e){super(),bre(this,"cubeCamera"),bre(this,"volume"),bre(this,"probeCountPerFrame",1),bre(this,"nextProbeIndex",-1),bre(this,"tempProbeList",[]),bre(this,"isRenderCloudGI"),bre(this,"probeRenderResult"),bre(this,"renderStatus","none"),bre(this,"positionMap"),bre(this,"normalMap"),bre(this,"colorMap"),bre(this,"probeNext",128),bre(this,"sizeW"),bre(this,"sizeH"),bre(this,"lightingPass"),bre(this,"bouncePass"),bre(this,"irradianceComputePass"),bre(this,"irradianceDepthMap"),bre(this,"irradianceColorMap"),this.passType=zse.GI;var t=(this.volume=e).setting;this.cubeCamera=new Woe(.01,5e3),this.sizeW=t.probeSourceTextureSize,this.sizeH=t.probeSourceTextureSize,this.probeNext=t.probeSourceTextureSize/t.probeSize,this.initIrradianceMap(e),this.probeRenderResult=new Joe,t=new Yoe(this.sizeW,this.sizeH);this.positionMap=t.attachments[0],this.normalMap=t.attachments[1],this.colorMap=t.attachments[2],this.setRenderStates(t)}setInputTexture(e){this.lightingPass=new qoe,this.bouncePass=new Xoe(this.volume),this.irradianceComputePass=new $oe(this.volume),this.lightingPass.setInputs([this.positionMap,this.normalMap,this.colorMap,e[0],e[1]]),this.bouncePass.setInputs([this.normalMap,this.colorMap,this.lightingPass.lightingTexture,this.irradianceColorMap]),this.irradianceComputePass.setTextures([this.positionMap,this.normalMap,this.bouncePass.blendTexture],this.irradianceColorMap,this.irradianceDepthMap)}setIrradianceData(e,t,n,r){n!=this.irradianceColorMap.width||r!=this.irradianceColorMap.height?console.error("irradiance image size not match !"):(this.writeToTexture(this.irradianceColorMap,e,n,r),this.writeToTexture(this.irradianceDepthMap,t,n,r))}updateProbe(e,t,n){var r=Kse.instance.getLights(e.scene),i=this.volume.setting.probeSize,a=(t.drawCallFrame+=1,this.cubeCamera.x=t.x,this.cubeCamera.y=t.y,this.cubeCamera.z=t.z,this.volume.setting.debugCamera?(this.cubeCamera.x=e.camera.transform.x,this.cubeCamera.y=e.camera.transform.y,this.cubeCamera.z=e.camera.transform.z,this.cubeCamera.rotationX=e.camera.transform.rotationX,this.cubeCamera.rotationY=e.camera.transform.rotationY,this.cubeCamera.rotationZ=e.camera.transform.rotationZ):(this.cubeCamera.rotationX=t.rotationX,this.cubeCamera.rotationY=t.rotationY,this.cubeCamera.rotationZ=t.rotationZ),this.cubeCamera),s=Math.floor(t.index/this.probeNext)*(6*i);t=Math.floor(t.index%this.probeNext)*i;n.setViewport(0+s,t,i,i,0,1),this.renderSceneOnce(e,a.right_camera,n,r),n.setViewport(i+s,t,i,i,0,1),this.renderSceneOnce(e,a.left_camera,n,r),n.setViewport(2*i+s,t,i,i,0,1),this.renderSceneOnce(e,a.up_camera,n,r),n.setViewport(3*i+s,t,i,i,0,1),this.renderSceneOnce(e,a.down_camera,n,r),n.setViewport(4*i+s,t,i,i,0,1),this.renderSceneOnce(e,a.front_camera,n,r),n.setViewport(5*i+s,t,i,i,0,1),this.renderSceneOnce(e,a.back_camera,n,r)}renderSceneOnce(e,t,n,r){this.volume.uploadBuffer();var i=Kse.instance.getRenderNodes(e.scene);roe.bindCamera(n,t);let a=Math.max(0,nce.setting.render.drawOpMin),s=Math.min(nce.setting.render.drawOpMax,i.opaqueList.length);for(let u=a;u<s;++u){var o=i.opaqueList[u];o.enable&&o.transform.enable&&o.renderPass2(e,this.passType,this.rendererPassState,null,n)}Kse.instance.sky&&Kse.instance.sky.renderPass2(e,this.passType,this.rendererPassState,null,n),a=Math.max(0,nce.setting.render.drawTrMin),s=Math.min(nce.setting.render.drawTrMax,i.transparentList.length);for(let u=a;u<s;++u){var l=i.transparentList[u];l.enable&&l.transform.enable&&l.renderPass2(e,this.passType,this.rendererPassState,null,n)}}render(e,t){var n;nce.setting.gi.enable&&(e.camera,e.scene,this.volume.updateOrientation(),this.volume.isVolumeFrameChange=!1,this.volume.uploadBuffer(),(n=Kse.instance.sky)&&n.nodeUpdate(e,this.passType,this.rendererPassState,null),this.rendProbe(e),n=0<this.probeRenderResult.count,(Kse.instance.state.giLightingChange||n||nce.setting.gi.realTimeGI)&&(Kse.instance.state.giLightingChange=!1,this.lightingPass.computer(e,this.rendererPassState),this.bouncePass.computer(e,this.rendererPassState),this.irradianceComputePass.computer(e,this.rendererPassState)),this.probeRenderResult.complete)&&this.dispatchEvent(Zoe)}startRenderGI(e=0){-1==this.nextProbeIndex&&0==e&&this.dispatchEvent(Koe),this.nextProbeIndex=e,this.renderStatus="rendering"}startRenderCloudGI(){this.dispatchEvent(Koe),this.nextProbeIndex=0,this.renderStatus="rendering",this.isRenderCloudGI=!0}rendProbe(e){let t=!1;if(t=nce.setting.gi.autoRenderProbe?(-1==this.nextProbeIndex&&this.startRenderGI(),!0):"rendering"==this.renderStatus,this.probeRenderResult.count=0,this.probeRenderResult.complete=!1,t){var n=Kse.instance.getProbes(e.scene);this.renderContext.clean(),this.renderContext.beginRenderPass(),this.tempProbeList.length=0;let t=Math.min(this.probeCountPerFrame,n.length);for(this.probeRenderResult.count=t;0<t;){var r=n[this.nextProbeIndex];this.updateProbe(e,r,this.renderContext.encoder),t--,this.nextProbeIndex++,r.drawCallFrame<3&&this.tempProbeList.push(r)}0<this.tempProbeList.length&&this.volume.updateProbes(this.tempProbeList);var i=this.nextProbeIndex>=n.length;this.nextProbeIndex>=n.length&&this.isRenderCloudGI&&this.updateProbe(e,n[0],this.renderContext.encoder),this.renderContext.endRenderPass(),i&&(this.nextProbeIndex=-1,this.renderStatus="complete",this.probeRenderResult.complete=!0)}}initIrradianceMap(e){e=e.setting;var t=GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.STORAGE_BINDING|GPUTextureUsage.COPY_SRC|GPUTextureUsage.COPY_DST;this.irradianceDepthMap=new boe(e.octRTMaxSize,e.octRTMaxSize,die,!1,t),this.irradianceDepthMap.name="irradianceDepthMap",this.irradianceColorMap=new boe(e.octRTMaxSize,e.octRTMaxSize,die,!1,t),this.irradianceColorMap.name="irradianceColorMap"}writeToTexture(e,t,n,r){console.log(e.name);var i=Dre.device.createBuffer({size:t.byteLength,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.COPY_SRC});(t=(Dre.device.queue.writeBuffer(i,0,t),roe.beginCommandEncoder())).copyBufferToTexture({buffer:i,bytesPerRow:16*n},{texture:e.getGPUTexture()},{width:n,height:r,depthOrArrayLayers:1}),roe.endCommandEncoder(t)}}class ele extends joe{constructor(e){super(e)}start(){super.start();var e=Loe.getGBufferFrame("ColorPassGBuffer"),t=[],n=new Poe;nce.setting.render.zPrePass&&(e.zPreTexture=this.depthPassRenderer.rendererPassState.depthTexture),n.setRenderStates(e),nce.setting.gi.enable&&(e=toe.getLightEntries(this.view.scene),this.ddgiProbeRenderer=new Qoe(e.irradianceVolume),this.ddgiProbeRenderer.setInputTexture([this.shadowMapPassRenderer.depth2DArrayTexture,this.pointLightShadowRenderer.cubeArrayTexture]),n.setIrradiance(this.ddgiProbeRenderer.irradianceColorMap,this.ddgiProbeRenderer.irradianceDepthMap),this.rendererMap.addRenderer(this.ddgiProbeRenderer),t.push(this.ddgiProbeRenderer.positionMap,this.ddgiProbeRenderer.normalMap,this.ddgiProbeRenderer.colorMap,this.ddgiProbeRenderer.lightingPass.lightingTexture,this.ddgiProbeRenderer.irradianceColorMap,this.ddgiProbeRenderer.irradianceDepthMap)),this.postRenderer&&this.postRenderer.setDebugTexture(t),this.rendererMap.addRenderer(n),nce.setting.render.debug&&this.debug()}debug(){}}class tle{constructor(){bre(this,"_factor"),bre(this,"_doubleFactor"),this._factor=1,this._doubleFactor=2}get accelerateInterpolator(){return this._factor}set accelerateInterpolator(e){this._factor=e,this._doubleFactor=2*this._factor}getInterpolation(e){return 1==this._factor?e*e:Math.pow(e,this._doubleFactor)}}class nle{constructor(){bre(this,"_factor",1)}get decelerateInterpolator(){return this._factor}set decelerateInterpolator(e){this._factor=e}getInterpolation(e){return 1==this._factor?1-(1-e)*(1-e):1-Math.pow(1-e,2*this._factor)}}class rle{constructor(){bre(this,"_factor",1)}getInterpolation(e){return Math.cos((e+1)*Math.PI)/2+.5}}class ile{getInterpolation(e){return e}}class ale{getInterpolation(e){return 4.9*e+4.9*e}}class sle{constructor(){}static bounce(e){return e*e*9.8}getInterpolation(e){return(e*=1.1226)<.3535?sle.bounce(e):e<.7408?sle.bounce(e-.54719)+.7:e<.9644?sle.bounce(e-.8526)+.9:sle.bounce(e-1.0435)+.95}getBounceInterpolation(e){return e<.5?sle.bounce(e):sle.bounce(e-1)}geJumpUp(e,t){return t<.5?e*(t/=.5)-sle.bounce(t):t<.8?.3*(e*(t=(t-.5)/(.8-.5))-sle.bounce(t)):t<1?.15*(e*(t=(t-.8)/(1-.8))-sle.bounce(t)):e*t-sle.bounce(t)}}class ole{constructor(){bre(this,"_tension"),this._tension=2}get anticipateInterpolator(){return this._tension}set anticipateInterpolator(e){this._tension=e}getInterpolation(e){return e*e*((this._tension+1)*e-this._tension)}}class lle{constructor(){bre(this,"_tension"),this._tension=1.5}anticipateOvershootInterpolator(e){this._tension=1.5*e}anticipateOvershootInterpolator2(e,t){this._tension=e*t}getInterpolation(e){return e<.5?.5*lle.a(2*e,this._tension):.5*(lle.o(2*e-2,this._tension)+2)}static a(e,t){return e*e*((t+1)*e-t)}static o(e,t){return e*e*((t+1)*e+t)}}class ule{constructor(e){bre(this,"_cycles"),this._cycles=e}getInterpolation(e){return Math.sin(2*this._cycles*Math.PI*e)}}class cle{constructor(){bre(this,"_tension"),this._tension=2}getInterpolation(e){return--e*e*((this._tension+1)*e+this._tension)+1}}var dle=(e=>(e[e.AccelerateInterpolator=0]="AccelerateInterpolator",e[e.DecelerateInterpolator=1]="DecelerateInterpolator",e[e.AccelerateDecelerateInterpolator=2]="AccelerateDecelerateInterpolator",e[e.LinearInterpolator=3]="LinearInterpolator",e[e.BounceInterpolator=4]="BounceInterpolator",e[e.AnticipateInterpolator=5]="AnticipateInterpolator",e[e.AnticipateOvershootInterpolator=6]="AnticipateOvershootInterpolator",e[e.CycleInterpolator=7]="CycleInterpolator",e[e.OvershootInterpolator=8]="OvershootInterpolator",e[e.JumperInterpolator=9]="JumperInterpolator",e))(dle||{});const hle=class{constructor(){bre(this,"complete",!1),bre(this,"onComplete"),bre(this,"onProgress"),bre(this,"target"),bre(this,"property"),bre(this,"targetProperty"),bre(this,"durtion"),bre(this,"interpolatorEnum"),bre(this,"delayTime",0),bre(this,"_interpolator"),bre(this,"_ct",0),bre(this,"_p",0)}static to(e,t,n,r=0){var i=new hle;return i.target=e,i.property=t,i.durtion=n,i.interpolatorEnum=r,i.start(),i.delayTime=t.delayTime||0,t.onComplete&&(i.onComplete=t.onComplete),t.onProgress&&(i.onProgress=t.onProgress),this.interpolators.push(i),i}static tick(e){var t;for(t of hle.interpolators)t.complete?hle.remove(t,!0):t.tick(e)}static remove(e,t){var n=hle.interpolators,r=n.indexOf(e);-1!=r&&n.splice(r,1),t&&e.dispose()}static removeList(e,t){e.forEach((e=>{this.remove(e,t)}))}start(){for(var e in window.AccelerateInterpolator=tle,window.DecelerateInterpolator=nle,window.AccelerateDecelerateInterpolator=rle,window.LinearInterpolator=ile,window.BounceInterpolator=sle,window.AnticipateInterpolator=ole,window.AnticipateOvershootInterpolator=lle,window.CycleInterpolator=ule,window.OvershootInterpolator=cle,window.JumperInterpolator=ale,this._interpolator=new window[dle[this.interpolatorEnum]],this.targetProperty={},this.property)this.targetProperty[e]=this.target[e]}tick(e){if(this.delayTime<=0){this._p=Math.min(this._ct/this.durtion,1);var t,n,r,i=this._interpolator.getInterpolation(this._p),a=this.property,s=this.target,o=this.targetProperty;for(r in a)n=a[r],t=o[r],s[r]=t+(n-t)*i;null!=this.onProgress&&this.onProgress(this._p),this._ct>=this.durtion&&(this.complete=!0,null!=this.onComplete)&&this.onComplete(this.target),this._ct+=e}else this.delayTime-=e}dispose(){this.onComplete=null,this.onProgress=null,this.target=null,this.property=null,this.targetProperty=null,this.interpolatorEnum=null,this._interpolator=null,hle.remove(this)}};let ple=hle;bre(ple,"interpolators",[]);class fle{static hasString(e,t){for(var n=0;n<e.length;++n)if(e[n]==t)return n;return-1}static getEllipsis(e,t=4){let n=e;return n.length>t?n.slice(0,t)+"...":n}static getURLName(e){let t=(e=e.split("/"))[e.length-1];return t.split(".")[0]}static getFileFormat(e){var t=e.lastIndexOf("."),n=e.length;return-1!==e.indexOf("?",++t)&&(n=e.indexOf("?",t)),e.substr(t,n-t).toLowerCase()}static readLineProperty(e,t){e.trim().split(" ").forEach(((e,n)=>{var r,i;1<(e=e.split("=")).length&&(r=e[0],i=e[1],Object.prototype.hasOwnProperty.call(t,r))&&(-1==i.indexOf('"')?t[r]=parseFloat(e[1]):t[r]=i.replace('"',"").replace('"',""))}))}static getPath(e){var t=e.lastIndexOf("/");return e.substring(0,++t)}static normalizePath(e){return e.replaceAll("//","/").replaceAll("\\","/")}static getStringList(e,t=";"){return e.split(t)}static formatTime(e){e=e/1e3/60;var t=Math.floor(e);e=Math.floor(e-t);return[t.toString(),e.toString()]}static trim(e){return e.replace(/^\s+/g,"").replace(/\s+$/g,"")}static isEmpty(e){return!e||"u"<typeof e||null==e||"string"==typeof e&&""===this.trim(e)||"null"===e}static strCut(e,t){if(2*e.length<=t)return e;for(var n=0,r="",i=0;i<e.length;i++)if(r+=e.charAt(i),128<e.charCodeAt(i)){if(t<=(n+=2))return r.substring(0,r.length-1)+"..."}else if(t<=(n+=1))return r.substring(0,r.length-2)+"...";return r}static toQueryPair(e,t,n=!1){return e+"="+(n?encodeURIComponent(t):t)}static stringFormat(e,...t){if(0===arguments.length)throw new Error("please give arg at least one !");if(2===arguments.length&&"object"==typeof arguments[1])for(var n in arguments[1]){var r=new RegExp("({"+n+"})","g");e=e.replace(r,arguments[1][n])}else for(let a=0;a<t.length;a++){if(null==t[a])return e;var i=new RegExp("({["+a+"]})","g");e=e.replace(i,t[a])}return e}static parseJson2String(e,t){let n=null,r="",i=0;return(t=t||{}).newlineAfterColonIfBeforeBraceOrBracket=!0===t.newlineAfterColonIfBeforeBraceOrBracket,t.spaceAfterColon=!1!==t.spaceAfterColon,"string"==typeof e&&(e=JSON.parse(e)),n=/([\{\}])/g,e=(e=JSON.stringify(e)).replace(n,"\r\n$1\r\n"),n=/([\[\]])/g,e=e.replace(n,"\r\n$1\r\n"),n=/(\,)/g,e=e.replace(n,"$1\r\n"),n=/(\r\n\r\n)/g,e=e.replace(n,"\r\n"),n=/\r\n\,/g,e=e.replace(n,","),t.newlineAfterColonIfBeforeBraceOrBracket||(n=/\:\r\n\{/g,e=e.replace(n,":{"),n=/\:\r\n\[/g,e=e.replace(n,":[")),t.spaceAfterColon&&(n=/\:/g,e=e.replace(n,":")),e.split("\r\n").forEach((function(e,t){let n=0,a=0,s="";for(e.match(/\{$/)||e.match(/\[$/)?a=1:e.match(/\}/)||e.match(/\]/)?0!==i&&--i:a=0,n=0;n<i;n++)s+="    ";r+=s+e+"\r\n",i+=a})),r}static compareVersion(e,t){e=e.split("."),t=t.split(".");for(var n=Math.max(e.length,t.length);e.length<n;)e.push("0");for(;t.length<n;)t.push("0");for(let a=0;a<n;a++){var r=parseInt(e[a]),i=parseInt(t[a]);if(i<r)return 1;if(r<i)return-1}return 0}static buildRandomCode(){let e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",t="";for(let r=0;r<26;r++){var n=Math.floor(62*Math.random());t+=e.charAt(n)}return(new Date).getTime()+"-"+t}static UUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}static stringToHash(e){let t=0;if(0!=e.length)for(let n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t&=t}return t}static parseUrl(e,t){return t.match(/^(blob|http|https):/)?t:e+t}}bre(fle,"_filterChar",[" ","  ",";","\n","\r","\t","\n","\r","\t"]);class mle extends kae{constructor(e=!0){super(),bre(this,"_source"),bre(this,"imageData"),this.useMipmap=e}get source(){return this._source}set source(e){this._source=e,this._source instanceof HTMLImageElement?this._source.decode().then((async()=>{var e;this._source instanceof HTMLImageElement&&(e=await createImageBitmap(this._source,{imageOrientation:this.flipY?"flipY":"from-image"}),this.generate(e))})):(this._source instanceof HTMLCanvasElement||this._source instanceof ImageBitmap)&&this.generate(this._source)}async load(e,t){var n,r;return-1!=e.indexOf(";base64")?(n=document.createElement("img"),r=e.indexOf("data:image"),r=e.substring(r,e.length),n.src=r,await n.decode(),n.width=Math.max(n.width,32),n.height=Math.max(n.height,32),r=await createImageBitmap(n,{resizeWidth:n.width,resizeHeight:n.height,imageOrientation:this.flipY?"flipY":"from-image"}),this.format=oie,this.generate(r)):(n=await fetch(e,{headers:Object.assign({Accept:"image/avif,image/webp,*/*"},null==t?void 0:t.headers)}),r=await gle.read(e,n,t),n=new Blob([r],{type:"image/jpeg"}),r=null,await this.loadFromBlob(n)),this.name=fle.getURLName(e),!0}async loadFromBlob(e){this.imageData=e;let t=await createImageBitmap(e,{imageOrientation:this.flipY?"flipY":"from-image"});var n;return(t.width<32||t.height<32)&&(e=Math.max(t.width,32),n=Math.max(t.height,32),t=await createImageBitmap(t,{resizeWidth:e,resizeHeight:n,imageOrientation:this.flipY?"flipY":"from-image"})),this.format=oie,this.generate(t),!0}}class gle{constructor(){bre(this,"baseUrl",""),bre(this,"initUrl"),bre(this,"_progress",0)}async loadBinData(e,t){return this.baseUrl=fle.getPath(e),this.initUrl=e,new Promise((async(n,r)=>{fetch(e,{headers:null==t?void 0:t.headers}).then((async r=>{if(!r.ok)throw Error("request rejected with status "+r.status);r=(await gle.read(e,r,t)).buffer,n(r)})).catch((e=>{t.onError&&t.onError(e),r(e)}))}))}async loadAsyncBitmapTexture(e,t){this.baseUrl=fle.getPath(e),this.initUrl=e;var n=new mle;return n.url=e,n.name=fle.getURLName(e),await n.load(e,t),nce.res.addTexture(e,n),n}async loadJson(e,t){return this.baseUrl=fle.getPath(e),this.initUrl=e,new Promise((async(n,r)=>{fetch(e,{headers:null==t?void 0:t.headers}).then((async r=>{if(!r.ok)throw Error("request rejected with status"+r.status);r=await gle.read(e,r,t),r=new TextDecoder("utf-8").decode(r),n(JSON.parse(r))})).catch((e=>{t.onError&&t.onError(e),r(e)}))}))}async loadTxt(e,t){return this.baseUrl=fle.getPath(e),new Promise((async(n,r)=>{fetch(e).then((async r=>{if(!r.ok)throw Error("request rejected with status"+r.status);r=await gle.read(e,r,t),r=new TextDecoder("utf-8").decode(r),n({data:r})})).catch((e=>{t.onError&&t.onError(e),r(e)}))}))}static async read(e,t,n){var r,i=t.body.getReader(),a=+t.headers.get("Content-Length");let s=0,o=[],l=[];for(;;){var{done:u,value:c}=await i.read();if(u){0<a&&n&&n.onComplete&&n.onComplete.call(this,e);break}o.push(c),s+=c.length,0<a?n&&n.onProgress&&n.onProgress.call(this,s,a,e):l.push(c.length)}if(0<l.length)for(let p=0;p<o.length;p++)console.log(l[p]),n&&n.onProgress&&n.onProgress.call(this,l[p],s,e),l[p]==s&&n&&n.onComplete&&n.onComplete.call(this,e);let d=new Uint8Array(s),h=0;for(r of o)d.set(r,h),h+=r.length;return d}}class vle extends gle{async load(e,t,n,r){switch(t.format){case"bin":return new Promise((async(i,a)=>{this.loadBinData(e,n).then((async n=>{var a=new t;if(a.userData=r,a.baseUrl=this.baseUrl,a.initUrl=e,await a.parseBuffer(n),!a.verification())throw new Error("parser error");i(a)})).catch((e=>{a(e)}))}));case"json":return new Promise(((i,a)=>{this.loadJson(e,n).then((async a=>{var s=new t;s.userData=r,s.baseUrl=this.baseUrl,s.initUrl=e,s.loaderFunctions=n,await s.parseJson(a),i(s)})).catch((e=>{a(e)}))}));case"text":return new Promise(((i,a)=>{this.loadTxt(e,n).then((async s=>{var o=new t;o.userData=r,o.baseUrl=this.baseUrl,o.initUrl=e,o.loaderFunctions=n,s.data?(await o.parseString(s.data),i(o)):a("text load is empty!")})).catch((e=>{a(e)}))}))}}}class yle{constructor(){bre(this,"baseUrl"),bre(this,"initUrl"),bre(this,"loaderFunctions"),bre(this,"userData"),bre(this,"data")}parseString(e){}parseJson(e){}parseBuffer(e){}parseTexture(e){throw this.parserError("Method not implemented.",-1)}parse(e){}verification(e){throw this.parserError("Method not implemented.",-1)}parserError(e,t){console.error(`error id:${t} `+e)}}bre(yle,"format","bin");class _le{constructor(){bre(this,"asset"),bre(this,"accessors"),bre(this,"buffers"),bre(this,"bufferViews"),bre(this,"materials"),bre(this,"meshes"),bre(this,"nodes"),bre(this,"scene",0),bre(this,"scenes"),bre(this,"textures"),bre(this,"cameras"),bre(this,"skins"),bre(this,"resources"),bre(this,"images"),bre(this,"samplers"),bre(this,"animations"),bre(this,"extensions")}}const ble={};{const e=ble;e[5120]=Int8Array,e[5121]=Uint8Array,e[5122]=Int16Array,e[5123]=Uint16Array,e[5124]=Int32Array,e[5125]=Uint32Array,e[5126]=Float32Array,e[32819]=Uint16Array,e[32820]=Uint16Array,e[33635]=Uint16Array,e[5131]=Uint16Array,e[33640]=Uint32Array,e[35899]=Uint32Array,e[35902]=Uint32Array,e[36269]=Uint32Array,e[34042]=Uint32Array}function xle(e){if(e=ble[e])return e;throw new Error("unkonw gl type")}class wle{static async apply(e,t){if(t.extensions){const n=t.extensions.KHR_draco_mesh_compression;if(n){let r=this._workers.get(e.gltf),i=(r||(r=new Worker(await this.initDecoder()),this._workers.set(e.gltf,r)),r.postMessage({type:"init",decoderConfig:{}}),e.parseBufferView(n.bufferView));return i.result||(t=await new Promise(((e,t)=>{r.onmessage=n=>{"decode"==(n=n.data).type?e(n.result):"error"==n.type&&t(n.error)},r.postMessage({type:"decoder",buffer:i,attributes:n.attributes},[i])})),i.result=t),i.result}}}static unload(e){var t=this._workers.get(e);t&&(t.terminate(),this._workers.delete(e))}static async initDecoder(){var e;return this._workerCode||(e=await(new vle).loadTxt("https://cdn.orillusion.com/draco_decoder_gltf.js"),e=new Blob([e.data,"",`(${Sle})()`],{type:"application/javascript"}),this._workerCode=URL.createObjectURL(e)),this._workerCode}}function Sle(){let e,t;onmessage=n=>{var r=n.data;switch(r.type){case"init":e=r.decoderConfig,t=new Promise(((t,n)=>{e.onModuleLoaded=e=>{t({draco:e})},DracoDecoderModule(e)}));break;case"decoder":const n=r.buffer,i=r.attributes;t.then((e=>{var t=e.draco,r=new t.Decoder;let a,s;(e=new t.DecoderBuffer).Init(new Int8Array(n),n.byteLength);try{var o=r.GetEncodedGeometryType(e),l=(o==t.TRIANGULAR_MESH?(s=new t.Mesh,a=r.DecodeBufferToMesh(e,s)):self.postMessage(new Error("INVALID_GEOMETRY_TYPE:"+o)),a.ok()||self.postMessage(new Error("DracoDecode:"+a.error_msg())),{});for(const e in i){var u=r.GetAttributeByUniqueId(s,i[e]),c=u.num_components(),d=s.num_points()*c,h=d*Float32Array.BYTES_PER_ELEMENT,p=t.DT_FLOAT32,f=t._malloc(h),m=(r.GetAttributeDataArrayForAllPoints(s,u,p,h,f),new Float32Array(t.HEAPF32.buffer,f,d).slice());t._free(f),l[e]={data:m,numComponents:c,normalize:!1}}var g=3*s.num_faces(),v=4*g,y=t._malloc(v),_=(r.GetTrianglesUInt32Array(s,v,y),new Uint32Array(t.HEAPF32.buffer,y,g).slice());t._free(y),l.indices={data:_,numComponents:1,normalize:!1},self.postMessage({type:"decode",result:l})}catch(b){self.postMessage({type:"error",error:b.message})}finally{t.destroy(s),t.destroy(r),t.destroy(e)}}))}}}bre(wle,"_workerCode"),bre(wle,"_workers",new Map);class Cle{constructor(e){bre(this,"gltf"),this.gltf=e}parse(e){var t,n,r,i,a,s,o,l=this.gltf.cameras[e];return l?(l.isParsed||(l.isParsed=!0,l.dcamera=!1,({name:t,type:n,perspective:s,orthographic:r}=l),"perspective"===n&&s?(({aspectRatio:s,yfov:i,zfar:o,znear:a}=s),l.dcamera=Object.assign({},{name:t,type:n,yfov:i,znear:a,aspectRatio:s,zfar:o})):"orthographic"===n&&r&&(({xmag:i,ymag:a,zfar:s,znear:o}=r),l.dcamera=Object.assign({},{name:t,type:n,xmag:i,ymag:a,zfar:s,znear:o}))),l.dcamera):this.errorMiss("camera",e)}errorMiss(e,t){throw new Error(e+t)}}const Tle=class extends yle{constructor(){super(...arguments),bre(this,"_gltf")}async parseJson(e){this._gltf=new _le,this._gltf={...this._gltf,...e},this._gltf.resources={},await Promise.all([this.load_gltf_bin(),this.load_gltf_textures()]);let t=new Qle,n=await t.parse(this.initUrl,this._gltf,this._gltf.scene);return t.destory(),t=null,n?(this.data=n.rootNode,n.rootNode):this._gltf=null}verification(){if(this.data)return!0;throw new Error("Method not implemented.")}static getMeshNameCounter(){return function(){return"GLTF_NO_NAME_PRIMITIVE_"+Tle._counter++}}static getModelNameCounter(){let e=0;return function(){return"GLTF_NO_NAME_MESH_"+e++}}static getTexCoordDefine(e){return"UV_NUM "+e}static getVertexColorDefine(e){return"HAS_VERTEXCOLOR "+e}static getBaseColorTextureDefine(){return"HAS_BASECOLORMAP"}static getMetalRoughnessDefine(){return"HAS_METALROUGHNESSMAP"}static getNormalMapDefine(){return"HAS_NORMALMAP"}static getEmissiveMapDefine(){return"HAS_EMISSIVEMAP"}static getOcclusionMapDefine(){return"HAS_OCCLUSIONMAP"}static getMorphTargetsDefine(e){return"MORPH_TARGET_NUM "+e}static getMorphtargetPositionDefine(){return"HAS_MORPH_POSITION"}static getMorphtargetNormalDefine(){return"HAS_MORPH_NORMAL"}static getMorphtargetTangentDefine(){return"HAS_MORPH_TANGENT"}static getJointsNumDefine(e){return"JOINTS_NUM "+e}static getJointVec8Define(){return"JOINT_VEC8"}static getHasNormalDefine(){return"HAS_NORMAL"}static getHasTangentDefine(){return"HAS_TANGENT"}static getHasNormalMapDefine(){return"HAS_NORMAL_MAP"}static getAlphaMaskDefine(){return"ALPHA_MASK"}static getAlphaBlendDefine(){return"ALPHA_BLEND"}async load_gltf_bin(){if(this._gltf.buffers&&0<this._gltf.buffers.length){var e=[];for(let n=0;n<this._gltf.buffers.length;n++){const r=this._gltf.buffers[n];if("data:"!==r.uri.substring(0,5)){let n=fle.parseUrl(this.baseUrl,r.uri);null!=(t=this.loaderFunctions)&&t.onUrl&&(n=await this.loaderFunctions.onUrl(n));var t=(new vle).loadBinData(n,this.loaderFunctions).then((e=>{this._gltf.resources[r.uri]=e}));e.push(t)}}await Promise.all(e)}}async load_gltf_textures(){if(this._gltf,this._gltf.images){var e=[];for(let n=0;n<this._gltf.images.length;n++){const r=this._gltf.images[n];if(r.uri){let n=fle.parseUrl(this.baseUrl,r.uri);null!=(t=this.loaderFunctions)&&t.onUrl&&(n=await this.loaderFunctions.onUrl(n));var t=(new vle).loadAsyncBitmapTexture(n,this.loaderFunctions).then((e=>{e.name=fle.getURLName(r.uri),this._gltf.resources[e.name]=e}));e.push(t)}}await Promise.all(e)}}};let Mle=Tle;bre(Mle,"format","json"),bre(Mle,"_counter",0),bre(Mle,"defaultMaterial",{name:"GLTF_DEFAULT_MATERIAL",alphaCutoff:.33,alphaMode:"MASK",pbrMetallicRoughness:{name:"GLTF_DEFAULT_MATERIAL",defines:[],doubleSided:!1,baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1,emissiveFactor:[0,0,0]}});class Ele{constructor(e){bre(this,"gltf"),bre(this,"subParser"),this.gltf=e.gltf,this.subParser=e}async parse(e){var t=this.gltf.meshes[e];if(!t)return this.errorMiss("mesh",e);if(!t.isParsed){var n=t.primitives,r=t.extras,i=[];for(let e=0;e<n.length;e++){var a,s=n[e],{attributes:o,indices:l,material:u,mode:c,targets:d,extensions:h}=s;let f=t.name;for(a in o)f+=a;f=f+"indices:"+l+"material:"+u;const m={attribArrays:{indices:[]},weights:[],defines:[],material:null,drawMode:null,meshName:null,modelName:null,morphTargetsRelative:!1,targetNames:r?r.targetNames:null};let g,v=!1,y=0,_=!1;h&&h.KHR_draco_mesh_compression&&(g=await wle.apply(this.subParser,s));for(const e in o){var p=g?g[e]:this.parseAccessor(o[e]);if(p){let t;switch(e){case"POSITION":t=Nae.position;break;case"NORMAL":t=Nae.normal,v=!0;break;case"TEXCOORD_0":t=Nae.uv,y++;break;case"JOINTS_0":t=Nae.joints0;break;case"JOINTS_1":t=Nae.joints1,_=!0;break;case"WEIGHTS_0":t=Nae.weights0;break;case"WEIGHTS_1":t=Nae.weights1;break;default:t=e}m.attribArrays[t]=p}}if(v&&m.defines.push(Mle.getHasNormalDefine()),y&&m.defines.push(Mle.getTexCoordDefine(y)),_&&m.defines.push(Mle.getJointVec8Define()),void 0!==l&&(h=g?g.indices:this.parseAccessor(l))&&(m.attribArrays.indices=h),(s=await this.parseMaterial(u))&&(m.material=s,m.defines=m.defines.concat(s.defines)),m.drawMode=void 0===c?4:c,m.meshName=()=>f,m.modelName=t.name||Mle.getModelNameCounter(),d){m.defines.push(Mle.getMorphTargetsDefine(d.length));let e=!(m.morphTargetsRelative=!0),n=!1,r=!1;for(let t=0;t<d.length;t++){const i=d[t];Object.keys(i).forEach((a=>{var s=this.parseAccessor(i[a]);if(s){let i;switch(a){case"POSITION":i=Fse.MORPH_POSITION_PREFIX+t,e=!0;break;case"NORMAL":i=Fse.MORPH_NORMAL_PREFIX+t,n=!0;break;case"TANGENT":i=Fse.MORPH_TANGENT_PREFIX+t,r=!0;break;default:i=!1}i?m.attribArrays[i]=s:console.error("glTF has unsupported morph target attribute "+a)}}))}e&&m.defines.push(Mle.getMorphtargetPositionDefine()),n&&m.defines.push(Mle.getMorphtargetNormalDefine()),r&&m.defines.push(Mle.getMorphtargetTangentDefine()),m.weights=t.weights||new Array(d.length).fill(0)}i.push(m)}t.dprimitives=i,t.isParsed=!0}return t.dprimitives}parseAccessor(e){return this.subParser.parseAccessor(e)}parseMaterial(e){return this.subParser.parseMaterial(e)}errorMiss(e,t){throw new Error(e+t)}}class Ale{constructor(e){bre(this,"gltf"),bre(this,"subParser"),this.gltf=e.gltf,this.subParser=e}async parse(e){let t;if(!(t=null==e?Mle.defaultMaterial:this.gltf.materials[e]))return this.errorMiss("material",e);if(t.isParsed)return t.dmaterial;let{name:n,pbrMetallicRoughness:r,normalTexture:i,occlusionTexture:a,emissiveTexture:s,emissiveFactor:o,alphaMode:l,alphaCutoff:u,doubleSided:c,extensions:d}=t;var h,p,f,m,g;e={name:n,defines:[],doubleSided:!!c,baseColorFactor:[1,1,1,1],emissiveFactor:null,alphaCutoff:0,enableBlend:!1,baseColorTexture:null,metallicRoughnessTexture:null,normalTexture:null,occlusionTexture:null,emissiveTexture:null,transformUV1:null,transformUV2:null,extensions:null};return r?(({baseColorFactor:p,metallicFactor:f,roughnessFactor:g,baseColorTexture:m,metallicRoughnessTexture:h}=r),Object.assign(e,{baseColorFactor:p||[1,1,1,1],metallicFactor:void 0===f?1:f,roughnessFactor:void 0===g?.15:g}),m&&((p=m.extensions)&&(f=p.KHR_texture_transform)&&(e.transformUV1=new $re(f.offset?f.offset[0]:0,f.offset?f.offset[1]:0,f.scale?f.scale[0]:1,f.scale?f.scale[1]:1)),g=await this.parseTexture(m.index),e.baseColorTexture=g||nce.res.redTexture),h&&(p=await this.parseTexture(h.index),e.metallicRoughnessTexture=p||nce.res.blackTexture)):Object.assign(e,{baseColorFactor:[1,1,1,1],metallicFactor:0,roughnessFactor:.5}),(l=e.baseColorFactor&&e.baseColorFactor[3]<1?"MASK"===l?"MASK":"BLEND":l)&&"OPAQUE"!==l&&("MASK"===l&&(e.defines.push(Mle.getAlphaMaskDefine()),e.alphaCutoff=void 0===u?.5:u),"BLEND"===l)&&(e.defines.push(Mle.getAlphaBlendDefine()),e.enableBlend=!0),i&&(f=await this.parseTexture(i.index),e.normalTexture=f||nce.res.normalTexture),a&&(m=await this.parseTexture(a.index))&&(e.occlusionTexture=m),o&&(e.emissiveFactor=o),s&&(g=await this.parseTexture(s.index),e.emissiveTexture=g||nce.res.blackTexture),d&&(e.extensions=d),t.isParsed=!0,t.dmaterial=e}async parseTexture(e){return this.subParser.parseTexture(e)}errorMiss(e,t){throw new Error(e+t)}}class Ple{constructor(e){bre(this,"gltf"),bre(this,"subParser"),this.gltf=e.gltf,this.subParser=e}parse(e){var t=this.gltf.skins[e];if(!t)return this.errorMiss("skin",e);if(!t.isParsed){var{name:n,joints:r,inverseBindMatrices:i,skeleton:a}=t;if(!r)return this.errorMiss("skin.joints",e);t.isParsed=!0,t.dskin=!1;let u={name:n,skeleton:null,inverseBindMatrices:null,joints:r,defines:[Mle.getJointsNumDefine(r.length)]};if(a)u.skeleton=a;else{var s=-1;for(let e=0;e<this.gltf.nodes.length;e++)if("root"==this.gltf.nodes[e].name){s=e;break}-1==s&&(s=(e=this.gltf.scenes[this.gltf.scene]).nodes[e.nodes.length-1]),u.skeleton=s}if(u.inverseBindMatrices=Fse.IDENTITY_INVERSE_BIND_MATRICES,void 0!==i)if(n=this.parseAccessor(i)){var o=n.data,l=[];for(let e=0;e<o.length;e+=16)l.push(o.slice(e,e+16));u.inverseBindMatrices=l}else u=null;t.dskin=u}return t.dskin}parseAccessor(e){return this.subParser.parseAccessor(e)}errorMiss(e,t){throw new Error(e+t)}}class Rle{constructor(e=""){bre(this,"name",""),bre(this,"index",0),bre(this,"parent",null),bre(this,"children",[]),bre(this,"scale",new Rre),bre(this,"rotation",new Gie),bre(this,"translation",new Rre),this.name=e}}class Lle{constructor(e=[]){bre(this,"joints"),this.joints=e}get numJoint(){return this.joints.length}addJoint(e){e.index=this.joints.push(e)-1}getJointName(e){return this.joints[e].name}getJointParentIndex(e){return(e=this.joints[e]).parent?e.parent.index:-1}getJointByName(e){for(var t of this.joints)if(t.name==e)return t;return null}}class kle{constructor(e,t=!1){bre(this,"index"),bre(this,"worldMatrix"),this.index=e,this.worldMatrix=new Kie(!t)}}class Dle{constructor(e,t=!1){bre(this,"time"),bre(this,"_skeleton"),bre(this,"_jointsPose"),bre(this,"mJointMatrixIndexTable"),this._skeleton=e,this._jointsPose=new Array(e.numJoint),this.mJointMatrixIndexTable=new Array(e.numJoint);for(let r=0;r<e.numJoint;r++){var n=new kle(r,t);this._jointsPose[r]=n,this.mJointMatrixIndexTable[r]=n.worldMatrix.index}}buildSkeletonPose(e){var t=new Rre,n=new Gie,r=new Rre,i=new Array(this._skeleton.numJoint);this.time=0<e[11]?e[11]:e[24];for(let l=0;l<this._skeleton.numJoint;l++){var a=12*l*4,s=(a=new Float32Array(e.buffer,e.byteOffset+a,12),new Kie),o=(a=(t.set(a[0],a[1],a[2]),n.set(a[4],a[5],a[6],a[7]),r.set(a[8],a[9],a[10]),Jie(n.getEulerAngles(),r,t,s),i[l]=s,new kle(l)),this._skeleton.getJointParentIndex(l));o<0?a.worldMatrix.copyFrom(s):Zie(this._jointsPose[o].worldMatrix,s,a.worldMatrix),this._jointsPose[l]=a}}get numJoint(){return this._skeleton.numJoint}get joints(){return this._jointsPose}get jointMatrixIndexTable(){return this.mJointMatrixIndexTable}lerp(e,t,n){for(let a=0;a<this._jointsPose.length;a++){var r=e._jointsPose[a],i=t._jointsPose[a];this._jointsPose[a].worldMatrix.lerp(r.worldMatrix,i.worldMatrix,n)}}copyFrom(e){for(let t=0;t<this._jointsPose.length;t++)this._jointsPose[t].worldMatrix.copyFrom(e._jointsPose[t].worldMatrix)}reset(){for(let e=0;e<this._jointsPose.length;e++)this._jointsPose[e].worldMatrix.identity()}}class Ile extends Cre{constructor(e,t){super(),bre(this,"skeletonAnimation"),this.type=e,this.time=t}}class Ole{constructor(e,t,n,r){if(bre(this,"name",""),bre(this,"_skeleton"),bre(this,"_skeletonPoses"),bre(this,"_animationClipData"),bre(this,"_events"),this.name=e,this._skeleton=t,this._animationClipData=r,0<n&&r){this._skeletonPoses=new Array(n);var i=12*t.numJoint;for(let e=0;e<n;e++){var a=i*e*4,s=(a=new Float32Array(r.buffer,a,i),new Dle(t));s.buildSkeletonPose(a),this._skeletonPoses[e]=s}}}get totalTime(){return this._skeletonPoses[this._skeletonPoses.length-1].time}get frameRate(){return this.totalTime/this._skeletonPoses.length}get skeleton(){return this._skeleton}get numFrame(){return this._skeletonPoses.length-1}get animationClipData(){return this._animationClipData}getSkeletonPose(e){return this._skeletonPoses[e]}getLerpSkeletonPose(e,t,n,r){return e=this.getSkeletonPose(e),t=this.getSkeletonPose(t),r.lerp(e,t,n),r}createSubClip(e,t,n){e=new Ole(e,this._skeleton,0,null),t=Math.max(Math.floor(t/this.frameRate),0),n=Math.min(Math.floor(n/this.frameRate),this._skeletonPoses.length-1);var r=(e._skeletonPoses=this._skeletonPoses.slice(t,n),12*this._skeleton.numJoint*4);return this._animationClipData=new Float32Array(this._animationClipData,t*r,(n-t)*r),e}addEvent(e,t){this._events||(this._events=new Array),this._events.push(new Ile(e,t))}removeEvent(e){this._events&&(this._events=this._events.filter((t=>t.type!=e)))}getEvents(){return this._events}}class Nle{constructor(e){bre(this,"gltf"),bre(this,"subParser"),this.gltf=e.gltf,this.subParser=e}parse(e){var t=new Lle;return this.buildSkeleton(t,void 0,e),t}parseSkeletonAnimation(e,t){for(var n,r=this.subParser.parseAccessor(t.samplers[0].input).data.length,i=12*e.numJoint,a=new Float32Array(i*r),s=0;s<e.numJoint;s++)for(var o=0;o<r;o++)a[0+(f=i*o+12*s)]=1,a[f+1]=1,a[f+2]=1,a[f+3]=1;for(n of t.channels){var l=t.samplers[n.sampler],u=this.subParser.parseAccessor(l.input),c=this.subParser.parseAccessor(l.output),d=(l=n.target.node,n.target.path);if(l=this.gltf.nodes[l]){var h=e.getJointByName(l.name);switch(d){case"scale":for(o=0;o<r;o++){var p=o*c.numComponents;a[0+(f=i*o+12*h.index)]=c.data[p+0],a[f+1]=c.data[p+1],a[f+2]=c.data[p+2],a[f+3]=1}break;case"rotation":for(o=0;o<r;o++)p=o*c.numComponents,a[0+(f=i*o+12*h.index+4)]=c.data[p+0],a[f+1]=c.data[p+1],a[f+2]=c.data[p+2],a[f+3]=c.data[p+3];break;case"translation":for(o=0;o<r;o++){var f;p=o*c.numComponents;a[0+(f=i*o+12*h.index+8)]=c.data[p+0],a[f+1]=c.data[p+1],a[f+2]=c.data[p+2],a[f+3]=u.data[o*u.numComponents]}}}}return new Ole(t.name,e,r,a)}buildSkeleton(e,t,n,r=0){var i=this.gltf.nodes[n],a=(i.name||(i.name="Node_"+n),new Rle(i.name));if(a.parent=t,i.scale&&a.scale.set(i.scale[0],i.scale[1],i.scale[2]),i.rotation&&a.rotation.set(i.rotation[0],i.rotation[1],i.rotation[2],i.rotation[3]),i.translation&&a.translation.set(i.translation[0],i.translation[1],i.translation[2]),e.addJoint(a),i.children)for(var s of i.children)this.buildSkeleton(e,a,s,r+1)}}class Ble{constructor(e){bre(this,"loop",!0),bre(this,"speed",1),bre(this,"t",0),bre(this,"time",0),bre(this,"weight",0),bre(this,"currFrame",0),bre(this,"lastFrame",-1),bre(this,"nextFrame",0),bre(this,"clip"),bre(this,"animation"),bre(this,"_isEnd",!1),bre(this,"_currSkeletonPose"),this.clip=e,this._currSkeletonPose=new Dle(this.clip.skeleton)}reset(){this.time=0,this.weight=0,this._isEnd=!1}get name(){return this.clip.name}get currSkeletonPose(){return this._currSkeletonPose}update(e){if(this.time=(this.time+e*this.speed)%this.clip.totalTime,e=this.time/this.clip.frameRate,this.currFrame=Math.trunc(e),this.t=e-this.currFrame,this.currFrame<0&&(this.currFrame=this.clip.numFrame+this.currFrame),0<=this.time?this.nextFrame=(this.currFrame+1)%this.clip.numFrame:(this.nextFrame=this.currFrame-1,this.nextFrame<0&&(this.nextFrame=this.clip.numFrame+this.nextFrame),this.t=1-this.t),this._isEnd)this.currFrame=this.nextFrame=this.speed<0?0:this.clip.numFrame-1;else if(this.currFrame!=this.lastFrame){if(e=this.speed<0?0:this.clip.numFrame,this.currFrame==e&&(this.loop?(this.currFrame=0,this.nextFrame=1,this.time=this.t=0):(this.currFrame=this.nextFrame=this.speed<0?0:this.clip.numFrame-1,this._isEnd=!0)),e=this.clip.getEvents())for(var t of e){var n=Math.floor(t.time/this.clip.frameRate);n=Math.min(n,this.clip.numFrame);if(Math.max(n,0)==this.currFrame){t.skeletonAnimation=this.animation,this.animation.eventDispatcher.dispatchEvent(t);break}}this.lastFrame=this.currFrame}this.clip.getLerpSkeletonPose(this.currFrame,this.nextFrame,this.t,this._currSkeletonPose)}}class Ule extends iae{constructor(){super(),bre(this,"isPlaying",!0),bre(this,"timeScale",1),bre(this,"_skeleton"),bre(this,"_clips",[]),bre(this,"_clipStates",new Map),bre(this,"_mixSkeletonPose"),bre(this,"_mixTempSkeletonPose"),bre(this,"_currentClipState"),bre(this,"_bindList",[]),bre(this,"_jointMatrixIndexTableBuffer"),bre(this,"_crossFadeState")}start(){}get currName(){return this._currentClipState?this._currentClipState.name:""}set skeleton(e){this._skeleton=e,this._mixSkeletonPose=new Dle(this._skeleton,!0),this._mixTempSkeletonPose=new Dle(this._skeleton),e=new Float32Array(this._mixSkeletonPose.jointMatrixIndexTable),this._jointMatrixIndexTableBuffer=new Aie(4*this._skeleton.numJoint,0,e),this._jointMatrixIndexTableBuffer.visibility=GPUShaderStage.VERTEX|GPUShaderStage.COMPUTE}get skeleton(){return this._skeleton}get finalSkeletonPose(){return this._mixSkeletonPose}get jointMatrixIndexTableBuffer(){return this._jointMatrixIndexTableBuffer}getJointIndexTable(e){var t=new Array;for(let r=0;r<e.length;r++){var n=e[r];n=this._skeleton.getJointByName(n);t[r]=n?n.index:-1}return t}addAnimationClip(e){var t;this._clipStates.has(e.name)||(this._clips.push(e),((t=new Ble(e)).animation=this)._clipStates.set(e.name,t),this._currentClipState)||this.setCurrentClipState(t)}getAnimationClip(e){return(e=this.getAnimationClipState(e))?e.clip:null}getAnimationClips(){return this._clips}getAnimationClipState(e){return this._clipStates.has(e)?this._clipStates.get(e):null}getAnimationClipStates(){return this._clipStates}pause(){this.isPlaying=!1}resume(){this.isPlaying=!0}play(e,t=1,n=!1){return this._currentClipState&&this._currentClipState.name==e?(n&&this._currentClipState.reset(),!1):!!(n=this.getAnimationClipState(e))&&(n.speed=t,n.reset(),this._clipStates.forEach(((e,t)=>{e.weight=0})),this.setCurrentClipState(n),!0)}crossFade(e,t){t<.01?this.play(e):this._currentClipState.name!=e&&(e=this.getAnimationClipState(e))&&(e.reset(),this._crossFadeState?(this._crossFadeState.inClip&&(this._crossFadeState.inClip.weight=0),this._crossFadeState.outClip&&(this._crossFadeState.outClip.weight=0),this._crossFadeState.reset(e,this._currentClipState,t)):this._crossFadeState=new zle(e,this._currentClipState,t),this._currentClipState=e)}setAnimIsLoop(e,t){this._clipStates.has(e)&&(this._clipStates.get(e).loop=t)}addJointBind(e,t){this._bindList.push({jointName:e,obj:t})}removeJointBind(e){for(let t=0;t<this._bindList.length;t++)if(this._bindList[t].obj==e){this._bindList.splice(t,1);break}}onUpdate(){if(this.isPlaying){let i=.001*Sre.delta*this.timeScale;this._crossFadeState&&this._crossFadeState.update(i);var e=0,t=[];if(this._clipStates.forEach(((n,r)=>{0<n.weight&&(n.update(i),e+=n.weight,t.push(n))})),0<t.length){this._mixSkeletonPose.copyFrom(t[0].currSkeletonPose);for(var n=1;n<t.length;++n){var r=t[n];this._mixTempSkeletonPose.lerp(this._mixSkeletonPose,r.currSkeletonPose,r.weight/e),this._mixSkeletonPose.copyFrom(this._mixTempSkeletonPose)}}}}cloneTo(e){var t=e.addComponent(Ule);t.skeleton=this.skeleton;for(var n=0;n<this._clips.length;++n)t.addAnimationClip(this._clips[n])}setCurrentClipState(e){this._currentClipState!=e&&(this._currentClipState=e,this._currentClipState.weight=1)}}class zle{constructor(e,t,n){bre(this,"inClip"),bre(this,"outClip"),bre(this,"currentTime"),bre(this,"crossFadeTime"),this.reset(e,t,n)}reset(e,t,n){this.inClip=e,this.outClip=t,this.currentTime=0,this.crossFadeTime=n}update(e){this.inClip&&this.outClip&&(this.currentTime+=e,this.inClip.weight=Math.min(Math.abs(this.currentTime%this.crossFadeTime)/this.crossFadeTime,1),this.outClip.weight=1-this.inClip.weight,Math.abs(this.currentTime)>=this.crossFadeTime)&&(this.inClip.weight=1,this.outClip.weight=0,this.inClip=null,this.outClip=null)}}class Fle{static add(e){-1==this.list.indexOf(e)&&this.list.push(e)}static remove(e){-1!=(e=this.list.indexOf(e))&&this.list.splice(e,1)}}bre(Fle,"list",[]);class Vle extends iae{constructor(){super(),bre(this,"name"),bre(this,"size",1),bre(this,"lightData"),bre(this,"dirFix",1),bre(this,"bindOnChange"),bre(this,"needUpdateShadow",!0),bre(this,"realTimeShadow",!0),bre(this,"_castGI",!1),bre(this,"_castShadow",!1),bre(this,"_iesProfiles")}init(){this.transform.object3D.bound=new gae(new Rre,new Rre),this.lightData=new tae,this.lightData.lightMatrixIndex=this.transform.worldMatrix.index}onChange(){this.bindOnChange&&this.bindOnChange(),this.transform.object3D.bound.setFromCenterAndSize(this.transform.worldPosition,new Rre(this.size,this.size,this.size)),this._castGI&&(Kse.instance.state.giLightingChange=!0),this._castShadow?(this.needUpdateShadow=!0,Sae.addShadowLight(this)):Sae.removeShadowLight(this)}start(){this.transform.onPositionChange=()=>this.onPositionChange(),this.transform.onScaleChange=()=>this.onScaleChange(),this.transform.onRotationChange=()=>this.onRotChange(),this.onPositionChange(),this.onRotChange(),this.onScaleChange()}onPositionChange(){this.lightData.lightPosition.copyFrom(this.transform.worldPosition)}onRotChange(){1==this.dirFix?this.lightData.direction.copyFrom(this.transform.forward):this.lightData.direction.copyFrom(this.transform.back),this.lightData.lightTangent.copyFrom(this.transform.up),this.onChange()}onScaleChange(){this.onChange()}onEnable(){this.onChange(),Kse.instance.addLight(this.transform.scene3D,this)}onDisable(){this.onChange(),Kse.instance.removeLight(this.transform.scene3D,this)}set iesProfiles(e){this._iesProfiles=e,this.lightData.iesIndex=e.index,Oae.use=!0,this.onChange()}get iesProfile(){return this._iesProfiles}get r(){return this.lightData.lightColor.r}set r(e){this.lightData.lightColor.r=e,this.onChange()}get g(){return this.lightData.lightColor.g}set g(e){this.lightData.lightColor.g=e,this.onChange()}get b(){return this.lightData.lightColor.b}set b(e){this.lightData.lightColor.b=e,this.onChange()}get lightColor(){return this.lightData.lightColor}set lightColor(e){this.lightData.lightColor=e,this.onChange()}get intensity(){return this.lightData.intensity}set intensity(e){this.lightData.intensity=e,this.onChange()}set castShadow(e){e!=this._castShadow&&(this._castShadow=e,this.onChange())}get castShadow(){return this._castShadow}get shadowIndex(){return this.lightData.castShadowIndex}get castGI(){return this._castGI}set castGI(e){e?Fle.add(this):Fle.remove(this),(this._castGI=e)&&this.onChange()}get direction(){return this.lightData.direction}destroy(e){this.bindOnChange=null,this.transform.eventDispatcher.removeEventListener(pae.ROTATION_ONCHANGE,this.onRotChange,this),this.transform.eventDispatcher.removeEventListener(pae.SCALE_ONCHANGE,this.onScaleChange,this),super.destroy(e)}}class Gle extends Vle{constructor(){super(),bre(this,"shadowCamera")}init(){super.init(),""==this.object3D.name&&(this.object3D.name="DirectionLight_"+Rie()),this.radius=9999999,this.lightData.lightType=eae.DirectionLight,this.lightData.linear=0}start(){super.start(),this.castGI=!0}get radius(){return this.lightData.range}set radius(e){this.lightData.range=e,this.onChange()}get indirect(){return this.lightData.quadratic}set indirect(e){this.lightData.quadratic=e,this.onChange()}debug(){}}class Hle extends Vle{constructor(){super()}init(){super.init(),this.lightData.lightType=eae.PointLight,""==this.object3D.name&&(this.object3D.name="PointLight"+Rie())}get range(){return this.lightData.range}set range(e){this.lightData.range=e,this.onChange()}get at(){return this.lightData.linear}set at(e){this.lightData.linear=e,this.onChange()}get radius(){return this.lightData.radius}set radius(e){this.lightData.radius=e,this.onChange()}get quadratic(){return this.lightData.quadratic}set quadratic(e){this.lightData.quadratic=e,this.onChange()}start(){this.transform.rotationX=90,super.start()}onUpdate(){this.transform.updateWorldMatrix(!0)}onGraphic(e){(e=e.graphic3D.createCustomShape("PointLight_"+this.object3D.uuid,this.transform)).buildAxis(),e.buildCircle(Rre.ZERO,this.range,32,Rre.X_AXIS),e.buildCircle(Rre.ZERO,this.range,32,Rre.Y_AXIS),e.buildCircle(Rre.ZERO,this.range,32,Rre.Z_AXIS)}debug(){}debugDraw(e){}}class jle extends Vle{constructor(){super()}init(){super.init(),this.lightData.lightType=eae.SpotLight,""==this.object3D.name&&(this.object3D.name="SpotLight"+Rie())}get innerAngle(){return this.lightData.innerAngle/this.lightData.outerAngle*100}set innerAngle(e){this.lightData.innerAngle=Wie(e,0,100)/100*this.lightData.outerAngle,this.onChange()}get outerAngle(){return this.lightData.outerAngle*Hie*2}set outerAngle(e){this.lightData.outerAngle=Wie(e,1,179)*jie*.5,this.onChange()}get radius(){return this.lightData.radius}set radius(e){this.lightData.radius=e,this.onChange()}get range(){return this.lightData.range}set range(e){this.lightData.range=e,this.onChange()}get at(){return this.lightData.linear}set at(e){this.lightData.linear=e,this.onChange()}start(){super.start(),this.lightData.lightType=eae.SpotLight}onUpdate(){this.transform.updateWorldMatrix(!0)}onGraphic(e){e=e.graphic3D.createCustomShape("SpotLight_"+this.object3D.uuid,this.transform);var t=this.range,n=this.outerAngle/2,r=(e.buildAxis(),(90-n)*jie),i=t*Math.cos(r),a=t*Math.sin(r);e.buildLines([Rre.ZERO,new Rre(0,i,a)]),e.buildLines([Rre.ZERO,new Rre(i,0,a)]),r=(90+n)*jie,i=t*Math.cos(r),a=t*Math.sin(r),e.buildLines([Rre.ZERO,new Rre(0,i,a)]),e.buildLines([Rre.ZERO,new Rre(i,0,a)]),e.buildArcLine(Rre.ZERO,t,90-n,90+n,16,Rre.X_AXIS),e.buildArcLine(Rre.ZERO,t,90-n,90+n,16,Rre.Y_AXIS),e.buildCircle(new Rre(0,0,t*Math.sin(r)),t*Math.cos(r),32,Rre.Z_AXIS)}debug(){}debugDraw(e){}}class Wle extends soe{constructor(){super(),bre(this,"skinJointsName"),bre(this,"mInverseBindMatrixData"),bre(this,"mInverseBindMatrixBuffer"),bre(this,"mSkeletonAnimation"),bre(this,"mJointIndexTableBuffer"),this.addRendererMask(bie.SkinnedMesh)}start(){var e;super.start(),this.skeletonAnimation=this.object3D.getComponent(Ule),this.skeletonAnimation||(0<(e=this.object3D.parentObject.parentObject.getComponentsInChild(Ule)).length&&(this.skeletonAnimation=e[0]),this.skeletonAnimation)||(this.skeletonAnimation=this.object3D.getComponentFromParent(Ule))}onEnable(){super.onEnable()}get skeletonAnimation(){return this.mSkeletonAnimation}set skeletonAnimation(e){(this.mSkeletonAnimation=e)&&!this.mJointIndexTableBuffer&&(e=this.mSkeletonAnimation.getJointIndexTable(this.skinJointsName),this.mJointIndexTableBuffer=new Aie(4*e.length,0,new Float32Array(e)),this.mJointIndexTableBuffer.visibility=GPUShaderStage.VERTEX|GPUShaderStage.COMPUTE)}get skinInverseBindMatrices(){return this.mInverseBindMatrixData}set skinInverseBindMatrices(e){this.mInverseBindMatrixData=e;var t=new Float32Array(16*e.length);for(let i=0;i<e.length;i++){var n=16*i,r=e[i];t.set(r,n)}this.mInverseBindMatrixBuffer=new Aie(t.byteLength,0,t),this.mInverseBindMatrixBuffer.visibility=GPUShaderStage.VERTEX|GPUShaderStage.COMPUTE}get inverseBindMatrixBuffer(){return this.mInverseBindMatrixBuffer}get jointIndexTableBuffer(){return this.mJointIndexTableBuffer.buffer}cloneTo(e){(e=e.addComponent(Wle)).geometry=this.geometry,e.material=this.material.clone(),e.castShadow=this.castShadow,e.castGI=this.castGI,e.receiveShadow=this.receiveShadow,e.rendererMask=this.rendererMask,e.skinJointsName=this.skinJointsName,e.skinInverseBindMatrices=this.skinInverseBindMatrices,e.mJointIndexTableBuffer=this.mJointIndexTableBuffer}nodeUpdate(e,t,n,r){for(let s=0;s<this.materials.length;s++){var i=this.materials[s].renderPasses.get(t);if(i)for(let e=0;e<i.length;e++){var a=i[e].renderShader;a.pipeline||(a.setStorageBuffer("jointsMatrixIndexTable",this.mSkeletonAnimation.jointMatrixIndexTableBuffer),a.setStorageBuffer("jointsInverseMatrix",this.mInverseBindMatrixBuffer),a.setStorageBuffer("jointsIndexMapingTable",this.mJointIndexTableBuffer))}}super.nodeUpdate(e,t,n,r)}}class Yle extends kse{get uvTransform_1(){return this.renderShader.uniforms.transformUV1.vector4}set uvTransform_1(e){this.renderShader.setUniformVector4("transformUV1",e)}get uvTransform_2(){return this.renderShader.uniforms.transformUV2.vector4}set uvTransform_2(e){this.renderShader.setUniformVector4("transformUV2",e)}get materialF0(){return this.renderShader.uniforms.materialF0.vector4}set materialF0(e){this.renderShader.setUniformVector4("materialF0",e)}get roughness(){return this.renderShader.uniforms.roughness.value}set roughness(e){this.renderShader.setUniformFloat("roughness",e)}get metallic(){return this.renderShader.uniforms.metallic.value}set metallic(e){this.renderShader.setUniformFloat("metallic",e)}get ao(){return this.renderShader.uniforms.ao.value}set ao(e){this.renderShader.setUniformFloat("ao",e)}get metallic_min(){return this.renderShader.uniforms.metallic_min.value}set metallic_min(e){this.renderShader.setUniformFloat("metallic_min",e)}get metallic_max(){return this.renderShader.uniforms.metallic_max.value}set metallic_max(e){this.renderShader.setUniformFloat("metallic_max",e)}get roughness_min(){return this.renderShader.uniforms.roughness_min.value}set roughness_min(e){this.renderShader.setUniformFloat("roughness_min",e)}get roughness_max(){return this.renderShader.uniforms.roughness_max.value}set roughness_max(e){this.renderShader.setUniformFloat("roughness_max",e)}get normalScale(){return this.renderShader.uniforms.normalScale.value}set normalScale(e){this.renderShader.setUniformFloat("normalScale",e)}get maskMap(){return this.renderShader.textures.maskMap}set maskMap(e){this.renderShader.setDefine("USE_ARMC",!0),this.renderShader.setTexture("maskMap",e)}set aoMap(e){e&&(this.renderShader.setTexture("aoMap",e),e!=nce.res.whiteTexture)&&this.renderShader.setDefine("USE_AOTEX",!0)}get aoMap(){return this.renderShader.textures.aoMap}set clearCoatRoughnessMap(e){e&&(this.renderShader.setTexture("clearCoatRoughnessMap",e),this.renderShader.setDefine("USE_CLEARCOAT_ROUGHNESS",!0))}get clearCoatRoughnessMap(){return this.renderShader.textures.clearCoatRoughnessMap}get brdfLUT(){return this.renderShader.textures.brdfLUT}set brdfLUT(e){this.renderShader.setTexture("brdfLUT",e),this.renderShader.setTexture("brdflutMap",e)}get emissiveMap(){return this.renderShader.textures.emissiveMap}set emissiveMap(e){this.renderShader.setTexture("emissiveMap",e)}set envIntensity(e){this.renderShader.setUniformFloat("envIntensity",e)}get envIntensity(){return this.renderShader.uniforms.envIntensity.value}set ior(e){this.renderShader.setUniformFloat("ior",e)}get ior(){return this.renderShader.uniforms.ior.value}useCleanCoat(){this.renderShader.setDefine("USE_CLEARCOAT",!0)}set clearcoatFactor(e){this.renderShader.setUniformFloat("clearcoatFactor",e)}get clearcoatFactor(){return this.renderShader.uniforms.clearcoatFactor.value}set clearcoatRoughnessFactor(e){this.renderShader.setUniformFloat("clearcoatRoughnessFactor",e)}get clearcoatRoughnessFactor(){return this.renderShader.uniforms.clearcoatRoughnessFactor.value}set clearcoatWeight(e){this.renderShader.setUniformFloat("clearcoatWeight",e)}get clearcoatWeight(){return this.renderShader.uniforms.clearcoatWeight.value}set clearcoatColor(e){this.renderShader.setUniformColor("clearcoatColor",e)}get clearcoatColor(){return this.renderShader.uniforms.clearcoatColor.color}destroy(e){super.destroy(e)}}const $le=class extends Yle{constructor(){super(),this.setShader("PBRLItShader","PBRLItShader");var e=((e=((e=this.getShader()).setShaderEntry("VertMain","FragMain"),e.setDefine("USE_BRDF",!0),e.setDefine("USE_NORMALFILPY",nce.setting.material.normalYFlip),e.shaderState)).acceptShadow=!0,e.castShadow=!0,e.receiveEnv=!0,e.acceptGI=!0,e.useLight=!0,nce.res.getTexture("BRDFLUT"));this.brdfLUT=e,this.envIntensity=.75,this.materialF0=new $re(.04,.04,.04,.96),this.baseMap=nce.res.whiteTexture,this.normalMap=nce.res.normalTexture,this.emissiveMap=nce.res.blackTexture}clone(){var e,t,n=new $le;for(e in n.baseMap=this.baseMap,n.normalMap=this.normalMap,n.aoMap=this.aoMap,n.brdfLUT=this.brdfLUT,this.maskMap&&(n.maskMap=this.maskMap),n.emissiveMap=this.emissiveMap,this.uvTransform_1&&(n.uvTransform_1=(new $re).copyFrom(this.uvTransform_1)),this.uvTransform_2&&(n.uvTransform_2=(new $re).copyFrom(this.uvTransform_2)),n.baseColor=this.baseColor.clone(),n.emissiveColor=this.emissiveColor.clone(),this.materialF0&&(n.materialF0=(new $re).copyFrom(this.materialF0)),n.envIntensity=this.envIntensity,n.normalScale=this.normalScale,n.roughness=this.roughness,n.metallic=this.metallic,n.ao=this.ao,n.roughness_min=this.roughness_min,n.roughness_max=this.roughness_max,n.metallic_min=this.metallic_min,n.metallic_max=this.metallic_max,n.emissiveIntensity=this.emissiveIntensity,n.alphaCutoff=this.alphaCutoff,n.ior=this.ior,n.clearcoatFactor=this.clearcoatFactor,n.clearcoatRoughnessFactor=this.clearcoatRoughnessFactor,this.clearcoatColor&&(n.clearcoatColor=this.clearcoatColor.clone()),n.clearcoatWeight=this.clearcoatWeight,n.transparent=this.transparent,n.cullMode=this.cullMode,n.blendMode=this.blendMode,n.shaderState.acceptShadow=this.shaderState.acceptShadow,n.shaderState.castShadow=this.shaderState.castShadow,n.shaderState.receiveEnv=this.shaderState.receiveEnv,n.shaderState.acceptGI=this.shaderState.acceptGI,n.shaderState.useLight=this.shaderState.useLight,this.renderShader.defineValue)n.renderShader.defineValue[e]=this.renderShader.defineValue[e];for(t in this.renderShader.constValues)n.renderShader.constValues[t]=this.renderShader.constValues[t];return n}debug(){}destroy(e){super.destroy(e)}};let Xle=$le;bre(Xle,"count",0);class qle{static apply(e,t,n){var r=t.extensions;r&&r.KHR_materials_clearcoat&&(n.setDefine("USE_CLEARCOAT",!0),"clearcoatFactor"in(r=r.KHR_materials_clearcoat)&&(t.clearcoatFactor=r.clearcoatFactor,n.clearcoatFactor=t.clearcoatFactor),"clearcoatRoughnessFactor"in r)&&(t.clearcoatRoughnessFactor=r.clearcoatRoughnessFactor,n.clearcoatRoughnessFactor=t.clearcoatRoughnessFactor)}}class Kle{static apply(e,t,n){(t=t.extensions)&&t.KHR_materials_emissive_strength?(n.emissiveIntensity=.5*t.KHR_materials_emissive_strength.emissiveStrength,n.emissiveMap==nce.res.blackTexture&&(n.emissiveMap=nce.res.whiteTexture)):n.emissiveIntensity=1}}class Zle{static apply(e,t,n){(t=t.extensions)&&t.KHR_materials_unlit?n.supportLight=!0:n.supportLight=!1}}class Jle{constructor(e){bre(this,"gltf"),bre(this,"subParser"),bre(this,"_testCount",8),bre(this,"_hasCastShadow",!1),this.gltf=e.gltf,this.subParser=e}async convertNodeToObject3D(e,t){var n,r=new bae;if(r.name=e.name,r[Fse.GLTF_NODE_INDEX_PROPERTY]=e.nodeId,e.nodeObj=r,e.matrix&&(e.translation=[0,0,0],e.rotation=[0,0,0,1],e.scale=[1,1,1]),e.translation&&(r.transform.x=e.translation[0],r.transform.y=e.translation[1],r.transform.z=e.translation[2]),e.rotation&&((n=new Gie).setFromArray(e.rotation),r.transform.localRotQuat=n),e.scale&&(r.transform.scaleX=e.scale[0],r.transform.scaleY=e.scale[1],r.transform.scaleZ=e.scale[2]),t.addChild(r),e.light&&this.convertLight(e,r),e.primitives&&this.convertprimitives(e,r),e.skeleton){var i=r.addComponent(Ule);if(i){i.skeleton=this.subParser.parseSkeleton(e.skeleton.skeleton);for(let e=0;e<this.gltf.animations.length;e++){var a=((a=this.gltf.animations[e]).name||(a.name=e.toString()),this.subParser.parseSkeletonAnimation(i.skeleton,a));i.addAnimationClip(a)}}}return r}convertLight(e,t){switch(e.light.type){case"directional":var n=t.addComponent(Gle);t.name=e.light.name,n.intensity=.1*e.light.intensity,n.radius=Number.MAX_SAFE_INTEGER,n.dirFix=-1,this._hasCastShadow||(this._hasCastShadow=!0,n.castShadow=this._hasCastShadow),n.lightColor=e.light.color?new wre(e.light.color[0],e.light.color[1],e.light.color[2]):new wre(1,1,1,1),n.debug();break;case"point":0<this._testCount&&((n=t.addComponent(Hle)).name=e.light.name,n.intensity=e.light.intensity?8*e.light.intensity*2:1,n.radius=8,n.at=2,n.range=e.light.range||8,n.lightColor=e.light.color?new wre(e.light.color[0],e.light.color[1],e.light.color[2]):new wre(1,1,1,1)),this._testCount--;break;case"spot":(n=t.addComponent(jle)).name=e.light.name,n.intensity=5*e.light.intensity,n.radius=1,n.dirFix=-1,n.at=2,n.range=e.light.range||8,n.outerAngle=e.light.spot.outerConeAngle*Hie,n.lightColor=e.light.color?new wre(e.light.color[0],e.light.color[1],e.light.color[2]):new wre(1,1,1,1)}}convertprimitives(e,t){for(let S=0;S<e.primitives.length;S++){var n,r,i,a,s,o,l=e.primitives[S],u=(l.modelName,l.material);null==u.name&&(u.name=Rie());let C,T="matkey_"+u.name;if(u&&this.gltf.resources[T])C=this.gltf.resources[T];else{let e=C=new Xle;(this.gltf.resources[T]=e).name=u.name,l.material&&(({baseColorTexture:u,baseColorFactor:c,metallicFactor:v,roughnessFactor:d,doubleSided:y,metallicRoughnessTexture:w,normalTexture:x,occlusionTexture:n,emissiveTexture:r,emissiveFactor:i,enableBlend:a,alphaCutoff:o}=l.material),s=e=this.applyMaterialExtensions(l.material,e),"enableBlend"in l.material&&(l.material.enableBlend?s.blendMode=Bae.NORMAL:s.blendMode=Bae.NONE,l.material.defines)&&-1!=l.material.defines.indexOf("ALPHA_BLEND")&&(s.blendMode=Bae.ALPHA,s.transparent=!0),"alphaCutoff"in l.material&&0<o&&(s.alphaCutoff=o,s.blendMode=Bae.NORMAL,s.transparent=!0),l.material.transformUV1&&(s.uvTransform_1=l.material.transformUV1),l.material.transformUV2&&(s.uvTransform_2=l.material.transformUV2),s.baseColor=new wre(c[0],c[1],c[2],c[3]),s.roughness=d,s.metallic=v,s.doubleSide=y,u&&(s.baseMap=u),x&&(s.normalMap=x),w&&(s.maskMap=w),n&&w!=n&&(s.aoMap=n),r&&(s.emissiveMap=r),i&&(0<i[0]||0<i[1]||0<i[2])&&(s.emissiveMap&&s.emissiveMap==nce.res.blackTexture&&(s.emissiveMap=nce.res.whiteTexture),o=i[3]||1,s.emissiveColor=new wre(i[0],i[1],i[2],o),s.emissiveIntensity=1),nce.setting.material.materialDebug)&&s.debug()}var{attribArrays:c,modelName:d}=l;let M;if(!c.indices.data){var h=[],p=c.position.data.length/3/3;for(let e=0;e<p;e++){var f=3*e;h.push(2+f),h.push(0+f),h.push(1+f)}c.indices={data:new Uint8Array(h),normalize:!1,numComponents:1}}if(!c.normal){var m=[],g=c.position.data.length/3;for(let e=0;e<g;e++)m.push(0),m.push(0),m.push(0);c.normal={data:new Float32Array(m),normalize:!1,numComponents:3}}if(c.indices.data&&3<c.indices.data.length){var v=l.meshName(),y=(this.gltf.resources[v]?M=this.gltf.resources[v]:(M=M||this.createGeometryBase(v,c,l),this.gltf.resources[v]=M),new bae);if(y.name=d+S,this.gltf.animations&&null!=c[Nae.joints0]){if(M=M||this.createGeometryBase(d,c,l),this.gltf.resources[v]=M,(u=this.gltf.nodes[e.skin.skeleton]).dnode&&u.dnode.nodeObj){var _=u.dnode.nodeObj.addComponent(Ule);if(_){_.skeleton=this.subParser.parseSkeleton(e.skin.skeleton);for(let e=0;e<this.gltf.animations.length;e++){var b=((b=this.gltf.animations[e]).name||(b.name=e.toString()),this.subParser.parseSkeletonAnimation(_.skeleton,b));_.addAnimationClip(b)}}}else u.dnode.skeleton=e.skin;var x=y.addComponent(Wle);x.castShadow=!0,x.castGI=!0,x.geometry=M,x.material=C,x.skinJointsName=this.parseSkinJoints(e.skin),x.skinInverseBindMatrices=e.skin.inverseBindMatrices}else{M=M||this.createGeometryBase(d,c,l),(this.gltf.resources[v]=M).hasAttribute(Nae.joints0)&&M.vertexAttributeMap.delete(Nae.joints0);var w=y.addComponent(soe);w.castShadow=!0,w.castGI=!0,w.geometry=M,w.material=C}e.skin&&e.skin.defines,t.addChild(y)}}}createGeometryBase(e,t,n){var r=new voe,i=(r.name=e,r.morphTargetsRelative=n.morphTargetsRelative,n.targetNames);if(i&&0<i.length){var a=r.morphTargetDictionary={};for(let e=0;e<i.length;e++)a[i[e]]=e}if(r.morphTargetDictionary){var s=t.position.data.length/3,o=new Float32Array(s);for(let e=0;e<s;e++)o[e]=e;t.vIndex={data:o,normalize:!1,numComponents:1}}for(const u in t){var l=t[u];r.setAttribute(u,l.data)}return e=r.getAttribute(Nae.indices),r.addSubGeometry({indexStart:0,indexCount:e.data.length,vertexStart:0,index:0}),r}applyMaterialExtensions(e,t){return qle.apply(this.gltf,e,t),Zle.apply(this.gltf,e,t),Kle.apply(this.gltf,e,t),t}parseSkinJoints(e){var t,n=[];for(t of e.joints){var r=this.gltf.nodes[t];n.push(r.name)}return n}}class Qle{constructor(){bre(this,"currentSceneName"),bre(this,"gltf"),bre(this,"initUrl"),bre(this,"_generator"),bre(this,"_version"),bre(this,"_BASE64_MARKER",";base64,"),bre(this,"_cameraParser",null),bre(this,"_meshParser",null),bre(this,"_materialParser",null),bre(this,"_skinParser",null),bre(this,"_skeletonParser",null),bre(this,"_converter",null)}get version(){return this.version||(this.gltf?this.gltf.asset?(this._version=this.gltf.asset.version,this.gltf.asset.minVersion&&(this._version+="\r minVersion"+this.gltf.asset.minVersion),this.version):this.errorMiss("asset"):(console.warn("glTF not loaded."),null))}async parse(e,t,n){this.gltf=t,this.initUrl=e;var{version:t,generator:e}=this.gltf.asset;return this._generator=e,"2.0"!==t?(console.error("GLTFParser only support glTF 2.0 for now! Received glTF version: "+this.version),!1):(e={nodes:await this.parseScene(n),animations:this.parseAnimations(),name:this.currentSceneName},this.convertToNode(e))}destory(){wle.unload(this.gltf),this.gltf=null}async parseScene(e){e=e||this.gltf.scene||0;var t=this.gltf.scenes[e];if("u"<typeof t)return this.errorMiss("scene",e);this.currentSceneName=t.name||"GLTF_NO_NAME_SCENE";var n=[],r=t.nodes;for(let a=0;a<r.length;a++){var i=await this.parseNode(r[a]);i&&n.push(i)}return n}async parseNode(e){var t=this.gltf.nodes[e];if(!t)return this.errorMiss("node",e);if(!t.isParsed){var{name:n,matrix:r,translation:i,rotation:a,scale:s}=t,o={name:n,matrix:r,translation:i,rotation:a,scale:s,nodeId:e,camera:null,primitives:null,skin:null,children:null,light:null};if(void 0!==t.camera&&(o.camera=this.parseCamera(t.camera)),void 0!==t.mesh&&(o.primitives=await this.parseMesh(t.mesh)),void 0!==t.extensions&&this.applyNodeExtensions(t,o),void 0!==t.skin&&(n=this.parseSkin(t.skin))&&(o.skin=n),o.children=[],t.children)for(let e=0;e<t.children.length;e++)o.children.push(await this.parseNode(t.children[e]));t.dnode=o,t.isParsed=!0}return t.dnode}errorMiss(e,t){throw new Error(e+t)}parseCamera(e){return this._cameraParser||(this._cameraParser=new Cle(this.gltf)),this._cameraParser.parse(e)}async parseMesh(e){return this._meshParser||(this._meshParser=new Ele(this)),this._meshParser.parse(e)}async parseTexture(e){var t,n,r,i=this.gltf.textures[e];return i&&!i.dtexture&&(i&&null!=i.source?(t=this.gltf.images[i.source]).uri?(r=t.uri,r=fle.getURLName(r),i.dtexture=this.gltf.resources[r]):t.bufferView?(r=this.parseBufferView(t.bufferView),n=new mle,r=new Blob([r],{type:t.mimeType}),await n.loadFromBlob(r),i.dtexture=n):i.dtexture=this.gltf.resources[t.name]:i.name&&(r=fle.getURLName(i.name),i.dtexture=this.gltf.resources[r])),i.dtexture||console.log("miss texture , please check texture!",e,i),i.dtexture}async parseMaterial(e){return this._materialParser||(this._materialParser=new Ale(this)),this._materialParser.parse(e)}parseAnimations(){return[]}async parseObject3D(e,t){return this._converter||(this._converter=new Jle(this)),this._converter.convertNodeToObject3D(e,t)}parseSkeleton(e){return this._skeletonParser||(this._skeletonParser=new Nle(this)),this._skeletonParser.parse(e)}parseSkeletonAnimation(e,t){return this._skeletonParser||(this._skeletonParser=new Nle(this)),this._skeletonParser.parseSkeletonAnimation(e,t)}async trivarse(e,t){for(let r=0;r<t.length;r++){var n=await this.parseObject3D(t[r],e);await this.trivarse(n,t[r].children)}}async convertToNode(e){var t=new bae,n=(t.name=e.name,e.nodes);return e.animations,await this.trivarse(t,n),{rootNode:t,textures:[],animations:void 0,cameras:[]}}parseSkin(e){return this._skinParser||(this._skinParser=new Ple(this)),this._skinParser.parse(e)}parseAccessor(e){var t=this.gltf.accessors[e];if(!t)return this.errorMiss("accessor",e);if(!t.isParsed){t.isParsed=!0,t.daccessor=!1;e=!!t.normalized;var n,r=(n=this.gltf.bufferViews[t.bufferView])&&n.byteStride,i=xle(t.componentType);let d=1;switch(t.type){case"SCALAR":d=1;break;case"VEC2":d=2;break;case"VEC3":d=3;break;case"VEC4":case"MAT2":d=4;break;case"MAT3":d=9;break;case"MAT4":d=16;break;default:d=0}if(0===d)return console.error("glTF has unknown data type in accessor: "+t.type),!1;var a=d*i.BYTES_PER_ELEMENT;let h;if(void 0!==n){if(!(h=this.parseBufferView(t.bufferView)))return t.daccessor}else h=new Uint8Array(a*t.count).buffer;let p=this.getTypedArrayFromArrayBuffer(h,r,t.byteOffset||0,i,d,t.count);if(t.sparse){var{count:n,indices:a,values:r}=t.sparse,s=(p=new i(p),a.byteOffset||0),o=this.gltf.bufferViews[a.bufferView],l=xle(a.componentType),u=(a=this.parseBufferView(a.bufferView),this.getTypedArrayFromArrayBuffer(a,o.byteStride,s,l,1,n)),c=(a=r.byteOffset||0,o=this.gltf.bufferViews[r.bufferView],s=this.parseBufferView(r.bufferView),this.getTypedArrayFromArrayBuffer(s,o.byteStride,a,i,d,n));for(let e=0;e<u.length;e++)p.set(c.slice(e*d,e*d+d),u[e]*d)}t.computeResult={typedArray:p,arrayType:i,numComponents:d},t.daccessor={data:p,numComponents:d,normalize:e}}return t.daccessor}getTypedArrayFromArrayBuffer(e,t,n,r,i,a){let s;var o=i*r.BYTES_PER_ELEMENT;if(t&&o!==t){s=new r(i*a);for(let o=0;o<a;o++){var l=new r(e,n+o*t,i);for(let e=0;e<i;e++)s[o*i+e]=l[e]}}else s=new r(e,n,a*i);return s}parseBufferView(e){var t,n,r,i=this.gltf.bufferViews[e];return i?(!i.isParsed&&(i.isParsed=!0,i.dbufferView=!1,r=this.parseBuffer(i.buffer))&&(({byteOffset:t,byteLength:n}=i),r=new Uint8Array(r,t||0,n),i.dbufferView=new Uint8Array(r).buffer),i.dbufferView):this.errorMiss("bufferView",e)}parseBuffer(e){var t=this.gltf.buffers[e];if(!t)return this.errorMiss("buffer",e);if(!t.isParsed)if(t.isParsed=!0,t.dbuffer=!1,"data:"!==t.uri.substring(0,5)){var n=t.uri;(r=this.gltf.resources[n])?r.byteLength===t.byteLength?t.dbuffer=this.gltf.resources[n]:console.error(`load gltf resource "${n}" at buffers[${e} failed, ArrayBuffer.byteLength not equals buffer's byteLength]`):console.error(`load gltf resource "${n}" at buffers[${e}] failed`)}else{var r=t.uri.indexOf(this._BASE64_MARKER)+this._BASE64_MARKER.length,i=window.atob(t.uri.substring(r)),a=new Uint8Array(i.length);for(let e=0;e<i.length;e++)a[e]=i.charCodeAt(e);t.dbuffer=a.buffer}return t.dbuffer}getLight(e){return this.gltf.extensions.KHR_lights_punctual.lights[e]}applyNodeExtensions(e,t){(e=e.extensions).KHR_lights_punctual&&this.gltf.extensions.KHR_lights_punctual&&(t.light=this.getLight(e.KHR_lights_punctual.light))}}class eue{constructor(){bre(this,"magic"),bre(this,"version"),bre(this,"length")}}class tue{constructor(){bre(this,"chunkLength"),bre(this,"chunkType"),bre(this,"chunkData")}}class nue extends yle{constructor(){super(...arguments),bre(this,"_gltf")}async parseBuffer(e){var t=new Uint8Array(e);if(1179937895!=(e=(t.pos=0,this.parseHeader(t))).magic)return console.error("invalid GLB file"),!1;if(2!==e.version)return console.error("GLBParser only support glTF 2.0 for now! Received glTF version: "+e.version),!1;for(var n=[];t.pos<t.length;){var r=this.parseChunk(t);n.push(r)}if(1313821514!=n[0].chunkType)return console.error("invalid GLBChunk"),!1;let i="",a=n[0].chunkData;for(let d=0;d<a.length;d+=65535){var s=a.length-d;s=Math.min(s,65535),s=a.subarray(d,d+s);i+=String.fromCharCode(...s)}e=JSON.parse(i),this._gltf=new _le,this._gltf={...this._gltf,...e},this._gltf.resources={};for(let d=0;d<this._gltf.buffers.length;d++){var o=this._gltf.buffers[d];o.isParsed=!0,o.dbuffer=n[d+1].chunkData.buffer}if(this._gltf.images)for(let d=0;d<this._gltf.images.length;d++){var l=this._gltf.images[d],u=(l.name=l.name||"bufferView_"+l.bufferView.toString(),this._gltf.bufferViews[l.bufferView]),c=this._gltf.buffers[u.buffer];c=new Uint8Array(c.dbuffer,u.byteOffset,u.byteLength),u=new Blob([c],{type:l.mimeType}),c=new mle;await c.loadFromBlob(u),c.name=l.name,this._gltf.resources[l.name]=c}return(e=await(new Qle).parse(this.initUrl,this._gltf,this._gltf.scene))?(this.data=e.rootNode,e.rootNode):null}async parseJsonAndBuffer(e,t){if(this._gltf=new _le,this._gltf={...this._gltf,...e},this._gltf.resources={},(e=this._gltf.buffers[0]).isParsed=!0,e.dbuffer=t,this._gltf.images)for(let a=0;a<this._gltf.images.length;a++){var n=this._gltf.images[a],r=(n.name=n.name||"bufferView_"+n.bufferView.toString(),this._gltf.bufferViews[n.bufferView]),i=this._gltf.buffers[r.buffer];i=new Uint8Array(i.dbuffer,r.byteOffset,r.byteLength),r=new Blob([i],{type:n.mimeType}),i=new mle;await i.loadFromBlob(r),i.name=n.name,this._gltf.resources[n.name]=i}return(e=await(new Qle).parse(this.initUrl,this._gltf,this._gltf.scene))?(this.data=e.rootNode,e.rootNode):null}verification(){if(this.data)return!0;throw new Error("Method not implemented.")}parseHeader(e){var t=e.pos,n=new eue;t=new Uint32Array(e.buffer,t,3);return e.pos+=t.byteLength,n.magic=t[0],n.version=t[1],n.length=t[2],n}parseChunk(e){var t=e.pos,n=new tue,r=new Uint32Array(e.buffer,t,2),i=(t=e.pos+=r.byteLength,n.chunkLength=r[0],n.chunkType=r[1],n.chunkData=new Uint8Array(e.buffer,t,n.chunkLength),new Uint8Array(n.chunkLength));for(let a=0;a<n.chunkLength;a++)i[a]=n.chunkData[a];return n.chunkData=i,e.pos+=n.chunkLength,n}}bre(nue,"format","bin");class rue extends yle{constructor(){super(...arguments),bre(this,"textData",""),bre(this,"source_vertices"),bre(this,"source_normals"),bre(this,"source_tangents"),bre(this,"source_textureCoords"),bre(this,"matLibs"),bre(this,"geometrys"),bre(this,"activeGeo"),bre(this,"facesMaterialsIndex"),bre(this,"mtl"),bre(this,"mtlUrl")}async parseString(e){return this.source_vertices=[],this.source_normals=[],this.source_tangents=[],this.source_textureCoords=[],this.matLibs={},this.geometrys={},this.textData=e,await Promise.all([this.parserOBJ(),this.loadMTL()]),this.parser_mesh(),"null"}applyVector2(e,t,n){t[e]&&0<t[e].length?(n.push(t[e][0]),n.push(t[e][1])):(n.push(0),n.push(0))}applyVector3(e,t,n){n.push(t[e][0]),n.push(t[e][1]),n.push(t[e][2])}applyVector4(e,t,n){n.push(t[e][0]),n.push(t[e][1]),n.push(t[e][2]),n.push(t[e][3])}async loadMTL(){let e,t=(await(new vle).loadTxt(this.baseUrl+this.mtlUrl)).data.split("\r\n");for(let a=0;a<t.length;a++){let r=t[a];var n=r.indexOf("#");"newmtl"===(n=(r=(r=-1!=n?r.substring(0,n):r).trim()).split(/\s+/))[0]?(e={name:n[1]},this.matLibs[n[1]]=e):-1!=n[0].indexOf("map_")?(e[n[0]]=n[1],e.textures||(e.textures=[n[n.length-1]]),e.textures.push(n[n.length-1])):2==n.length?e[n[0]]=Number(n[1]):3==n.length?e[n[0]]=[Number(n[1]),Number(n[2])]:4==n.length&&(e[n[0]]=[Number(n[1]),Number(n[2]),Number(n[3])])}for(const a in this.matLibs){var r=this.matLibs[a];if(r.textures&&0<r.textures.length)for(let e=0;e<r.textures.length;e++){var i=fle.normalizePath(this.baseUrl+r.textures[e]);await nce.res.loadTexture(i)}}return!0}async load_textures(){}parserLine(e){var t=e.indexOf("#"),n=(-1!=t&&(-1!=e.indexOf("# object")&&(r=(n=e.split(/\s+/))[1],i=n[2],this.activeGeo={type:r,name:i[1],source_mat:"",source_faces:[]},this.geometrys[i]=this.activeGeo),e=e.substring(0,t)),(e=e.trim()).split(/\s+/));if("v"===n[0]){var r=[Number(n[1]),Number(n[2]),Number(n[3]),n[4]?1:Number(n[4])];this.source_vertices.push(r)}else if("vt"===n[0]){var i=[Number(n[1]),Number(n[2]),n[3]?1:Number(n[3])];this.source_textureCoords.push(i)}else if("vn"===n[0])t=[Number(n[1]),Number(n[2]),Number(n[3])],this.source_normals.push(t);else if("f"===n[0]){for(var a={indices:[],texture:[],normal:[]},s=1;s<n.length;++s){var o=n[s].indexOf("//"),l=n[s].split(/\W+/);0<o?(a.indices.push(l[0]),a.normal.push(l[1])):1===l.length?a.indices.push(l[0]):2===l.length?(a.indices.push(l[0]),a.texture.push(l[1])):3===l.length&&(a.indices.push(l[0]),a.texture.push(l[1]),a.normal.push(l[2]))}this.activeGeo.source_faces.push(a)}else"usemtl"===n[0]?this.activeGeo.source_mat=n[1]:"mtllib"===n[0]&&(this.mtlUrl=n[1])}async parserOBJ(){var e=this.textData.split("\r\n");for(let n=0;n<e.length;n++){var t=e[n];this.parserLine(t)}return!(this.textData="")}async parser_mesh(){for(const g in this.geometrys){var e=this.geometrys[g];e.vertex_arr=[],e.normal_arr=[],e.uv_arr=[],e.indeice_arr=[];let v=0;for(let d=0;d<e.source_faces.length;d++){var t=e.source_faces[d],n=parseInt(t.indices[0])-1,r=parseInt(t.indices[1])-1,i=parseInt(t.indices[2])-1,a=parseInt(t.normal[0])-1,s=parseInt(t.normal[1])-1,o=parseInt(t.normal[2])-1,l=parseInt(t.texture[0])-1,u=parseInt(t.texture[1])-1,c=parseInt(t.texture[2])-1;this.applyVector3(n,this.source_vertices,e.vertex_arr),this.applyVector3(a,this.source_normals,e.normal_arr),this.applyVector2(l,this.source_textureCoords,e.uv_arr),e.indeice_arr[v]=v++,this.applyVector3(r,this.source_vertices,e.vertex_arr),this.applyVector3(s,this.source_normals,e.normal_arr),this.applyVector2(u,this.source_textureCoords,e.uv_arr),e.indeice_arr[v]=v++,this.applyVector3(i,this.source_vertices,e.vertex_arr),this.applyVector3(o,this.source_normals,e.normal_arr),this.applyVector2(c,this.source_textureCoords,e.uv_arr),e.indeice_arr[v]=v++,3<t.indices.length&&(r=parseInt(t.indices[3])-1,s=parseInt(t.normal[3])-1,u=parseInt(t.texture[3])-1,this.applyVector3(n,this.source_vertices,e.vertex_arr),this.applyVector3(a,this.source_normals,e.normal_arr),this.applyVector2(l,this.source_textureCoords,e.uv_arr),e.indeice_arr[v]=v++,this.applyVector3(i,this.source_vertices,e.vertex_arr),this.applyVector3(o,this.source_normals,e.normal_arr),this.applyVector2(c,this.source_textureCoords,e.uv_arr),e.indeice_arr[v]=v++,this.applyVector3(r,this.source_vertices,e.vertex_arr),this.applyVector3(s,this.source_normals,e.normal_arr),this.applyVector2(u,this.source_textureCoords,e.uv_arr),e.indeice_arr[v]=v++)}var d=new bae;for(const e in this.geometrys){var h=this.geometrys[e],p=new voe,f=(p.setIndices(new Uint32Array(h.indeice_arr)),p.setAttribute(Nae.position,new Float32Array(h.vertex_arr)),p.setAttribute(Nae.normal,new Float32Array(h.normal_arr)),p.setAttribute(Nae.uv,new Float32Array(h.uv_arr)),p.setAttribute(Nae.TEXCOORD_1,new Float32Array(h.uv_arr)),p.addSubGeometry({indexStart:0,indexCount:h.indeice_arr.length,vertexStart:0,index:0}),new Xle),m=(h=this.matLibs[h.source_mat],(h=(f.baseMap=nce.res.getTexture(fle.normalizePath(this.baseUrl+h.map_Kd)),new bae)).addComponent(soe));m.geometry=p,m.material=f,d.addChild(h)}this.data=d}}verification(){if(this.data)return!0;throw new Error("Method not implemented.")}}bre(rue,"format","text");class iue{static blurImageFromTexture(e,t,n,r){r=r?"\n    struct ImageSize {\n        srcWidth: i32,\n            srcHeight : i32,\n                dstWidth : i32,\n                    dstHeight : i32,\n    };\n\n    @group(0) @binding(0) var<uniform>size : ImageSize;\n    @group(0) @binding(1) var inputTexture: texture_2d<f32>;\n    @group(0) @binding(2) var outputTexture: texture_storage_2d<rgba8unorm, write>;\n\n    fn repeat_i32(id: i32, max: i32) -> i32 {\n        var ret = id;\n        if (id < 0) {\n            ret = max + id;\n        }\n        if (id >= max) {\n            ret = id - max;\n        }\n        return ret;\n    }\n\n    fn clamp_i32(id: i32, max: i32) -> i32 {\n        var ret = id;\n        if (id < 0) {\n            ret = 0;\n        }\n        if (id >= max) {\n            ret = max - 1;\n        }\n        return ret;\n    }\n\n    fn blur(idx: u32) -> vec4 < f32 > {\n        var id: vec2<i32>;\n        id.y = i32(idx) / size.srcWidth;\n        id.x = i32(idx) - i32(id.y) * size.srcWidth;\n        var _BlurSpread: i32 = 1;\n        var result = vec4<f32>(0.0, 0.0, 0.0, 0.0);\n        let g: array < f32, 3u > = array<f32, 3u > (0.4026, 0.2442, 0.0545);\n        var uv: vec2<i32>;\n        for(var h: i32 = 0; h< 5; h = h + 1) {\n        let offsetU: i32 = (h - 2) * _BlurSpread;\n        uv.x = id.x + offsetU;\n        uv.x = clamp_i32(uv.x, size.srcWidth);\n        for (var v: i32 = 0; v < 5; v = v + 1) {\n            let offsetV: i32 = (v - 2) * _BlurSpread;\n            uv.y = id.y + offsetV;\n            uv.y = clamp(uv.y, 0, size.srcHeight);\n            let weightU: i32 = abs(h - 2);\n            let weightV: i32 = abs(v - 2);\n            let resultWeight: f32 = g[weightU] * g[weightV];\n            var colorf32: vec4<f32> = textureLoad(inputTexture, uv, 0);\n            let sampleColor: vec4<f32> = vec4<f32>(colorf32 * resultWeight);\n            result = result + sampleColor;\n        }\n    }\n\n    return result;\n    }\n\n    @compute @workgroup_size(8, 8, 1)\n    fn main(@builtin(global_invocation_id) GlobalInvocationID : vec3<u32>) {\n        var uv: vec2<f32> = vec2<f32>(f32(GlobalInvocationID.x) / f32(size.dstWidth), f32(GlobalInvocationID.y) / f32(size.dstHeight));\n        uv = uv * vec2<f32>(f32(size.srcWidth), f32(size.srcHeight));\n        let srcIdx = i32(uv.y) * size.srcWidth + i32(uv.x);\n        var dstId: vec2<i32> = vec2<i32>(i32(GlobalInvocationID.x), i32(GlobalInvocationID.y));\n        textureStore(outputTexture, dstId, blur(u32(srcIdx)));\n    }\n":"\n    struct ImageSize {\n        srcWidth: i32,\n            srcHeight : i32,\n                dstWidth : i32,\n                    dstHeight : i32,\n    };\n\n    @group(0) @binding(0) var<uniform>size : ImageSize;\n    @group(0) @binding(1) var inputTexture: texture_2d<f32>;\n    @group(0) @binding(2) var outputTexture: texture_storage_2d<rgba8unorm, write>;\n\n    @compute @workgroup_size(8, 8, 1)\n    fn main(@builtin(global_invocation_id) GlobalInvocationID : vec3<u32>) {\n        var uv: vec2<f32> = vec2<f32>(f32(GlobalInvocationID.x) / f32(size.dstWidth), f32(GlobalInvocationID.y) / f32(size.dstHeight));\n        uv = uv * vec2<f32>(f32(size.srcWidth), f32(size.srcHeight));\n        var dstId: vec2<i32> = vec2<i32>(i32(GlobalInvocationID.x), i32(GlobalInvocationID.y));\n        var srcId: vec2<i32> = vec2<i32>(i32(GlobalInvocationID.x * 2u), i32(GlobalInvocationID.y * 2u));\n        textureStore(outputTexture, dstId, textureLoad(inputTexture, srcId, 0));\n    }\n",r=(s=Dre.device).createComputePipeline({layout:"auto",compute:{module:s.createShaderModule({code:r}),entryPoint:"main"}});var i=s.createBuffer({size:16,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),a=(s.queue.writeBuffer(i,0,new Uint32Array([e.width,e.height,t,n])),s.createTexture({size:[t,n,1],mipLevelCount:1,format:"rgba8unorm",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.STORAGE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.COPY_SRC|GPUTextureUsage.RENDER_ATTACHMENT,label:"blurImageFromTexture"})),s=(e=[{binding:0,resource:{buffer:i,size:16}},{binding:1,resource:e.gpuTexture.createView({format:"rgba8unorm",dimension:"2d",baseMipLevel:0,mipLevelCount:1})},{binding:2,resource:a.createView({format:"rgba8unorm",dimension:"2d",baseMipLevel:0,mipLevelCount:1})}],s.createBindGroup({layout:r.getBindGroupLayout(0),entries:e})),o=(e=roe.beginCommandEncoder()).beginComputePass();return o.setPipeline(r),o.setBindGroup(0,s),o.dispatchWorkgroups(Math.floor(t/8),Math.floor(n/8)),o.end(),roe.endCommandEncoder(e),i.destroy(),a}}class aue extends kae{constructor(){super(4,4),bre(this,"width",4),bre(this,"height",4),bre(this,"depthOrArrayLayers",6),bre(this,"visibility",GPUShaderStage.FRAGMENT),bre(this,"textureBindingLayout",{viewDimension:"cube",multisampled:!1}),bre(this,"samplerBindingLayout",{type:"filtering"}),this.addressModeU=Kre,this.addressModeV=Kre,this.addressModeW=Kre,this.magFilter=this.minFilter="linear",this.mipmapFilter="linear",this.visibility=GPUShaderStage.FRAGMENT}createTextureDescriptor(e,t,n,r,i=GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.COPY_SRC|GPUTextureUsage.STORAGE_BINDING|GPUTextureUsage.RENDER_ATTACHMENT,a=1){this.width=e,this.height=t,this.format=r,this.usage=i,this.textureDescriptor={size:{width:e,height:t,depthOrArrayLayers:6},mipLevelCount:n,format:r,usage:i,dimension:"2d"},this.viewDescriptor=1<a?{dimension:"cube-array"}:{dimension:this.textureBindingLayout.viewDimension}}}const sue=class{static createFace(e,t,n,r){var i=Dre.device,a=(null==this.pipeline&&(this.pipeline=i.createComputePipeline({layout:"auto",compute:{module:i.createShaderModule({code:sue.createCube}),entryPoint:"main"}})),this.pipeline);this.configBuffer||(this.configBuffer=i.createBuffer({size:16,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST})),i.queue.writeBuffer(this.configBuffer,0,new Uint32Array([e,0,0,0])),this.blurSettingBuffer||(this.blurSettingBuffer=i.createBuffer({size:16,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST})),i.queue.writeBuffer(this.blurSettingBuffer,0,new Float32Array([0,0,0,0])),e=[{binding:0,resource:{buffer:this.configBuffer,size:16}},{binding:1,resource:n.getGPUView()},{binding:2,resource:r.getGPUView()}],n=i.createBindGroup({layout:a.getBindGroupLayout(0),entries:e});(i=(r=roe.beginCommandEncoder()).beginComputePass()).setPipeline(a),i.setBindGroup(0,n),i.dispatchWorkgroups(t/8,t/8),i.end(),roe.endCommandEncoder(r)}};let oue=sue;bre(oue,"createCube","\n\nstruct SettingUniform {\n  faceIndex : i32,\n  srcHeight : i32,\n  dstWidth : i32,\n  dstHeight : i32\n};\n\n@group(0) @binding(0) var<uniform> settingUniform : SettingUniform;\n@group(0) @binding(1) var inputTex : texture_2d<f32>;\n@group(0) @binding(2) var outTex : texture_storage_2d<rgba8unorm, write>;\n\n@compute @workgroup_size(8, 8, 1)\nfn main(@builtin(global_invocation_id) GlobalInvocationID : vec3<u32>) {\n  let coord = vec2<i32>(GlobalInvocationID.xy);\n  \n  let outTexSize = textureDimensions(outTex).xy;\n  let outTexel = 1.0 / vec2<f32>(outTexSize - 1);\n  \n  let uv_0 = vec2<f32>(coord) * outTexel;\n  var oc = samplePixel(settingUniform.faceIndex, uv_0);\n  textureStore(outTex, coord, oc);\n}\n\nfn samplePixel(face:i32, uv01:vec2<f32>) -> vec4<f32> {\n    let rectangle_v2_f32 = round(vec2<f32>(0.25, 0.33333) * vec2<f32>(textureDimensions(inputTex).xy));\n    let rectangle = vec2<i32>(rectangle_v2_f32);\n    \n    var offsetIndex = vec2<i32>(0);\n    if(face == 0){\n        offsetIndex.x = 2;\n        offsetIndex.y = 1;\n    }else if(face == 1){\n        offsetIndex.x = 0;\n        offsetIndex.y = 1;\n    }else if(face == 2){\n        offsetIndex.x = 1;\n        offsetIndex.y = 0;\n    }else if(face == 3){\n        offsetIndex.x = 1;\n        offsetIndex.y = 2;\n    }else if(face == 4){\n        offsetIndex.x = 1;\n        offsetIndex.y = 1;\n    }else if(face == 5){\n        offsetIndex.x = 3;\n        offsetIndex.y = 1;\n    }\n    \n    let coordOffset = rectangle * offsetIndex;\n    let coordIndex = vec2<i32>(vec2<f32>(rectangle - 1) * uv01);\n    var oc = textureLoad(inputTex, coordOffset + coordIndex, 0);\n    return oc;\n}\n"),bre(oue,"configBuffer",null),bre(oue,"blurSettingBuffer",null),bre(oue,"pipeline");class lue extends aue{constructor(){super(),bre(this,"_images"),bre(this,"_url"),this.useMipmap=!0}generateImages(e){var t=Dre.device;this.width=this.height=32,"width"in e[0]&&(this.width=this.height=e[0].width);let n=Math.min(this.width,this.height);for(this.mipmapCount=1;16<n;)n/=2,this.mipmapCount++;this.textureBindingLayout.viewDimension="cube",this.samplerBindingLayout.type="filtering",this.createTextureDescriptor(this.width,this.height,this.mipmapCount,this.format),this.textureDescriptor.size={width:this.width,height:this.height,depthOrArrayLayers:6},this.textureDescriptor.dimension="2d",this.gpuTexture=t.createTexture(this.textureDescriptor);let r,i=[],a=this.width,s=this.height;if(e[0]instanceof kae){for(let t=0;t<6;t++){var o=e[t];i[t]=o.getGPUTexture()}this.uploadMipmapGPUTexture(0,this.width,this.width,i)}else{this.uploadBaseImages(this.width,e);for(let t=0;t<6;t++){var l=new mle(!1);l.format=this.format,l.source=e[t],i[t]=l.getGPUTexture()}}for(let c=1;c<this.mipmapCount;c++){r=i,i=[];var u={width:a,height:s,gpuTexture:null};a/=2,s/=2;for(let e=0;e<6;e++)u.gpuTexture=r[e],i[e]=iue.blurImageFromTexture(u,a,s,!1);this.uploadMipmapGPUTexture(c,a,s,i)}this.gpuSampler=t.createSampler(this)}uploadBaseImages(e,t){var n=Dre.device,r=roe.beginCommandEncoder();for(let i=0;i<6;i++)n.queue.copyExternalImageToTexture({source:t[i]},{texture:this.gpuTexture,mipLevel:0,origin:{x:0,y:0,z:i}},{width:e,height:e,depthOrArrayLayers:1});roe.endCommandEncoder(r)}uploadMipmapGPUTexture(e,t,n,r){var i=roe.beginCommandEncoder();for(let a=0;a<6;a++)i.copyTextureToTexture({texture:r[a],mipLevel:0,origin:{x:0,y:0,z:0}},{texture:this.gpuTexture,mipLevel:e,origin:{x:0,y:0,z:a}},{width:t,height:n,depthOrArrayLayers:1});roe.endCommandEncoder(i)}get images(){return this._images}set images(e){if(this._images=e,this._images[0]instanceof HTMLImageElement){let e=[],t=6,n=this;for(let r=0;r<6;r++)!function(r,i){i.decode().then((async()=>{e[r]=await createImageBitmap(i),0==--t&&n.generateImages(e)}))}(r,this._images[r])}else(this._images instanceof HTMLCanvasElement||this._images instanceof ImageBitmap)&&this.generateImages(this._images)}async load(e){this._url=e;let t=6,n=[],r=(this.format=oie,this);for(let o=0;o<6;o++){void 0,void 0,s=void 0;var i=o,a=e[o],s=document.createElement("img");s.src=a,s.setAttribute("crossOrigin",""),await s.decode(),n[i]=await createImageBitmap(s),0==--t&&r.generateImages(n),await 0}return!0}async loadStd(e){this._url=e,this.format=oie;var t=document.createElement("img"),n=(t.src=e,t.setAttribute("crossOrigin",""),await t.decode(),new mle(!1)),r=(n.name=fle.getURLName(e),n.format="rgba8unorm",n.source=await createImageBitmap(t),Math.round(Math.log2(n.width/4))),i=(r=Math.pow(2,r),this.width=this.height=r,[]);for(let s=0;s<6;s++){var a=new boe(r,r,this.format,!1,GPUTextureUsage.STORAGE_BINDING|GPUTextureUsage.COPY_SRC|GPUTextureUsage.TEXTURE_BINDING);a.name="face "+s,i.push(a),oue.createFace(s,this.width,n,a)}return this.generateImages(i),!0}}var uue=(e=>(e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Bottom=2]="Bottom",e[e.Top=3]="Top",e[e.Back=4]="Back",e[e.Front=5]="Front",e))(uue||{});class cue{static getRotationToFace(e){var t=Gie.identity().clone(),n=new Rre,r=(new Kie).identity(),i=new Rre;switch(e){case 3:n.set(0,-1,0),i.set(0,0,-1);break;case 2:n.set(0,1,0),i.set(0,0,1);break;case 1:n.set(1,0,0),i.set(0,1,0);break;case 0:n.set(-1,0,0),i.set(0,1,0);break;case 4:n.set(0,0,-1),i.set(0,1,0);break;case 5:return Gie.identity()}return r.lookAt(new Rre,n,i),t.setFromRotationMatrix(r),t}}const due=class{static convertRGBE2RGBA(e,t){var n,r=(n=Dre.device).createComputePipeline({layout:"auto",compute:{module:n.createShaderModule({code:"\n  struct ImageSize {\n    srcWidth : i32,\n    srcHeight : i32,\n    dstWidth : i32,\n    dstHeight : i32\n  };\n\n  @group(0) @binding(0) var<uniform> size : ImageSize;\n  @group(0) @binding(1) var<storage, read> tex_in: array<vec4<f32>>;\n  @group(0) @binding(2) var outputBuffer : texture_storage_2d<rgba16float, write>;\n\n  @compute @workgroup_size(8, 8, 1)\n  fn main(@builtin(global_invocation_id) GlobalInvocationID : vec3<u32>) {\n    let fragCoord = vec2<i32>(i32(GlobalInvocationID.x), i32(GlobalInvocationID.y));\n    var oc:vec4<f32> = tex_in[fragCoord.y * size.srcWidth + fragCoord.x] / 256.0;\n    var e = pow(2.0, oc.w * 255.0 - 128.0);\n    oc = oc * e;\n    oc = scaleByThreshold(oc, 40.0);\n    textureStore(outputBuffer, fragCoord , vec4<f32>(oc.xyz, 1.0) );\n  }\n\n  fn scaleByThreshold(color:vec4<f32>, threshold:f32) -> vec4<f32>{\n    var oc = color;\n    let brightness = length(vec3<f32>(oc.xyz));\n    var scale = brightness / threshold;\n    if(scale > 1.0){\n        scale = 1.0 / pow(scale, 0.7);\n        oc = oc * scale;\n    }\n    oc.a = 1.0;\n    return oc;\n  }\n"}),entryPoint:"main"}}),i=n.createBuffer({size:16,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),a=(n.queue.writeBuffer(i,0,new Uint32Array([e.width,e.height,e.width,e.height])),n.createBuffer({size:t.byteLength,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST|GPUBufferUsage.COPY_SRC}));n.queue.writeBuffer(a,0,t),a=[{binding:0,resource:{buffer:i,size:16}},{binding:1,resource:{buffer:a,size:t.byteLength}},{binding:2,resource:e.getGPUView()}],t=n.createBindGroup({layout:r.getBindGroupLayout(0),entries:a});(a=(n=roe.beginCommandEncoder()).beginComputePass()).setPipeline(r),a.setBindGroup(0,t),a.dispatchWorkgroups(Math.floor(e.width/8),Math.floor(e.height/8)),a.end(),roe.endCommandEncoder(n),i.destroy()}static makeTextureCube(e,t,n){var r=Dre.device,i=(due.makeFaceTexturePipeline||(due.makeFaceTexturePipeline=r.createComputePipeline({layout:"auto",compute:{module:r.createShaderModule({code:"\n  struct ImageSize {\n    srcWidth : i32,\n    srcHeight : i32,\n    dstWidth : i32,\n    dstHeight : i32\n  };\n\n  @group(0) @binding(0) var<uniform> size : ImageSize;\n  @group(0) @binding(1) var<storage,read_write> faceRotation: array<vec4<f32>>;\n  @group(0) @binding(2) var inputTexSampler : sampler;\n  @group(0) @binding(3) var inputTex : texture_2d<f32>;\n\n  @group(1) @binding(0) var outputBuffer0 : texture_storage_2d_array<rgba16float, write>;\n\n  fn SampleSphericalMap(v: vec3<f32>) -> vec2<f32> {\n      var uv:vec2<f32> = vec2<f32>(atan2(v.z, v.x), asin(v.y));\n      //uv = (uv * (vec2<f32>(0.1590999960899353, 0.3183000087738037) + vec2<f32>(0.0010000000474974513)));\n      uv = uv * vec2<f32>(0.1590999960899353, 0.3183000087738037);\n      uv = uv + vec2<f32>(0.5);\n      uv = clamp(uv, vec2<f32>(0.0), vec2<f32>(1.0));\n      return uv;\n  }\n\n\n  fn applyQuaternion(position:vec3<f32>, q:vec4<f32>) -> vec3<f32>{\n      let x:f32 = position.x;\n      let y:f32 = position.y;\n      let z:f32 = position.z;\n\n      let qx:f32 = q.x;\n      let qy:f32 = q.y;\n      let qz:f32 = q.z;\n      let qw:f32 = q.w;\n\n      let ix:f32 = qw * x + qy * z - qz * y;\n      let iy:f32 = qw * y + qz * x - qx * z;\n      let iz:f32 = qw * z + qx * y - qy * x;\n      let iw:f32 = -qx * x - qy * y - qz * z;\n\n      var ret: vec3<f32>;\n      ret.x = ix * qw + iw * -qx + iy * -qz - iz * -qy;\n      ret.y = iy * qw + iw * -qy + iz * -qx - ix * -qz;\n      ret.z = iz * qw + iw * -qz + ix * -qy - iy * -qx;\n\n      return ret;\n  }\n\n  fn convertIdToDir3(uv_i32:vec2<i32>, quaternion:vec4<f32>) -> vec3<f32>{\n      var uv_f32:vec2<f32> = vec2<f32>(uv_i32.xy);\n      var halfSize:f32 = f32(size.dstWidth / 2);\n      var worldDirection:vec3<f32> = vec3<f32>(uv_f32.x - halfSize, uv_f32.y - halfSize, -halfSize);\n      worldDirection = normalize(worldDirection);\n      worldDirection = applyQuaternion(worldDirection, quaternion);\n      return worldDirection;\n  }\n\n  @compute @workgroup_size(8, 8, 1)\n  fn main(@builtin(global_invocation_id) GlobalInvocationID : vec3<u32>) {\n    let coord = vec2<i32>(GlobalInvocationID.xy);\n    let quaternion = faceRotation[GlobalInvocationID.z];\n    var worldDirection:vec3<f32> = convertIdToDir3(coord, quaternion);\n    let uv_f32:vec2<f32> = SampleSphericalMap(worldDirection);\n    let oc = textureSampleLevel(inputTex, inputTexSampler, uv_f32 , 0.0);\n    textureStore(outputBuffer0, coord, i32(GlobalInvocationID.z), oc);\n  }\n"}),entryPoint:"main"}})),due.makeFaceTexturePipeline);if(due.configBuffer||(due.configBuffer=r.createBuffer({size:16,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST})),r.queue.writeBuffer(due.configBuffer,0,new Uint32Array([e.width,e.height,t,t])),!due.quaternionBuffer){due.quaternionBuffer=r.createBuffer({size:576,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST});var a=new Float32Array(24);for(let e=0;e<6;e++){var s=cue.getRotationToFace(e);a[4*e+0]=s.x,a[4*e+1]=s.y,a[4*e+2]=s.z,a[4*e+3]=s.w}r.queue.writeBuffer(due.quaternionBuffer,0,a)}e=[{binding:0,resource:{buffer:due.configBuffer,size:16}},{binding:1,resource:{buffer:due.quaternionBuffer,size:96}},{binding:2,resource:e.gpuSampler},{binding:3,resource:e.getGPUView()}],n=[{binding:0,resource:n}],e=r.createBindGroup({layout:i.getBindGroupLayout(0),entries:e}),r=r.createBindGroup({layout:i.getBindGroupLayout(1),entries:n});var o=(n=roe.beginCommandEncoder()).beginComputePass();o.setPipeline(i),o.setBindGroup(0,e),o.setBindGroup(1,r),o.dispatchWorkgroups(t/8,t/8,6),o.end(),roe.endCommandEncoder(n)}};let hue=due;bre(hue,"makeFaceTexturePipeline"),bre(hue,"configBuffer"),bre(hue,"quaternionBuffer");class pue extends kae{constructor(){super(32,32,null),this.isHDRTexture=!0}create(e=32,t=32,n=null,r=!0){this.width=e,this.height=t;var i=Dre.device,a=4*e*2;this.format=die,this.useMipmap=r,this.updateTextureDescription(),this.updateGPUTexture(),r=i.createBuffer({size:n.byteLength,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.COPY_SRC});return(n=(i.queue.writeBuffer(r,0,n),roe.beginCommandEncoder())).copyBufferToTexture({buffer:r,bytesPerRow:a},{texture:this.getGPUTexture()},{width:e,height:t,depthOrArrayLayers:1}),roe.endCommandEncoder(n),this.useMipmap||(this.samplerBindingLayout.type="filtering",this.textureBindingLayout.sampleType="float"),this.gpuSampler=i.createSampler(this),this}async load(e,t){return(await(new vle).load(e,_ue,t)).getHDRTexture()}}const fue=new Float32Array(1),mue=new Int32Array(fue.buffer);let gue=function(e){fue[0]=e;let t=(e=mue[0])>>16&32768,n=e>>12&2047;var r=e>>23&255;return r<103||(142<r?t=31744|t|((255==r?1:0)&&8388607&e):r<114?(n|=2048,t|=(n>>114-r)+(n>>113-r&1)):t=(t|=r-112<<10|n>>1)+(1&n)),t};var vue=(e=>(e[e.RGBE_RETURN_FAILURE=-1]="RGBE_RETURN_FAILURE",e[e.rgbe_read_error=1]="rgbe_read_error",e[e.rgbe_write_error=2]="rgbe_write_error",e[e.rgbe_format_error=3]="rgbe_format_error",e[e.rgbe_memory_error=4]="rgbe_memory_error",e))(vue||{});class yue{constructor(){bre(this,"valid"),bre(this,"string"),bre(this,"comments"),bre(this,"programtype"),bre(this,"format"),bre(this,"gamma"),bre(this,"exposure"),bre(this,"width"),bre(this,"height")}}class _ue extends yle{constructor(){super(...arguments),bre(this,"_rgbeArray"),bre(this,"_width"),bre(this,"_height"),bre(this,"_RGBE_RETURN_FAILURE",-1),bre(this,"_parserType",lie)}parseBuffer(e){if((n=((e=new Uint8Array(e)).pos=0,this.paserHeader(e)))instanceof yue){var t=this._width=n.width,n=this._height=n.height;if((e=this.parserPixel(e.subarray(e.pos),t,n))instanceof Uint8Array)return this._rgbeArray=e,this._parserType,void(this.data=void 0)}return null}verification(){if(this.data&&this.data instanceof kae)return!0;if(this._rgbeArray)return!0;throw new Error("Method not implemented.")}getTexture(){return this.data}getCubeTexture(){var e=this._width/4;return(new wue).createFromHDRData(e,{width:this._width,height:this._height,array:this._rgbeArray})}getHDRTexture(){return(new pue).create(this._width,this._height,this._rgbeArray)}parseError(e,t){switch(e){case 1:console.error("Read Error: "+(t||""));break;case 2:console.error("Write Error: "+(t||""));break;case 3:console.error("Bad File Format: "+(t||""));break;default:console.error("Error: "+(t||""))}return-1}parserBlock(e,t,n){t=t||1024;let r=e.pos,i=-1,a=0,s="",o=String.fromCharCode.apply(null,new Uint16Array(e.subarray(r,r+128)));for(;(i=o.indexOf("\n"))<0&&a<t&&r<e.byteLength;)s+=o,a+=o.length,r+=128,o+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(r,r+128)));return-1<i&&(!1!==n&&(e.pos+=a+i+1),s+o.slice(0,i))}paserHeader(e){var t=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,n=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,r=/^\s*FORMAT=(\S+)\s*$/,i=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,a=new yue;let s,o;if(e.pos>=e.byteLength||!(s=this.parserBlock(e)))return this.parseError(1,"no header found");if(!(o=s.match(/^#\?(\S+)/)))return this.parseError(3,"bad initial token");for(a.valid|=1,a.programtype=o[1],a.string+=s+"\n";!1!==(s=this.parserBlock(e));)if(a.string+=s+"\n","#"===s.charAt(0))a.comments+=s+"\n";else if((o=s.match(t))&&(a.gamma=Math.floor(10*parseFloat(o[1]))/10),(o=s.match(n))&&(a.exposure=Math.floor(10*parseFloat(o[1]))/10),(o=s.match(r))&&(a.valid|=2,a.format=o[1]),(o=s.match(i))&&(a.valid|=4,a.height=parseInt(o[1],10),a.width=parseInt(o[2],10)),2&a.valid&&4&a.valid)break;return 2&a.valid?4&a.valid?a:(this.parseError(3,"missing image size specifier"),null):(this.parseError(3,"missing format specifier"),null)}parserPixel(e,t,n){var r=t;if(r<8||32767<r||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);if(r!==(e[2]<<8|e[3]))return this.parseError(3,"wrong scanline width");var i=new Uint8Array(4*t*n);if(!i.length)return this.parseError(4,"unable to allocate buffer space");let a=0,s=0;var o=4*r,l=new Uint8Array(4),u=new Uint8Array(o);let c=n;for(;0<c&&s<e.byteLength;){if(s+4>e.byteLength)return this.parseError(1,"");if(l[0]=e[s++],l[1]=e[s++],l[2]=e[s++],l[3]=e[s++],2!=l[0]||2!=l[1]||(l[2]<<8|l[3])!=r)return this.parseError(3,"bad rgbe scanline format");let t,n=0;for(;n<o&&s<e.byteLength;){var d=128<(t=e[s++]);if(d&&(t-=128),0===t||n+t>o)return this.parseError(3,"bad scanline data");if(d){var h=e[s++];for(let e=0;e<t;e++)u[n++]=h}else u.set(e.subarray(s,s+t),n),n+=t,s+=t}var p=r;for(let e=0;e<p;e++){var f=0;i[a]=u[e+0],f+=r,i[a+1]=u[e+f],f+=r,i[a+2]=u[e+f],f+=r,i[a+3]=u[e+f],a+=4}c--}return i}rbgeToFloat(e,t,n,r){var i=e[t+3];i=Math.pow(2,i-128)/255;n[r+0]=e[t+0]*i,n[r+1]=e[t+1]*i,n[r+2]=e[t+2]*i,n[r+3]=1}rbgeToHalfFloat(e,t,n,r){var i=e[t+3];i=Math.pow(2,i-128)/255;n[r+0]=gue(e[t+0]*i),n[r+1]=gue(e[t+1]*i),n[r+2]=gue(e[t+2]*i),n[r+3]=gue(1)}}bre(_ue,"format","bin");class bue{static importantSample(e,t,n,r){var i=Dre.device,a=(null==this.pipeline&&(this.pipeline=i.createComputePipeline({layout:"auto",compute:{module:i.createShaderModule({code:"\n    struct ImageSize {\n        srcWidth : i32,\n        srcHeight : i32,\n        dstWidth : i32,\n        dstHeight : i32\n    };\n    \n    @group(0) @binding(0) var<uniform> size : ImageSize;\n    @group(0) @binding(1) var<storage,read_write> faceRotation: array<vec4<f32>>;\n    @group(0) @binding(2) var inputTexSampler : sampler;\n    @group(0) @binding(3) var inputTex : texture_2d<f32>;\n    \n    @group(1) @binding(0) var<uniform> blurSetting : vec4<f32>;\n    @group(1) @binding(1) var outputBuffer0 : texture_storage_2d_array<rgba16float, write>;\n    \n    var<private> PI: f32 = 3.14159265359;\n    \n    fn applyQuaternion(position:vec3<f32>, q:vec4<f32>) -> vec3<f32>{\n        let x:f32 = position.x;\n        let y:f32 = position.y;\n        let z:f32 = position.z;\n    \n        let qx:f32 = q.x;\n        let qy:f32 = q.y;\n        let qz:f32 = q.z;\n        let qw:f32 = q.w;\n    \n        let ix:f32 = qw * x + qy * z - qz * y;\n        let iy:f32 = qw * y + qz * x - qx * z;\n        let iz:f32 = qw * z + qx * y - qy * x;\n        let iw:f32 = -qx * x - qy * y - qz * z;\n    \n        var ret: vec3<f32>;\n        ret.x = ix * qw + iw * -qx + iy * -qz - iz * -qy;\n        ret.y = iy * qw + iw * -qy + iz * -qx - ix * -qz;\n        ret.z = iz * qw + iw * -qz + ix * -qy - iy * -qx;\n    \n        return ret;\n    }\n    \n    fn convertIdToDir3(uv_i32:vec2<i32>, quaternion:vec4<f32>) -> vec3<f32>{\n        var uv_f32:vec2<f32> = vec2<f32>(uv_i32.xy);\n        var halfSize:f32 = f32(size.dstWidth / 2);\n        var worldDirection:vec3<f32> = vec3<f32>(uv_f32.x - halfSize, uv_f32.y - halfSize, -halfSize);\n        worldDirection = normalize(worldDirection);\n        worldDirection = applyQuaternion(worldDirection, quaternion);\n        return worldDirection;\n    }\n    \n    fn VanDerCorpus(n0:u32, base0:u32) -> f32\n    {\n        var n = n0;\n        var base = base0;\n        var invBase:f32 = 1.0 / f32(base);\n        var denom:f32   = 1.0;\n        var result:f32  = 0.0;\n    \n        for(var i:u32 = 0u; i < 32u; i = i + 1u)\n        {\n            if(n > 0u)\n            {\n                denom   = f32(n) % 2.0;\n                result = result + denom * invBase;\n                invBase = invBase / 2.0;\n                n       = u32(f32(n) / 2.0);\n            }\n        }\n    \n        return result;\n    }\n    \n    fn HammersleyNoBitOps(i:u32, N:u32) -> vec2<f32>\n    {\n        return vec2(f32(i)/f32(N), VanDerCorpus(i, 2u));\n    }\n    \n    fn hammersley( i : u32 ,  N : u32 ) -> vec2<f32>\n    {\n        // Radical inverse based on http://holger.dammertz.org/stuff/notes_HammersleyOnHemisphere.html\n        var bits = (i << 16u) | (i >> 16u);\n        bits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);\n        bits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);\n        bits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);\n        bits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);\n        var rdi = f32(bits) * 2.3283064365386963e-10;\n        return vec2<f32>(f32(i) /f32(N), rdi);\n    }\n    \n    fn ImportanceSampleGGX( Xi:vec2<f32>, N:vec3<f32>, roughness:f32) ->vec3<f32>\n    {\n        var a = roughness*roughness;\n    \n        var phi = 2.0 * PI * Xi.x;\n        var cosTheta = sqrt((1.0 - Xi.y) / (1.0 + (a*a - 1.0) * Xi.y));\n        var sinTheta = sqrt(1.0 - cosTheta*cosTheta);\n    \n        // from spherical coordinates to cartesian coordinates\n        var H:vec3<f32>;\n        H.x = cos(phi) * sinTheta;\n        H.y = sin(phi) * sinTheta;\n        H.z = cosTheta;\n    \n        // from tangent-space vector to world-space sample vector\n        var up:vec3<f32>;\n        if(abs(N.z) < 0.999)\n        {\n            up = vec3<f32>(0.0, 0.0, 1.0);\n        }\n        else\n        {\n            up = vec3<f32>(1.0, 0.0, 0.0);\n        }\n        var tangent:vec3<f32>  = normalize(cross(up, N));\n        var bitangent:vec3<f32> = cross(N, tangent);\n        var sampleVec:vec3<f32> = tangent * H.x + bitangent * H.y + N * H.z;\n        return normalize(sampleVec);\n    }\n    \n    fn multiSample(localPos:vec3<f32>, roughness:f32) -> vec4<f32>\n    {\n        var N: vec3<f32> = normalize(localPos);\n        var R: vec3<f32> = N;\n        var V: vec3<f32> = R;\n    \n        let SAMPLE_COUNT:u32 = 1024u;\n        var totalWeight:f32 = 0.0;\n        var prefilteredColor:vec3<f32> = vec3<f32>(0.0, 0.0, 0.0);\n        for(var i:u32 = 0u; i < SAMPLE_COUNT; i = i + 1u)\n        {\n            var Xi:vec2<f32> = hammersley(i, SAMPLE_COUNT);\n            var H :vec3<f32> = ImportanceSampleGGX(Xi, N, roughness);\n            var L :vec3<f32> = normalize(2.0 * dot(V, H) * H - V);\n    \n            var NdotL:f32 = max(dot(N, L), 0.0);\n            if(NdotL > 0.0)\n            {\n                var att = 1.0 ;//( f32(SAMPLE_COUNT - i) / f32(SAMPLE_COUNT)) ;\n    \n                prefilteredColor = prefilteredColor + sampleColor(L).rgb * NdotL;\n                prefilteredColor = prefilteredColor * att ;\n                totalWeight      = totalWeight + NdotL;\n            }\n        }\n        prefilteredColor = prefilteredColor / totalWeight;\n    \n        return vec4<f32>(prefilteredColor, 1.0);\n    }\n    \n    fn SampleSphericalMap(v: vec3<f32>) -> vec2<f32> {\n        var uv:vec2<f32> = vec2<f32>(atan2(v.z, v.x), asin(v.y));\n        //uv = (uv * (vec2<f32>(0.1590999960899353, 0.3183000087738037) + vec2<f32>(0.0010000000474974513)));\n        uv = uv * vec2<f32>(0.1590999960899353, 0.3183000087738037);\n        uv = uv + vec2<f32>(0.5);\n        uv = clamp(uv, vec2<f32>(0.0), vec2<f32>(1.0));\n        return uv;\n    }\n    \n    fn sampleColor(d:vec3<f32>) -> vec4<f32>\n    {\n        let uv_f32:vec2<f32> = SampleSphericalMap(d);\n        let oc = textureSampleLevel(inputTex, inputTexSampler, uv_f32 , 0.0);\n        //let dir = vec3<f32>(-d.x, -d.y, d.z);\n        //var oc:vec4<f32> = textureSampleLevel(cubeMap, cubeMapSampler, dir, 0.0);\n        return oc;\n    }\n    \n    @compute @workgroup_size(8, 8, 1)\n    fn main(@builtin(global_invocation_id) GlobalInvocationID : vec3<u32>) {\n        let coord = vec2<i32>(GlobalInvocationID.xy);\n        let quaternion = faceRotation[GlobalInvocationID.z];\n        var worldDirection:vec3<f32> = convertIdToDir3(coord, quaternion);\n        var oc:vec4<f32> = multiSample(worldDirection, blurSetting.x);\n        textureStore(outputBuffer0, coord, i32(GlobalInvocationID.z), oc);\n    }\n\n"}),entryPoint:"main"}})),this.pipeline);if(this.configBuffer||(this.configBuffer=i.createBuffer({size:16,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST})),i.queue.writeBuffer(this.configBuffer,0,new Uint32Array([e.width,e.height,t,t])),!this.quaternionBuffer){this.quaternionBuffer=i.createBuffer({size:576,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST});var s=new Float32Array(24);for(let e=0;e<6;e++){var o=cue.getRotationToFace(e);s[4*e+0]=o.x,s[4*e+1]=o.y,s[4*e+2]=o.z,s[4*e+3]=o.w}i.queue.writeBuffer(this.quaternionBuffer,0,s)}this.blurSettingBuffer||(this.blurSettingBuffer=i.createBuffer({size:16,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST})),i.queue.writeBuffer(this.blurSettingBuffer,0,new Float32Array([n,0,0,0])),n=e.erpTexture,e=[{binding:0,resource:{buffer:this.configBuffer,size:16}},{binding:1,resource:{buffer:this.quaternionBuffer,size:96}},{binding:2,resource:n.gpuSampler},{binding:3,resource:n.getGPUView()}],n=[{binding:0,resource:{buffer:this.blurSettingBuffer,size:16}},{binding:1,resource:r}],r=i.createBindGroup({layout:a.getBindGroupLayout(0),entries:e}),e=i.createBindGroup({layout:a.getBindGroupLayout(1),entries:n}),(n=(i=roe.beginCommandEncoder()).beginComputePass()).setPipeline(a),n.setBindGroup(0,r),n.setBindGroup(1,e),n.dispatchWorkgroups(t/8,t/8,6),n.end(),roe.endCommandEncoder(i)}}bre(bue,"configBuffer",null),bre(bue,"quaternionBuffer",null),bre(bue,"blurSettingBuffer",null),bre(bue,"pipeline");class xue{constructor(e){bre(this,"faceTextureRef"),bre(this,"_texture"),this._texture=e,this.faceTextureRef={}}uploadTexture(e,t){return e=this.getGpuSource(e),hue.makeTextureCube(t,this._texture.width,e.v),this}uploadErpTexture(e){var t=this.getGpuSource(0);return hue.makeTextureCube(e,this._texture.width,t.v),this.generateMipmap(e),this}getGpuSource(e){let t=this.faceTextureRef[e];return t||(t={t:this._texture.getGPUTexture(),v:this._texture.getGPUTexture().createView({format:this._texture.format,dimension:"2d-array",baseMipLevel:e,mipLevelCount:1,arrayLayerCount:6})},this.faceTextureRef[e]=t),t}generateMipmap(e){let t=1;for(;t<this._texture.mipmapCount;)this.generateMipmapAtLevel(t,e),t++}generateMipmapAtLevel(e,t,n=3){var r=this._texture.width/Math.pow(2,e),i=(t={width:r,height:r,erpTexture:t},(e+1)/this._texture.mipmapCount);i=Math.pow(i,n),n=this.getGpuSource(e);bue.importantSample(t,r,i,n.v)}}class wue extends aue{constructor(){super(),bre(this,"_url"),bre(this,"_faceData"),this.useMipmap=!0,this.format=die,this.isHDRTexture=!0,this._faceData=new xue(this)}createFromHDRData(e,t){var n=new boe(t.width,t.height,die,!1,GPUTextureUsage.STORAGE_BINDING|GPUTextureUsage.TEXTURE_BINDING);t=new Float32Array(t.array);return hue.convertRGBE2RGBA(n,t),this.createFromTexture(e,n),this}createFromTexture(e,t){this.width=this.height=e,this.textureBindingLayout.viewDimension="cube";let n=this.width;for(this.mipmapCount=1;16<n;)n/=2,this.mipmapCount++;return this.createTextureDescriptor(e,e,this.mipmapCount,this.format),this.textureDescriptor.size={width:e,height:e,depthOrArrayLayers:6},this.textureDescriptor.dimension="2d",this.gpuSampler=Dre.device.createSampler(this),this._faceData.uploadErpTexture(t),this}async load(e,t){return this._url=e,(await(new vle).load(e,_ue,t)).getCubeTexture()}}class Sue{constructor(e,t,n,r){bre(this,"buffer"),bre(this,"binOffset"),bre(this,"binLength"),bre(this,"header"),this.buffer=e,this.binOffset=t+n,this.binLength=r;let i=null;i=0!==n?(r=new Uint8Array(e,t,n),JSON.parse(function(e){return(new TextDecoder).decode(e)}(r))):{},this.header=i}getKeys(){return Object.keys(this.header)}getData(e,t,n=null,r=null){var i=this.header;if(!(e in i))return null;if((i=i[e])instanceof Object){if(Array.isArray(i))return i;{var{buffer:a,binOffset:s,binLength:o}=this,l=i.byteOffset||0,u=i.type||r;n=i.componentType||n;if("type"in i&&r&&i.type!==r)throw new Error("FeatureTable: Specified type does not match expected type.");let h,p;switch(u){case"SCALAR":h=1;break;case"VEC2":h=2;break;case"VEC3":h=3;break;case"VEC4":h=4;break;default:throw new Error(`FeatureTable : Feature type not provided for "${e}".`)}var c=s+l,d=t*h;switch(n){case"BYTE":p=new Int8Array(a,c,d);break;case"UNSIGNED_BYTE":p=new Uint8Array(a,c,d);break;case"SHORT":p=new Int16Array(a,c,d);break;case"UNSIGNED_SHORT":p=new Uint16Array(a,c,d);break;case"INT":p=new Int32Array(a,c,d);break;case"UNSIGNED_INT":p=new Uint32Array(a,c,d);break;case"FLOAT":p=new Float32Array(a,c,d);break;case"DOUBLE":p=new Float64Array(a,c,d);break;default:throw new Error(`FeatureTable : Feature component type not provided for "${e}".`)}if(c+d*p.BYTES_PER_ELEMENT>s+o)throw new Error("FeatureTable: Feature data read outside binary body length.");return p}}return i}}class Cue extends Sue{constructor(e,t,n,r,i){super(e,n,r,i),bre(this,"batchSize"),this.batchSize=t}getData(e,t=null,n=null){return super.getData(e,this.batchSize,t,n)}}function Tue(e){let t;if(t=e instanceof DataView?e:new DataView(e),"{"===String.fromCharCode(t.getUint8(0)))return null;let n="";for(let r=0;r<4;r++)n+=String.fromCharCode(t.getUint8(r));return n}class Mue{async parse(e){var t=Tue(s=new DataView(e)),n=(t=(console.assert("b3dm"===t),s.getUint32(4,!0)),console.assert(1===t),s.getUint32(8,!0)),r=(console.assert(n===e.byteLength),s.getUint32(12,!0)),i=s.getUint32(16,!0),a=s.getUint32(20,!0),s=s.getUint32(24,!0),o=new Sue(e,28,r,i);r=28+r+i,i=new Cue(e,o.getData("BATCH_LENGTH"),r,a,s),r=r+a+s;return{version:t,featureTable:o,batchTable:i,glbBytes:new Uint8Array(e,r,n-r)}}}const Eue=class extends Mue{constructor(){super(),bre(this,"adjustmentTransform"),bre(this,"gltfBuffer"),this.adjustmentTransform=(new Kie).identity(),Eue.tempMatrix||(Eue.tempMatrix=(new Kie).identity())}async parse(e){e=await super.parse(e);var t,n=(this.gltfBuffer=e.glbBytes.slice().buffer,await(new Oue).parseBinary(this.gltfBuffer)),{batchTable:e,featureTable:r}=e,i=((i=((t=((t=r.getData("RTC_CENTER"))&&(n.x+=t[0],n.y+=t[1],n.z+=t[2]),n.getComponent(pae))).updateWorldMatrix(),Eue.tempMatrix)).compose(t.localPosition,t.localRotQuat,t.localScale),i.multiply(this.adjustmentTransform),i.decompose(Fie.QUATERNION));return t.localRotQuat.copyFrom(i[1]),t.localRotQuat=t.localRotQuat,t.localPosition.copyFrom(i[0]),t.localPosition=t.localPosition,t.localScale.copyFrom(i[2]),t.localScale=t.localScale,t.updateWorldMatrix(),n.batchTable=e,n.featureTable=r,n}static decodeText(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let t="";for(let n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch{return t}}};let Aue=Eue;bre(Aue,"tempMatrix");class Pue extends yle{async parseBuffer(e){var t=new Aue;t.adjustmentTransform=this.userData,this.data=await t.parse(e)}verification(){if(this.data)return!0;throw new Error("Method not implemented.")}}bre(Pue,"format","bin");const Rue="glTF",Lue=1313821514,kue=5130562,Due="KHR_binary_glTF";class Iue{constructor(e){bre(this,"name"),bre(this,"content"),bre(this,"body"),bre(this,"header"),this.name=Due,this.content=null,this.body=null;var t=new DataView(e,0,12);if(this.header={magic:Aue.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==Rue)throw new Error("GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("GLTFLoader: Legacy binary file detected.");var n=this.header.length-12,r=new DataView(e,12);let i=0;for(;i<n;){var a,s=r.getUint32(i,!0),o=(i+=4,r.getUint32(i,!0));i+=4,o===Lue?(a=new Uint8Array(e,12+i,s),this.content=Aue.decodeText(a)):o===kue&&(a=12+i,this.body=e.slice(a,a+s)),i+=s}if(null===this.content)throw new Error("GLTFLoader: JSON content not found.")}}class Oue{constructor(){bre(this,"_binary")}async parseBinary(e){let t,n;if(this._binary=e,e={},Aue.decodeText(new Uint8Array(this._binary,0,4))===Rue){try{n=e[Due]=new Iue(this._binary)}catch{return}t=e[Due].content}else t=Aue.decodeText(new Uint8Array(this._binary));return e=JSON.parse(t),this.parseGLB(e,n.body)}async parseGLB(e,t){return(new nue).parseJsonAndBuffer(e,t)}}class Nue{async parse(e){var t=Tue(o=new DataView(e)),n=(t=(console.assert("i3dm"===t),o.getUint32(4,!0)),console.assert(1===t),o.getUint32(8,!0)),r=(console.assert(n===e.byteLength),o.getUint32(12,!0)),i=o.getUint32(16,!0),a=o.getUint32(20,!0),s=o.getUint32(24,!0),o=(o.getUint32(28,!0),new Sue(e,32,r,i));r=32+r+i,i=new Cue(e,o.getData("INSTANCES_LENGTH"),r,a,s),r=r+a+s;return{version:t,featureTable:o,batchTable:i,glbBytes:new Uint8Array(e,r,n-r)}}}class Bue extends bae{constructor(e,t,n){super(),bre(this,"_geometry"),bre(this,"_material"),bre(this,"_instanceList"),this._geometry=e,this._material=t,this._instanceList=[];for(let a=0;a<n;a++){var r=new bae,i=r.addComponent(soe);i.geometry=this._geometry,i.material=this._material,this.addChild(r),this._instanceList.push(r)}}setMatrixAt(e,t){return e=this._instanceList[e],t=t.decompose(Fie.QUATERNION),(e=e.transform).localRotQuat.copyFrom(t[1]),e.localRotQuat=e.localRotQuat,e.localPosition.copyFrom(t[0]),e.localPosition=e.localPosition,e.localScale.copyFrom(t[2]),e.localScale=e.localScale,this}}const Uue=class extends Nue{constructor(){super(),bre(this,"adjustmentTransform"),bre(this,"_gltfBuffer"),this.adjustmentTransform=(new Kie).identity()}async parse(e){e=await super.parse(e);var t=(this._gltfBuffer=e.glbBytes.slice().buffer,await(new Oue).parseBinary(this._gltfBuffer)),{batchTable:e,featureTable:n}=e;const r=this.adjustmentTransform,i=n.getData("INSTANCES_LENGTH"),a=n.getData("POSITION",i,"FLOAT","VEC3"),s=n.getData("NORMAL_UP",i,"FLOAT","VEC3"),o=n.getData("NORMAL_RIGHT",i,"FLOAT","VEC3"),l=n.getData("SCALE_NON_UNIFORM",i,"FLOAT","VEC3"),u=n.getData("SCALE",i,"FLOAT","SCALAR"),c=new Map,d=[],h=(t.traverse((e=>{var t,n;(n=e?e.getComponent(soe):null)&&(({geometry:n,material:t}=n),(n=new Bue(n,t,i)).localPosition=n.localPosition.copy(e.localPosition),n.localRotation=n.localRotation.copy(e.localRotation),n.localScale=n.localScale.copy(e.localScale),d.push(n),c.set(e,n))})),new Rre);for(let f=0;f<i;f++)h.x+=a[3*f+0]/i,h.y+=a[3*f+1]/i,h.z+=a[3*f+2]/i;c.forEach(((e,t)=>{var n=t.parent?t.parentObject:null;n&&(n.removeChild(t),n.addChild(e),e.transform.updateWorldMatrix(),e.transform.worldMatrix.transformVector4(h,e.localPosition))}));var p=Uue;for(let f=0;f<i;f++){p.tempMat.identity(),p.tempPos.set(a[3*f+0]-h.x,a[3*f+1]-h.y,a[3*f+2]-h.z),s?(p.tempUp.set(s[3*f+0],s[3*f+1],s[3*f+2]),p.tempRight.set(o[3*f+0],o[3*f+1],o[3*f+2]),p.tempRight.cross(p.tempUp,p.tempFwd).normalize(),p.tempMat.makeBasis(p.tempRight,p.tempUp,p.tempFwd),p.tempQuat.setFromRotationMatrix(p.tempMat)):p.tempQuat.set(0,0,0,1),u?p.tempSca.setScalar(u[f]):l?p.tempSca.set(l[3*f+0],l[3*f+1],l[3*f+2]):p.tempSca.set(1,1,1),p.tempMat.compose(p.tempPos,p.tempQuat,p.tempSca),p.tempMat.multiplyMatrices(p.tempMat,r);for(let e=0,t=d.length;e<t;e++)d[e].setMatrixAt(f,p.tempMat)}return t.batchTable=e,t.featureTable=n,t}};let zue=Uue;bre(zue,"tempFwd",new Rre),bre(zue,"tempUp",new Rre),bre(zue,"tempRight",new Rre),bre(zue,"tempPos",new Rre),bre(zue,"tempQuat",new Gie),bre(zue,"tempSca",new Rre),bre(zue,"tempMat",new Kie);class Fue extends yle{async parseBuffer(e){var t=new zue;t.adjustmentTransform=this.userData,this.data=await t.parse(e)}verification(){if(this.data)return!0;throw new Error("Method not implemented.")}}bre(Fue,"format","bin");class Vue extends aue{constructor(){super(),bre(this,"_faceData"),bre(this,"_url"),this.useMipmap=!0,this.format=die,this._faceData=new xue(this)}get ldrImageUrl(){return this._url}async load(e,t){this._url=e;var n=new mle(!1);return await n.load(e,t),this.createFromLDRTexture(n),this}createFromLDRTexture(e){var t=Math.log2(e.width/4);t=Math.pow(2,Math.round(t));return this.createFromTexture(t,e),this}createFromTexture(e,t){this.width=this.height=e,this.textureBindingLayout.viewDimension="cube";let n=this.width;for(this.mipmapCount=1;16<n;)n/=2,this.mipmapCount++;return this.createTextureDescriptor(e,e,this.mipmapCount,this.format),this.textureDescriptor.size={width:e,height:e,depthOrArrayLayers:6},this.textureDescriptor.dimension="2d",this.gpuSampler=Dre.device.createSampler(this),this._faceData.uploadErpTexture(t),this}}class Gue{constructor(){bre(this,"compute"),this.compute=new Uie("\nvar<private>PI: f32 = 3.141592653589793;\n\n// fn saturate( x : f32 ) -> f32 {\n//     return clamp(x, 0.0, 1.0);\n// }\n\nfn hammersley(i : u32, N : u32) -> vec2<f32>\n{\n    // Radical inverse based on http://holger.dammertz.org/stuff/notes_HammersleyOnHemisphere.html\n    var bits = (i << 16u) | (i >> 16u);\n    bits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);\n    bits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);\n    bits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);\n    bits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);\n    var rdi = f32(bits) * 2.3283064365386963e-10;\n    return vec2<f32>(f32(i) / f32(N), rdi);\n}\n\nfn G_Smith(NoV: f32, NoL : f32, roughness : f32) -> f32\n{\n    var k = (roughness * roughness) / 2.0;\n    var GGXL = NoL / (NoL * (1.0 - k) + k);\n    var GGXV = NoV / (NoV * (1.0 - k) + k);\n    return GGXL * GGXV;\n}\n\nfn V_SmithGGXCorrelated(NoV: f32, NoL : f32, roughness : f32) -> f32\n{\n    var a2 = pow(roughness, 4.0);\n    var GGXV = NoL * sqrt(NoV * NoV * (1.0 - a2) + a2);\n    var GGXL = NoV * sqrt(NoL * NoL * (1.0 - a2) + a2);\n    return 0.5 / (GGXV + GGXL);\n}\n\n\n// Based on Karis 2014\nfn importanceSampleGGX(Xi: vec2<f32>, roughness: f32, N: vec3<f32>) -> vec3<f32>\n{\n    var a = roughness * roughness;\n    // Sample in spherical coordinates\n    var Phi = 2.0 * PI * Xi.x;\n    var CosTheta = sqrt((1.0 - Xi.y) / (1.0 + (a * a - 1.0) * Xi.y));\n    var SinTheta = sqrt(1.0 - CosTheta * CosTheta);\n    // Construct tangent space vector\n    var H: vec3<f32>;\n    H.x = SinTheta * cos(Phi);\n    H.y = SinTheta * sin(Phi);\n    H.z = CosTheta;\n\n    // Tangent to world space\n    var UpVector = vec3<f32>(1.0, 0.0, 0.0);\n    if (abs(N.z) < 0.999) {\n        UpVector = vec3<f32>(0.0, 0.0, 1.0);\n    }\n    var TangentX = normalize(cross(UpVector, N));\n    var TangentY = cross(N, TangentX);\n    return TangentX * H.x + TangentY * H.y + N * H.z;\n}\n\n\n// Karis 2014\nfn integrateBRDF(roughness: f32, NoV: f32) -> vec2<f32>\n{\n    var V: vec3<f32>;\n    V.x = sqrt(1.0 - NoV * NoV); // sin\n    V.y = 0.0;\n    V.z = NoV; // cos\n\n    // N points straight upwards for this integration\n    var N = vec3<f32>(0.0, 0.0, 1.0);\n\n    var A = 0.0;\n    var B = 0.0;\n    var numSamples = 1024u;\n\n    for (var i = 0u; i < numSamples; i += 1u) {\n        var Xi = hammersley(i, numSamples);\n        // Sample microfacet direction\n        var H = importanceSampleGGX(Xi, roughness, N);\n\n        // Get the light direction\n        var L = 2.0 * dot(V, H) * H - V;\n\n        var NoL = saturate(dot(N, L));\n        var NoH = saturate(dot(N, H));\n        var VoH = saturate(dot(V, H));\n\n        if (NoL > 0.0) {\n            var V_pdf = V_SmithGGXCorrelated(NoV, NoL, roughness) * VoH * NoL / NoH;\n            var Fc = pow(1.0 - VoH, 5.0);\n            A += (1.0 - Fc) * V_pdf;\n            B += Fc * V_pdf;\n        }\n    }\n\n    return 4.0 * vec2<f32>(A, B) / f32(numSamples);\n}\n\n@group(0) @binding(0) var brdflutTexture: texture_storage_2d<rgba8unorm, write>;\n@compute @workgroup_size(8, 8, 1)\n// fn CsMain( @builtin(workgroup_id) workgroup_id : vec3<u32> , @builtin(local_invocation_id) local_invocation_id : vec3<u32> ){\nfn CsMain(@builtin(global_invocation_id) global_invocation_id : vec3<u32>){\n    var fragCoord = vec2<u32>(global_invocation_id.x, global_invocation_id.y);\n\n    var fragColor = vec4<f32>(0.0);\n    // Output to screen\n    var res = integrateBRDF(f32(fragCoord.y + 1u) / 256.0, f32(fragCoord.x + 1u) / 256.0);\n    fragColor = vec4<f32>(res.x, res.y, 0.0, 1.0);\n\n    textureStore(brdflutTexture, vec2<i32>(fragCoord.xy), fragColor);\n}\n")}generateBRDFLUTTexture(){var e=new boe(256,256,oie,!1,GPUTextureUsage.STORAGE_BINDING|GPUTextureUsage.TEXTURE_BINDING),t=(this.compute.setStorageTexture("brdflutTexture",e),this.compute.workerSizeX=32,this.compute.workerSizeY=32,roe.beginCommandEncoder());return roe.computeCommand(t,[this.compute]),roe.endCommandEncoder(t),e}}class Hue extends kae{constructor(){super(...arguments),bre(this,"_dataBuffer")}create(e,t,n,r=!1){var i=Dre.device,a=256*Math.ceil(4*e/256),s=(this.format=oie,this.mipmapCount=Math.floor(r?Math.log2(e):1),this.createTextureDescriptor(e,t,this.mipmapCount,this.format),this._dataBuffer=i.createBuffer({size:n.byteLength,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.COPY_SRC}));return(i=(i.queue.writeBuffer(s,0,n),roe.beginCommandEncoder())).copyBufferToTexture({buffer:s,bytesPerRow:a},{texture:this.getGPUTexture()},{width:e,height:t,depthOrArrayLayers:1}),roe.endCommandEncoder(i),r&&Lae.webGPUGenerateMipmap(this),this}updateTexture(e,t,n){var r=Dre.device,i=256*Math.ceil(4*e/256),a=(this.mipmapCount=Math.floor(Math.log2(e)),this._dataBuffer&&this._dataBuffer.destroy(),this._dataBuffer=null,this._dataBuffer=r.createBuffer({size:n.byteLength,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.COPY_SRC}));(n=(r.queue.writeBuffer(a,0,n),roe.beginCommandEncoder())).copyBufferToTexture({buffer:a,bytesPerRow:i},{texture:this.getGPUTexture()},{width:e,height:t,depthOrArrayLayers:1}),roe.endCommandEncoder(n),this.gpuSampler=r.createSampler(this),1<this.mipmapCount&&Lae.webGPUGenerateMipmap(this)}}class jue{constructor(e){bre(this,"id"),bre(this,"guiTexture"),bre(this,"uvRec",new $re(0,0,1,1)),bre(this,"uvBorder",new $re(0,0,0,0)),bre(this,"offsetSize",new $re(0,0,4,4)),bre(this,"borderSize",new $re(0,0,0,0)),bre(this,"trimSize",new Wre),bre(this,"isSliced",!1),bre(this,"height",4),bre(this,"width",4),bre(this,"xadvance",0),bre(this,"xoffset",0),bre(this,"yoffset",0),this.guiTexture=e||nce.res.defaultGUITexture}}const Wue=class{constructor(e){bre(this,"_staticId",-1),bre(this,"dynamicId",-1),bre(this,"texture"),bre(this,"width",1),bre(this,"height",1),e=e||nce.res.whiteTexture,this.texture=e,Wue._maxUid++,this._staticId=Wue._maxUid,this.init()}get staticId(){return this._staticId}init(){this.dynamicId=-1,this.width=this.texture.width,this.height=this.texture.height}};let Yue=Wue;bre(Yue,"_maxUid",-1);let $ue=new class{constructor(){bre(this,"fntCache",{}),bre(this,"fntData",{})}addFontData(e,t,n){this.fntData[""+e+t]=n}getFontData(e,t){return this.fntData[""+e+t]}addFnt(e,t,n,r){e=""+e+t,this.fntCache[e]||(this.fntCache[e]={}),this.fntCache[e][n]=r}getFnt(e,t,n){return(e=this.fntCache[""+e+t])?e[n]:this.fntCache[" "]}};class Xue{constructor(){bre(this,"face",""),bre(this,"size",0),bre(this,"bold",!1),bre(this,"italic",!1),bre(this,"stretchH",0),bre(this,"spacing",""),bre(this,"outline",0),bre(this,"lineHeight",0),bre(this,"base",0),bre(this,"scaleW",0),bre(this,"scaleH",0),bre(this,"pages",0),bre(this,"packed",0),bre(this,"alphaChnl",0),bre(this,"redChnl",0),bre(this,"greenChnl",0),bre(this,"blueChnl",0),bre(this,"count",0),bre(this,"fontPage",[]),bre(this,"fontChar",{})}}class que{constructor(){bre(this,"id",0),bre(this,"file","")}}class Kue{constructor(){bre(this,"id",-1),bre(this,"x",0),bre(this,"y",0),bre(this,"width",0),bre(this,"height",0),bre(this,"xoffset",0),bre(this,"yoffset",0),bre(this,"xadvance",0),bre(this,"page",0),bre(this,"chnl",0)}}const Zue=class extends yle{static parseSprite(e,t){for(const i in t.fontChar){var n,r;Object.prototype.hasOwnProperty.call(t.fontChar,i)&&(n=t.fontChar[i],(r=new jue).id=n.id.toString(),r.offsetSize.set(0,0,n.width,n.height),r.trimSize.set(n.width,n.height),r.width=n.width,r.height=n.height,r.xadvance=n.xadvance,r.xoffset=n.xoffset,r.yoffset=n.yoffset,r.guiTexture=e[n.page],r.uvRec.set(n.x/t.scaleW,(t.scaleH-(n.y+n.height))/t.scaleH,n.width/t.scaleW,n.height/t.scaleH),$ue.addFnt(t.face,t.size,r.id,r))}}verification(){if(this.data)return!0;throw new Error("Method not implemented.")}async parseString(e){let t=this.getNewLine(e),n=e,r=new Xue;n.trim().split(t).forEach(((e,t)=>{var n;t<2?Zue.readLineProperty(e,r):t<r.pages+2?(n=new que,Zue.readLineProperty(e,n),r.fontPage.push(n)):t<r.pages+3?Zue.readLineProperty(e,r):0<r.count&&(n=new Kue,Zue.readLineProperty(e,n),r.fontChar[n.id]=n,r.count--)})),n="",this.data=r,await this.loadFontTextures()}getNewLine(e){return-1!=e.indexOf("\r\n")?"\r\n":-1!=e.indexOf("\r")?"\r":"\n"}async loadFontTextures(){var e=[],t=this.data;for(const r of t.fontPage){var n=this.baseUrl+r.file;n=(await nce.res.loadTexture(n,null,!0),nce.res.getTexture(n)),n=new Yue(n);e.push(n)}Zue.parseSprite(e,t),t.fontChar[" "]||Zue.insertSpaceChar(t,e[0])}static insertSpaceChar(e,t){var n=new jue,r=.5*e.size,i=.5*e.lineHeight;n.id=" ",n.offsetSize.set(0,0,e.size,e.size),n.trimSize.set(r,i),n.width=r,n.height=i,n.xadvance=0,n.xoffset=0,n.yoffset=0,n.guiTexture=t,n.uvRec.set(0,0,1e-6,1e-6),$ue.addFnt(e.face,e.size,n.id,n)}static readLineProperty(e,t){e.trim().split(" ").forEach(((e,n)=>{var r,i;1<(e=e.split("=")).length&&(r=e[0],i=e[1],Object.prototype.hasOwnProperty.call(t,r))&&(-1==i.indexOf('"')?t[r]=parseFloat(e[1]):t[r]=i.replace('"',"").replace('"',""))}))}};let Jue=Zue;bre(Jue,"format","text");class Que{constructor(e){bre(this,"_spriteMap",new Map),bre(this,"_spriteList",[]),bre(this,"textureSize",new Wre),bre(this,"name"),this.textureSize.set(e.x,e.y)}setTexture(e,t,n){return e=function(e,t,n){var r=new jue;return r.guiTexture=e,r.id=t,r.uvRec.copyFrom(n.textureRect),r.trimSize.x=n.textureRect.z,r.trimSize.y=n.textureRect.w,r.offsetSize.x=n.textureRectOffset.x,r.offsetSize.y=n.textureRectOffset.y,r.offsetSize.z=n.size.x,r.offsetSize.w=n.size.y,r.width=n.size.x,r.height=n.size.y,t=1/e.width,e=1/e.height,r.uvRec.set(r.uvRec.x*t,r.uvRec.y*e,r.uvRec.z*t,r.uvRec.w*e),n.border.x<=.1&&n.border.y<=.1&&n.border.z<=.1&&n.border.x<=.1?r.isSliced=!1:(r.borderSize.copyFrom(n.border),r.uvBorder.copyFrom(n.border),r.uvBorder.x-=n.textureRectOffset.x,r.uvBorder.y-=n.textureRectOffset.y,r.uvBorder.z=n.border.z-(n.size.x-n.textureRect.z-n.textureRectOffset.x),r.uvBorder.w=n.border.w-(n.size.y-n.textureRect.w-n.textureRectOffset.y),r.uvBorder.x/=n.textureRect.z,r.uvBorder.z/=n.textureRect.z,r.uvBorder.y/=n.textureRect.w,r.uvBorder.w/=n.textureRect.w,r.isSliced=!0),r}(e,t,n),this._spriteMap.set(e.id,e),this._spriteList.push(e),e}getSprite(e){return this._spriteMap.get(e)}get spriteList(){return this._spriteList}}class ece extends yle{constructor(){super(...arguments),bre(this,"_json"),bre(this,"_texture")}async parseString(e){this._json=JSON.parse(e),e=this.userData.replace(".json",".png"),this._texture=await nce.res.loadTexture(e,null,!0),this.data={json:this._json,texture:this._texture},this.parseAtlas()}verification(){if(this.data)return!0;throw new Error("verify failed.")}parseAtlas(){var e=new Que(this._json.size),t=new Yue(this._texture),n=this._json.atlas;for(const r in n)e.setTexture(t,r,n[r]);nce.res.addAtlas(this.baseUrl,e),this.data=e}}bre(ece,"format","text");class tce{constructor(){bre(this,"_texturePool"),bre(this,"_materialPool"),bre(this,"_prefabPool"),bre(this,"_gltfPool"),bre(this,"_atlasList"),bre(this,"normalTexture"),bre(this,"maskTexture"),bre(this,"whiteTexture"),bre(this,"blackTexture"),bre(this,"redTexture"),bre(this,"blueTexture"),bre(this,"greenTexture"),bre(this,"yellowTexture"),bre(this,"grayTexture"),bre(this,"defaultSky"),bre(this,"defaultGUITexture"),bre(this,"defaultGUISprite"),this._texturePool=new Map,this._materialPool=new Map,this._prefabPool=new Map,this._gltfPool=new Map,this._atlasList=new Map,this.initDefault()}getGltf(e){return this._gltfPool.get(e)}addTexture(e,t){this._texturePool.set(e,t)}getTexture(e){return this._texturePool.get(e)}addMat(e,t){return this._materialPool.set(e,t)}getMat(e){return this._materialPool.get(e)}addPrefab(e,t){this._prefabPool.set(e,t)}getPrefab(e){return this._prefabPool.get(e).instantiate()}addAtlas(e,t){t.name=e,this._atlasList.set(e,t)}getAtlas(e){return this._atlasList.get(e)}getGUISprite(e){for(var t of this._atlasList.values())if(t=t.getSprite(e))return t;return null}async loadGltf(e,t){if(this._prefabPool.has(e))return this._prefabPool.get(e);let n,r=e.substring(e.lastIndexOf(".")).toLowerCase(),i=new vle;return t=(n=".gltf"==r?await i.load(e,Mle,t):await i.load(e,nue,t)).data,this._prefabPool.set(e,t),this._gltfPool.set(e,n.gltf),t}async loadObj(e,t){if(this._prefabPool.has(e))return this._prefabPool.get(e);let n,r=e.substring(e.lastIndexOf(".")).toLowerCase(),i=new vle;return t=(n=".obj"==r?await i.load(e,rue,t):n).data,this._prefabPool.set(e,t),t}async loadB3DM(e,t,n){return this._prefabPool.has(e)?this._prefabPool.get(e):(t=(await(new vle).load(e,Pue,t,n)).data,this._prefabPool.set(e,t),t)}async loadI3DM(e,t,n){return this._prefabPool.has(e)?this._prefabPool.get(e):(t=(await(new vle).load(e,Fue,t,n)).data,this._prefabPool.set(e,t),t)}async loadTexture(e,t,n){var r;return this._texturePool.has(e)?this._texturePool.get(e):((r=new mle).flipY=n,await r.load(e,t),this._texturePool.set(e,r),r)}async loadHDRTexture(e,t){if(this._texturePool.has(e))return this._texturePool.get(e);let n=new pue;return n=await n.load(e,t),this._texturePool.set(e,n),n}async loadHDRTextureCube(e,t){if(this._texturePool.has(e))return this._texturePool.get(e);let n=new wue;return n=await n.load(e,t),this._texturePool.set(e,n),n}async loadLDRTextureCube(e,t){if(this._texturePool.has(e))return this._texturePool.get(e);let n=new Vue;return n=await n.load(e,t),this._texturePool.set(e,n),n}async loadTextureCubeMaps(e){var t=e[0];return this._texturePool.has(t)?this._texturePool.get(t):(await(t=new lue).load(e),this._texturePool.set(e[0],t),t)}async loadTextureCubeStd(e,t){var n;return this._texturePool.has(e)?this._texturePool.get(e):(await(n=new lue).loadStd(e),n)}async loadJSON(e,t){return(new vle).loadJson(e,t).then((async e=>e)).catch((e=>{console.log(e)}))}async loadFont(e,t,n){return t=(e=await(new vle).load(e,Jue,t,n)).data,$ue.addFontData(t.face,t.size,t),e.data}async loadAtlas(e,t){return(await(new vle).load(e,ece,t,e)).data}createTexture(e,t,n,r,i,a,s){var o=new Uint8Array(4096);return(e=(this.fillColor(o,e,t,n,r,i,a),new Hue)).name=s,e.create(16,16,o,!0),s&&this.addTexture(s,e),e}fillColor(e,t,n,r,i,a,s){for(let l=0;l<t;l++)for(let u=0;u<n;u++){var o=u*t+l;e[4*o+0]=r,e[4*o+1]=i,e[4*o+2]=a,e[4*o+3]=s}}initDefault(){this.normalTexture=this.createTexture(32,32,127.5,127.5,255,255,"default-normalTexture"),this.maskTexture=this.createTexture(32,32,255,127.5,0,255,"default-maskTexture"),this.whiteTexture=this.createTexture(32,32,255,255,255,255,"default-whiteTexture"),this.blackTexture=this.createTexture(32,32,0,0,0,255,"default-blackTexture"),this.redTexture=this.createTexture(32,32,255,0,0,255,"default-redTexture"),this.blueTexture=this.createTexture(32,32,0,0,255,255,"default-blueTexture"),this.greenTexture=this.createTexture(32,32,0,255,0,255,"default-greenTexture"),this.yellowTexture=this.createTexture(32,32,0,255,255,255,"default-yellowTexture"),this.grayTexture=this.createTexture(32,32,128,128,128,255,"default-grayTexture");var e=(new Gue).generateBRDFLUTTexture();e.name="BRDFLUT",this.addTexture("BRDFLUT",e),this.defaultSky=new wue,this.defaultSky.createFromTexture(128,this.blackTexture),Pse.getInstance().attached(this.defaultSky,this),Pse.getInstance().attached(e,this),Pse.getInstance().attached(this.normalTexture,this),Pse.getInstance().attached(this.maskTexture,this),Pse.getInstance().attached(this.whiteTexture,this),Pse.getInstance().attached(this.blackTexture,this),Pse.getInstance().attached(this.redTexture,this),Pse.getInstance().attached(this.blueTexture,this),Pse.getInstance().attached(this.greenTexture,this),Pse.getInstance().attached(this.yellowTexture,this),Pse.getInstance().attached(this.grayTexture,this),this.defaultGUITexture=new Yue(this.whiteTexture),this.defaultGUISprite=new jue(this.defaultGUITexture),this.defaultGUISprite.trimSize.set(4,4)}}class nce{static get frameRate(){return this._frameRate}static set frameRate(e){this._frameRate=e,this._frameRateValue=1/e,360<=e&&(this._frameRateValue=0)}static get size(){return Dre.presentationSize}static get aspect(){return Dre.aspect}static get width(){return Dre.windowWidth}static get height(){return Dre.windowHeight}static async init(e={}){console.log("Engine Version","0.6.6"),this.setting={...this.setting,...e.engineSetting},await Dre.init(e.canvasConfig),Hre.init(),Ese.init(),toe.init(),Coe.init(),Sae.init(),this.res=new tce,this._beforeRender=e.beforeRender,this._renderLoop=e.renderLoop,this._lateRender=e.lateRender,this.inputSystem=new kre,this.inputSystem.initCanvas(Dre.canvas)}static startRenderView(e){this.renderJobs||(this.renderJobs=new Map),this.views=[e];var t=new ele(e);return this.renderJobs.set(e,t),t.addPost(new Moe),t.start(),this.resume(),t}static startRenderViews(e){this.renderJobs||(this.renderJobs=new Map),this.views=e;for(let r=0;r<e.length;r++){var t=e[r],n=new ele(t);this.renderJobs.set(t,n),n.addPost(new Moe),n.start()}this.resume()}static getRenderJob(e){return this.renderJobs.get(e)}static pause(){0!=this._requestAnimationFrameID&&(cancelAnimationFrame(this._requestAnimationFrameID),this._requestAnimationFrameID=0)}static resume(){this._requestAnimationFrameID=requestAnimationFrame((e=>this.render(e)))}static render(e){this._deltaTime=e-this._time,this._time=e,0<this._frameRateValue?(this._frameTimeCount+=.001*this._deltaTime,this._frameTimeCount>=.95*this._frameRateValue&&(this._frameTimeCount=0,this.updateFrame(e))):this.updateFrame(e),this.resume()}static updateFrame(e){Sre.delta=e-Sre.time,Sre.time=e,Sre.frame+=1,ple.tick(Sre.delta),this._beforeRender&&this._beforeRender(),rae.componentsBeforeUpdateList.forEach(((e,t)=>{e.forEach(((e,n)=>{n.enable&&e(t)}))}));let t=Dre.device.createCommandEncoder();rae.componentsComputeList.forEach(((e,n)=>{e.forEach(((e,r)=>{r.enable&&e(n,t)}))})),Dre.device.queue.submit([t.finish()]),toe.modelMatrixBindGroup.writeBuffer(),rae.componentsUpdateList.forEach(((e,t)=>{e.forEach(((e,n)=>{n.enable&&e(t)}))})),this._renderLoop&&this._renderLoop(),this.renderJobs.forEach(((e,t)=>{e.renderFrame()})),rae.componentsLateUpdateList.forEach(((e,t)=>{e.forEach(((e,n)=>{n.enable&&e(t)}))})),this._lateRender&&this._lateRender()}}bre(nce,"res"),bre(nce,"inputSystem"),bre(nce,"views"),bre(nce,"_frameRateValue",0),bre(nce,"_frameRate",360),bre(nce,"_frameTimeCount",0),bre(nce,"_deltaTime",0),bre(nce,"_time",0),bre(nce,"_beforeRender"),bre(nce,"_renderLoop"),bre(nce,"_lateRender"),bre(nce,"_requestAnimationFrameID",0),bre(nce,"Engine3D"),bre(nce,"setting",{occlusionQuery:{enable:!0,debug:!1},pick:{enable:!0,mode:"bound",detail:"mesh"},render:{debug:!1,renderPassState:4,renderState_left:5,renderState_right:5,renderState_split:.5,quadScale:1,hdrExposure:1.5,debugQuad:-1,maxPointLight:1e3,maxDirectLight:4,maxSportLight:1e3,drawOpMin:0,drawOpMax:Number.MAX_SAFE_INTEGER,drawTrMin:0,drawTrMax:Number.MAX_SAFE_INTEGER,zPrePass:!1,gi:!1,postProcessing:{globalFog:{debug:!1,enable:!1,fogType:0,height:100,start:800,end:200,density:.02,ins:1,skyFactor:.5,skyRoughness:.4,overrideSkyFactor:.8,fogColor:new wre(112/255,61/255,139/255,1)},ssao:{enable:!1,radius:.15,bias:-.1,aoPower:2,debug:!0},outline:{enable:!1,strength:1,groupCount:4,outlinePixel:2,fadeOutlinePixel:4,useAddMode:!1,debug:!0},taa:{enable:!1,jitterSeedCount:8,blendFactor:.1,sharpFactor:.6,sharpPreBlurFactor:.5,temporalJitterScale:.13,debug:!0},gtao:{enable:!1,darkFactor:1,maxDistance:5,maxPixel:50,rayMarchSegment:6,multiBounce:!1,usePosFloat32:!0,blendColor:!0,debug:!0},ssr:{enable:!1,pixelRatio:1,fadeEdgeRatio:.2,rayMarchRatio:.5,fadeDistanceMin:600,fadeDistanceMax:2e3,roughnessThreshold:.5,powDotRN:.2,mixThreshold:.1,debug:!0},bloom:{enable:!1,blurX:4,blurY:4,strength:.25,radius:1.3,luminosityThreshold:.98,debug:!1},fxaa:{enable:!1},depthOfView:{enable:!1,iterationCount:3,pixelOffset:1,near:150,far:300}}},shadow:{enable:!0,type:"HARD",shadowBias:.00204,pointShadowBias:.002,shadowQuality:2.5,shadowBound:50,shadowSize:1024,pointShadowSize:1024,shadowSoft:.005,shadowNear:1,shadowFar:2e3,needUpdate:!0,autoUpdate:!0,updateFrameRate:2,debug:!1},gi:{enable:!1,offsetX:0,offsetY:0,offsetZ:0,probeSpace:64,probeXCount:4,probeYCount:2,probeZCount:4,probeSize:32,probeSourceTextureSize:2048,octRTMaxSize:2048,octRTSideSize:16,maxDistance:110.72,normalBias:.25,depthSharpness:1,hysteresis:.98,lerpHysteresis:.01,irradianceChebyshevBias:.01,rayNumber:144,irradianceDistanceBias:32,indirectIntensity:1,ddgiGamma:2.2,bounceIntensity:.025,probeRoughness:1,realTimeGI:!1,debug:!1,autoRenderProbe:!1},sky:{type:"HDRSKY",sky:null,skyExposure:1,defaultFar:65536,defaultNear:1},light:{maxLight:4096},material:{materialChannelDebug:!1,materialDebug:!1}}),bre(nce,"renderJobs");let rce='\n#include "Common_vert"\n#include "FragmentVarying"\n#include "GlobalUniform"\n\nstruct FragmentOutput {\n    @location(0) o_Position: vec4<f32>,\n    @location(1) o_Normal: vec4<f32>,\n    @location(2) o_Color: vec4<f32>\n};\n\nstruct MaterialUniform {\n    baseColor: vec4<f32>,\n    emissiveColor: vec4<f32>,\n    emissiveIntensity: f32,\n    normalScale: f32,\n    alphaCutoff: f32\n};\n\n@group(2) @binding(0)\nvar<uniform> materialUniform: MaterialUniform;\n\n@group(1) @binding(auto)\nvar baseMapSampler: sampler;\n@group(1) @binding(auto)\nvar baseMap: texture_2d<f32>;\n\n@group(1) @binding(auto)\nvar normalMapSampler: sampler;\n@group(1) @binding(auto)\nvar normalMap: texture_2d<f32>;\n\n@group(1) @binding(auto)\nvar emissiveMapSampler: sampler;\n@group(1) @binding(auto)\nvar emissiveMap: texture_2d<f32>;\n\nfn vert(inputData:VertexAttributes) -> VertexOutput {\n    ORI_Vert(inputData) ;\n    return ORI_VertexOut ;\n}\n\nvar<private> ORI_FragmentOutput: FragmentOutput;\nvar<private> ORI_VertexVarying: FragmentVarying;\n\n@fragment\nfn FragMain(vertex_varying:FragmentVarying) -> FragmentOutput {\n    ORI_VertexVarying = vertex_varying;\n    var texColor = textureSample(baseMap, baseMapSampler, ORI_VertexVarying.fragUV0.xy );\n\n    var emissive = textureSample(emissiveMap, emissiveMapSampler, ORI_VertexVarying.fragUV0.xy ).rgb ;\n    let intensity = materialUniform.emissiveIntensity * materialUniform.emissiveColor.a ;\n    emissive = emissive.rgb * materialUniform.emissiveColor.rgb ;\n    emissive = convertToHDRRGB(emissive,intensity);\n\n    if (materialUniform.alphaCutoff-texColor.w > 0.0) {\n        discard ;\n    }\n\n    var o_Position = vec4<f32>(ORI_VertexVarying.vWorldPos.xyz,emissive.r) ;\n    var o_Normal = vec4<f32>((ORI_VertexVarying.vWorldNormal.xyz * 0.5 + 0.5 ),emissive.g) ;\n    var o_Color = vec4<f32>((texColor * materialUniform.baseColor).rgb , emissive.b )  ;\n    return FragmentOutput(o_Position,o_Normal,vec4<f32>(o_Color));\n}\n\nfn convertToHDRRGB( color : vec3<f32> , ins:f32 ) -> vec3<f32> {\n    var hdrColor = vec3<f32>(0.0,0.0,0.0);\n    hdrColor.r = color.r * pow(2.4, ins);\n    hdrColor.g = color.g * pow(2.4, ins);\n    hdrColor.b = color.b * pow(2.4, ins);\n    return hdrColor;\n}\n',ice='\n#include "GlobalUniform"\n\nstruct uniformData {\n    exposure: f32,\n    roughness: f32\n};\n\nstruct FragmentOutput {\n    @location(0) o_Position: vec4<f32>,\n    @location(1) o_Normal: vec4<f32>,\n    @location(2) o_Color: vec4<f32>\n};\n\n@group(1) @binding(4)\nvar baseMapSampler: sampler;\n@group(1) @binding(5)\nvar baseMap: texture_cube<f32>;\n\n@group(2) @binding(0)\nvar<uniform> global: uniformData;\n\nfn LinearToGammaSpace(linRGB: vec3<f32>) -> vec3<f32> {\n    var linRGB1: vec3<f32>;\n    linRGB1 = linRGB;\n    linRGB1 = max(linRGB1, vec3<f32>(0.0, 0.0, 0.0));\n    linRGB1.x = pow(linRGB1.x, 0.4166666567325592);\n    linRGB1.y = pow(linRGB1.y, 0.4166666567325592);\n    linRGB1.z = pow(linRGB1.z, 0.4166666567325592);\n    return max(((1.0549999475479126 * linRGB1) - vec3<f32>(0.054999999701976776)), vec3<f32>(0.0));\n}\n\n@fragment\nfn main(@location(0) fragUV: vec2<f32>, @location(1) vWorldPos: vec4<f32>, @location(2) vWorldNormal: vec3<f32>) -> FragmentOutput {\n    let maxLevel: u32 = textureNumLevels(baseMap);\n    let textureColor:vec3<f32> = textureSampleLevel(baseMap, baseMapSampler, normalize(vWorldPos.xyz), global.roughness * f32(maxLevel) ).xyz;\n    let o_Color = 0.618 * vec4<f32>(LinearToGammaSpace(textureColor) * globalUniform.skyExposure , 1.0);\n    let o_Normal = vec4(vWorldNormal,1.0) ;\n    let o_Position = vec4<f32>(vWorldPos.xyz,100000.0) ;\n    return FragmentOutput(o_Position,o_Normal,o_Color);\n}\n';class ace{}bre(ace,"Ori_AllShader",'\n        #include "Common_vert"\n        #include "Common_frag"\n        #include "BxDF_frag"\n\n        fn vert(inputData:VertexAttributes) -> VertexOutput {\n            ORI_Vert(inputData) ;\n            return ORI_VertexOut ;\n        }\n\n        fn frag(){\n            ORI_ShadingInput.BaseColor = materialUniform.baseColor ;\n            ORI_ShadingInput.Roughness = materialUniform.roughness  ;\n            ORI_ShadingInput.Metallic = materialUniform.metallic ;\n            ORI_ShadingInput.Specular = 0.5 ;\n            ORI_ShadingInput.AmbientOcclusion = materialUniform.ao ;\n            ORI_ShadingInput.EmissiveColor = vec4<f32>(0.0);\n\n            ORI_ShadingInput.Normal = ORI_VertexVarying.vWorldNormal.rgb ;\n\n            #if USE_SHADOWMAPING\n                useShadow();\n            #endif\n\n            BxDFShading();\n        }\n    ');class sce{}bre(sce,"lambert_frag_wgsl",'\n    #include "FragmentOutput.wgsl"\n    #include "LighStruct"\n    #include "ColorUtil_frag"\n\n    @group(2) @binding(4)\n    var baseMapSampler: sampler;\n    @group(2) @binding(5)\n    var baseMap: texture_2d<f32>;\n\n    struct StandMaterial {\n        transformUV1:vec4<f32>,\n        transformUV2:vec4<f32>,\n        baseColor: vec4<f32>,\n        dirLight: vec4<f32>,\n        dirLightColor: vec4<f32>,\n        alphaCutoff: f32,\n        shadowBias: f32,\n    };\n\n    @group(2) @binding(0)\n    var<uniform> materialUniform: StandMaterial;\n\n    fn frag(){\n        var baseColor = materialUniform.baseColor;\n        var alphaCutoff = materialUniform.alphaCutoff;\n        var shadowBias = materialUniform.shadowBias;\n        var transformUV1 = materialUniform.transformUV1;\n        var transformUV2 = materialUniform.transformUV2;\n\n        var uv = transformUV1.zw * vUv0 + transformUV1.xy;\n        var baseMap = textureSample(baseMap, baseMapSampler, uv).xyz;\n\n        let viewDir = normalize(globalUniform.cameraWorldMatrix[3].xyz - vWorldPos.xyz) ;\n\n        let lightIndex = getCluster(builtin_fragCoord);\n        let start = max(lightIndex.start, 0.0);\n        let count = max(lightIndex.count, 0.0);\n        let end = max(start + count , 0.0);\n        var color = vec3<f32>(0.0);\n        for(var i:i32 = i32(start) ; i < i32(end); i = i + 1 )\n        {\n          let light = getLight(i) ;\n          switch (light.lightType) {\n            case PointLightType: {\n              let lightingColor = lambert_pointLight( baseMap , viewDir,vWorldNormal,vWorldPos.xyz,light);\n              color += lightingColor ;\n            }\n            case DirectLightType: {\n              let lightingColor = lambert_directLight( baseMap , viewDir,vWorldNormal,light.direction,light.lightColor,light.intensity);\n              color += lightingColor ;\n            }\n            case SpotLightType: {\n\n            }\n            default: {\n            }\n          }\n        }\n\n        ORI_FragmentOutput.color = vec4<f32>(color, 1.0);\n    }\n    '),bre(sce,"lambert_vert_wgsl",'\n      #include "Common_vert"\n\n      fn vert(){\n\n      }\n    ');let oce="\n    struct FragmentOutput {\n        @location(0) o_Target: vec4<f32>\n    };\n\n    var<private> varying_uv: vec2<f32>;\n    @group(1) @binding(0)\n    var baseMapSampler: sampler;\n    @group(1) @binding(1)\n    var baseMap: texture_2d<f32>;\n\n    struct MaterialUniform{\n        u_texel: vec2<f32>,\n        u_strength: f32,\n    }\n\n    @group(2) @binding(0)\n    var<uniform> materialUniform: MaterialUniform;\n\n\n    fn LinearToGammaSpace(linRGB0: vec3<f32>) -> vec3<f32> {\n        var linRGB = max(linRGB0, vec3(0.0, 0.0, 0.0));\n        linRGB.r = pow(linRGB.r,0.416666667);\n        linRGB.g = pow(linRGB.g,0.416666667);\n        linRGB.b = pow(linRGB.b,0.416666667);\n        return max(1.055 * linRGB - 0.055, vec3(0.0, 0.0, 0.0));\n    }\n\n    fn texture2D( uv:vec2<f32> , offset:vec2<f32> ) -> vec4<f32> {\n        return textureSample(baseMap, baseMapSampler, uv.xy + offset ).rgba ;\n    }\n\n    @fragment\n    fn main(@location(0) fragUV: vec2<f32>) -> FragmentOutput {\n        var v_vTexcoord = fragUV ;\n        // v_vTexcoord.x = 1.0 - v_vTexcoord.x ;\n        v_vTexcoord.y = 1.0 - v_vTexcoord.y ;\n\n        var reducemul = 1.0 / 8.0;\n        var reducemin = 1.0 / 128.0;\n\n        var basecol = texture2D(v_vTexcoord , vec2<f32>(0.0)).rgba;\n        var baseNW = texture2D(v_vTexcoord , -materialUniform.u_texel).rgb;\n        var baseNE = texture2D(v_vTexcoord , vec2<f32>(materialUniform.u_texel.x, -materialUniform.u_texel.y)).rgb;\n        var baseSW = texture2D(v_vTexcoord , vec2<f32>(-materialUniform.u_texel.x, materialUniform.u_texel.y)).rgb;\n        var baseSE = texture2D(v_vTexcoord , materialUniform.u_texel ).rgb;\n\n        // var gray = vec3<f32>(0.299, 0.587, 0.114);\n        var gray = vec3<f32>(0.213, 0.715, 0.072);\n        var monocol = dot(basecol.rgb, gray);\n        var monoNW = dot(baseNW, gray);\n        var monoNE = dot(baseNE, gray);\n        var monoSW = dot(baseSW, gray);\n        var monoSE = dot(baseSE, gray);\n\n        var monomin = min(monocol, min(min(monoNW, monoNE), min(monoSW, monoSE)));\n        var monomax = max(monocol, max(max(monoNW, monoNE), max(monoSW, monoSE)));\n\n        var dir = vec2<f32>(-((monoNW + monoNE) - (monoSW + monoSE)), ((monoNW + monoSW) - (monoNE + monoSE)));\n        var dirreduce = max((monoNW + monoNE + monoSW + monoSE) * reducemul * 0.25, reducemin);\n        var dirmin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirreduce);\n        dir = min(vec2<f32>(materialUniform.u_strength), max(vec2<f32>(-materialUniform.u_strength), dir * dirmin)) * materialUniform.u_texel;\n\n        var resultA = 0.5 * (texture2D(v_vTexcoord , dir * -0.166667).rgb  +\n                            texture2D(v_vTexcoord , dir * 0.166667).rgb);\n        var resultB = resultA * 0.5 + 0.25 * (texture2D( v_vTexcoord , dir * -0.5).rgb +\n                                            texture2D( v_vTexcoord , dir * 0.5).rgb);\n        var monoB = dot(resultB.rgb, gray);\n        \n        var color:vec3<f32> ;\n        if(monoB < monomin || monoB > monomax) {\n            color = resultA ;//* v_vColour;\n        } else {\n            color = resultB ;//* v_vColour;\n        }\n        return FragmentOutput(vec4<f32>(color.rgb,basecol.a));\n    }\n";class lce{}bre(lce,"cs","\n    #include 'ColorUtil'\n    struct UniformData {\n        width: f32,\n        height: f32,\n        sunU: f32,\n        sunV: f32,\n        eyePos: f32,\n        sunRadius: f32,         // = 500.0;\n        sunRadiance: f32,       // = 20.0;\n        mieG: f32,              // = 0.76;\n        mieHeight: f32,         // = 1200;\n        sunBrightness: f32,     // = 1.0;\n        displaySun: f32,        // > 0.5: true\n        skyColor: vec4<f32>,        // sky color\n      };\n\n      @group(0) @binding(0) var<uniform> uniformBuffer: UniformData;\n      @group(0) @binding(1) var outTexture : texture_storage_2d<rgba16float, write>;\n\n      var<private> uv01: vec2<f32>;\n      var<private> fragCoord: vec2<i32>;\n      var<private> texSizeF32: vec2<f32>;\n\n      var<private> PI:f32 = 3.1415926535;\n      var<private> PI_2:f32 = 0.0;\n      var<private> EPSILON:f32 = 0.0000001;\n      var<private> SAMPLES_NUMS:i32 = 16;\n\n      var<private> transmittance:vec3<f32>;\n      var<private> insctrMie:vec3<f32>;\n      var<private> insctrRayleigh:vec3<f32>;\n\n      @compute @workgroup_size( 8 , 8 , 1 )\n      fn CsMain( @builtin(workgroup_id) workgroup_id : vec3<u32> , @builtin(global_invocation_id) globalInvocation_id : vec3<u32>)\n      {\n        fragCoord = vec2<i32>(globalInvocation_id.xy);\n        texSizeF32 = vec2<f32>( uniformBuffer.width, uniformBuffer.height);\n        uv01 = vec2<f32>(globalInvocation_id.xy) / texSizeF32;\n        uv01.y = 1.0 - uv01.y - EPSILON;\n        PI_2 = PI * 2.0;\n        textureStore(outTexture, fragCoord , mainImage(uv01));//vec4(uv01, 0.0, 1.0));\n      }\n\n      struct ScatteringParams\n      {\n        sunRadius:f32,\n        sunRadiance:f32,\n\n        mieG:f32,\n        mieHeight:f32,\n\n        rayleighHeight:f32,\n\n        waveLambdaMie:vec3<f32>,\n        waveLambdaOzone:vec3<f32>,\n        waveLambdaRayleigh:vec3<f32>,\n\n        earthRadius:f32,\n        earthAtmTopRadius:f32,\n        earthCenter:vec3<f32>,\n      }\n\n      fn ComputeSphereNormal(coord:vec2<f32>, phiStart:f32, phiLength:f32, thetaStart:f32, thetaLength:f32) -> vec3<f32>\n      {\n        var normal:vec3<f32>;\n        normal.x = -sin(thetaStart + coord.y * thetaLength) * sin(phiStart + coord.x * phiLength);\n        normal.y = -cos(thetaStart + coord.y * thetaLength);\n        normal.z = -sin(thetaStart + coord.y * thetaLength) * cos(phiStart + coord.x * phiLength);\n        return normalize(normal);\n      }\n\n      fn ComputeRaySphereIntersection(position:vec3<f32>, dir:vec3<f32>, center:vec3<f32>, radius:f32) -> vec2<f32>\n      {\n        var origin:vec3<f32> = position - center;\n        var B = dot(origin, dir);\n        var C = dot(origin, origin) - radius * radius;\n        var D = B * B - C;\n\n        var minimaxIntersections:vec2<f32>;\n        if (D < 0.0)\n        {\n          minimaxIntersections = vec2<f32>(-1.0, -1.0);\n        }\n        else\n        {\n          D = sqrt(D);\n          minimaxIntersections = vec2<f32>(-B - D, -B + D);\n        }\n\n        return minimaxIntersections;\n      }\n\n      fn ComputeWaveLambdaRayleigh(lambda: vec3<f32>) -> vec3<f32>\n      {\n        var n:f32 = 1.0003;\n        var N:f32 = 2.545E25;\n        var pn:f32 = 0.035;\n        var n2:f32 = n * n;\n        var pi3:f32 = PI * PI * PI;\n        var rayleighConst:f32 = (8.0 * pi3 * pow(n2 - 1.0,2.0)) / (3.0 * N) * ((6.0 + 3.0 * pn) / (6.0 - 7.0 * pn));\n        return vec3<f32>(rayleighConst) / (lambda * lambda * lambda * lambda);\n      }\n\n      fn ComputePhaseMie(theta: f32, g:f32) -> f32\n      {\n        var g2 = g * g;\n        return (1.0 - g2) / pow(1.0 + g2 - 2.0 * g * saturate(theta), 1.5) / (4.0 * PI);\n      }\n\n      fn ComputePhaseRayleigh(theta: f32) -> f32\n      {\n        var theta2 = theta * theta;\n        return (theta2 * 0.75 + 0.75) / (4.0 * PI);\n      }\n\n      fn ChapmanApproximation(X: f32, h: f32, cosZenith: f32) -> f32\n      {\n        var c = sqrt(X + h);\n        var c_exp_h = c * exp(-h);\n\n        if (cosZenith >= 0.0)\n        {\n          return c_exp_h / (c * cosZenith + 1.0);\n        }\n        else\n        {\n          var x0 = sqrt(1.0 - cosZenith * cosZenith) * (X + h);\n          var c0 = sqrt(x0);\n\n          return 2.0 * c0 * exp(X - x0) - c_exp_h / (1.0 - c * cosZenith);\n        }\n      }\n\n      fn GetOpticalDepthSchueler(h: f32, H: f32, earthRadius: f32, cosZenith: f32) -> f32\n      {\n        return H * ChapmanApproximation(earthRadius / H, h / H, cosZenith);\n      }\n\n      fn GetTransmittance(setting: ScatteringParams, L:vec3<f32>, V: vec3<f32>) -> vec3<f32>\n      {\n        var ch = GetOpticalDepthSchueler(L.y, setting.rayleighHeight, setting.earthRadius, V.y);\n        return exp(-(setting.waveLambdaMie + setting.waveLambdaRayleigh) * ch);\n      }\n\n      fn ComputeOpticalDepth(setting: ScatteringParams, samplePoint: vec3<f32>, V: vec3<f32>, L: vec3<f32>, neg: f32) -> vec2<f32>\n      {\n        var rl = length(samplePoint);\n        var h = rl - setting.earthRadius;\n        var r: vec3<f32> = samplePoint / rl;\n\n        var cos_chi_sun = dot(r, L);\n        var cos_chi_ray = dot(r, V * neg);\n\n        var opticalDepthSun = GetOpticalDepthSchueler(h, setting.rayleighHeight, setting.earthRadius, cos_chi_sun);\n        var opticalDepthCamera = GetOpticalDepthSchueler(h, setting.rayleighHeight, setting.earthRadius, cos_chi_ray) * neg;\n\n        return vec2<f32>(opticalDepthSun, opticalDepthCamera);\n      }\n\n      fn AerialPerspective(setting:ScatteringParams, start: vec3<f32>, end: vec3<f32>, V: vec3<f32>, L: vec3<f32>, infinite:i32)\n      {\n        var inf_neg:f32 = 1.0;\n        if( infinite == 0){\n          inf_neg = -1.0;\n        }\n\n        var sampleStep: vec3<f32> = (end - start) / f32(SAMPLES_NUMS);\n        var samplePoint: vec3<f32> = end - sampleStep;\n        var sampleLambda: vec3<f32> = setting.waveLambdaMie + setting.waveLambdaRayleigh + setting.waveLambdaOzone;\n\n        var sampleLength:f32 = length(sampleStep);\n\n        var scattering:vec3<f32> = vec3<f32>(0.0);\n        var lastOpticalDepth:vec2<f32> = ComputeOpticalDepth(setting, end, V, L, inf_neg);\n\n        for (var i:i32 = 1; i < SAMPLES_NUMS; i = i + 1)\n        {\n          var opticalDepth: vec2<f32> = ComputeOpticalDepth(setting, samplePoint, V, L, inf_neg);\n\n          var segment_s: vec3<f32> = exp(-sampleLambda * (opticalDepth.x + lastOpticalDepth.x));\n          var segment_t: vec3<f32> = exp(-sampleLambda * (opticalDepth.y - lastOpticalDepth.y));\n\n          transmittance *= segment_t;\n\n          scattering = scattering * segment_t;\n          scattering += exp(-(length(samplePoint) - setting.earthRadius) / setting.rayleighHeight) * segment_s;\n\n          lastOpticalDepth = opticalDepth;\n          samplePoint = samplePoint - sampleStep;\n        }\n\n        insctrMie = scattering * setting.waveLambdaMie * sampleLength;\n        insctrRayleigh = scattering * setting.waveLambdaRayleigh * sampleLength;\n      }\n\n      fn ComputeSkyboxChapman(setting: ScatteringParams, eye:vec3<f32>, V:vec3<f32>, L:vec3<f32>) -> f32\n      {\n        var neg:i32 = 1;\n        var outerIntersections: vec2<f32> = ComputeRaySphereIntersection(eye, V, setting.earthCenter, setting.earthAtmTopRadius);\n        if (outerIntersections.y < 0.0){\n          return 0.0;\n        }\n        var innerIntersections: vec2<f32> = ComputeRaySphereIntersection(eye, V, setting.earthCenter, setting.earthRadius);\n        if (innerIntersections.x > 0.0)\n        {\n          neg = 0;\n          outerIntersections.y = innerIntersections.x;\n        }\n\n        let eye0 = eye - setting.earthCenter;\n\n        var start : vec3<f32> = eye0 + V * max(0.0, outerIntersections.x);\n        var end : vec3<f32>= eye0 + V * outerIntersections.y;\n\n        AerialPerspective(setting, start, end, V, L, neg);\n\n        //bool intersectionTest = innerIntersections.x < 0.0 && innerIntersections.y < 0.0;\n        //return intersectionTest ? 1.0 : 0.0;\n\n        if(innerIntersections.x < 0.0 && innerIntersections.y < 0.0){\n          return 1.0;\n        }\n        return 0.0;\n      }\n\n      fn ComputeSkyInscattering(setting: ScatteringParams, eye: vec3<f32>, V: vec3<f32>, L: vec3<f32>) -> vec4<f32>\n      {\n        transmittance = vec3<f32>(1.0);\n        insctrMie = vec3<f32>(0.0);\n        insctrRayleigh = vec3<f32>(0.0);\n        var intersectionTest:f32 = ComputeSkyboxChapman(setting, eye, V, L);\n\n        var phaseTheta = dot(V, L);\n        var phaseMie = ComputePhaseMie(phaseTheta, setting.mieG);\n        var phaseRayleigh = ComputePhaseRayleigh(phaseTheta);\n        var phaseNight = 1.0 - saturate(transmittance.x * EPSILON);\n\n        var insctrTotalMie: vec3<f32> = insctrMie * phaseMie;\n        var insctrTotalRayleigh: vec3<f32> = insctrRayleigh * phaseRayleigh;\n\n        var sky: vec3<f32> = (insctrTotalMie + insctrTotalRayleigh) * setting.sunRadiance;\n        if(uniformBuffer.displaySun > 0.5){\n          var angle:f32 = saturate((1.0 - phaseTheta) * setting.sunRadius);\n          var cosAngle:f32 = cos(angle * PI * 0.5);\n          var edge:f32 = 0.0;\n          if(angle >= 0.9){\n            edge = smoothstep(0.9, 1.0, angle);\n          }\n\n          var limbDarkening: vec3<f32> = GetTransmittance(setting, -L, V);\n          limbDarkening *= pow(vec3<f32>(cosAngle), vec3<f32>(0.420, 0.503, 0.652)) * mix(vec3<f32>(1.0), vec3<f32>(1.2,0.9,0.5), edge) * intersectionTest;\n          sky += limbDarkening * uniformBuffer.sunBrightness; \n        }\n        return vec4<f32>(sky, phaseNight * intersectionTest);\n      }\n\n      fn TonemapACES(x: vec3<f32>) -> vec3<f32>\n      {\n        var A:f32 = 2.51f;\n        var B:f32 = 0.03f;\n        var C:f32 = 2.43f;\n        var D:f32 = 0.59f;\n        var E:f32 = 0.14f;\n        return (x * (A * x + B)) / (x * (C * x + D) + E);\n      }\n\n      fn noise(uv:vec2<f32>) -> f32\n      {\n        return fract(dot(sin(vec3<f32>(uv.xyx) * vec3<f32>(uv.xyy) * 1024.0), vec3<f32>(341896.483, 891618.637, 602649.7031)));\n      }\n\n      fn mainImage( uv:vec2<f32> ) -> vec4<f32>\n      {\n        let eyePosition = uniformBuffer.eyePos;\n        var sun = vec2<f32>(uniformBuffer.sunU, uniformBuffer.sunV);\n        var V: vec3<f32> = ComputeSphereNormal(uv, 0.0, PI_2, 0.0, PI);\n        var L: vec3<f32> = ComputeSphereNormal(vec2<f32>(sun.x, sun.y), 0.0, PI_2, 0.0, PI);\n\n        var setting: ScatteringParams;\n        setting.sunRadius = uniformBuffer.sunRadius;//500.0;\n        setting.sunRadiance = uniformBuffer.sunRadiance;//20.0;\n        setting.mieG = uniformBuffer.mieG;//0.76;\n        setting.mieHeight = uniformBuffer.mieHeight;// 1200.0;\n        setting.rayleighHeight = 8000.0;\n        setting.earthRadius = 6360000.0;\n        setting.earthAtmTopRadius = 6420000.0;\n        setting.earthCenter = vec3<f32>(0, -setting.earthRadius, 0);\n        setting.waveLambdaMie = vec3<f32>(0.0000002);\n\n        // wavelength with 680nm, 550nm, 450nm\n        setting.waveLambdaRayleigh = ComputeWaveLambdaRayleigh(vec3<f32>(0.000000680, 0.000000550, 0.000000450));\n\n        // see https://www.shadertoy.com/view/MllBR2\n        setting.waveLambdaOzone = vec3<f32>(1.36820899679147, 3.31405330400124, 0.13601728252538)* 0.0000006 * 2.504;\n\n        var eye:vec3<f32> = vec3<f32>(0,eyePosition,0);\n        var sky0:vec4<f32> = ComputeSkyInscattering(setting, eye, V, L);\n        var sky = vec3<f32>(sky0.rgb);\n\n        sky = TonemapACES(sky.rgb * 2.0);\n        sky = pow(sky.rgb, vec3<f32>(1.0/1.2)); // gamma\n\n        var fragColor:vec4<f32> = vec4<f32>((sky.rgb), 1.0);\n        return fragColor;\n      }\n    ");class uce{constructor(){bre(this,"sunRadius",500),bre(this,"sunRadiance",11),bre(this,"mieG",.76),bre(this,"mieHeight",1200),bre(this,"eyePos",1500),bre(this,"sunX",.71),bre(this,"sunY",.56),bre(this,"sunBrightness",1),bre(this,"displaySun",!0),bre(this,"defaultTextureCubeSize",512),bre(this,"defaultTexture2DSize",1024),bre(this,"skyColor",new wre(1,1,1,1))}}class cce extends Vue{constructor(e){return super(),bre(this,"_internalTexture"),bre(this,"_cubeSize"),bre(this,"setting"),this.setting=e,this._cubeSize=e.defaultTextureCubeSize,this._internalTexture=new dce(e.defaultTexture2DSize,.5*e.defaultTexture2DSize),this._internalTexture.update(this.setting),this.createFromTexture(this._cubeSize,this._internalTexture),this}get texture2D(){return this._internalTexture}apply(){return this._internalTexture.update(this.setting),this._faceData.uploadErpTexture(this._internalTexture),this}}class dce extends boe{constructor(e,t){super(e,t,die,!1,GPUTextureUsage.STORAGE_BINDING|GPUTextureUsage.TEXTURE_BINDING),bre(this,"_computeShader"),bre(this,"_uniformBuffer"),this.initCompute(e,t)}initCompute(e,t){this._uniformBuffer=new Pie(64),this._uniformBuffer.apply(),this._computeShader=new Uie(lce.cs),this._computeShader.setUniformBuffer("uniformBuffer",this._uniformBuffer),this._computeShader.setStorageTexture("outTexture",this),this._computeShader.workerSizeX=e/8,this._computeShader.workerSizeY=t/8}update(e){return this._uniformBuffer.setFloat("width",this.width),this._uniformBuffer.setFloat("height",this.height),this._uniformBuffer.setFloat("sunU",e.sunX),this._uniformBuffer.setFloat("sunV",e.sunY),this._uniformBuffer.setFloat("eyePos",e.eyePos),this._uniformBuffer.setFloat("sunRadius",e.sunRadius),this._uniformBuffer.setFloat("sunRadiance",e.sunRadiance),this._uniformBuffer.setFloat("mieG",e.mieG),this._uniformBuffer.setFloat("mieHeight",e.mieHeight),this._uniformBuffer.setFloat("sunBrightness",e.sunBrightness),this._uniformBuffer.setFloat("displaySun",e.displaySun?1:0),this._uniformBuffer.setColor("skyColor",e.skyColor),this._uniformBuffer.apply(),e=roe.beginCommandEncoder(),roe.computeCommand(e,[this._computeShader]),roe.endCommandEncoder(e),this}}class hce extends kse{constructor(){super(),bre(this,"transparency"),bre(this,"metallic"),this.setShader("sky_vs_frag_wgsl","sky_fs_frag_wgsl"),this.getShader().setUniformVector3("eyesPos",new Rre),this.getShader().setUniformFloat("exposure",1),this.getShader().setUniformFloat("roughness",0);var e=this.getShader().shaderState;e.frontFace="cw",e.cullMode=rie,e.depthWriteEnabled=!1,e.depthCompare=Jre}set baseMap(e){super.baseMap=e;var t="IS_HDR_SKY";this.renderShader.defineValue[t]!=(null==e?void 0:e.isHDRTexture)&&this.renderShader.setDefine(t,!(null==e||!e.isHDRTexture))}get baseMap(){return super.baseMap}set envMap(e){}set shadowMap(e){}get exposure(){return nce.setting.sky.skyExposure}set exposure(e){nce.setting.sky.skyExposure=e}get roughness(){return this.renderShader.uniforms.roughness.value}set roughness(e){"roughness"in this.renderShader.uniforms&&(this.renderShader.uniforms.roughness.value=e)}}class pce extends voe{constructor(e,t,n,r,i,a,s){super(),bre(this,"shape_vertices",[]),bre(this,"shape_indices",[]),bre(this,"radius"),bre(this,"widthSegments"),bre(this,"heightSegments"),bre(this,"phiStart"),bre(this,"phiLength"),bre(this,"thetaStart"),bre(this,"thetaLength"),this.radius=e,this.widthSegments=t,this.heightSegments=n,this.phiStart=r,this.phiLength=i,this.thetaStart=a,this.thetaLength=s,this.buildGeometry()}buildGeometry(){var e,t=0,n=this.heightSegments,r=this.widthSegments,i=this.radius,a=(n+1)*(r+1);let s=new Float32Array(3*a),o=new Float32Array(3*a),l=new Float32Array(2*a),u=new Uint16Array(r*n*2*3),c=0,d=0,h=0;for(e=0;e<=n;++e)for(var p=Math.PI*e/n,f=-i*Math.cos(p),m=i*Math.sin(p),g=0;g<=r;++g){var v,y=2*Math.PI*g/r,_=m*Math.cos(y),b=(y=m*Math.sin(y),1/Math.sqrt(_*_+y*y+f*f));s[c++]=_,s[c++]=y,s[c++]=f,o[d++]=_*b,o[d++]=y*b,o[d++]=f*b,l[h++]=g/r,l[h++]=e/n,0<g&&0<e&&(y=(_=(r+1)*e+g)-1,b=(r+1)*(e-1)+g-1,v=(r+1)*(e-1)+g,e==n?(u[t++]=_,u[t++]=b,u[t++]=v):1==e?(u[t++]=_,u[t++]=y,u[t++]=b):(u[t++]=_,u[t++]=y,u[t++]=b,u[t++]=_,u[t++]=b,u[t++]=v))}this.setIndices(u),this.setAttribute(Nae.position,s),this.setAttribute(Nae.normal,o),this.setAttribute(Nae.uv,l),this.setAttribute(Nae.TEXCOORD_1,l),this.addSubGeometry({indexStart:0,indexCount:u.length,vertexStart:0,index:0}),this.bounds=new gae(Rre.ZERO,new Rre(2*this.radius,2*this.radius,2*this.radius))}}class fce extends soe{constructor(){super(),bre(this,"skyMaterial"),this.castShadow=!1,this.castGI=!0,this.addRendererMask(bie.Sky),this.alwaysRender=!0}init(){super.init(),this.object3D.bound=new gae(Rre.ZERO.clone(),Rre.MAX),this.geometry=new pce(nce.setting.sky.defaultFar,20,20),this.skyMaterial||(this.skyMaterial=new hce)}onEnable(){this._readyPipeline?(this.castNeedPass(this.materials[0].getShader()),!this._inRenderer&&this.transform.scene3D&&((Kse.instance.sky=this)._inRenderer=!0)):this.initPipeline()}onDisable(){this._inRenderer&&this.transform.scene3D&&(this._inRenderer=!1,Kse.instance.sky=null)}renderPass2(e,t,n,r,i,a=!1){this.transform.updateWorldMatrix(),super.renderPass2(e,t,n,r,i,a)}set map(e){this.skyMaterial.baseMap=e,null==this.skyMaterial.name&&(this.skyMaterial.name="skyMaterial"),this.material=this.skyMaterial}get map(){return this.skyMaterial.baseMap}get exposure(){return this.skyMaterial.exposure}set exposure(e){this.skyMaterial&&(this.skyMaterial.exposure=e)}get roughness(){return this.skyMaterial.roughness}set roughness(e){this.skyMaterial&&(this.skyMaterial.roughness=e)}}class mce{constructor(){bre(this,"rotateX"),bre(this,"rotateY"),bre(this,"sunX"),bre(this,"sunY"),this.reset()}reset(){return this.rotateX=this.rotateY=this.sunX=this.sunY=Number.MAX_VALUE,this}isRotateChange(e,t){return.001<=Math.abs(this.rotateX-e)||.001<=Math.abs(this.rotateY-t)}isSkyChange(e,t){return.001<=Math.abs(this.sunX-e)||.001<=Math.abs(this.sunY-t)}save(e,t,n,r){return this.sunX=e,this.sunY=t,this.rotateX=n,this.rotateY=r,this}}class gce extends fce{constructor(){super(...arguments),bre(this,"_atmosphericScatteringSky"),bre(this,"_onChange",!0),bre(this,"_relatedTransform"),bre(this,"_historyData")}get sunX(){return this._atmosphericScatteringSky.setting.sunX}set sunX(e){this._atmosphericScatteringSky.setting.sunX!=e&&(this._atmosphericScatteringSky.setting.sunX=e,this._onChange=!0)}get sunY(){return this._atmosphericScatteringSky.setting.sunY}set sunY(e){this._atmosphericScatteringSky.setting.sunY!=e&&(this._atmosphericScatteringSky.setting.sunY=e,this._onChange=!0)}get eyePos(){return this._atmosphericScatteringSky.setting.eyePos}set eyePos(e){this._atmosphericScatteringSky.setting.eyePos!=e&&(this._atmosphericScatteringSky.setting.eyePos=e,this._onChange=!0)}get sunRadius(){return this._atmosphericScatteringSky.setting.sunRadius}set sunRadius(e){this._atmosphericScatteringSky.setting.sunRadius!=e&&(this._atmosphericScatteringSky.setting.sunRadius=e,this._onChange=!0)}get sunRadiance(){return this._atmosphericScatteringSky.setting.sunRadiance}set sunRadiance(e){this._atmosphericScatteringSky.setting.sunRadiance!=e&&(this._atmosphericScatteringSky.setting.sunRadiance=e,this._onChange=!0)}get sunBrightness(){return this._atmosphericScatteringSky.setting.sunBrightness}set sunBrightness(e){this._atmosphericScatteringSky.setting.sunBrightness!=e&&(this._atmosphericScatteringSky.setting.sunBrightness=e,this._onChange=!0)}get displaySun(){return this._atmosphericScatteringSky.setting.displaySun}set displaySun(e){this._atmosphericScatteringSky.setting.displaySun!=e&&(this._atmosphericScatteringSky.setting.displaySun=e,this._onChange=!0)}init(){super.init(),this._historyData=new mce,this._atmosphericScatteringSky=new cce(new uce)}start(){var e=this.transform.scene3D;this.map=this._atmosphericScatteringSky,e.envMap=this._atmosphericScatteringSky,super.start()}get relativeTransform(){return this._relatedTransform}set relativeTransform(e){this._relatedTransform=e,this._historyData.reset()}onUpdate(e){this._relatedTransform&&(this._relatedTransform.rotationZ=0,this._historyData.isRotateChange(this._relatedTransform.rotationX,this._relatedTransform.rotationY)?(this.sunX=(this._relatedTransform.rotationY+90)/360,this.sunY=this._relatedTransform.rotationX/180+.5):this._historyData.isSkyChange(this.sunX,this.sunY)&&(this._relatedTransform.rotationY=360*this.sunX-90,this._relatedTransform.rotationX=180*(this.sunY-.5)),this._historyData.save(this.sunX,this.sunY,this._relatedTransform.rotationX,this._relatedTransform.rotationY)),this._onChange&&(this._onChange=!1,this._atmosphericScatteringSky.apply())}}class vce{}bre(vce,"vertexScale",1),bre(vce,"quadMaxCountForWorld",256),bre(vce,"quadMaxCountForView",2048),bre(vce,"SortOrderStartWorld",7e3),bre(vce,"SortOrderStartView",8e3),bre(vce,"SortOrderCanvasSpan",1e4);var yce=(e=>(e[e.View=0]="View",e[e.World=2]="World",e))(yce||{}),_ce=(e=>(e[e.Simple=0]="Simple",e[e.Sliced=1]="Sliced",e[e.Tiled=2]="Tiled",e[e.Filled=3]="Filled",e))(_ce||{}),bce=(e=>(e[e.None=0]="None",e[e.BillboardY=9]="BillboardY",e[e.BillboardXYZ=10]="BillboardXYZ",e))(bce||{});class xce extends iae{constructor(){super(),bre(this,"type"),bre(this,"camera"),bre(this,"_cameraPosition"),this._cameraPosition=new Rre}onUpdate(){this.enable&&this.transform.view3D.camera&&this.updateBillboardMatrix()}updateBillboardMatrix(){var e=this.transform.view3D.camera;this._cameraPosition.copyFrom(e.transform.back),this.type!=bce.BillboardXYZ&&this.type==bce.BillboardY&&(this._cameraPosition.y=0),this._cameraPosition.normalize(),this._cameraPosition.add(this.object3D.localPosition,this._cameraPosition),this.transform.lookAt(this.object3D.localPosition,this._cameraPosition,e.transform.up)}cloneTo(e){e.addComponent(xce).type=this.type}}var wce=(e=>(e[e.None=0]="None",e[e.Box=1]="Box",e[e.Capsule=2]="Capsule",e[e.Sphere=3]="Sphere",e[e.Mesh=4]="Mesh",e))(wce||{});class Sce{constructor(){bre(this,"_center"),bre(this,"_size"),bre(this,"_halfSize"),bre(this,"_shapeType",0),this._center=new Rre,this._size=new Rre,this._halfSize=new Rre}get shapeType(){return this._shapeType}setFromCenterAndSize(e,t){return e&&this._center.copy(e),t&&this._size.copy(t),this}get center(){return this._center}set center(e){this._center.copy(e)}get size(){return this._size}set size(e){this._size.copy(e),this._halfSize.copy(e).multiplyScalar(.5)}get halfSize(){return this._halfSize}rayPick(e,t){return null}}const Cce=class extends Sce{constructor(){super(),bre(this,"_pickRet"),bre(this,"box"),this._shapeType=wce.Box,this.box=new gae(new Rre,new Rre)}rayPick(e,t){this.box.setFromCenterAndSize(this.center,this.size);var n=Cce.helpMatrix;return(e=((t=(n.copyFrom(t).invert(),Cce.helpRay.copy(e))).applyMatrix(n),t.intersectBox(this.box,Cce.v3_help_0)))?(this._pickRet||(this._pickRet={intersect:!1,intersectPoint:new Rre,distance:0}),this._pickRet.intersect=!0,this._pickRet.intersectPoint=e,this._pickRet.distance=Rre.distance(t.origin,Cce.v3_help_0),this._pickRet):null}};let Tce=Cce;bre(Tce,"v3_help_0",new Rre),bre(Tce,"helpMatrix",new Kie),bre(Tce,"helpRay",new oae);class Mce extends iae{constructor(){super(),bre(this,"_shape"),this._shape=new Tce}start(){"pixel"==nce.setting.pick.mode&&this.transform.scene3D.view.pickFire.mouseEnableMap.set(this.transform.worldMatrix.index,this)}get shape(){return this._shape}set shape(e){this._shape=e}rayPick(e){return this._enable?this._shape.rayPick(e,this.transform.worldMatrix):null}beforeDestroy(e){var t;"pixel"==nce.setting.pick.mode&&this.transform.scene3D.view.pickFire.mouseEnableMap.delete(this.transform.worldMatrix.index),null!=(t=super.beforeDestroy)&&t.call(this,e)}}var Ece=(e=>(e[e.PingPong=0]="PingPong",e[e.Repeat=1]="Repeat",e[e.Clamp=2]="Clamp",e))(Ece||{}),Ace=(e=>(e[e.Default=0]="Default",e[e.Clamp=1]="Clamp",e[e.Once=1]="Once",e[e.Loop=2]="Loop",e[e.PingPong=4]="PingPong",e[e.ClampForever=8]="ClampForever",e))(Ace||{});class Pce{}bre(Pce,"property",{"m_LocalPosition.x":"localPosition.x","m_LocalPosition.y":"localPosition.y","m_LocalPosition.z":"localPosition.z","m_LocalRotation.x":"localQuaternion.x","m_LocalRotation.y":"localQuaternion.y","m_LocalRotation.z":"localQuaternion.z","m_LocalRotation.w":"localQuaternion.w","localEulerAnglesRaw.x":"localRotation.x","localEulerAnglesRaw.y":"localRotation.y","localEulerAnglesRaw.z":"localRotation.z","m_LocalEulerAngles.x":"localRotation.x","m_LocalEulerAngles.y":"localRotation.y","m_LocalEulerAngles.z":"localRotation.z","m_LocalScale.x":"localScale.x","m_LocalScale.y":"localScale.y","m_LocalScale.z":"localScale.z","m_Color.r":"r","m_Color.g":"g","m_Color.b":"b","m_Color.a":"alpha","field of view":"camera3D.fov",m_IsActive:"visible",m_Sprite:"texture",m_FlipX:"flipX",m_FlipY:"flipY"}),bre(Pce,"property_quaternion",{"m_LocalRotation.x":!0,"m_LocalRotation.y":!0,"m_LocalRotation.z":!0,"m_LocalRotation.w":!0}),bre(Pce,"property_scale",{"m_LocalPosition.x":1,"m_LocalPosition.y":1,"m_LocalPosition.z":-1,"localEulerAnglesRaw.x":-1,"localEulerAnglesRaw.y":1,"localEulerAnglesRaw.z":1,"m_LocalEulerAngles.x":-1,"m_LocalEulerAngles.y":1,"m_LocalEulerAngles.z":1,"m_LocalRotation.x":1,"m_LocalRotation.y":1,"m_LocalRotation.z":-1,"m_LocalRotation.w":-1,"m_LocalScale.x":1,"m_LocalScale.y":1,"m_LocalScale.z":1,"m_Color.r":1,"m_Color.g":1,"m_Color.b":1,"m_Color.a":1,"field of view":1,m_IsActive:1,m_Sprite:1}),bre(Pce,"property_offset",{"m_LocalPosition.x":0,"m_LocalPosition.y":0,"m_LocalPosition.z":0,"localEulerAnglesRaw.x":0,"localEulerAnglesRaw.y":0,"localEulerAnglesRaw.z":0,"m_LocalEulerAngles.x":0,"m_LocalEulerAngles.y":0,"m_LocalEulerAngles.z":0,"m_LocalRotation.x":0,"m_LocalRotation.y":0,"m_LocalRotation.z":0,"m_LocalRotation.w":0,"m_LocalScale.x":0,"m_LocalScale.y":0,"m_LocalScale.z":0,"field of view":0,"m_Color.r":0,"m_Color.g":0,"m_Color.b":0,"m_Color.a":0,m_IsActive:0,m_Sprite:0});const Rce=class{constructor(e){bre(this,"_propertyAnimClip"),bre(this,"_target"),bre(this,"_animation"),bre(this,"_propertyCache"),bre(this,"_bindObjects",[]),bre(this,"_currentClip"),bre(this,"_frame",0),bre(this,"_time",0),bre(this,"_isPlaying",!0),bre(this,"speed",1),this._target=e.object3D,this._animation=e,this._propertyAnimClip={},this._propertyCache={}}get object3D(){return this._target}get time(){return this._time}get currentClip(){return this._currentClip}getClip(e){return this._propertyAnimClip[e]}addClip(e){for(const r in(this._propertyAnimClip[e.name]=e).objAnimClip){let i=e.objAnimClip[r],a=this._target;a=""==r?this._target:this._target.getObjectByName(r);var t=i.curve;for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)){var n=Pce.property[e].split(".");if(a){-1==this._bindObjects.indexOf(a)&&this._bindObjects.push(a),null==this._propertyCache[r]&&(this._propertyCache[r]={}),this._propertyCache[r][e]={value:a[n[0]],property:n[1]};for(let t=1;t<n.length-1;t++)this._propertyCache[r][e]={value:a[n[t]],property:n[t+1]}}}}return this}play(e,t=!0){var n=this._propertyAnimClip[e];return n?(this._isPlaying=!0,!t&&this._currentClip&&this._currentClip.name==e||(this._time=0),this._currentClip=n,this._currentClip):null}stop(){return this._isPlaying=!1,this}toggle(){return this._isPlaying=!this._isPlaying,this}get isPlaying(){return this._isPlaying}update(e,t){e*=.001,t*=.001,this._currentClip&&this._frame!=e&&this._isPlaying&&(this._frame=e,e=this._time,this._time=this.calcTime(e+t*this.speed),this.validProperty(),this._currentClip.wrapMode!=Ace.Loop&&this._currentClip.wrapMode!=Ace.Default&&(0<this.speed?this._time>=this._currentClip.totalTime:this._time<=0)&&(this._isPlaying=!1,this._animation.statusCall(Rce.Complete,e,this._time)),this._animation.statusCall(Rce.Seek,e,this._time))}seek(e){return this._time=this.calcTime(e),this.validProperty(),this}calcTime(e){return this._currentClip.wrapMode==Ace.Loop||this._currentClip.wrapMode==Ace.Default?Xie(e,this._currentClip.totalTime):Wie(e,0,this._currentClip.totalTime)}validProperty(){if(this._target)for(const a in this._currentClip.objAnimClip){let i=!1,s=this._currentClip.objAnimClip[a].curve;for(const r in s){var e,t,n;Object.prototype.hasOwnProperty.call(s,r)&&(n=s[r],e=this._propertyCache[a][r],t=Pce.property_scale[r],i=i||Pce.property_quaternion[r],n=n.getValue(this._time)*t+Pce.property_offset[r],e.value[e.property]=n)}var r;i&&(r=this._target.transform,Kie.getEuler(r.localRotation,r.localRotQuat,!0,"ZYX"))}for(var i of this._bindObjects)i.transform.notifyChange()}};let Lce=Rce;bre(Lce,"Complete",0),bre(Lce,"Seek",1);class kce extends Cre{constructor(e,t){super(t),bre(this,"animation"),bre(this,"frame"),this.animation=e}}bre(kce,"SEEK","SEEK"),bre(kce,"COMPLETE","COMPLETE");class Dce extends voe{constructor(e=1,t=1,n=1){super(),bre(this,"width"),bre(this,"height"),bre(this,"depth"),this.width=e,this.height=t,this.depth=n,this.initVertex()}initVertex(){var e=this.width/2,t=this.height/2,n=this.depth/2,r=(e=(this.bounds=new gae(Rre.ZERO.clone(),new Rre(this.width,this.height,this.depth)),new Float32Array([-e,t,n,e,t,n,e,t,-n,-e,t,-n,-e,t,n,e,t,-n,e,-t,n,-e,-t,n,-e,-t,-n,e,-t,-n,e,-t,n,-e,-t,-n,-e,-t,n,-e,t,n,-e,t,-n,-e,-t,-n,-e,-t,n,-e,t,-n,e,t,n,e,-t,n,e,-t,-n,e,t,-n,e,t,n,e,-t,-n,e,t,n,-e,t,n,-e,-t,n,-e,-t,n,e,-t,n,e,t,n,e,-t,-n,-e,-t,-n,-e,t,-n,e,t,-n,e,-t,-n,-e,t,-n])),t=new Float32Array([0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1]),n=new Float32Array([1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,1,0,0]),[0,2,1,3,5,4,6,8,7,9,11,10,12,14,13,15,17,16,18,20,19,21,23,22,24,26,25,27,29,28,30,32,31,33,35,34]),i=new Uint16Array(r.reverse());this.setIndices(i),this.setAttribute(Nae.position,e),this.setAttribute(Nae.normal,t),this.setAttribute(Nae.uv,n),this.setAttribute(Nae.TEXCOORD_1,n),this.addSubGeometry({indexStart:0,indexCount:r.length,vertexStart:0,index:0})}}var Ice=(e=>(e[e.Key_BackSpace=8]="Key_BackSpace",e[e.Key_Tab=9]="Key_Tab",e[e.Key_Clear=12]="Key_Clear",e[e.Key_Enter=13]="Key_Enter",e[e.Key_Shift_L=16]="Key_Shift_L",e[e.Key_Control_L=17]="Key_Control_L",e[e.Key_Alt_L=18]="Key_Alt_L",e[e.Key_Pause=19]="Key_Pause",e[e.Key_CapsLock=20]="Key_CapsLock",e[e.Key_Escape=21]="Key_Escape",e[e.Key_Esc=27]="Key_Esc",e[e.Key_Space=32]="Key_Space",e[e.Key_Prior=33]="Key_Prior",e[e.Key_Next=34]="Key_Next",e[e.Key_End=35]="Key_End",e[e.Key_Home=36]="Key_Home",e[e.Key_Left=37]="Key_Left",e[e.Key_Up=38]="Key_Up",e[e.Key_Right=39]="Key_Right",e[e.Key_Down=40]="Key_Down",e[e.Key_Select=41]="Key_Select",e[e.Key_Print=42]="Key_Print",e[e.Key_Execute=43]="Key_Execute",e[e.Key_Insert=45]="Key_Insert",e[e.Key_Delete=46]="Key_Delete",e[e.Key_Help=47]="Key_Help",e[e.Key_0=48]="Key_0",e[e.Key_1=49]="Key_1",e[e.Key_2=50]="Key_2",e[e.Key_3=51]="Key_3",e[e.Key_4=52]="Key_4",e[e.Key_5=53]="Key_5",e[e.Key_6=54]="Key_6",e[e.Key_7=55]="Key_7",e[e.Key_8=56]="Key_8",e[e.Key_9=57]="Key_9",e[e.Key_A=65]="Key_A",e[e.Key_B=66]="Key_B",e[e.Key_C=67]="Key_C",e[e.Key_D=68]="Key_D",e[e.Key_E=69]="Key_E",e[e.Key_F=70]="Key_F",e[e.Key_G=71]="Key_G",e[e.Key_H=72]="Key_H",e[e.Key_I=73]="Key_I",e[e.Key_J=74]="Key_J",e[e.Key_K=75]="Key_K",e[e.Key_L=76]="Key_L",e[e.Key_M=77]="Key_M",e[e.Key_N=78]="Key_N",e[e.Key_O=79]="Key_O",e[e.Key_P=80]="Key_P",e[e.Key_Q=81]="Key_Q",e[e.Key_R=82]="Key_R",e[e.Key_S=83]="Key_S",e[e.Key_T=84]="Key_T",e[e.Key_U=85]="Key_U",e[e.Key_V=86]="Key_V",e[e.Key_W=87]="Key_W",e[e.Key_X=88]="Key_X",e[e.Key_Y=89]="Key_Y",e[e.Key_Z=90]="Key_Z",e[e.Key_KP_0=96]="Key_KP_0",e[e.Key_KP_1=97]="Key_KP_1",e[e.Key_KP_2=98]="Key_KP_2",e[e.Key_KP_3=99]="Key_KP_3",e[e.Key_KP_4=100]="Key_KP_4",e[e.Key_KP_5=101]="Key_KP_5",e[e.Key_KP_6=102]="Key_KP_6",e[e.Key_KP_7=103]="Key_KP_7",e[e.Key_KP_8=104]="Key_KP_8",e[e.Key_KP_9=105]="Key_KP_9",e[e.Key_Multiply=106]="Key_Multiply",e[e.Key_Add=107]="Key_Add",e[e.Key_Separator=108]="Key_Separator",e[e.Key_Subtract=109]="Key_Subtract",e[e.Key_Decimal=110]="Key_Decimal",e[e.Key_Divide=111]="Key_Divide",e[e.Key_F1=112]="Key_F1",e[e.Key_F2=113]="Key_F2",e[e.Key_F3=114]="Key_F3",e[e.Key_F4=115]="Key_F4",e[e.Key_F5=116]="Key_F5",e[e.Key_F6=117]="Key_F6",e[e.Key_F7=118]="Key_F7",e[e.Key_F8=119]="Key_F8",e[e.Key_F9=120]="Key_F9",e[e.Key_F10=121]="Key_F10",e[e.Key_F11=122]="Key_F11",e[e.Key_F12=123]="Key_F12",e[e.Key_F13=124]="Key_F13",e[e.Key_F14=125]="Key_F14",e[e.Key_F15=126]="Key_F15",e[e.Key_F16=127]="Key_F16",e[e.Key_F17=128]="Key_F17",e[e.Key_F18=129]="Key_F18",e[e.Key_F19=130]="Key_F19",e[e.Key_F20=131]="Key_F20",e[e.Key_F21=132]="Key_F21",e[e.Key_F22=133]="Key_F22",e[e.Key_F23=134]="Key_F23",e[e.Key_F24=135]="Key_F24",e[e.Key_Num_Lock=136]="Key_Num_Lock",e[e.Key_Scroll_Lock=137]="Key_Scroll_Lock",e))(Ice||{});class Oce{static add(e,t,n){return(n=n||new Rre).x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z,n}static sub(e,t,n){return(n=n||new Rre).x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z,n}static mul(e,t,n){return(n=n||new Rre).x=e.x*t.x,n.y=e.y*t.y,n.z=e.z*t.z,n}static mulScale(e,t,n){return(n=n||new Rre).x=e.x*t,n.y=e.y*t,n.z=e.z*t,n}static div(e,t,n){return(n=n||new Rre).x=e.x/t.x,n.y=e.y/t.y,n.z=e.z/t.z,n}static normalize(e){return e.clone().normalize()}static dot(e,t){var n=Rre.HELP_0;return n.copyFrom(e),n.dotProduct(t)}static calculateVectorAngle_xz(e,t){return Math.acos((e.x*t.x+e.y*t.y)/Math.sqrt((e.x*e.x+e.y*e.y)*(t.x*t.x+t.y*t.y)))}static distance(e,t){return Rre.distance(e,t)}static getRandomXYZ(e=-100,t=100){return new Rre(Math.random()*t+e,Math.random()*t+e,Math.random()*t+e)}static getRandomV3(e=-100,t=100,n,r){return new Rre(Math.random()*t+e,Math.random()*r+n,Math.random()*t+e)}}class Nce extends iae{constructor(){super(),bre(this,"camera"),bre(this,"minDistance",.1),bre(this,"maxDistance",500),bre(this,"rollSmooth",15),bre(this,"dragSmooth",20),bre(this,"wheelSmooth",10),bre(this,"wheelStep",.002),bre(this,"mouseRightFactor",.5),bre(this,"mouseLeftFactor",20),bre(this,"smooth",!0),bre(this,"_wheelStep",.002),bre(this,"_distance",0),bre(this,"distance",10),bre(this,"_roll",0),bre(this,"roll",0),bre(this,"_pitch",0),bre(this,"pitch",0),bre(this,"_currentPos"),bre(this,"_targetPos"),bre(this,"_mouseLeftDown",!1),bre(this,"_mouseRightDown",!1),bre(this,"_bottomClamp",89.99),bre(this,"_topClamp",-89.99),bre(this,"_tempDir",new Rre),bre(this,"_tempPos",new Rre),this._currentPos=new bae,this._targetPos=new bae}start(){this.camera=this.object3D.getOrAddComponent(dae),nce.inputSystem.addEventListener(Are.POINTER_DOWN,this.onMouseDown,this),nce.inputSystem.addEventListener(Are.POINTER_MOVE,this.onMouseMove,this),nce.inputSystem.addEventListener(Are.POINTER_UP,this.onMouseUp,this),nce.inputSystem.addEventListener(Are.POINTER_WHEEL,this.onMouseWheel,this)}setCamera(e,t,n,r){this.roll=e,this.pitch=t,this.distance=n,this.maxDistance=1.2*n,r&&this._targetPos.transform.localPosition.copy(r)}focusByBounds(e){e=yae.genMeshBounds(e),this.target=e.center}set target(e){this._targetPos.transform.localPosition.copy(e)}get target(){return this._targetPos.transform.localPosition}onMouseWheel(e){this.enable&&(this._wheelStep=this.wheelStep*Oce.distance(this._currentPos.transform.worldPosition,this.camera.transform.worldPosition)/10,this.distance-=nce.inputSystem.wheelDelta*this._wheelStep,this.distance=Wie(this.distance,this.minDistance,this.maxDistance))}onMouseDown(e){if(this.enable)switch(e.mouseCode){case 0:this._mouseLeftDown=!0;break;case 1:break;case 2:this._mouseRightDown=!0}}onMouseUp(e){this._mouseLeftDown=!1,this._mouseRightDown=!1}onMouseMove(e){var t;this.enable&&(this._mouseRightDown&&(t=this.camera.transform.forward,Oce.mulScale(t,.25*e.movementY*this.camera.aspect,Rre.HELP_1),this._targetPos.x+=Rre.HELP_1.x*this.mouseRightFactor,this._targetPos.z+=Rre.HELP_1.z*this.mouseRightFactor,t=this.camera.transform.right,Oce.mulScale(t,.25*-e.movementX,Rre.HELP_1),this._targetPos.x-=Rre.HELP_1.x*this.mouseRightFactor,this._targetPos.z-=Rre.HELP_1.z*this.mouseRightFactor),this._mouseLeftDown)&&(this.roll-=e.movementX*Sre.delta*.001*this.mouseLeftFactor,this.pitch-=e.movementY*Sre.delta*.001*this.mouseLeftFactor,this.pitch=Wie(this.pitch,this._topClamp,this._bottomClamp))}onBeforeUpdate(e){var t;this.enable&&(t=Wie(Sre.delta,0,.016),this.smooth?(this._currentPos.x+=(this._targetPos.x-this._currentPos.x)*t*this.dragSmooth,this._currentPos.y+=(this._targetPos.y-this._currentPos.y)*t*this.dragSmooth,this._currentPos.z+=(this._targetPos.z-this._currentPos.z)*t*this.dragSmooth,this._distance+=(this.distance-this._distance)*t*this.wheelSmooth,this._roll+=(this.roll-this._roll)*t*this.rollSmooth,this._pitch+=(this.pitch-this._pitch)*t*this.rollSmooth):(this._currentPos.x=this._targetPos.x,this._currentPos.y=this._targetPos.y,this._currentPos.z=this._targetPos.z,this._distance=this.distance,this._roll=this.roll,this._pitch=this.pitch),this._tempDir.set(0,0,1),(t=Gie.HELP_0).fromEulerAngles(this._pitch,this._roll,0),this._tempDir.applyQuaternion(t),this._tempPos=Oce.mulScale(this._tempDir,this._distance,this._tempPos),this._tempPos.add(this._currentPos.transform.localPosition,this._tempPos),this.transform.lookAt(this._tempPos,this._currentPos.transform.localPosition,Rre.UP),this.camera.lookTarget.copy(this._currentPos.transform.localPosition))}destroy(e){nce.inputSystem.removeEventListener(Are.POINTER_DOWN,this.onMouseDown,this),nce.inputSystem.removeEventListener(Are.POINTER_MOVE,this.onMouseMove,this),nce.inputSystem.removeEventListener(Are.POINTER_UP,this.onMouseUp,this),nce.inputSystem.removeEventListener(Are.POINTER_WHEEL,this.onMouseWheel,this),super.destroy(e),this.camera=null}}var Bce=(e=>(e[e.NORMAL=0]="NORMAL",e[e.DOWN=1]="DOWN",e[e.OVER=2]="OVER",e[e.DISABLE=3]="DISABLE",e))(Bce||{});let Uce=2*Math.PI;class zce{constructor(e=1,t=0,n=0,r=1,i=0,a=0){bre(this,"a"),bre(this,"b"),bre(this,"c"),bre(this,"d"),bre(this,"tx"),bre(this,"ty"),this.a=e,this.b=t,this.c=n,this.d=r,this.tx=i,this.ty=a}clone(){return new zce(this.a,this.b,this.c,this.d,this.tx,this.ty)}concat(e){var t=this.a,n=this.c,r=this.tx;this.a=t*e.a+this.b*e.c,this.b=t*e.b+this.b*e.d,this.c=n*e.a+this.d*e.c,this.d=n*e.b+this.d*e.d,this.tx=r*e.a+this.ty*e.c+e.tx,this.ty=r*e.b+this.ty*e.d+e.ty}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}identity(){return this.a=this.d=1,this.b=this.c=this.tx=this.ty=0,this}invert(){this._invertInto(this)}rotate(e){var t,n,r,i,a,s,o;0!=(e=+e)&&(e*=jie,t=Math.cos(e),e=Math.sin(e),n=this.a,r=this.b,i=this.c,a=this.d,s=this.tx,o=this.ty,this.a=n*t-r*e,this.b=n*e+r*t,this.c=i*t-a*e,this.d=i*e+a*t,this.tx=s*t-o*e,this.ty=s*e+o*t)}scale(e,t){1!==e&&(this.a*=e,this.c*=e,this.tx*=e),1!==t&&(this.b*=t,this.d*=t,this.ty*=t)}setTo(e,t,n,r,i,a){return this.a=e,this.b=t,this.c=n,this.d=r,this.tx=i,this.ty=a,this}transformPoint(e,t,n){var r=this.a*e+this.c*t+this.tx;e=this.b*e+this.d*t+this.ty;return n?(n.setTo(r,e,0,1),n):new Rre(r,e,0,1)}setTranslate(e,t){this.tx=e,this.ty=t}translate(e,t){this.tx+=e,this.ty+=t}mul(e){var t=this.a,n=this.b,r=this.c,i=this.d,a=this.tx,s=this.ty,o=e.a,l=e.b,u=e.c,c=e.d,d=e.tx;e=e.ty;0!==l||0!==u?(this.a=t*o+n*u,this.b=t*l+n*c,this.c=r*o+i*u,this.d=r*l+i*c,this.tx=o*a+u*s+d,this.ty=l*a+c*s+e):(this.a=t*o,this.b=n*c,this.c=r*o,this.d=i*c,this.tx=o*a+d,this.ty=c*s+e)}equals(e){return this.a==e.a&&this.b==e.b&&this.c==e.c&&this.d==e.d&&this.tx==e.tx&&this.ty==e.ty}prepend(e,t,n,r,i,a){var s,o,l=this.tx;return 1==e&&0==t&&0==n&&1==r||(s=this.a,o=this.c,this.a=s*e+this.b*n,this.b=s*t+this.b*r,this.c=o*e+this.d*n,this.d=o*t+this.d*r),this.tx=l*e+this.ty*n+i,this.ty=l*t+this.ty*r+a,this}append(e){var t=this.a,n=this.b,r=this.c,i=this.d;return 1==e.a&&0==e.b&&0==e.c&&1==e.d||(this.a=e.a*t+e.b*r,this.b=e.a*n+e.b*i,this.c=e.c*t+e.d*r,this.d=e.c*n+e.d*i),this.tx=e.tx*t+e.ty*r+this.tx,this.ty=e.tx*n+e.ty*i+this.ty,this}deltaTransformPoint(e){var t=this.a*e.x+this.c*e.y;e=this.b*e.x+this.d*e.y;return new Rre(t,e)}toString(){return"(a="+this.a+", b="+this.b+", c="+this.c+", d="+this.d+", tx="+this.tx+", ty="+this.ty+")"}createBox(e,t,n=0,r=0,i=0){var a,s=this;0!==n?(n*=jie,a=Math.cos(n),n=Math.sin(n),s.a=a*e,s.b=n*t,s.c=-n*e,s.d=a*t):(s.a=e,s.b=0,s.c=0,s.d=t),s.tx=r,s.ty=i}createGradientBox(e,t,n=0,r=0,i=0){this.createBox(e/1638.4,t/1638.4,n,r+e/2,i+t/2)}_invertInto(e){let t=this.a,n=this.b,r=this.c,i=this.d,a=this.tx,s=this.ty;var o,l;0==n&&0==r?(e.b=e.c=0)==t||0==i?e.a=e.d=e.tx=e.ty=0:(t=e.a=1/t,i=e.d=1/i,e.tx=-t*a,e.ty=-i*s):0==(o=t*i-n*r)?e.identity():(o=1/o,l=e.a=i*o,n=e.b=-n*o,r=e.c=-r*o,i=e.d=t*o,e.tx=-(l*a+r*s),e.ty=-(n*a+i*s))}getScaleX(){var e;return 1==this.a&&0==this.b?1:(e=Math.sqrt(this.a*this.a+this.b*this.b),this.getDeterminant()<0?-e:e)}getScaleY(){var e;return 0==this.c&&1==this.d?1:(e=Math.sqrt(this.c*this.c+this.d*this.d),this.getDeterminant()<0?-e:e)}getSkewX(){return Math.atan2(this.d,this.c)-Math.PI/2}getSkewY(){return Math.atan2(this.b,this.a)}updateScaleAndRotation(e,t,n,r){var i,a;0!=n&&n!=Uce||0!=r&&r!=Uce?(n*=jie,r*=jie,i=Math.cos(n),a=Math.sin(n),n==r?(this.a=i*e,this.b=a*e):(this.a=Math.cos(r)*e,this.b=Math.sin(r)*e),this.c=-a*t,this.d=i*t):(this.a=e,this.b=this.c=0,this.d=t)}preMultiplyInto(e,t){let n=e.a*this.a,r=0,i=0,a=e.d*this.d,s=e.tx*this.a+this.tx,o=e.ty*this.d+this.ty;0===e.b&&0===e.c&&0===this.b&&0===this.c||(n+=e.b*this.c,a+=e.c*this.b,r+=e.a*this.b+e.b*this.d,i+=e.c*this.a+e.d*this.c,s+=e.ty*this.c,o+=e.tx*this.b),t.a=n,t.b=r,t.c=i,t.d=a,t.tx=s,t.ty=o}$transformBounds(e){let t=this.a,n=this.b,r=this.c,i=this.d,a=this.tx,s=this.ty,o=e.x,l=e.y,u=o+e.width,c=l+e.height,d=t*o+r*l+a,h=n*o+i*l+s,p=t*u+r*l+a,f=n*u+i*l+s,m=t*u+r*c+a,g=n*u+i*c+s,v=t*o+r*c+a,y=n*o+i*c+s,_=0;d>p&&(_=d,d=p,p=_),m>v&&(_=m,m=v,v=_),e.x=Math.floor(d<m?d:m),e.width=Math.ceil((p>v?p:v)-e.x),h>f&&(_=h,h=f,f=_),g>y&&(_=g,g=y,y=_),e.y=Math.floor(h<g?h:g),e.height=Math.ceil((f>y?f:y)-e.y)}getDeterminant(){return this.a*this.d-this.b*this.c}}class Fce extends iae{constructor(){super(...arguments),bre(this,"index",0)}addChild(e){return this.object3D.addChild(e),this}removeChild(e){return this.object3D.removeChild(e),this}cloneTo(e){console.error("UICanvas Can not be Clone!")}}var Vce=(e=>(e[e.NONE=0]="NONE",e[e.POSITION=1]="POSITION",e[e.SPRITE=2]="SPRITE",e[e.COLOR=4]="COLOR",e[e.MAX=7]="MAX",e))(Vce||{});class Gce{constructor(e){bre(this,"array"),bre(this,"buffer"),this.buffer=new Aie(e,0),this.array=new Float32Array(this.buffer.memory.shareDataBuffer)}}class Hce extends voe{constructor(e){super(),bre(this,"_attributeUV"),bre(this,"_attributeVIndex"),bre(this,"_faceIndexes"),bre(this,"_uvSize",2),bre(this,"_vIndexSize",1),bre(this,"_posAttribute"),bre(this,"_spriteAttribute"),bre(this,"_colorAttribute"),bre(this,"_onPositionChange",!0),bre(this,"_onSpriteChange",!0),bre(this,"_onColorChange",!0),bre(this,"maxQuadCount"),this.maxQuadCount=e}updateBounds(e,t){var n=.1*Number.MAX_VALUE;return e=new Rre(-n,-n,-n),t=new Rre(n,n,n),this.bounds.setFromMinMax(e,t),this}get vPositionBuffer(){return this._onPositionChange&&(this._posAttribute.buffer.apply(),this._onPositionChange=!1),this._posAttribute.buffer}get vSpriteBuffer(){return this._onSpriteChange&&(this._spriteAttribute.buffer.apply(),this._onSpriteChange=!1),this._spriteAttribute.buffer}get vColorBuffer(){return this._onColorChange&&(this._colorAttribute.buffer.apply(),this._onColorChange=!1),this._colorAttribute.buffer}create(){this.createBuffer(),this.updateBounds();var e=this.maxQuadCount,t=[],n=[];for(let a=0;a<e;a++)t.push(...Yce.attUV);for(let a=0,s=this.maxQuadCount*Yce.vertexCount;a<s;a++)n[a]=a;this._attributeUV=new Float32Array(Yce.vertexCount*e*this._uvSize),this._attributeVIndex=new Float32Array(Yce.vertexCount*e*this._vIndexSize),this._attributeUV.set(t,0),this._attributeVIndex.set(n,0);var r=[];for(let a=0;a<e;a++)for(let e=0;e<Yce.indecies.length;e++){var i=Yce.indecies[e]+4*a;r.push(i)}return this._faceIndexes=new Uint32Array(6*e),this._faceIndexes.set(r,0),this.setIndices(this._faceIndexes),this.setAttribute(Nae.uv,this._attributeUV),this.setAttribute(Nae.vIndex,this._attributeVIndex),this.addSubGeometry({indexStart:0,indexCount:this._faceIndexes.length,vertexStart:0,index:0}),this}createBuffer(){var e=this.maxQuadCount;this._posAttribute=new Gce(4*e),this._spriteAttribute=new Gce(12*e),this._colorAttribute=new Gce(4*e)}fillQuad(e,t){e.dirtyAttributes&Vce.POSITION&&this.fillQuadPosition(e,t),e.dirtyAttributes&Vce.COLOR&&this.fillQuadColor(e,t),e.dirtyAttributes&Vce.SPRITE&&this.fillQuadSprite(e,t)}fillQuadPosition(e,t){Wce.setXYZW(this._posAttribute.array,e.z,e.left,e.bottom,e.right,e.top),this._onPositionChange=!0}fillQuadColor(e,t){var n=e.color,r=this._colorAttribute.array;Wce.setXYZW(r,e.z,n.r,n.g,n.b,n.a),this._onColorChange=!0}fillQuadSprite(e,t){let n=e.sprite,r=0,i=0;n.isSliced&&e.imageType==_ce.Sliced&&(r=n.trimSize.x,r=(t.width-(n.offsetSize.z-n.trimSize.x))/r,i=n.trimSize.y,i=(t.height-(n.offsetSize.w-n.trimSize.y))/i);t=n.guiTexture.dynamicId;var a=n.uvRec,s=n.uvBorder,o=this._spriteAttribute.array,l=12*e.z;o[0+l]=a.x,o[1+l]=a.y,o[2+l]=a.z,o[3+l]=a.w,o[4+l]=s.w,o[5+l]=s.y,o[6+l]=s.z,o[7+l]=s.w,o[8+l]=r,o[9+l]=i,o[10+l]=t,o[11+l]=e.visible?1:0,this._onSpriteChange=!0}}class jce{static set(e,t,n,r,...i){var a=t*r+n;for(let s=0,o=i.length;s<o;s++)e[a+s]=i[s]}}class Wce extends jce{static setXYZW(e,t,n,r,i,a){this.set(e,t,0,4,n,r,i,a)}static setXYZ(e,t,n,r,i){this.set(e,t,0,4,n,r,i)}static setZ(e,t,n){this.set(e,t,3,4,n)}}class Yce{}bre(Yce,"vertexCount",4),bre(Yce,"attUV",[0,0,1,0,1,1,0,1]),bre(Yce,"indecies",[0,1,2,0,2,3]);class $ce{constructor(){bre(this,"_textureMap",new Map),bre(this,"_textureList",[])}build(e,t,n){let r,i=-1,a=-1,s=(this._textureMap.clear(),this._textureList.length=0,[]),o=t.quadMaxCount-1;for(var l of e){var u,c=l.needUpdateQuads,d=(s.length=0,this.collectQuads(l.object3D,s));for(u of d){if(u.z=++i,u.sprite&&u.sprite.guiTexture){var h=u.sprite.guiTexture;if(!this._textureMap.has(h.staticId)&&(++a,this._textureMap.set(h.staticId,h),h.dynamicId=a,this._textureList[a]=h.texture,7<a)){console.warn("texture Count Exceeded the maximum limit of 7");break}}if((c||n)&&(u.dirtyAttributes=Vce.MAX),u.dirtyAttributes&Vce.POSITION&&u.applyTransform(l),u.dirtyAttributes&&u.writeToGeometry(t._geometry,l),i==o){r=!0;break}}if(r)break}return t._uiMaterial.setTextures(this._textureList),t._limitVertexCount=4*(i+1),!r}collectQuads(e,t){var n;for(n of(t=t||[],e.components.values())){var r,i=n;!i.isUIShadow&&i.mainQuads&&((r=i.getShadowRender())&&this.push(r.mainQuads,t),this.push(i.mainQuads,t))}return t}push(e,t){e&&0<e.length&&t.push(...e)}}const Xce=class{static bindTextureArray(){let e="";for(let t=0;t<7;t++)e+=`\n        @group(1) @binding(auto)\n        var tex_${t}Sampler: sampler;\n        @group(1) @binding(auto)\n#if VideoTexture${t}\n        var tex_${t}: texture_external;\n#else\n        var tex_${t}: texture_2d<f32>;\n#endif\n`;return e}static sampleTexture(e){return`\n#if VideoTexture${e}\n            let size = textureDimensions(tex_${e}).xy - 1;\n            uv.y = 1.0 - uv.y;\n            let iuv = vec2<i32>(uv * vec2<f32>(size));\n            color = textureLoad(tex_${e}, iuv) ;\n#else\n            color = textureSampleLevel(tex_${e}, tex_${e}Sampler, uv, 0.0);\n#endif        `}};let qce,Kce=Xce;bre(Kce,"fs",`\n        ${Vre}\n        ${Xce.bindTextureArray()}\n\n        var<private> fragmentOutput: FragmentOutput;\n        var<private> uvSlice: vec2<f32>;\n        var<private> EPSILON: f32 = 0.001;\n        \n        fn sliceBorder(s0:f32, scale:f32, border0:vec2<f32>) -> f32 \n        {\n          var s = s0;\n          var border = border0;\n          var borderScale = vec2<f32>(border.x / scale, 1.0 - (1.0 - border.y) / scale);\n          if(s < borderScale.x){\n            s *= scale;\n          }else if(s < borderScale.y){\n            var t = (s - borderScale.x) / (borderScale.y - borderScale.x);\n            s = t * (border.y - border.x) + border.x;\n          }else{\n            s = 1.0 - (1.0 - s) * scale;\n          }\n          return s;\n        }\n\n        fn isInsideAlpha(coord:vec2<f32>, rect:vec4<f32>, cornerRadius0:f32, fadeOutSize0:f32) -> f32\n        {\n            var minX = min(rect.x, rect.z);\n            var maxX = max(rect.x, rect.z);\n            var minY = min(rect.y, rect.w);\n            var maxY = max(rect.y, rect.w);\n\n            var cornerRadius = max(EPSILON, cornerRadius0);\n\n            var center = vec2<f32>(minX + maxX, minY + maxY) * 0.5;\n            var extents = vec2<f32>(maxX - minX, maxY - minY) * 0.5;\n\n            cornerRadius = min(extents.x, cornerRadius);\n            cornerRadius = min(extents.y, cornerRadius);\n            \n            var extendsMin = max(vec2<f32>(0.0), extents - cornerRadius);\n            \n            var toCenter = abs(coord - center);\n            var outerDist = toCenter - extents;\n            var innerDist = toCenter - extendsMin;\n            \n            if(innerDist.x <= 0 && innerDist.y <= 0){\n                return 1.0;\n            }else if(outerDist.x <= 0 && outerDist.y <= 0){\n                var fadeOutPercent = clamp(fadeOutSize0, EPSILON, cornerRadius) / cornerRadius;\n                innerDist = max(vec2(EPSILON), innerDist);\n                var distance = min(cornerRadius, length(innerDist));\n                var alpha = 1.0 - distance / cornerRadius;\n                alpha /= fadeOutPercent;\n                alpha = clamp(alpha, 0.0, 1.0);\n                return alpha;\n            }\n            return 0.0;\n        }\n        \n        @fragment\n        fn FragMain( \n            @location(0) vUV: vec2<f32>,\n            @location(1) vColor4: vec4<f32>,\n            @location(2) vLocalPos: vec2<f32>,\n            @location(3) vUvRec: vec4<f32>,\n            @location(4) vUvBorder: vec4<f32>,\n            @location(5) vUvSlice: vec2<f32>,\n            @location(6) vTextureID: f32,\n            @builtin(front_facing) face: bool,\n            @builtin(position) fragCoord : vec4<f32> \n        ) -> FragmentOutput {\n\n            var scissorAlpha = 1.0;\n#if SCISSOR_ENABLE\n            scissorAlpha = isInsideAlpha(\n                vLocalPos.xy,\n                materialUniform.scissorRect,\n                materialUniform.scissorCornerRadius,\n                materialUniform.scissorFadeOutSize);\n\n            if(scissorAlpha < EPSILON){\n                discard;\n            }\n#endif\n\n            uvSlice = vUvSlice;\n            \n            var uv:vec2<f32> = vUV;\n            if(uvSlice.x > 1.0){ uv.x = sliceBorder(uv.x, uvSlice.x, vUvBorder.xz);}\n            if(uvSlice.y > 1.0){ uv.y = sliceBorder(uv.y, uvSlice.y, vUvBorder.yw);}\n            uv = uv * vUvRec.zw + vUvRec.xy;\n            \n            var color = vec4<f32>(0.0,0.0,0.0,1.0);\n            let texId = i32(vTextureID + 0.5);\n            \n            var texSize = vec2<i32>(0);\n            var coord = vec2<i32>(0);\n            \n            if(texId == 0){\n                ${Xce.sampleTexture(0)}\n            }else if(texId == 1){\n                ${Xce.sampleTexture(1)}\n            }else if(texId == 2){\n                ${Xce.sampleTexture(2)}\n            }else if(texId == 3){            \n                ${Xce.sampleTexture(3)}\n            }else if(texId == 4){            \n                ${Xce.sampleTexture(4)}\n            }else if(texId == 5){            \n                ${Xce.sampleTexture(5)}\n            }else if(texId == 6){            \n                ${Xce.sampleTexture(6)}\n            }\n            color *= vColor4;\n            color.a *= scissorAlpha;\n            if(color.a < EPSILON)\n            { \n                discard;\n            }\n\n            fragmentOutput.color = color;\n            return fragmentOutput ;\n        }`),bre(Kce,"GUI_common_vs",`\n        ${Fre}\n        ${zre}\n\n        struct VertexSpriteBuffer {\n            vUvRec: vec4<f32>,\n            vUvBorder: vec4<f32>,\n            vUvSlice: vec2<f32>,\n            vTextureID: f32,\n            vVisible: f32\n        }\n                \n        struct MaterialUniform{\n            scissorRect:vec4<f32>,\n            screen:vec2<f32>,\n            scissorCornerRadius:f32,\n            scissorFadeOutSize:f32,\n            limitVertex:f32,\n        }\n        \n        struct VertexOutput {\n            @location(0) vUV: vec2<f32>,\n            @location(1) vColor4: vec4<f32>,\n            @location(2) vLocalPos: vec2<f32>,\n            @location(3) vUvRec: vec4<f32>,\n            @location(4) vUvBorder: vec4<f32>,\n            @location(5) vUvSlice: vec2<f32>,\n            @location(6) vTextureID: f32,\n            \n            @builtin(position) member: vec4<f32>\n        };\n        \n         struct VertexInput{\n            @builtin(instance_index) index : u32,\n            @location(0) uv: vec2<f32>,\n            @location(1) vIndex: f32,\n        }\n\n        @group(2) @binding(0)\n        var<uniform> materialUniform : MaterialUniform;\n        @group(3) @binding(1)\n        var<storage, read> vPositionBuffer: array<vec4<f32>>;\n        @group(3) @binding(2)\n        var<storage, read> vSpriteBuffer: array<VertexSpriteBuffer>;\n        @group(3) @binding(3)\n        var<storage, read> vColorBuffer: array<vec4<f32>>;\n\n        var<private> vertexOut: VertexOutput ;\n\n        //quad: (left, bottom, right, top)\n        //index: 0~3\n        fn getVertexXY(quad:vec4<f32>, index:u32) -> vec2<f32>\n        {\n            var ret = vec2<f32>(0.0);\n            if(index == 0 || index == 3){\n                ret.x = quad.x;\n            }else{\n                ret.x = quad.z;\n            }\n            if(index == 0 || index == 1){\n                ret.y = quad.w;\n            }else{\n                ret.y = quad.y;\n            }\n            return ret;\n        }\n    `),bre(Kce,"GUI_shader_view",`\n        ${Xce.GUI_common_vs}\n\n        @vertex\n        fn VertMain( vertex:VertexInput ) -> VertexOutput {\n            var _m = models.matrix[0];\n            var _n = globalUniform.frame;\n            \n            let vertexIndex = vertex.vIndex;\n            let quadIndex = u32(vertex.vIndex * 0.25);\n            let vertexPosition = getVertexXY(vPositionBuffer[quadIndex], u32(vertexIndex) % 4u);\n            var vSpriteData = vSpriteBuffer[quadIndex];\n            \n            var op = vec2<f32>(0.0001);\n            let isValidVertex = vSpriteData.vVisible > 0.5 && vertexIndex < materialUniform.limitVertex;\n            if(isValidVertex){\n                op = 2.0 * vertexPosition / materialUniform.screen;\n            }\n\n            vertexOut.vLocalPos = vertexPosition;\n            vertexOut.member = vec4<f32>(op.x, op.y, vertexIndex * 0.0001, 1.0);\n\n            vertexOut.vUV = vec2<f32>(vertex.uv);\n            vertexOut.vUvRec = vSpriteData.vUvRec;\n            vertexOut.vUvBorder = vSpriteData.vUvBorder;\n            vertexOut.vUvSlice = vSpriteData.vUvSlice;\n            vertexOut.vTextureID = vSpriteData.vTextureID;\n            vertexOut.vColor4 = vColorBuffer[quadIndex];\n\n            return vertexOut;\n         }\n         \n         ${Xce.fs}\n        `),bre(Kce,"GUI_shader_world",`\n        ${Xce.GUI_common_vs}\n        @vertex\n        fn VertMain( vertex:VertexInput ) -> VertexOutput {\n            var modelMatrix = models.matrix[vertex.index];\n            \n            let vertexIndex = vertex.vIndex;\n            let quadIndex = u32(vertex.vIndex * 0.25);\n            let vertexPosition = getVertexXY(vPositionBuffer[quadIndex], u32(vertexIndex) % 4u);\n            var localPos = vec4<f32>(vertexPosition.xy, vertexIndex * 0.0001, 1.0) ;\n            var op = vec4<f32>(0.0001);\n            var vSpriteData = vSpriteBuffer[quadIndex];\n\n            let isValidVertex = vSpriteData.vVisible > 0.5 && vertexIndex < materialUniform.limitVertex;\n            if(isValidVertex){\n                op = globalUniform.projMat * globalUniform.viewMat * modelMatrix * localPos ;\n            }\n\n            vertexOut.vLocalPos = vertexPosition;\n            vertexOut.member = op;\n\n            vertexOut.vUV = vec2<f32>(vertex.uv);\n            vertexOut.vUvRec = vSpriteData.vUvRec;\n            vertexOut.vUvBorder = vSpriteData.vUvBorder;\n            vertexOut.vUvSlice = vSpriteData.vUvSlice;\n            vertexOut.vTextureID = vSpriteData.vTextureID;\n            vertexOut.vColor4 = vColorBuffer[quadIndex];\n\n            return vertexOut;\n         }\n         \n         ${Xce.fs}\n\n        `);class Zce extends kse{constructor(e){super(),bre(this,"_scissorRect"),bre(this,"_screenSize",new Wre),bre(this,"_scissorEnable",!1),bre(this,"_videoTextureFlags",{}),Hre.register("GUI_shader_view",Kce.GUI_shader_view),Hre.register("GUI_shader_world",Kce.GUI_shader_world);var t=e==yce.View?"GUI_shader_view":"GUI_shader_world";(t=this.setShader(t,t)).setShaderEntry("VertMain","FragMain"),t.setUniformVector2("screen",new Wre(1024,1024)),t.setUniformVector4("scissorRect",new $re),t.setUniformFloat("scissorCornerRadius",0),t.setUniformFloat("scissorFadeOutSize",0),t.setUniformFloat("limitVertex",0),t.shaderState.depthWriteEnabled=!1,this.blendMode=Bae.ALPHA,this.depthCompare=e==yce.View?eie:Qre,this.cullMode=rie,this.transparent=!0,this.receiveEnv=!1}setLimitVertex(e){this.renderShader.setUniformFloat("limitVertex",e)}setScissorRect(e,t,n,r){this._scissorRect||(this._scissorRect=new $re),this._scissorRect.set(e,t,n,r),this.renderShader.setUniformVector4("scissorRect",this._scissorRect)}setScissorEnable(e){this._scissorEnable!=e&&((this._scissorEnable=e)?this.renderShader.setDefine("SCISSOR_ENABLE",!0):this.renderShader.deleteDefine("SCISSOR_ENABLE"),this.renderShader.noticeStateChange())}setScissorCorner(e,t){this.renderShader.setUniformFloat("scissorCornerRadius",e),this.renderShader.setUniformFloat("scissorFadeOutSize",t)}setScreenSize(e,t){return this._screenSize.set(e,t),this.renderShader.setUniformVector2("screen",this._screenSize),this}setTextures(e){for(let n=0;n<7;n++){var t=e[n]||nce.res.whiteTexture;this.renderShader.setTexture("tex_"+n,t),this.setVideoTextureDefine(n,t.isVideoTexture)}}setVideoTextureDefine(e,t){let n=!1;t!=this._videoTextureFlags[e]&&(t?this.renderShader.setDefine("VideoTexture"+e,!0):this.renderShader.deleteDefine("VideoTexture"+e),this._videoTextureFlags[e]=t,n=!0),n&&this.renderShader.noticeStateChange()}set envMap(e){}set shadowMap(e){}set baseMap(e){}set normalMap(e){}set emissiveMap(e){}set irradianceMap(e){}set irradianceDepthMap(e){}}class Jce extends soe{constructor(){super(...arguments),bre(this,"_guiGeometry")}init(e){super.init(),this.addRendererMask(bie.UI),this.removeRendererMask(bie.Default),this.castGI=!1,this.castShadow=!1,this.alwaysRender=!0,this._ignoreEnvMap=this._ignorePrefilterMap=!0}get geometry(){return super.geometry}set geometry(e){super.geometry=e,this._guiGeometry=e}nodeUpdate(e,t,n,r){for(let u=0;u<this.materials.length;u++){var i=this.materials[u].renderPasses.get(t),a=this._guiGeometry.vPositionBuffer,s=this._guiGeometry.vSpriteBuffer,o=this._guiGeometry.vColorBuffer;if(i)for(let e=0;e<i.length;e++){var l=i[e].renderShader;l.pipeline||(l.setStorageBuffer("vPositionBuffer",a),l.setStorageBuffer("vSpriteBuffer",s),l.setStorageBuffer("vColorBuffer",o))}}super.nodeUpdate(e,t,n,r)}onUpdate(e){this.transform.updateWorldMatrix()}}class Qce{constructor(){bre(this,"_use"),bre(this,"_unUse"),this._use=[],this._unUse=[]}pushBack(e){var t=this._use.indexOf(e);-1!=t&&(this._use.splice(t,1),this._unUse.push(e))}getOne(e){let t;return 0<this._unUse.length?(t=this._unUse[0],this._unUse.splice(0,1)):t=new e,this._use.push(t),t}hasFree(){return 0<this._unUse.length}}const ede=class{constructor(){bre(this,"x",0),bre(this,"y",0),bre(this,"z",0),bre(this,"width",1),bre(this,"height",1),bre(this,"_globalX",0),bre(this,"_globalY",0),bre(this,"_globalWidth",0),bre(this,"_globalHeight",0),bre(this,"_visible",!0),bre(this,"_offsetX",0),bre(this,"_offsetY",0),bre(this,"_sprite",nce.res.defaultGUISprite),bre(this,"_color",new wre(1,1,1,1)),bre(this,"_imageType",_ce.Simple),bre(this,"dirtyAttributes",Vce.MAX)}static get quadPool(){return this.textPool||(this.textPool=new Qce),this.textPool}static recycleQuad(e){e.sprite=null,e.dirtyAttributes=Vce.MAX,e.x=0,e.y=0,e.z=-1,ede.quadPool.pushBack(e)}static spawnQuad(){return ede.quadPool.getOne(ede)}get imageType(){return this._imageType}set imageType(e){this._imageType=e,this.setAttrChange(Vce.SPRITE|Vce.POSITION)}get color(){return this._color}set color(e){this._color.copyFrom(e),this.setAttrChange(Vce.COLOR)}get visible(){return this._visible}set visible(e){e!=this._visible&&(this._visible=e,this.setAttrChange(Vce.SPRITE))}get sprite(){return this._sprite}set sprite(e){this._sprite!=e&&(this._sprite=e,this.setAttrChange(Vce.SPRITE|Vce.POSITION))}get left(){return this._globalX-this._offsetX}get right(){return this.left+this._globalWidth}get top(){return this._globalY-this._offsetY}get bottom(){return this.top+this._globalHeight}setSize(e,t){this.width=e,this.height=t,this.setAttrChange(Vce.POSITION)}setXY(e,t){this.x=e,this.y=t,this.setAttrChange(Vce.POSITION)}setAttrChange(e){this.dirtyAttributes=this.dirtyAttributes|e}applyTransform(e){this.setAttrChange(Vce.POSITION);let t=this._sprite,n=e.getWorldMatrix();var r=(n=0==this.x&&0==this.y?n:this.getQuadMatrix(n)).getScaleX(),i=n.getScaleY(),a=t.isSliced&&this._imageType==_ce.Sliced;return this._offsetX=.5*e.width*r,this._offsetY=.5*e.height*i,a?(this._globalWidth=r*(e.width-(t.offsetSize.z-t.trimSize.x)),this._globalHeight=i*(e.height-(t.offsetSize.w-t.trimSize.y)),this._globalX=n.tx+t.offsetSize.x*r,this._globalY=n.ty+t.offsetSize.y*i):(a=this.width/t.offsetSize.z,e=this.height/t.offsetSize.w,this._globalWidth=r*t.trimSize.x*a,this._globalHeight=i*t.trimSize.y*e,this._globalX=n.tx+t.offsetSize.x*a*r,this._globalY=n.ty+t.offsetSize.y*e*i),this}getQuadMatrix(e){return(qce=qce||new zce).identity(),qce.setTranslate(this.x,this.y),qce.mul(e),qce}writeToGeometry(e,t){return e.fillQuad(this,t),this.dirtyAttributes=Vce.NONE,this}};let tde,nde=ede;bre(nde,"textPool");class rde extends iae{constructor(){super(...arguments),bre(this,"_uiTransform"),bre(this,"_visible",!0)}destroy(){this._uiTransform.setNeedUpdateUIPanel(),super.destroy()}get uiTransform(){return this._uiTransform}get visible(){return this._visible}set visible(e){this._visible!=e&&(this._visible=e,null!=(e=this.onUIComponentVisible))&&e.call(this,this._visible)}init(e){var t;null!=(t=super.init)&&t.call(this,e),this._uiTransform=this.object3D.getOrAddComponent(ude),this._uiTransform.setNeedUpdateUIPanel()}copyComponent(e){return this.visible=e.visible,this}}class ide extends rde{constructor(){super(...arguments),bre(this,"_mainQuads"),bre(this,"_shadowRender"),bre(this,"_shadowSource"),bre(this,"isUIShadow"),bre(this,"isShadowless"),bre(this,"needUpdateShadow")}init(e){var t;null!=(t=super.init)&&t.call(this,e),this._mainQuads=[]}destroy(){var e;this.detachQuads(),null!=(e=this._shadowRender)&&e.setShadowSource(null),null!=(e=this._shadowSource)&&e.setShadowRenderer(null),super.destroy(),this._shadowRender=null,this._shadowSource=null}start(){var e;null!=(e=super.start)&&e.call(this),this.isUIShadow?this.autoBindShadow(null,this):this.isShadowless||this.autoBindShadow(this,null),this.setShadowDirty()}setShadowDirty(){this._shadowRender&&(this._shadowRender.needUpdateShadow=!0)}get mainQuads(){return this._mainQuads}setShadowRenderer(e){this._shadowRender=e}setShadowSource(e){this._shadowSource=e}getShadowRender(){return this._shadowRender}autoBindShadow(e,t){var n=this.object3D.components.values();if(!e)for(var r of n)if(!r.isShadowless&&!r.isUIShadow&&r.mainQuads){e=r;break}if(!t)for(var i of n)if(i.isUIShadow&&i.mainQuads){t=i;break}return!(!e||!t||(e.setShadowRenderer(t),t.setShadowSource(e),0))}recycleQuad(e){var t;return e&&this._mainQuads&&(0<=(t=this._mainQuads.indexOf(e))?(this._mainQuads.splice(t,1),nde.recycleQuad(e)):e=null),e}attachQuad(e){return this._mainQuads&&this._mainQuads.push(e),this}detachQuads(){if(this._mainQuads)for(;0<this._mainQuads.length;){var e=this._mainQuads.shift();this.recycleQuad(e)}return this}copyComponent(e){return super.copyComponent(e),this.isUIShadow=e.isUIShadow,this.isShadowless=e.isShadowless,this}}class ade extends ide{init(e){var t;null!=(t=super.init)&&t.call(this,e),this.attachQuad(nde.spawnQuad()),this.sprite=nce.res.defaultGUISprite}cloneTo(e){e.getOrAddComponent(ade).copyComponent(this)}copyComponent(e){return super.copyComponent(e),this.sprite=e.sprite,this.color=e.color,this.imageType=e.imageType,this}set sprite(e){for(var t of(e=e||nce.res.defaultGUISprite,this._mainQuads))t.sprite=e,t.setSize(this._uiTransform.width,this._uiTransform.height);this.setShadowDirty()}onTransformResize(){this.applyTransformSize()}applyTransformSize(){for(var e of this._mainQuads)e.setSize(this._uiTransform.width,this._uiTransform.height);this.setShadowDirty()}get sprite(){return this._mainQuads[0].sprite}onUIComponentVisible(e){this.applyComponentVisible()}onUITransformVisible(e){this.applyComponentVisible()}applyComponentVisible(){var e,t=!this._visible||!this._uiTransform.globalVisible;for(e of this._mainQuads)e.visible=!t;this.setShadowDirty()}get color(){return this._mainQuads[0].color}set color(e){for(var t of this._mainQuads)t.color=e;this.setShadowDirty()}get imageType(){return this._mainQuads[0].imageType}set imageType(e){for(var t of this._mainQuads)t.imageType=e;this.setShadowDirty()}}class sde extends ade{constructor(){super(...arguments),bre(this,"space",yce.World),bre(this,"needUpdateGeometry",!0),bre(this,"panelOrder",0),bre(this,"needSortOnCameraZ"),bre(this,"_billboard"),bre(this,"_rebuild"),bre(this,"scissorEnable",!1),bre(this,"scissorCornerRadius",0),bre(this,"scissorFadeOutSize",0),bre(this,"_uiRenderer"),bre(this,"_uiMaterial"),bre(this,"_geometry"),bre(this,"_limitVertexCount",0),bre(this,"_maxCount",128),bre(this,"isUIPanel",!0),bre(this,"_collectTransform",[])}cloneTo(e){e.getOrAddComponent(sde).copyComponent(this)}copyComponent(e){return super.copyComponent(e),this.panelOrder=e.panelOrder,this.needSortOnCameraZ=e.needSortOnCameraZ,this.cullMode=e.cullMode,this.billboard=e.billboard,this.scissorEnable=e.scissorEnable,this.scissorCornerRadius=e.scissorCornerRadius,this.scissorFadeOutSize=e.scissorFadeOutSize,this}init(e){super.init(e),this.create(this.space),this.visible=!1}create(e){this._maxCount=this.space==yce.World?vce.quadMaxCountForWorld:vce.quadMaxCountForView,this._uiRenderer=this.object3D.addComponent(Jce),this._geometry=this._uiRenderer.geometry=new Hce(this._maxCount).create(),this._uiMaterial=this._uiRenderer.material=new Zce(e),this._uiRenderer.renderOrder=vce.SortOrderStartWorld,this._rebuild=new $ce,this.object3D.bound=new gae(new Rre,new Rre(1,1,1).multiplyScalar(.1*Number.MAX_VALUE))}get quadMaxCount(){return this._maxCount}set billboard(e){this.space==yce.View?e=bce.None:console.warn("Cannot enable billboard in view space"),e==bce.BillboardXYZ||e==bce.BillboardY?(this._billboard=this.object3D.getOrAddComponent(xce),this._billboard.type=e):(this.object3D.removeComponent(xce),this._billboard=null)}get billboard(){return this._billboard?this._billboard.type:bce.None}set cullMode(e){this.space==yce.World?this._uiRenderer.material.cullMode=e:console.warn("Cannot change cullMode in view space")}get cullMode(){return this._uiRenderer.material.cullMode}onUpdate(e){var t;null!=(t=super.onUpdate)&&t.call(this,e),this.rebuildGUIMesh(e)}rebuildGUIMesh(e){var t=this,n=Dre.canvas.clientWidth,r=Dre.canvas.clientHeight;if((i=t._collectTransform).length=0,t.object3D.getComponents(ude,i),0<i.length){t._rebuild.build(i,t,t.needUpdateGeometry),this._uiMaterial.setScreenSize(n,r);for(const e of i)e.needUpdateQuads=!1}var i;r=(n=t.object3D.getComponentFromParent(Fce))?n.index:0,t._uiRenderer.enable=0<i.length,n=t.isViewPanel?vce.SortOrderStartView:vce.SortOrderStartWorld;(i=(t._uiRenderer.renderOrder=r*vce.SortOrderCanvasSpan+n+t.panelOrder,t._uiRenderer.needSortOnCameraZ=t.needSortOnCameraZ,t._uiMaterial)).setLimitVertex(t._limitVertexCount),i.setScissorEnable(t.scissorEnable),t.scissorEnable&&(r=t.mainQuads[0],i.setScissorRect(r.left,r.bottom,r.right,r.top),i.setScissorCorner(t.scissorCornerRadius,t.scissorFadeOutSize)),t.needUpdateGeometry=!1}}class ode extends sde{constructor(){super(),bre(this,"isViewPanel",!0),bre(this,"space",yce.View)}cloneTo(e){e.getOrAddComponent(ode).copyComponent(this)}}class lde extends sde{constructor(){super(),bre(this,"isWorldPanel",!0),bre(this,"space",yce.World),bre(this,"_depthTest",!0)}cloneTo(e){e.getOrAddComponent(lde).copyComponent(this)}copyComponent(e){return super.copyComponent(e),this.depthTest=e.depthTest,this}get depthTest(){return this._depthTest}set depthTest(e){this._depthTest!=e&&(this._depthTest=e,e=this.depthTest?Qre:eie,this._uiRenderer.material.depthCompare=e)}}class ude extends iae{constructor(){super(),bre(this,"useParentPivot",!1),bre(this,"parent"),bre(this,"pivotX",.5),bre(this,"pivotY",.5),bre(this,"_width",100),bre(this,"_height",100),bre(this,"_localVisible",!0),bre(this,"_globalVisible",!0),bre(this,"_uiInteractiveList"),bre(this,"_localMatrix"),bre(this,"_worldMatrix"),bre(this,"_onChange",!0),bre(this,"needUpdateQuads",!0),bre(this,"_tempTransforms",[]),this._localMatrix=new zce,this._worldMatrix=new zce}get uiInteractiveList(){return this._uiInteractiveList}init(e){super.init(e),this.onParentChange(null,null==(e=this.object3D.parent)?void 0:e.object3D)}addUIInteractive(e){return this._uiInteractiveList||(this._uiInteractiveList=[]),this._uiInteractiveList.push(e),this}removeUIInteractive(e){if(this._uiInteractiveList){var t=this._uiInteractiveList.indexOf(e);if(0<=t)return this._uiInteractiveList.slice(t,1),e}return null}get globalVisible(){return this._globalVisible}set visible(e){this._localVisible!=e&&(this._localVisible=e,e=!this.parent||this.parent._globalVisible,this.onUITransformVisible(this._localVisible&&e))}get visible(){return this._localVisible}onUITransformVisible(e){(e=this._localVisible&&e)!=this._globalVisible&&(this._globalVisible=e,this.object3D.components.forEach(((e,t)=>{if(e.onUITransformVisible)if(e==this)for(var n of this.object3D.entityChildren)(n=n.getComponent(ude))&&n.onUITransformVisible(this._globalVisible);else e.onUITransformVisible(this._globalVisible)})))}onParentChange(e,t){var n;null!=(n=this.parent)&&n.setNeedUpdateUIPanel(),this.parent=null==t?void 0:t.getComponent(ude),null!=(n=this.parent)&&n.setNeedUpdateUIPanel()}get width(){return this._width}get height(){return this._height}resize(e,t){var n,r;if(this._width==e&&this._height==t)return!1;for(r of(this._width=e,this._height=t,this.onChange=!0,this.object3D.components.values()))null!=(n=r.onTransformResize)&&n.call(r);return!0}get x(){return this.object3D.x}set x(e){e!=this.object3D.x&&(this.object3D.x=e,this.onChange=!0)}get y(){return this.object3D.y}set y(e){e!=this.object3D.y&&(this.object3D.y=e,this.onChange=!0)}setXY(e,t){var n=this.object3D.localPosition;n.set(e,t,n.z),this.object3D.localPosition=n,this.onChange=!0}get z(){return this.object3D.z}set z(e){e!=this.object3D.z&&(this.object3D.z=e,this.onChange=!0)}get scaleX(){return this.object3D.scaleX}set scaleX(e){this.onChange=!0,this.object3D.scaleX=e}get scaleY(){return this.object3D.scaleY}set scaleY(e){this.onChange=!0,this.object3D.scaleY=e}get scaleZ(){return this.object3D.scaleZ}set scaleZ(e){this.onChange=!0,this.object3D.scaleZ=e}get onChange(){return this._onChange}set onChange(e){var t;if(this._onChange!=e&&(this._onChange=e))for(t of(this._tempTransforms.length=0,this.object3D.getComponents(ude,this._tempTransforms,!0)))t._onChange=!0,t.needUpdateQuads=!0}onEnable(){this.setNeedUpdateUIPanel(),this.onChange=!0}onDisable(){this.setNeedUpdateUIPanel(),this.onChange=!0}setNeedUpdateUIPanel(){let e;(e=(e=this.object3D.getComponentFromParent(lde))||this.object3D.getComponentFromParent(ode))&&(e.needUpdateGeometry=!0)}cloneTo(e){(e=e.getOrAddComponent(ude)).visible=this.visible,e.x=this.x,e.y=this.y,e.z=this.z,e.resize(this.width,this.height),e.pivotX=this.pivotX,e.pivotY=this.pivotY,e.scaleX=this.scaleX,e.scaleY=this.scaleY}matrix(){var e=this._localMatrix,t=this.object3D.rotationZ;return this.parent?e.updateScaleAndRotation(this.object3D.scaleX,this.object3D.scaleY,t,t):e.updateScaleAndRotation(1,1,t,t),e.tx=this.object3D.x,e.ty=this.object3D.y,.5==this.pivotX&&.5==this.pivotY||(tde=tde||(new zce).identity(),e.mul(tde.setTo(1,0,0,1,-(this.pivotX-.5)*this.width,-(this.pivotY-.5)*this.height))),e}getWorldMatrix(){var e=this._worldMatrix;return this._onChange&&(e.copyFrom(this.matrix()),this.parent&&e.mul(this.parent.getWorldMatrix()),this._onChange=!1),e}}class cde{constructor(){bre(this,"_ray"),bre(this,"_mouseCode"),bre(this,"_clickEvent"),bre(this,"_outEvent"),bre(this,"_overEvent"),bre(this,"_upEvent"),bre(this,"_downEvent"),bre(this,"_view"),bre(this,"_lastDownTarget"),bre(this,"_lastOverTarget"),bre(this,"_lastDownPosition",new Wre),bre(this,"_calcDistanceVec2",new Wre),bre(this,"_lastDownTime",0),bre(this,"_clickTimeSpan",200),bre(this,"_clickDistanceSpan",10),bre(this,"_colliderOut",[]),bre(this,"_transformList",[]),bre(this,"_sortWorldPanelList",[]),bre(this,"_iteractive2PanelDict",new Map)}init(e){this._view=e,this._ray=new oae,this._clickEvent=new Are(Are.PICK_CLICK_GUI),this._outEvent=new Are(Are.PICK_OUT_GUI),this._overEvent=new Are(Are.PICK_OVER_GUI),this._upEvent=new Are(Are.PICK_UP_GUI),this._downEvent=new Are(Are.PICK_DOWN_GUI),nce.inputSystem.addEventListener(Are.POINTER_DOWN,this.onTouchDown,this),nce.inputSystem.addEventListener(Are.POINTER_UP,this.onTouchUp,this),nce.inputSystem.addEventListener(Are.POINTER_MOVE,this.onTouchMove,this)}onTouchMove(e){this._mouseCode=e.mouseCode,this.collectEntities(),(e=(e=this.pick(this._colliderOut,this._view.camera))?e.interactive:null)!=this._lastOverTarget&&(this._lastOverTarget&&this._lastOverTarget.enable&&(this._lastOverTarget.mouseStyle=Bce.NORMAL,this._outEvent.data=this._lastOverTarget,this._lastOverTarget.object3D.dispatchEvent(this._outEvent)),e&&(e.mouseStyle=Bce.OVER,(this._overEvent.data=e).object3D.dispatchEvent(this._overEvent)),this._lastOverTarget=e)}onTouchDown(e){this._lastDownTime=Sre.time,this._lastDownPosition.set(e.mouseX,e.mouseY),this._mouseCode=e.mouseCode,this.collectEntities(),(e=(e=this.pick(this._colliderOut,this._view.camera))?e.interactive:null)&&(e.mouseStyle=Bce.DOWN,(this._overEvent.data=e).object3D.dispatchEvent(this._overEvent)),this._lastDownTarget=e}onTouchUp(e){this._calcDistanceVec2.set(e.mouseX,e.mouseY),this._mouseCode=e.mouseCode,this.collectEntities();var t=this.pick(this._colliderOut,this._view.camera),n=t?t.interactive:null;this._lastDownTarget&&this._lastDownTarget.enable&&(this._lastDownTarget.mouseStyle=Bce.NORMAL),n&&n==this._lastDownTarget&&Sre.time-this._lastDownTime<=this._clickTimeSpan&&(this._calcDistanceVec2.set(e.mouseX,e.mouseY),this._calcDistanceVec2.distance(this._lastDownPosition)<=this._clickDistanceSpan)&&(this._clickEvent.data={pick:n,pickInfo:t,mouseCode:this._mouseCode},n.object3D.dispatchEvent(this._clickEvent)),this._lastDownTarget=null}collectEntities(){return this._colliderOut.length=0,this._sortWorldPanelList.length=0,this._iteractive2PanelDict.clear(),this._view.canvasList.forEach((e=>{if(e&&e.transform&&e.transform.parent){var t;e=e.object3D.getComponentsByProperty("isUIPanel",!0,!0);for(t of(e.sort(((e,t)=>(e=e._uiRenderer.__renderOrder,t._uiRenderer.__renderOrder<e?-1:1))),e)){this._transformList.length=0,t.object3D.getComponents(ude,this._transformList);for(const e of this._transformList){var n=e.uiInteractiveList;if(n&&0<n.length)for(var r of n)this._colliderOut.push(r),this._iteractive2PanelDict.set(r,t)}}}})),this._colliderOut}pick(e,t){this._ray=this._view.camera.screenPointToRay(nce.inputSystem.mouseX,nce.inputSystem.mouseY);var n=new Wre(nce.inputSystem.mouseX,nce.inputSystem.mouseY),r=new Wre(Dre.canvas.clientWidth,Dre.canvas.clientHeight);for(const a of e)if(a.interactive&&a.enable&&a.interactiveVisible){var i=this._iteractive2PanelDict.get(a);if(i=a.rayPick(this._ray,i,n,r))return i.interactive=a,i}return null}}var dde=(e=>(e[e.COLLINEAR=0]="COLLINEAR",e[e.LINES_INTERSECT=1]="LINES_INTERSECT",e[e.SEGMENTS_INTERSECT=2]="SEGMENTS_INTERSECT",e[e.A_BISECTS_B=3]="A_BISECTS_B",e[e.B_BISECTS_A=4]="B_BISECTS_A",e[e.PARALELL=5]="PARALELL",e))(dde||{}),hde=(e=>(e[e.ON_LINE=0]="ON_LINE",e[e.LEFT_SIDE=1]="LEFT_SIDE",e[e.RIGHT_SIDE=2]="RIGHT_SIDE",e))(hde||{});const pde=class{constructor(e,t){bre(this,"start"),bre(this,"end"),bre(this,"color",new wre(1,1,1,1)),bre(this,"_normal"),bre(this,"_normalCalculated",!1),this.start=e,this.end=t}set(e,t){this.start=e,this.end=t}getCenter(){var e=Rre.HELP_0;return this.start.subtract(this.end,e),e.scaleBy(.5),e.add(this.end),e}inverse(){var e=this.start;this.start=this.end,this.end=e}equals(e){return this.start==e.start&&this.end==e.end||this.start==e.end&&this.end==e.start}toArray(){return[this.start.x,this.start.y,this.start.z,this.end.x,this.end.y,this.end.z]}static getLines(e){var t=[];for(let i=0;i<e.length;i++){var n=i,r=Xie(i+1,e.length);n=e[n],r=e[r];t.push(new pde(n,r))}return t}intersection(e,t=null){var n=(e.end.z-e.start.z)*(this.end.x-this.start.x)-(e.end.x-e.start.x)*(this.end.z-this.start.z),r=(e.end.x-e.start.x)*(this.start.z-e.start.z)-(e.end.z-e.start.z)*(this.start.x-e.start.x);e=(e.start.x-this.start.x)*(this.end.z-this.start.z)-(e.start.z-this.start.z)*(this.end.x-this.start.x);if(0==n)return 0==r&&0==e?0:5;e/=n;n=this.start.x+(r/=n)*(this.end.x-this.start.x);var i=this.start.z+r*(this.end.z-this.start.z);return null!=t&&(t.x=n,t.y=0,t.z=i),0<=r&&r<=1&&0<=e&&e<=1?2:0<=e&&e<=1?3:0<=r&&r<=1?4:1}getDirection(){var e=this.end.subtract(this.start);return new Rre(e.x,e.y).normalize()}copyFrom(e){this.start||(this.start=new Rre),this.end||(this.end=new Rre),this.start.copyFrom(e.start),this.end.copyFrom(e.end)}static IsEqual(e,t){return Math.abs(e-t)<1e-7}static squreDistanceSegmentToSegment(e,t,n){let r=e.start,i=e.end,a=t.start,s=t.end,o=r.x,l=r.y,u=r.z,c=i.x,d=i.y,h=i.z,p=a.x,f=a.y,m=a.z,g=c-o,v=d-l,y=h-u,_=s.x-p,b=s.y-f,x=s.z-m,w=o-p,S=l-f,C=u-m,T=g*g+v*v+y*y,M=g*_+v*b+y*x,E=_*_+b*b+x*x,A=g*w+v*S+y*C,P=_*w+b*S+x*C,R=T*E-M*M,L=R,k=R,D=0,I=0,O=(this.IsEqual(R,0)?(D=0,L=1,I=P,k=E):(D=M*P-E*A,I=T*P-M*A,D<0?(D=0,I=P,k=E):D>L&&(D=L,I=P+M,k=E)),I<0?-A<(I=0)?D=0:T<-A?D=L:(D=-A,L=T):I>k&&(I=k,M-A<0?D=0:T<M-A?D=L:(D=M-A,L=T)),0),N=0;O=this.IsEqual(D,0)?0:D/L,N=this.IsEqual(I,0)?0:I/k;var B=C+O*y-N*x;return(e=w+O*g-N*_)*e+(t=S+O*v-N*b)*t+B*B}isNear(e,t=0,n){var r=Rre.HELP_0,i=Rre.HELP_1;return(r=(r.copyFrom(e.origin),i.copyFrom(e.direction),i.scaleBy(9999),i.add(r,i),pde.cacluteLine0.set(r,i),pde.cacluteLine1.copyFrom(this),n&&(n.perspectiveMultiplyPoint3(pde.cacluteLine1.start,pde.cacluteLine1.start),n.perspectiveMultiplyPoint3(pde.cacluteLine1.end,pde.cacluteLine1.end)),pde.squreDistanceSegmentToSegment(pde.cacluteLine0,pde.cacluteLine1,n)))+1e-4<=t?(e.length=r,!0):!(e.length=-999999)}};let fde=pde;bre(fde,"cacluteLine0",new pde(null,null)),bre(fde,"cacluteLine1",new pde(null,null));const mde=class{constructor(e,t,n){bre(this,"v1"),bre(this,"v2"),bre(this,"v3"),bre(this,"u1"),bre(this,"u2"),bre(this,"u3"),bre(this,"n1"),bre(this,"n2"),bre(this,"n3"),bre(this,"t0"),bre(this,"t"),bre(this,"u"),bre(this,"v"),bre(this,"min",new Rre),bre(this,"max",new Rre),bre(this,"id",0),this.id=200+mde.ID++,e&&t&&n&&this.set(e,t,n)}set(e,t,n){return this.v1=e,this.v2=t,this.v3=n,e=this.min,t=this.max,e.x=Math.min(this.v1.x,this.v2.x,this.v3.x),e.y=Math.min(this.v1.y,this.v2.y,this.v3.y),e.z=Math.min(this.v1.z,this.v2.z,this.v3.z),t.x=Math.max(this.v1.x,this.v2.x,this.v3.x),t.y=Math.max(this.v1.y,this.v2.y,this.v3.y),t.z=Math.max(this.v1.z,this.v2.z,this.v3.z),this}getNormal(){var e=this.v1,t=this.v2,n=this.v3;t=new Rre(t.x-e.x,t.y-e.y,t.z-e.z);return(n=new Rre(n.x-e.x,n.y-e.y,n.z-e.z).cross(t)).normalize(),n}turnBack(){var e=this.v3;this.v3=this.v1,this.v1=e}getLines(){var e=this.v1,t=this.v2,n=this.v3;return[new fde(e,t),new fde(t,n),new fde(n,e)]}equals(e){let t=this.getLines(),n=e.getLines(),r=0;for(let i=0;i<t.length;i++)for(let e=0;e<n.length;e++)t[i].equals(n[e])&&r++;return 3==r}getCenter(){var e=this.min,t=this.max,n=new Rre;return n.x=.5*(e.x+t.x),n.y=.5*(e.y+t.y),n.z=.5*(e.z+t.z),n}intersects(e){var t=this.max,n=this.min,r=e.max;e=e.min;return n.x<=r.x&&t.x>=e.x&&n.y<=r.y&&t.y>=e.y&&n.z<=r.z&&t.z>=e.z}sign2D(e,t,n){return(e.x-n.x)*(t.z-n.z)-(t.x-n.x)*(e.z-n.z)}pointInTriangle2D(e){var t=this.v1,n=this.v2,r=this.v3,i=this.sign2D(e,t,n);n=this.sign2D(e,n,r),e=this.sign2D(e,r,t);return!((i<0||n<0||e<0)&&(0<i||0<n||0<e))}toArray(){return[this.v1.x,this.v1.y,this.v1.z,this.v2.x,this.v2.y,this.v2.z,this.v3.x,this.v3.y,this.v3.z]}};let gde=mde;bre(gde,"ID",-1);class vde{static init(){this._pt0=new Rre,this._pt1=new Rre,this._pt2=new Rre,this._pt3=new Rre,this._ray=new oae,this._triangle=new gde,this._hitPoint=new Rre,this._worldMatrix=new Kie}static rayPick(e,t,n,r,i,a){this._isInit||(this.init(),this._isInit=!0);let s,o=this._worldMatrix;var l,u;return r!=yce.World?(this.calculateHotArea_View(i,this._pt0,this._pt1,this._pt2,this._pt3),r=n.x,n=n.y,l=Math.min(this._pt0.x,this._pt1.x,this._pt2.x,this._pt3.x)+.5*r,u=Math.min(this._pt0.y,this._pt1.y,this._pt2.y,this._pt3.y)+.5*n,r=Math.max(this._pt0.x,this._pt1.x,this._pt2.x,this._pt3.x)+.5*r,n=Math.max(this._pt0.y,this._pt1.y,this._pt2.y,this._pt3.y)+.5*n,(s=t.x<=r&&t.x>=l&&t.y<=n&&t.y>=u)?(this._hitPoint.set(t.x,t.y,0),{intersect:!0,distance:0,intersectPoint:this._hitPoint}):null):(this.calculateHotArea_World(i,this._pt0,this._pt1,this._pt2,this._pt3),o.copyFrom(a).invert(),(r=this._ray).copy(e).applyMatrix(o),this._triangle.set(this._pt0,this._pt1,this._pt2),(s=r.intersectTriangle(r.origin,r.direction,this._triangle))||(this._triangle.set(this._pt1,this._pt2,this._pt3),s=r.intersectTriangle(r.origin,r.direction,this._triangle)),s?{intersect:!0,distance:0,intersectPoint:s}:null)}static calculateHotArea_View(e,t,n,r,i){var a=e.getWorldMatrix(),s=a.getScaleX(),o=a.getScaleY();s=.5*e.width*s,e=.5*e.height*o,t.set(-s,-e,0),n.set(s,-e,0),r.set(-s,e,0),i.set(s,e,0),o=a.tx;t.x+=o,n.x+=o,r.x+=o,i.x+=o,o=a.ty,t.y-=o,n.y-=o,r.y-=o,i.y-=o}static calculateHotArea_World(e,t,n,r,i){var a=e.getWorldMatrix(),s=a.getScaleX(),o=a.getScaleY();s=.5*e.width*s,e=.5*e.height*o,t.set(-s,e,0),n.set(s,e,0),r.set(-s,-e,0),i.set(s,-e,0),o=a.tx;t.x+=o,n.x+=o,r.x+=o,i.x+=o,o=a.ty,t.y+=o,n.y+=o,r.y+=o,i.y+=o}}bre(vde,"_pt0"),bre(vde,"_pt1"),bre(vde,"_pt2"),bre(vde,"_pt3"),bre(vde,"_hitPoint"),bre(vde,"_worldMatrix"),bre(vde,"_ray"),bre(vde,"_triangle"),bre(vde,"_isInit");var yde=(e=>(e[e.UpperLeft=0]="UpperLeft",e[e.UpperCenter=1]="UpperCenter",e[e.UpperRight=2]="UpperRight",e[e.MiddleLeft=3]="MiddleLeft",e[e.MiddleCenter=4]="MiddleCenter",e[e.MiddleRight=5]="MiddleRight",e[e.LowerLeft=6]="LowerLeft",e[e.LowerCenter=7]="LowerCenter",e[e.LowerRight=8]="LowerRight",e))(yde||{}),_de=(e=>(e[e.Upper=0]="Upper",e[e.Middle=1]="Middle",e[e.Lower=2]="Lower",e))(_de||{}),bde=(e=>(e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right",e))(bde||{}),xde=(e=>(e[e.NONE=0]="NONE",e[e.COLOR=1]="COLOR",e[e.SPRITE=2]="SPRITE",e))(xde||{}),wde=(e=>(e[e.CastGI=0]="CastGI",e[e.ReceiveGI=1]="ReceiveGI",e[e.CastDepth=2]="CastDepth",e[e.Other=3]="Other",e))(wde||{});bre(class extends Yle{constructor(e=0,t=0){super(),Hre.register("GIProbeShader",'\n    #include "Common_vert"\n    #include "Common_frag"\n    #include "UnLit_frag"\n    #include "Irradiance_frag"\n    #include "MathShader"\n    \n    struct MaterialUniform {\n      probeUniform:vec4<f32>,\n    };\n\n    @group(2) @binding(0)\n    var<uniform> materialUniform: MaterialUniform;\n\n    var<private> probeID: i32 ;\n    var<private> debugType: i32 ;\n    \n    fn vert(inputData:VertexAttributes) -> VertexOutput {\n        ORI_Vert(inputData) ;\n        return ORI_VertexOut ;\n    }\n\n    fn frag(){\n        probeID = i32(materialUniform.probeUniform.x);\n        debugType = i32(materialUniform.probeUniform.y);\n        if(debugType == 0){\n            ORI_ShadingInput.BaseColor = debugProbe(probeID);\n        }else if(debugType == 1){\n            ORI_ShadingInput.BaseColor = getIrradiance();\n        }else if(debugType == 2){\n            ORI_ShadingInput.BaseColor = debugProbeDepth(probeID);\n        }\n        UnLit();\n    }\n    '),this.setShader("GIProbeShader","GIProbeShader");var n=this.getShader();(t=(n.setDefine("USE_BRDF",!0),n.setShaderEntry("VertMain","FragMain"),n.setUniformVector4("probeUniform",new $re(t,e,0,0)),n.shaderState)).acceptShadow=!1,t.castShadow=!1,t.receiveEnv=!1,t.acceptGI=!1,t.useLight=!1,e=nce.res.getTexture("BRDFLUT");this.brdfLUT=e,this.baseMap=nce.res.whiteTexture,this.normalMap=nce.res.normalTexture,this.emissiveMap=nce.res.blackTexture}debug(){}},"count",0);class Sde{constructor(e,t){bre(this,"center",new Rre),bre(this,"extents"),bre(this,"max"),bre(this,"min"),bre(this,"size"),bre(this,"tmpVecA",new Rre),bre(this,"tmpVecB",new Rre),bre(this,"tmpVecC",new Rre),bre(this,"tmpVecD",new Rre),bre(this,"radius",0),bre(this,"diffBetweenPoints",new Rre),bre(this,"owner"),bre(this,"forward",new Rre(0,0,1)),bre(this,"worldCenter"),bre(this,"worldSize"),bre(this,"_center",new Rre),this.center=e||new Rre(0,0,0),this.radius=void 0===t?.5:t}updateBound(){throw new Error("Method not implemented.")}containsPoint(e){e=this.tmpVecA.subtract(e,this.center).lengthSquared;var t=this.radius;return e<t*t}intersectsRay(e,t){var n,r=(n=this.tmpVecA.copyFrom(e.origin).subtract(this.center)).dotProduct(this.tmpVecB.copyFrom(e.direction).normalize());return 0<(n=n.dotProduct(n)-this.radius*this.radius)&&0<r?null:!((n=r*r-n)<0||(r=Math.abs(-r-Math.sqrt(n)),t&&t.copyFrom(e.direction).scaleBy(r).add(e.origin),0))}intersectsBoundingSphere(e){return this.tmpVecA.subtract(e.center,this.center),e=e.radius+this.radius,this.tmpVecA.lengthSquared<=e*e}calculateTransform(e){this.update(e)}containsFrustum(e,t){return t.containsSphere(e)}clone(){return new Sde(this.center.clone(),this.radius)}update(e){this.owner=e,this._center.add(e.transform.worldMatrix.position,this.center),this.forward=e.transform.forward}merge(e){throw new Error("BoundingSphere merge is not ready!")}setFromCenterAndSize(e,t){this.center.copy(e),this.radius=t}}const Cde=class extends Sce{constructor(e){super(),bre(this,"_pickRet"),bre(this,"box"),bre(this,"radius",.5),this._shapeType=wce.Sphere,this.radius=e,this.box=new Sde(new Rre,1)}rayPick(e,t){this.box.setFromCenterAndSize(this.center,this.radius);var n=Cde.helpMatrix;return(e=((t=(n.copyFrom(t).invert(),Cde.helpRay.copy(e))).applyMatrix(n),t.intersectSphere(t.origin,t.direction,this.box.center,this.box.radius)))?(this._pickRet||(this._pickRet={intersect:!1,intersectPoint:new Rre,distance:0}),this._pickRet.intersect=!0,this._pickRet.intersectPoint=e,this._pickRet.distance=Rre.distance(t.origin,Cde.v3_help_0),this._pickRet):null}};let Tde=Cde;bre(Tde,"v3_help_0",new Rre),bre(Tde,"helpMatrix",new Kie),bre(Tde,"helpRay",new oae);class Mde extends bae{constructor(){super(),bre(this,"_envMap"),bre(this,"skyObject"),bre(this,"envMapChange",!0),bre(this,"view"),(this.transform.scene3D=this).skyObject=new bae,this.addChild(this.skyObject),this._isScene3D=!0,this.envMap||(this.envMap=nce.res.defaultSky)}get envMap(){return this._envMap}set envMap(e){this._envMap!=e&&(this.envMapChange=!0),this._envMap=e,Kse.instance.sky&&"map"in Kse.instance.sky&&(Kse.instance.sky.map=e)}get exposure(){return Kse.instance.sky&&"exposure"in Kse.instance.sky?Kse.instance.sky.exposure:0}set exposure(e){Kse.instance.sky&&"exposure"in Kse.instance.sky&&(Kse.instance.sky.exposure=e,nce.setting.sky.skyExposure=e)}get roughness(){if(Kse.instance.sky&&"roughness"in Kse.instance.sky)return Kse.instance.sky.roughness}set roughness(e){Kse.instance.sky&&"roughness"in Kse.instance.sky&&(Kse.instance.sky.roughness=e)}}class Ede extends Yse{constructor(){super(3,sie)}}class Ade extends Yse{constructor(){super(2,aie)}}class Pde extends bae{constructor(){super(),bre(this,"mLineRender"),bre(this,"mFillRender"),this.mLineRender=this.addComponent(Ade),this.mFillRender=this.addComponent(Ede)}drawAxis(e,t=new Rre(0,0,0),n=10){this.createCustomShape(e).buildAxis(t,n)}drawLines(e,t,n=wre.COLOR_WHITE){this.createCustomShape(e).buildLines(t,n)}drawCurve(e,t,n=10,r=.5,i=wre.COLOR_WHITE){var a=[],s=new Rre,o=new Rre;for(let h=0;h<t.length-1;++h){a.push(t[h]);var l=t[Math.max(h-1,0)],u=t[h],c=t[h+1],d=t[Math.min(h+2,t.length-1)];c.subtract(l,s).multiplyScalar(r/3).add(u,s),u.subtract(d,o).multiplyScalar(r/3).add(c,o),a.push(...this.calculateBezierCurve(u,s,o,c,n))}a.push(t[t.length-1]),this.drawLines(e,a,i)}calculateBezierCurve(e,t,n,r,i){var a=new Array(i);for(let c=0;c<i;++c){var s=1-(u=(c+1)/(i+1)),o=e.mul(s*s*s),l=t.mul(3*u*s*s),u=(s=n.mul(3*u*u*s),r.mul(u*u*u));a[c]=o.add(l).add(s).add(u)}return a}drawRect(e,t,n,r,i=wre.COLOR_WHITE){this.drawLines(e,[t,new Rre(t.x+n,t.y,t.z),new Rre(t.x+n,t.y+r,t.z),new Rre(t.x,t.y+r,t.z),t],i)}drawCircle(e,t,n,r=32,i=Rre.Y_AXIS,a=wre.COLOR_WHITE){this.createCustomShape(e).buildCircle(t,n,r,i,a)}drawSector(e,t,n,r,i,a=16,s=Rre.Y_AXIS,o=wre.COLOR_WHITE){var l=(i-r)*jie,u=(r*=jie,[]);u.push(t);for(let p=0;p<=a;++p){0<p&&u.push(u[u.length-1]);var c=l*(p/a)+r,d=n*Math.cos(c),h=n*Math.sin(c);switch(s){case Rre.X_AXIS:u.push(t.add(new Rre(0,d,h)));break;case Rre.Y_AXIS:u.push(t.add(new Rre(d,0,h)));break;default:Rre.Z_AXIS,u.push(t.add(new Rre(d,h,0)))}}u.push(u[u.length-1]),u.push(t),this.mLineRender.fillShapeData(e,"line",o,u)}drawArcLine(e,t,n,r,i,a=16,s=Rre.Y_AXIS,o=wre.COLOR_WHITE){this.mLineRender.allocGraphics3DShape(e,this.transform._worldMatrix.index).buildArcLine(t,n,r,i,a,s,o)}createCustomShape(e,t=this.transform){return this.mLineRender.allocGraphics3DShape(e,t._worldMatrix.index)}drawBox(e,t,n,r=wre.COLOR_WHITE){var i=[];i.push(t),i.push(new Rre(n.x,t.y,t.z)),i.push(i[i.length-1]),i.push(new Rre(n.x,n.y,t.z)),i.push(i[i.length-1]),i.push(new Rre(t.x,n.y,t.z)),i.push(i[i.length-1]),i.push(t),i.push(i[i.length-1]),i.push(new Rre(t.x,t.y,n.z)),i.push(i[i.length-1]),i.push(new Rre(n.x,t.y,n.z)),i.push(i[i.length-1]),i.push(new Rre(n.x,n.y,n.z)),i.push(i[i.length-1]),i.push(new Rre(t.x,n.y,n.z)),i.push(i[i.length-1]),i.push(new Rre(t.x,t.y,n.z)),i.push(new Rre(t.x,n.y,t.z)),i.push(new Rre(t.x,n.y,n.z)),i.push(new Rre(n.x,n.y,t.z)),i.push(new Rre(n.x,n.y,n.z)),i.push(new Rre(n.x,t.y,t.z)),i.push(new Rre(n.x,t.y,n.z)),this.mLineRender.fillShapeData(e,"line",r,i)}drawFillRect(e,t,n,r,i=wre.COLOR_WHITE){this.mFillRender.fillShapeData(e,"fill",i,[t,new Rre(t.x+n,t.y,t.z),new Rre(t.x+n,t.y+r,t.z),new Rre(t.x+n,t.y+r,t.z),new Rre(t.x,t.y+r,t.z),t])}drawFillCircle(e,t,n,r=32,i=Rre.Y_AXIS,a=wre.COLOR_WHITE){var s=[];s.push(t);for(let c=0;c<=r;++c){2<=c&&(s.push(t),s.push(s[s.length-2]));var o=2*Math.PI*c/r,l=n*Math.cos(o),u=n*Math.sin(o);switch(i){case Rre.X_AXIS:s.push(t.add(new Rre(0,l,u)));break;case Rre.Y_AXIS:s.push(t.add(new Rre(l,0,u)));break;default:Rre.Z_AXIS,s.push(t.add(new Rre(l,u,0)))}}this.mFillRender.fillShapeData(e,"fill",a,s)}drawMeshWireframe(e,t,n,r=wre.COLOR_WHITE){t&&this.createCustomShape(e,n||this.transform).fillShapeData(t.genWireframe(),r)}drawFillSector(e,t,n,r,i,a=16,s=Rre.Y_AXIS,o=wre.COLOR_WHITE){var l=(i-r)*jie,u=(r*=jie,[]);u.push(t);for(let p=0;p<=a;++p){2<=p&&(u.push(t),u.push(u[u.length-2]));var c=l*(p/a)+r,d=n*Math.cos(c),h=n*Math.sin(c);switch(s){case Rre.X_AXIS:u.push(t.add(new Rre(0,d,h)));break;case Rre.Y_AXIS:u.push(t.add(new Rre(d,0,h)));break;default:Rre.Z_AXIS,u.push(t.add(new Rre(d,h,0)))}}this.mFillRender.fillShapeData(e,"fill",o,u)}drawBoundingBox(e,t,n=wre.COLOR_WHITE){this.drawBox(e,t.min,t.max,n)}drawCameraFrustum(e,t=wre.COLOR_WHITE){var n,r,i,a,s,o,l,u,c,d;e.type==cae.perspective?(r=(o=Math.tan(e.fov/2*jie))*e.aspect,c=(l=e.transform._worldMatrix).transformVector(new Rre(-r,-o,1)),d=l.transformVector(new Rre(-r,o,1)),u=l.transformVector(new Rre(r,-o,1)),l=l.transformVector(new Rre(r,o,1)),r=e.far,o=e.near,n=e.transform.worldPosition,a=(new Rre).copyFrom(c).multiplyScalar(r).add(n),s=(new Rre).copyFrom(d).multiplyScalar(r).add(n),i=(new Rre).copyFrom(u).multiplyScalar(r).add(n),r=(new Rre).copyFrom(l).multiplyScalar(r).add(n),c=(new Rre).copyFrom(c).multiplyScalar(o).add(n),d=(new Rre).copyFrom(d).multiplyScalar(o).add(n),u=(new Rre).copyFrom(u).multiplyScalar(o).add(n),l=(new Rre).copyFrom(l).multiplyScalar(o).add(n),(o=this.createCustomShape("CameraFrustum_"+e.object3D.uuid)).buildLines([d,s],t),o.buildLines([c,a],t),o.buildLines([l,r],t),o.buildLines([u,i],t),o.buildLines([s,r,i,a,s],t),o.buildLines([d,l,u,c,d],t)):e.type==cae.ortho&&(e.viewPort,e.viewPort.height,r=(n=e.transform.worldMatrix).transformVector(new Rre(-.5*e.viewPort.width,.5*e.viewPort.height,e.far)),i=n.transformVector(new Rre(-.5*e.viewPort.width,-.5*e.viewPort.height,e.far)),a=n.transformVector(new Rre(.5*e.viewPort.width,.5*e.viewPort.height,e.far)),s=n.transformVector(new Rre(.5*e.viewPort.width,-.5*e.viewPort.height,e.far)),o=n.transformVector(new Rre(-.5*e.viewPort.width,.5*e.viewPort.height,e.near)),l=n.transformVector(new Rre(-.5*e.viewPort.width,-.5*e.viewPort.height,e.near)),u=n.transformVector(new Rre(.5*e.viewPort.width,.5*e.viewPort.height,e.near)),c=n.transformVector(new Rre(.5*e.viewPort.width,-.5*e.viewPort.height,e.near)),(d=this.createCustomShape("CameraFrustum_"+e.object3D.uuid)).buildLines([o,r],t),d.buildLines([l,i],t),d.buildLines([u,a],t),d.buildLines([c,s],t),d.buildLines([r,a,s,i,r],t),d.buildLines([o,u,c,l,o],t))}drawObjectBoundingBox(e,t=wre.COLOR_WHITE){var n=yae.genMeshBounds(e);this.drawBox("Bounds_"+e.uuid,n.min,n.max,t)}Clear(e){this.mLineRender.shapes.has(e)?this.mLineRender.removeShape(e):this.mFillRender.shapes.has(e)&&this.mFillRender.removeShape(e)}ClearAll(){this.mLineRender.shapes.clear(),this.mFillRender.shapes.clear()}ChangeColor(e,t){var n;if(this.mLineRender.shapes.has(e))n=this.mLineRender.shapes.get(e);else{if(!this.mFillRender.shapes.has(e))return;n=this.mFillRender.shapes.get(e)}var r=n.shapeData;for(let i=0;i<r.length;i+=jse.ShapeVertexSize)r[i+4]=t.r,r[i+5]=t.g,r[i+6]=t.b,r[i+7]=t.a}}class Rde{constructor(){bre(this,"_computeShader"),bre(this,"_outBuffer")}init(){var e=Loe.getGBufferFrame("ColorPassGBuffer");this._computeShader=new Uie("\n    struct GlobalUniform {\n        projMat: mat4x4<f32>,\n        viewMat: mat4x4<f32>,\n        cameraWorldMatrix: mat4x4<f32>,\n        pvMatrixInv : mat4x4<f32>,\n        shadowMatrix: array<mat4x4<f32>,8>,\n        CameraPos: vec3<f32>,\n        \n        frame: f32,\n        time: f32,\n        delta: f32,\n        shadowBias: f32,\n        skyExposure: f32,\n        renderPassState:f32,\n        quadScale: f32,\n        hdrExposure: f32,\n        \n        renderState_left: i32,\n        renderState_right: i32,\n        renderState_split: f32,\n\n        mouseX: f32,\n        mouseY: f32,\n        windowWidth: f32,\n        windowHeight: f32,\n\n        near: f32,\n        far: f32,\n\n        pointShadowBias: f32,\n        shadowMapSize: f32,\n        shadowSoft: f32,\n    };\n\n    struct PickResult{\n        pick_meshID:f32,\n        pick_meshID2:f32,\n        pick_UV:vec2<f32>,\n        pick_Position:vec4<f32>,\n        pick_Normal:vec4<f32>,\n        pick_Tangent:vec4<f32>,\n    }\n\n    @group(0) @binding(0) var<uniform> standUniform: GlobalUniform;\n    @group(0) @binding(1) var<storage,read_write> outBuffer: PickResult;\n    @group(0) @binding(2) var visibleMap : texture_2d<f32>;\n\n    @compute @workgroup_size( 1 )\n    fn CsMain( @builtin(workgroup_id) workgroup_id : vec3<u32> , @builtin(global_invocation_id) globalInvocation_id : vec3<u32>)\n    {\n    var result:PickResult ;\n    // result.pick_meshID\n    let texSize = textureDimensions(visibleMap).xy;\n    let screenPoint = vec2<f32>(standUniform.mouseX/standUniform.windowWidth,standUniform.mouseY/standUniform.windowHeight);\n\n    let mouseUV = screenPoint * vec2<f32>(texSize.xy); \n    let info = textureLoad(visibleMap, vec2<i32>(mouseUV) , 0);\n\n    outBuffer.pick_meshID = f32(info.w) ;\n    outBuffer.pick_meshID2 = f32(info.w) ;\n    outBuffer.pick_Tangent = vec4<f32>(2.0,2.0,2.0,2.0) ;\n    outBuffer.pick_UV = vec2<f32>(standUniform.mouseX,standUniform.mouseY) ;\n    outBuffer.pick_Position = vec4<f32>(info.xyzw) ;\n    outBuffer.pick_Normal = vec4<f32>(info.xyzw) ;\n    }\n"),this._outBuffer=new Doe(32),this._computeShader.setStorageBuffer("outBuffer",this._outBuffer),this._computeShader.setSamplerTexture("visibleMap",e.getPositionMap())}compute(e){e=toe.getCameraGroup(e.camera),this._computeShader.setStorageBuffer("standUniform",e.uniformGPUBuffer),e=roe.beginCommandEncoder(),roe.computeCommand(e,[this._computeShader]),roe.endCommandEncoder(e),this._outBuffer.readBuffer()}getPickMeshID(){var e=this._outBuffer.outFloat32Array[0]+.1;return Math.floor(e)}getPickWorldPosition(e){e=e||new Rre;var t=this._outBuffer.outFloat32Array[4],n=this._outBuffer.outFloat32Array[5],r=this._outBuffer.outFloat32Array[6];return e.set(t,n,r),e}getPickScreenUV(e){e=e||new Wre;var t=this._outBuffer.outFloat32Array[2],n=this._outBuffer.outFloat32Array[3];return e.set(t,n),e}}class Lde extends Mre{constructor(e){super(),bre(this,"ray"),bre(this,"isTouching",!1),bre(this,"_mouseCode"),bre(this,"_pickEvent"),bre(this,"_outEvent"),bre(this,"_overEvent"),bre(this,"_upEvent"),bre(this,"_downEvent"),bre(this,"_mouseMove"),bre(this,"_pickCompute"),bre(this,"_lastDownTarget"),bre(this,"mouseEnableMap"),bre(this,"_view"),bre(this,"_lastFocus"),bre(this,"_colliderOut",[]),bre(this,"_interestList",[]),this._view=e,this.init()}init(){this.ray=new oae,this.mouseEnableMap=new Map,this._pickEvent=new Are(Are.PICK_CLICK),this._outEvent=new Are(Are.PICK_OUT),this._overEvent=new Are(Are.PICK_OVER),this._mouseMove=new Are(Are.PICK_MOVE),this._upEvent=new Are(Are.PICK_UP),this._downEvent=new Are(Are.PICK_DOWN)}start(){nce.inputSystem.addEventListener(Are.POINTER_DOWN,this.onTouchStart,this),nce.inputSystem.addEventListener(Are.POINTER_UP,this.onTouchEnd,this),nce.inputSystem.addEventListener(Are.POINTER_CLICK,this.onTouchOnce,this),nce.inputSystem.addEventListener(Are.POINTER_MOVE,this.onTouchMove,this),"pixel"==nce.setting.pick.mode&&(this._pickCompute=new Rde,this._pickCompute.init())}stop(){nce.inputSystem.removeEventListener(Are.POINTER_DOWN,this.onTouchStart,this),nce.inputSystem.removeEventListener(Are.POINTER_UP,this.onTouchEnd,this),nce.inputSystem.removeEventListener(Are.POINTER_CLICK,this.onTouchOnce,this),nce.inputSystem.removeEventListener(Are.POINTER_MOVE,this.onTouchMove,this)}onTouchStart(e){this.isTouching=!0,this._mouseCode=e.mouseCode,this.collectEntities(),this.pick(this._colliderOut,this._view.camera);var t=this.findNearestObj(this._interestList,this._view.camera);(this._lastDownTarget=t)&&(this._downEvent.target=t.object3D,this._downEvent.ctrlKey=e.ctrlKey,this._downEvent.data={pick:t,pickInfo:this.getPickInfo(),mouseCode:this._mouseCode},this.dispatchEvent(this._downEvent),t.object3D.containEventListener(Are.PICK_DOWN))&&t.object3D.dispatchEvent(this._downEvent)}onTouchEnd(e){this.isTouching=!1,this._mouseCode=e.mouseCode,this.collectEntities(),this.pick(this._colliderOut,this._view.camera);var t=this.findNearestObj(this._interestList,this._view.camera);t&&(this._upEvent.target=t.object3D,this._upEvent.ctrlKey=e.ctrlKey,this._upEvent.data={pick:t,pickInfo:this.getPickInfo(),mouseCode:this._mouseCode},this.dispatchEvent(this._upEvent),t.object3D.containEventListener(Are.PICK_UP))&&t.object3D.dispatchEvent(this._upEvent)}getPickInfo(){return{worldPos:this._pickCompute.getPickWorldPosition(),screenUv:this._pickCompute.getPickScreenUV(),meshID:this._pickCompute.getPickMeshID()}}onTouchMove(e){this.isTouching=!0,this._mouseCode=e.mouseCode,this.collectEntities(),this.pick(this._colliderOut,this._view.camera);var t=this.findNearestObj(this._interestList,this._view.camera);t&&(this._mouseMove.target=t.object3D,this._mouseMove.ctrlKey=e.ctrlKey,this._mouseMove.data={pick:t,pickInfo:this.getPickInfo(),mouseCode:this._mouseCode},this.dispatchEvent(this._mouseMove),t.object3D.containEventListener(Are.PICK_MOVE))&&t.object3D.dispatchEvent(this._mouseMove),t!=this._lastFocus&&(this._lastFocus&&this._lastFocus.object3D&&(this._outEvent.target=t.object3D,this._outEvent.data={pick:this._lastFocus,pickInfo:this.getPickInfo(),mouseCode:this._mouseCode},this._outEvent.ctrlKey=e.ctrlKey,this.dispatchEvent(this._outEvent),this._lastFocus.object3D.containEventListener(Are.PICK_OUT))&&this._lastFocus.object3D.dispatchEvent(this._outEvent),t)&&(this._overEvent.target=t.object3D,this._overEvent.ctrlKey=e.ctrlKey,this._overEvent.data={pick:t,pickInfo:this.getPickInfo(),mouseCode:this._mouseCode},this.dispatchEvent(this._overEvent),t.object3D.containEventListener(Are.PICK_OVER))&&t.object3D.dispatchEvent(this._overEvent),this._lastFocus=t}onTouchOnce(e){this.isTouching=!0,this._mouseCode=e.mouseCode,this.collectEntities(),this.pick(this._colliderOut,this._view.camera);var t,n=this.findNearestObj(this._interestList,this._view.camera);n&&(t="pixel"==nce.setting.pick.mode?this.getPickInfo():null,this._pickEvent.target=n.object3D,this._pickEvent.ctrlKey=e.ctrlKey,this._pickEvent.data={pick:n,pickInfo:t,mouseCode:this._mouseCode},this.dispatchEvent(this._pickEvent),n===this._lastDownTarget)&&n.object3D.containEventListener(Are.PICK_CLICK)&&n.object3D.dispatchEvent(this._pickEvent),this._lastDownTarget=null}findNearestObj(e,t){let n=null,r=Number.MAX_VALUE;for(const a of e){var i=Rre.distance(a.object3D.transform.worldPosition,t.transform.worldPosition);i<r&&(n=a,r=i)}return n}collectEntities(){return this._colliderOut.length=0,this._view.scene.getComponents(Mce,this._colliderOut),this._colliderOut}pick(e,t){if(this._interestList.length=0,"pixel"==nce.setting.pick.mode){this._pickCompute.compute(this._view);var n=this._pickCompute.getPickMeshID();(n=this.mouseEnableMap.get(n))&&this._interestList.push(n)}else if("bound"==nce.setting.pick.mode){this.ray=t.screenPointToRay(nce.inputSystem.mouseX,nce.inputSystem.mouseY);for(const t of e)t.enable&&t.rayPick(this.ray)&&this._interestList.push(t)}}}class kde extends Tre{constructor(e=0,t=0,n=0,r=0){super(),bre(this,"_camera"),bre(this,"_scene"),bre(this,"_viewPort"),bre(this,"_enablePick",!1),bre(this,"_enable",!0),bre(this,"pickFire"),bre(this,"guiPick"),bre(this,"canvasList"),bre(this,"graphic3D"),this.canvasList=[],this._viewPort=new $re(e,t,n,r),this.enablePick=!0,this.graphic3D=new Pde}get enable(){return this._enable}set enable(e){this._enable=e}get enablePick(){return this._enablePick}set enablePick(e){this._enablePick!=e&&(this.pickFire=new Lde(this),this.pickFire.start()),this._enablePick=e}get scene(){return this._scene}set scene(e){(this._scene=e).view=this,Sae.createBuffer(e),this.graphic3D&&e.addChild(this.graphic3D),e&&this.canvasList.forEach((t=>{t&&e.addChild(t.object3D)}))}get camera(){return this._camera}set camera(e){this._camera=e}get viewPort(){return this._viewPort}set viewPort(e){this._viewPort=e}enableUICanvas(e=0){let t=this.canvasList[e];var n;return t||((n=new bae).name="Canvas "+e,(t=n.addComponent(Fce)).index=e,this.canvasList[e]=t),this.scene.addChild(t.object3D),this.guiPick||(this.guiPick=new cde,this.guiPick.init(this)),t}disableUICanvas(e=0){(e=this.canvasList[e])&&e.object3D&&e.object3D.removeFromParent()}}var Dde=(e=>(e[e.position=3]="position",e[e.normal=3]="normal",e[e.TANGENT=4]="TANGENT",e[e.uv=2]="uv",e[e.TEXCOORD_1=2]="TEXCOORD_1",e[e.color=4]="color",e[e.joints0=4]="joints0",e[e.weights0=4]="weights0",e[e.joints1=4]="joints1",e[e.weights1=4]="weights1",e[e.vIndex=1]="vIndex",e[e.a_morphPositions_0=3]="a_morphPositions_0",e))(Dde||{});class Ide{constructor(){bre(this,"min",0),bre(this,"max",0)}set(e,t){return this.max=t,this.min=e,this}copy(e){return this.max=e.max,this.min=e.min,this}isInterestRange(e){return!(this.max>e.min||e.max<this.min)}}class Ode{constructor(){bre(this,"_spaceDesc")}getRange(e){return this._spaceDesc[e]}initSpace(e){for(var t of(this._spaceDesc={},e))(this._spaceDesc[t]=new Ide).set(-Number.MAX_VALUE,Number.MAX_VALUE);return this}isContain(e,t){return t>=(e=this._spaceDesc[e]).min&&t<e.max}isInterestRange(e,t){return!!(e=this._spaceDesc[e])&&t.isInterestRange(e)}splitSpace(e,t,n){return e=this._spaceDesc[e],t?e.max=n:e.min=n,this}copySpace(e){for(var t in e._spaceDesc){var n=e._spaceDesc[t];this._spaceDesc[t].copy(n)}return this}}const Nde=class{};let Bde=Nde;bre(Bde,"MaxEntityCountInLeaf",4),bre(Bde,"MaxLayer",10),bre(Bde,"ClearLeafLayer",Nde.MaxLayer-4);const Ude=class{constructor(){bre(this,"uuid","0"),this.uuid=(Ude.UUID++).toString()}};let zde=Ude;bre(zde,"UUID",0);class Fde{constructor(){bre(this,"map",{}),bre(this,"_count",0)}get count(){return this._count}push(e){return!this.map[e.uuid]&&(this.map[e.uuid]=e,this._count++,!0)}remove(e){return!!this.map[e]&&(delete this.map[e],this._count--,!0)}}const Vde=class extends zde{constructor(e=0){super(),bre(this,"_dimensionIndex",0),bre(this,"_dimensions"),bre(this,"_dimension"),bre(this,"_left"),bre(this,"_right"),bre(this,"_space"),bre(this,"_parent"),bre(this,"_entities"),bre(this,"layer"),bre(this,"_splitEntityList",[]),bre(this,"pointIntersect",new Rre),this.layer=e,Vde.nodeCount++}get dimension(){return this._dimension}initNode(e,t,n){return this._dimensions=t,this._dimensionIndex=n,this._dimension=t[n],this._space=(new Ode).initSpace(t),e&&this._space.copySpace(e._space),this._parent=e,this._entities=new Fde,this}updateEntity(e){var t;e.isInNode(this,this._dimension)&&(e.attachTreeNode(this),this.autoSplit(),this._left)&&this._right&&(t=(this._dimensionIndex+1)%this._dimensions.length,t=this._dimensions[t],e.isInNode(this._right,t)?this._right.updateEntity(e):e.isInNode(this._left,t)&&this._left.updateEntity(e))}buildRoot(e){for(const t of e)t.entity.attachTreeNode(this);this.autoSplit()}autoSplit(){if(this._entities.count>Bde.MaxEntityCountInLeaf&&!this._right&&!this._left&&this.layer<Bde.MaxLayer){let n=this._splitEntityList,r=(this._dimensionIndex+1)%this._dimensions.length,i=this._dimensions[r],a=0;for(const t in this._entities.map){var e=this._entities.map[t];a+=e.centerValue(i),n.push(e)}for(var t of(a/=this._entities.count,this._left=new Vde(this.layer+1),this._right=new Vde(this.layer+1),this._left.initNode(this,this._dimensions,r),this._right.initNode(this,this._dimensions,r),this._left.setSpace(!0,a),this._right.setSpace(!1,a),n))t.isInNode(this._right,i)?t.attachTreeNode(this._right):t.isInNode(this._left,i)&&t.attachTreeNode(this._left)}this._left&&this._left.autoSplit(),this._right&&this._right.autoSplit()}setSpace(e,t){return this._parent&&this._space.splitSpace(this._dimension,e,t),this}isEmpty(){return null==this._left&&null==this._right&&0==this._entities.count}pushEntity(e){return this._entities.push(e)}removeEntity(e){return this._entities.remove(e.uuid)}autoClear(){let e=this;for(;e&&e.layer>Bde.ClearLeafLayer&&e.clearLeaf();)e=e._parent}clearLeaf(){var e=!this._left&&!this._right,t=!e&&this._left.isEmpty()&&this._right.isEmpty();return t&&(this._left=this._right=null,Vde.nodeCount-=2),e||t}isContain(e){return this._space.isContain(this._dimension,e)}nodeIntersectsBox(e){var t=this._space.getRange("x"),n=this._space.getRange("y"),r=this._space.getRange("z"),i=Vde.rangeBox;return i.min.set(t.min,n.min,r.min),i.max.set(t.max,n.max,r.max),i.intersectsBox(e)}nodeIntersectsRay(e){var t=this._space.getRange("x"),n=this._space.getRange("y"),r=this._space.getRange("z"),i=Vde.rangeBox;return i.min.set(t.min,n.min,r.min),i.max.set(t.max,n.max,r.max),!0}pointCast(e,t=0,n){if(n=n||[],0<this._entities.count){var r,i=this._entities.map;for(r in i){let a=i[r],s=a.entityContainPoint(e);(s=!s&&0<t?a.squareDistanceTo(e,this._dimensions)<=t:s)&&n.push(a)}}this._left&&this._left.isContain(e[this._left.dimension])&&this._left.pointCast(e,t,n),this._right&&this._right.isContain(e[this._right.dimension])&&this._right.pointCast(e,t,n)}boxCast(e,t){if(t=t||[],0<this._entities.count){var n,r=this._entities.map;for(n in r){var i=r[n];i.entityIntersectsBox(e)&&t.push(i)}}this._left&&this._left.nodeIntersectsBox(e)&&this._left.boxCast(e,t),this._right&&this._right.nodeIntersectsBox(e)&&this._right.boxCast(e,t)}rayCast(e,t,n){t=t||[],n=n||[];var r=this.pointIntersect;if(0<this._entities.count){var i,a=this._entities.map;for(i in a){var s=a[i];s.entityIntersectsRay(e,r)&&(n.push((new Rre).copyFrom(r)),t.push(s))}}this._left&&this._left.nodeIntersectsRay(e)&&this._left.rayCast(e,t,n),this._right&&this._right.nodeIntersectsRay(e)&&this._right.rayCast(e,t,n)}};let Gde=Vde;bre(Gde,"nodeCount",0),bre(Gde,"rangeBox",new gae(new Rre(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),new Rre(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE)));bre(class extends Cre{},"RESIZE","resize");var Hde=(e=>(e[e.MOUSE_LEFT=0]="MOUSE_LEFT",e[e.MOUSE_MID=1]="MOUSE_MID",e[e.MOUSE_RIGHT=2]="MOUSE_RIGHT",e))(Hde||{});class jde extends Cre{}bre(jde,"LOADER_PROGRESS","loaderProgress"),bre(jde,"LOADER_COMPLETE","loaderComplete");class Wde extends Cre{}bre(Wde,"ADDED","added"),bre(Wde,"REMOVED","removed"),bre(Wde,"CHILD_ADD_EVENT","childAddEvent"),bre(Wde,"CHILD_REMOVED","childRemoved");class Yde extends Cre{}bre(Yde,"SHOW","show"),bre(Yde,"HIDE","hide"),bre(Yde,"UPDATE","update");bre(class{constructor(e=2){bre(this,"name"),bre(this,"index",2),bre(this,"gpuBindGroup"),this.index=e}bindTextureToPipeline(e,t){if(!this.gpuBindGroup){var n,r,i=[];for(let e=0;e<t.length;e++)t[e]&&((n=t[e])instanceof Boe?i.push({binding:2*e+0,resource:n.gpuSampler},{binding:2*e+1,resource:n.getGPUView()}):n instanceof zoe?i.push({binding:2*e+0,resource:n.gpuSampler_comparison},{binding:2*e+1,resource:n.getGPUView()}):n instanceof boe&&(r=-1!=n.format.indexOf("depth"),i.push({binding:2*e+0,resource:r?n.gpuSampler_comparison:n.gpuSampler},{binding:2*e+1,resource:n.getGPUView()})));e=e.getBindGroupLayout(this.index),this.gpuBindGroup=Dre.device.createBindGroup({layout:e,entries:i})}}bindTextureToPipeline2(e,t){if(!this.gpuBindGroup){var n,r=[];for(let e=0;e<t.length;e++)t[e]&&(n=t[e],r.push({binding:e,resource:n.getGPUView()}));e=e.getBindGroupLayout(this.index),this.gpuBindGroup=Dre.device.createBindGroup({layout:e,entries:r})}}},"pool",new Map);class $de{static createMipmap(e,t){var n=Dre.device;this._pipelineMax||(this._pipelineMax=n.createComputePipeline({layout:"auto",compute:{module:n.createShaderModule({code:this.codeMax}),entryPoint:"main"}})),this._pipelineMin||(this._pipelineMin=n.createComputePipeline({layout:"auto",compute:{module:n.createShaderModule({code:this.codeMin}),entryPoint:"main"}})),n=Math.ceil(.5*e.width);(t={mipmapCount:t,texture:e,srcView:null,mipLevel:1,dstHeight:Math.ceil(.5*e.height),dstWidth:n}).srcView=e.getGPUTexture().createView({format:e.format,dimension:"2d",baseMipLevel:0,mipLevelCount:1}),1024<e.width&&1024<e.height?this.mipmap(this._pipelineMax,t):this.mipmap(this._pipelineMin,t)}static mipmap(e,t){var n=Dre.device,r=roe.beginCommandEncoder();let i,a,s=e==this._pipelineMax;for(let u=t.mipLevel;u<t.mipmapCount;u++){var o,l=0;l=((o=[]).push({binding:l++,resource:t.srcView}),o.push({binding:+l,resource:t.texture.gpuSampler}),i=t.texture.getGPUTexture().createView({format:t.texture.format,dimension:"2d",baseMipLevel:u,mipLevelCount:1}),o.push({binding:2,resource:i}),n.createBindGroup({layout:e.getBindGroupLayout(0),entries:o}));(o=r.beginComputePass()).setPipeline(e),o.setBindGroup(0,l);let c=t.dstWidth,d=t.dstHeight;if(s&&(c=Math.max(1,Math.floor(t.dstWidth/8)),d=Math.max(1,Math.floor(t.dstHeight/8))),o.dispatchWorkgroups(c,d),t.dstHeight*=.5,t.dstWidth*=.5,t.srcView=i,t.mipLevel=u+1,a=s&&(t.dstWidth<8||t.dstHeight<8),o.end(),a)break}roe.endCommandEncoder(r),a&&this.mipmap(this._pipelineMin,t)}}bre($de,"codeMax","\n        @group(0) @binding(0) var inputTexture : texture_2d<f32>;\n        @group(0) @binding(1) var inputTextureSampler : sampler;\n        @group(0) @binding(2) var outputTexture : texture_storage_2d<rgba8unorm, write>;\n        \n        @compute @workgroup_size(8, 8)\n        fn main(@builtin(global_invocation_id) GlobalInvocationID : vec3<u32>) {\n            let dstSize = textureDimensions(outputTexture).xy;\n            let uv01 = vec2<f32>(f32(GlobalInvocationID.x) / f32(dstSize.x - 1), f32(GlobalInvocationID.y) / f32(dstSize.y - 1));\n            var fromColor = textureSampleLevel(inputTexture, inputTextureSampler, uv01, 0.0);\n            let dstCoord = vec2<i32>(i32(GlobalInvocationID.x), i32(GlobalInvocationID.y));\n            \n            //fromColor = vec4<f32>(0.0, 0.0, 0.0, 1.0);\n            //if(dstSize.x == 512){\n            //    fromColor.x = 1.0;\n            //}else  if(dstSize.x == 256){\n            //    fromColor.y = 1.0;\n            //}else if(dstSize.x == 128){\n            //    fromColor.z = 1.0;\n            //}\n            \n            textureStore(outputTexture, dstCoord, fromColor);\n        }\n    "),bre($de,"codeMin","\n        @group(0) @binding(0) var inputTexture : texture_2d<f32>;\n        @group(0) @binding(1) var inputTextureSampler : sampler;\n        @group(0) @binding(2) var outputTexture : texture_storage_2d<rgba8unorm, write>;\n        \n        @compute @workgroup_size(1, 1)\n        fn main(@builtin(global_invocation_id) GlobalInvocationID : vec3<u32>) {\n            let dstSize = textureDimensions(outputTexture).xy;\n            let uv01 = vec2<f32>(f32(GlobalInvocationID.x) / f32(dstSize.x - 1), f32(GlobalInvocationID.y) / f32(dstSize.y - 1));\n            var fromColor = textureSampleLevel(inputTexture, inputTextureSampler, uv01, 0.0);\n            let dstCoord = vec2<i32>(i32(GlobalInvocationID.x), i32(GlobalInvocationID.y));\n            \n            textureStore(outputTexture, dstCoord, fromColor);\n        }\n    "),bre($de,"_pipelineMax"),bre($de,"_pipelineMin");class Xde{constructor(){bre(this,"name",""),bre(this,"passMap",new Map)}}class qde{constructor(){bre(this,"passType",""),bre(this,"shaderState",new Map),bre(this,"vertexShader",""),bre(this,"fragmentShader","")}}class Kde{static parser(e,t){e=Iie.filterComment(e);let n=new Xde,r=e.indexOf(this.shaderKeyword),i=e.indexOf("{",r),a=e.substring(r+this.shaderKeyword.length,i).trim();var s;for(s of(n.name=a.substring(1,a.length-1),a=e.substring(e.indexOf("{")+1,e.lastIndexOf("}")),this.splitPassBlock(a))){let e,r=this.parserPassBlock(s);n.passMap.has(r.passType)?e=n.passMap.get(r.passType):(e=[],n.passMap.set(r.passType,e)),e.push(r),0<r.vertexShader.length&&(r.vertexShader=Iie.parse(r.vertexShader,t)),0<r.fragmentShader.length&&(r.fragmentShader=Iie.parse(r.fragmentShader,t))}return n}static splitPassBlock(e){let t=0,n=[];for(;t<e.length;){var r=e.indexOf(this.passKeyword,t);if(-1==r){n.push(e.substring(t));break}0!=t&&n.push(e.substring(t,r)),t=r+this.passKeyword.length}return n}static parserPassBlock(e){var t=new qde,n=e.indexOf(this.passTypeKeyword),r=e.indexOf('"',n);n=e.indexOf('"',r+1);return t.passType=e.substring(n+1,r).trim(),this.parserShaderState(t,e),-1!=(n=e.indexOf(this.vertexKeyword))&&(t.vertexShader=this.extractBlock(e.substring(n+this.vertexKeyword.length),"{","}")),-1!=(n=e.indexOf(this.fragmentKeyword))&&(t.fragmentShader=this.extractBlock(e.substring(n+this.fragmentKeyword.length),"{","}")),t}static parserShaderState(e,t){if(-1==(r=t.indexOf("ShaderState")))return!1;var n,r=t.indexOf("{",r),i=t.indexOf("}",r);for(n of t.substring(r+1,i).split(",")){var a=(s=n.split(":"))[0].trim(),s=this.convertValue(s[1].trim());e.shaderState.set(a,s)}return!0}static convertValue(e){return 4==e.length&&"true"==e.toLowerCase()||(5!=e.length||"false"!=e.toLowerCase())&&('"'==e[0]?e.substring(1,e.length-1):Number.parseInt(e))}static extractBlock(e,t,n){var r,i=e.indexOf(t);if(-1==i)return"";let a=0,s=0;for(r of e=e.substring(i)){if(r==t?a++:r==n&&a--,a<=0)break;s++}return e.substring(1,s).trim()}}bre(Kde,"passKeyword","pass"),bre(Kde,"shaderKeyword","Shader"),bre(Kde,"vertexKeyword","vertex"),bre(Kde,"fragmentKeyword","fragment"),bre(Kde,"passTypeKeyword","PassType");let Zde=new Cre("IrradianceDataReaderCompleteEvent");class Jde extends Mre{constructor(){super(...arguments),bre(this,"readFlag",!1),bre(this,"probeRenderer"),bre(this,"opColorBuffer"),bre(this,"opDepthBuffer"),bre(this,"srcColorMap"),bre(this,"srcDepthMap"),bre(this,"opDepthArray"),bre(this,"opColorArray")}initReader(e,t,n){this.probeRenderer=e,this.srcColorMap=t,this.srcDepthMap=n,t=(e=nce.setting.gi).octRTMaxSize*e.octRTMaxSize,this.opColorBuffer=Dre.device.createBuffer({size:4*t*4,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ,mappedAtCreation:!1}),this.opColorArray=new Float32Array(4*t),this.opDepthBuffer=Dre.device.createBuffer({size:4*t*4,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ,mappedAtCreation:!1}),this.opDepthArray=new Float32Array(4*t),this.probeRenderer.addEventListener(Zoe.type,(()=>{this.onProbeRenderComplete()}),this),this.probeRenderer.addEventListener(Koe.type,(()=>{console.log("GIRenderStartEvent")}),this)}async onProbeRenderComplete(){var e;console.log("GIRenderCompleteEvent"),this.readFlag?console.log("irradianceDataReader is reading yet!!!"):(this.readFlag=!0,e=Date.now(),console.log("irradianceDataReader start reading "),await Jde.read(this.srcColorMap.getGPUTexture(),this.opColorBuffer,this.opColorArray),await Jde.read(this.srcDepthMap.getGPUTexture(),this.opDepthBuffer,this.opDepthArray),this.readFlag=!1,console.log("process time :",Date.now()-e),console.log("irradianceDataReader read complete"),this.dispatchEvent(Zde))}static async read(e,t,n){var r=roe.beginCommandEncoder();r.copyTextureToBuffer({texture:e},{buffer:t,bytesPerRow:16*e.width},[e.width,e.height]),roe.endCommandEncoder(r),await t.mapAsync(GPUMapMode.READ),e=t.getMappedRange();n.set(new Float32Array(e),0),t.unmap()}}new Jde;class Qde{constructor(){bre(this,"indexList"),bre(this,"color"),bre(this,"count")}}let ehe=new class{constructor(){bre(this,"SlotCount",8),bre(this,"MaxEntities",16),bre(this,"defaultColor",new wre(.2,1,1,1)),bre(this,"slots",[]),bre(this,"dataDirty",!0);var e=nce.setting.render.postProcessing.outline.groupCount;this.SlotCount=Math.max(1,Math.min(e,this.SlotCount));for(let n=0;n<this.SlotCount;n++){var t=this.slots[n]=new Qde;t.indexList=new Float32Array(this.MaxEntities),t.color=this.defaultColor.clone(),t.count=0}}clear(){for(let e=0;e<this.SlotCount;e++)this.clearAt(e)}clearAt(e){return this.dataDirty=!0,(e=this.slots[e]).color.copyFrom(this.defaultColor),e.indexList.fill(-1),e.count=0,this}fillDataAt(e,t,n){this.dataDirty=!0;var r=this.slots[e];if(r){r.indexList.fill(-1);for(let e=0,n=t.length;e<n;e++)r.indexList[e]=t[e];r.count=t.length,r.color.copyFrom(n)}return this}fetchData(e){return e.dirty=this.dataDirty,e.slots=this.slots,this.dataDirty=!1,this}};new class{constructor(){bre(this,"_tempIndexArray",[]),bre(this,"_rendererList",[])}setOutline(e,t){this.setOutlineList([e],t?[t]:null)}setOutlineList(e,t){e=e||[];var n=ehe.defaultColor,r=ehe.SlotCount;for(let s=0;s<r;s++){this._tempIndexArray.length=0;var i=e[s],a=(t?t[s]:null)||n;if(i)for(const e of i)this.getEntityIdList(e,this._tempIndexArray);ehe.fillDataAt(s,this._tempIndexArray,a)}}clearOutline(){return ehe.clear(),this}getEntityIdList(e,t){this._rendererList.length=0;for(const n of e.getComponents(soe,this._rendererList))t.push(n.object3D.transform._worldMatrix.index)}};const the=class{static distPtTri(e,t,n,r){var i,a=new Rre,s=new Rre,o=new Rre,l=(r=(r.subtract(t,a),n.subtract(t,s),e.subtract(t,o),$ie(a,a)),n=$ie(a,s),$ie(a,o)),u=1/(r*(i=$ie(s,s))-n*n);r=(r*(o=$ie(s,o))-n*l)*u;return(i=(i*l-n*o)*u)>=-the.EPS&&r>=-the.EPS&&i+r<=1+the.EPS?(o=t[1]+a[1]*i+s[1]*r,Math.abs(o-e[1])):the.FLT_MAX}static IntersectTriangle(e,t,n){let r,i=t.v1,a=t.v2,s=t.v3,o=a.subtract(i,Rre.HELP_3),l=s.subtract(i,Rre.HELP_4),u=e.direction.cross(l,Rre.HELP_5),c=$ie(o,u);if(0<c){if(n)return null;r=e.origin.subtract(i,Rre.HELP_2)}else r=i.subtract(e.origin,Rre.HELP_2),c=-c;var d,h,p;return c<1e-4||(n=$ie(r,u))<0||n>c||(h=r.cross(o,Rre.HELP_1),(d=$ie(e.direction,h))<0)||n+d>c?(this._info.isIn=!1,this._info.t=0,this._info.u=0,this._info.v=0):(h=$ie(l,h),h*=p=1/c,n*=p,d*=p,this._info.isIn=!0,this._info.t=h,p=1-(this._info.u=n)-(this._info.v=d),this._u0.copyFrom(t.u1),this._u0.scale(p),this._u1.copyFrom(t.u2),this._u1.scale(n),this._u2.copyFrom(t.u3),this._u2.scale(d),this._info.uv.copyFrom(this._u0),this._info.uv.add(this._u1,this._info.uv),this._info.uv.add(this._u2,this._info.uv),this._info.localPosition.copyFrom(e.direction).multiplyScalar(h),this._info.localPosition.add(e.origin,this._info.localPosition)),this._info}};let nhe=the;bre(nhe,"EPS",1e-4),bre(nhe,"FLT_MAX",3402823466e29),bre(nhe,"_info",new class{constructor(){bre(this,"localPosition",new Rre),bre(this,"worldPosition",new Rre),bre(this,"uv",new Wre),bre(this,"faceIndex"),bre(this,"isIn",!1),bre(this,"t",0),bre(this,"u",0),bre(this,"v",0),bre(this,"triangle"),bre(this,"v0"),bre(this,"v1"),bre(this,"v2"),bre(this,"pickList"),bre(this,"color")}}),bre(nhe,"_u0",new Wre),bre(nhe,"_u1",new Wre),bre(nhe,"_u2",new Wre);const rhe=class extends Mre{constructor(){if(super(),bre(this,"_maxRetry",3),rhe._instance)throw new Error("LoadManager is singleton class...")}loadAll(e,t){return new Promise(((n,r)=>{let i=e.length,a=[];e.forEach(((e,r)=>{let s=new t;this.load(e,t).then((e=>{s.parse(e),a.push(s),0==--i&&n(a)}))}))}))}static getInstance(){return this._instance||(this._instance=new rhe)}loadUrls(e,t){return new Promise(((n,r)=>{let i=e.length,a=[];e.forEach(((r,s)=>{this.load(r,t).then((t=>{a.push(t),0==--i&&n(a),i<0&&console.error(`loadUrls ${e} error`)}))}))}))}get maxRetry(){return this._maxRetry}set maxRetry(e){this._maxRetry=e}load(e,t){return new Promise(((e,n)=>{t.format}))}};bre(rhe,"_instance");bre(class extends Yle{constructor(){super(),Hre.register("ColorLitShader",ace.Ori_AllShader);var e=this.setShader("ColorLitShader","ColorLitShader"),t=(e.setDefine("USE_BRDF",!0),e.setShaderEntry("VertMain","FragMain"),e.setUniformColor("baseColor",new wre),e.setUniformColor("emissiveColor",new wre),e.setUniformFloat("envIntensity",1),e.setUniformFloat("normalScale",1),e.setUniformFloat("roughness",0),e.setUniformFloat("metallic",0),e.setUniformFloat("ao",1),e.setUniformFloat("alphaCutoff",0),e.shaderState);t.acceptShadow=!0,t.receiveEnv=!0,t.acceptGI=!0,t.useLight=!0,e.setTexture("normalMap",nce.res.normalTexture),e.setTexture("emissiveMap",nce.res.blackTexture)}clone(){return null}debug(){}},"count",0);bre(class{static calculateCubicBezierPoint(e,t,n,r,i){let a=1-(e=(e=1<e?1:e)<0?0:e),s=a*a,o=a*a*a,l=e*e,u=e*e*e,c=t.mul(o),d=n.mul(3),h=(d=(d=d.mul(e)).mul(s),r.mul(3));return h=(h=h.mul(l)).mul(a),t=i.mul(u),(c=(c=c.add(d)).add(h)).add(t)}static bezierPoint(e,t,n,r){let i=1-(e=(e=1<e?1:e)<0?0:e),a=i*i,s=e*e,o=t.mul(a),l=n.mul(2);return l.scaleBy(i),l.scaleBy(e),t=r.mul(s),(o=o.add(l)).add(t)}static calculateCubicBezierPoints(e,t,n){let r=1-(e=(e=1<e?1:e)<0?0:e),i=r*r,a=r*r*r,s=e*e,o=e*e*e,l=t[n].mul(a),u=t[n+1].mul(3),c=(u=(u=u.mul(e)).mul(i),t[n+2].mul(3));return c=(c=c.mul(s)).mul(r),e=t[n+3].mul(o),(l=(l=l.add(u)).add(c)).add(e)}static bezierPathValue(e,t){(e=1<e?1:e)<0&&(e=0);var n,r=t.length,i=this.tmp_points;i.length=0;for(let a=1;a<r;++a)for(let s=0;s<r-a;++s)1==a?((n=new Rre).x=t[s].x*(1-e)+t[s+1].x*e,n.y=t[s].y*(1-e)+t[s+1].y*e,n.z=t[s].z*(1-e)+t[s+1].z*e,this.tmp_points.push(n)):((n=new Rre).x=i[s].x*(1-e)+i[s+1].x*e,n.y=i[s].y*(1-e)+i[s+1].y*e,n.z=i[s].z*(1-e)+i[s+1].z*e,i.push(n));return i[0]}},"tmp_points",[]);var ihe=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(ihe||{}),ahe=(e=>(e[e.kParticleSystemClampVelocityCurveId=322376503]="kParticleSystemClampVelocityCurveId",e[e.kParticleSystemForceCurveId=306581307]="kParticleSystemForceCurveId",e[e.kParticleSystemRotationCurveId=1793934638]="kParticleSystemRotationCurveId",e[e.kParticleSystemRotationBySpeedCurveId=3737431713]="kParticleSystemRotationBySpeedCurveId",e[e.kParticleSystemStartSpeedCurveId=2527743459]="kParticleSystemStartSpeedCurveId",e[e.kParticleSystemSizeCurveId=2368504881]="kParticleSystemSizeCurveId",e[e.kParticleSystemSizeBySpeedCurveId=4085612399]="kParticleSystemSizeBySpeedCurveId",e[e.kParticleSystemVelocityCurveId=3774601268]="kParticleSystemVelocityCurveId",e[e.kParticleSystemUVCurveId=326370691]="kParticleSystemUVCurveId",e[e.kParticleSystemColorGradientId=1494990940]="kParticleSystemColorGradientId",e[e.kParticleSystemColorByVelocityGradientId=1089181156]="kParticleSystemColorByVelocityGradientId",e[e.kParticleSystemMeshSelectionId=3159510623]="kParticleSystemMeshSelectionId",e[e.kParticleSystemUVRowSelectionId=2941263940]="kParticleSystemUVRowSelectionId",e))(ahe||{});function she(e,t,n,r){return Math.abs(e)<1e-5?1e-5<Math.abs(t)?(r.r0=-n/t,1):0:(n=t*t-4*e*n)<0?0:(e=.5/e,n=Math.sqrt(n),r.r0=(n-t)*e,r.r1=(-n-t)*e,2)}function ohe(e,t,n,r,i){let a=0;return 1e-4<=Math.abs(t)?(e[0]=function(e,t,n){var r,i=.3333333333333333,a=(n=(r=(e*=i)*e)*e-e*t*.5+.5*n,(r=(t=t*i-r)*t*t)+n*n);return 0<=a?-e-t/(a=0<(a=Math.sqrt(a)-n)?Math.pow(a,i):-Math.pow(-a,i))+a:(a=Math.sqrt(-r),r=Math.acos(-n/a),a=Math.pow(a,i),-e+(a-=t/a)*Math.cos(r*i))}(n/t,r/t,i/t),a++,a+=she(t,n+t*e[0],r+n*e[0]+t*e[0]*e[0],{r0:e[1],r1:e[2]})):a+=she(n,r,i,{r0:e[1],r1:e[2]}),a}class lhe{constructor(){bre(this,"coeff",[])}static EvalSegment(e,t){return e*(e*(e*t[0]+t[1])+t[2])+t[3]}}const uhe=class{constructor(){bre(this,"segments",[]),bre(this,"integrationCache",[]),bre(this,"doubleIntegrationCache",[]),bre(this,"times",[]),bre(this,"segmentCount"),this.segments[uhe.kMaxNumSegments]=new lhe,this.integrationCache[uhe.kMaxNumSegments]=0,this.doubleIntegrationCache[uhe.kMaxNumSegments]=0,this.times[uhe.kMaxNumSegments]=0}calculateMinMax(e,t){e.x=Math.min(e.x,t),e.y=Math.max(e.y,t)}findMinMaxDoubleIntegrated(){let e=Wre.ZERO.clone(),t=.05;for(let n=0;n<20;n++)this.calculateMinMax(e,this.evaluateDoubleIntegrated(t)),t+=.05;return e}findMinMaxIntegrated(){var e=Wre.ZERO.clone(),t=[],n=[];for(let s=0;s<this.segmentCount;s++){var r=[],i=ohe(r,4*this.segments[s].coeff[0],3*this.segments[s].coeff[1],2*this.segments[s].coeff[2],+this.segments[s].coeff[3]);for(let o=0;o<i;o++){var a=r[o]+t[s];a>=t[s]&&a<n[s]&&this.calculateMinMax(e,this.evaluateIntegrated(a))}this.calculateMinMax(e,this.evaluateIntegrated(n[s])),this.times[s]}return e}generateIntegrationCache(e){e.integrationCache[0]=0;let t=e.times[0],n=0;for(let a=1;a<e.segmentCount;a++){var r=e.segments[a-1].coeff,i=(dhe(r),t-n);e.integrationCache[a]=e.integrationCache[a-1]+lhe.EvalSegment(i,r)*i,n=t,t=e.times[a]}}generateDoubleIntegrationCache(e){let t=0,n=0;for(let i=0;i<e.segmentCount;i++){e.doubleIntegrationCache[i]=t;var r=e.times[i]-n;r=Math.max(r,0);t+=lhe.EvalSegment(r,e.segments[i].coeff)*r*r+e.integrationCache[i]*r,n=e.times[i]}}integrate(){this.generateIntegrationCache(this);for(let e=0;e<this.segmentCount;e++)dhe(this.segments[e].coeff)}doubleIntegrate(){this.generateIntegrationCache(this);for(let e=0;e<this.segmentCount;e++)che(this.segments[e].coeff);this.generateDoubleIntegrationCache(this)}static isValidCurve(e){let t=e.getKeyCount(),n=t-1;return 0!=e.getKey(0).time&&n++,1!=e.getKey(t-1).time&&n++,n<=uhe.kMaxNumSegments}evaluateDoubleIntegrated(e){let t=0;for(let r=0;r<this.segmentCount;r++){var n;if(e<=this.times[r])return n=e-t,this.doubleIntegrationCache[r]+this.integrationCache[r]*n+lhe.EvalSegment(n,this.segments[r].coeff)*n*n;t=this.times[r]}return 1}evaluateIntegrated(e){let t=0;for(let r=0;r<this.segmentCount;r++){var n;if(e<=this.times[r])return n=e-t,this.integrationCache[r]+lhe.EvalSegment(n,this.segments[r].coeff)*n;t=this.times[r]}return 1}evaluate(e){let t=0;for(let n=0;n<this.segmentCount;n++){if(e<=this.times[n])return lhe.EvalSegment(e-t,this.segments[n].coeff);t=this.times[n]}return 1}buildCurve(e,t){var n=e.getKeyCount();if(this.segmentCount=1,this.segments.length=0,this.integrationCache.length=0,this.doubleIntegrationCache.length=0,this.times.length=0,this.times[0]=1.01,0!=n)if(1==n)this.segments[0]=new lhe,this.segments[0].coeff[3]=e.getKey(0).value*t;else{this.segmentCount=n-1;let r=0;0!=e.getKey(0).time&&(this.segments[0].coeff[3]=e.getKey(0).value,this.times[0]=e.getKey(0).time,r=1);for(let t=0;t<this.segmentCount;t++)e.calculateCacheData(void 0,t,t+1,0),this.segments[t+r].coeff=(void 0).coeff.concat(),this.times[t+r]=e.getKey(t+1).time;this.segmentCount+=r,1!=e.getKey(n-1).time&&(this.segments[this.segmentCount].coeff[3]=e.getKey(n-1).value,this.segmentCount++),this.times[this.segmentCount-1]=1.01;for(let e=0;e<this.segmentCount;e++)this.segments[e].coeff[0]*=t,this.segments[e].coeff[1]*=t,this.segments[e].coeff[2]*=t,this.segments[e].coeff[3]*=t}return!0}};function che(e){e[0]/=20,e[1]/=12,e[2]/=6,e[3]/=2}function dhe(e){e[0]/=4,e[1]/=3,e[2]/=2,e[3]/=1}bre(uhe,"kMaxNumSegments",8);var hhe=(e=>(e[e.kEMScalar=0]="kEMScalar",e[e.kEMOptimized=1]="kEMOptimized",e[e.kEMOptimizedMinMax=2]="kEMOptimizedMinMax",e[e.kEMSlow=3]="kEMSlow",e))(hhe||{}),phe=(e=>(e[e.kMMCScalar=0]="kMMCScalar",e[e.kMMCCurve=1]="kMMCCurve",e[e.kMMCTwoCurves=2]="kMMCTwoCurves",e[e.kMMCTwoConstants=3]="kMMCTwoConstants",e))(phe||{});const fhe=class extends Wre{constructor(e=0,t=0){super(e,t),bre(this,"u",0),bre(this,"v",0),this.u=e,this.v=t}length(){return 0}};bre(fhe,"uv_0",new fhe);class mhe{static initHeap(){this.boxGeo||(this.boxGeo=new Dce),this.sphere||(this.sphere=new pce(1,35,35)),this.material||(this.material=new Xle)}static get CubeMesh(){return this.initHeap(),this.boxGeo}static get SphereMesh(){return this.initHeap(),this.sphere}static GetCube(){this.initHeap();var e=new bae,t=e.addComponent(soe);return t.geometry=this.boxGeo,t.material=this.material.clone(),t.castShadow=!0,e}static GetSingleCube(e,t,n,r,i,a){this.initHeap();var s=new Xle;return(i=(r=(s.baseColor=new wre(r,i,a,1),new bae)).addComponent(soe)).castGI=!0,i.geometry=new Dce(e,t,n),i.material=s,r}static GetSingleSphere(e,t,n,r){this.initHeap();var i=new Xle;return(n=(t=(i.baseColor=new wre(t,n,r,1),new bae)).addComponent(soe)).castGI=!0,n.geometry=new pce(e,20,20),n.material=i,t}static get Sphere(){this.initHeap();var e=new bae,t=e.addComponent(soe);return t.geometry=this.sphere,t.material=this.material,e}static GetSingleCube2(e,t=10){this.initHeap();var n=new bae,r=n.addComponent(soe);return r.castShadow=!1,r.geometry=new Dce(t,t,t),r.material=e,n}}bre(mhe,"boxGeo"),bre(mhe,"sphere"),bre(mhe,"material");const ghe=[Ti("canvas",{id:"canvas",width:"800",height:"500"},null,-1)],vhe=[{path:"/jhayesGPUBase",name:"",component:"",meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/JHAYESGL.png"},children:[]},{path:"/gpu",name:"案例展示",component:"",meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/JHAYESGL.png"},children:[{path:"/SDSDS",name:"ASDV",component:Fn({__name:"TESTGPU",setup:e=>(console.log(nce),async function(){await nce.init({});let e=new Mde;e.addComponent(gce);let t=new bae,n=t.addComponent(dae);n.perspective(60,nce.aspect,1,5e3),t.addComponent(Nce).setCamera(0,-20,15),e.addChild(t);let r=new bae,i=r.addComponent(Gle);r.rotationX=45,r.rotationY=30,i.lightColor=new wre(1,1,1,1),i.intensity=1,e.addChild(r);let a=document.createElement("button");a.setAttribute("style","position:fixed;top:calc(50% - 20px);left:0;right:0;width:150px;padding:10px;font-size:16px;margin:auto;"),a.innerHTML="Load Model",document.body.appendChild(a),a.onclick=async()=>{a.onclick=null;let t=await nce.res.loadGltf("https://cdn.orillusion.com/PBR/DragonAttenuation/DragonAttenuation.gltf",{onProgress:(e,t,n)=>{n.match(/\.bin$/)&&(a.innerHTML="Loading "+(e/t*100).toFixed(0)+"%")},onComplete:e=>{e.match(/\.bin$/)&&(a.innerHTML="Model Loaded!",setTimeout((()=>{a.remove()}),1e3))}});e.addChild(t)};let s=new kde;s.scene=e,s.camera=n,nce.startRenderView(s),console.log(nce)}(),(e,t)=>(fi(),yi("div",null,ghe)))}),meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/project1.png"}}]}],yhe={components:{Atropos:u4},data:()=>({routeGPU:vhe}),mounted(){console.log(vhe)}},_he={class:"p-[2vw]"},bhe=Ti("div",{style:{height:"100%",width:"100%","background-color":"var(--el-bg-color-overlay)","box-shadow":"var(--el-box-shadow-lighter)","text-align":"center","line-height":"40px",color:"#1989fa"}}," UP ",-1),xhe=Ti("div",{class:"w-full text-[1.5vw] font-bold"},"虚幻5示例",-1),whe=Ti("img",{src:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/ue50.png",class:"w-[50vw] mt-[1vw]",alt:"",srcset:""},null,-1);const She={class:"echarts-box w-[100%] h-[calc(100%-60px)] b-[calc(50%-300px)] absolute"},Che=[{path:"/",name:"首页",component:r4,meta:{show:!0,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/JHAYESGL.png"}},{path:"/JHAYES2D",name:"JHAYES2D",component:b4,meta:{show:!0,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/JHAYESGL.png"}},{path:"/JHAYESLAB",name:"实验室",component:w4,meta:{show:!0,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/JHAYESGL.png"}},{path:"/JHAYES3D",name:"JHAYES3D",component:lee,meta:{show:!0,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/JHAYESGL.png"}},{path:"/JHAYESGL",name:"JHAYESGL",component:sre,meta:{show:!0,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/JHAYESGL.png"}},{path:"/JHAYESLABC",name:"JHAYESLABC",component:yre,meta:{show:!1,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/JHAYESGL.png"}},{path:"/JHAYESGPU",name:"JHAYESGPU",component:gs(yhe,[["render",function(e,t,n,r,i,a){const s=ur("el-backtop");return fi(),yi("div",_he,[Mi(s,{bottom:100},{default:vn((()=>[bhe])),_:1}),xhe,whe])}]]),meta:{show:!0,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/JHAYESGL.png"}},{path:"/ABOUT",name:"关于",component:gs(Fn({__name:"index",setup:e=>(Kn((()=>{})),er((()=>{})),(e,t)=>(fi(),yi("div",She)))}),[["__scopeId","data-v-94a704df"]]),meta:{show:!0,img:"https://fastly.jsdelivr.net/gh/cjhayes16/oss/JHAYESGL.png"}},...h4,...eee,...vhe,...Jne],The=function(e){const t=jj(e.routes,e),n=e.parseQuery||mW,r=e.stringifyQuery||gW,i=e.history,a=SW(),s=SW(),o=SW(),l=Pt(Pj);let u=Pj;tj&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const c=rj.bind(null,(e=>""+e)),d=rj.bind(null,pW),h=rj.bind(null,fW);function p(e,a){if(a=nj({},a||l.value),"string"==typeof e){const r=lj(n,e,a.path),s=t.resolve({path:r.path},a),o=i.createHref(r.fullPath);return nj(r,s,{params:h(s.params),hash:fW(r.hash),redirectedFrom:void 0,href:o})}let s;if("path"in e)s=nj({},e,{path:lj(n,e.path,a.path).path});else{const t=nj({},e.params);for(const e in t)null==t[e]&&delete t[e];s=nj({},e,{params:d(e.params)}),a.params=d(a.params)}const o=t.resolve(s,a),u=e.hash||"";o.params=c(h(o.params));const p=function(e,t){const n=t.query?e(t.query):"";return t.path+(n&&"?")+n+(t.hash||"")}(r,nj({},e,{hash:(f=u,dW(f).replace(oW,"{").replace(uW,"}").replace(aW,"^")),path:o.path}));var f;const m=i.createHref(p);return nj({fullPath:p,hash:u,query:r===gW?vW(e.query):e.query||{}},o,{redirectedFrom:void 0,href:m})}function f(e){return"string"==typeof e?lj(n,e,l.value.path):nj({},e)}function m(e,t){if(u!==e)return Dj(8,{from:t,to:e})}function g(e){return y(e)}function v(e){const t=e.matched[e.matched.length-1];if(t&&t.redirect){const{redirect:n}=t;let r="function"==typeof n?n(e):n;return"string"==typeof r&&(r=r.includes("?")||r.includes("#")?r=f(r):{path:r},r.params={}),nj({query:e.query,hash:e.hash,params:"path"in r?{}:e.params},r)}}function y(e,t){const n=u=p(e),i=l.value,a=e.state,s=e.force,o=!0===e.replace,c=v(n);if(c)return y(nj(f(c),{state:"object"==typeof c?nj({},a,c.state):a,force:s,replace:o}),t||n);const d=n;let h;return d.redirectedFrom=t,!s&&function(e,t,n){const r=t.matched.length-1,i=n.matched.length-1;return r>-1&&r===i&&cj(t.matched[r],n.matched[i])&&dj(t.params,n.params)&&e(t.query)===e(n.query)&&t.hash===n.hash}(r,i,n)&&(h=Dj(16,{to:d,from:i}),R(i,i,!0,!1)),(h?Promise.resolve(h):b(d,i)).catch((e=>Ij(e)?Ij(e,2)?e:P(e):A(e,d,i))).then((e=>{if(e){if(Ij(e,2))return y(nj({replace:o},f(e.to),{state:"object"==typeof e.to?nj({},a,e.to.state):a,force:s}),t||d)}else e=w(d,i,!0,o,a);return x(d,i,e),e}))}function _(e,t){const n=m(e,t);return n?Promise.reject(n):Promise.resolve()}function b(e,t){let n;const[r,i,o]=function(e,t){const n=[],r=[],i=[],a=Math.max(t.matched.length,e.matched.length);for(let s=0;s<a;s++){const a=t.matched[s];a&&(e.matched.find((e=>cj(e,a)))?r.push(a):n.push(a));const o=e.matched[s];o&&(t.matched.find((e=>cj(e,o)))||i.push(o))}return[n,r,i]}(e,t);n=TW(r.reverse(),"beforeRouteLeave",e,t);for(const a of r)a.leaveGuards.forEach((r=>{n.push(CW(r,e,t))}));const l=_.bind(null,e,t);return n.push(l),DW(n).then((()=>{n=[];for(const r of a.list())n.push(CW(r,e,t));return n.push(l),DW(n)})).then((()=>{n=TW(i,"beforeRouteUpdate",e,t);for(const r of i)r.updateGuards.forEach((r=>{n.push(CW(r,e,t))}));return n.push(l),DW(n)})).then((()=>{n=[];for(const r of e.matched)if(r.beforeEnter&&!t.matched.includes(r))if(aj(r.beforeEnter))for(const i of r.beforeEnter)n.push(CW(i,e,t));else n.push(CW(r.beforeEnter,e,t));return n.push(l),DW(n)})).then((()=>(e.matched.forEach((e=>e.enterCallbacks={})),n=TW(o,"beforeRouteEnter",e,t),n.push(l),DW(n)))).then((()=>{n=[];for(const r of s.list())n.push(CW(r,e,t));return n.push(l),DW(n)})).catch((e=>Ij(e,8)?e:Promise.reject(e)))}function x(e,t,n){for(const r of o.list())r(e,t,n)}function w(e,t,n,r,a){const s=m(e,t);if(s)return s;const o=t===Pj,u=tj?history.state:{};n&&(r||o?i.replace(e.fullPath,nj({scroll:o&&u&&u.scroll},a)):i.push(e.fullPath,a)),l.value=e,R(e,t,n,o),P()}let S;function C(){S||(S=i.listen(((e,t,n)=>{if(!I.listening)return;const r=p(e),a=v(r);if(a)return void y(nj(a,{replace:!0}),r).catch(ij);u=r;const s=l.value;var o,c;tj&&(o=wj(s.fullPath,n.delta),c=bj(),Sj.set(o,c)),b(r,s).catch((e=>Ij(e,12)?e:Ij(e,2)?(y(e.to,r).then((e=>{Ij(e,20)&&!n.delta&&n.type===fj.pop&&i.go(-1,!1)})).catch(ij),Promise.reject()):(n.delta&&i.go(-n.delta,!1),A(e,r,s)))).then((e=>{(e=e||w(r,s,!1))&&(n.delta&&!Ij(e,8)?i.go(-n.delta,!1):n.type===fj.pop&&Ij(e,20)&&i.go(-1,!1)),x(r,s,e)})).catch(ij)})))}let T,M=SW(),E=SW();function A(e,t,n){P(e);const r=E.list();return r.length?r.forEach((r=>r(e,t,n))):console.error(e),Promise.reject(e)}function P(e){return T||(T=!e,C(),M.list().forEach((([t,n])=>e?n(e):t())),M.reset()),e}function R(t,n,r,i){const{scrollBehavior:a}=e;if(!tj||!a)return Promise.resolve();const s=!r&&function(e){const t=Sj.get(e);return Sj.delete(e),t}(wj(t.fullPath,0))||(i||!r)&&history.state&&history.state.scroll||null;return en().then((()=>a(t,n,s))).then((e=>e&&xj(e))).catch((e=>A(e,t,n)))}const L=e=>i.go(e);let k;const D=new Set,I={currentRoute:l,listening:!0,addRoute:function(e,n){let r,i;return Aj(e)?(r=t.getRecordMatcher(e),i=n):i=e,t.addRoute(i,r)},removeRoute:function(e){const n=t.getRecordMatcher(e);n&&t.removeRoute(n)},hasRoute:function(e){return!!t.getRecordMatcher(e)},getRoutes:function(){return t.getRoutes().map((e=>e.record))},resolve:p,options:e,push:g,replace:function(e){return g(nj(f(e),{replace:!0}))},go:L,back:()=>L(-1),forward:()=>L(1),beforeEach:a.add,beforeResolve:s.add,afterEach:o.add,onError:E.add,isReady:function(){return T&&l.value!==Pj?Promise.resolve():new Promise(((e,t)=>{M.add([e,t])}))},install(e){e.component("RouterLink",EW),e.component("RouterView",kW),e.config.globalProperties.$router=this,Object.defineProperty(e.config.globalProperties,"$route",{enumerable:!0,get:()=>Dt(l)}),tj&&!k&&l.value===Pj&&(k=!0,g(i.location).catch((e=>{})));const t={};for(const r in Pj)t[r]=Ki((()=>l.value[r]));e.provide(bW,this),e.provide(xW,pt(t)),e.provide(wW,l);const n=e.unmount;D.add(e),e.unmount=function(){D.delete(e),D.size<1&&(u=Pj,S&&S(),S=null,l.value=Pj,k=!1,T=!1),n()}}};return I}({history:((Mhe=location.host?Mhe||location.pathname+location.search:"").includes("#")||(Mhe+="#"),Ej(Mhe)),routes:Che});var Mhe;The.beforeEach(((e,t,n)=>{console.log(typeof e.name),window.document.title=e.name,n()}));cs(vs).use(ej).use(The).mount("#app");export{lre as L,gs as _,fi as a,gn as b,yi as c,Fn as d,Ti as e,YS as f,Ri as g,Hee as h,Jee as i,$ee as j,Wee as k,ore as l,Gee as m,Qee as n,Kn as o,mn as p,jee as q,Yee as r,lte as t};
