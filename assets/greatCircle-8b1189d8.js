import{k as t,d as e,o as s,L as r,m as i,c as o,a as n,p as a,b as h,e as p,_ as c}from"./index-4159e47b.js";var l=Math.PI/180,u=180/Math.PI,d=function(t,e){this.lon=t,this.lat=e,this.x=l*t,this.y=l*e};d.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)},d.prototype.antipode=function(){var t=-1*this.lat,e=this.lon<0?180+this.lon:-1*(180-this.lon);return new d(e,t)};var g=function(){this.coords=[],this.length=0};g.prototype.move_to=function(t){this.length++,this.coords.push(t)};var f=function(t){this.properties=t||{},this.geometries=[]};f.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(1===this.geometries.length)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var t=[],e=0;e<this.geometries.length;e++)t.push(this.geometries[e].coords);return{geometry:{type:"MultiLineString",coordinates:t},type:"Feature",properties:this.properties}},f.prototype.wkt=function(){for(var t="",e="LINESTRING(",s=function(t){e+=t[0]+" "+t[1]+","},r=0;r<this.geometries.length;r++){if(0===this.geometries[r].coords.length)return"LINESTRING(empty)";this.geometries[r].coords.forEach(s),t+=e.substring(0,e.length-1)+")"}return t};var v=function(t,e,s){if(!t||void 0===t.x||void 0===t.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!e||void 0===e.x||void 0===e.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new d(t.x,t.y),this.end=new d(e.x,e.y),this.properties=s||{};var r=this.start.x-this.end.x,i=this.start.y-this.end.y,o=Math.pow(Math.sin(i/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(r/2),2);if(this.g=2*Math.asin(Math.sqrt(o)),this.g===Math.PI)throw new Error("it appears "+t.view()+" and "+e.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+t+" and "+e)};v.prototype.interpolate=function(t){var e=Math.sin((1-t)*this.g)/Math.sin(this.g),s=Math.sin(t*this.g)/Math.sin(this.g),r=e*Math.cos(this.start.y)*Math.cos(this.start.x)+s*Math.cos(this.end.y)*Math.cos(this.end.x),i=e*Math.cos(this.start.y)*Math.sin(this.start.x)+s*Math.cos(this.end.y)*Math.sin(this.end.x),o=e*Math.sin(this.start.y)+s*Math.sin(this.end.y),n=u*Math.atan2(o,Math.sqrt(Math.pow(r,2)+Math.pow(i,2)));return[u*Math.atan2(i,r),n]},v.prototype.Arc=function(t,e){var s=[];if(!t||t<=2)s.push([this.start.lon,this.start.lat]),s.push([this.end.lon,this.end.lat]);else for(var r=1/(t-1),i=0;i<t;++i){var o=r*i,n=this.interpolate(o);s.push(n)}for(var a=!1,h=0,p=e&&e.offset?e.offset:10,c=180-p,l=-180+p,u=360-p,d=1;d<s.length;++d){var v=s[d-1][0],y=s[d][0],M=Math.abs(y-v);M>u&&(y>c&&v<l||v>c&&y<l)?a=!0:M>h&&(h=M)}var m=[];if(a&&h<p){var w=[];m.push(w);for(var x=0;x<s.length;++x){var E=parseFloat(s[x][0]);if(x>0&&Math.abs(E-s[x-1][0])>u){var T=parseFloat(s[x-1][0]),S=parseFloat(s[x-1][1]),I=parseFloat(s[x][0]),b=parseFloat(s[x][1]);if(T>-180&&T<l&&180===I&&x+1<s.length&&s[x-1][0]>-180&&s[x-1][0]<l){w.push([-180,s[x][1]]),x++,w.push([s[x][0],s[x][1]]);continue}if(T>c&&T<180&&-180===I&&x+1<s.length&&s[x-1][0]>c&&s[x-1][0]<180){w.push([180,s[x][1]]),x++,w.push([s[x][0],s[x][1]]);continue}if(T<l&&I>c){var L=T;T=I,I=L;var R=S;S=b,b=R}if(T>c&&I<l&&(I+=360),T<=180&&I>=180&&T<I){var F=(180-T)/(I-T),A=F*b+(1-F)*S;w.push([s[x-1][0]>c?180:-180,A]),(w=[]).push([s[x-1][0]>c?-180:180,A]),m.push(w)}else w=[],m.push(w);w.push([E,s[x][1]])}else w.push([s[x][0],s[x][1]])}}else{var N=[];m.push(N);for(var _=0;_<s.length;++_)N.push([s[_][0],s[_][1]])}for(var k=new f(this.properties),j=0;j<m.length;++j){var G=new g;k.geometries.push(G);for(var C=m[j],O=0;O<C.length;++O)G.move_to(C[O])}return k};const y=[(t=>(a("data-v-c1c184e5"),t=t(),h(),t))((()=>p("div",{id:"map"},null,-1)))],M=c(e({__name:"greatCircle",setup(e){let a={minZoom:5,maxZoom:18};return s((()=>{const e=r.map("map",a).setView([30.55227,117.07424],13);r.tileLayer("http://t0.tianditu.gov.cn/img_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=img&STYLE=default&TILEMATRIXSET=w&FORMAT=tiles&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}&tk=8c2992a8d82ecb284c857aa88102a057",{attribution:"stamen"}).addTo(e),e.on("click",(t=>{console.log(t.latlng)}));const s=r.icon({iconUrl:"http://grzegorztomicki.pl/serwisy/pin.png",iconSize:[50,58],iconAnchor:[20,58],popupAnchor:[0,-60]}),o=[117.07424,30.55227],n=i(o);r.marker([30.55227,117.07424],{icon:s}).bindPopup(`<br>${o.toString()}`).addTo(e);let h=[];[[30.65227,117.27424],[30.45227,117.17424],[30.95227,117.37424]].map((s=>{const o=r.marker(s).bindPopup(s.toString()).addTo(e);h.push(o);const a=i(s.reverse()),p=function(e,s,r){if("object"!=typeof(r=r||{}))throw new Error("options is invalid");var i=r.properties,o=r.npoints,n=r.offset;return e=t(e),s=t(s),i=i||{},o=o||100,n=n||10,new v({x:e[0],y:e[1]},{x:s[0],y:s[1]},i).Arc(o,{offset:n}).json()}(n,a);r.geoJSON(p).addTo(e)}));let p=new r.featureGroup(h);e.fitBounds(p.getBounds(),{padding:[50,50]})})),(t,e)=>(n(),o("div",null,y))}}),[["__scopeId","data-v-c1c184e5"]]);export{M as default};
